Rank =    0  Free Memory = 86379 MB
Rank =    1  Free Memory = 86379 MB
Rank =    2  Free Memory = 86379 MB
Rank =    3  Free Memory = 86379 MB
Rank =    4  Free Memory = 86379 MB
Rank =    5  Free Memory = 86379 MB
Rank =    6  Free Memory = 86378 MB
Rank =    7  Free Memory = 86378 MB
Rank =    8  Free Memory = 86378 MB
Rank =    9  Free Memory = 86378 MB
Rank =   10  Free Memory = 86377 MB
Rank =   11  Free Memory = 86377 MB
Rank =   12  Free Memory = 86377 MB
Rank =   13  Free Memory = 86377 MB
Rank =   14  Free Memory = 86376 MB
Rank =   15  Free Memory = 86363 MB
Rank =   16  Free Memory = 86363 MB
Rank =   17  Free Memory = 86363 MB
Rank =   18  Free Memory = 86363 MB
Rank =   19  Free Memory = 86363 MB
Rank =   20  Free Memory = 86363 MB
Rank =   21  Free Memory = 86363 MB
Rank =   22  Free Memory = 86363 MB
Rank =   23  Free Memory = 86363 MB
Rank =   24  Free Memory = 86363 MB
Rank =   25  Free Memory = 86363 MB
Rank =   26  Free Memory = 86363 MB
Rank =   27  Free Memory = 86363 MB
Rank =   28  Free Memory = 86363 MB
Rank =   29  Free Memory = 86363 MB
Rank =   30  Free Memory = 86363 MB
Rank =   31  Free Memory = 86363 MB
Rank =   32  Free Memory = 87175 MB
Rank =   33  Free Memory = 87175 MB
Rank =   34  Free Memory = 87175 MB
Rank =   35  Free Memory = 87175 MB
Rank =   36  Free Memory = 87175 MB
Rank =   37  Free Memory = 87175 MB
Rank =   38  Free Memory = 87175 MB
Rank =   39  Free Memory = 87175 MB
Rank =   40  Free Memory = 87175 MB
Rank =   41  Free Memory = 87175 MB
Rank =   42  Free Memory = 87175 MB
Rank =   43  Free Memory = 87175 MB
Rank =   44  Free Memory = 87175 MB
Rank =   45  Free Memory = 87175 MB
Rank =   46  Free Memory = 87175 MB
Rank =   47  Free Memory = 87175 MB
Rank =   48  Free Memory = 87175 MB
Rank =   49  Free Memory = 87175 MB
Rank =   50  Free Memory = 87175 MB
Rank =   51  Free Memory = 87175 MB
Rank =   52  Free Memory = 87175 MB
Rank =   53  Free Memory = 87175 MB
Rank =   54  Free Memory = 87175 MB
Rank =   55  Free Memory = 87175 MB
Rank =   56  Free Memory = 87175 MB
Rank =   57  Free Memory = 87175 MB
Rank =   58  Free Memory = 87175 MB
Rank =   59  Free Memory = 87175 MB
Rank =   60  Free Memory = 87175 MB
Rank =   61  Free Memory = 87175 MB
Rank =   62  Free Memory = 87175 MB
Rank =   63  Free Memory = 87175 MB
Rank =   64  Free Memory = 86909 MB
Rank =   65  Free Memory = 86909 MB
Rank =   66  Free Memory = 86909 MB
Rank =   67  Free Memory = 86909 MB
Rank =   68  Free Memory = 86909 MB
Rank =   69  Free Memory = 86909 MB
Rank =   70  Free Memory = 86909 MB
Rank =   71  Free Memory = 86909 MB
Rank =   72  Free Memory = 86909 MB
Rank =   73  Free Memory = 86908 MB
Rank =   74  Free Memory = 86908 MB
Rank =   75  Free Memory = 86908 MB
Rank =   76  Free Memory = 86908 MB
Rank =   77  Free Memory = 86908 MB
Rank =   78  Free Memory = 86908 MB
Rank =   79  Free Memory = 86908 MB
Rank =   80  Free Memory = 86908 MB
Rank =   81  Free Memory = 86908 MB
Rank =   82  Free Memory = 86908 MB
Rank =   83  Free Memory = 86908 MB
Rank =   84  Free Memory = 86908 MB
Rank =   85  Free Memory = 86908 MB
Rank =   86  Free Memory = 86908 MB
Rank =   87  Free Memory = 86908 MB
Rank =   88  Free Memory = 86908 MB
Rank =   89  Free Memory = 86908 MB
Rank =   90  Free Memory = 86908 MB
Rank =   91  Free Memory = 86908 MB
Rank =   92  Free Memory = 86908 MB
Rank =   93  Free Memory = 86908 MB
Rank =   94  Free Memory = 86908 MB
Rank =   95  Free Memory = 86908 MB
Rank =   96  Free Memory = 78753 MB
Rank =   97  Free Memory = 78752 MB
Rank =   98  Free Memory = 78752 MB
Rank =   99  Free Memory = 78752 MB
Rank =  100  Free Memory = 78752 MB
Rank =  101  Free Memory = 78752 MB
Rank =  102  Free Memory = 78752 MB
Rank =  103  Free Memory = 78752 MB
Rank =  104  Free Memory = 78752 MB
Rank =  105  Free Memory = 78752 MB
Rank =  106  Free Memory = 78752 MB
Rank =  107  Free Memory = 78752 MB
Rank =  108  Free Memory = 78752 MB
Rank =  109  Free Memory = 78752 MB
Rank =  110  Free Memory = 78752 MB
Rank =  111  Free Memory = 78752 MB
Rank =  112  Free Memory = 78752 MB
Rank =  113  Free Memory = 78752 MB
Rank =  114  Free Memory = 78752 MB
Rank =  115  Free Memory = 78752 MB
Rank =  116  Free Memory = 78752 MB
Rank =  117  Free Memory = 78752 MB
Rank =  118  Free Memory = 78752 MB
Rank =  119  Free Memory = 78752 MB
Rank =  120  Free Memory = 78752 MB
Rank =  121  Free Memory = 78752 MB
Rank =  122  Free Memory = 78751 MB
Rank =  123  Free Memory = 78751 MB
Rank =  124  Free Memory = 78751 MB
Rank =  125  Free Memory = 78751 MB
Rank =  126  Free Memory = 78751 MB
Rank =  127  Free Memory = 78751 MB
  Input file(s): opt_form_n2pistar_lmtt_run002c.xml 

=====================================================
                    QMCPACK 3.7.9

       (c) Copyright 2003-  QMCPACK developers

                    Please cite:
 J. Kim et al. J. Phys. Cond. Mat. 30 195901 (2018)
      https://doi.org/10.1088/1361-648X/aab9c3

  Git branch: gvp
  Last git commit: a1d851bbe8d902a0d3168a885b757a378aeaab54-dirty
  Last git commit date: Mon Feb 13 11:52:39 2023 -0800
  Last git commit subject: Print param update magnitude and largest update
=====================================================
  Global options 

  Total number of MPI ranks = 128
  Number of MPI groups      = 1
  MPI group ID              = 0
  Number of ranks in group  = 128
  MPI ranks per node        = 32
  OMP 1st level threads     = 1
  OMP nested threading disabled or only 1 thread on the 2nd level

  Precision used in this calculation, see definitions in the manual:
  Base precision      = double
  Full precision      = double

  Structure-of-arrays (SoA) optimization enabled

  Input XML = opt_form_n2pistar_lmtt_run002c.xml

  Project = FORM
  date    = 2023-02-22 16:25:01 PST
  host    = n0110.savio3

 Random Number
 -------------
  Offset for the random number seeds based on time: 605

  Range of prime numbers to use as seeds over processors and threads = 4463-5569


 Particle Set 
 ------------
  Name: e
  All the species have the same mass 1
  Particle set size: 12

 Particle Set 
 ------------
  Name: ion0
  All the species have the same mass 1
  Particle set size: 4

 Wavefunction setup: 
 ------------------- 
  Name: psi0

   Jastrow
   -------
    Name: J2   Type: Two-Body   Function: Bspline

    Radial function for species: u - u
     Number of parameters: 10
     Cusp: -0.25
     Cutoff radius: 10

     Name                        Value Type Recompute Use Index
     ---- ---------------------------- ---- --------- --- -----
     uu_0                 2.969878e-01    1         1 OFF
     uu_1                 1.214598e-01    1         1 OFF
     uu_2                 7.692261e-03    1         1 OFF
     uu_3                -5.988518e-02    1         1 OFF
     uu_4                -1.008186e-01    1         1 OFF
     uu_5                -1.267693e-01    1         1 OFF
     uu_6                -1.424572e-01    1         1 OFF
     uu_7                -1.471938e-01    1         1 OFF
     uu_8                -1.395512e-01    1         1 OFF
     uu_9                -1.170827e-01    1         1 OFF

    Radial function for species: u - d
     Number of parameters: 10
     Cusp: -5.000000e-01
     Cutoff radius: 1.000000e+01

     Name                        Value Type Recompute Use Index
     ---- ---------------------------- ---- --------- --- -----
     ud_0                 4.098493e-01    1         1 OFF
     ud_1                 1.280868e-01    1         1 OFF
     ud_2                -1.741848e-02    1         1 OFF
     ud_3                -9.455707e-02    1         1 OFF
     ud_4                -1.368506e-01    1         1 OFF
     ud_5                -1.613527e-01    1         1 OFF
     ud_6                -1.739996e-01    1         1 OFF
     ud_7                -1.751521e-01    1         1 OFF
     ud_8                -1.631144e-01    1         1 OFF
     ud_9                -1.336224e-01    1         1 OFF


   Jastrow
   -------
    Name: J1   Type: One-Body   Function: Bspline

    Radial function for element: C
     Number of parameters: 10
     Cusp: 0.000000e+00
     Cutoff radius: 1.000000e+01

     Name                        Value Type Recompute Use Index
     ---- ---------------------------- ---- --------- --- -----
     eC_0                -5.810574e-01    1         1 OFF
     eC_1                -4.296394e-01    1         1 OFF
     eC_2                -1.793900e-01    1         1 OFF
     eC_3                -2.513542e-02    1         1 OFF
     eC_4                 5.576471e-02    1         1 OFF
     eC_5                 1.582299e-01    1         1 OFF
     eC_6                 2.553617e-01    1         1 OFF
     eC_7                 3.740835e-01    1         1 OFF
     eC_8                 2.827417e-01    1         1 OFF
     eC_9                 8.197673e-02    1         1 OFF

    Radial function for element: O
     Number of parameters: 10
     Cusp: 0.000000e+00
     Cutoff radius: 1.000000e+01

     Name                        Value Type Recompute Use Index
     ---- ---------------------------- ---- --------- --- -----
     eO_0                -1.183058e+00    1         1 OFF
     eO_1                -8.065315e-01    1         1 OFF
     eO_2                -3.412496e-01    1         1 OFF
     eO_3                -7.608637e-04    1         1 OFF
     eO_4                 2.238678e-01    1         1 OFF
     eO_5                 3.875698e-01    1         1 OFF
     eO_6                 4.319831e-01    1         1 OFF
     eO_7                 4.299413e-01    1         1 OFF
     eO_8                 4.063458e-01    1         1 OFF
     eO_9                 3.120286e-01    1         1 OFF

    Radial function for element: H1
     Number of parameters: 10
     Cusp: 0.000000e+00
     Cutoff radius: 1.000000e+01

      Name                        Value Type Recompute Use Index
     ----- ---------------------------- ---- --------- --- -----
     eH1_0                -2.086297e-01    1         1 OFF
     eH1_1                -1.161154e-01    1         1 OFF
     eH1_2                -7.867980e-02    1         1 OFF
     eH1_3                -5.952234e-02    1         1 OFF
     eH1_4                 1.067786e-02    1         1 OFF
     eH1_5                 5.587847e-02    1         1 OFF
     eH1_6                 9.050690e-02    1         1 OFF
     eH1_7                 6.415771e-02    1         1 OFF
     eH1_8                 6.534814e-03    1         1 OFF
     eH1_9                 6.249708e-02    1         1 OFF

    Radial function for element: H2
     Number of parameters: 10
     Cusp: 0.000000e+00
     Cutoff radius: 1.000000e+01

      Name                        Value Type Recompute Use Index
     ----- ---------------------------- ---- --------- --- -----
     eH2_0                -2.043774e-01    1         1 OFF
     eH2_1                -1.120154e-01    1         1 OFF
     eH2_2                -7.472353e-02    1         1 OFF
     eH2_3                -5.568105e-02    1         1 OFF
     eH2_4                 1.425377e-02    1         1 OFF
     eH2_5                 5.879339e-02    1         1 OFF
     eH2_6                 9.301498e-02    1         1 OFF
     eH2_7                 6.632804e-02    1         1 OFF
     eH2_8                 1.611107e-02    1         1 OFF
     eH2_9                 6.620031e-02    1         1 OFF

  Created SPOSet builder named 'LCAOBSet' of type molecularorbital
  LCAO: SoaAtomicBasisSet<MultiQuintic,0>
  AO BasisSet for C
   Angular momentum expanded in cartesian functions x^lx y^ly z^lz according to Gamess
Using log grid with default values: ri = 1.000000e-06 rf = 1.000000e+02 npts = 1001
   R(n,l,m,s) 0 0 0 0
   R(n,l,m,s) 1 0 0 0
   R(n,l,m,s) 2 1 0 0
   R(n,l,m,s) 3 1 0 0
   R(n,l,m,s) 4 2 0 0
Expanding Ylm (angular function) according to Gamess using cartesian gaussians
Adding 1 cartesian gaussian orbitals for l= 0
Adding 1 cartesian gaussian orbitals for l= 0
Adding 3 cartesian gaussian orbitals for l= 1
Adding 3 cartesian gaussian orbitals for l= 1
Adding 6 cartesian gaussian orbitals for l= 2
  Setting cutoff radius 1.270574e+01

   Maximum Angular Momentum  = 2
   Number of Radial functors = 5
   Basis size                = 14

  AO BasisSet for O
   Angular momentum expanded in cartesian functions x^lx y^ly z^lz according to Gamess
Using log grid with default values: ri = 1.000000e-06 rf = 1.000000e+02 npts = 1001
   R(n,l,m,s) 0 0 0 0
   R(n,l,m,s) 1 0 0 0
   R(n,l,m,s) 2 1 0 0
   R(n,l,m,s) 3 1 0 0
   R(n,l,m,s) 4 2 0 0
Expanding Ylm (angular function) according to Gamess using cartesian gaussians
Adding 1 cartesian gaussian orbitals for l= 0
Adding 1 cartesian gaussian orbitals for l= 0
Adding 3 cartesian gaussian orbitals for l= 1
Adding 3 cartesian gaussian orbitals for l= 1
Adding 6 cartesian gaussian orbitals for l= 2
  Setting cutoff radius 1.018591e+01

   Maximum Angular Momentum  = 2
   Number of Radial functors = 5
   Basis size                = 14

  AO BasisSet for H1
   Angular momentum expanded in cartesian functions x^lx y^ly z^lz according to Gamess
Using log grid with default values: ri = 1.000000e-06 rf = 1.000000e+02 npts = 1001
   R(n,l,m,s) 0 0 0 0
   R(n,l,m,s) 1 0 0 0
   R(n,l,m,s) 2 1 0 0
Expanding Ylm (angular function) according to Gamess using cartesian gaussians
Adding 1 cartesian gaussian orbitals for l= 0
Adding 1 cartesian gaussian orbitals for l= 0
Adding 3 cartesian gaussian orbitals for l= 1
  Setting cutoff radius 1.270574e+01

   Maximum Angular Momentum  = 1
   Number of Radial functors = 3
   Basis size                = 5

  AO BasisSet for H2
   Angular momentum expanded in cartesian functions x^lx y^ly z^lz according to Gamess
Using log grid with default values: ri = 1.000000e-06 rf = 1.000000e+02 npts = 1001
   R(n,l,m,s) 0 0 0 0
   R(n,l,m,s) 1 0 0 0
   R(n,l,m,s) 2 1 0 0
Expanding Ylm (angular function) according to Gamess using cartesian gaussians
Adding 1 cartesian gaussian orbitals for l= 0
Adding 1 cartesian gaussian orbitals for l= 0
Adding 3 cartesian gaussian orbitals for l= 1
  Setting cutoff radius 1.270574e+01

   Maximum Angular Momentum  = 1
   Number of Radial functors = 3
   Basis size                = 5

Creating SPOSet in SlaterDetBuilder::put(xmlNodePtr cur).
spo_name = spo-up
  Building SPOSet 'spo-up' with '' basis set.
Creating SPOSet in SlaterDetBuilder::put(xmlNodePtr cur).
spo_name = spo-dn
  Building SPOSet 'spo-dn' with '' basis set.
Using Bryan's algorithm for MultiSlaterDeterminant expansion. 
Creating base determinant (up) for MSD expansion. 
Creating base determinant (down) for MSD expansion. 
Found determinant list. 
Reading CI expansion.
Found 77 terms in the MSD expansion.
Norm of ci vector (sum of ci^2): 1.001167e+00
Norm of qchem ci vector (sum of qchem_ci^2): 0.000000e+00
Found 24 unique up determinants.
Found 24 unique down determinants.
Number of terms in pairs array: 12
Number of terms in pairs array: 12
CI coefficients are optimizable. 
  FermionWF = MultiSlaterDeterminantFast
  QMCHamiltonian::addOperator Kinetic to H, physical Hamiltonian 
  QMCHamiltonian::addOperator ElecElec to H, physical Hamiltonian 
QMCHamiltonian::addOperatorType added type coulomb named ElecElec

  ECPotential builder for pseudopotential 

  Adding pseudopotential for C
   Linear grid  ri=0.000000e+00 rf=1.000000e+01 npts = 10001
    ECPComponentBuilder::buildSemiLocalAndLocal 
    Assuming Hartree unit
   Number of angular momentum channels 2
   Maximum angular momentum channel 1
   Creating a Linear Grid Rmax=1.405000e+00
  Using global grid with delta = 1.000000e-03
   Making L=1 a local potential with a radial cutoff of 9.999000e+00
    Non-local pseudopotential parameters
    Maximum angular mementum = 0
    Number of non-local channels = 1
       l(0)=0
    Cutoff radius = 1.405000e+00
    Spherical grids and weights: 
         1.0000000000e+00  0.0000000000e+00  0.0000000000e+00    8.3333333333e-02
        -1.0000000000e+00  1.2246467991e-16  0.0000000000e+00    8.3333333333e-02
         4.4721359550e-01  8.9442719100e-01  0.0000000000e+00    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -8.9442719100e-01  1.0953573965e-16    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
    Maximum cutoff radius 1.4050000000e+00

  Adding pseudopotential for O
   Linear grid  ri=0.0000000000e+00 rf=1.0000000000e+01 npts = 10001
    ECPComponentBuilder::buildSemiLocalAndLocal 
    Assuming Hartree unit
   Number of angular momentum channels 2
   Maximum angular momentum channel 1
   Creating a Linear Grid Rmax=1.0750000000e+00
  Using global grid with delta = 1.0000000000e-03
   Making L=1 a local potential with a radial cutoff of 9.9990000000e+00
    Non-local pseudopotential parameters
    Maximum angular mementum = 0
    Number of non-local channels = 1
       l(0)=0
    Cutoff radius = 1.0750000000e+00
    Spherical grids and weights: 
         1.0000000000e+00  0.0000000000e+00  0.0000000000e+00    8.3333333333e-02
        -1.0000000000e+00  1.2246467991e-16  0.0000000000e+00    8.3333333333e-02
         4.4721359550e-01  8.9442719100e-01  0.0000000000e+00    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -8.9442719100e-01  1.0953573965e-16    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
    Maximum cutoff radius 1.0750000000e+00

  Adding pseudopotential for H1
   Linear grid  ri=0.0000000000e+00 rf=1.0000000000e+01 npts = 10001
    ECPComponentBuilder::buildSemiLocalAndLocal 
    Assuming Hartree unit
   Number of angular momentum channels 2
   Maximum angular momentum channel 1
   Creating a Linear Grid Rmax=1.0000000000e-10
  Using global grid with delta = 1.0000000000e-03
   Making L=1 a local potential with a radial cutoff of 9.9990000000e+00
    Non-local pseudopotential parameters
    Maximum angular mementum = 0
    Number of non-local channels = 1
       l(0)=0
    Cutoff radius = 1.0000000000e-03
    Spherical grids and weights: 
         1.0000000000e+00  0.0000000000e+00  0.0000000000e+00    8.3333333333e-02
        -1.0000000000e+00  1.2246467991e-16  0.0000000000e+00    8.3333333333e-02
         4.4721359550e-01  8.9442719100e-01  0.0000000000e+00    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -8.9442719100e-01  1.0953573965e-16    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
    Maximum cutoff radius 1.0000000000e-03

  Adding pseudopotential for H2
   Linear grid  ri=0.0000000000e+00 rf=1.0000000000e+01 npts = 10001
    ECPComponentBuilder::buildSemiLocalAndLocal 
    Assuming Hartree unit
   Number of angular momentum channels 2
   Maximum angular momentum channel 1
   Creating a Linear Grid Rmax=1.0000000000e-10
  Using global grid with delta = 1.0000000000e-03
   Making L=1 a local potential with a radial cutoff of 9.9990000000e+00
    Non-local pseudopotential parameters
    Maximum angular mementum = 0
    Number of non-local channels = 1
       l(0)=0
    Cutoff radius = 1.0000000000e-03
    Spherical grids and weights: 
         1.0000000000e+00  0.0000000000e+00  0.0000000000e+00    8.3333333333e-02
        -1.0000000000e+00  1.2246467991e-16  0.0000000000e+00    8.3333333333e-02
         4.4721359550e-01  8.9442719100e-01  0.0000000000e+00    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -8.9442719100e-01  1.0953573965e-16    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
    Maximum cutoff radius 1.0000000000e-03
  QMCHamiltonian::addOperator LocalECP to H, physical Hamiltonian 

  Using NonLocalECP potential 
    Maximum grid on a sphere for NonLocalECPotential: 12
  QMCHamiltonian::addOperator NonLocalECP to H, physical Hamiltonian 
QMCHamiltonian::addOperatorType added type pseudo named NonLocalECP
  QMCHamiltonian::addOperator IonIon to H, physical Hamiltonian 
QMCHamiltonian::addOperatorType added type coulomb named IonIon

  QMCHamiltonian::add2WalkerProperty added
    5 to P::PropertyList 
    0 to P::Collectables 
    starting Index of the observables in P::PropertyList = 10
ParticleSetPool::randomize 
  Initialization Execution time = 4.3926e-01 secs
=========================================================
 Summary of QMC systems 
=========================================================
ParticleSetPool has: 

  ParticleSet 'e' contains 12 particles :  u(6) d(6)

    u -1.8061669018e+00  2.7837752017e-01 -8.9374600273e-01
    u  6.2204767277e-01 -3.1767951129e-01 -1.6068917470e+00
    u  2.7844543642e-02 -4.6711695757e-01  1.3769739340e+00
    u  5.3613352983e-01 -1.0346031641e-01  1.1931174682e+00
    u  6.6915801034e-01  1.1573235719e+00  1.2719505344e+00
    u  1.8470266426e-02  1.4117662795e+00 -1.6695285925e+00
    d -9.6293909260e-01  1.0337145637e+00 -8.9962839053e-01
    d  1.0744417758e+00  1.1605479134e+00 -1.8930392030e+00
    d  1.2380477230e+00  4.9285421082e-01  8.7082227944e-01
    d  8.1730014770e-01 -3.7289888410e-01  2.8378529985e+00
    (... and 2 more particle positions ...)

  Distance table for similar particles (A-A):
    source/target: e
    Using structure-of-arrays (SoA) data layout
    Distance computations use open boundary conditions in 3D.

  Distance table for dissimilar particles (A-B):
    source: ion0  target: e
    Using structure-of-arrays (SoA) data layout
    Distance computations use open boundary conditions in 3D.


  ParticleSet 'ion0' contains 4 particles :  C(1) O(1) H1(1) H2(1)

    C  0.0000000000e+00  0.0000000000e+00 -1.1394765782e+00
    O  0.0000000000e+00  0.0000000000e+00  1.1440287480e+00
    H1  0.0000000000e+00  1.7662761033e+00 -2.2339863698e+00
    H2  0.0000000000e+00 -1.7662761033e+00 -2.2339863698e+00

  Distance table for similar particles (A-A):
    source/target: ion0
    Using structure-of-arrays (SoA) data layout
    Distance computations use open boundary conditions in 3D.


  Hamiltonian h0
  Kinetic         Kinetic energy
  ElecElec        CoulombAA source/target e

  LocalECP        LocalECPotential: ion0
  NonLocalECP     NonLocalECPotential: ion0
  IonIon          CoulombAA source/target ion0


Loop execution max-interations = 100
Inside LM engine constructor, num_params is: 0 and _total_num_params is: 0

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s000 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15
  Adding 1 walkers to 0 existing sets
  Total number of walkers: 1.2800000000e+02
  Total weight: 1.2800000000e+02

=========================================================
  Start VMC
  File Root FORM.s000 append = no 
=========================================================
Resetting walkers
  Using the current 1 walkers.
  Total number of walkers: 1.2800000000e+02
  Total weight: 1.2800000000e+02
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=0  my_counter=0
  time step      = 5.0000000000e-02
  blocks         = 250
  steps          = 250
  substeps       = 10
  current        = 0
  target samples = 8.0000000000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">250</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">6.2500000000e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000000000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000000000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000000000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000000000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000000000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000000000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">8.0000000000e+06</parameter>
<parameter name="samplesperthread" condition="real">6.2500000000e+04</parameter>
<parameter name="steps" condition="int">250</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000000000e-02</parameter>
<parameter name="time_step" condition="au">5.0000000000e-02</parameter>
<parameter name="timestep" condition="au">5.0000000000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
  Set drift_modifier UNR parameter a = 1.0000000000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000000000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: 0 and ratio_threshold_: 0.0000000000e+00
Allocating full size _hmat_temp and _smat_temp
Inside LM engine's get_param, num_params is: 76
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="250">
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =8000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 0
    time step          = 0.05
    reference energy   = -22.6775
    reference variance = 0.356173
====================================================
  Execution time = 1.0492e+02
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s000
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 62500 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 6.1069e+04
  VMC Eavg = -2.2669e+01
  VMC Evar = 5.1118e-01
  Total weights = 7.820280384e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.9141e+01
  </log>
</opt>
<opt stage="main" walkers="62500">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.497464479997
                                         uncertainty =       0.001801311186

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.497464479997
                                         uncertainty =       0.001801311186

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000249365070
  error estimate for blocks of size 2^( 2) =       0.000258308280
  error estimate for blocks of size 2^( 3) =       0.000266329928
  error estimate for blocks of size 2^( 4) =       0.000272079000
  error estimate for blocks of size 2^( 5) =       0.000275306633
  error estimate for blocks of size 2^( 6) =       0.000277271339
  error estimate for blocks of size 2^( 7) =       0.000278963673
  error estimate for blocks of size 2^( 8) =       0.000279221319
  error estimate for blocks of size 2^( 9) =       0.000280038407

      target function =                  N/A
              le_mean =     -22.669012762249
             les_mean =     514.395318829433
             stat err =       0.000278873684
             autocorr =       1.250673157788
              std dev =       0.705310928456
             le_variance =       0.497463505799


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy-2.266901276225e+01 
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.5000e-01, overlap shift 2.5000e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.669012762273       residual = 3.44e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.669088668072       residual = 1.51e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.669090642396       residual = 4.48e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.669091255197       residual = 7.69e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 2.5000e-01 is 2.007069e-03

solving harmonic davidson linear method for identity shift 1.0000e+00, overlap shift 1.0000e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.669012762273       residual = 3.44e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.669038870601       residual = 6.66e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.669038977096       residual = 1.09e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.669039079451       residual = 2.33e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 1.0000e+00 is 5.826295e-04

solving harmonic davidson linear method for identity shift 4.0000e+00, overlap shift 4.0000e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.669012762273       residual = 3.44e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.669019966187       residual = 5.73e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.669019979605       residual = 1.28e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.669020003899       residual = 2.17e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 4.0000e+00 is 1.573874e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.003527 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.2408e+02
  </log>
  <optVariables href="FORM.s000.opt.xml">
ci_001 -7.056468e-01                3 1 ON  0
ci_002 -7.036396e-01                3 1 ON  1
ci_003 -4.890855e-02                3 1 ON  2
ci_004 -4.881711e-02                3 1 ON  3
ci_005 1.792796e-02                 3 1 ON  4
ci_006 1.790330e-02                 3 1 ON  5
ci_007 1.486685e-02                 3 1 ON  6
ci_008 1.500327e-02                 3 1 ON  7
ci_009 -1.231316e-02                3 1 ON  8
ci_010 -1.267934e-02                3 1 ON  9
ci_011 -9.735198e-03                3 1 ON  10
ci_012 -9.936180e-03                3 1 ON  11
ci_013 1.037411e-02                 3 1 ON  12
ci_014 1.094449e-02                 3 1 ON  13
ci_015 1.350703e-02                 3 1 ON  14
ci_016 1.371150e-02                 3 1 ON  15
ci_017 1.098337e-02                 3 1 ON  16
ci_018 1.132125e-02                 3 1 ON  17
ci_019 1.226656e-03                 3 1 ON  18
ci_020 1.703562e-03                 3 1 ON  19
ci_021 -7.886355e-03                3 1 ON  20
ci_022 -8.639274e-03                3 1 ON  21
ci_023 7.899169e-03                 3 1 ON  22
ci_024 7.672344e-03                 3 1 ON  23
ci_025 4.110341e-03                 3 1 ON  24
ci_026 3.532492e-03                 3 1 ON  25
ci_027 5.995449e-03                 3 1 ON  26
ci_028 6.679434e-03                 3 1 ON  27
ci_029 -5.179745e-03                3 1 ON  28
ci_030 -5.163995e-03                3 1 ON  29
ci_031 -7.566589e-03                3 1 ON  30
ci_032 -7.842997e-03                3 1 ON  31
ci_033 5.075857e-03                 3 1 ON  32
ci_034 4.448317e-03                 3 1 ON  33
ci_035 1.642379e-03                 3 1 ON  34
ci_036 1.774938e-03                 3 1 ON  35
ci_037 5.275784e-03                 3 1 ON  36
ci_038 5.649576e-03                 3 1 ON  37
ci_039 5.255560e-03                 3 1 ON  38
ci_040 5.159354e-03                 3 1 ON  39
ci_041 5.093148e-03                 3 1 ON  40
ci_042 4.737847e-03                 3 1 ON  41
ci_043 5.354034e-03                 3 1 ON  42
ci_044 5.106106e-03                 3 1 ON  43
ci_045 3.159255e-03                 3 1 ON  44
ci_046 3.287213e-03                 3 1 ON  45
ci_047 -8.991784e-04                3 1 ON  46
ci_048 -9.091374e-04                3 1 ON  47
ci_049 1.575588e-03                 3 1 ON  48
ci_050 1.863059e-03                 3 1 ON  49
ci_051 -2.000902e-03                3 1 ON  50
ci_052 -2.118384e-03                3 1 ON  51
ci_053 -2.417428e-03                3 1 ON  52
ci_054 -1.946437e-03                3 1 ON  53
ci_055 -1.597661e-03                3 1 ON  54
ci_056 -1.650479e-03                3 1 ON  55
ci_057 -1.152530e-03                3 1 ON  56
ci_058 -1.587696e-03                3 1 ON  57
ci_059 2.677535e-04                 3 1 ON  58
ci_060 4.677661e-04                 3 1 ON  59
ci_061 -6.078308e-04                3 1 ON  60
ci_062 -4.865567e-04                3 1 ON  61
ci_063 -8.290581e-04                3 1 ON  62
ci_064 -1.075068e-04                3 1 ON  63
ci_065 -2.670283e-03                3 1 ON  64
ci_066 -2.518370e-03                3 1 ON  65
ci_067 -2.589490e-03                3 1 ON  66
ci_068 -2.513769e-03                3 1 ON  67
ci_069 3.450326e-04                 3 1 ON  68
ci_070 2.105988e-04                 3 1 ON  69
ci_071 -2.241711e-03                3 1 ON  70
ci_072 -2.324959e-03                3 1 ON  71
ci_073 1.833165e-04                 3 1 ON  72
ci_074 2.980546e-04                 3 1 ON  73
ci_075 -3.214114e-04                3 1 ON  74
ci_076 -2.760279e-04                3 1 ON  75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="250">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =8000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 0
    time step          = 0.05
    reference energy   = -22.5604
    reference variance = 0.47489
====================================================
  Execution time = 1.0207e+02
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s000
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 62500 
  VMC Eavg = -2.2670e+01
  VMC Evar = 5.1531e-01
  Total weights = 7.8203e+06
  Execution time = 1.4757e+01
  </log>
</opt>
<opt stage="main" walkers="62500">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

ERROR CostFunction-> Number of Effective Walkers is too small! 
  Number of effective walkers (samples) / total number of samples = 1.96219e-05
  User specified threshold minwalkers = 0.3
  If this message appears frequently. You might have to be cautious. 
  Find info about parameter "minwalkers" in the user manual!
Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.499024082228
                                         uncertainty =       0.002072914324

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.499024082228
                                         uncertainty =       0.002072914324

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000249755833
  error estimate for blocks of size 2^( 2) =       0.000258743147
  error estimate for blocks of size 2^( 3) =       0.000266605512
  error estimate for blocks of size 2^( 4) =       0.000272289437
  error estimate for blocks of size 2^( 5) =       0.000275451440
  error estimate for blocks of size 2^( 6) =       0.000276938693
  error estimate for blocks of size 2^( 7) =       0.000278455163
  error estimate for blocks of size 2^( 8) =       0.000278038924
  error estimate for blocks of size 2^( 9) =       0.000278071852

      target function =                  N/A
              le_mean =     -22.669831781011
             les_mean =     514.437123964185
             stat err =       0.000277876158
             autocorr =       1.237859315331
              std dev =       0.706416173561
             le_variance =       0.499023810269

ERROR CostFunction-> Number of Effective Walkers is too small! 
  Number of effective walkers (samples) / total number of samples = 1.75477e-05
  User specified threshold minwalkers = 0.3
  If this message appears frequently. You might have to be cautious. 
  Find info about parameter "minwalkers" in the user manual!
Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.505139932895
                                         uncertainty =       0.006261222975

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.505139932895
                                         uncertainty =       0.006261222975

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000251280132
  error estimate for blocks of size 2^( 2) =       0.000260220539
  error estimate for blocks of size 2^( 3) =       0.000268025372
  error estimate for blocks of size 2^( 4) =       0.000273681154
  error estimate for blocks of size 2^( 5) =       0.000276785214
  error estimate for blocks of size 2^( 6) =       0.000278270806
  error estimate for blocks of size 2^( 7) =       0.000279745977
  error estimate for blocks of size 2^( 8) =       0.000279397791
  error estimate for blocks of size 2^( 9) =       0.000279462557

      target function =                  N/A
              le_mean =     -22.669866908117
             les_mean =     522.271781665826
             stat err =       0.000279219283
             autocorr =       1.234737144687
              std dev =       0.710727539877
             le_variance =       0.505133635940

ERROR CostFunction-> Number of Effective Walkers is too small! 
  Number of effective walkers (samples) / total number of samples = 1.96184e-05
  User specified threshold minwalkers = 0.3
  If this message appears frequently. You might have to be cautious. 
  Find info about parameter "minwalkers" in the user manual!
Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.499004627981
                                         uncertainty =       0.002189377651

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.499004627981
                                         uncertainty =       0.002189377651

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000249750925
  error estimate for blocks of size 2^( 2) =       0.000258740226
  error estimate for blocks of size 2^( 3) =       0.000266600995
  error estimate for blocks of size 2^( 4) =       0.000272284805
  error estimate for blocks of size 2^( 5) =       0.000275446464
  error estimate for blocks of size 2^( 6) =       0.000276934738
  error estimate for blocks of size 2^( 7) =       0.000278458497
  error estimate for blocks of size 2^( 8) =       0.000278038302
  error estimate for blocks of size 2^( 9) =       0.000278067377

      target function =                  N/A
              le_mean =     -22.669827688751
             les_mean =     514.451006411220
             stat err =       0.000277874728
             autocorr =       1.237895232109
              std dev =       0.706402291952
             le_variance =       0.499004198075

ERROR CostFunction-> Number of Effective Walkers is too small! 
  Number of effective walkers (samples) / total number of samples = 2.35038e-05
  User specified threshold minwalkers = 0.3
  If this message appears frequently. You might have to be cautious. 
  Find info about parameter "minwalkers" in the user manual!
Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.498995188119
                                         uncertainty =       0.002083145173

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.498995188119
                                         uncertainty =       0.002083145173

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000249748599
  error estimate for blocks of size 2^( 2) =       0.000258736142
  error estimate for blocks of size 2^( 3) =       0.000266598233
  error estimate for blocks of size 2^( 4) =       0.000272282231
  error estimate for blocks of size 2^( 5) =       0.000275444307
  error estimate for blocks of size 2^( 6) =       0.000276932271
  error estimate for blocks of size 2^( 7) =       0.000278450906
  error estimate for blocks of size 2^( 8) =       0.000278035032
  error estimate for blocks of size 2^( 9) =       0.000278067979

      target function =                  N/A
              le_mean =     -22.669829033367
             les_mean =     514.437999924582
             stat err =       0.000277871547
             autocorr =       1.237889950784
              std dev =       0.706395711235
             le_variance =       0.498994900852


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.669831781011        initial
     2.5000e-01     2.5000e+00             2.0071e-03       -22.669866908117  <--
     1.0000e+00     1.0000e+01             5.8263e-04       -22.669827688751
     4.0000e+00     4.0000e+01             1.5739e-04       -22.669829033367

*****************************************************************************
Applying the update for shift_i =   2.5000e-01     and shift_s =   2.5000e+00
*****************************************************************************

  Execution time = 1.7599e+02
  </log>
  <optVariables href="FORM.s000.opt.xml">
ci_001                -7.058440e-01 3 1  ON 0
ci_002                -7.037850e-01 3 1  ON 1
ci_003                -4.748411e-02 3 1  ON 2
ci_004                -4.742714e-02 3 1  ON 3
ci_005                 1.729549e-02 3 1  ON 4
ci_006                 1.726921e-02 3 1  ON 5
ci_007                 1.382803e-02 3 1  ON 6
ci_008                 1.433206e-02 3 1  ON 7
ci_009                -1.178065e-02 3 1  ON 8
ci_010                -1.233520e-02 3 1  ON 9
ci_011                -9.406577e-03 3 1  ON 10
ci_012                -9.341095e-03 3 1  ON 11
ci_013                 1.004617e-02 3 1  ON 12
ci_014                 1.055714e-02 3 1  ON 13
ci_015                 1.318931e-02 3 1  ON 14
ci_016                 1.352610e-02 3 1  ON 15
ci_017                 1.083454e-02 3 1  ON 16
ci_018                 1.131319e-02 3 1  ON 17
ci_019                 2.171925e-04 3 1  ON 18
ci_020                 7.167349e-04 3 1  ON 19
ci_021                -8.143191e-03 3 1  ON 20
ci_022                -8.560419e-03 3 1  ON 21
ci_023                 7.745819e-03 3 1  ON 22
ci_024                 7.513992e-03 3 1  ON 23
ci_025                 4.046372e-03 3 1  ON 24
ci_026                 3.538036e-03 3 1  ON 25
ci_027                 5.792569e-03 3 1  ON 26
ci_028                 6.691847e-03 3 1  ON 27
ci_029                -4.499430e-03 3 1  ON 28
ci_030                -4.875952e-03 3 1  ON 29
ci_031                -7.772401e-03 3 1  ON 30
ci_032                -7.762317e-03 3 1  ON 31
ci_033                 5.119841e-03 3 1  ON 32
ci_034                 4.340255e-03 3 1  ON 33
ci_035                 1.619868e-03 3 1  ON 34
ci_036                 1.618519e-03 3 1  ON 35
ci_037                 5.199220e-03 3 1  ON 36
ci_038                 5.728737e-03 3 1  ON 37
ci_039                 5.285433e-03 3 1  ON 38
ci_040                 5.177091e-03 3 1  ON 39
ci_041                 4.986862e-03 3 1  ON 40
ci_042                 4.868113e-03 3 1  ON 41
ci_043                 5.032951e-03 3 1  ON 42
ci_044                 5.094926e-03 3 1  ON 43
ci_045                 3.024192e-03 3 1  ON 44
ci_046                 3.446906e-03 3 1  ON 45
ci_047                -7.719712e-04 3 1  ON 46
ci_048                -6.475038e-04 3 1  ON 47
ci_049                 1.910286e-03 3 1  ON 48
ci_050                 1.655184e-03 3 1  ON 49
ci_051                -1.673987e-03 3 1  ON 50
ci_052                -1.934150e-03 3 1  ON 51
ci_053                -2.271246e-03 3 1  ON 52
ci_054                -2.114783e-03 3 1  ON 53
ci_055                -1.636037e-03 3 1  ON 54
ci_056                -1.921684e-03 3 1  ON 55
ci_057                -1.174257e-03 3 1  ON 56
ci_058                -1.579886e-03 3 1  ON 57
ci_059                 3.313369e-04 3 1  ON 58
ci_060                 5.282306e-04 3 1  ON 59
ci_061                -5.127026e-04 3 1  ON 60
ci_062                -5.592435e-04 3 1  ON 61
ci_063                -9.123704e-04 3 1  ON 62
ci_064                -2.295834e-04 3 1  ON 63
ci_065                -2.465366e-03 3 1  ON 64
ci_066                -2.478794e-03 3 1  ON 65
ci_067                -2.621972e-03 3 1  ON 66
ci_068                -2.214072e-03 3 1  ON 67
ci_069                 4.500879e-04 3 1  ON 68
ci_070                 2.258861e-05 3 1  ON 69
ci_071                -2.078540e-03 3 1  ON 70
ci_072                -2.324795e-03 3 1  ON 71
ci_073                 1.643794e-05 3 1  ON 72
ci_074                 2.632991e-04 3 1  ON 73
ci_075                -1.213285e-04 3 1  ON 74
ci_076                -2.476867e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 3.0010e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s001 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s001 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=1  my_counter=0
  time step      = 5.0000e-02
  blocks         = 250
  steps          = 250
  substeps       = 10
  current        = 0
  target samples = 8.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">250</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">6.2500e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">8.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">6.2500e+04</parameter>
<parameter name="steps" condition="int">250</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2619e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="250">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =8000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 1
    time step          = 0.05
    reference energy   = -22.6732
    reference variance = 0.292737
====================================================
  Execution time = 1.0455e+02
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s001
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 62500 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 6.1102e+04
  VMC Eavg = -2.2669e+01
  VMC Evar = 5.0980e-01
  Total weights = 7.820393722e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.9175e+01
  </log>
</opt>
<opt stage="main" walkers="62500">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.496538767489
                                         uncertainty =       0.001739953569

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.496538767489
                                         uncertainty =       0.001739953569

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000249132882
  error estimate for blocks of size 2^( 2) =       0.000258121142
  error estimate for blocks of size 2^( 3) =       0.000266111829
  error estimate for blocks of size 2^( 4) =       0.000272028847
  error estimate for blocks of size 2^( 5) =       0.000275275012
  error estimate for blocks of size 2^( 6) =       0.000276784772
  error estimate for blocks of size 2^( 7) =       0.000277703518
  error estimate for blocks of size 2^( 8) =       0.000278118044
  error estimate for blocks of size 2^( 9) =       0.000279316976

      target function =                  N/A
              le_mean =     -22.669294768079
             les_mean =     514.406726560474
             stat err =       0.000277980828
             autocorr =       1.244994929411
              std dev =       0.704654201606
             le_variance =       0.496537543841


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266929476808e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.2500e-02, overlap shift 6.2500e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.669294768104       residual = 5.37e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.669301424122       residual = 1.13e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.669359810042       residual = 1.60e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.669370205254       residual = 1.71e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.669371352600       residual = 1.22e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.669371272733       residual = 1.39e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.669371220123       residual = 4.10e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 6.2500e-02 is 4.352058e-03

solving harmonic davidson linear method for identity shift 2.5000e-01, overlap shift 2.5000e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.669294768104       residual = 5.37e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.669298739910       residual = 1.05e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.669327404954       residual = 4.65e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.669329023551       residual = 1.16e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.669329122340       residual = 1.84e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          4 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 2.5000e-01 is 2.020041e-03

solving harmonic davidson linear method for identity shift 1.0000e+00, overlap shift 1.0000e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.669294768104       residual = 5.37e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.669296288061       residual = 9.95e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.669305764197       residual = 2.09e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.669305887229       residual = 2.92e-08           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.669305909733       residual = 5.12e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          4 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 1.0000e+00 is 7.654291e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.006122 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.2374e+02
  </log>
  <optVariables href="FORM.s001.opt.xml">
ci_001                -7.061321e-01 3 1  ON 0
ci_002                -7.038185e-01 3 1  ON 1
ci_003                -4.595600e-02 3 1  ON 2
ci_004                -4.578954e-02 3 1  ON 3
ci_005                 1.646572e-02 3 1  ON 4
ci_006                 1.675038e-02 3 1  ON 5
ci_007                 1.327990e-02 3 1  ON 6
ci_008                 1.350922e-02 3 1  ON 7
ci_009                -1.102214e-02 3 1  ON 8
ci_010                -1.202677e-02 3 1  ON 9
ci_011                -8.945350e-03 3 1  ON 10
ci_012                -8.815242e-03 3 1  ON 11
ci_013                 9.721873e-03 3 1  ON 12
ci_014                 9.930943e-03 3 1  ON 13
ci_015                 1.345084e-02 3 1  ON 14
ci_016                 1.334894e-02 3 1  ON 15
ci_017                 1.062009e-02 3 1  ON 16
ci_018                 1.171477e-02 3 1  ON 17
ci_019                -7.282309e-04 3 1  ON 18
ci_020                -1.376532e-04 3 1  ON 19
ci_021                -8.342531e-03 3 1  ON 20
ci_022                -8.515984e-03 3 1  ON 21
ci_023                 7.816957e-03 3 1  ON 22
ci_024                 7.509887e-03 3 1  ON 23
ci_025                 4.049866e-03 3 1  ON 24
ci_026                 3.449346e-03 3 1  ON 25
ci_027                 6.769103e-03 3 1  ON 26
ci_028                 6.618778e-03 3 1  ON 27
ci_029                -3.394618e-03 3 1  ON 28
ci_030                -5.020415e-03 3 1  ON 29
ci_031                -8.192575e-03 3 1  ON 30
ci_032                -7.730677e-03 3 1  ON 31
ci_033                 5.136389e-03 3 1  ON 32
ci_034                 3.207701e-03 3 1  ON 33
ci_035                 1.487304e-03 3 1  ON 34
ci_036                 1.634782e-03 3 1  ON 35
ci_037                 5.192070e-03 3 1  ON 36
ci_038                 5.403921e-03 3 1  ON 37
ci_039                 5.391158e-03 3 1  ON 38
ci_040                 5.380966e-03 3 1  ON 39
ci_041                 5.246005e-03 3 1  ON 40
ci_042                 5.215653e-03 3 1  ON 41
ci_043                 4.953442e-03 3 1  ON 42
ci_044                 4.967967e-03 3 1  ON 43
ci_045                 2.987252e-03 3 1  ON 44
ci_046                 2.399462e-03 3 1  ON 45
ci_047                -8.665424e-04 3 1  ON 46
ci_048                -7.507050e-04 3 1  ON 47
ci_049                 1.640489e-03 3 1  ON 48
ci_050                 2.008830e-03 3 1  ON 49
ci_051                -1.492227e-03 3 1  ON 50
ci_052                -1.750499e-03 3 1  ON 51
ci_053                -2.827963e-03 3 1  ON 52
ci_054                -2.243605e-03 3 1  ON 53
ci_055                -1.759019e-03 3 1  ON 54
ci_056                -2.061119e-03 3 1  ON 55
ci_057                -1.357202e-03 3 1  ON 56
ci_058                -1.464605e-03 3 1  ON 57
ci_059                 3.777688e-04 3 1  ON 58
ci_060                 3.225174e-04 3 1  ON 59
ci_061                -3.643529e-04 3 1  ON 60
ci_062                -4.627086e-04 3 1  ON 61
ci_063                -9.104617e-04 3 1  ON 62
ci_064                -2.167410e-04 3 1  ON 63
ci_065                -4.453254e-04 3 1  ON 64
ci_066                -2.437800e-03 3 1  ON 65
ci_067                -2.840972e-03 3 1  ON 66
ci_068                -2.348868e-03 3 1  ON 67
ci_069                 1.290182e-03 3 1  ON 68
ci_070                 2.046354e-04 3 1  ON 69
ci_071                -1.889048e-03 3 1  ON 70
ci_072                -2.315276e-03 3 1  ON 71
ci_073                -2.191870e-05 3 1  ON 72
ci_074                 2.866535e-04 3 1  ON 73
ci_075                 2.665578e-04 3 1  ON 74
ci_076                -3.476442e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="250">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =8000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 1
    time step          = 0.05
    reference energy   = -22.7269
    reference variance = 0.410797
====================================================
  Execution time = 1.0188e+02
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s001
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 62500 
  VMC Eavg = -2.2670e+01
  VMC Evar = 5.1337e-01
  Total weights = 7.8199e+06
  Execution time = 1.4761e+01
  </log>
</opt>
<opt stage="main" walkers="62500">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

ERROR CostFunction-> Number of Effective Walkers is too small! 
  Number of effective walkers (samples) / total number of samples = 0.0114949
  User specified threshold minwalkers = 0.3
  If this message appears frequently. You might have to be cautious. 
  Find info about parameter "minwalkers" in the user manual!
Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.515573197339
                                         uncertainty =       0.013159908616

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.515573197339
                                         uncertainty =       0.013159908616

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000253870593
  error estimate for blocks of size 2^( 2) =       0.000262621997
  error estimate for blocks of size 2^( 3) =       0.000270441370
  error estimate for blocks of size 2^( 4) =       0.000276284713
  error estimate for blocks of size 2^( 5) =       0.000279672648
  error estimate for blocks of size 2^( 6) =       0.000281709681
  error estimate for blocks of size 2^( 7) =       0.000282349492
  error estimate for blocks of size 2^( 8) =       0.000283530252
  error estimate for blocks of size 2^( 9) =       0.000283983349

      target function =                  N/A
              le_mean =     -22.670077482115
             les_mean =     515.382189094370
             stat err =       0.000282893193
             autocorr =       1.241710067709
              std dev =       0.718054470715
             le_variance =       0.515602222914

ERROR CostFunction-> Number of Effective Walkers is too small! 
  Number of effective walkers (samples) / total number of samples = 0.00444931
  User specified threshold minwalkers = 0.3
  If this message appears frequently. You might have to be cautious. 
  Find info about parameter "minwalkers" in the user manual!
Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.501855227290
                                         uncertainty =       0.001688722233

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.501855227290
                                         uncertainty =       0.001688722233

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000250465116
  error estimate for blocks of size 2^( 2) =       0.000259347882
  error estimate for blocks of size 2^( 3) =       0.000267251216
  error estimate for blocks of size 2^( 4) =       0.000273164052
  error estimate for blocks of size 2^( 5) =       0.000276540906
  error estimate for blocks of size 2^( 6) =       0.000278625161
  error estimate for blocks of size 2^( 7) =       0.000279342374
  error estimate for blocks of size 2^( 8) =       0.000280446870
  error estimate for blocks of size 2^( 9) =       0.000281140127

      target function =                  N/A
              le_mean =     -22.669978701177
             les_mean =     514.632123468726
             stat err =       0.000279888633
             autocorr =       1.248751512101
              std dev =       0.708422327650
             le_variance =       0.501862194314

ERROR CostFunction-> Number of Effective Walkers is too small! 
  Number of effective walkers (samples) / total number of samples = 0.0113543
  User specified threshold minwalkers = 0.3
  If this message appears frequently. You might have to be cautious. 
  Find info about parameter "minwalkers" in the user manual!
Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.501274405323
                                         uncertainty =       0.001540684592

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.501274405323
                                         uncertainty =       0.001540684592

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000250319944
  error estimate for blocks of size 2^( 2) =       0.000259210780
  error estimate for blocks of size 2^( 3) =       0.000267118167
  error estimate for blocks of size 2^( 4) =       0.000273016325
  error estimate for blocks of size 2^( 5) =       0.000276399016
  error estimate for blocks of size 2^( 6) =       0.000278484957
  error estimate for blocks of size 2^( 7) =       0.000279202459
  error estimate for blocks of size 2^( 8) =       0.000280270943
  error estimate for blocks of size 2^( 9) =       0.000280919661

      target function =                  N/A
              le_mean =     -22.669997746891
             les_mean =     514.520471061009
             stat err =       0.000279719505
             autocorr =       1.248689892608
              std dev =       0.708011719750
             le_variance =       0.501280595304

ERROR CostFunction-> Number of Effective Walkers is too small! 
  Number of effective walkers (samples) / total number of samples = 0.052744
  User specified threshold minwalkers = 0.3
  If this message appears frequently. You might have to be cautious. 
  Find info about parameter "minwalkers" in the user manual!
Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.501348093200
                                         uncertainty =       0.001598193279

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.501348093200
                                         uncertainty =       0.001598193279

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000250338242
  error estimate for blocks of size 2^( 2) =       0.000259223117
  error estimate for blocks of size 2^( 3) =       0.000267141167
  error estimate for blocks of size 2^( 4) =       0.000273057625
  error estimate for blocks of size 2^( 5) =       0.000276438555
  error estimate for blocks of size 2^( 6) =       0.000278509618
  error estimate for blocks of size 2^( 7) =       0.000279200638
  error estimate for blocks of size 2^( 8) =       0.000280286852
  error estimate for blocks of size 2^( 9) =       0.000280931461

      target function =                  N/A
              le_mean =     -22.669999541153
             les_mean =     514.746454132346
             stat err =       0.000279732142
             autocorr =       1.248620169502
              std dev =       0.708063474446
             le_variance =       0.501353883845


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.670077482115        initial  <--
     6.2500e-02     6.2500e-01             4.3521e-03       -22.669978701177
     2.5000e-01     2.5000e+00             2.0200e-03       -22.669997746891
     1.0000e+00     1.0000e+01             7.6543e-04       -22.669999541153

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 175.7875
  </log>
  <optVariables href="FORM.s001.opt.xml">
ci_001                -7.058440e-01 3 1  ON 0
ci_002                -7.037850e-01 3 1  ON 1
ci_003                -4.748411e-02 3 1  ON 2
ci_004                -4.742714e-02 3 1  ON 3
ci_005                 1.729549e-02 3 1  ON 4
ci_006                 1.726921e-02 3 1  ON 5
ci_007                 1.382803e-02 3 1  ON 6
ci_008                 1.433206e-02 3 1  ON 7
ci_009                -1.178065e-02 3 1  ON 8
ci_010                -1.233520e-02 3 1  ON 9
ci_011                -9.406577e-03 3 1  ON 10
ci_012                -9.341095e-03 3 1  ON 11
ci_013                 1.004617e-02 3 1  ON 12
ci_014                 1.055714e-02 3 1  ON 13
ci_015                 1.318931e-02 3 1  ON 14
ci_016                 1.352610e-02 3 1  ON 15
ci_017                 1.083454e-02 3 1  ON 16
ci_018                 1.131319e-02 3 1  ON 17
ci_019                 2.171925e-04 3 1  ON 18
ci_020                 7.167349e-04 3 1  ON 19
ci_021                -8.143191e-03 3 1  ON 20
ci_022                -8.560419e-03 3 1  ON 21
ci_023                 7.745819e-03 3 1  ON 22
ci_024                 7.513992e-03 3 1  ON 23
ci_025                 4.046372e-03 3 1  ON 24
ci_026                 3.538036e-03 3 1  ON 25
ci_027                 5.792569e-03 3 1  ON 26
ci_028                 6.691847e-03 3 1  ON 27
ci_029                -4.499430e-03 3 1  ON 28
ci_030                -4.875952e-03 3 1  ON 29
ci_031                -7.772401e-03 3 1  ON 30
ci_032                -7.762317e-03 3 1  ON 31
ci_033                 5.119841e-03 3 1  ON 32
ci_034                 4.340255e-03 3 1  ON 33
ci_035                 1.619868e-03 3 1  ON 34
ci_036                 1.618519e-03 3 1  ON 35
ci_037                 5.199220e-03 3 1  ON 36
ci_038                 5.728737e-03 3 1  ON 37
ci_039                 5.285433e-03 3 1  ON 38
ci_040                 5.177091e-03 3 1  ON 39
ci_041                 4.986862e-03 3 1  ON 40
ci_042                 4.868113e-03 3 1  ON 41
ci_043                 5.032951e-03 3 1  ON 42
ci_044                 5.094926e-03 3 1  ON 43
ci_045                 3.024192e-03 3 1  ON 44
ci_046                 3.446906e-03 3 1  ON 45
ci_047                -7.719712e-04 3 1  ON 46
ci_048                -6.475038e-04 3 1  ON 47
ci_049                 1.910286e-03 3 1  ON 48
ci_050                 1.655184e-03 3 1  ON 49
ci_051                -1.673987e-03 3 1  ON 50
ci_052                -1.934150e-03 3 1  ON 51
ci_053                -2.271246e-03 3 1  ON 52
ci_054                -2.114783e-03 3 1  ON 53
ci_055                -1.636037e-03 3 1  ON 54
ci_056                -1.921684e-03 3 1  ON 55
ci_057                -1.174257e-03 3 1  ON 56
ci_058                -1.579886e-03 3 1  ON 57
ci_059                 3.313369e-04 3 1  ON 58
ci_060                 5.282306e-04 3 1  ON 59
ci_061                -5.127026e-04 3 1  ON 60
ci_062                -5.592435e-04 3 1  ON 61
ci_063                -9.123704e-04 3 1  ON 62
ci_064                -2.295834e-04 3 1  ON 63
ci_065                -2.465366e-03 3 1  ON 64
ci_066                -2.478794e-03 3 1  ON 65
ci_067                -2.621972e-03 3 1  ON 66
ci_068                -2.214072e-03 3 1  ON 67
ci_069                 4.500879e-04 3 1  ON 68
ci_070                 2.258861e-05 3 1  ON 69
ci_071                -2.078540e-03 3 1  ON 70
ci_072                -2.324795e-03 3 1  ON 71
ci_073                 1.643794e-05 3 1  ON 72
ci_074                 2.632991e-04 3 1  ON 73
ci_075                -1.213285e-04 3 1  ON 74
ci_076                -2.476867e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 2.9955e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s002 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s002 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=2  my_counter=0
  time step      = 5.0000e-02
  blocks         = 250
  steps          = 250
  substeps       = 10
  current        = 0
  target samples = 8.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">250</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">6.2500e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">8.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">6.2500e+04</parameter>
<parameter name="steps" condition="int">250</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2659e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="250">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =8000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 2
    time step          = 0.05
    reference energy   = -22.6751
    reference variance = 0.376914
====================================================
  Execution time = 1.0445e+02
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s002
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 62500 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 6.1156e+04
  VMC Eavg = -2.2670e+01
  VMC Evar = 5.1239e-01
  Total weights = 7.820413171e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.9052e+01
  </log>
</opt>
<opt stage="main" walkers="62500">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.498473030282
                                         uncertainty =       0.001549902111

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.498473030282
                                         uncertainty =       0.001549902111

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000249618432
  error estimate for blocks of size 2^( 2) =       0.000258539597
  error estimate for blocks of size 2^( 3) =       0.000266419834
  error estimate for blocks of size 2^( 4) =       0.000272240783
  error estimate for blocks of size 2^( 5) =       0.000275821563
  error estimate for blocks of size 2^( 6) =       0.000276984005
  error estimate for blocks of size 2^( 7) =       0.000277560894
  error estimate for blocks of size 2^( 8) =       0.000278057196
  error estimate for blocks of size 2^( 9) =       0.000278022647

      target function =                  N/A
              le_mean =     -22.669643475668
             les_mean =     514.425130070632
             stat err =       0.000277656185
             autocorr =       1.237261226056
              std dev =       0.706027544621
             le_variance =       0.498474893764


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266964347567e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.2500e-01, overlap shift 6.2500e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.669643475694       residual = 1.81e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.669663299738       residual = 3.90e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.669664250454       residual = 6.31e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.669664339896       residual = 9.78e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 6.2500e-01 is 7.947705e-04

solving harmonic davidson linear method for identity shift 2.5000e+00, overlap shift 2.5000e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.669643475694       residual = 1.81e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.669649169914       residual = 3.05e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.669649375466       residual = 5.09e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.669649402978       residual = 6.57e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 2.5000e+00 is 2.112905e-04

solving harmonic davidson linear method for identity shift 1.0000e+01, overlap shift 1.0000e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.669643475694       residual = 1.81e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.669644954309       residual = 3.06e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.669645003897       residual = 5.71e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.669645012238       residual = 7.64e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 1.0000e+01 is 5.370786e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.007465 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.2351e+02
  </log>
  <optVariables href="FORM.s002.opt.xml">
ci_001                -7.058737e-01 3 1  ON 0
ci_002                -7.037999e-01 3 1  ON 1
ci_003                -4.732011e-02 3 1  ON 2
ci_004                -4.721585e-02 3 1  ON 3
ci_005                 1.715749e-02 3 1  ON 4
ci_006                 1.719261e-02 3 1  ON 5
ci_007                 1.370548e-02 3 1  ON 6
ci_008                 1.420998e-02 3 1  ON 7
ci_009                -1.171727e-02 3 1  ON 8
ci_010                -1.230653e-02 3 1  ON 9
ci_011                -9.364498e-03 3 1  ON 10
ci_012                -9.228799e-03 3 1  ON 11
ci_013                 1.002476e-02 3 1  ON 12
ci_014                 1.047972e-02 3 1  ON 13
ci_015                 1.313548e-02 3 1  ON 14
ci_016                 1.343660e-02 3 1  ON 15
ci_017                 1.085154e-02 3 1  ON 16
ci_018                 1.131475e-02 3 1  ON 17
ci_019                 8.567676e-05 3 1  ON 18
ci_020                 5.901238e-04 3 1  ON 19
ci_021                -8.135288e-03 3 1  ON 20
ci_022                -8.545059e-03 3 1  ON 21
ci_023                 7.704604e-03 3 1  ON 22
ci_024                 7.558798e-03 3 1  ON 23
ci_025                 4.050069e-03 3 1  ON 24
ci_026                 3.564888e-03 3 1  ON 25
ci_027                 5.866439e-03 3 1  ON 26
ci_028                 6.738700e-03 3 1  ON 27
ci_029                -4.477855e-03 3 1  ON 28
ci_030                -4.791567e-03 3 1  ON 29
ci_031                -7.819921e-03 3 1  ON 30
ci_032                -7.687890e-03 3 1  ON 31
ci_033                 5.052719e-03 3 1  ON 32
ci_034                 4.315941e-03 3 1  ON 33
ci_035                 1.629512e-03 3 1  ON 34
ci_036                 1.628320e-03 3 1  ON 35
ci_037                 5.193965e-03 3 1  ON 36
ci_038                 5.722652e-03 3 1  ON 37
ci_039                 5.295325e-03 3 1  ON 38
ci_040                 5.169185e-03 3 1  ON 39
ci_041                 4.989585e-03 3 1  ON 40
ci_042                 4.858960e-03 3 1  ON 41
ci_043                 5.022668e-03 3 1  ON 42
ci_044                 5.095969e-03 3 1  ON 43
ci_045                 3.027239e-03 3 1  ON 44
ci_046                 3.421595e-03 3 1  ON 45
ci_047                -7.376143e-04 3 1  ON 46
ci_048                -6.428682e-04 3 1  ON 47
ci_049                 1.852110e-03 3 1  ON 48
ci_050                 1.656723e-03 3 1  ON 49
ci_051                -1.630639e-03 3 1  ON 50
ci_052                -1.916545e-03 3 1  ON 51
ci_053                -2.277312e-03 3 1  ON 52
ci_054                -2.161081e-03 3 1  ON 53
ci_055                -1.610863e-03 3 1  ON 54
ci_056                -1.887523e-03 3 1  ON 55
ci_057                -1.181975e-03 3 1  ON 56
ci_058                -1.587795e-03 3 1  ON 57
ci_059                 3.348158e-04 3 1  ON 58
ci_060                 5.118504e-04 3 1  ON 59
ci_061                -5.121853e-04 3 1  ON 60
ci_062                -5.436764e-04 3 1  ON 61
ci_063                -8.371493e-04 3 1  ON 62
ci_064                -2.679723e-04 3 1  ON 63
ci_065                -2.468911e-03 3 1  ON 64
ci_066                -2.457281e-03 3 1  ON 65
ci_067                -2.620223e-03 3 1  ON 66
ci_068                -2.287790e-03 3 1  ON 67
ci_069                 4.020118e-04 3 1  ON 68
ci_070                -4.884691e-05 3 1  ON 69
ci_071                -2.046059e-03 3 1  ON 70
ci_072                -2.273342e-03 3 1  ON 71
ci_073                 5.336182e-05 3 1  ON 72
ci_074                 3.005074e-04 3 1  ON 73
ci_075                -1.380918e-04 3 1  ON 74
ci_076                -2.660267e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="250">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =8000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 2
    time step          = 0.05
    reference energy   = -22.7427
    reference variance = 0.647496
====================================================
  Execution time = 1.0259e+02
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s002
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 62500 
  VMC Eavg = -2.2670e+01
  VMC Evar = 5.0911e-01
  Total weights = 7.8207e+06
  Execution time = 1.4735e+01
  </log>
</opt>
<opt stage="main" walkers="62500">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.495210240428
                                         uncertainty =       0.001666820797

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.495210240428
                                         uncertainty =       0.001666820797

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000248799565
  error estimate for blocks of size 2^( 2) =       0.000257752219
  error estimate for blocks of size 2^( 3) =       0.000265693588
  error estimate for blocks of size 2^( 4) =       0.000271495293
  error estimate for blocks of size 2^( 5) =       0.000275059979
  error estimate for blocks of size 2^( 6) =       0.000276749783
  error estimate for blocks of size 2^( 7) =       0.000278542891
  error estimate for blocks of size 2^( 8) =       0.000279328310
  error estimate for blocks of size 2^( 9) =       0.000279959577

      target function =                  N/A
              le_mean =     -22.669516789392
             les_mean =     514.416482854989
             stat err =       0.000278645141
             autocorr =       1.254306619320
              std dev =       0.703711438057
             le_variance =       0.495209788053

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.495161738491
                                         uncertainty =       0.001686101255

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.495161738491
                                         uncertainty =       0.001686101255

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000248787407
  error estimate for blocks of size 2^( 2) =       0.000257739907
  error estimate for blocks of size 2^( 3) =       0.000265681737
  error estimate for blocks of size 2^( 4) =       0.000271479494
  error estimate for blocks of size 2^( 5) =       0.000275047810
  error estimate for blocks of size 2^( 6) =       0.000276732316
  error estimate for blocks of size 2^( 7) =       0.000278520377
  error estimate for blocks of size 2^( 8) =       0.000279303347
  error estimate for blocks of size 2^( 9) =       0.000279918548

      target function =                  N/A
              le_mean =     -22.669523639227
             les_mean =     514.660879798859
             stat err =       0.000278618647
             autocorr =       1.254190679639
              std dev =       0.703677051466
             le_variance =       0.495161392760

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.495119344383
                                         uncertainty =       0.001675725603

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.495119344383
                                         uncertainty =       0.001675725603

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000248776740
  error estimate for blocks of size 2^( 2) =       0.000257730623
  error estimate for blocks of size 2^( 3) =       0.000265672976
  error estimate for blocks of size 2^( 4) =       0.000271473771
  error estimate for blocks of size 2^( 5) =       0.000275040124
  error estimate for blocks of size 2^( 6) =       0.000276728551
  error estimate for blocks of size 2^( 7) =       0.000278521343
  error estimate for blocks of size 2^( 8) =       0.000279305540
  error estimate for blocks of size 2^( 9) =       0.000279938974

      target function =                  N/A
              le_mean =     -22.669518762150
             les_mean =     514.416801485107
             stat err =       0.000278623602
             autocorr =       1.254342861001
              std dev =       0.703646878379
             le_variance =       0.495118929452

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.495196746157
                                         uncertainty =       0.001667878771

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.495196746157
                                         uncertainty =       0.001667878771

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000248796176
  error estimate for blocks of size 2^( 2) =       0.000257749014
  error estimate for blocks of size 2^( 3) =       0.000265690520
  error estimate for blocks of size 2^( 4) =       0.000271492074
  error estimate for blocks of size 2^( 5) =       0.000275057034
  error estimate for blocks of size 2^( 6) =       0.000276746681
  error estimate for blocks of size 2^( 7) =       0.000278539862
  error estimate for blocks of size 2^( 8) =       0.000279325292
  error estimate for blocks of size 2^( 9) =       0.000279956434

      target function =                  N/A
              le_mean =     -22.669516930942
             les_mean =     514.417290240563
             stat err =       0.000278642067
             autocorr =       1.254313117735
              std dev =       0.703701853451
             le_variance =       0.495196298551


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.669516789392        initial
     6.2500e-01     6.2500e+00             7.9477e-04       -22.669523639227  <--
     2.5000e+00     2.5000e+01             2.1129e-04       -22.669518762150
     1.0000e+01     1.0000e+02             5.3708e-05       -22.669516930942

*****************************************************************************
Applying the update for shift_i =   6.2500e-01     and shift_s =   6.2500e+00
*****************************************************************************

  Execution time = 1.7640e+02
  </log>
  <optVariables href="FORM.s002.opt.xml">
ci_001                -7.059534e-01 3 1  ON 0
ci_002                -7.038353e-01 3 1  ON 1
ci_003                -4.686808e-02 3 1  ON 2
ci_004                -4.663237e-02 3 1  ON 3
ci_005                 1.685779e-02 3 1  ON 4
ci_006                 1.702543e-02 3 1  ON 5
ci_007                 1.341205e-02 3 1  ON 6
ci_008                 1.391907e-02 3 1  ON 7
ci_009                -1.157076e-02 3 1  ON 8
ci_010                -1.223819e-02 3 1  ON 9
ci_011                -9.264993e-03 3 1  ON 10
ci_012                -8.956877e-03 3 1  ON 11
ci_013                 9.981801e-03 3 1  ON 12
ci_014                 1.029358e-02 3 1  ON 13
ci_015                 1.299874e-02 3 1  ON 14
ci_016                 1.320922e-02 3 1  ON 15
ci_017                 1.089994e-02 3 1  ON 16
ci_018                 1.132375e-02 3 1  ON 17
ci_019                -2.478909e-04 3 1  ON 18
ci_020                 2.656871e-04 3 1  ON 19
ci_021                -8.107955e-03 3 1  ON 20
ci_022                -8.510769e-03 3 1  ON 21
ci_023                 7.609059e-03 3 1  ON 22
ci_024                 7.660930e-03 3 1  ON 23
ci_025                 4.070621e-03 3 1  ON 24
ci_026                 3.643340e-03 3 1  ON 25
ci_027                 6.022188e-03 3 1  ON 26
ci_028                 6.834485e-03 3 1  ON 27
ci_029                -4.422360e-03 3 1  ON 28
ci_030                -4.590650e-03 3 1  ON 29
ci_031                -7.939996e-03 3 1  ON 30
ci_032                -7.504715e-03 3 1  ON 31
ci_033                 4.889387e-03 3 1  ON 32
ci_034                 4.258614e-03 3 1  ON 33
ci_035                 1.646411e-03 3 1  ON 34
ci_036                 1.643387e-03 3 1  ON 35
ci_037                 5.181355e-03 3 1  ON 36
ci_038                 5.704432e-03 3 1  ON 37
ci_039                 5.315936e-03 3 1  ON 38
ci_040                 5.153593e-03 3 1  ON 39
ci_041                 4.995737e-03 3 1  ON 40
ci_042                 4.838622e-03 3 1  ON 41
ci_043                 4.996709e-03 3 1  ON 42
ci_044                 5.094026e-03 3 1  ON 43
ci_045                 3.039966e-03 3 1  ON 44
ci_046                 3.362683e-03 3 1  ON 45
ci_047                -6.625804e-04 3 1  ON 46
ci_048                -6.308988e-04 3 1  ON 47
ci_049                 1.713226e-03 3 1  ON 48
ci_050                 1.659896e-03 3 1  ON 49
ci_051                -1.520401e-03 3 1  ON 50
ci_052                -1.869123e-03 3 1  ON 51
ci_053                -2.292921e-03 3 1  ON 52
ci_054                -2.279114e-03 3 1  ON 53
ci_055                -1.549498e-03 3 1  ON 54
ci_056                -1.799474e-03 3 1  ON 55
ci_057                -1.199710e-03 3 1  ON 56
ci_058                -1.605623e-03 3 1  ON 57
ci_059                 3.390920e-04 3 1  ON 58
ci_060                 4.746998e-04 3 1  ON 59
ci_061                -5.134021e-04 3 1  ON 60
ci_062                -5.075278e-04 3 1  ON 61
ci_063                -6.555017e-04 3 1  ON 62
ci_064                -3.649247e-04 3 1  ON 63
ci_065                -2.474712e-03 3 1  ON 64
ci_066                -2.409945e-03 3 1  ON 65
ci_067                -2.616100e-03 3 1  ON 66
ci_068                -2.465666e-03 3 1  ON 67
ci_069                 2.894854e-04 3 1  ON 68
ci_070                -2.171486e-04 3 1  ON 69
ci_071                -1.965003e-03 3 1  ON 70
ci_072                -2.147423e-03 3 1  ON 71
ci_073                 1.299197e-04 3 1  ON 72
ci_074                 3.795865e-04 3 1  ON 73
ci_075                -1.759907e-04 3 1  ON 74
ci_076                -3.069112e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 2.9992e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s003 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s003 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=3  my_counter=0
  time step      = 5.0000e-02
  blocks         = 250
  steps          = 250
  substeps       = 10
  current        = 0
  target samples = 8.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">250</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">6.2500e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">8.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">6.2500e+04</parameter>
<parameter name="steps" condition="int">250</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2676e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="250">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =8000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 3
    time step          = 0.05
    reference energy   = -22.7128
    reference variance = 0.238781
====================================================
  Execution time = 1.0390e+02
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s003
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 62500 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 6.1053e+04
  VMC Eavg = -2.2670e+01
  VMC Evar = 5.0830e-01
  Total weights = 7.820299929e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.9338e+01
  </log>
</opt>
<opt stage="main" walkers="62500">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.495213331103
                                         uncertainty =       0.001665340021

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.495213331103
                                         uncertainty =       0.001665340021

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000248800585
  error estimate for blocks of size 2^( 2) =       0.000257773935
  error estimate for blocks of size 2^( 3) =       0.000265943794
  error estimate for blocks of size 2^( 4) =       0.000271782002
  error estimate for blocks of size 2^( 5) =       0.000275022482
  error estimate for blocks of size 2^( 6) =       0.000276622621
  error estimate for blocks of size 2^( 7) =       0.000277621668
  error estimate for blocks of size 2^( 8) =       0.000278379391
  error estimate for blocks of size 2^( 9) =       0.000277535967

      target function =                  N/A
              le_mean =     -22.669868600121
             les_mean =     514.431242318251
             stat err =       0.000277539912
             autocorr =       1.244365891975
              std dev =       0.703714322151
             le_variance =       0.495213847200


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266986860012e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5625e-01, overlap shift 1.5625e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.669868600150       residual = 1.40e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.669904719273       residual = 9.63e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.669909868229       residual = 5.19e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.669910432517       residual = 1.34e-08           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.669910429541       residual = 6.99e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          4 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 1.5625e-01 is 2.090425e-03

solving harmonic davidson linear method for identity shift 6.2500e-01, overlap shift 6.2500e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.669868600150       residual = 1.40e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.669882488341       residual = 2.95e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.669883234268       residual = 5.27e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.669883291482       residual = 8.90e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 6.2500e-01 is 6.365992e-04

solving harmonic davidson linear method for identity shift 2.5000e+00, overlap shift 2.5000e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.669868600150       residual = 1.40e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.669872611798       residual = 2.05e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.669872719804       residual = 3.73e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.669872734876       residual = 6.58e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 2.5000e+00 is 1.678101e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.008929 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.2325e+02
  </log>
  <optVariables href="FORM.s003.opt.xml">
ci_001                -7.059404e-01 3 1  ON 0
ci_002                -7.039742e-01 3 1  ON 1
ci_003                -4.625771e-02 3 1  ON 2
ci_004                -4.599577e-02 3 1  ON 3
ci_005                 1.658022e-02 3 1  ON 4
ci_006                 1.670089e-02 3 1  ON 5
ci_007                 1.309299e-02 3 1  ON 6
ci_008                 1.369022e-02 3 1  ON 7
ci_009                -1.154650e-02 3 1  ON 8
ci_010                -1.205105e-02 3 1  ON 9
ci_011                -9.011303e-03 3 1  ON 10
ci_012                -8.755007e-03 3 1  ON 11
ci_013                 9.808181e-03 3 1  ON 12
ci_014                 1.018635e-02 3 1  ON 13
ci_015                 1.288613e-02 3 1  ON 14
ci_016                 1.302974e-02 3 1  ON 15
ci_017                 1.076471e-02 3 1  ON 16
ci_018                 1.125033e-02 3 1  ON 17
ci_019                -6.980130e-04 3 1  ON 18
ci_020                -1.750509e-04 3 1  ON 19
ci_021                -8.258661e-03 3 1  ON 20
ci_022                -8.621473e-03 3 1  ON 21
ci_023                 7.711403e-03 3 1  ON 22
ci_024                 7.899536e-03 3 1  ON 23
ci_025                 4.213634e-03 3 1  ON 24
ci_026                 3.593279e-03 3 1  ON 25
ci_027                 6.221982e-03 3 1  ON 26
ci_028                 6.628900e-03 3 1  ON 27
ci_029                -4.335761e-03 3 1  ON 28
ci_030                -4.544918e-03 3 1  ON 29
ci_031                -7.868119e-03 3 1  ON 30
ci_032                -7.545449e-03 3 1  ON 31
ci_033                 4.815383e-03 3 1  ON 32
ci_034                 4.331160e-03 3 1  ON 33
ci_035                 1.544587e-03 3 1  ON 34
ci_036                 1.442355e-03 3 1  ON 35
ci_037                 5.278546e-03 3 1  ON 36
ci_038                 5.495646e-03 3 1  ON 37
ci_039                 5.256696e-03 3 1  ON 38
ci_040                 5.224834e-03 3 1  ON 39
ci_041                 5.039094e-03 3 1  ON 40
ci_042                 4.610710e-03 3 1  ON 41
ci_043                 5.006687e-03 3 1  ON 42
ci_044                 5.237445e-03 3 1  ON 43
ci_045                 3.147778e-03 3 1  ON 44
ci_046                 3.375357e-03 3 1  ON 45
ci_047                -7.018767e-04 3 1  ON 46
ci_048                -6.217586e-04 3 1  ON 47
ci_049                 1.743278e-03 3 1  ON 48
ci_050                 1.657713e-03 3 1  ON 49
ci_051                -1.617359e-03 3 1  ON 50
ci_052                -1.697586e-03 3 1  ON 51
ci_053                -2.341512e-03 3 1  ON 52
ci_054                -2.498842e-03 3 1  ON 53
ci_055                -1.529969e-03 3 1  ON 54
ci_056                -1.611263e-03 3 1  ON 55
ci_057                -1.280988e-03 3 1  ON 56
ci_058                -1.591259e-03 3 1  ON 57
ci_059                 4.248818e-04 3 1  ON 58
ci_060                 4.301915e-04 3 1  ON 59
ci_061                -4.763929e-04 3 1  ON 60
ci_062                -3.304581e-04 3 1  ON 61
ci_063                -5.754303e-04 3 1  ON 62
ci_064                -3.460522e-04 3 1  ON 63
ci_065                -2.343607e-03 3 1  ON 64
ci_066                -2.598486e-03 3 1  ON 65
ci_067                -2.681597e-03 3 1  ON 66
ci_068                -2.328841e-03 3 1  ON 67
ci_069                 2.541162e-04 3 1  ON 68
ci_070                -1.568573e-04 3 1  ON 69
ci_071                -1.942695e-03 3 1  ON 70
ci_072                -2.111841e-03 3 1  ON 71
ci_073                 5.747032e-05 3 1  ON 72
ci_074                 4.408843e-04 3 1  ON 73
ci_075                -2.224161e-04 3 1  ON 74
ci_076                -2.499514e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="250">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =8000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 3
    time step          = 0.05
    reference energy   = -22.7518
    reference variance = 0.303418
====================================================
  Execution time = 1.0079e+02
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s003
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 62500 
  VMC Eavg = -2.2670e+01
  VMC Evar = 5.0870e-01
  Total weights = 7.8203e+06
  Execution time = 1.4694e+01
  </log>
</opt>
<opt stage="main" walkers="62500">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.495351404218
                                         uncertainty =       0.001709956551

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.495351404218
                                         uncertainty =       0.001709956551

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000248835660
  error estimate for blocks of size 2^( 2) =       0.000257922983
  error estimate for blocks of size 2^( 3) =       0.000266083244
  error estimate for blocks of size 2^( 4) =       0.000271902873
  error estimate for blocks of size 2^( 5) =       0.000275194541
  error estimate for blocks of size 2^( 6) =       0.000276799503
  error estimate for blocks of size 2^( 7) =       0.000277838430
  error estimate for blocks of size 2^( 8) =       0.000278853893
  error estimate for blocks of size 2^( 9) =       0.000279727628

      target function =                  N/A
              le_mean =     -22.669741364210
             les_mean =     514.475403323762
             stat err =       0.000278304863
             autocorr =       1.250882030903
              std dev =       0.703813531460
             le_variance =       0.495353487067

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.495044431577
                                         uncertainty =       0.001737470467

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.495044431577
                                         uncertainty =       0.001737470467

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000248758534
  error estimate for blocks of size 2^( 2) =       0.000257850284
  error estimate for blocks of size 2^( 3) =       0.000266010368
  error estimate for blocks of size 2^( 4) =       0.000271824241
  error estimate for blocks of size 2^( 5) =       0.000275111326
  error estimate for blocks of size 2^( 6) =       0.000276711411
  error estimate for blocks of size 2^( 7) =       0.000277755039
  error estimate for blocks of size 2^( 8) =       0.000278762166
  error estimate for blocks of size 2^( 9) =       0.000279623640

      target function =                  N/A
              le_mean =     -22.669742505816
             les_mean =     514.479183193079
             stat err =       0.000278213064
             autocorr =       1.250832220027
              std dev =       0.703595386457
             le_variance =       0.495046467844

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.511284849198
                                         uncertainty =       0.013103004370

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.511284849198
                                         uncertainty =       0.013103004370

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000252809757
  error estimate for blocks of size 2^( 2) =       0.000261761006
  error estimate for blocks of size 2^( 3) =       0.000269784545
  error estimate for blocks of size 2^( 4) =       0.000275509443
  error estimate for blocks of size 2^( 5) =       0.000278787202
  error estimate for blocks of size 2^( 6) =       0.000280432997
  error estimate for blocks of size 2^( 7) =       0.000281410934
  error estimate for blocks of size 2^( 8) =       0.000282193389
  error estimate for blocks of size 2^( 9) =       0.000283339416

      target function =                  N/A
              le_mean =     -22.669799142745
             les_mean =     541.199109239829
             stat err =       0.000281844184
             autocorr =       1.242883699881
              std dev =       0.715053974455
             le_variance =       0.511302186384

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.495290571326
                                         uncertainty =       0.001708730873

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.495290571326
                                         uncertainty =       0.001708730873

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000248820379
  error estimate for blocks of size 2^( 2) =       0.000257908660
  error estimate for blocks of size 2^( 3) =       0.000266068433
  error estimate for blocks of size 2^( 4) =       0.000271889756
  error estimate for blocks of size 2^( 5) =       0.000275181087
  error estimate for blocks of size 2^( 6) =       0.000276786949
  error estimate for blocks of size 2^( 7) =       0.000277825791
  error estimate for blocks of size 2^( 8) =       0.000278845373
  error estimate for blocks of size 2^( 9) =       0.000279716207

      target function =                  N/A
              le_mean =     -22.669740076358
             les_mean =     514.455306376161
             stat err =       0.000278293580
             autocorr =       1.250934239025
              std dev =       0.703770309497
             le_variance =       0.495292648530


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.669741364210        initial
     1.5625e-01     1.5625e+00             2.0904e-03       -22.669742505816
     6.2500e-01     6.2500e+00             6.3660e-04       -22.669799142745  <--
     2.5000e+00     2.5000e+01             1.6781e-04       -22.669740076358

*****************************************************************************
Applying the update for shift_i =   6.2500e-01     and shift_s =   6.2500e+00
*****************************************************************************

  Execution time = 1.7428e+02
  </log>
  <optVariables href="FORM.s003.opt.xml">
ci_001                -7.059404e-01 3 1  ON 0
ci_002                -7.039742e-01 3 1  ON 1
ci_003                -4.625771e-02 3 1  ON 2
ci_004                -4.599577e-02 3 1  ON 3
ci_005                 1.658022e-02 3 1  ON 4
ci_006                 1.670089e-02 3 1  ON 5
ci_007                 1.309299e-02 3 1  ON 6
ci_008                 1.369022e-02 3 1  ON 7
ci_009                -1.154650e-02 3 1  ON 8
ci_010                -1.205105e-02 3 1  ON 9
ci_011                -9.011303e-03 3 1  ON 10
ci_012                -8.755007e-03 3 1  ON 11
ci_013                 9.808181e-03 3 1  ON 12
ci_014                 1.018635e-02 3 1  ON 13
ci_015                 1.288613e-02 3 1  ON 14
ci_016                 1.302974e-02 3 1  ON 15
ci_017                 1.076471e-02 3 1  ON 16
ci_018                 1.125033e-02 3 1  ON 17
ci_019                -6.980130e-04 3 1  ON 18
ci_020                -1.750509e-04 3 1  ON 19
ci_021                -8.258661e-03 3 1  ON 20
ci_022                -8.621473e-03 3 1  ON 21
ci_023                 7.711403e-03 3 1  ON 22
ci_024                 7.899536e-03 3 1  ON 23
ci_025                 4.213634e-03 3 1  ON 24
ci_026                 3.593279e-03 3 1  ON 25
ci_027                 6.221982e-03 3 1  ON 26
ci_028                 6.628900e-03 3 1  ON 27
ci_029                -4.335761e-03 3 1  ON 28
ci_030                -4.544918e-03 3 1  ON 29
ci_031                -7.868119e-03 3 1  ON 30
ci_032                -7.545449e-03 3 1  ON 31
ci_033                 4.815383e-03 3 1  ON 32
ci_034                 4.331160e-03 3 1  ON 33
ci_035                 1.544587e-03 3 1  ON 34
ci_036                 1.442355e-03 3 1  ON 35
ci_037                 5.278546e-03 3 1  ON 36
ci_038                 5.495646e-03 3 1  ON 37
ci_039                 5.256696e-03 3 1  ON 38
ci_040                 5.224834e-03 3 1  ON 39
ci_041                 5.039094e-03 3 1  ON 40
ci_042                 4.610710e-03 3 1  ON 41
ci_043                 5.006687e-03 3 1  ON 42
ci_044                 5.237445e-03 3 1  ON 43
ci_045                 3.147778e-03 3 1  ON 44
ci_046                 3.375357e-03 3 1  ON 45
ci_047                -7.018767e-04 3 1  ON 46
ci_048                -6.217586e-04 3 1  ON 47
ci_049                 1.743278e-03 3 1  ON 48
ci_050                 1.657713e-03 3 1  ON 49
ci_051                -1.617359e-03 3 1  ON 50
ci_052                -1.697586e-03 3 1  ON 51
ci_053                -2.341512e-03 3 1  ON 52
ci_054                -2.498842e-03 3 1  ON 53
ci_055                -1.529969e-03 3 1  ON 54
ci_056                -1.611263e-03 3 1  ON 55
ci_057                -1.280988e-03 3 1  ON 56
ci_058                -1.591259e-03 3 1  ON 57
ci_059                 4.248818e-04 3 1  ON 58
ci_060                 4.301915e-04 3 1  ON 59
ci_061                -4.763929e-04 3 1  ON 60
ci_062                -3.304581e-04 3 1  ON 61
ci_063                -5.754303e-04 3 1  ON 62
ci_064                -3.460522e-04 3 1  ON 63
ci_065                -2.343607e-03 3 1  ON 64
ci_066                -2.598486e-03 3 1  ON 65
ci_067                -2.681597e-03 3 1  ON 66
ci_068                -2.328841e-03 3 1  ON 67
ci_069                 2.541162e-04 3 1  ON 68
ci_070                -1.568573e-04 3 1  ON 69
ci_071                -1.942695e-03 3 1  ON 70
ci_072                -2.111841e-03 3 1  ON 71
ci_073                 5.747032e-05 3 1  ON 72
ci_074                 4.408843e-04 3 1  ON 73
ci_075                -2.224161e-04 3 1  ON 74
ci_076                -2.499514e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 2.9755e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s004 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s004 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=4  my_counter=0
  time step      = 5.0000e-02
  blocks         = 250
  steps          = 250
  substeps       = 10
  current        = 0
  target samples = 8.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">250</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">6.2500e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">8.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">6.2500e+04</parameter>
<parameter name="steps" condition="int">250</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2690e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="250">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =8000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 4
    time step          = 0.05
    reference energy   = -22.579
    reference variance = 0.403447
====================================================
  Execution time = 1.0317e+02
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s004
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 62500 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 6.1067e+04
  VMC Eavg = -2.2670e+01
  VMC Evar = 5.1350e-01
  Total weights = 7.820540869e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.9177e+01
  </log>
</opt>
<opt stage="main" walkers="62500">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.501159906621
                                         uncertainty =       0.002990695913

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.501159906621
                                         uncertainty =       0.002990695913

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000250290546
  error estimate for blocks of size 2^( 2) =       0.000259087121
  error estimate for blocks of size 2^( 3) =       0.000267049627
  error estimate for blocks of size 2^( 4) =       0.000272871907
  error estimate for blocks of size 2^( 5) =       0.000276790141
  error estimate for blocks of size 2^( 6) =       0.000278072913
  error estimate for blocks of size 2^( 7) =       0.000278166065
  error estimate for blocks of size 2^( 8) =       0.000278693368
  error estimate for blocks of size 2^( 9) =       0.000278561513

      target function =                  N/A
              le_mean =     -22.669591815955
             les_mean =     514.423891693982
             stat err =       0.000278373465
             autocorr =       1.236991676930
              std dev =       0.707928569492
             le_variance =       0.501162859503


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266959181596e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5625e-01, overlap shift 1.5625e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.669591815979       residual = 8.25e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.669611003696       residual = 4.95e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.669612587393       residual = 2.83e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.669613251342       residual = 5.88e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 1.5625e-01 is 1.874733e-03

solving harmonic davidson linear method for identity shift 6.2500e-01, overlap shift 6.2500e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.669591815979       residual = 8.25e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.669598985610       residual = 1.28e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.669598834290       residual = 2.89e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.669598873261       residual = 8.52e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 6.2500e-01 is 5.745520e-04

solving harmonic davidson linear method for identity shift 2.5000e+00, overlap shift 2.5000e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.669591815979       residual = 8.25e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.669593861304       residual = 9.27e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.669593736573       residual = 2.69e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.669593750294       residual = 6.58e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 2.5000e+00 is 1.519213e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.010281 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.2236e+02
  </log>
  <optVariables href="FORM.s004.opt.xml">
ci_001                -7.060029e-01 3 1  ON 0
ci_002                -7.039980e-01 3 1  ON 1
ci_003                -4.576721e-02 3 1  ON 2
ci_004                -4.542122e-02 3 1  ON 3
ci_005                 1.645790e-02 3 1  ON 4
ci_006                 1.662480e-02 3 1  ON 5
ci_007                 1.296012e-02 3 1  ON 6
ci_008                 1.361450e-02 3 1  ON 7
ci_009                -1.155925e-02 3 1  ON 8
ci_010                -1.193694e-02 3 1  ON 9
ci_011                -9.013230e-03 3 1  ON 10
ci_012                -8.760860e-03 3 1  ON 11
ci_013                 9.660161e-03 3 1  ON 12
ci_014                 9.950062e-03 3 1  ON 13
ci_015                 1.276761e-02 3 1  ON 14
ci_016                 1.297276e-02 3 1  ON 15
ci_017                 1.086744e-02 3 1  ON 16
ci_018                 1.112968e-02 3 1  ON 17
ci_019                -1.014257e-03 3 1  ON 18
ci_020                -4.452206e-04 3 1  ON 19
ci_021                -8.279783e-03 3 1  ON 20
ci_022                -8.514295e-03 3 1  ON 21
ci_023                 7.499804e-03 3 1  ON 22
ci_024                 7.976008e-03 3 1  ON 23
ci_025                 4.141278e-03 3 1  ON 24
ci_026                 3.691380e-03 3 1  ON 25
ci_027                 6.278625e-03 3 1  ON 26
ci_028                 6.722586e-03 3 1  ON 27
ci_029                -4.431023e-03 3 1  ON 28
ci_030                -4.485996e-03 3 1  ON 29
ci_031                -7.933380e-03 3 1  ON 30
ci_032                -7.510714e-03 3 1  ON 31
ci_033                 4.777548e-03 3 1  ON 32
ci_034                 4.392695e-03 3 1  ON 33
ci_035                 1.397673e-03 3 1  ON 34
ci_036                 1.331765e-03 3 1  ON 35
ci_037                 5.210776e-03 3 1  ON 36
ci_038                 5.439309e-03 3 1  ON 37
ci_039                 5.519528e-03 3 1  ON 38
ci_040                 5.279491e-03 3 1  ON 39
ci_041                 5.138250e-03 3 1  ON 40
ci_042                 4.761502e-03 3 1  ON 41
ci_043                 4.866289e-03 3 1  ON 42
ci_044                 5.131600e-03 3 1  ON 43
ci_045                 3.397362e-03 3 1  ON 44
ci_046                 3.401039e-03 3 1  ON 45
ci_047                -7.388406e-04 3 1  ON 46
ci_048                -5.538287e-04 3 1  ON 47
ci_049                 1.708376e-03 3 1  ON 48
ci_050                 1.622835e-03 3 1  ON 49
ci_051                -1.541217e-03 3 1  ON 50
ci_052                -1.580925e-03 3 1  ON 51
ci_053                -2.574221e-03 3 1  ON 52
ci_054                -2.506634e-03 3 1  ON 53
ci_055                -1.736553e-03 3 1  ON 54
ci_056                -1.589825e-03 3 1  ON 55
ci_057                -1.354680e-03 3 1  ON 56
ci_058                -1.519965e-03 3 1  ON 57
ci_059                 4.930939e-04 3 1  ON 58
ci_060                 4.596345e-04 3 1  ON 59
ci_061                -4.587695e-04 3 1  ON 60
ci_062                -4.007559e-04 3 1  ON 61
ci_063                -5.527642e-04 3 1  ON 62
ci_064                -2.649873e-04 3 1  ON 63
ci_065                -2.414168e-03 3 1  ON 64
ci_066                -2.645809e-03 3 1  ON 65
ci_067                -2.506996e-03 3 1  ON 66
ci_068                -2.268333e-03 3 1  ON 67
ci_069                 2.779624e-04 3 1  ON 68
ci_070                -8.501066e-05 3 1  ON 69
ci_071                -1.912547e-03 3 1  ON 70
ci_072                -2.295412e-03 3 1  ON 71
ci_073                 1.184810e-04 3 1  ON 72
ci_074                 4.535540e-04 3 1  ON 73
ci_075                -1.220867e-04 3 1  ON 74
ci_076                -2.575103e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="250">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =8000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 4
    time step          = 0.05
    reference energy   = -22.6085
    reference variance = 0.341327
====================================================
  Execution time = 1.0071e+02
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s004
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 62500 
  VMC Eavg = -2.2669e+01
  VMC Evar = 5.0808e-01
  Total weights = 7.8208e+06
  Execution time = 1.4640e+01
  </log>
</opt>
<opt stage="main" walkers="62500">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.496067840446
                                         uncertainty =       0.001636240983

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.496067840446
                                         uncertainty =       0.001636240983

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000249014845
  error estimate for blocks of size 2^( 2) =       0.000258057071
  error estimate for blocks of size 2^( 3) =       0.000266148971
  error estimate for blocks of size 2^( 4) =       0.000272089773
  error estimate for blocks of size 2^( 5) =       0.000275438512
  error estimate for blocks of size 2^( 6) =       0.000277460074
  error estimate for blocks of size 2^( 7) =       0.000278890504
  error estimate for blocks of size 2^( 8) =       0.000279301200
  error estimate for blocks of size 2^( 9) =       0.000279373042

      target function =                  N/A
              le_mean =     -22.669401664652
             les_mean =     514.411143989459
             stat err =       0.000278756205
             autocorr =       1.253137160902
              std dev =       0.704320343059
             le_variance =       0.496067145647

ERROR CostFunction-> Number of Effective Walkers is too small! 
  Number of effective walkers (samples) / total number of samples = 0.101957
  User specified threshold minwalkers = 0.3
  If this message appears frequently. You might have to be cautious. 
  Find info about parameter "minwalkers" in the user manual!
Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.496022754432
                                         uncertainty =       0.001649884107

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.496022754432
                                         uncertainty =       0.001649884107

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000249003494
  error estimate for blocks of size 2^( 2) =       0.000258045030
  error estimate for blocks of size 2^( 3) =       0.000266132077
  error estimate for blocks of size 2^( 4) =       0.000272069133
  error estimate for blocks of size 2^( 5) =       0.000275412119
  error estimate for blocks of size 2^( 6) =       0.000277428419
  error estimate for blocks of size 2^( 7) =       0.000278860064
  error estimate for blocks of size 2^( 8) =       0.000279265169
  error estimate for blocks of size 2^( 9) =       0.000279347909

      target function =                  N/A
              le_mean =     -22.669406975873
             les_mean =     514.418391050375
             stat err =       0.000278725390
             autocorr =       1.252974357090
              std dev =       0.704288236072
             le_variance =       0.496021919469

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.496003865260
                                         uncertainty =       0.001644679615

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.496003865260
                                         uncertainty =       0.001644679615

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000248998775
  error estimate for blocks of size 2^( 2) =       0.000258040866
  error estimate for blocks of size 2^( 3) =       0.000266128990
  error estimate for blocks of size 2^( 4) =       0.000272068232
  error estimate for blocks of size 2^( 5) =       0.000275411822
  error estimate for blocks of size 2^( 6) =       0.000277433124
  error estimate for blocks of size 2^( 7) =       0.000278864001
  error estimate for blocks of size 2^( 8) =       0.000279276517
  error estimate for blocks of size 2^( 9) =       0.000279353175

      target function =                  N/A
              le_mean =     -22.669404165342
             les_mean =     514.425037288016
             stat err =       0.000278731704
             autocorr =       1.253078612989
              std dev =       0.704274890536
             le_variance =       0.496003121439

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.496047693597
                                         uncertainty =       0.001637158529

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.496047693597
                                         uncertainty =       0.001637158529

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000249009788
  error estimate for blocks of size 2^( 2) =       0.000258052179
  error estimate for blocks of size 2^( 3) =       0.000266143720
  error estimate for blocks of size 2^( 4) =       0.000272084318
  error estimate for blocks of size 2^( 5) =       0.000275432763
  error estimate for blocks of size 2^( 6) =       0.000277453972
  error estimate for blocks of size 2^( 7) =       0.000278884013
  error estimate for blocks of size 2^( 8) =       0.000279294827
  error estimate for blocks of size 2^( 9) =       0.000279367660

      target function =                  N/A
              le_mean =     -22.669401109739
             les_mean =     514.411435081380
             stat err =       0.000278750118
             autocorr =       1.253133330722
              std dev =       0.704306039313
             le_variance =       0.496046997013


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.669401664652        initial
     1.5625e-01     1.5625e+00             1.8747e-03       -22.669406975873  <--
     6.2500e-01     6.2500e+00             5.7455e-04       -22.669404165342
     2.5000e+00     2.5000e+01             1.5192e-04       -22.669401109739

*****************************************************************************
Applying the update for shift_i =   1.5625e-01     and shift_s =   1.5625e+00
*****************************************************************************

  Execution time = 1.7392e+02
  </log>
  <optVariables href="FORM.s004.opt.xml">
ci_001                -7.061549e-01 3 1  ON 0
ci_002                -7.040306e-01 3 1  ON 1
ci_003                -4.464858e-02 3 1  ON 2
ci_004                -4.412104e-02 3 1  ON 3
ci_005                 1.631277e-02 3 1  ON 4
ci_006                 1.653062e-02 3 1  ON 5
ci_007                 1.275838e-02 3 1  ON 6
ci_008                 1.350980e-02 3 1  ON 7
ci_009                -1.161102e-02 3 1  ON 8
ci_010                -1.177293e-02 3 1  ON 9
ci_011                -8.988882e-03 3 1  ON 10
ci_012                -8.779653e-03 3 1  ON 11
ci_013                 9.421821e-03 3 1  ON 12
ci_014                 9.575657e-03 3 1  ON 13
ci_015                 1.256545e-02 3 1  ON 14
ci_016                 1.286428e-02 3 1  ON 15
ci_017                 1.104671e-02 3 1  ON 16
ci_018                 1.094653e-02 3 1  ON 17
ci_019                -1.566678e-03 3 1  ON 18
ci_020                -9.400182e-04 3 1  ON 19
ci_021                -8.289771e-03 3 1  ON 20
ci_022                -8.313831e-03 3 1  ON 21
ci_023                 7.217367e-03 3 1  ON 22
ci_024                 8.076124e-03 3 1  ON 23
ci_025                 4.072653e-03 3 1  ON 24
ci_026                 3.890640e-03 3 1  ON 25
ci_027                 6.337519e-03 3 1  ON 26
ci_028                 6.819490e-03 3 1  ON 27
ci_029                -4.576129e-03 3 1  ON 28
ci_030                -4.386422e-03 3 1  ON 29
ci_031                -8.033091e-03 3 1  ON 30
ci_032                -7.472234e-03 3 1  ON 31
ci_033                 4.683531e-03 3 1  ON 32
ci_034                 4.489221e-03 3 1  ON 33
ci_035                 1.222035e-03 3 1  ON 34
ci_036                 1.197043e-03 3 1  ON 35
ci_037                 5.096620e-03 3 1  ON 36
ci_038                 5.329531e-03 3 1  ON 37
ci_039                 5.811137e-03 3 1  ON 38
ci_040                 5.339684e-03 3 1  ON 39
ci_041                 5.262693e-03 3 1  ON 40
ci_042                 4.958207e-03 3 1  ON 41
ci_043                 4.664018e-03 3 1  ON 42
ci_044                 4.978880e-03 3 1  ON 43
ci_045                 3.781092e-03 3 1  ON 44
ci_046                 3.433675e-03 3 1  ON 45
ci_047                -7.809806e-04 3 1  ON 46
ci_048                -4.823204e-04 3 1  ON 47
ci_049                 1.657854e-03 3 1  ON 48
ci_050                 1.573684e-03 3 1  ON 49
ci_051                -1.416122e-03 3 1  ON 50
ci_052                -1.382281e-03 3 1  ON 51
ci_053                -2.939085e-03 3 1  ON 52
ci_054                -2.516993e-03 3 1  ON 53
ci_055                -2.086147e-03 3 1  ON 54
ci_056                -1.554807e-03 3 1  ON 55
ci_057                -1.454874e-03 3 1  ON 56
ci_058                -1.415455e-03 3 1  ON 57
ci_059                 5.605917e-04 3 1  ON 58
ci_060                 4.857252e-04 3 1  ON 59
ci_061                -4.328084e-04 3 1  ON 60
ci_062                -4.834401e-04 3 1  ON 61
ci_063                -5.233090e-04 3 1  ON 62
ci_064                -1.566119e-04 3 1  ON 63
ci_065                -2.512097e-03 3 1  ON 64
ci_066                -2.707105e-03 3 1  ON 65
ci_067                -2.213430e-03 3 1  ON 66
ci_068                -2.168794e-03 3 1  ON 67
ci_069                 3.230605e-04 3 1  ON 68
ci_070                 2.496468e-05 3 1  ON 69
ci_071                -1.863648e-03 3 1  ON 70
ci_072                -2.567233e-03 3 1  ON 71
ci_073                 1.802240e-04 3 1  ON 72
ci_074                 4.650117e-04 3 1  ON 73
ci_075                 2.468563e-05 3 1  ON 74
ci_076                -2.704516e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 2.9629e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s005 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s005 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=5  my_counter=0
  time step      = 5.0000e-02
  blocks         = 250
  steps          = 250
  substeps       = 10
  current        = 0
  target samples = 8.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">250</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">6.2500e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">8.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">6.2500e+04</parameter>
<parameter name="steps" condition="int">250</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2671e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="250">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =8000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 5
    time step          = 0.05
    reference energy   = -22.6485
    reference variance = 0.504295
====================================================
  Execution time = 1.0230e+02
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s005
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 62500 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 6.1076e+04
  VMC Eavg = -2.2669e+01
  VMC Evar = 5.0939e-01
  Total weights = 7.821002847e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.9040e+01
  </log>
</opt>
<opt stage="main" walkers="62500">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.496542518620
                                         uncertainty =       0.001735883589

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.496542518620
                                         uncertainty =       0.001735883589

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000249134300
  error estimate for blocks of size 2^( 2) =       0.000258090400
  error estimate for blocks of size 2^( 3) =       0.000266123798
  error estimate for blocks of size 2^( 4) =       0.000271945959
  error estimate for blocks of size 2^( 5) =       0.000275139176
  error estimate for blocks of size 2^( 6) =       0.000276754868
  error estimate for blocks of size 2^( 7) =       0.000277689377
  error estimate for blocks of size 2^( 8) =       0.000277955927
  error estimate for blocks of size 2^( 9) =       0.000278968538

      target function =                  N/A
              le_mean =     -22.669445980247
             les_mean =     514.413173588435
             stat err =       0.000277842178
             autocorr =       1.243739133094
              std dev =       0.704658213074
             le_variance =       0.496543197252


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266944598025e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.9062e-02, overlap shift 3.9062e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.669445980269       residual = 6.31e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.669476259942       residual = 1.10e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.669485081689       residual = 1.84e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.669486830603       residual = 1.72e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.669486931331       residual = 4.10e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.669486822235       residual = 2.18e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.669486853765       residual = 2.83e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 3.9062e-02 is 4.025553e-03

solving harmonic davidson linear method for identity shift 1.5625e-01, overlap shift 1.5625e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.669445980269       residual = 6.31e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.669463452912       residual = 3.57e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.669465426885       residual = 1.77e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.669465663975       residual = 6.15e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 1.5625e-01 is 1.714518e-03

solving harmonic davidson linear method for identity shift 6.2500e-01, overlap shift 6.2500e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.669445980269       residual = 6.31e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.669452471224       residual = 8.66e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.669452672064       residual = 2.01e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.669452715495       residual = 6.96e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 6.2500e-01 is 5.222459e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.011972 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.2135e+02
  </log>
  <optVariables href="FORM.s005.opt.xml">
ci_001                -7.060251e-01 3 1  ON 0
ci_002                -7.043800e-01 3 1  ON 1
ci_003                -4.308065e-02 3 1  ON 2
ci_004                -4.240652e-02 3 1  ON 3
ci_005                 1.615885e-02 3 1  ON 4
ci_006                 1.623275e-02 3 1  ON 5
ci_007                 1.255005e-02 3 1  ON 6
ci_008                 1.303119e-02 3 1  ON 7
ci_009                -1.193089e-02 3 1  ON 8
ci_010                -1.180622e-02 3 1  ON 9
ci_011                -8.997845e-03 3 1  ON 10
ci_012                -8.846788e-03 3 1  ON 11
ci_013                 9.265882e-03 3 1  ON 12
ci_014                 9.540008e-03 3 1  ON 13
ci_015                 1.293940e-02 3 1  ON 14
ci_016                 1.258096e-02 3 1  ON 15
ci_017                 1.100354e-02 3 1  ON 16
ci_018                 1.102230e-02 3 1  ON 17
ci_019                -1.879412e-03 3 1  ON 18
ci_020                -1.427505e-03 3 1  ON 19
ci_021                -8.668608e-03 3 1  ON 20
ci_022                -8.331285e-03 3 1  ON 21
ci_023                 7.450034e-03 3 1  ON 22
ci_024                 7.683460e-03 3 1  ON 23
ci_025                 4.071324e-03 3 1  ON 24
ci_026                 3.629063e-03 3 1  ON 25
ci_027                 6.473245e-03 3 1  ON 26
ci_028                 6.491736e-03 3 1  ON 27
ci_029                -5.053578e-03 3 1  ON 28
ci_030                -4.851289e-03 3 1  ON 29
ci_031                -7.763825e-03 3 1  ON 30
ci_032                -7.478494e-03 3 1  ON 31
ci_033                 4.611184e-03 3 1  ON 32
ci_034                 4.448097e-03 3 1  ON 33
ci_035                 1.453221e-03 3 1  ON 34
ci_036                 1.111681e-03 3 1  ON 35
ci_037                 5.213461e-03 3 1  ON 36
ci_038                 5.309137e-03 3 1  ON 37
ci_039                 5.720794e-03 3 1  ON 38
ci_040                 5.602093e-03 3 1  ON 39
ci_041                 5.177135e-03 3 1  ON 40
ci_042                 4.941774e-03 3 1  ON 41
ci_043                 4.866246e-03 3 1  ON 42
ci_044                 5.000336e-03 3 1  ON 43
ci_045                 3.549814e-03 3 1  ON 44
ci_046                 3.232783e-03 3 1  ON 45
ci_047                -6.887474e-04 3 1  ON 46
ci_048                -4.129321e-04 3 1  ON 47
ci_049                 2.185317e-03 3 1  ON 48
ci_050                 1.667889e-03 3 1  ON 49
ci_051                -1.327440e-03 3 1  ON 50
ci_052                -1.549906e-03 3 1  ON 51
ci_053                -2.599709e-03 3 1  ON 52
ci_054                -2.484589e-03 3 1  ON 53
ci_055                -2.099485e-03 3 1  ON 54
ci_056                -1.812159e-03 3 1  ON 55
ci_057                -1.572303e-03 3 1  ON 56
ci_058                -1.598460e-03 3 1  ON 57
ci_059                 2.840234e-04 3 1  ON 58
ci_060                 1.331055e-04 3 1  ON 59
ci_061                -2.795107e-04 3 1  ON 60
ci_062                -2.439489e-04 3 1  ON 61
ci_063                -3.584680e-04 3 1  ON 62
ci_064                -5.400123e-04 3 1  ON 63
ci_065                -2.651192e-03 3 1  ON 64
ci_066                -2.442136e-03 3 1  ON 65
ci_067                -2.222953e-03 3 1  ON 66
ci_068                -2.763740e-03 3 1  ON 67
ci_069                 1.973204e-04 3 1  ON 68
ci_070                 1.771658e-04 3 1  ON 69
ci_071                -1.851554e-03 3 1  ON 70
ci_072                -2.588465e-03 3 1  ON 71
ci_073                 2.776273e-04 3 1  ON 72
ci_074                 4.301787e-04 3 1  ON 73
ci_075                -1.239309e-04 3 1  ON 74
ci_076                 6.255870e-05 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="250">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =8000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 5
    time step          = 0.05
    reference energy   = -22.6962
    reference variance = 0.280673
====================================================
  Execution time = 1.0020e+02
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s005
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 62500 
  VMC Eavg = -2.2669e+01
  VMC Evar = 5.1273e-01
  Total weights = 7.8211e+06
  Execution time = 1.4690e+01
  </log>
</opt>
<opt stage="main" walkers="62500">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.497068983225
                                         uncertainty =       0.002003477296

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.497068983225
                                         uncertainty =       0.002003477296

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000249266301
  error estimate for blocks of size 2^( 2) =       0.000258176956
  error estimate for blocks of size 2^( 3) =       0.000266133827
  error estimate for blocks of size 2^( 4) =       0.000271883168
  error estimate for blocks of size 2^( 5) =       0.000274955082
  error estimate for blocks of size 2^( 6) =       0.000276683376
  error estimate for blocks of size 2^( 7) =       0.000277799373
  error estimate for blocks of size 2^( 8) =       0.000278437177
  error estimate for blocks of size 2^( 9) =       0.000278670756

      target function =                  N/A
              le_mean =     -22.669464790934
             les_mean =     514.427909880320
             stat err =       0.000277897671
             autocorr =       1.242918560934
              std dev =       0.705031568322
             le_variance =       0.497069512330

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.497099349869
                                         uncertainty =       0.002141725267

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.497099349869
                                         uncertainty =       0.002141725267

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000249273918
  error estimate for blocks of size 2^( 2) =       0.000258180849
  error estimate for blocks of size 2^( 3) =       0.000266132506
  error estimate for blocks of size 2^( 4) =       0.000271872954
  error estimate for blocks of size 2^( 5) =       0.000274942621
  error estimate for blocks of size 2^( 6) =       0.000276669297
  error estimate for blocks of size 2^( 7) =       0.000277800793
  error estimate for blocks of size 2^( 8) =       0.000278450201
  error estimate for blocks of size 2^( 9) =       0.000278695572

      target function =                  N/A
              le_mean =     -22.669462115088
             les_mean =     514.428586954933
             stat err =       0.000277903966
             autocorr =       1.242898918415
              std dev =       0.705053109751
             le_variance =       0.497099887569

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.501505402886
                                         uncertainty =       0.004709915136

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.501505402886
                                         uncertainty =       0.004709915136

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000250378147
  error estimate for blocks of size 2^( 2) =       0.000259244464
  error estimate for blocks of size 2^( 3) =       0.000267177272
  error estimate for blocks of size 2^( 4) =       0.000272910106
  error estimate for blocks of size 2^( 5) =       0.000275948185
  error estimate for blocks of size 2^( 6) =       0.000277672697
  error estimate for blocks of size 2^( 7) =       0.000278801889
  error estimate for blocks of size 2^( 8) =       0.000279477380
  error estimate for blocks of size 2^( 9) =       0.000279774674

      target function =                  N/A
              le_mean =     -22.669439395639
             les_mean =     516.508443228390
             stat err =       0.000278931660
             autocorr =       1.241088582689
              std dev =       0.708176343047
             le_variance =       0.501513732851

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.497460962414
                                         uncertainty =       0.002075242186

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.497460962414
                                         uncertainty =       0.002075242186

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000249364686
  error estimate for blocks of size 2^( 2) =       0.000258273479
  error estimate for blocks of size 2^( 3) =       0.000266228079
  error estimate for blocks of size 2^( 4) =       0.000271978329
  error estimate for blocks of size 2^( 5) =       0.000275045038
  error estimate for blocks of size 2^( 6) =       0.000276764480
  error estimate for blocks of size 2^( 7) =       0.000277868444
  error estimate for blocks of size 2^( 8) =       0.000278521240
  error estimate for blocks of size 2^( 9) =       0.000278715795

      target function =                  N/A
              le_mean =     -22.669451442744
             les_mean =     514.669406561608
             stat err =       0.000277967490
             autocorr =       1.242562118719
              std dev =       0.705309841867
             le_variance =       0.497461973034


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.669464790934        initial  <--
     3.9062e-02     3.9062e-01             4.0256e-03       -22.669462115088
     1.5625e-01     1.5625e+00             1.7145e-03       -22.669439395639
     6.2500e-01     6.2500e+00             5.2225e-04       -22.669451442744

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 173.6056
  </log>
  <optVariables href="FORM.s005.opt.xml">
ci_001                -7.061549e-01 3 1  ON 0
ci_002                -7.040306e-01 3 1  ON 1
ci_003                -4.464858e-02 3 1  ON 2
ci_004                -4.412104e-02 3 1  ON 3
ci_005                 1.631277e-02 3 1  ON 4
ci_006                 1.653062e-02 3 1  ON 5
ci_007                 1.275838e-02 3 1  ON 6
ci_008                 1.350980e-02 3 1  ON 7
ci_009                -1.161102e-02 3 1  ON 8
ci_010                -1.177293e-02 3 1  ON 9
ci_011                -8.988882e-03 3 1  ON 10
ci_012                -8.779653e-03 3 1  ON 11
ci_013                 9.421821e-03 3 1  ON 12
ci_014                 9.575657e-03 3 1  ON 13
ci_015                 1.256545e-02 3 1  ON 14
ci_016                 1.286428e-02 3 1  ON 15
ci_017                 1.104671e-02 3 1  ON 16
ci_018                 1.094653e-02 3 1  ON 17
ci_019                -1.566678e-03 3 1  ON 18
ci_020                -9.400182e-04 3 1  ON 19
ci_021                -8.289771e-03 3 1  ON 20
ci_022                -8.313831e-03 3 1  ON 21
ci_023                 7.217367e-03 3 1  ON 22
ci_024                 8.076124e-03 3 1  ON 23
ci_025                 4.072653e-03 3 1  ON 24
ci_026                 3.890640e-03 3 1  ON 25
ci_027                 6.337519e-03 3 1  ON 26
ci_028                 6.819490e-03 3 1  ON 27
ci_029                -4.576129e-03 3 1  ON 28
ci_030                -4.386422e-03 3 1  ON 29
ci_031                -8.033091e-03 3 1  ON 30
ci_032                -7.472234e-03 3 1  ON 31
ci_033                 4.683531e-03 3 1  ON 32
ci_034                 4.489221e-03 3 1  ON 33
ci_035                 1.222035e-03 3 1  ON 34
ci_036                 1.197043e-03 3 1  ON 35
ci_037                 5.096620e-03 3 1  ON 36
ci_038                 5.329531e-03 3 1  ON 37
ci_039                 5.811137e-03 3 1  ON 38
ci_040                 5.339684e-03 3 1  ON 39
ci_041                 5.262693e-03 3 1  ON 40
ci_042                 4.958207e-03 3 1  ON 41
ci_043                 4.664018e-03 3 1  ON 42
ci_044                 4.978880e-03 3 1  ON 43
ci_045                 3.781092e-03 3 1  ON 44
ci_046                 3.433675e-03 3 1  ON 45
ci_047                -7.809806e-04 3 1  ON 46
ci_048                -4.823204e-04 3 1  ON 47
ci_049                 1.657854e-03 3 1  ON 48
ci_050                 1.573684e-03 3 1  ON 49
ci_051                -1.416122e-03 3 1  ON 50
ci_052                -1.382281e-03 3 1  ON 51
ci_053                -2.939085e-03 3 1  ON 52
ci_054                -2.516993e-03 3 1  ON 53
ci_055                -2.086147e-03 3 1  ON 54
ci_056                -1.554807e-03 3 1  ON 55
ci_057                -1.454874e-03 3 1  ON 56
ci_058                -1.415455e-03 3 1  ON 57
ci_059                 5.605917e-04 3 1  ON 58
ci_060                 4.857252e-04 3 1  ON 59
ci_061                -4.328084e-04 3 1  ON 60
ci_062                -4.834401e-04 3 1  ON 61
ci_063                -5.233090e-04 3 1  ON 62
ci_064                -1.566119e-04 3 1  ON 63
ci_065                -2.512097e-03 3 1  ON 64
ci_066                -2.707105e-03 3 1  ON 65
ci_067                -2.213430e-03 3 1  ON 66
ci_068                -2.168794e-03 3 1  ON 67
ci_069                 3.230605e-04 3 1  ON 68
ci_070                 2.496468e-05 3 1  ON 69
ci_071                -1.863648e-03 3 1  ON 70
ci_072                -2.567233e-03 3 1  ON 71
ci_073                 1.802240e-04 3 1  ON 72
ci_074                 4.650117e-04 3 1  ON 73
ci_075                 2.468563e-05 3 1  ON 74
ci_076                -2.704516e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 2.9498e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s006 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s006 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=6  my_counter=0
  time step      = 5.0000e-02
  blocks         = 250
  steps          = 250
  substeps       = 10
  current        = 0
  target samples = 8.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">250</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">6.2500e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">8.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">6.2500e+04</parameter>
<parameter name="steps" condition="int">250</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2671e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="250">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =8000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 6
    time step          = 0.05
    reference energy   = -22.5907
    reference variance = 0.607643
====================================================
  Execution time = 1.0235e+02
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s006
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 62500 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 6.1065e+04
  VMC Eavg = -2.2670e+01
  VMC Evar = 5.0552e-01
  Total weights = 7.820335441e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.9075e+01
  </log>
</opt>
<opt stage="main" walkers="62500">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.493557962016
                                         uncertainty =       0.001505651173

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.493557962016
                                         uncertainty =       0.001505651173

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000248384027
  error estimate for blocks of size 2^( 2) =       0.000257374720
  error estimate for blocks of size 2^( 3) =       0.000265344416
  error estimate for blocks of size 2^( 4) =       0.000271302822
  error estimate for blocks of size 2^( 5) =       0.000274755631
  error estimate for blocks of size 2^( 6) =       0.000277389439
  error estimate for blocks of size 2^( 7) =       0.000278436404
  error estimate for blocks of size 2^( 8) =       0.000278522721
  error estimate for blocks of size 2^( 9) =       0.000278502972

      target function =                  N/A
              le_mean =     -22.669728213561
             les_mean =     514.422097599064
             stat err =       0.000278212884
             autocorr =       1.254605390547
              std dev =       0.702536118412
             le_variance =       0.493556997673


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266972821356e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.9062e-01, overlap shift 3.9062e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.669728213592       residual = 7.40e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.669736324626       residual = 1.34e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.669736588971       residual = 1.66e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.669736641853       residual = 5.43e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 3.9062e-01 is 7.581556e-04

solving harmonic davidson linear method for identity shift 1.5625e+00, overlap shift 1.5625e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.669728213592       residual = 7.40e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.669730744467       residual = 8.70e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.669730680033       residual = 1.35e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.669730701945       residual = 2.75e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 1.5625e+00 is 2.076878e-04

solving harmonic davidson linear method for identity shift 6.2500e+00, overlap shift 6.2500e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.669728213592       residual = 7.40e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.669728888153       residual = 1.06e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.669728860664       residual = 1.78e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.669728868731       residual = 3.24e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 6.2500e+00 is 5.323056e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.013311 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.2144e+02
  </log>
  <optVariables href="FORM.s006.opt.xml">
ci_001                -7.061771e-01 3 1  ON 0
ci_002                -7.040435e-01 3 1  ON 1
ci_003                -4.444089e-02 3 1  ON 2
ci_004                -4.393404e-02 3 1  ON 3
ci_005                 1.631472e-02 3 1  ON 4
ci_006                 1.639993e-02 3 1  ON 5
ci_007                 1.274604e-02 3 1  ON 6
ci_008                 1.341958e-02 3 1  ON 7
ci_009                -1.159751e-02 3 1  ON 8
ci_010                -1.179422e-02 3 1  ON 9
ci_011                -8.927848e-03 3 1  ON 10
ci_012                -8.724350e-03 3 1  ON 11
ci_013                 9.383516e-03 3 1  ON 12
ci_014                 9.526998e-03 3 1  ON 13
ci_015                 1.252578e-02 3 1  ON 14
ci_016                 1.281676e-02 3 1  ON 15
ci_017                 1.100960e-02 3 1  ON 16
ci_018                 1.095967e-02 3 1  ON 17
ci_019                -1.693824e-03 3 1  ON 18
ci_020                -9.919687e-04 3 1  ON 19
ci_021                -8.290197e-03 3 1  ON 20
ci_022                -8.292184e-03 3 1  ON 21
ci_023                 7.222510e-03 3 1  ON 22
ci_024                 8.002685e-03 3 1  ON 23
ci_025                 4.150929e-03 3 1  ON 24
ci_026                 3.939148e-03 3 1  ON 25
ci_027                 6.393999e-03 3 1  ON 26
ci_028                 6.742689e-03 3 1  ON 27
ci_029                -4.604939e-03 3 1  ON 28
ci_030                -4.349347e-03 3 1  ON 29
ci_031                -8.023407e-03 3 1  ON 30
ci_032                -7.437807e-03 3 1  ON 31
ci_033                 4.705138e-03 3 1  ON 32
ci_034                 4.477521e-03 3 1  ON 33
ci_035                 1.270809e-03 3 1  ON 34
ci_036                 1.280935e-03 3 1  ON 35
ci_037                 5.087506e-03 3 1  ON 36
ci_038                 5.378489e-03 3 1  ON 37
ci_039                 5.804388e-03 3 1  ON 38
ci_040                 5.434442e-03 3 1  ON 39
ci_041                 5.161157e-03 3 1  ON 40
ci_042                 4.924610e-03 3 1  ON 41
ci_043                 4.694910e-03 3 1  ON 42
ci_044                 4.959595e-03 3 1  ON 43
ci_045                 3.735181e-03 3 1  ON 44
ci_046                 3.389065e-03 3 1  ON 45
ci_047                -7.747093e-04 3 1  ON 46
ci_048                -5.586624e-04 3 1  ON 47
ci_049                 1.658821e-03 3 1  ON 48
ci_050                 1.545803e-03 3 1  ON 49
ci_051                -1.486154e-03 3 1  ON 50
ci_052                -1.387438e-03 3 1  ON 51
ci_053                -2.946720e-03 3 1  ON 52
ci_054                -2.565364e-03 3 1  ON 53
ci_055                -2.008954e-03 3 1  ON 54
ci_056                -1.556362e-03 3 1  ON 55
ci_057                -1.375707e-03 3 1  ON 56
ci_058                -1.389576e-03 3 1  ON 57
ci_059                 5.333709e-04 3 1  ON 58
ci_060                 4.508823e-04 3 1  ON 59
ci_061                -4.233400e-04 3 1  ON 60
ci_062                -4.423064e-04 3 1  ON 61
ci_063                -5.631540e-04 3 1  ON 62
ci_064                -2.511527e-04 3 1  ON 63
ci_065                -2.565146e-03 3 1  ON 64
ci_066                -2.772965e-03 3 1  ON 65
ci_067                -2.177439e-03 3 1  ON 66
ci_068                -2.126577e-03 3 1  ON 67
ci_069                 2.638262e-04 3 1  ON 68
ci_070                 2.050422e-05 3 1  ON 69
ci_071                -1.934256e-03 3 1  ON 70
ci_072                -2.513083e-03 3 1  ON 71
ci_073                 1.374135e-04 3 1  ON 72
ci_074                 4.384371e-04 3 1  ON 73
ci_075                -6.967746e-05 3 1  ON 74
ci_076                -3.052701e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="250">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =8000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 6
    time step          = 0.05
    reference energy   = -22.7496
    reference variance = 0.489337
====================================================
  Execution time = 9.9938e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s006
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 62500 
  VMC Eavg = -2.2670e+01
  VMC Evar = 5.1327e-01
  Total weights = 7.8208e+06
  Execution time = 1.4628e+01
  </log>
</opt>
<opt stage="main" walkers="62500">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.498629744299
                                         uncertainty =       0.001560811254

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.498629744299
                                         uncertainty =       0.001560811254

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000249658142
  error estimate for blocks of size 2^( 2) =       0.000258681608
  error estimate for blocks of size 2^( 3) =       0.000266741318
  error estimate for blocks of size 2^( 4) =       0.000272579157
  error estimate for blocks of size 2^( 5) =       0.000276088582
  error estimate for blocks of size 2^( 6) =       0.000277923641
  error estimate for blocks of size 2^( 7) =       0.000279456746
  error estimate for blocks of size 2^( 8) =       0.000280107862
  error estimate for blocks of size 2^( 9) =       0.000281209404

      target function =                  N/A
              le_mean =     -22.669903832973
             les_mean =     514.438646956951
             stat err =       0.000279674413
             autocorr =       1.254914108199
              std dev =       0.706139861540
             le_variance =       0.498633504056

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.498507475830
                                         uncertainty =       0.001565950271

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.498507475830
                                         uncertainty =       0.001565950271

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000249627518
  error estimate for blocks of size 2^( 2) =       0.000258652710
  error estimate for blocks of size 2^( 3) =       0.000266712782
  error estimate for blocks of size 2^( 4) =       0.000272549083
  error estimate for blocks of size 2^( 5) =       0.000276055587
  error estimate for blocks of size 2^( 6) =       0.000277887665
  error estimate for blocks of size 2^( 7) =       0.000279421276
  error estimate for blocks of size 2^( 8) =       0.000280067902
  error estimate for blocks of size 2^( 9) =       0.000281172842

      target function =                  N/A
              le_mean =     -22.669904486710
             les_mean =     514.440946732883
             stat err =       0.000279637421
             autocorr =       1.254889999843
              std dev =       0.706053244072
             le_variance =       0.498511183464

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.498542633619
                                         uncertainty =       0.001563124844

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.498542633619
                                         uncertainty =       0.001563124844

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000249636325
  error estimate for blocks of size 2^( 2) =       0.000258661078
  error estimate for blocks of size 2^( 3) =       0.000266721345
  error estimate for blocks of size 2^( 4) =       0.000272558377
  error estimate for blocks of size 2^( 5) =       0.000276065897
  error estimate for blocks of size 2^( 6) =       0.000277899690
  error estimate for blocks of size 2^( 7) =       0.000279432434
  error estimate for blocks of size 2^( 8) =       0.000280080794
  error estimate for blocks of size 2^( 9) =       0.000281185002

      target function =                  N/A
              le_mean =     -22.669903198196
             les_mean =     514.441247286634
             stat err =       0.000279649480
             autocorr =       1.254909685482
              std dev =       0.706078153531
             le_variance =       0.498546358894

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.498616027324
                                         uncertainty =       0.001561019965

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.498616027324
                                         uncertainty =       0.001561019965

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000249654707
  error estimate for blocks of size 2^( 2) =       0.000258678361
  error estimate for blocks of size 2^( 3) =       0.000266738186
  error estimate for blocks of size 2^( 4) =       0.000272575960
  error estimate for blocks of size 2^( 5) =       0.000276085137
  error estimate for blocks of size 2^( 6) =       0.000277919987
  error estimate for blocks of size 2^( 7) =       0.000279453130
  error estimate for blocks of size 2^( 8) =       0.000280103828
  error estimate for blocks of size 2^( 9) =       0.000281205810

      target function =                  N/A
              le_mean =     -22.669903598990
             les_mean =     514.438353653283
             stat err =       0.000279670689
             autocorr =       1.254915217737
              std dev =       0.706130145332
             le_variance =       0.498619782146


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.669903832973        initial
     3.9062e-01     3.9062e+00             7.5816e-04       -22.669904486710  <--
     1.5625e+00     1.5625e+01             2.0769e-04       -22.669903198196
     6.2500e+00     6.2500e+01             5.3231e-05       -22.669903598990

*****************************************************************************
Applying the update for shift_i =   3.9062e-01     and shift_s =   3.9062e+00
*****************************************************************************

  Execution time = 1.7305e+02
  </log>
  <optVariables href="FORM.s006.opt.xml">
ci_001                -7.062417e-01 3 1  ON 0
ci_002                -7.040645e-01 3 1  ON 1
ci_003                -4.389043e-02 3 1  ON 2
ci_004                -4.344204e-02 3 1  ON 3
ci_005                 1.631810e-02 3 1  ON 4
ci_006                 1.615913e-02 3 1  ON 5
ci_007                 1.273350e-02 3 1  ON 6
ci_008                 1.323198e-02 3 1  ON 7
ci_009                -1.157904e-02 3 1  ON 8
ci_010                -1.185403e-02 3 1  ON 9
ci_011                -8.799935e-03 3 1  ON 10
ci_012                -8.607191e-03 3 1  ON 11
ci_013                 9.298554e-03 3 1  ON 12
ci_014                 9.424251e-03 3 1  ON 13
ci_015                 1.243458e-02 3 1  ON 14
ci_016                 1.270917e-02 3 1  ON 15
ci_017                 1.093164e-02 3 1  ON 16
ci_018                 1.099369e-02 3 1  ON 17
ci_019                -1.993358e-03 3 1  ON 18
ci_020                -1.125320e-03 3 1  ON 19
ci_021                -8.286967e-03 3 1  ON 20
ci_022                -8.248907e-03 3 1  ON 21
ci_023                 7.231142e-03 3 1  ON 22
ci_024                 7.856568e-03 3 1  ON 23
ci_025                 4.342305e-03 3 1  ON 24
ci_026                 4.060494e-03 3 1  ON 25
ci_027                 6.494076e-03 3 1  ON 26
ci_028                 6.605437e-03 3 1  ON 27
ci_029                -4.661593e-03 3 1  ON 28
ci_030                -4.270881e-03 3 1  ON 29
ci_031                -8.003778e-03 3 1  ON 30
ci_032                -7.366384e-03 3 1  ON 31
ci_033                 4.757638e-03 3 1  ON 32
ci_034                 4.452782e-03 3 1  ON 33
ci_035                 1.352210e-03 3 1  ON 34
ci_036                 1.419377e-03 3 1  ON 35
ci_037                 5.065610e-03 3 1  ON 36
ci_038                 5.482552e-03 3 1  ON 37
ci_039                 5.792269e-03 3 1  ON 38
ci_040                 5.607099e-03 3 1  ON 39
ci_041                 4.963075e-03 3 1  ON 40
ci_042                 4.859268e-03 3 1  ON 41
ci_043                 4.756960e-03 3 1  ON 42
ci_044                 4.914929e-03 3 1  ON 43
ci_045                 3.637010e-03 3 1  ON 44
ci_046                 3.293787e-03 3 1  ON 45
ci_047                -7.621160e-04 3 1  ON 46
ci_048                -6.874636e-04 3 1  ON 47
ci_049                 1.663142e-03 3 1  ON 48
ci_050                 1.484271e-03 3 1  ON 49
ci_051                -1.631996e-03 3 1  ON 50
ci_052                -1.394748e-03 3 1  ON 51
ci_053                -2.964633e-03 3 1  ON 52
ci_054                -2.674728e-03 3 1  ON 53
ci_055                -1.841486e-03 3 1  ON 54
ci_056                -1.563224e-03 3 1  ON 55
ci_057                -1.213750e-03 3 1  ON 56
ci_058                -1.338980e-03 3 1  ON 57
ci_059                 4.879082e-04 3 1  ON 58
ci_060                 3.881281e-04 3 1  ON 59
ci_061                -4.010925e-04 3 1  ON 60
ci_062                -3.610444e-04 3 1  ON 61
ci_063                -6.526334e-04 3 1  ON 62
ci_064                -4.596853e-04 3 1  ON 63
ci_065                -2.669928e-03 3 1  ON 64
ci_066                -2.915307e-03 3 1  ON 65
ci_067                -2.105569e-03 3 1  ON 66
ci_068                -2.035325e-03 3 1  ON 67
ci_069                 1.448672e-04 3 1  ON 68
ci_070                 1.400036e-05 3 1  ON 69
ci_071                -2.075080e-03 3 1  ON 70
ci_072                -2.392488e-03 3 1  ON 71
ci_073                 6.209391e-05 3 1  ON 72
ci_074                 3.943932e-04 3 1  ON 73
ci_075                -2.639439e-04 3 1  ON 74
ci_076                -3.760809e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 2.9452e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s007 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s007 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=7  my_counter=0
  time step      = 5.0000e-02
  blocks         = 250
  steps          = 250
  substeps       = 10
  current        = 0
  target samples = 8.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">250</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">6.2500e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">8.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">6.2500e+04</parameter>
<parameter name="steps" condition="int">250</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2671e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="250">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =8000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 7
    time step          = 0.05
    reference energy   = -22.6164
    reference variance = 0.480926
====================================================
  Execution time = 1.0265e+02
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s007
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 62500 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 6.1120e+04
  VMC Eavg = -2.2670e+01
  VMC Evar = 5.0996e-01
  Total weights = 7.820684680e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.9035e+01
  </log>
</opt>
<opt stage="main" walkers="62500">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.497865644628
                                         uncertainty =       0.002081235841

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.497865644628
                                         uncertainty =       0.002081235841

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000249465303
  error estimate for blocks of size 2^( 2) =       0.000258577750
  error estimate for blocks of size 2^( 3) =       0.000266614560
  error estimate for blocks of size 2^( 4) =       0.000272333157
  error estimate for blocks of size 2^( 5) =       0.000275505658
  error estimate for blocks of size 2^( 6) =       0.000276965478
  error estimate for blocks of size 2^( 7) =       0.000277842747
  error estimate for blocks of size 2^( 8) =       0.000278591595
  error estimate for blocks of size 2^( 9) =       0.000278975804

      target function =                  N/A
              le_mean =     -22.669573245381
             les_mean =     514.419509551720
             stat err =       0.000278093906
             autocorr =       1.242689543880
              std dev =       0.705594429741
             le_variance =       0.497863499281


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266957324538e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.7656e-02, overlap shift 9.7656e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.669573245404       residual = 6.80e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.669589060111       residual = 5.12e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.669591412321       residual = 4.96e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.669591526691       residual = 2.47e-08           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.669591753013       residual = 7.74e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          4 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 9.7656e-02 is 2.002649e-03

solving harmonic davidson linear method for identity shift 3.9062e-01, overlap shift 3.9062e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.669573245404       residual = 6.80e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.669580186138       residual = 1.25e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.669580479139       residual = 3.41e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.669580439548       residual = 1.07e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 3.9062e-01 is 6.690129e-04

solving harmonic davidson linear method for identity shift 1.5625e+00, overlap shift 1.5625e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.669573245404       residual = 6.80e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.669575384640       residual = 6.79e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.669575396478       residual = 2.12e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.669575388134       residual = 7.59e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 1.5625e+00 is 1.821900e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.014775 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.2170e+02
  </log>
  <optVariables href="FORM.s007.opt.xml">
ci_001                -7.063165e-01 3 1  ON 0
ci_002                -7.040726e-01 3 1  ON 1
ci_003                -4.322141e-02 3 1  ON 2
ci_004                -4.280643e-02 3 1  ON 3
ci_005                 1.629693e-02 3 1  ON 4
ci_006                 1.598615e-02 3 1  ON 5
ci_007                 1.283405e-02 3 1  ON 6
ci_008                 1.296366e-02 3 1  ON 7
ci_009                -1.159425e-02 3 1  ON 8
ci_010                -1.185745e-02 3 1  ON 9
ci_011                -8.586932e-03 3 1  ON 10
ci_012                -8.494240e-03 3 1  ON 11
ci_013                 8.940496e-03 3 1  ON 12
ci_014                 9.544236e-03 3 1  ON 13
ci_015                 1.238495e-02 3 1  ON 14
ci_016                 1.266595e-02 3 1  ON 15
ci_017                 1.129963e-02 3 1  ON 16
ci_018                 1.093356e-02 3 1  ON 17
ci_019                -2.260823e-03 3 1  ON 18
ci_020                -1.391766e-03 3 1  ON 19
ci_021                -8.386687e-03 3 1  ON 20
ci_022                -8.370477e-03 3 1  ON 21
ci_023                 7.367183e-03 3 1  ON 22
ci_024                 7.938197e-03 3 1  ON 23
ci_025                 4.188545e-03 3 1  ON 24
ci_026                 4.130346e-03 3 1  ON 25
ci_027                 6.668094e-03 3 1  ON 26
ci_028                 6.527175e-03 3 1  ON 27
ci_029                -4.678128e-03 3 1  ON 28
ci_030                -4.446416e-03 3 1  ON 29
ci_031                -8.068393e-03 3 1  ON 30
ci_032                -7.409328e-03 3 1  ON 31
ci_033                 4.598530e-03 3 1  ON 32
ci_034                 4.486544e-03 3 1  ON 33
ci_035                 1.211605e-03 3 1  ON 34
ci_036                 1.330008e-03 3 1  ON 35
ci_037                 4.932018e-03 3 1  ON 36
ci_038                 5.640802e-03 3 1  ON 37
ci_039                 5.661286e-03 3 1  ON 38
ci_040                 5.563952e-03 3 1  ON 39
ci_041                 5.092176e-03 3 1  ON 40
ci_042                 5.087760e-03 3 1  ON 41
ci_043                 4.897193e-03 3 1  ON 42
ci_044                 5.033037e-03 3 1  ON 43
ci_045                 3.625849e-03 3 1  ON 44
ci_046                 3.233724e-03 3 1  ON 45
ci_047                -5.962878e-04 3 1  ON 46
ci_048                -6.710971e-04 3 1  ON 47
ci_049                 1.644175e-03 3 1  ON 48
ci_050                 1.436224e-03 3 1  ON 49
ci_051                -1.591472e-03 3 1  ON 50
ci_052                -1.355274e-03 3 1  ON 51
ci_053                -2.887229e-03 3 1  ON 52
ci_054                -2.601335e-03 3 1  ON 53
ci_055                -1.595097e-03 3 1  ON 54
ci_056                -1.461479e-03 3 1  ON 55
ci_057                -1.613047e-03 3 1  ON 56
ci_058                -1.433768e-03 3 1  ON 57
ci_059                 5.704480e-04 3 1  ON 58
ci_060                 3.445334e-04 3 1  ON 59
ci_061                -5.070999e-04 3 1  ON 60
ci_062                -3.377680e-04 3 1  ON 61
ci_063                -6.752185e-04 3 1  ON 62
ci_064                -5.054614e-04 3 1  ON 63
ci_065                -2.713958e-03 3 1  ON 64
ci_066                -2.659763e-03 3 1  ON 65
ci_067                -2.573343e-03 3 1  ON 66
ci_068                -2.217657e-03 3 1  ON 67
ci_069                 1.338269e-04 3 1  ON 68
ci_070                -2.386655e-04 3 1  ON 69
ci_071                -1.889749e-03 3 1  ON 70
ci_072                -2.275779e-03 3 1  ON 71
ci_073                 1.183558e-04 3 1  ON 72
ci_074                 2.455383e-04 3 1  ON 73
ci_075                -3.646177e-04 3 1  ON 74
ci_076                -1.848158e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="250">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =8000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 7
    time step          = 0.05
    reference energy   = -22.6431
    reference variance = 0.431814
====================================================
  Execution time = 1.0015e+02
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s007
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 62500 
  VMC Eavg = -2.2669e+01
  VMC Evar = 5.0714e-01
  Total weights = 7.8205e+06
  Execution time = 1.4635e+01
  </log>
</opt>
<opt stage="main" walkers="62500">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.494863564969
                                         uncertainty =       0.001291957719

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.494863564969
                                         uncertainty =       0.001291957719

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000248712185
  error estimate for blocks of size 2^( 2) =       0.000257763570
  error estimate for blocks of size 2^( 3) =       0.000265866488
  error estimate for blocks of size 2^( 4) =       0.000271616836
  error estimate for blocks of size 2^( 5) =       0.000274948873
  error estimate for blocks of size 2^( 6) =       0.000276606129
  error estimate for blocks of size 2^( 7) =       0.000277474293
  error estimate for blocks of size 2^( 8) =       0.000278087072
  error estimate for blocks of size 2^( 9) =       0.000277609122

      target function =                  N/A
              le_mean =     -22.669282472970
             les_mean =     514.424903454525
             stat err =       0.000277444154
             autocorr =       1.244391491580
              std dev =       0.703464289351
             le_variance =       0.494862006392

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.494885527530
                                         uncertainty =       0.001289795040

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.494885527530
                                         uncertainty =       0.001289795040

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000248717732
  error estimate for blocks of size 2^( 2) =       0.000257766731
  error estimate for blocks of size 2^( 3) =       0.000265862977
  error estimate for blocks of size 2^( 4) =       0.000271610129
  error estimate for blocks of size 2^( 5) =       0.000274939233
  error estimate for blocks of size 2^( 6) =       0.000276596656
  error estimate for blocks of size 2^( 7) =       0.000277472495
  error estimate for blocks of size 2^( 8) =       0.000278048590
  error estimate for blocks of size 2^( 9) =       0.000277596763

      target function =                  N/A
              le_mean =     -22.669279190535
             les_mean =     514.485049800067
             stat err =       0.000277428626
             autocorr =       1.244196703790
              std dev =       0.703479978390
             le_variance =       0.494884079995

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.495190107439
                                         uncertainty =       0.001337435566

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.495190107439
                                         uncertainty =       0.001337435566

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000248794133
  error estimate for blocks of size 2^( 2) =       0.000257841000
  error estimate for blocks of size 2^( 3) =       0.000265941771
  error estimate for blocks of size 2^( 4) =       0.000271683466
  error estimate for blocks of size 2^( 5) =       0.000275022682
  error estimate for blocks of size 2^( 6) =       0.000276698266
  error estimate for blocks of size 2^( 7) =       0.000277579213
  error estimate for blocks of size 2^( 8) =       0.000278172380
  error estimate for blocks of size 2^( 9) =       0.000277754069

      target function =                  N/A
              le_mean =     -22.669270391556
             les_mean =     518.713585314233
             stat err =       0.000277550982
             autocorr =       1.244529702618
              std dev =       0.703696074986
             le_variance =       0.495188165951

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.494827683230
                                         uncertainty =       0.001291037778

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.494827683230
                                         uncertainty =       0.001291037778

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000248703167
  error estimate for blocks of size 2^( 2) =       0.000257754504
  error estimate for blocks of size 2^( 3) =       0.000265857696
  error estimate for blocks of size 2^( 4) =       0.000271608246
  error estimate for blocks of size 2^( 5) =       0.000274937643
  error estimate for blocks of size 2^( 6) =       0.000276593904
  error estimate for blocks of size 2^( 7) =       0.000277464480
  error estimate for blocks of size 2^( 8) =       0.000278074804
  error estimate for blocks of size 2^( 9) =       0.000277600876

      target function =                  N/A
              le_mean =     -22.669278319048
             les_mean =     514.483608006587
             stat err =       0.000277433516
             autocorr =       1.244386293018
              std dev =       0.703438784587
             le_variance =       0.494826123661


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.669282472970        initial  <--
     9.7656e-02     9.7656e-01             2.0026e-03       -22.669279190535
     3.9062e-01     3.9062e+00             6.6901e-04       -22.669270391556
     1.5625e+00     1.5625e+01             1.8219e-04       -22.669278319048

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 173.3623
  </log>
  <optVariables href="FORM.s007.opt.xml">
ci_001                -7.062417e-01 3 1  ON 0
ci_002                -7.040645e-01 3 1  ON 1
ci_003                -4.389043e-02 3 1  ON 2
ci_004                -4.344204e-02 3 1  ON 3
ci_005                 1.631810e-02 3 1  ON 4
ci_006                 1.615913e-02 3 1  ON 5
ci_007                 1.273350e-02 3 1  ON 6
ci_008                 1.323198e-02 3 1  ON 7
ci_009                -1.157904e-02 3 1  ON 8
ci_010                -1.185403e-02 3 1  ON 9
ci_011                -8.799935e-03 3 1  ON 10
ci_012                -8.607191e-03 3 1  ON 11
ci_013                 9.298554e-03 3 1  ON 12
ci_014                 9.424251e-03 3 1  ON 13
ci_015                 1.243458e-02 3 1  ON 14
ci_016                 1.270917e-02 3 1  ON 15
ci_017                 1.093164e-02 3 1  ON 16
ci_018                 1.099369e-02 3 1  ON 17
ci_019                -1.993358e-03 3 1  ON 18
ci_020                -1.125320e-03 3 1  ON 19
ci_021                -8.286967e-03 3 1  ON 20
ci_022                -8.248907e-03 3 1  ON 21
ci_023                 7.231142e-03 3 1  ON 22
ci_024                 7.856568e-03 3 1  ON 23
ci_025                 4.342305e-03 3 1  ON 24
ci_026                 4.060494e-03 3 1  ON 25
ci_027                 6.494076e-03 3 1  ON 26
ci_028                 6.605437e-03 3 1  ON 27
ci_029                -4.661593e-03 3 1  ON 28
ci_030                -4.270881e-03 3 1  ON 29
ci_031                -8.003778e-03 3 1  ON 30
ci_032                -7.366384e-03 3 1  ON 31
ci_033                 4.757638e-03 3 1  ON 32
ci_034                 4.452782e-03 3 1  ON 33
ci_035                 1.352210e-03 3 1  ON 34
ci_036                 1.419377e-03 3 1  ON 35
ci_037                 5.065610e-03 3 1  ON 36
ci_038                 5.482552e-03 3 1  ON 37
ci_039                 5.792269e-03 3 1  ON 38
ci_040                 5.607099e-03 3 1  ON 39
ci_041                 4.963075e-03 3 1  ON 40
ci_042                 4.859268e-03 3 1  ON 41
ci_043                 4.756960e-03 3 1  ON 42
ci_044                 4.914929e-03 3 1  ON 43
ci_045                 3.637010e-03 3 1  ON 44
ci_046                 3.293787e-03 3 1  ON 45
ci_047                -7.621160e-04 3 1  ON 46
ci_048                -6.874636e-04 3 1  ON 47
ci_049                 1.663142e-03 3 1  ON 48
ci_050                 1.484271e-03 3 1  ON 49
ci_051                -1.631996e-03 3 1  ON 50
ci_052                -1.394748e-03 3 1  ON 51
ci_053                -2.964633e-03 3 1  ON 52
ci_054                -2.674728e-03 3 1  ON 53
ci_055                -1.841486e-03 3 1  ON 54
ci_056                -1.563224e-03 3 1  ON 55
ci_057                -1.213750e-03 3 1  ON 56
ci_058                -1.338980e-03 3 1  ON 57
ci_059                 4.879082e-04 3 1  ON 58
ci_060                 3.881281e-04 3 1  ON 59
ci_061                -4.010925e-04 3 1  ON 60
ci_062                -3.610444e-04 3 1  ON 61
ci_063                -6.526334e-04 3 1  ON 62
ci_064                -4.596853e-04 3 1  ON 63
ci_065                -2.669928e-03 3 1  ON 64
ci_066                -2.915307e-03 3 1  ON 65
ci_067                -2.105569e-03 3 1  ON 66
ci_068                -2.035325e-03 3 1  ON 67
ci_069                 1.448672e-04 3 1  ON 68
ci_070                 1.400036e-05 3 1  ON 69
ci_071                -2.075080e-03 3 1  ON 70
ci_072                -2.392488e-03 3 1  ON 71
ci_073                 6.209391e-05 3 1  ON 72
ci_074                 3.943932e-04 3 1  ON 73
ci_075                -2.639439e-04 3 1  ON 74
ci_076                -3.760809e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 2.9507e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s008 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s008 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=8  my_counter=0
  time step      = 5.0000e-02
  blocks         = 250
  steps          = 250
  substeps       = 10
  current        = 0
  target samples = 8.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">250</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">6.2500e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">8.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">6.2500e+04</parameter>
<parameter name="steps" condition="int">250</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2666e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="250">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =8000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 8
    time step          = 0.05
    reference energy   = -22.6056
    reference variance = 0.428823
====================================================
  Execution time = 1.0262e+02
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s008
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 62500 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 6.1090e+04
  VMC Eavg = -2.2669e+01
  VMC Evar = 5.0829e-01
  Total weights = 7.820548671e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.8795e+01
  </log>
</opt>
<opt stage="main" walkers="62500">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.495593081517
                                         uncertainty =       0.002675067017

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.495593081517
                                         uncertainty =       0.002675067017

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000248895457
  error estimate for blocks of size 2^( 2) =       0.000257909606
  error estimate for blocks of size 2^( 3) =       0.000266059194
  error estimate for blocks of size 2^( 4) =       0.000271821646
  error estimate for blocks of size 2^( 5) =       0.000274933611
  error estimate for blocks of size 2^( 6) =       0.000275947024
  error estimate for blocks of size 2^( 7) =       0.000276779090
  error estimate for blocks of size 2^( 8) =       0.000275596444
  error estimate for blocks of size 2^( 9) =       0.000277464200

      target function =                  N/A
              le_mean =     -22.669389866216
             les_mean =     514.409524671798
             stat err =       0.000276446689
             autocorr =       1.233641150468
              std dev =       0.703982661611
             le_variance =       0.495591587849


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266938986622e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.7656e-01, overlap shift 9.7656e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.669389866239       residual = 9.25e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.669393974804       residual = 1.13e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.669393855419       residual = 4.47e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.669393844892       residual = 1.76e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 9.7656e-01 is 3.605511e-04

solving harmonic davidson linear method for identity shift 3.9062e+00, overlap shift 3.9062e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.669389866239       residual = 9.25e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.669390998517       residual = 1.43e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.669390934669       residual = 5.48e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.669390935694       residual = 1.99e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 3.9062e+00 is 9.371401e-05

solving harmonic davidson linear method for identity shift 1.5625e+01, overlap shift 1.5625e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.669389866239       residual = 9.25e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.669390156742       residual = 1.58e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.669390138442       residual = 6.03e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.669390138880       residual = 2.10e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 1.5625e+01 is 2.367385e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.019198 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.2143e+02
  </log>
  <optVariables href="FORM.s008.opt.xml">
ci_001                -7.062438e-01 3 1  ON 0
ci_002                -7.040754e-01 3 1  ON 1
ci_003                -4.379671e-02 3 1  ON 2
ci_004                -4.336943e-02 3 1  ON 3
ci_005                 1.632050e-02 3 1  ON 4
ci_006                 1.615948e-02 3 1  ON 5
ci_007                 1.270345e-02 3 1  ON 6
ci_008                 1.320806e-02 3 1  ON 7
ci_009                -1.157343e-02 3 1  ON 8
ci_010                -1.184836e-02 3 1  ON 9
ci_011                -8.778396e-03 3 1  ON 10
ci_012                -8.603400e-03 3 1  ON 11
ci_013                 9.262306e-03 3 1  ON 12
ci_014                 9.405491e-03 3 1  ON 13
ci_015                 1.243583e-02 3 1  ON 14
ci_016                 1.269924e-02 3 1  ON 15
ci_017                 1.089297e-02 3 1  ON 16
ci_018                 1.100481e-02 3 1  ON 17
ci_019                -2.034924e-03 3 1  ON 18
ci_020                -1.163619e-03 3 1  ON 19
ci_021                -8.268575e-03 3 1  ON 20
ci_022                -8.250899e-03 3 1  ON 21
ci_023                 7.250729e-03 3 1  ON 22
ci_024                 7.861131e-03 3 1  ON 23
ci_025                 4.305519e-03 3 1  ON 24
ci_026                 4.035988e-03 3 1  ON 25
ci_027                 6.507259e-03 3 1  ON 26
ci_028                 6.563043e-03 3 1  ON 27
ci_029                -4.660023e-03 3 1  ON 28
ci_030                -4.301134e-03 3 1  ON 29
ci_031                -7.998101e-03 3 1  ON 30
ci_032                -7.366698e-03 3 1  ON 31
ci_033                 4.730328e-03 3 1  ON 32
ci_034                 4.457306e-03 3 1  ON 33
ci_035                 1.363452e-03 3 1  ON 34
ci_036                 1.412378e-03 3 1  ON 35
ci_037                 5.065535e-03 3 1  ON 36
ci_038                 5.497173e-03 3 1  ON 37
ci_039                 5.830013e-03 3 1  ON 38
ci_040                 5.584026e-03 3 1  ON 39
ci_041                 4.990951e-03 3 1  ON 40
ci_042                 4.861221e-03 3 1  ON 41
ci_043                 4.820994e-03 3 1  ON 42
ci_044                 4.937542e-03 3 1  ON 43
ci_045                 3.555685e-03 3 1  ON 44
ci_046                 3.281279e-03 3 1  ON 45
ci_047                -7.597292e-04 3 1  ON 46
ci_048                -6.779659e-04 3 1  ON 47
ci_049                 1.649134e-03 3 1  ON 48
ci_050                 1.510294e-03 3 1  ON 49
ci_051                -1.656717e-03 3 1  ON 50
ci_052                -1.381851e-03 3 1  ON 51
ci_053                -2.993822e-03 3 1  ON 52
ci_054                -2.643513e-03 3 1  ON 53
ci_055                -1.824237e-03 3 1  ON 54
ci_056                -1.581480e-03 3 1  ON 55
ci_057                -1.239293e-03 3 1  ON 56
ci_058                -1.343801e-03 3 1  ON 57
ci_059                 4.680827e-04 3 1  ON 58
ci_060                 4.076475e-04 3 1  ON 59
ci_061                -3.474420e-04 3 1  ON 60
ci_062                -3.276567e-04 3 1  ON 61
ci_063                -6.221263e-04 3 1  ON 62
ci_064                -4.443594e-04 3 1  ON 63
ci_065                -2.653277e-03 3 1  ON 64
ci_066                -2.887023e-03 3 1  ON 65
ci_067                -2.109236e-03 3 1  ON 66
ci_068                -2.073993e-03 3 1  ON 67
ci_069                 1.452040e-04 3 1  ON 68
ci_070                -2.436181e-05 3 1  ON 69
ci_071                -2.114412e-03 3 1  ON 70
ci_072                -2.375796e-03 3 1  ON 71
ci_073                 1.246029e-04 3 1  ON 72
ci_074                 3.743434e-04 3 1  ON 73
ci_075                -2.316780e-04 3 1  ON 74
ci_076                -3.618255e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="250">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =8000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 8
    time step          = 0.05
    reference energy   = -22.6866
    reference variance = 0.533253
====================================================
  Execution time = 1.0044e+02
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s008
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 62500 
  VMC Eavg = -2.2670e+01
  VMC Evar = 5.1216e-01
  Total weights = 7.8202e+06
  Execution time = 1.4651e+01
  </log>
</opt>
<opt stage="main" walkers="62500">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

ERROR CostFunction-> Number of Effective Walkers is too small! 
  Number of effective walkers (samples) / total number of samples = 0.219839
  User specified threshold minwalkers = 0.3
  If this message appears frequently. You might have to be cautious. 
  Find info about parameter "minwalkers" in the user manual!
Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.499312339664
                                         uncertainty =       0.002324071754

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.499312339664
                                         uncertainty =       0.002324071754

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000249826730
  error estimate for blocks of size 2^( 2) =       0.000258822970
  error estimate for blocks of size 2^( 3) =       0.000266801605
  error estimate for blocks of size 2^( 4) =       0.000272722808
  error estimate for blocks of size 2^( 5) =       0.000275821713
  error estimate for blocks of size 2^( 6) =       0.000278476495
  error estimate for blocks of size 2^( 7) =       0.000279695732
  error estimate for blocks of size 2^( 8) =       0.000279252276
  error estimate for blocks of size 2^( 9) =       0.000280897029

      target function =                  N/A
              le_mean =     -22.669819226280
             les_mean =     514.433211978699
             stat err =       0.000279580383
             autocorr =       1.252378442428
              std dev =       0.706616700150
             le_variance =       0.499307160932

ERROR CostFunction-> Number of Effective Walkers is too small! 
  Number of effective walkers (samples) / total number of samples = 0.00573023
  User specified threshold minwalkers = 0.3
  If this message appears frequently. You might have to be cautious. 
  Find info about parameter "minwalkers" in the user manual!
Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.499300809708
                                         uncertainty =       0.002332413257

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.499300809708
                                         uncertainty =       0.002332413257

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000249823842
  error estimate for blocks of size 2^( 2) =       0.000258819519
  error estimate for blocks of size 2^( 3) =       0.000266797743
  error estimate for blocks of size 2^( 4) =       0.000272717919
  error estimate for blocks of size 2^( 5) =       0.000275815407
  error estimate for blocks of size 2^( 6) =       0.000278470204
  error estimate for blocks of size 2^( 7) =       0.000279687899
  error estimate for blocks of size 2^( 8) =       0.000279244495
  error estimate for blocks of size 2^( 9) =       0.000280890138

      target function =                  N/A
              le_mean =     -22.669819840329
             les_mean =     514.433988617756
             stat err =       0.000279573184
             autocorr =       1.252342904269
              std dev =       0.706608530994
             le_variance =       0.499295616073

ERROR CostFunction-> Number of Effective Walkers is too small! 
  Number of effective walkers (samples) / total number of samples = 0.213311
  User specified threshold minwalkers = 0.3
  If this message appears frequently. You might have to be cautious. 
  Find info about parameter "minwalkers" in the user manual!
Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.499304474841
                                         uncertainty =       0.002328791210

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.499304474841
                                         uncertainty =       0.002328791210

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000249824761
  error estimate for blocks of size 2^( 2) =       0.000258820713
  error estimate for blocks of size 2^( 3) =       0.000266799110
  error estimate for blocks of size 2^( 4) =       0.000272719818
  error estimate for blocks of size 2^( 5) =       0.000275817925
  error estimate for blocks of size 2^( 6) =       0.000278472660
  error estimate for blocks of size 2^( 7) =       0.000279690926
  error estimate for blocks of size 2^( 8) =       0.000279247559
  error estimate for blocks of size 2^( 9) =       0.000280892748

      target function =                  N/A
              le_mean =     -22.669819336851
             les_mean =     514.433115577676
             stat err =       0.000279575973
             autocorr =       1.252358680265
              std dev =       0.706611129533
             le_variance =       0.499299288380

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.499311032030
                                         uncertainty =       0.002324681246

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.499311032030
                                         uncertainty =       0.002324681246

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000249826403
  error estimate for blocks of size 2^( 2) =       0.000258822603
  error estimate for blocks of size 2^( 3) =       0.000266801227
  error estimate for blocks of size 2^( 4) =       0.000272722384
  error estimate for blocks of size 2^( 5) =       0.000275821190
  error estimate for blocks of size 2^( 6) =       0.000278475980
  error estimate for blocks of size 2^( 7) =       0.000279695076
  error estimate for blocks of size 2^( 8) =       0.000279251578
  error estimate for blocks of size 2^( 9) =       0.000280896297

      target function =                  N/A
              le_mean =     -22.669819176976
             les_mean =     514.433085118019
             stat err =       0.000279579733
             autocorr =       1.252375900124
              std dev =       0.706615774184
             le_variance =       0.499305852326


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.669819226280        initial
     9.7656e-01     9.7656e+00             3.6055e-04       -22.669819840329  <--
     3.9062e+00     3.9062e+01             9.3714e-05       -22.669819336851
     1.5625e+01     1.5625e+02             2.3674e-05       -22.669819176976

*****************************************************************************
Applying the update for shift_i =   9.7656e-01     and shift_s =   9.7656e+00
*****************************************************************************

  Execution time = 1.7374e+02
  </log>
  <optVariables href="FORM.s008.opt.xml">
ci_001                -7.062488e-01 3 1  ON 0
ci_002                -7.041065e-01 3 1  ON 1
ci_003                -4.352988e-02 3 1  ON 2
ci_004                -4.316103e-02 3 1  ON 3
ci_005                 1.632565e-02 3 1  ON 4
ci_006                 1.616078e-02 3 1  ON 5
ci_007                 1.262962e-02 3 1  ON 6
ci_008                 1.314542e-02 3 1  ON 7
ci_009                -1.155981e-02 3 1  ON 8
ci_010                -1.183478e-02 3 1  ON 9
ci_011                -8.725762e-03 3 1  ON 10
ci_012                -8.596652e-03 3 1  ON 11
ci_013                 9.169954e-03 3 1  ON 12
ci_014                 9.357552e-03 3 1  ON 13
ci_015                 1.243967e-02 3 1  ON 14
ci_016                 1.267493e-02 3 1  ON 15
ci_017                 1.079250e-02 3 1  ON 16
ci_018                 1.103467e-02 3 1  ON 17
ci_019                -2.144013e-03 3 1  ON 18
ci_020                -1.265723e-03 3 1  ON 19
ci_021                -8.219138e-03 3 1  ON 20
ci_022                -8.256009e-03 3 1  ON 21
ci_023                 7.298572e-03 3 1  ON 22
ci_024                 7.873126e-03 3 1  ON 23
ci_025                 4.210390e-03 3 1  ON 24
ci_026                 3.973183e-03 3 1  ON 25
ci_027                 6.537357e-03 3 1  ON 26
ci_028                 6.463614e-03 3 1  ON 27
ci_029                -4.656739e-03 3 1  ON 28
ci_030                -4.380610e-03 3 1  ON 29
ci_031                -7.982658e-03 3 1  ON 30
ci_032                -7.366743e-03 3 1  ON 31
ci_033                 4.663948e-03 3 1  ON 32
ci_034                 4.469572e-03 3 1  ON 33
ci_035                 1.387613e-03 3 1  ON 34
ci_036                 1.395333e-03 3 1  ON 35
ci_037                 5.063001e-03 3 1  ON 36
ci_038                 5.533987e-03 3 1  ON 37
ci_039                 5.918742e-03 3 1  ON 38
ci_040                 5.529829e-03 3 1  ON 39
ci_041                 5.059230e-03 3 1  ON 40
ci_042                 4.866654e-03 3 1  ON 41
ci_043                 4.986376e-03 3 1  ON 42
ci_044                 4.993473e-03 3 1  ON 43
ci_045                 3.346652e-03 3 1  ON 44
ci_046                 3.248475e-03 3 1  ON 45
ci_047                -7.539792e-04 3 1  ON 46
ci_048                -6.557438e-04 3 1  ON 47
ci_049                 1.612574e-03 3 1  ON 48
ci_050                 1.577200e-03 3 1  ON 49
ci_051                -1.716116e-03 3 1  ON 50
ci_052                -1.346569e-03 3 1  ON 51
ci_053                -3.071806e-03 3 1  ON 52
ci_054                -2.561353e-03 3 1  ON 53
ci_055                -1.779775e-03 3 1  ON 54
ci_056                -1.630417e-03 3 1  ON 55
ci_057                -1.303473e-03 3 1  ON 56
ci_058                -1.355366e-03 3 1  ON 57
ci_059                 4.182119e-04 3 1  ON 58
ci_060                 4.554435e-04 3 1  ON 59
ci_061                -2.073185e-04 3 1  ON 60
ci_062                -2.431410e-04 3 1  ON 61
ci_063                -5.449844e-04 3 1  ON 62
ci_064                -4.055476e-04 3 1  ON 63
ci_065                -2.611026e-03 3 1  ON 64
ci_066                -2.812241e-03 3 1  ON 65
ci_067                -2.119366e-03 3 1  ON 66
ci_068                -2.174202e-03 3 1  ON 67
ci_069                 1.458276e-04 3 1  ON 68
ci_070                -1.240144e-04 3 1  ON 69
ci_071                -2.212938e-03 3 1  ON 70
ci_072                -2.332986e-03 3 1  ON 71
ci_073                 2.732430e-04 3 1  ON 72
ci_074                 3.255488e-04 3 1  ON 73
ci_075                -1.499987e-04 3 1  ON 74
ci_076                -3.246486e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 2.9518e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s009 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s009 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=9  my_counter=0
  time step      = 5.0000e-02
  blocks         = 250
  steps          = 250
  substeps       = 10
  current        = 0
  target samples = 8.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">250</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">6.2500e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">8.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">6.2500e+04</parameter>
<parameter name="steps" condition="int">250</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2664e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="250">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =8000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 9
    time step          = 0.05
    reference energy   = -22.6887
    reference variance = 0.418231
====================================================
  Execution time = 1.0257e+02
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s009
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 62500 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 6.1135e+04
  VMC Eavg = -2.2670e+01
  VMC Evar = 5.0998e-01
  Total weights = 7.820560227e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.9045e+01
  </log>
</opt>
<opt stage="main" walkers="62500">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.497014650065
                                         uncertainty =       0.002627091798

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.497014650065
                                         uncertainty =       0.002627091798

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000249252566
  error estimate for blocks of size 2^( 2) =       0.000258131680
  error estimate for blocks of size 2^( 3) =       0.000266205365
  error estimate for blocks of size 2^( 4) =       0.000271795286
  error estimate for blocks of size 2^( 5) =       0.000275247505
  error estimate for blocks of size 2^( 6) =       0.000277547090
  error estimate for blocks of size 2^( 7) =       0.000278356645
  error estimate for blocks of size 2^( 8) =       0.000278488825
  error estimate for blocks of size 2^( 9) =       0.000278953026

      target function =                  N/A
              le_mean =     -22.669593434767
             les_mean =     514.420442235073
             stat err =       0.000278336396
             autocorr =       1.246983550562
              std dev =       0.704992718457
             le_variance =       0.497014733078


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266959343477e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.4414e-01, overlap shift 2.4414e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.669593434790       residual = 1.18e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.669595032941       residual = 1.34e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.669599871568       residual = 4.66e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.669600065868       residual = 1.90e-08           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.669600070687       residual = 6.45e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          4 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 2.4414e-01 is 3.266234e-03

solving harmonic davidson linear method for identity shift 9.7656e-01, overlap shift 9.7656e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.669593434790       residual = 1.18e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.669593988441       residual = 1.05e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.669595362790       residual = 1.42e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.669595388730       residual = 3.08e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 9.7656e-01 is 1.078442e-03

solving harmonic davidson linear method for identity shift 3.9062e+00, overlap shift 3.9062e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.669593434790       residual = 1.18e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.669593587975       residual = 1.10e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.669593948567       residual = 1.41e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.669593944477       residual = 2.69e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 3.9062e+00 is 2.934382e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.020650 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.2163e+02
  </log>
  <optVariables href="FORM.s009.opt.xml">
ci_001                -7.059999e-01 3 1  ON 0
ci_002                -7.043615e-01 3 1  ON 1
ci_003                -4.330754e-02 3 1  ON 2
ci_004                -4.281193e-02 3 1  ON 3
ci_005                 1.627054e-02 3 1  ON 4
ci_006                 1.621993e-02 3 1  ON 5
ci_007                 1.250082e-02 3 1  ON 6
ci_008                 1.314322e-02 3 1  ON 7
ci_009                -1.120439e-02 3 1  ON 8
ci_010                -1.186380e-02 3 1  ON 9
ci_011                -8.794913e-03 3 1  ON 10
ci_012                -8.522190e-03 3 1  ON 11
ci_013                 9.185532e-03 3 1  ON 12
ci_014                 9.424112e-03 3 1  ON 13
ci_015                 1.251131e-02 3 1  ON 14
ci_016                 1.375337e-02 3 1  ON 15
ci_017                 1.105822e-02 3 1  ON 16
ci_018                 1.104934e-02 3 1  ON 17
ci_019                -2.149330e-03 3 1  ON 18
ci_020                -1.516695e-03 3 1  ON 19
ci_021                -8.519384e-03 3 1  ON 20
ci_022                -8.386113e-03 3 1  ON 21
ci_023                 7.472198e-03 3 1  ON 22
ci_024                 7.967264e-03 3 1  ON 23
ci_025                 4.163002e-03 3 1  ON 24
ci_026                 3.941253e-03 3 1  ON 25
ci_027                 6.701684e-03 3 1  ON 26
ci_028                 6.419940e-03 3 1  ON 27
ci_029                -4.788869e-03 3 1  ON 28
ci_030                -4.303740e-03 3 1  ON 29
ci_031                -8.208977e-03 3 1  ON 30
ci_032                -7.612415e-03 3 1  ON 31
ci_033                 4.035748e-03 3 1  ON 32
ci_034                 4.439322e-03 3 1  ON 33
ci_035                 1.373325e-03 3 1  ON 34
ci_036                 1.300262e-03 3 1  ON 35
ci_037                 4.864406e-03 3 1  ON 36
ci_038                 5.422992e-03 3 1  ON 37
ci_039                 5.942779e-03 3 1  ON 38
ci_040                 5.588217e-03 3 1  ON 39
ci_041                 5.026284e-03 3 1  ON 40
ci_042                 4.968729e-03 3 1  ON 41
ci_043                 4.988391e-03 3 1  ON 42
ci_044                 4.953221e-03 3 1  ON 43
ci_045                 3.125017e-03 3 1  ON 44
ci_046                 3.303064e-03 3 1  ON 45
ci_047                -7.513453e-04 3 1  ON 46
ci_048                -6.249205e-04 3 1  ON 47
ci_049                 1.771372e-03 3 1  ON 48
ci_050                 1.626997e-03 3 1  ON 49
ci_051                -1.570699e-03 3 1  ON 50
ci_052                -1.337716e-03 3 1  ON 51
ci_053                -3.069593e-03 3 1  ON 52
ci_054                -2.554209e-03 3 1  ON 53
ci_055                -1.771189e-03 3 1  ON 54
ci_056                -2.610850e-03 3 1  ON 55
ci_057                -1.255925e-03 3 1  ON 56
ci_058                -1.325444e-03 3 1  ON 57
ci_059                 2.858858e-04 3 1  ON 58
ci_060                 4.770128e-04 3 1  ON 59
ci_061                -4.197603e-04 3 1  ON 60
ci_062                -2.751666e-04 3 1  ON 61
ci_063                -7.943058e-04 3 1  ON 62
ci_064                -5.654550e-04 3 1  ON 63
ci_065                -2.712300e-03 3 1  ON 64
ci_066                -2.895239e-03 3 1  ON 65
ci_067                -2.145077e-03 3 1  ON 66
ci_068                -2.754161e-03 3 1  ON 67
ci_069                 1.009737e-04 3 1  ON 68
ci_070                -2.620765e-05 3 1  ON 69
ci_071                -1.857529e-03 3 1  ON 70
ci_072                -2.275026e-03 3 1  ON 71
ci_073                 2.537772e-04 3 1  ON 72
ci_074                 5.370752e-04 3 1  ON 73
ci_075                -1.964998e-04 3 1  ON 74
ci_076                -2.508188e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="250">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =8000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 9
    time step          = 0.05
    reference energy   = -22.7001
    reference variance = 0.390714
====================================================
  Execution time = 9.9784e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s009
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 62500 
  VMC Eavg = -2.2670e+01
  VMC Evar = 5.1310e-01
  Total weights = 7.8203e+06
  Execution time = 1.4640e+01
  </log>
</opt>
<opt stage="main" walkers="62500">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.499546554728
                                         uncertainty =       0.001735878656

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.499546554728
                                         uncertainty =       0.001735878656

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000249886712
  error estimate for blocks of size 2^( 2) =       0.000258835970
  error estimate for blocks of size 2^( 3) =       0.000267122290
  error estimate for blocks of size 2^( 4) =       0.000272752663
  error estimate for blocks of size 2^( 5) =       0.000276185115
  error estimate for blocks of size 2^( 6) =       0.000277771845
  error estimate for blocks of size 2^( 7) =       0.000278475845
  error estimate for blocks of size 2^( 8) =       0.000278853059
  error estimate for blocks of size 2^( 9) =       0.000278758110

      target function =                  N/A
              le_mean =     -22.669638176843
             les_mean =     514.463642489049
             stat err =       0.000278464715
             autocorr =       1.241806761092
              std dev =       0.706786353643
             le_variance =       0.499546949696

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.500104359141
                                         uncertainty =       0.001753085801

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.500104359141
                                         uncertainty =       0.001753085801

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000250026160
  error estimate for blocks of size 2^( 2) =       0.000258971687
  error estimate for blocks of size 2^( 3) =       0.000267257249
  error estimate for blocks of size 2^( 4) =       0.000272890679
  error estimate for blocks of size 2^( 5) =       0.000276318214
  error estimate for blocks of size 2^( 6) =       0.000277908680
  error estimate for blocks of size 2^( 7) =       0.000278604632
  error estimate for blocks of size 2^( 8) =       0.000279012389
  error estimate for blocks of size 2^( 9) =       0.000278933818

      target function =                  N/A
              le_mean =     -22.669644551221
             les_mean =     514.430192491509
             stat err =       0.000278614880
             autocorr =       1.241760130820
              std dev =       0.707180772302
             le_variance =       0.500104644714

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.499824880531
                                         uncertainty =       0.001745546578

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.499824880531
                                         uncertainty =       0.001745546578

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000249956294
  error estimate for blocks of size 2^( 2) =       0.000258903434
  error estimate for blocks of size 2^( 3) =       0.000267189248
  error estimate for blocks of size 2^( 4) =       0.000272821453
  error estimate for blocks of size 2^( 5) =       0.000276251112
  error estimate for blocks of size 2^( 6) =       0.000277840351
  error estimate for blocks of size 2^( 7) =       0.000278540758
  error estimate for blocks of size 2^( 8) =       0.000278940124
  error estimate for blocks of size 2^( 9) =       0.000278844982

      target function =                  N/A
              le_mean =     -22.669630871831
             les_mean =     514.609648180972
             stat err =       0.000278541554
             autocorr =       1.241800505717
              std dev =       0.706983163093
             le_variance =       0.499825192896

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.499557224312
                                         uncertainty =       0.001736122225

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.499557224312
                                         uncertainty =       0.001736122225

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000249889374
  error estimate for blocks of size 2^( 2) =       0.000258838616
  error estimate for blocks of size 2^( 3) =       0.000267124551
  error estimate for blocks of size 2^( 4) =       0.000272756528
  error estimate for blocks of size 2^( 5) =       0.000276187744
  error estimate for blocks of size 2^( 6) =       0.000277778630
  error estimate for blocks of size 2^( 7) =       0.000278487392
  error estimate for blocks of size 2^( 8) =       0.000278863200
  error estimate for blocks of size 2^( 9) =       0.000278760000

      target function =                  N/A
              le_mean =     -22.669635019977
             les_mean =     514.430774483494
             stat err =       0.000278472305
             autocorr =       1.241848000134
              std dev =       0.706793883823
             le_variance =       0.499557594209


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.669638176843        initial
     2.4414e-01     2.4414e+00             3.2662e-03       -22.669644551221  <--
     9.7656e-01     9.7656e+00             1.0784e-03       -22.669630871831
     3.9062e+00     3.9062e+01             2.9344e-04       -22.669635019977

*****************************************************************************
Applying the update for shift_i =   2.4414e-01     and shift_s =   2.4414e+00
*****************************************************************************

  Execution time = 1.7299e+02
  </log>
  <optVariables href="FORM.s009.opt.xml">
ci_001                -7.052458e-01 3 1  ON 0
ci_002                -7.051513e-01 3 1  ON 1
ci_003                -4.277701e-02 3 1  ON 2
ci_004                -4.192375e-02 3 1  ON 3
ci_005                 1.616829e-02 3 1  ON 4
ci_006                 1.631790e-02 3 1  ON 5
ci_007                 1.225279e-02 3 1  ON 6
ci_008                 1.314986e-02 3 1  ON 7
ci_009                -1.055932e-02 3 1  ON 8
ci_010                -1.191840e-02 3 1  ON 9
ci_011                -8.909781e-03 3 1  ON 10
ci_012                -8.352417e-03 3 1  ON 11
ci_013                 9.176706e-03 3 1  ON 12
ci_014                 9.542938e-03 3 1  ON 13
ci_015                 1.265375e-02 3 1  ON 14
ci_016                 1.594116e-02 3 1  ON 15
ci_017                 1.143597e-02 3 1  ON 16
ci_018                 1.106387e-02 3 1  ON 17
ci_019                -2.138753e-03 3 1  ON 18
ci_020                -2.034018e-03 3 1  ON 19
ci_021                -9.076220e-03 3 1  ON 20
ci_022                -8.583977e-03 3 1  ON 21
ci_023                 7.748989e-03 3 1  ON 22
ci_024                 8.127192e-03 3 1  ON 23
ci_025                 4.076568e-03 3 1  ON 24
ci_026                 3.916535e-03 3 1  ON 25
ci_027                 6.931950e-03 3 1  ON 26
ci_028                 6.355444e-03 3 1  ON 27
ci_029                -4.980596e-03 3 1  ON 28
ci_030                -4.159608e-03 3 1  ON 29
ci_031                -8.619256e-03 3 1  ON 30
ci_032                -8.070295e-03 3 1  ON 31
ci_033                 2.883923e-03 3 1  ON 32
ci_034                 4.376332e-03 3 1  ON 33
ci_035                 1.345202e-03 3 1  ON 34
ci_036                 1.152403e-03 3 1  ON 35
ci_037                 4.502244e-03 3 1  ON 36
ci_038                 5.225701e-03 3 1  ON 37
ci_039                 5.970162e-03 3 1  ON 38
ci_040                 5.676155e-03 3 1  ON 39
ci_041                 4.968523e-03 3 1  ON 40
ci_042                 5.144239e-03 3 1  ON 41
ci_043                 5.002905e-03 3 1  ON 42
ci_044                 4.889007e-03 3 1  ON 43
ci_045                 2.762942e-03 3 1  ON 44
ci_046                 3.405914e-03 3 1  ON 45
ci_047                -7.498782e-04 3 1  ON 46
ci_048                -5.905521e-04 3 1  ON 47
ci_049                 2.069480e-03 3 1  ON 48
ci_050                 1.722323e-03 3 1  ON 49
ci_051                -1.316372e-03 3 1  ON 50
ci_052                -1.325123e-03 3 1  ON 51
ci_053                -3.039691e-03 3 1  ON 52
ci_054                -2.533016e-03 3 1  ON 53
ci_055                -1.735915e-03 3 1  ON 54
ci_056                -4.418933e-03 3 1  ON 55
ci_057                -1.178914e-03 3 1  ON 56
ci_058                -1.277649e-03 3 1  ON 57
ci_059                 8.953317e-05 3 1  ON 58
ci_060                 4.898342e-04 3 1  ON 59
ci_061                -6.979496e-04 3 1  ON 60
ci_062                -3.362915e-04 3 1  ON 61
ci_063                -1.253751e-03 3 1  ON 62
ci_064                -8.650560e-04 3 1  ON 63
ci_065                -2.858171e-03 3 1  ON 64
ci_066                -3.069670e-03 3 1  ON 65
ci_067                -2.191068e-03 3 1  ON 66
ci_068                -3.750968e-03 3 1  ON 67
ci_069                 3.350640e-05 3 1  ON 68
ci_070                 1.412460e-04 3 1  ON 69
ci_071                -1.210799e-03 3 1  ON 70
ci_072                -2.174576e-03 3 1  ON 71
ci_073                 2.313943e-04 3 1  ON 72
ci_074                 8.467491e-04 3 1  ON 73
ci_075                -2.712739e-04 3 1  ON 74
ci_076                -1.183291e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 2.9463e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s010 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s010 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=10  my_counter=0
  time step      = 5.0000e-02
  blocks         = 250
  steps          = 250
  substeps       = 10
  current        = 0
  target samples = 8.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">250</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">6.2500e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">8.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">6.2500e+04</parameter>
<parameter name="steps" condition="int">250</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2667e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="250">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =8000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 10
    time step          = 0.05
    reference energy   = -22.6241
    reference variance = 0.570648
====================================================
  Execution time = 1.0198e+02
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s010
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 62500 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 6.1123e+04
  VMC Eavg = -2.2669e+01
  VMC Evar = 5.1557e-01
  Total weights = 7.820174555e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.9023e+01
  </log>
</opt>
<opt stage="main" walkers="62500">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.503200252272
                                         uncertainty =       0.005460284367

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.503200252272
                                         uncertainty =       0.005460284367

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000250797922
  error estimate for blocks of size 2^( 2) =       0.000259619951
  error estimate for blocks of size 2^( 3) =       0.000267626547
  error estimate for blocks of size 2^( 4) =       0.000273267257
  error estimate for blocks of size 2^( 5) =       0.000276811809
  error estimate for blocks of size 2^( 6) =       0.000278363859
  error estimate for blocks of size 2^( 7) =       0.000278537837
  error estimate for blocks of size 2^( 8) =       0.000278451341
  error estimate for blocks of size 2^( 9) =       0.000278333297

      target function =                  N/A
              le_mean =     -22.669396272965
             les_mean =     514.417098321325
             stat err =       0.000278421583
             autocorr =       1.232417707904
              std dev =       0.709363645849
             le_variance =       0.503196782052


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266939627297e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.1035e-02, overlap shift 6.1035e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.669396272992       residual = 1.84e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.669443772540       residual = 6.16e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.669447384170       residual = 6.32e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.669447755419       residual = 7.61e-08           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.669447929507       residual = 8.41e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          4 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 6.1035e-02 is 3.140080e-03

solving harmonic davidson linear method for identity shift 2.4414e-01, overlap shift 2.4414e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.669396272992       residual = 1.84e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.669422365680       residual = 2.30e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.669423304646       residual = 8.32e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.669423281230       residual = 3.27e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 2.4414e-01 is 1.528051e-03

solving harmonic davidson linear method for identity shift 9.7656e-01, overlap shift 9.7656e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.669396272992       residual = 1.84e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.669405582781       residual = 2.11e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.669405816111       residual = 6.34e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.669405793615       residual = 2.00e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 9.7656e-01 is 5.021702e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.022318 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.2102e+02
  </log>
  <optVariables href="FORM.s010.opt.xml">
ci_001                -7.053559e-01 3 1  ON 0
ci_002                -7.051570e-01 3 1  ON 1
ci_003                -4.207361e-02 3 1  ON 2
ci_004                -4.160717e-02 3 1  ON 3
ci_005                 1.597757e-02 3 1  ON 4
ci_006                 1.622078e-02 3 1  ON 5
ci_007                 1.240955e-02 3 1  ON 6
ci_008                 1.310387e-02 3 1  ON 7
ci_009                -1.103758e-02 3 1  ON 8
ci_010                -1.157394e-02 3 1  ON 9
ci_011                -9.060781e-03 3 1  ON 10
ci_012                -8.529546e-03 3 1  ON 11
ci_013                 9.106716e-03 3 1  ON 12
ci_014                 9.458269e-03 3 1  ON 13
ci_015                 1.245743e-02 3 1  ON 14
ci_016                 1.441311e-02 3 1  ON 15
ci_017                 1.138977e-02 3 1  ON 16
ci_018                 1.152519e-02 3 1  ON 17
ci_019                -2.388257e-03 3 1  ON 18
ci_020                -2.119145e-03 3 1  ON 19
ci_021                -8.714772e-03 3 1  ON 20
ci_022                -8.331036e-03 3 1  ON 21
ci_023                 7.998939e-03 3 1  ON 22
ci_024                 8.083421e-03 3 1  ON 23
ci_025                 3.694342e-03 3 1  ON 24
ci_026                 4.066088e-03 3 1  ON 25
ci_027                 6.135158e-03 3 1  ON 26
ci_028                 6.552761e-03 3 1  ON 27
ci_029                -4.685099e-03 3 1  ON 28
ci_030                -4.165892e-03 3 1  ON 29
ci_031                -8.838174e-03 3 1  ON 30
ci_032                -8.474311e-03 3 1  ON 31
ci_033                 3.512277e-03 3 1  ON 32
ci_034                 4.637384e-03 3 1  ON 33
ci_035                 1.465140e-03 3 1  ON 34
ci_036                 9.710158e-04 3 1  ON 35
ci_037                 5.053035e-03 3 1  ON 36
ci_038                 5.106316e-03 3 1  ON 37
ci_039                 5.205855e-03 3 1  ON 38
ci_040                 5.278359e-03 3 1  ON 39
ci_041                 4.592975e-03 3 1  ON 40
ci_042                 5.264089e-03 3 1  ON 41
ci_043                 5.147199e-03 3 1  ON 42
ci_044                 5.055026e-03 3 1  ON 43
ci_045                 2.698966e-03 3 1  ON 44
ci_046                 3.627804e-03 3 1  ON 45
ci_047                -8.196992e-04 3 1  ON 46
ci_048                -4.343487e-04 3 1  ON 47
ci_049                 1.846960e-03 3 1  ON 48
ci_050                 8.866199e-04 3 1  ON 49
ci_051                -1.493838e-03 3 1  ON 50
ci_052                -1.005189e-03 3 1  ON 51
ci_053                -3.081496e-03 3 1  ON 52
ci_054                -2.551447e-03 3 1  ON 53
ci_055                -1.766963e-03 3 1  ON 54
ci_056                -3.314960e-03 3 1  ON 55
ci_057                -1.511087e-03 3 1  ON 56
ci_058                -1.331587e-03 3 1  ON 57
ci_059                 6.566824e-05 3 1  ON 58
ci_060                 4.777590e-04 3 1  ON 59
ci_061                -3.031794e-04 3 1  ON 60
ci_062                 1.829889e-04 3 1  ON 61
ci_063                -8.323812e-04 3 1  ON 62
ci_064                -5.345769e-04 3 1  ON 63
ci_065                -2.356313e-03 3 1  ON 64
ci_066                -3.375228e-03 3 1  ON 65
ci_067                -2.064222e-03 3 1  ON 66
ci_068                -3.237634e-03 3 1  ON 67
ci_069                -2.186130e-04 3 1  ON 68
ci_070                -8.604355e-05 3 1  ON 69
ci_071                -1.709134e-03 3 1  ON 70
ci_072                -2.664803e-03 3 1  ON 71
ci_073                -6.448095e-05 3 1  ON 72
ci_074                 4.337071e-04 3 1  ON 73
ci_075                -2.545920e-04 3 1  ON 74
ci_076                -8.976280e-05 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="250">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =8000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 10
    time step          = 0.05
    reference energy   = -22.6397
    reference variance = 0.28977
====================================================
  Execution time = 1.0014e+02
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s010
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 62500 
  VMC Eavg = -2.2670e+01
  VMC Evar = 5.0939e-01
  Total weights = 7.8204e+06
  Execution time = 1.4672e+01
  </log>
</opt>
<opt stage="main" walkers="62500">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

ERROR CostFunction-> Number of Effective Walkers is too small! 
  Number of effective walkers (samples) / total number of samples = 0.152682
  User specified threshold minwalkers = 0.3
  If this message appears frequently. You might have to be cautious. 
  Find info about parameter "minwalkers" in the user manual!
Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.498130938261
                                         uncertainty =       0.001567497042

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.498130938261
                                         uncertainty =       0.001567497042

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000249532073
  error estimate for blocks of size 2^( 2) =       0.000258464658
  error estimate for blocks of size 2^( 3) =       0.000266300193
  error estimate for blocks of size 2^( 4) =       0.000271990260
  error estimate for blocks of size 2^( 5) =       0.000275423038
  error estimate for blocks of size 2^( 6) =       0.000277416500
  error estimate for blocks of size 2^( 7) =       0.000277339513
  error estimate for blocks of size 2^( 8) =       0.000278517890
  error estimate for blocks of size 2^( 9) =       0.000278185287

      target function =                  N/A
              le_mean =     -22.669847276309
             les_mean =     514.581722838696
             stat err =       0.000277864798
             autocorr =       1.239978939719
              std dev =       0.705783285145
             le_variance =       0.498130045591

ERROR CostFunction-> Number of Effective Walkers is too small! 
  Number of effective walkers (samples) / total number of samples = 0.196529
  User specified threshold minwalkers = 0.3
  If this message appears frequently. You might have to be cautious. 
  Find info about parameter "minwalkers" in the user manual!
Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.497531337334
                                         uncertainty =       0.001568777725

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.497531337334
                                         uncertainty =       0.001568777725

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000249381706
  error estimate for blocks of size 2^( 2) =       0.000258312224
  error estimate for blocks of size 2^( 3) =       0.000266143509
  error estimate for blocks of size 2^( 4) =       0.000271848245
  error estimate for blocks of size 2^( 5) =       0.000275283275
  error estimate for blocks of size 2^( 6) =       0.000277274137
  error estimate for blocks of size 2^( 7) =       0.000277192397
  error estimate for blocks of size 2^( 8) =       0.000278351308
  error estimate for blocks of size 2^( 9) =       0.000277957583

      target function =                  N/A
              le_mean =     -22.669858773089
             les_mean =     514.457040829445
             stat err =       0.000277693856
             autocorr =       1.239947676872
              std dev =       0.705357982513
             le_variance =       0.497529883495

ERROR CostFunction-> Number of Effective Walkers is too small! 
  Number of effective walkers (samples) / total number of samples = 0.151177
  User specified threshold minwalkers = 0.3
  If this message appears frequently. You might have to be cautious. 
  Find info about parameter "minwalkers" in the user manual!
Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.497893885899
                                         uncertainty =       0.001581955801

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.497893885899
                                         uncertainty =       0.001581955801

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000249472625
  error estimate for blocks of size 2^( 2) =       0.000258400148
  error estimate for blocks of size 2^( 3) =       0.000266232989
  error estimate for blocks of size 2^( 4) =       0.000271934190
  error estimate for blocks of size 2^( 5) =       0.000275365971
  error estimate for blocks of size 2^( 6) =       0.000277365877
  error estimate for blocks of size 2^( 7) =       0.000277291579
  error estimate for blocks of size 2^( 8) =       0.000278460136
  error estimate for blocks of size 2^( 9) =       0.000278034023

      target function =                  N/A
              le_mean =     -22.669864900524
             les_mean =     514.546499408566
             stat err =       0.000277787904
             autocorr =       1.239883468661
              std dev =       0.705615138291
             le_variance =       0.497892723385

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.497646215191
                                         uncertainty =       0.001545993638

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.497646215191
                                         uncertainty =       0.001545993638

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000249410505
  error estimate for blocks of size 2^( 2) =       0.000258345578
  error estimate for blocks of size 2^( 3) =       0.000266181131
  error estimate for blocks of size 2^( 4) =       0.000271879791
  error estimate for blocks of size 2^( 5) =       0.000275312136
  error estimate for blocks of size 2^( 6) =       0.000277313432
  error estimate for blocks of size 2^( 7) =       0.000277238704
  error estimate for blocks of size 2^( 8) =       0.000278388279
  error estimate for blocks of size 2^( 9) =       0.000278006968

      target function =                  N/A
              le_mean =     -22.669845990412
             les_mean =     514.473880814705
             stat err =       0.000277736846
             autocorr =       1.240045193919
              std dev =       0.705439438302
             le_variance =       0.497644801112


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.669847276309        initial
     6.1035e-02     6.1035e-01             3.1401e-03       -22.669858773089
     2.4414e-01     2.4414e+00             1.5281e-03       -22.669864900524  <--
     9.7656e-01     9.7656e+00             5.0217e-04       -22.669845990412

*****************************************************************************
Applying the update for shift_i =   2.4414e-01     and shift_s =   2.4414e+00
*****************************************************************************

  Execution time = 1.7350e+02
  </log>
  <optVariables href="FORM.s010.opt.xml">
ci_001                -7.053559e-01 3 1  ON 0
ci_002                -7.051570e-01 3 1  ON 1
ci_003                -4.207361e-02 3 1  ON 2
ci_004                -4.160717e-02 3 1  ON 3
ci_005                 1.597757e-02 3 1  ON 4
ci_006                 1.622078e-02 3 1  ON 5
ci_007                 1.240955e-02 3 1  ON 6
ci_008                 1.310387e-02 3 1  ON 7
ci_009                -1.103758e-02 3 1  ON 8
ci_010                -1.157394e-02 3 1  ON 9
ci_011                -9.060781e-03 3 1  ON 10
ci_012                -8.529546e-03 3 1  ON 11
ci_013                 9.106716e-03 3 1  ON 12
ci_014                 9.458269e-03 3 1  ON 13
ci_015                 1.245743e-02 3 1  ON 14
ci_016                 1.441311e-02 3 1  ON 15
ci_017                 1.138977e-02 3 1  ON 16
ci_018                 1.152519e-02 3 1  ON 17
ci_019                -2.388257e-03 3 1  ON 18
ci_020                -2.119145e-03 3 1  ON 19
ci_021                -8.714772e-03 3 1  ON 20
ci_022                -8.331036e-03 3 1  ON 21
ci_023                 7.998939e-03 3 1  ON 22
ci_024                 8.083421e-03 3 1  ON 23
ci_025                 3.694342e-03 3 1  ON 24
ci_026                 4.066088e-03 3 1  ON 25
ci_027                 6.135158e-03 3 1  ON 26
ci_028                 6.552761e-03 3 1  ON 27
ci_029                -4.685099e-03 3 1  ON 28
ci_030                -4.165892e-03 3 1  ON 29
ci_031                -8.838174e-03 3 1  ON 30
ci_032                -8.474311e-03 3 1  ON 31
ci_033                 3.512277e-03 3 1  ON 32
ci_034                 4.637384e-03 3 1  ON 33
ci_035                 1.465140e-03 3 1  ON 34
ci_036                 9.710158e-04 3 1  ON 35
ci_037                 5.053035e-03 3 1  ON 36
ci_038                 5.106316e-03 3 1  ON 37
ci_039                 5.205855e-03 3 1  ON 38
ci_040                 5.278359e-03 3 1  ON 39
ci_041                 4.592975e-03 3 1  ON 40
ci_042                 5.264089e-03 3 1  ON 41
ci_043                 5.147199e-03 3 1  ON 42
ci_044                 5.055026e-03 3 1  ON 43
ci_045                 2.698966e-03 3 1  ON 44
ci_046                 3.627804e-03 3 1  ON 45
ci_047                -8.196992e-04 3 1  ON 46
ci_048                -4.343487e-04 3 1  ON 47
ci_049                 1.846960e-03 3 1  ON 48
ci_050                 8.866199e-04 3 1  ON 49
ci_051                -1.493838e-03 3 1  ON 50
ci_052                -1.005189e-03 3 1  ON 51
ci_053                -3.081496e-03 3 1  ON 52
ci_054                -2.551447e-03 3 1  ON 53
ci_055                -1.766963e-03 3 1  ON 54
ci_056                -3.314960e-03 3 1  ON 55
ci_057                -1.511087e-03 3 1  ON 56
ci_058                -1.331587e-03 3 1  ON 57
ci_059                 6.566824e-05 3 1  ON 58
ci_060                 4.777590e-04 3 1  ON 59
ci_061                -3.031794e-04 3 1  ON 60
ci_062                 1.829889e-04 3 1  ON 61
ci_063                -8.323812e-04 3 1  ON 62
ci_064                -5.345769e-04 3 1  ON 63
ci_065                -2.356313e-03 3 1  ON 64
ci_066                -3.375228e-03 3 1  ON 65
ci_067                -2.064222e-03 3 1  ON 66
ci_068                -3.237634e-03 3 1  ON 67
ci_069                -2.186130e-04 3 1  ON 68
ci_070                -8.604355e-05 3 1  ON 69
ci_071                -1.709134e-03 3 1  ON 70
ci_072                -2.664803e-03 3 1  ON 71
ci_073                -6.448095e-05 3 1  ON 72
ci_074                 4.337071e-04 3 1  ON 73
ci_075                -2.545920e-04 3 1  ON 74
ci_076                -8.976280e-05 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 2.9454e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s011 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s011 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=11  my_counter=0
  time step      = 5.0000e-02
  blocks         = 250
  steps          = 250
  substeps       = 10
  current        = 0
  target samples = 8.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">250</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">6.2500e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">8.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">6.2500e+04</parameter>
<parameter name="steps" condition="int">250</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2663e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="250">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =8000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 11
    time step          = 0.05
    reference energy   = -22.6546
    reference variance = 0.326673
====================================================
  Execution time = 1.0223e+02
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s011
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 62500 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 6.1049e+04
  VMC Eavg = -2.2669e+01
  VMC Evar = 5.0801e-01
  Total weights = 7.820538063e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.8884e+01
  </log>
</opt>
<opt stage="main" walkers="62500">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.495545482191
                                         uncertainty =       0.001230573702

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.495545482191
                                         uncertainty =       0.001230573702

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000248883821
  error estimate for blocks of size 2^( 2) =       0.000257922023
  error estimate for blocks of size 2^( 3) =       0.000266013895
  error estimate for blocks of size 2^( 4) =       0.000271708241
  error estimate for blocks of size 2^( 5) =       0.000275242572
  error estimate for blocks of size 2^( 6) =       0.000276802661
  error estimate for blocks of size 2^( 7) =       0.000277604322
  error estimate for blocks of size 2^( 8) =       0.000278585654
  error estimate for blocks of size 2^( 9) =       0.000279425184

      target function =                  N/A
              le_mean =     -22.669491840898
             les_mean =     514.413868339203
             stat err =       0.000278104455
             autocorr =       1.248597789871
              std dev =       0.703949750064
             le_variance =       0.495545250615


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266949184090e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.1035e-02, overlap shift 6.1035e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.669491840922       residual = 7.67e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.669518740986       residual = 5.38e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.669522647714       residual = 8.58e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.669522920895       residual = 6.94e-08           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.669522946916       residual = 7.20e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          4 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 6.1035e-02 is 2.107209e-03

solving harmonic davidson linear method for identity shift 2.4414e-01, overlap shift 2.4414e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.669491840922       residual = 7.67e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.669506389214       residual = 1.89e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.669507050546       residual = 9.10e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.669507038462       residual = 2.67e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 2.4414e-01 is 7.893131e-04

solving harmonic davidson linear method for identity shift 9.7656e-01, overlap shift 9.7656e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.669491840922       residual = 7.67e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.669496969520       residual = 1.17e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.669496989941       residual = 3.39e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.669497009815       residual = 1.22e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 9.7656e-01 is 2.652068e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.023781 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.2113e+02
  </log>
  <optVariables href="FORM.s011.opt.xml">
ci_001                -7.054961e-01 3 1  ON 0
ci_002                -7.051526e-01 3 1  ON 1
ci_003                -4.134087e-02 3 1  ON 2
ci_004                -4.081785e-02 3 1  ON 3
ci_005                 1.588936e-02 3 1  ON 4
ci_006                 1.623962e-02 3 1  ON 5
ci_007                 1.247384e-02 3 1  ON 6
ci_008                 1.258810e-02 3 1  ON 7
ci_009                -1.128575e-02 3 1  ON 8
ci_010                -1.153451e-02 3 1  ON 9
ci_011                -8.934173e-03 3 1  ON 10
ci_012                -8.309065e-03 3 1  ON 11
ci_013                 9.152470e-03 3 1  ON 12
ci_014                 9.415239e-03 3 1  ON 13
ci_015                 1.259327e-02 3 1  ON 14
ci_016                 1.413260e-02 3 1  ON 15
ci_017                 1.100374e-02 3 1  ON 16
ci_018                 1.113512e-02 3 1  ON 17
ci_019                -2.448583e-03 3 1  ON 18
ci_020                -2.165331e-03 3 1  ON 19
ci_021                -8.340845e-03 3 1  ON 20
ci_022                -8.489476e-03 3 1  ON 21
ci_023                 7.853823e-03 3 1  ON 22
ci_024                 7.991667e-03 3 1  ON 23
ci_025                 4.118877e-03 3 1  ON 24
ci_026                 3.798313e-03 3 1  ON 25
ci_027                 6.708872e-03 3 1  ON 26
ci_028                 6.749665e-03 3 1  ON 27
ci_029                -4.523488e-03 3 1  ON 28
ci_030                -4.160706e-03 3 1  ON 29
ci_031                -8.386852e-03 3 1  ON 30
ci_032                -8.157539e-03 3 1  ON 31
ci_033                 3.627637e-03 3 1  ON 32
ci_034                 4.540258e-03 3 1  ON 33
ci_035                 1.236195e-03 3 1  ON 34
ci_036                 9.637198e-04 3 1  ON 35
ci_037                 4.850449e-03 3 1  ON 36
ci_038                 5.471741e-03 3 1  ON 37
ci_039                 5.297549e-03 3 1  ON 38
ci_040                 5.446469e-03 3 1  ON 39
ci_041                 4.913534e-03 3 1  ON 40
ci_042                 4.909018e-03 3 1  ON 41
ci_043                 5.031994e-03 3 1  ON 42
ci_044                 5.281186e-03 3 1  ON 43
ci_045                 2.728571e-03 3 1  ON 44
ci_046                 3.476850e-03 3 1  ON 45
ci_047                -7.179117e-04 3 1  ON 46
ci_048                -5.353257e-04 3 1  ON 47
ci_049                 1.305643e-03 3 1  ON 48
ci_050                 7.530996e-04 3 1  ON 49
ci_051                -1.373405e-03 3 1  ON 50
ci_052                -8.435206e-04 3 1  ON 51
ci_053                -2.915615e-03 3 1  ON 52
ci_054                -2.337853e-03 3 1  ON 53
ci_055                -1.697975e-03 3 1  ON 54
ci_056                -3.002162e-03 3 1  ON 55
ci_057                -1.536360e-03 3 1  ON 56
ci_058                -1.403651e-03 3 1  ON 57
ci_059                 8.100958e-05 3 1  ON 58
ci_060                 6.989991e-04 3 1  ON 59
ci_061                -2.637433e-04 3 1  ON 60
ci_062                 1.237057e-04 3 1  ON 61
ci_063                -4.600388e-04 3 1  ON 62
ci_064                -5.483277e-04 3 1  ON 63
ci_065                -2.246008e-03 3 1  ON 64
ci_066                -2.636211e-03 3 1  ON 65
ci_067                -2.180960e-03 3 1  ON 66
ci_068                -2.670086e-03 3 1  ON 67
ci_069                -1.169917e-04 3 1  ON 68
ci_070                 1.497658e-04 3 1  ON 69
ci_071                -1.765269e-03 3 1  ON 70
ci_072                -2.406013e-03 3 1  ON 71
ci_073                 3.990852e-05 3 1  ON 72
ci_074                 1.889459e-04 3 1  ON 73
ci_075                -4.238941e-04 3 1  ON 74
ci_076                -1.994435e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="250">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =8000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 11
    time step          = 0.05
    reference energy   = -22.662
    reference variance = 0.377783
====================================================
  Execution time = 1.0037e+02
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s011
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 62500 
  VMC Eavg = -2.2670e+01
  VMC Evar = 5.1173e-01
  Total weights = 7.8210e+06
  Execution time = 1.4602e+01
  </log>
</opt>
<opt stage="main" walkers="62500">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.498477372431
                                         uncertainty =       0.001672861466

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.498477372431
                                         uncertainty =       0.001672861466

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000249619741
  error estimate for blocks of size 2^( 2) =       0.000258532140
  error estimate for blocks of size 2^( 3) =       0.000266624045
  error estimate for blocks of size 2^( 4) =       0.000272371220
  error estimate for blocks of size 2^( 5) =       0.000275661664
  error estimate for blocks of size 2^( 6) =       0.000277029726
  error estimate for blocks of size 2^( 7) =       0.000277539923
  error estimate for blocks of size 2^( 8) =       0.000277894313
  error estimate for blocks of size 2^( 9) =       0.000279570282

      target function =                  N/A
              le_mean =     -22.669994817240
             les_mean =     514.481647184748
             stat err =       0.000278008561
             autocorr =       1.240390642052
              std dev =       0.706031247670
             le_variance =       0.498480122686

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.498199513557
                                         uncertainty =       0.001665014605

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.498199513557
                                         uncertainty =       0.001665014605

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000249550171
  error estimate for blocks of size 2^( 2) =       0.000258461795
  error estimate for blocks of size 2^( 3) =       0.000266553492
  error estimate for blocks of size 2^( 4) =       0.000272300462
  error estimate for blocks of size 2^( 5) =       0.000275594821
  error estimate for blocks of size 2^( 6) =       0.000276952653
  error estimate for blocks of size 2^( 7) =       0.000277466937
  error estimate for blocks of size 2^( 8) =       0.000277804919
  error estimate for blocks of size 2^( 9) =       0.000279518346

      target function =                  N/A
              le_mean =     -22.670001598884
             les_mean =     514.517500657588
             stat err =       0.000277935714
             autocorr =       1.240432015224
              std dev =       0.705834473549
             le_variance =       0.498202304050

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.498086630136
                                         uncertainty =       0.001670153889

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.498086630136
                                         uncertainty =       0.001670153889

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000249521884
  error estimate for blocks of size 2^( 2) =       0.000258434140
  error estimate for blocks of size 2^( 3) =       0.000266524325
  error estimate for blocks of size 2^( 4) =       0.000272272976
  error estimate for blocks of size 2^( 5) =       0.000275563585
  error estimate for blocks of size 2^( 6) =       0.000276928475
  error estimate for blocks of size 2^( 7) =       0.000277453375
  error estimate for blocks of size 2^( 8) =       0.000277809390
  error estimate for blocks of size 2^( 9) =       0.000279530185

      target function =                  N/A
              le_mean =     -22.670002811202
             les_mean =     514.460605611688
             stat err =       0.000277930356
             autocorr =       1.240665445232
              std dev =       0.705754465123
             le_variance =       0.498089365042

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.499040563904
                                         uncertainty =       0.001822185591

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.499040563904
                                         uncertainty =       0.001822185591

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000249761022
  error estimate for blocks of size 2^( 2) =       0.000258662038
  error estimate for blocks of size 2^( 3) =       0.000266753173
  error estimate for blocks of size 2^( 4) =       0.000272499947
  error estimate for blocks of size 2^( 5) =       0.000275791462
  error estimate for blocks of size 2^( 6) =       0.000277175694
  error estimate for blocks of size 2^( 7) =       0.000277706598
  error estimate for blocks of size 2^( 8) =       0.000278046215
  error estimate for blocks of size 2^( 9) =       0.000279760947

      target function =                  N/A
              le_mean =     -22.669985629927
             les_mean =     515.868684298519
             stat err =       0.000278172364
             autocorr =       1.240448207189
              std dev =       0.706430849241
             le_variance =       0.499044544760


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.669994817240        initial
     6.1035e-02     6.1035e-01             2.1072e-03       -22.670001598884
     2.4414e-01     2.4414e+00             7.8931e-04       -22.670002811202  <--
     9.7656e-01     9.7656e+00             2.6521e-04       -22.669985629927

*****************************************************************************
Applying the update for shift_i =   2.4414e-01     and shift_s =   2.4414e+00
*****************************************************************************

  Execution time = 1.7375e+02
  </log>
  <optVariables href="FORM.s011.opt.xml">
ci_001                -7.054961e-01 3 1  ON 0
ci_002                -7.051526e-01 3 1  ON 1
ci_003                -4.134087e-02 3 1  ON 2
ci_004                -4.081785e-02 3 1  ON 3
ci_005                 1.588936e-02 3 1  ON 4
ci_006                 1.623962e-02 3 1  ON 5
ci_007                 1.247384e-02 3 1  ON 6
ci_008                 1.258810e-02 3 1  ON 7
ci_009                -1.128575e-02 3 1  ON 8
ci_010                -1.153451e-02 3 1  ON 9
ci_011                -8.934173e-03 3 1  ON 10
ci_012                -8.309065e-03 3 1  ON 11
ci_013                 9.152470e-03 3 1  ON 12
ci_014                 9.415239e-03 3 1  ON 13
ci_015                 1.259327e-02 3 1  ON 14
ci_016                 1.413260e-02 3 1  ON 15
ci_017                 1.100374e-02 3 1  ON 16
ci_018                 1.113512e-02 3 1  ON 17
ci_019                -2.448583e-03 3 1  ON 18
ci_020                -2.165331e-03 3 1  ON 19
ci_021                -8.340845e-03 3 1  ON 20
ci_022                -8.489476e-03 3 1  ON 21
ci_023                 7.853823e-03 3 1  ON 22
ci_024                 7.991667e-03 3 1  ON 23
ci_025                 4.118877e-03 3 1  ON 24
ci_026                 3.798313e-03 3 1  ON 25
ci_027                 6.708872e-03 3 1  ON 26
ci_028                 6.749665e-03 3 1  ON 27
ci_029                -4.523488e-03 3 1  ON 28
ci_030                -4.160706e-03 3 1  ON 29
ci_031                -8.386852e-03 3 1  ON 30
ci_032                -8.157539e-03 3 1  ON 31
ci_033                 3.627637e-03 3 1  ON 32
ci_034                 4.540258e-03 3 1  ON 33
ci_035                 1.236195e-03 3 1  ON 34
ci_036                 9.637198e-04 3 1  ON 35
ci_037                 4.850449e-03 3 1  ON 36
ci_038                 5.471741e-03 3 1  ON 37
ci_039                 5.297549e-03 3 1  ON 38
ci_040                 5.446469e-03 3 1  ON 39
ci_041                 4.913534e-03 3 1  ON 40
ci_042                 4.909018e-03 3 1  ON 41
ci_043                 5.031994e-03 3 1  ON 42
ci_044                 5.281186e-03 3 1  ON 43
ci_045                 2.728571e-03 3 1  ON 44
ci_046                 3.476850e-03 3 1  ON 45
ci_047                -7.179117e-04 3 1  ON 46
ci_048                -5.353257e-04 3 1  ON 47
ci_049                 1.305643e-03 3 1  ON 48
ci_050                 7.530996e-04 3 1  ON 49
ci_051                -1.373405e-03 3 1  ON 50
ci_052                -8.435206e-04 3 1  ON 51
ci_053                -2.915615e-03 3 1  ON 52
ci_054                -2.337853e-03 3 1  ON 53
ci_055                -1.697975e-03 3 1  ON 54
ci_056                -3.002162e-03 3 1  ON 55
ci_057                -1.536360e-03 3 1  ON 56
ci_058                -1.403651e-03 3 1  ON 57
ci_059                 8.100958e-05 3 1  ON 58
ci_060                 6.989991e-04 3 1  ON 59
ci_061                -2.637433e-04 3 1  ON 60
ci_062                 1.237057e-04 3 1  ON 61
ci_063                -4.600388e-04 3 1  ON 62
ci_064                -5.483277e-04 3 1  ON 63
ci_065                -2.246008e-03 3 1  ON 64
ci_066                -2.636211e-03 3 1  ON 65
ci_067                -2.180960e-03 3 1  ON 66
ci_068                -2.670086e-03 3 1  ON 67
ci_069                -1.169917e-04 3 1  ON 68
ci_070                 1.497658e-04 3 1  ON 69
ci_071                -1.765269e-03 3 1  ON 70
ci_072                -2.406013e-03 3 1  ON 71
ci_073                 3.990852e-05 3 1  ON 72
ci_074                 1.889459e-04 3 1  ON 73
ci_075                -4.238941e-04 3 1  ON 74
ci_076                -1.994435e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 2.9490e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s012 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s012 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=12  my_counter=0
  time step      = 5.0000e-02
  blocks         = 250
  steps          = 250
  substeps       = 10
  current        = 0
  target samples = 8.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">250</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">6.2500e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">8.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">6.2500e+04</parameter>
<parameter name="steps" condition="int">250</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2663e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="250">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =8000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 12
    time step          = 0.05
    reference energy   = -22.7175
    reference variance = 0.873611
====================================================
  Execution time = 1.0183e+02
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s012
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 62500 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 6.1121e+04
  VMC Eavg = -2.2669e+01
  VMC Evar = 5.0843e-01
  Total weights = 7.820367508e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.8851e+01
  </log>
</opt>
<opt stage="main" walkers="62500">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.495625326382
                                         uncertainty =       0.001392549018

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.495625326382
                                         uncertainty =       0.001392549018

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000248904268
  error estimate for blocks of size 2^( 2) =       0.000257882912
  error estimate for blocks of size 2^( 3) =       0.000265963203
  error estimate for blocks of size 2^( 4) =       0.000271802724
  error estimate for blocks of size 2^( 5) =       0.000275280038
  error estimate for blocks of size 2^( 6) =       0.000277325412
  error estimate for blocks of size 2^( 7) =       0.000278746163
  error estimate for blocks of size 2^( 8) =       0.000279343773
  error estimate for blocks of size 2^( 9) =       0.000278050110

      target function =                  N/A
              le_mean =     -22.669235109994
             les_mean =     514.402654360603
             stat err =       0.000278366364
             autocorr =       1.250745148308
              std dev =       0.704007583347
             le_variance =       0.495626677410


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266923510999e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.1035e-02, overlap shift 6.1035e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.669235110017       residual = 4.54e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.669251238820       residual = 3.04e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.669253091608       residual = 3.59e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.669253557498       residual = 3.37e-08           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.669253662477       residual = 3.87e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          4 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 6.1035e-02 is 1.213091e-03

solving harmonic davidson linear method for identity shift 2.4414e-01, overlap shift 2.4414e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.669235110017       residual = 4.54e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.669244071172       residual = 1.14e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.669244290967       residual = 5.90e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.669244305805       residual = 1.84e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 2.4414e-01 is 6.415754e-04

solving harmonic davidson linear method for identity shift 9.7656e-01, overlap shift 9.7656e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.669235110017       residual = 4.54e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.669238336231       residual = 6.78e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.669238248845       residual = 2.66e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.669238263873       residual = 7.77e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 9.7656e-01 is 2.233898e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.025216 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.2069e+02
  </log>
  <optVariables href="FORM.s012.opt.xml">
ci_001                -7.055668e-01 3 1  ON 0
ci_002                -7.051478e-01 3 1  ON 1
ci_003                -4.094003e-02 3 1  ON 2
ci_004                -4.041256e-02 3 1  ON 3
ci_005                 1.591498e-02 3 1  ON 4
ci_006                 1.620587e-02 3 1  ON 5
ci_007                 1.255848e-02 3 1  ON 6
ci_008                 1.258642e-02 3 1  ON 7
ci_009                -1.137866e-02 3 1  ON 8
ci_010                -1.168714e-02 3 1  ON 9
ci_011                -8.616537e-03 3 1  ON 10
ci_012                -8.004614e-03 3 1  ON 11
ci_013                 9.434960e-03 3 1  ON 12
ci_014                 9.137926e-03 3 1  ON 13
ci_015                 1.263683e-02 3 1  ON 14
ci_016                 1.396216e-02 3 1  ON 15
ci_017                 1.080490e-02 3 1  ON 16
ci_018                 1.106473e-02 3 1  ON 17
ci_019                -2.595142e-03 3 1  ON 18
ci_020                -2.433280e-03 3 1  ON 19
ci_021                -8.088348e-03 3 1  ON 20
ci_022                -8.646017e-03 3 1  ON 21
ci_023                 7.777091e-03 3 1  ON 22
ci_024                 8.025918e-03 3 1  ON 23
ci_025                 3.974898e-03 3 1  ON 24
ci_026                 3.925814e-03 3 1  ON 25
ci_027                 6.430431e-03 3 1  ON 26
ci_028                 6.692678e-03 3 1  ON 27
ci_029                -4.595407e-03 3 1  ON 28
ci_030                -4.376709e-03 3 1  ON 29
ci_031                -8.253071e-03 3 1  ON 30
ci_032                -7.978260e-03 3 1  ON 31
ci_033                 3.969370e-03 3 1  ON 32
ci_034                 4.759062e-03 3 1  ON 33
ci_035                 1.084554e-03 3 1  ON 34
ci_036                 1.158285e-03 3 1  ON 35
ci_037                 5.103635e-03 3 1  ON 36
ci_038                 5.437643e-03 3 1  ON 37
ci_039                 5.439132e-03 3 1  ON 38
ci_040                 5.058067e-03 3 1  ON 39
ci_041                 5.092015e-03 3 1  ON 40
ci_042                 5.026762e-03 3 1  ON 41
ci_043                 5.011625e-03 3 1  ON 42
ci_044                 4.919545e-03 3 1  ON 43
ci_045                 2.751698e-03 3 1  ON 44
ci_046                 3.291623e-03 3 1  ON 45
ci_047                -8.411836e-04 3 1  ON 46
ci_048                -7.032649e-04 3 1  ON 47
ci_049                 1.488854e-03 3 1  ON 48
ci_050                 8.914837e-04 3 1  ON 49
ci_051                -1.316571e-03 3 1  ON 50
ci_052                -5.569265e-04 3 1  ON 51
ci_053                -2.697650e-03 3 1  ON 52
ci_054                -2.337893e-03 3 1  ON 53
ci_055                -1.535048e-03 3 1  ON 54
ci_056                -2.360586e-03 3 1  ON 55
ci_057                -1.458294e-03 3 1  ON 56
ci_058                -1.470169e-03 3 1  ON 57
ci_059                 1.599815e-04 3 1  ON 58
ci_060                 3.390433e-04 3 1  ON 59
ci_061                -1.362105e-04 3 1  ON 60
ci_062                 1.541788e-04 3 1  ON 61
ci_063                -3.729686e-04 3 1  ON 62
ci_064                -6.338568e-04 3 1  ON 63
ci_065                -2.195088e-03 3 1  ON 64
ci_066                -2.663493e-03 3 1  ON 65
ci_067                -2.604801e-03 3 1  ON 66
ci_068                -2.319521e-03 3 1  ON 67
ci_069                -5.438299e-05 3 1  ON 68
ci_070                 1.278538e-04 3 1  ON 69
ci_071                -1.740249e-03 3 1  ON 70
ci_072                -2.100609e-03 3 1  ON 71
ci_073                 2.577359e-04 3 1  ON 72
ci_074                 3.552332e-04 3 1  ON 73
ci_075                -4.932170e-04 3 1  ON 74
ci_076                -3.404699e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="250">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =8000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 12
    time step          = 0.05
    reference energy   = -22.8285
    reference variance = 0.576823
====================================================
  Execution time = 1.0017e+02
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s012
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 62500 
  VMC Eavg = -2.2670e+01
  VMC Evar = 5.1209e-01
  Total weights = 7.8210e+06
  Execution time = 1.4660e+01
  </log>
</opt>
<opt stage="main" walkers="62500">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.498662399833
                                         uncertainty =       0.002225303588

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.498662399833
                                         uncertainty =       0.002225303588

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000249665535
  error estimate for blocks of size 2^( 2) =       0.000258710319
  error estimate for blocks of size 2^( 3) =       0.000266684255
  error estimate for blocks of size 2^( 4) =       0.000272489662
  error estimate for blocks of size 2^( 5) =       0.000275688346
  error estimate for blocks of size 2^( 6) =       0.000277245271
  error estimate for blocks of size 2^( 7) =       0.000277998626
  error estimate for blocks of size 2^( 8) =       0.000279602415
  error estimate for blocks of size 2^( 9) =       0.000280296670

      target function =                  N/A
              le_mean =     -22.669518615782
             les_mean =     514.464792116104
             stat err =       0.000278785745
             autocorr =       1.246877928360
              std dev =       0.706160772680
             le_variance =       0.498663036872

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.498835097235
                                         uncertainty =       0.002387488703

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.498835097235
                                         uncertainty =       0.002387488703

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000249708785
  error estimate for blocks of size 2^( 2) =       0.000258748100
  error estimate for blocks of size 2^( 3) =       0.000266716614
  error estimate for blocks of size 2^( 4) =       0.000272521032
  error estimate for blocks of size 2^( 5) =       0.000275714886
  error estimate for blocks of size 2^( 6) =       0.000277267216
  error estimate for blocks of size 2^( 7) =       0.000278010836
  error estimate for blocks of size 2^( 8) =       0.000279594193
  error estimate for blocks of size 2^( 9) =       0.000280305460

      target function =                  N/A
              le_mean =     -22.669522849386
             les_mean =     514.421307527338
             stat err =       0.000278794426
             autocorr =       1.246523670933
              std dev =       0.706283101552
             le_variance =       0.498835819538

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.498903073949
                                         uncertainty =       0.002400316544

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.498903073949
                                         uncertainty =       0.002400316544

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000249725792
  error estimate for blocks of size 2^( 2) =       0.000258764462
  error estimate for blocks of size 2^( 3) =       0.000266733326
  error estimate for blocks of size 2^( 4) =       0.000272538668
  error estimate for blocks of size 2^( 5) =       0.000275734206
  error estimate for blocks of size 2^( 6) =       0.000277286299
  error estimate for blocks of size 2^( 7) =       0.000278028629
  error estimate for blocks of size 2^( 8) =       0.000279611297
  error estimate for blocks of size 2^( 9) =       0.000280322719

      target function =                  N/A
              le_mean =     -22.669523618413
             les_mean =     514.420794171592
             stat err =       0.000278812236
             autocorr =       1.246513139472
              std dev =       0.706331203580
             le_variance =       0.498903769151

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.498670933762
                                         uncertainty =       0.002253413618

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.498670933762
                                         uncertainty =       0.002253413618

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000249667674
  error estimate for blocks of size 2^( 2) =       0.000258711649
  error estimate for blocks of size 2^( 3) =       0.000266684098
  error estimate for blocks of size 2^( 4) =       0.000272490659
  error estimate for blocks of size 2^( 5) =       0.000275687176
  error estimate for blocks of size 2^( 6) =       0.000277241596
  error estimate for blocks of size 2^( 7) =       0.000277995939
  error estimate for blocks of size 2^( 8) =       0.000279596459
  error estimate for blocks of size 2^( 9) =       0.000280294629

      target function =                  N/A
              le_mean =     -22.669518473126
             les_mean =     514.428112264487
             stat err =       0.000278782156
             autocorr =       1.246824465514
              std dev =       0.706166820034
             le_variance =       0.498671577717


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.669518615782        initial
     6.1035e-02     6.1035e-01             1.2131e-03       -22.669522849386
     2.4414e-01     2.4414e+00             6.4158e-04       -22.669523618413  <--
     9.7656e-01     9.7656e+00             2.2339e-04       -22.669518473126

*****************************************************************************
Applying the update for shift_i =   2.4414e-01     and shift_s =   2.4414e+00
*****************************************************************************

  Execution time = 1.7354e+02
  </log>
  <optVariables href="FORM.s012.opt.xml">
ci_001                -7.055668e-01 3 1  ON 0
ci_002                -7.051478e-01 3 1  ON 1
ci_003                -4.094003e-02 3 1  ON 2
ci_004                -4.041256e-02 3 1  ON 3
ci_005                 1.591498e-02 3 1  ON 4
ci_006                 1.620587e-02 3 1  ON 5
ci_007                 1.255848e-02 3 1  ON 6
ci_008                 1.258642e-02 3 1  ON 7
ci_009                -1.137866e-02 3 1  ON 8
ci_010                -1.168714e-02 3 1  ON 9
ci_011                -8.616537e-03 3 1  ON 10
ci_012                -8.004614e-03 3 1  ON 11
ci_013                 9.434960e-03 3 1  ON 12
ci_014                 9.137926e-03 3 1  ON 13
ci_015                 1.263683e-02 3 1  ON 14
ci_016                 1.396216e-02 3 1  ON 15
ci_017                 1.080490e-02 3 1  ON 16
ci_018                 1.106473e-02 3 1  ON 17
ci_019                -2.595142e-03 3 1  ON 18
ci_020                -2.433280e-03 3 1  ON 19
ci_021                -8.088348e-03 3 1  ON 20
ci_022                -8.646017e-03 3 1  ON 21
ci_023                 7.777091e-03 3 1  ON 22
ci_024                 8.025918e-03 3 1  ON 23
ci_025                 3.974898e-03 3 1  ON 24
ci_026                 3.925814e-03 3 1  ON 25
ci_027                 6.430431e-03 3 1  ON 26
ci_028                 6.692678e-03 3 1  ON 27
ci_029                -4.595407e-03 3 1  ON 28
ci_030                -4.376709e-03 3 1  ON 29
ci_031                -8.253071e-03 3 1  ON 30
ci_032                -7.978260e-03 3 1  ON 31
ci_033                 3.969370e-03 3 1  ON 32
ci_034                 4.759062e-03 3 1  ON 33
ci_035                 1.084554e-03 3 1  ON 34
ci_036                 1.158285e-03 3 1  ON 35
ci_037                 5.103635e-03 3 1  ON 36
ci_038                 5.437643e-03 3 1  ON 37
ci_039                 5.439132e-03 3 1  ON 38
ci_040                 5.058067e-03 3 1  ON 39
ci_041                 5.092015e-03 3 1  ON 40
ci_042                 5.026762e-03 3 1  ON 41
ci_043                 5.011625e-03 3 1  ON 42
ci_044                 4.919545e-03 3 1  ON 43
ci_045                 2.751698e-03 3 1  ON 44
ci_046                 3.291623e-03 3 1  ON 45
ci_047                -8.411836e-04 3 1  ON 46
ci_048                -7.032649e-04 3 1  ON 47
ci_049                 1.488854e-03 3 1  ON 48
ci_050                 8.914837e-04 3 1  ON 49
ci_051                -1.316571e-03 3 1  ON 50
ci_052                -5.569265e-04 3 1  ON 51
ci_053                -2.697650e-03 3 1  ON 52
ci_054                -2.337893e-03 3 1  ON 53
ci_055                -1.535048e-03 3 1  ON 54
ci_056                -2.360586e-03 3 1  ON 55
ci_057                -1.458294e-03 3 1  ON 56
ci_058                -1.470169e-03 3 1  ON 57
ci_059                 1.599815e-04 3 1  ON 58
ci_060                 3.390433e-04 3 1  ON 59
ci_061                -1.362105e-04 3 1  ON 60
ci_062                 1.541788e-04 3 1  ON 61
ci_063                -3.729686e-04 3 1  ON 62
ci_064                -6.338568e-04 3 1  ON 63
ci_065                -2.195088e-03 3 1  ON 64
ci_066                -2.663493e-03 3 1  ON 65
ci_067                -2.604801e-03 3 1  ON 66
ci_068                -2.319521e-03 3 1  ON 67
ci_069                -5.438299e-05 3 1  ON 68
ci_070                 1.278538e-04 3 1  ON 69
ci_071                -1.740249e-03 3 1  ON 70
ci_072                -2.100609e-03 3 1  ON 71
ci_073                 2.577359e-04 3 1  ON 72
ci_074                 3.552332e-04 3 1  ON 73
ci_075                -4.932170e-04 3 1  ON 74
ci_076                -3.404699e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 2.9424e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s013 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s013 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=13  my_counter=0
  time step      = 5.0000e-02
  blocks         = 250
  steps          = 250
  substeps       = 10
  current        = 0
  target samples = 8.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">250</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">6.2500e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">8.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">6.2500e+04</parameter>
<parameter name="steps" condition="int">250</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2672e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="250">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =8000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 13
    time step          = 0.05
    reference energy   = -22.5911
    reference variance = 0.42208
====================================================
  Execution time = 1.0242e+02
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s013
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 62500 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 6.1036e+04
  VMC Eavg = -2.2670e+01
  VMC Evar = 5.1438e-01
  Total weights = 7.820110492e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.9027e+01
  </log>
</opt>
<opt stage="main" walkers="62500">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.500372661265
                                         uncertainty =       0.003709487419

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.500372661265
                                         uncertainty =       0.003709487419

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000250092768
  error estimate for blocks of size 2^( 2) =       0.000259018595
  error estimate for blocks of size 2^( 3) =       0.000267069926
  error estimate for blocks of size 2^( 4) =       0.000272803944
  error estimate for blocks of size 2^( 5) =       0.000275863128
  error estimate for blocks of size 2^( 6) =       0.000277508186
  error estimate for blocks of size 2^( 7) =       0.000278429963
  error estimate for blocks of size 2^( 8) =       0.000278325844
  error estimate for blocks of size 2^( 9) =       0.000279743241

      target function =                  N/A
              le_mean =     -22.669545352629
             les_mean =     514.422668395825
             stat err =       0.000278501808
             autocorr =       1.240091622960
              std dev =       0.707369167555
             le_variance =       0.500371139208


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266954535263e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.1035e-02, overlap shift 6.1035e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.669545352654       residual = 4.80e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.669546719419       residual = 2.50e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.669547371224       residual = 2.08e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.669547805108       residual = 1.86e-08           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.669547816946       residual = 2.33e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          4 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 6.1035e-02 is 1.144117e-03

solving harmonic davidson linear method for identity shift 2.4414e-01, overlap shift 2.4414e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.669545352654       residual = 4.80e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.669546095791       residual = 9.23e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.669546241979       residual = 3.82e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.669546327637       residual = 1.69e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 2.4414e-01 is 5.671887e-04

solving harmonic davidson linear method for identity shift 9.7656e-01, overlap shift 9.7656e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.669545352654       residual = 4.80e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.669545615700       residual = 5.56e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.669545606891       residual = 1.73e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.669545624245       residual = 6.30e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 9.7656e-01 is 2.022550e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.026674 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.2146e+02
  </log>
  <optVariables href="FORM.s013.opt.xml">
ci_001                -7.055741e-01 3 1  ON 0
ci_002                -7.051749e-01 3 1  ON 1
ci_003                -4.076055e-02 3 1  ON 2
ci_004                -4.010689e-02 3 1  ON 3
ci_005                 1.585138e-02 3 1  ON 4
ci_006                 1.616671e-02 3 1  ON 5
ci_007                 1.239128e-02 3 1  ON 6
ci_008                 1.278123e-02 3 1  ON 7
ci_009                -1.158185e-02 3 1  ON 8
ci_010                -1.180210e-02 3 1  ON 9
ci_011                -8.475191e-03 3 1  ON 10
ci_012                -8.091557e-03 3 1  ON 11
ci_013                 9.722168e-03 3 1  ON 12
ci_014                 8.990574e-03 3 1  ON 13
ci_015                 1.210063e-02 3 1  ON 14
ci_016                 1.372823e-02 3 1  ON 15
ci_017                 1.058188e-02 3 1  ON 16
ci_018                 1.126374e-02 3 1  ON 17
ci_019                -2.241037e-03 3 1  ON 18
ci_020                -2.637998e-03 3 1  ON 19
ci_021                -7.798847e-03 3 1  ON 20
ci_022                -8.590347e-03 3 1  ON 21
ci_023                 8.123060e-03 3 1  ON 22
ci_024                 8.156651e-03 3 1  ON 23
ci_025                 3.949501e-03 3 1  ON 24
ci_026                 4.332901e-03 3 1  ON 25
ci_027                 6.320177e-03 3 1  ON 26
ci_028                 6.581549e-03 3 1  ON 27
ci_029                -4.696066e-03 3 1  ON 28
ci_030                -4.818795e-03 3 1  ON 29
ci_031                -8.325541e-03 3 1  ON 30
ci_032                -7.910667e-03 3 1  ON 31
ci_033                 4.102495e-03 3 1  ON 32
ci_034                 4.653797e-03 3 1  ON 33
ci_035                 1.155669e-03 3 1  ON 34
ci_036                 9.879977e-04 3 1  ON 35
ci_037                 5.144841e-03 3 1  ON 36
ci_038                 5.601386e-03 3 1  ON 37
ci_039                 5.181863e-03 3 1  ON 38
ci_040                 5.037862e-03 3 1  ON 39
ci_041                 5.276991e-03 3 1  ON 40
ci_042                 4.866678e-03 3 1  ON 41
ci_043                 4.925262e-03 3 1  ON 42
ci_044                 4.861845e-03 3 1  ON 43
ci_045                 3.008206e-03 3 1  ON 44
ci_046                 3.313484e-03 3 1  ON 45
ci_047                -5.380245e-04 3 1  ON 46
ci_048                -6.354965e-04 3 1  ON 47
ci_049                 1.583748e-03 3 1  ON 48
ci_050                 7.781085e-04 3 1  ON 49
ci_051                -1.318902e-03 3 1  ON 50
ci_052                -7.169966e-04 3 1  ON 51
ci_053                -2.828431e-03 3 1  ON 52
ci_054                -2.523804e-03 3 1  ON 53
ci_055                -1.532489e-03 3 1  ON 54
ci_056                -2.316440e-03 3 1  ON 55
ci_057                -1.583719e-03 3 1  ON 56
ci_058                -1.405909e-03 3 1  ON 57
ci_059                 1.592767e-04 3 1  ON 58
ci_060                 3.008063e-04 3 1  ON 59
ci_061                 1.722899e-04 3 1  ON 60
ci_062                -4.130099e-04 3 1  ON 61
ci_063                -3.690359e-04 3 1  ON 62
ci_064                -3.101968e-04 3 1  ON 63
ci_065                -2.291872e-03 3 1  ON 64
ci_066                -2.940823e-03 3 1  ON 65
ci_067                -2.234474e-03 3 1  ON 66
ci_068                -2.026616e-03 3 1  ON 67
ci_069                 2.642224e-05 3 1  ON 68
ci_070                -3.274273e-04 3 1  ON 69
ci_071                -2.053954e-03 3 1  ON 70
ci_072                -1.980385e-03 3 1  ON 71
ci_073                 3.116310e-04 3 1  ON 72
ci_074                 1.905957e-04 3 1  ON 73
ci_075                -4.957896e-04 3 1  ON 74
ci_076                -2.218602e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="250">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =8000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 13
    time step          = 0.05
    reference energy   = -22.795
    reference variance = 0.551382
====================================================
  Execution time = 9.9864e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s013
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 62500 
  VMC Eavg = -2.2669e+01
  VMC Evar = 5.0932e-01
  Total weights = 7.8201e+06
  Execution time = 1.4642e+01
  </log>
</opt>
<opt stage="main" walkers="62500">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.495787801300
                                         uncertainty =       0.001275283482

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.495787801300
                                         uncertainty =       0.001275283482

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000248944632
  error estimate for blocks of size 2^( 2) =       0.000257900925
  error estimate for blocks of size 2^( 3) =       0.000265943361
  error estimate for blocks of size 2^( 4) =       0.000271679855
  error estimate for blocks of size 2^( 5) =       0.000275184888
  error estimate for blocks of size 2^( 6) =       0.000276707935
  error estimate for blocks of size 2^( 7) =       0.000277419244
  error estimate for blocks of size 2^( 8) =       0.000278197527
  error estimate for blocks of size 2^( 9) =       0.000278235481

      target function =                  N/A
              le_mean =     -22.669494083023
             les_mean =     514.420916790459
             stat err =       0.000277640047
             autocorr =       1.243823289779
              std dev =       0.704121750331
             le_variance =       0.495787439290

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.496108694263
                                         uncertainty =       0.001443063088

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.496108694263
                                         uncertainty =       0.001443063088

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000249024950
  error estimate for blocks of size 2^( 2) =       0.000257976046
  error estimate for blocks of size 2^( 3) =       0.000266009660
  error estimate for blocks of size 2^( 4) =       0.000271741770
  error estimate for blocks of size 2^( 5) =       0.000275246168
  error estimate for blocks of size 2^( 6) =       0.000276770817
  error estimate for blocks of size 2^( 7) =       0.000277483511
  error estimate for blocks of size 2^( 8) =       0.000278243122
  error estimate for blocks of size 2^( 9) =       0.000278268283

      target function =                  N/A
              le_mean =     -22.669495212170
             les_mean =     514.467116192326
             stat err =       0.000277691433
             autocorr =       1.243481244748
              std dev =       0.704348924369
             le_variance =       0.496107407259

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.560536013715
                                         uncertainty =       0.064373980018

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.560536013715
                                         uncertainty =       0.064373980018

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000264686514
  error estimate for blocks of size 2^( 2) =       0.000273156403
  error estimate for blocks of size 2^( 3) =       0.000280725123
  error estimate for blocks of size 2^( 4) =       0.000286244263
  error estimate for blocks of size 2^( 5) =       0.000289538538
  error estimate for blocks of size 2^( 6) =       0.000290770080
  error estimate for blocks of size 2^( 7) =       0.000291297247
  error estimate for blocks of size 2^( 8) =       0.000292439231
  error estimate for blocks of size 2^( 9) =       0.000292423312

      target function =                  N/A
              le_mean =     -22.669406212851
             les_mean =     554.902736611787
             stat err =       0.000291732467
             autocorr =       1.214803129724
              std dev =       0.748646515115
             le_variance =       0.560471604594

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.495786756555
                                         uncertainty =       0.001288643866

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.495786756555
                                         uncertainty =       0.001288643866

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000248944340
  error estimate for blocks of size 2^( 2) =       0.000257900439
  error estimate for blocks of size 2^( 3) =       0.000265942471
  error estimate for blocks of size 2^( 4) =       0.000271678306
  error estimate for blocks of size 2^( 5) =       0.000275183315
  error estimate for blocks of size 2^( 6) =       0.000276706491
  error estimate for blocks of size 2^( 7) =       0.000277417294
  error estimate for blocks of size 2^( 8) =       0.000278192909
  error estimate for blocks of size 2^( 9) =       0.000278232755

      target function =                  N/A
              le_mean =     -22.669491896097
             les_mean =     514.513434488874
             stat err =       0.000277637362
             autocorr =       1.243802160300
              std dev =       0.704120923396
             le_variance =       0.495786274764


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.669494083023        initial
     6.1035e-02     6.1035e-01             1.1441e-03       -22.669495212170  <--
     2.4414e-01     2.4414e+00             5.6719e-04       -22.669406212851
     9.7656e-01     9.7656e+00             2.0226e-04       -22.669491896097

*****************************************************************************
Applying the update for shift_i =   6.1035e-02     and shift_s =   6.1035e-01
*****************************************************************************

  Execution time = 1.7312e+02
  </log>
  <optVariables href="FORM.s013.opt.xml">
ci_001                -7.055736e-01 3 1  ON 0
ci_002                -7.052276e-01 3 1  ON 1
ci_003                -4.045477e-02 3 1  ON 2
ci_004                -3.959280e-02 3 1  ON 3
ci_005                 1.581326e-02 3 1  ON 4
ci_006                 1.613417e-02 3 1  ON 5
ci_007                 1.224028e-02 3 1  ON 6
ci_008                 1.295228e-02 3 1  ON 7
ci_009                -1.177087e-02 3 1  ON 8
ci_010                -1.193455e-02 3 1  ON 9
ci_011                -8.326538e-03 3 1  ON 10
ci_012                -8.155062e-03 3 1  ON 11
ci_013                 1.002275e-02 3 1  ON 12
ci_014                 8.886373e-03 3 1  ON 13
ci_015                 1.149271e-02 3 1  ON 14
ci_016                 1.350489e-02 3 1  ON 15
ci_017                 1.038033e-02 3 1  ON 16
ci_018                 1.153242e-02 3 1  ON 17
ci_019                -1.865380e-03 3 1  ON 18
ci_020                -2.898080e-03 3 1  ON 19
ci_021                -7.521837e-03 3 1  ON 20
ci_022                -8.545829e-03 3 1  ON 21
ci_023                 8.384486e-03 3 1  ON 22
ci_024                 8.254002e-03 3 1  ON 23
ci_025                 3.858105e-03 3 1  ON 24
ci_026                 4.769826e-03 3 1  ON 25
ci_027                 6.262329e-03 3 1  ON 26
ci_028                 6.516100e-03 3 1  ON 27
ci_029                -4.782707e-03 3 1  ON 28
ci_030                -5.181234e-03 3 1  ON 29
ci_031                -8.439430e-03 3 1  ON 30
ci_032                -7.844465e-03 3 1  ON 31
ci_033                 4.204243e-03 3 1  ON 32
ci_034                 4.561469e-03 3 1  ON 33
ci_035                 1.192418e-03 3 1  ON 34
ci_036                 9.044331e-04 3 1  ON 35
ci_037                 5.209768e-03 3 1  ON 36
ci_038                 5.709138e-03 3 1  ON 37
ci_039                 5.030446e-03 3 1  ON 38
ci_040                 5.035368e-03 3 1  ON 39
ci_041                 5.408939e-03 3 1  ON 40
ci_042                 4.759232e-03 3 1  ON 41
ci_043                 4.852282e-03 3 1  ON 42
ci_044                 4.811327e-03 3 1  ON 43
ci_045                 3.209665e-03 3 1  ON 44
ci_046                 3.333036e-03 3 1  ON 45
ci_047                -3.644520e-04 3 1  ON 46
ci_048                -6.057447e-04 3 1  ON 47
ci_049                 1.657625e-03 3 1  ON 48
ci_050                 6.709338e-04 3 1  ON 49
ci_051                -1.275173e-03 3 1  ON 50
ci_052                -8.753636e-04 3 1  ON 51
ci_053                -2.967834e-03 3 1  ON 52
ci_054                -2.680937e-03 3 1  ON 53
ci_055                -1.520448e-03 3 1  ON 54
ci_056                -2.336783e-03 3 1  ON 55
ci_057                -1.681697e-03 3 1  ON 56
ci_058                -1.353955e-03 3 1  ON 57
ci_059                 1.478408e-04 3 1  ON 58
ci_060                 2.839538e-04 3 1  ON 59
ci_061                 4.370101e-04 3 1  ON 60
ci_062                -8.997931e-04 3 1  ON 61
ci_063                -3.384060e-04 3 1  ON 62
ci_064                -2.551077e-05 3 1  ON 63
ci_065                -2.374349e-03 3 1  ON 64
ci_066                -3.121388e-03 3 1  ON 65
ci_067                -1.886358e-03 3 1  ON 66
ci_068                -1.773482e-03 3 1  ON 67
ci_069                 9.848757e-05 3 1  ON 68
ci_070                -6.663241e-04 3 1  ON 69
ci_071                -2.304002e-03 3 1  ON 70
ci_072                -1.864931e-03 3 1  ON 71
ci_073                 3.455330e-04 3 1  ON 72
ci_074                 9.018805e-05 3 1  ON 73
ci_075                -4.950900e-04 3 1  ON 74
ci_076                -1.169128e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 2.9460e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s014 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s014 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=14  my_counter=0
  time step      = 5.0000e-02
  blocks         = 250
  steps          = 250
  substeps       = 10
  current        = 0
  target samples = 8.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">250</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">6.2500e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">8.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">6.2500e+04</parameter>
<parameter name="steps" condition="int">250</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2673e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="250">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =8000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 14
    time step          = 0.05
    reference energy   = -22.7055
    reference variance = 0.52924
====================================================
  Execution time = 1.0219e+02
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s014
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 62500 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 6.1110e+04
  VMC Eavg = -2.2670e+01
  VMC Evar = 5.0896e-01
  Total weights = 7.820615856e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.9044e+01
  </log>
</opt>
<opt stage="main" walkers="62500">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.495322942512
                                         uncertainty =       0.001666709537

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.495322942512
                                         uncertainty =       0.001666709537

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000248827272
  error estimate for blocks of size 2^( 2) =       0.000257933433
  error estimate for blocks of size 2^( 3) =       0.000265938334
  error estimate for blocks of size 2^( 4) =       0.000271852139
  error estimate for blocks of size 2^( 5) =       0.000275303604
  error estimate for blocks of size 2^( 6) =       0.000276899872
  error estimate for blocks of size 2^( 7) =       0.000278095616
  error estimate for blocks of size 2^( 8) =       0.000278147058
  error estimate for blocks of size 2^( 9) =       0.000278468023

      target function =                  N/A
              le_mean =     -22.669649194716
             les_mean =     514.421956416028
             stat err =       0.000277902642
             autocorr =       1.247353058692
              std dev =       0.703789804733
             le_variance =       0.495320089247


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266964919472e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5259e-02, overlap shift 1.5259e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.669649194739       residual = 5.38e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.669668418026       residual = 2.90e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.669669603639       residual = 3.93e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.669670358195       residual = 1.01e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.669670619446       residual = 2.94e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.669670614629       residual = 1.56e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.669670570218       residual = 1.66e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.669670754797       residual = 5.31e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 1.5259e-02 is 1.518871e-03

solving harmonic davidson linear method for identity shift 6.1035e-02, overlap shift 6.1035e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.669649194739       residual = 5.38e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.669664393808       residual = 1.83e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.669664916660       residual = 1.42e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.669665254042       residual = 1.95e-08           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.669665298097       residual = 2.43e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          4 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 6.1035e-02 is 1.198443e-03

solving harmonic davidson linear method for identity shift 2.4414e-01, overlap shift 2.4414e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.669649194739       residual = 5.38e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.669657466941       residual = 6.91e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.669657505850       residual = 2.04e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.669657577852       residual = 7.97e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 2.4414e-01 is 6.623438e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.028615 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.2125e+02
  </log>
  <optVariables href="FORM.s014.opt.xml">
ci_001                -7.057617e-01 3 1  ON 0
ci_002                -7.051560e-01 3 1  ON 1
ci_003                -3.980761e-02 3 1  ON 2
ci_004                -3.893833e-02 3 1  ON 3
ci_005                 1.591461e-02 3 1  ON 4
ci_006                 1.583281e-02 3 1  ON 5
ci_007                 1.201620e-02 3 1  ON 6
ci_008                 1.276186e-02 3 1  ON 7
ci_009                -1.145778e-02 3 1  ON 8
ci_010                -1.127420e-02 3 1  ON 9
ci_011                -8.166626e-03 3 1  ON 10
ci_012                -7.986891e-03 3 1  ON 11
ci_013                 9.670601e-03 3 1  ON 12
ci_014                 9.574807e-03 3 1  ON 13
ci_015                 1.204901e-02 3 1  ON 14
ci_016                 1.256605e-02 3 1  ON 15
ci_017                 1.125408e-02 3 1  ON 16
ci_018                 1.167644e-02 3 1  ON 17
ci_019                -2.514447e-03 3 1  ON 18
ci_020                -2.910705e-03 3 1  ON 19
ci_021                -7.805385e-03 3 1  ON 20
ci_022                -8.363938e-03 3 1  ON 21
ci_023                 7.846451e-03 3 1  ON 22
ci_024                 8.074772e-03 3 1  ON 23
ci_025                 4.360014e-03 3 1  ON 24
ci_026                 4.065525e-03 3 1  ON 25
ci_027                 6.451242e-03 3 1  ON 26
ci_028                 6.331896e-03 3 1  ON 27
ci_029                -4.951220e-03 3 1  ON 28
ci_030                -4.863935e-03 3 1  ON 29
ci_031                -8.035074e-03 3 1  ON 30
ci_032                -7.785417e-03 3 1  ON 31
ci_033                 4.463659e-03 3 1  ON 32
ci_034                 4.393436e-03 3 1  ON 33
ci_035                 1.183276e-03 3 1  ON 34
ci_036                 9.058660e-04 3 1  ON 35
ci_037                 5.504474e-03 3 1  ON 36
ci_038                 5.277166e-03 3 1  ON 37
ci_039                 4.947523e-03 3 1  ON 38
ci_040                 4.984165e-03 3 1  ON 39
ci_041                 5.302340e-03 3 1  ON 40
ci_042                 4.907672e-03 3 1  ON 41
ci_043                 5.301127e-03 3 1  ON 42
ci_044                 5.050551e-03 3 1  ON 43
ci_045                 2.897760e-03 3 1  ON 44
ci_046                 2.711878e-03 3 1  ON 45
ci_047                -5.430965e-04 3 1  ON 46
ci_048                -7.423998e-04 3 1  ON 47
ci_049                 1.535184e-03 3 1  ON 48
ci_050                 1.169326e-03 3 1  ON 49
ci_051                -1.053218e-03 3 1  ON 50
ci_052                -2.073807e-03 3 1  ON 51
ci_053                -2.308100e-03 3 1  ON 52
ci_054                -2.525762e-03 3 1  ON 53
ci_055                -1.700416e-03 3 1  ON 54
ci_056                -1.797397e-03 3 1  ON 55
ci_057                -1.685991e-03 3 1  ON 56
ci_058                -1.618917e-03 3 1  ON 57
ci_059                 3.521571e-04 3 1  ON 58
ci_060                 1.525729e-04 3 1  ON 59
ci_061                -1.552299e-04 3 1  ON 60
ci_062                -3.147010e-04 3 1  ON 61
ci_063                -4.577105e-04 3 1  ON 62
ci_064                -7.136410e-04 3 1  ON 63
ci_065                -2.198277e-03 3 1  ON 64
ci_066                -2.593492e-03 3 1  ON 65
ci_067                -2.267987e-03 3 1  ON 66
ci_068                -2.463828e-03 3 1  ON 67
ci_069                 3.459213e-04 3 1  ON 68
ci_070                 2.202839e-04 3 1  ON 69
ci_071                -2.113792e-03 3 1  ON 70
ci_072                -2.142610e-03 3 1  ON 71
ci_073                 2.503524e-04 3 1  ON 72
ci_074                 5.644113e-04 3 1  ON 73
ci_075                -6.108017e-04 3 1  ON 74
ci_076                -9.084602e-05 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="250">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =8000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 14
    time step          = 0.05
    reference energy   = -22.5693
    reference variance = 0.451077
====================================================
  Execution time = 9.9827e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s014
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 62500 
  VMC Eavg = -2.2670e+01
  VMC Evar = 5.0905e-01
  Total weights = 7.8209e+06
  Execution time = 1.4655e+01
  </log>
</opt>
<opt stage="main" walkers="62500">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

ERROR CostFunction-> Number of Effective Walkers is too small! 
  Number of effective walkers (samples) / total number of samples = 0.00115962
  User specified threshold minwalkers = 0.3
  If this message appears frequently. You might have to be cautious. 
  Find info about parameter "minwalkers" in the user manual!
Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.502565168701
                                         uncertainty =       0.004856437136

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.502565168701
                                         uncertainty =       0.004856437136

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000250639733
  error estimate for blocks of size 2^( 2) =       0.000259521911
  error estimate for blocks of size 2^( 3) =       0.000267561782
  error estimate for blocks of size 2^( 4) =       0.000273252710
  error estimate for blocks of size 2^( 5) =       0.000276704943
  error estimate for blocks of size 2^( 6) =       0.000278960020
  error estimate for blocks of size 2^( 7) =       0.000279198147
  error estimate for blocks of size 2^( 8) =       0.000278950673
  error estimate for blocks of size 2^( 9) =       0.000278972230

      target function =                  N/A
              le_mean =     -22.670074126054
             les_mean =     516.430386235537
             stat err =       0.000279020268
             autocorr =       1.239286346079
              std dev =       0.708916218554
             le_variance =       0.502562204929

ERROR CostFunction-> Number of Effective Walkers is too small! 
  Number of effective walkers (samples) / total number of samples = 0.0711687
  User specified threshold minwalkers = 0.3
  If this message appears frequently. You might have to be cautious. 
  Find info about parameter "minwalkers" in the user manual!
Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.497682627528
                                         uncertainty =       0.001448473853

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.497682627528
                                         uncertainty =       0.001448473853

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000249419491
  error estimate for blocks of size 2^( 2) =       0.000258347022
  error estimate for blocks of size 2^( 3) =       0.000266421310
  error estimate for blocks of size 2^( 4) =       0.000272109141
  error estimate for blocks of size 2^( 5) =       0.000275554539
  error estimate for blocks of size 2^( 6) =       0.000277852986
  error estimate for blocks of size 2^( 7) =       0.000278039800
  error estimate for blocks of size 2^( 8) =       0.000277759345
  error estimate for blocks of size 2^( 9) =       0.000277797446

      target function =                  N/A
              le_mean =     -22.670041311154
             les_mean =     514.464015443617
             stat err =       0.000277862394
             autocorr =       1.241077127702
              std dev =       0.705464852678
             le_variance =       0.497680658363

ERROR CostFunction-> Number of Effective Walkers is too small! 
  Number of effective walkers (samples) / total number of samples = 0.00116678
  User specified threshold minwalkers = 0.3
  If this message appears frequently. You might have to be cautious. 
  Find info about parameter "minwalkers" in the user manual!
Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.499621559666
                                         uncertainty =       0.001919665313

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.499621559666
                                         uncertainty =       0.001919665313

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000249905153
  error estimate for blocks of size 2^( 2) =       0.000258814381
  error estimate for blocks of size 2^( 3) =       0.000266888295
  error estimate for blocks of size 2^( 4) =       0.000272544522
  error estimate for blocks of size 2^( 5) =       0.000275995587
  error estimate for blocks of size 2^( 6) =       0.000278301526
  error estimate for blocks of size 2^( 7) =       0.000278506637
  error estimate for blocks of size 2^( 8) =       0.000278174113
  error estimate for blocks of size 2^( 9) =       0.000278249126

      target function =                  N/A
              le_mean =     -22.670060559873
             les_mean =     514.801847193032
             stat err =       0.000278307850
             autocorr =       1.240225030372
              std dev =       0.706838512559
             le_variance =       0.499620682837

ERROR CostFunction-> Number of Effective Walkers is too small! 
  Number of effective walkers (samples) / total number of samples = 0.0164462
  User specified threshold minwalkers = 0.3
  If this message appears frequently. You might have to be cautious. 
  Find info about parameter "minwalkers" in the user manual!
Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.497741761833
                                         uncertainty =       0.001446707699

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.497741761833
                                         uncertainty =       0.001446707699

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000249434317
  error estimate for blocks of size 2^( 2) =       0.000258359979
  error estimate for blocks of size 2^( 3) =       0.000266434666
  error estimate for blocks of size 2^( 4) =       0.000272121329
  error estimate for blocks of size 2^( 5) =       0.000275565697
  error estimate for blocks of size 2^( 6) =       0.000277863947
  error estimate for blocks of size 2^( 7) =       0.000278054971
  error estimate for blocks of size 2^( 8) =       0.000277777077
  error estimate for blocks of size 2^( 9) =       0.000277807539

      target function =                  N/A
              le_mean =     -22.670035769628
             les_mean =     514.447997101667
             stat err =       0.000277875883
             autocorr =       1.241050078994
              std dev =       0.705506787311
             le_variance =       0.497739826942


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.670074126054        initial  <--
     1.5259e-02     1.5259e-01             1.5189e-03       -22.670041311154
     6.1035e-02     6.1035e-01             1.1984e-03       -22.670060559873
     2.4414e-01     2.4414e+00             6.6234e-04       -22.670035769628

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 173.9076
  </log>
  <optVariables href="FORM.s014.opt.xml">
ci_001                -7.055736e-01 3 1  ON 0
ci_002                -7.052276e-01 3 1  ON 1
ci_003                -4.045477e-02 3 1  ON 2
ci_004                -3.959280e-02 3 1  ON 3
ci_005                 1.581326e-02 3 1  ON 4
ci_006                 1.613417e-02 3 1  ON 5
ci_007                 1.224028e-02 3 1  ON 6
ci_008                 1.295228e-02 3 1  ON 7
ci_009                -1.177087e-02 3 1  ON 8
ci_010                -1.193455e-02 3 1  ON 9
ci_011                -8.326538e-03 3 1  ON 10
ci_012                -8.155062e-03 3 1  ON 11
ci_013                 1.002275e-02 3 1  ON 12
ci_014                 8.886373e-03 3 1  ON 13
ci_015                 1.149271e-02 3 1  ON 14
ci_016                 1.350489e-02 3 1  ON 15
ci_017                 1.038033e-02 3 1  ON 16
ci_018                 1.153242e-02 3 1  ON 17
ci_019                -1.865380e-03 3 1  ON 18
ci_020                -2.898080e-03 3 1  ON 19
ci_021                -7.521837e-03 3 1  ON 20
ci_022                -8.545829e-03 3 1  ON 21
ci_023                 8.384486e-03 3 1  ON 22
ci_024                 8.254002e-03 3 1  ON 23
ci_025                 3.858105e-03 3 1  ON 24
ci_026                 4.769826e-03 3 1  ON 25
ci_027                 6.262329e-03 3 1  ON 26
ci_028                 6.516100e-03 3 1  ON 27
ci_029                -4.782707e-03 3 1  ON 28
ci_030                -5.181234e-03 3 1  ON 29
ci_031                -8.439430e-03 3 1  ON 30
ci_032                -7.844465e-03 3 1  ON 31
ci_033                 4.204243e-03 3 1  ON 32
ci_034                 4.561469e-03 3 1  ON 33
ci_035                 1.192418e-03 3 1  ON 34
ci_036                 9.044331e-04 3 1  ON 35
ci_037                 5.209768e-03 3 1  ON 36
ci_038                 5.709138e-03 3 1  ON 37
ci_039                 5.030446e-03 3 1  ON 38
ci_040                 5.035368e-03 3 1  ON 39
ci_041                 5.408939e-03 3 1  ON 40
ci_042                 4.759232e-03 3 1  ON 41
ci_043                 4.852282e-03 3 1  ON 42
ci_044                 4.811327e-03 3 1  ON 43
ci_045                 3.209665e-03 3 1  ON 44
ci_046                 3.333036e-03 3 1  ON 45
ci_047                -3.644520e-04 3 1  ON 46
ci_048                -6.057447e-04 3 1  ON 47
ci_049                 1.657625e-03 3 1  ON 48
ci_050                 6.709338e-04 3 1  ON 49
ci_051                -1.275173e-03 3 1  ON 50
ci_052                -8.753636e-04 3 1  ON 51
ci_053                -2.967834e-03 3 1  ON 52
ci_054                -2.680937e-03 3 1  ON 53
ci_055                -1.520448e-03 3 1  ON 54
ci_056                -2.336783e-03 3 1  ON 55
ci_057                -1.681697e-03 3 1  ON 56
ci_058                -1.353955e-03 3 1  ON 57
ci_059                 1.478408e-04 3 1  ON 58
ci_060                 2.839538e-04 3 1  ON 59
ci_061                 4.370101e-04 3 1  ON 60
ci_062                -8.997931e-04 3 1  ON 61
ci_063                -3.384060e-04 3 1  ON 62
ci_064                -2.551077e-05 3 1  ON 63
ci_065                -2.374349e-03 3 1  ON 64
ci_066                -3.121388e-03 3 1  ON 65
ci_067                -1.886358e-03 3 1  ON 66
ci_068                -1.773482e-03 3 1  ON 67
ci_069                 9.848757e-05 3 1  ON 68
ci_070                -6.663241e-04 3 1  ON 69
ci_071                -2.304002e-03 3 1  ON 70
ci_072                -1.864931e-03 3 1  ON 71
ci_073                 3.455330e-04 3 1  ON 72
ci_074                 9.018805e-05 3 1  ON 73
ci_075                -4.950900e-04 3 1  ON 74
ci_076                -1.169128e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 2.9518e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s015 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s015 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=15  my_counter=0
  time step      = 5.0000e-02
  blocks         = 250
  steps          = 250
  substeps       = 10
  current        = 0
  target samples = 8.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">250</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">6.2500e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">8.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">6.2500e+04</parameter>
<parameter name="steps" condition="int">250</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2671e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="250">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =8000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 15
    time step          = 0.05
    reference energy   = -22.7249
    reference variance = 0.427308
====================================================
  Execution time = 1.0396e+02
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s015
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 62500 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 6.1096e+04
  VMC Eavg = -2.2670e+01
  VMC Evar = 5.0966e-01
  Total weights = 7.820458481e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.8899e+01
  </log>
</opt>
<opt stage="main" walkers="62500">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.496383828521
                                         uncertainty =       0.001302386194

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.496383828521
                                         uncertainty =       0.001302386194

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000249094266
  error estimate for blocks of size 2^( 2) =       0.000257998320
  error estimate for blocks of size 2^( 3) =       0.000265782332
  error estimate for blocks of size 2^( 4) =       0.000271559831
  error estimate for blocks of size 2^( 5) =       0.000274992653
  error estimate for blocks of size 2^( 6) =       0.000276711625
  error estimate for blocks of size 2^( 7) =       0.000277695045
  error estimate for blocks of size 2^( 8) =       0.000278457750
  error estimate for blocks of size 2^( 9) =       0.000278115447

      target function =                  N/A
              le_mean =     -22.669506524023
             les_mean =     514.416189962197
             stat err =       0.000277744967
             autocorr =       1.243268513595
              std dev =       0.704544977291
             le_variance =       0.496383625026


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266950652402e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5259e-01, overlap shift 1.5259e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.669506524048       residual = 5.17e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.669516694278       residual = 1.42e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.669517093754       residual = 5.48e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.669517108100       residual = 1.53e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 1.5259e-01 is 9.722369e-04

solving harmonic davidson linear method for identity shift 6.1035e-01, overlap shift 6.1035e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.669506524048       residual = 5.17e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.669510578860       residual = 4.38e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.669510617372       residual = 8.26e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 6.1035e-01 is 3.478353e-04

solving harmonic davidson linear method for identity shift 2.4414e+00, overlap shift 2.4414e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.669506524048       residual = 5.17e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.669507714810       residual = 4.05e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.669507715968       residual = 6.84e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 2.4414e+00 is 9.654792e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.029771 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.2287e+02
  </log>
  <optVariables href="FORM.s015.opt.xml">
ci_001                -7.055743e-01 3 1  ON 0
ci_002                -7.052384e-01 3 1  ON 1
ci_003                -4.033020e-02 3 1  ON 2
ci_004                -3.956513e-02 3 1  ON 3
ci_005                 1.585527e-02 3 1  ON 4
ci_006                 1.612915e-02 3 1  ON 5
ci_007                 1.221070e-02 3 1  ON 6
ci_008                 1.281898e-02 3 1  ON 7
ci_009                -1.170033e-02 3 1  ON 8
ci_010                -1.184396e-02 3 1  ON 9
ci_011                -8.338608e-03 3 1  ON 10
ci_012                -8.129239e-03 3 1  ON 11
ci_013                 9.959984e-03 3 1  ON 12
ci_014                 9.043775e-03 3 1  ON 13
ci_015                 1.184054e-02 3 1  ON 14
ci_016                 1.338685e-02 3 1  ON 15
ci_017                 1.059528e-02 3 1  ON 16
ci_018                 1.140792e-02 3 1  ON 17
ci_019                -1.979709e-03 3 1  ON 18
ci_020                -2.791059e-03 3 1  ON 19
ci_021                -7.798797e-03 3 1  ON 20
ci_022                -8.484123e-03 3 1  ON 21
ci_023                 8.417729e-03 3 1  ON 22
ci_024                 8.182531e-03 3 1  ON 23
ci_025                 3.863199e-03 3 1  ON 24
ci_026                 4.678949e-03 3 1  ON 25
ci_027                 6.317843e-03 3 1  ON 26
ci_028                 6.469407e-03 3 1  ON 27
ci_029                -4.764443e-03 3 1  ON 28
ci_030                -5.121124e-03 3 1  ON 29
ci_031                -8.354747e-03 3 1  ON 30
ci_032                -7.762389e-03 3 1  ON 31
ci_033                 4.173558e-03 3 1  ON 32
ci_034                 4.438719e-03 3 1  ON 33
ci_035                 1.216525e-03 3 1  ON 34
ci_036                 1.118306e-03 3 1  ON 35
ci_037                 5.333626e-03 3 1  ON 36
ci_038                 5.547334e-03 3 1  ON 37
ci_039                 5.138095e-03 3 1  ON 38
ci_040                 5.002972e-03 3 1  ON 39
ci_041                 5.291492e-03 3 1  ON 40
ci_042                 4.875277e-03 3 1  ON 41
ci_043                 4.847675e-03 3 1  ON 42
ci_044                 4.902848e-03 3 1  ON 43
ci_045                 3.214057e-03 3 1  ON 44
ci_046                 3.378372e-03 3 1  ON 45
ci_047                -2.883551e-04 3 1  ON 46
ci_048                -5.983202e-04 3 1  ON 47
ci_049                 1.624346e-03 3 1  ON 48
ci_050                 8.426243e-04 3 1  ON 49
ci_051                -1.264944e-03 3 1  ON 50
ci_052                -9.001093e-04 3 1  ON 51
ci_053                -2.924728e-03 3 1  ON 52
ci_054                -2.546097e-03 3 1  ON 53
ci_055                -1.520022e-03 3 1  ON 54
ci_056                -2.111206e-03 3 1  ON 55
ci_057                -1.695621e-03 3 1  ON 56
ci_058                -1.316179e-03 3 1  ON 57
ci_059                 1.876358e-04 3 1  ON 58
ci_060                 3.709538e-04 3 1  ON 59
ci_061                 3.374969e-04 3 1  ON 60
ci_062                -7.675214e-04 3 1  ON 61
ci_063                -4.069960e-04 3 1  ON 62
ci_064                -2.005264e-04 3 1  ON 63
ci_065                -2.408529e-03 3 1  ON 64
ci_066                -2.906873e-03 3 1  ON 65
ci_067                -1.939698e-03 3 1  ON 66
ci_068                -1.869991e-03 3 1  ON 67
ci_069                -1.370168e-04 3 1  ON 68
ci_070                -5.417277e-04 3 1  ON 69
ci_071                -2.214289e-03 3 1  ON 70
ci_072                -2.010063e-03 3 1  ON 71
ci_073                 2.792704e-04 3 1  ON 72
ci_074                -1.541660e-05 3 1  ON 73
ci_075                -3.814753e-04 3 1  ON 74
ci_076                -1.450572e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="250">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =8000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 15
    time step          = 0.05
    reference energy   = -22.598
    reference variance = 0.616916
====================================================
  Execution time = 1.0180e+02
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s015
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 62500 
  VMC Eavg = -2.2670e+01
  VMC Evar = 5.1247e-01
  Total weights = 7.8211e+06
  Execution time = 1.4656e+01
  </log>
</opt>
<opt stage="main" walkers="62500">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.499321019648
                                         uncertainty =       0.001790274742

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.499321019648
                                         uncertainty =       0.001790274742

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000249830015
  error estimate for blocks of size 2^( 2) =       0.000258745340
  error estimate for blocks of size 2^( 3) =       0.000266790624
  error estimate for blocks of size 2^( 4) =       0.000272593483
  error estimate for blocks of size 2^( 5) =       0.000275901907
  error estimate for blocks of size 2^( 6) =       0.000277438160
  error estimate for blocks of size 2^( 7) =       0.000278136320
  error estimate for blocks of size 2^( 8) =       0.000277828561
  error estimate for blocks of size 2^( 9) =       0.000277409092

      target function =                  N/A
              le_mean =     -22.669768473328
             les_mean =     514.432645071394
             stat err =       0.000277703033
             autocorr =       1.235583270303
              std dev =       0.706625990502
             le_variance =       0.499320290453

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.499292959732
                                         uncertainty =       0.001785259825

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.499292959732
                                         uncertainty =       0.001785259825

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000249822998
  error estimate for blocks of size 2^( 2) =       0.000258739321
  error estimate for blocks of size 2^( 3) =       0.000266783127
  error estimate for blocks of size 2^( 4) =       0.000272587260
  error estimate for blocks of size 2^( 5) =       0.000275892632
  error estimate for blocks of size 2^( 6) =       0.000277430385
  error estimate for blocks of size 2^( 7) =       0.000278122602
  error estimate for blocks of size 2^( 8) =       0.000277809220
  error estimate for blocks of size 2^( 9) =       0.000277395510

      target function =                  N/A
              le_mean =     -22.669768914768
             les_mean =     514.438749928255
             stat err =       0.000277689429
             autocorr =       1.235531617200
              std dev =       0.706606144814
             le_variance =       0.499292243889

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.499291607080
                                         uncertainty =       0.001786492368

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.499291607080
                                         uncertainty =       0.001786492368

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000249822658
  error estimate for blocks of size 2^( 2) =       0.000258738630
  error estimate for blocks of size 2^( 3) =       0.000266782277
  error estimate for blocks of size 2^( 4) =       0.000272586367
  error estimate for blocks of size 2^( 5) =       0.000275892383
  error estimate for blocks of size 2^( 6) =       0.000277429233
  error estimate for blocks of size 2^( 7) =       0.000278122900
  error estimate for blocks of size 2^( 8) =       0.000277814700
  error estimate for blocks of size 2^( 9) =       0.000277401953

      target function =                  N/A
              le_mean =     -22.669767741148
             les_mean =     514.431258320652
             stat err =       0.000277692197
             autocorr =       1.235559604352
              std dev =       0.706605183517
             le_variance =       0.499290885374

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.499310822913
                                         uncertainty =       0.001789690136

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.499310822913
                                         uncertainty =       0.001789690136

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000249827464
  error estimate for blocks of size 2^( 2) =       0.000258742883
  error estimate for blocks of size 2^( 3) =       0.000266787880
  error estimate for blocks of size 2^( 4) =       0.000272590947
  error estimate for blocks of size 2^( 5) =       0.000275898990
  error estimate for blocks of size 2^( 6) =       0.000277435405
  error estimate for blocks of size 2^( 7) =       0.000278132522
  error estimate for blocks of size 2^( 8) =       0.000277824674
  error estimate for blocks of size 2^( 9) =       0.000277405700

      target function =                  N/A
              le_mean =     -22.669767459216
             les_mean =     514.431811317866
             stat err =       0.000277699575
             autocorr =       1.235577726689
              std dev =       0.706618776028
             le_variance =       0.499310094635


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.669768473328        initial
     1.5259e-01     1.5259e+00             9.7224e-04       -22.669768914768  <--
     6.1035e-01     6.1035e+00             3.4784e-04       -22.669767741148
     2.4414e+00     2.4414e+01             9.6548e-05       -22.669767459216

*****************************************************************************
Applying the update for shift_i =   1.5259e-01     and shift_s =   1.5259e+00
*****************************************************************************

  Execution time = 1.7507e+02
  </log>
  <optVariables href="FORM.s015.opt.xml">
ci_001                -7.055779e-01 3 1  ON 0
ci_002                -7.052570e-01 3 1  ON 1
ci_003                -4.006271e-02 3 1  ON 2
ci_004                -3.952205e-02 3 1  ON 3
ci_005                 1.589835e-02 3 1  ON 4
ci_006                 1.612966e-02 3 1  ON 5
ci_007                 1.216657e-02 3 1  ON 6
ci_008                 1.263545e-02 3 1  ON 7
ci_009                -1.159238e-02 3 1  ON 8
ci_010                -1.169517e-02 3 1  ON 9
ci_011                -8.358088e-03 3 1  ON 10
ci_012                -8.115904e-03 3 1  ON 11
ci_013                 9.861650e-03 3 1  ON 12
ci_014                 9.265468e-03 3 1  ON 13
ci_015                 1.246495e-02 3 1  ON 14
ci_016                 1.315282e-02 3 1  ON 15
ci_017                 1.097226e-02 3 1  ON 16
ci_018                 1.115920e-02 3 1  ON 17
ci_019                -2.159659e-03 3 1  ON 18
ci_020                -2.600720e-03 3 1  ON 19
ci_021                -8.265246e-03 3 1  ON 20
ci_022                -8.395643e-03 3 1  ON 21
ci_023                 8.458057e-03 3 1  ON 22
ci_024                 8.088615e-03 3 1  ON 23
ci_025                 3.889166e-03 3 1  ON 24
ci_026                 4.507482e-03 3 1  ON 25
ci_027                 6.369537e-03 3 1  ON 26
ci_028                 6.426165e-03 3 1  ON 27
ci_029                -4.730172e-03 3 1  ON 28
ci_030                -5.037407e-03 3 1  ON 29
ci_031                -8.175266e-03 3 1  ON 30
ci_032                -7.639514e-03 3 1  ON 31
ci_033                 4.122146e-03 3 1  ON 32
ci_034                 4.248802e-03 3 1  ON 33
ci_035                 1.243063e-03 3 1  ON 34
ci_036                 1.357054e-03 3 1  ON 35
ci_037                 5.523283e-03 3 1  ON 36
ci_038                 5.323520e-03 3 1  ON 37
ci_039                 5.255670e-03 3 1  ON 38
ci_040                 4.967709e-03 3 1  ON 39
ci_041                 5.140315e-03 3 1  ON 40
ci_042                 5.025181e-03 3 1  ON 41
ci_043                 4.839740e-03 3 1  ON 42
ci_044                 5.037849e-03 3 1  ON 43
ci_045                 3.225209e-03 3 1  ON 44
ci_046                 3.462190e-03 3 1  ON 45
ci_047                -2.069504e-04 3 1  ON 46
ci_048                -5.829729e-04 3 1  ON 47
ci_049                 1.576731e-03 3 1  ON 48
ci_050                 1.093316e-03 3 1  ON 49
ci_051                -1.255067e-03 3 1  ON 50
ci_052                -9.084977e-04 3 1  ON 51
ci_053                -2.849084e-03 3 1  ON 52
ci_054                -2.343062e-03 3 1  ON 53
ci_055                -1.517638e-03 3 1  ON 54
ci_056                -1.730321e-03 3 1  ON 55
ci_057                -1.713471e-03 3 1  ON 56
ci_058                -1.264555e-03 3 1  ON 57
ci_059                 2.403793e-04 3 1  ON 58
ci_060                 4.807817e-04 3 1  ON 59
ci_061                 1.650273e-04 3 1  ON 60
ci_062                -5.609035e-04 3 1  ON 61
ci_063                -5.276110e-04 3 1  ON 62
ci_064                -4.505137e-04 3 1  ON 63
ci_065                -2.439361e-03 3 1  ON 64
ci_066                -2.595435e-03 3 1  ON 65
ci_067                -2.037101e-03 3 1  ON 66
ci_068                -2.034514e-03 3 1  ON 67
ci_069                -4.765004e-04 3 1  ON 68
ci_070                -3.820298e-04 3 1  ON 69
ci_071                -2.082595e-03 3 1  ON 70
ci_072                -2.214855e-03 3 1  ON 71
ci_073                 2.041560e-04 3 1  ON 72
ci_074                -1.369163e-04 3 1  ON 73
ci_075                -2.074602e-04 3 1  ON 74
ci_076                -1.962945e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 2.9795e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s016 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s016 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=16  my_counter=0
  time step      = 5.0000e-02
  blocks         = 250
  steps          = 250
  substeps       = 10
  current        = 0
  target samples = 8.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">250</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">6.2500e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">8.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">6.2500e+04</parameter>
<parameter name="steps" condition="int">250</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2670e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="250">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =8000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 16
    time step          = 0.05
    reference energy   = -22.7188
    reference variance = 0.298379
====================================================
  Execution time = 1.0437e+02
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s016
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 62500 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 6.1044e+04
  VMC Eavg = -2.2670e+01
  VMC Evar = 5.1227e-01
  Total weights = 7.820348622e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.9027e+01
  </log>
</opt>
<opt stage="main" walkers="62500">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.498727934862
                                         uncertainty =       0.002128195407

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.498727934862
                                         uncertainty =       0.002128195407

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000249682819
  error estimate for blocks of size 2^( 2) =       0.000258637986
  error estimate for blocks of size 2^( 3) =       0.000266558409
  error estimate for blocks of size 2^( 4) =       0.000272248077
  error estimate for blocks of size 2^( 5) =       0.000275996023
  error estimate for blocks of size 2^( 6) =       0.000277666762
  error estimate for blocks of size 2^( 7) =       0.000278981354
  error estimate for blocks of size 2^( 8) =       0.000279116847
  error estimate for blocks of size 2^( 9) =       0.000279728639

      target function =                  N/A
              le_mean =     -22.669756320192
             les_mean =     514.430122599906
             stat err =       0.000278873401
             autocorr =       1.247489404528
              std dev =       0.706209659020
             le_variance =       0.498732082492


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266975632019e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.8147e-02, overlap shift 3.8147e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.669756320215       residual = 1.60e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.669770967227       residual = 1.56e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.669768123240       residual = 3.39e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.669767255428       residual = 1.40e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.669767156828       residual = 3.47e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.669767430710       residual = 9.25e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.669767535815       residual = 1.51e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.669767536511       residual = 1.06e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 3.8147e-02 is 4.357171e-03

solving harmonic davidson linear method for identity shift 1.5259e-01, overlap shift 1.5259e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.669756320215       residual = 1.60e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.669764921576       residual = 5.24e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.669763863082       residual = 3.67e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.669763747857       residual = 2.46e-08           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.669763743972       residual = 1.40e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          4 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 1.5259e-01 is 2.343747e-03

solving harmonic davidson linear method for identity shift 6.1035e-01, overlap shift 6.1035e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.669756320215       residual = 1.60e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.669759564747       residual = 1.47e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.669759472416       residual = 2.83e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.669759462033       residual = 6.52e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 6.1035e-01 is 8.312664e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.031690 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.2341e+02
  </log>
  <optVariables href="FORM.s016.opt.xml">
ci_001                -7.048485e-01 3 1  ON 0
ci_002                -7.059393e-01 3 1  ON 1
ci_003                -3.937056e-02 3 1  ON 2
ci_004                -4.032079e-02 3 1  ON 3
ci_005                 1.605500e-02 3 1  ON 4
ci_006                 1.626617e-02 3 1  ON 5
ci_007                 1.225477e-02 3 1  ON 6
ci_008                 1.263167e-02 3 1  ON 7
ci_009                -1.179911e-02 3 1  ON 8
ci_010                -1.124619e-02 3 1  ON 9
ci_011                -8.521456e-03 3 1  ON 10
ci_012                -1.045965e-02 3 1  ON 11
ci_013                 1.048232e-02 3 1  ON 12
ci_014                 9.551123e-03 3 1  ON 13
ci_015                 1.286516e-02 3 1  ON 14
ci_016                 1.363119e-02 3 1  ON 15
ci_017                 1.186436e-02 3 1  ON 16
ci_018                 1.085978e-02 3 1  ON 17
ci_019                -2.488966e-03 3 1  ON 18
ci_020                -2.533603e-03 3 1  ON 19
ci_021                -7.865647e-03 3 1  ON 20
ci_022                -7.238792e-03 3 1  ON 21
ci_023                 8.000854e-03 3 1  ON 22
ci_024                 7.629138e-03 3 1  ON 23
ci_025                 4.015965e-03 3 1  ON 24
ci_026                 3.934081e-03 3 1  ON 25
ci_027                 5.997530e-03 3 1  ON 26
ci_028                 6.610176e-03 3 1  ON 27
ci_029                -5.475193e-03 3 1  ON 28
ci_030                -4.623406e-03 3 1  ON 29
ci_031                -8.161280e-03 3 1  ON 30
ci_032                -7.795313e-03 3 1  ON 31
ci_033                 4.033518e-03 3 1  ON 32
ci_034                 4.491835e-03 3 1  ON 33
ci_035                 1.322522e-03 3 1  ON 34
ci_036                 8.405670e-04 3 1  ON 35
ci_037                 5.711991e-03 3 1  ON 36
ci_038                 5.758674e-03 3 1  ON 37
ci_039                 4.961884e-03 3 1  ON 38
ci_040                 4.914638e-03 3 1  ON 39
ci_041                 5.159143e-03 3 1  ON 40
ci_042                 5.151273e-03 3 1  ON 41
ci_043                 4.681025e-03 3 1  ON 42
ci_044                 5.533447e-03 3 1  ON 43
ci_045                 2.409696e-03 3 1  ON 44
ci_046                 3.518632e-03 3 1  ON 45
ci_047                -6.154448e-04 3 1  ON 46
ci_048                -7.295618e-04 3 1  ON 47
ci_049                 2.491268e-03 3 1  ON 48
ci_050                 1.250734e-03 3 1  ON 49
ci_051                -1.028749e-03 3 1  ON 50
ci_052                -8.744065e-04 3 1  ON 51
ci_053                -3.464095e-03 3 1  ON 52
ci_054                -1.180923e-03 3 1  ON 53
ci_055                -1.166130e-03 3 1  ON 54
ci_056                -1.991469e-03 3 1  ON 55
ci_057                -1.699768e-03 3 1  ON 56
ci_058                -1.311662e-03 3 1  ON 57
ci_059                 3.888628e-05 3 1  ON 58
ci_060                 8.978753e-05 3 1  ON 59
ci_061                -4.414498e-05 3 1  ON 60
ci_062                -1.451561e-04 3 1  ON 61
ci_063                -1.514068e-04 3 1  ON 62
ci_064                -1.380474e-03 3 1  ON 63
ci_065                -2.315843e-03 3 1  ON 64
ci_066                -2.094318e-03 3 1  ON 65
ci_067                -1.774218e-03 3 1  ON 66
ci_068                -2.331840e-03 3 1  ON 67
ci_069                -2.649799e-04 3 1  ON 68
ci_070                -1.158040e-03 3 1  ON 69
ci_071                -1.630234e-03 3 1  ON 70
ci_072                -2.667822e-03 3 1  ON 71
ci_073                 6.274104e-04 3 1  ON 72
ci_074                 4.154124e-04 3 1  ON 73
ci_075                -9.705945e-04 3 1  ON 74
ci_076                -4.652701e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="250">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =8000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 16
    time step          = 0.05
    reference energy   = -22.6103
    reference variance = 0.378106
====================================================
  Execution time = 1.0198e+02
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s016
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 62500 
  VMC Eavg = -2.2670e+01
  VMC Evar = 5.1228e-01
  Total weights = 7.8205e+06
  Execution time = 1.4657e+01
  </log>
</opt>
<opt stage="main" walkers="62500">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.499267017622
                                         uncertainty =       0.003045378895

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.499267017622
                                         uncertainty =       0.003045378895

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000249815705
  error estimate for blocks of size 2^( 2) =       0.000258781906
  error estimate for blocks of size 2^( 3) =       0.000266864943
  error estimate for blocks of size 2^( 4) =       0.000272594175
  error estimate for blocks of size 2^( 5) =       0.000275891778
  error estimate for blocks of size 2^( 6) =       0.000277408383
  error estimate for blocks of size 2^( 7) =       0.000278210638
  error estimate for blocks of size 2^( 8) =       0.000278904425
  error estimate for blocks of size 2^( 9) =       0.000279657476

      target function =                  N/A
              le_mean =     -22.669820341147
             les_mean =     514.511349500948
             stat err =       0.000278545231
             autocorr =       1.243231420973
              std dev =       0.706585517208
             le_variance =       0.499263093128

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.499396641979
                                         uncertainty =       0.002994366640

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.499396641979
                                         uncertainty =       0.002994366640

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000249848140
  error estimate for blocks of size 2^( 2) =       0.000258812526
  error estimate for blocks of size 2^( 3) =       0.000266901058
  error estimate for blocks of size 2^( 4) =       0.000272629581
  error estimate for blocks of size 2^( 5) =       0.000275952728
  error estimate for blocks of size 2^( 6) =       0.000277467141
  error estimate for blocks of size 2^( 7) =       0.000278303298
  error estimate for blocks of size 2^( 8) =       0.000279037889
  error estimate for blocks of size 2^( 9) =       0.000279853813

      target function =                  N/A
              le_mean =     -22.669809475450
             les_mean =     514.506128610931
             stat err =       0.000278665535
             autocorr =       1.243982521659
              std dev =       0.706677255385
             le_variance =       0.499392743279

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.508005634402
                                         uncertainty =       0.009174294644

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.508005634402
                                         uncertainty =       0.009174294644

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000251992863
  error estimate for blocks of size 2^( 2) =       0.000260885181
  error estimate for blocks of size 2^( 3) =       0.000268921212
  error estimate for blocks of size 2^( 4) =       0.000274577429
  error estimate for blocks of size 2^( 5) =       0.000277895900
  error estimate for blocks of size 2^( 6) =       0.000279347079
  error estimate for blocks of size 2^( 7) =       0.000280270096
  error estimate for blocks of size 2^( 8) =       0.000280989379
  error estimate for blocks of size 2^( 9) =       0.000281706363

      target function =                  N/A
              le_mean =     -22.669845973393
             les_mean =     514.721689053005
             stat err =       0.000280578229
             autocorr =       1.239742407658
              std dev =       0.712743450191
             le_variance =       0.508003225790

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.498823172794
                                         uncertainty =       0.003028494421

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.498823172794
                                         uncertainty =       0.003028494421

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000249704651
  error estimate for blocks of size 2^( 2) =       0.000258671484
  error estimate for blocks of size 2^( 3) =       0.000266763008
  error estimate for blocks of size 2^( 4) =       0.000272495996
  error estimate for blocks of size 2^( 5) =       0.000275797685
  error estimate for blocks of size 2^( 6) =       0.000277313406
  error estimate for blocks of size 2^( 7) =       0.000278119074
  error estimate for blocks of size 2^( 8) =       0.000278837982
  error estimate for blocks of size 2^( 9) =       0.000279605645

      target function =                  N/A
              le_mean =     -22.669804626058
             les_mean =     514.449055294745
             stat err =       0.000278469027
             autocorr =       1.243656748395
              std dev =       0.706271408728
             le_variance =       0.498819302787


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.669820341147        initial
     3.8147e-02     3.8147e-01             4.3572e-03       -22.669809475450
     1.5259e-01     1.5259e+00             2.3437e-03       -22.669845973393  <--
     6.1035e-01     6.1035e+00             8.3127e-04       -22.669804626058

*****************************************************************************
Applying the update for shift_i =   1.5259e-01     and shift_s =   1.5259e+00
*****************************************************************************

  Execution time = 1.7552e+02
  </log>
  <optVariables href="FORM.s016.opt.xml">
ci_001                -7.048485e-01 3 1  ON 0
ci_002                -7.059393e-01 3 1  ON 1
ci_003                -3.937056e-02 3 1  ON 2
ci_004                -4.032079e-02 3 1  ON 3
ci_005                 1.605500e-02 3 1  ON 4
ci_006                 1.626617e-02 3 1  ON 5
ci_007                 1.225477e-02 3 1  ON 6
ci_008                 1.263167e-02 3 1  ON 7
ci_009                -1.179911e-02 3 1  ON 8
ci_010                -1.124619e-02 3 1  ON 9
ci_011                -8.521456e-03 3 1  ON 10
ci_012                -1.045965e-02 3 1  ON 11
ci_013                 1.048232e-02 3 1  ON 12
ci_014                 9.551123e-03 3 1  ON 13
ci_015                 1.286516e-02 3 1  ON 14
ci_016                 1.363119e-02 3 1  ON 15
ci_017                 1.186436e-02 3 1  ON 16
ci_018                 1.085978e-02 3 1  ON 17
ci_019                -2.488966e-03 3 1  ON 18
ci_020                -2.533603e-03 3 1  ON 19
ci_021                -7.865647e-03 3 1  ON 20
ci_022                -7.238792e-03 3 1  ON 21
ci_023                 8.000854e-03 3 1  ON 22
ci_024                 7.629138e-03 3 1  ON 23
ci_025                 4.015965e-03 3 1  ON 24
ci_026                 3.934081e-03 3 1  ON 25
ci_027                 5.997530e-03 3 1  ON 26
ci_028                 6.610176e-03 3 1  ON 27
ci_029                -5.475193e-03 3 1  ON 28
ci_030                -4.623406e-03 3 1  ON 29
ci_031                -8.161280e-03 3 1  ON 30
ci_032                -7.795313e-03 3 1  ON 31
ci_033                 4.033518e-03 3 1  ON 32
ci_034                 4.491835e-03 3 1  ON 33
ci_035                 1.322522e-03 3 1  ON 34
ci_036                 8.405670e-04 3 1  ON 35
ci_037                 5.711991e-03 3 1  ON 36
ci_038                 5.758674e-03 3 1  ON 37
ci_039                 4.961884e-03 3 1  ON 38
ci_040                 4.914638e-03 3 1  ON 39
ci_041                 5.159143e-03 3 1  ON 40
ci_042                 5.151273e-03 3 1  ON 41
ci_043                 4.681025e-03 3 1  ON 42
ci_044                 5.533447e-03 3 1  ON 43
ci_045                 2.409696e-03 3 1  ON 44
ci_046                 3.518632e-03 3 1  ON 45
ci_047                -6.154448e-04 3 1  ON 46
ci_048                -7.295618e-04 3 1  ON 47
ci_049                 2.491268e-03 3 1  ON 48
ci_050                 1.250734e-03 3 1  ON 49
ci_051                -1.028749e-03 3 1  ON 50
ci_052                -8.744065e-04 3 1  ON 51
ci_053                -3.464095e-03 3 1  ON 52
ci_054                -1.180923e-03 3 1  ON 53
ci_055                -1.166130e-03 3 1  ON 54
ci_056                -1.991469e-03 3 1  ON 55
ci_057                -1.699768e-03 3 1  ON 56
ci_058                -1.311662e-03 3 1  ON 57
ci_059                 3.888628e-05 3 1  ON 58
ci_060                 8.978753e-05 3 1  ON 59
ci_061                -4.414498e-05 3 1  ON 60
ci_062                -1.451561e-04 3 1  ON 61
ci_063                -1.514068e-04 3 1  ON 62
ci_064                -1.380474e-03 3 1  ON 63
ci_065                -2.315843e-03 3 1  ON 64
ci_066                -2.094318e-03 3 1  ON 65
ci_067                -1.774218e-03 3 1  ON 66
ci_068                -2.331840e-03 3 1  ON 67
ci_069                -2.649799e-04 3 1  ON 68
ci_070                -1.158040e-03 3 1  ON 69
ci_071                -1.630234e-03 3 1  ON 70
ci_072                -2.667822e-03 3 1  ON 71
ci_073                 6.274104e-04 3 1  ON 72
ci_074                 4.154124e-04 3 1  ON 73
ci_075                -9.705945e-04 3 1  ON 74
ci_076                -4.652701e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 2.9893e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s017 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s017 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=17  my_counter=0
  time step      = 5.0000e-02
  blocks         = 250
  steps          = 250
  substeps       = 10
  current        = 0
  target samples = 8.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">250</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">6.2500e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">8.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">6.2500e+04</parameter>
<parameter name="steps" condition="int">250</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2670e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="250">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =8000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 17
    time step          = 0.05
    reference energy   = -22.7418
    reference variance = 0.469518
====================================================
  Execution time = 1.0404e+02
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s017
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 62500 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 6.1103e+04
  VMC Eavg = -2.2670e+01
  VMC Evar = 5.0729e-01
  Total weights = 7.820049551e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.8826e+01
  </log>
</opt>
<opt stage="main" walkers="62500">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.494322511270
                                         uncertainty =       0.001300962493

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.494322511270
                                         uncertainty =       0.001300962493

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000248576643
  error estimate for blocks of size 2^( 2) =       0.000257600633
  error estimate for blocks of size 2^( 3) =       0.000265597923
  error estimate for blocks of size 2^( 4) =       0.000271295929
  error estimate for blocks of size 2^( 5) =       0.000274427731
  error estimate for blocks of size 2^( 6) =       0.000275894710
  error estimate for blocks of size 2^( 7) =       0.000277240738
  error estimate for blocks of size 2^( 8) =       0.000278020053
  error estimate for blocks of size 2^( 9) =       0.000278049487

      target function =                  N/A
              le_mean =     -22.669691493084
             les_mean =     514.422200471514
             stat err =       0.000277301247
             autocorr =       1.244465916282
              std dev =       0.703080921014
             le_variance =       0.494322781494


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266969149308e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.8147e-02, overlap shift 3.8147e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.669691493112       residual = 8.69e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.669713849772       residual = 5.77e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.669716734556       residual = 1.06e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.669716651512       residual = 1.77e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.669716736987       residual = 2.20e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.669716847169       residual = 5.81e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          5 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 3.8147e-02 is 2.613837e-03

solving harmonic davidson linear method for identity shift 1.5259e-01, overlap shift 1.5259e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.669691493112       residual = 8.69e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.669705315681       residual = 3.12e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.669706322949       residual = 2.22e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.669706278394       residual = 1.02e-08           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.669706263669       residual = 3.17e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          4 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 1.5259e-01 is 1.173908e-03

solving harmonic davidson linear method for identity shift 6.1035e-01, overlap shift 6.1035e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.669691493112       residual = 8.69e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.669696963266       residual = 2.13e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.669697205135       residual = 7.82e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.669697193942       residual = 1.32e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 6.1035e-01 is 4.483695e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.033373 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.2288e+02
  </log>
  <optVariables href="FORM.s017.opt.xml">
ci_001                -7.049915e-01 3 1  ON 0
ci_002                -7.059150e-01 3 1  ON 1
ci_003                -3.944331e-02 3 1  ON 2
ci_004                -3.921957e-02 3 1  ON 3
ci_005                 1.609445e-02 3 1  ON 4
ci_006                 1.610412e-02 3 1  ON 5
ci_007                 1.234725e-02 3 1  ON 6
ci_008                 1.237324e-02 3 1  ON 7
ci_009                -1.177602e-02 3 1  ON 8
ci_010                -1.190587e-02 3 1  ON 9
ci_011                -8.000670e-03 3 1  ON 10
ci_012                -9.285743e-03 3 1  ON 11
ci_013                 9.594651e-03 3 1  ON 12
ci_014                 9.412146e-03 3 1  ON 13
ci_015                 1.274648e-02 3 1  ON 14
ci_016                 1.285013e-02 3 1  ON 15
ci_017                 1.158437e-02 3 1  ON 16
ci_018                 1.074657e-02 3 1  ON 17
ci_019                -2.151699e-03 3 1  ON 18
ci_020                -2.625497e-03 3 1  ON 19
ci_021                -7.594034e-03 3 1  ON 20
ci_022                -7.542562e-03 3 1  ON 21
ci_023                 7.904126e-03 3 1  ON 22
ci_024                 7.494147e-03 3 1  ON 23
ci_025                 3.509095e-03 3 1  ON 24
ci_026                 4.293061e-03 3 1  ON 25
ci_027                 6.503152e-03 3 1  ON 26
ci_028                 6.773802e-03 3 1  ON 27
ci_029                -5.266377e-03 3 1  ON 28
ci_030                -4.319535e-03 3 1  ON 29
ci_031                -8.185504e-03 3 1  ON 30
ci_032                -7.828902e-03 3 1  ON 31
ci_033                 4.081100e-03 3 1  ON 32
ci_034                 4.526678e-03 3 1  ON 33
ci_035                 1.351442e-03 3 1  ON 34
ci_036                 6.719126e-04 3 1  ON 35
ci_037                 5.710994e-03 3 1  ON 36
ci_038                 5.228961e-03 3 1  ON 37
ci_039                 5.083463e-03 3 1  ON 38
ci_040                 5.210005e-03 3 1  ON 39
ci_041                 5.186358e-03 3 1  ON 40
ci_042                 5.485182e-03 3 1  ON 41
ci_043                 5.032288e-03 3 1  ON 42
ci_044                 5.429271e-03 3 1  ON 43
ci_045                 3.193656e-03 3 1  ON 44
ci_046                 3.373888e-03 3 1  ON 45
ci_047                -6.363201e-04 3 1  ON 46
ci_048                -7.308019e-04 3 1  ON 47
ci_049                 1.965853e-03 3 1  ON 48
ci_050                 1.243235e-03 3 1  ON 49
ci_051                -1.211486e-03 3 1  ON 50
ci_052                -1.431134e-03 3 1  ON 51
ci_053                -2.929640e-03 3 1  ON 52
ci_054                -1.541040e-03 3 1  ON 53
ci_055                -1.467757e-03 3 1  ON 54
ci_056                -1.716633e-03 3 1  ON 55
ci_057                -1.623795e-03 3 1  ON 56
ci_058                -1.315172e-03 3 1  ON 57
ci_059                 6.709357e-05 3 1  ON 58
ci_060                 1.841410e-04 3 1  ON 59
ci_061                 2.280452e-04 3 1  ON 60
ci_062                -1.832160e-04 3 1  ON 61
ci_063                -5.068299e-05 3 1  ON 62
ci_064                -9.660376e-04 3 1  ON 63
ci_065                -2.228044e-03 3 1  ON 64
ci_066                -2.092915e-03 3 1  ON 65
ci_067                -1.843687e-03 3 1  ON 66
ci_068                -2.573600e-03 3 1  ON 67
ci_069                -1.654835e-04 3 1  ON 68
ci_070                -1.190796e-03 3 1  ON 69
ci_071                -2.148714e-03 3 1  ON 70
ci_072                -2.017942e-03 3 1  ON 71
ci_073                 2.986139e-04 3 1  ON 72
ci_074                 3.366513e-04 3 1  ON 73
ci_075                -6.491538e-04 3 1  ON 74
ci_076                -9.354647e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="250">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =8000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 17
    time step          = 0.05
    reference energy   = -22.7495
    reference variance = 0.473215
====================================================
  Execution time = 1.0192e+02
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s017
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 62500 
  VMC Eavg = -2.2669e+01
  VMC Evar = 5.0662e-01
  Total weights = 7.8203e+06
  Execution time = 1.4637e+01
  </log>
</opt>
<opt stage="main" walkers="62500">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.494732588873
                                         uncertainty =       0.001347490423

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.494732588873
                                         uncertainty =       0.001347490423

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000248680133
  error estimate for blocks of size 2^( 2) =       0.000257720741
  error estimate for blocks of size 2^( 3) =       0.000265685319
  error estimate for blocks of size 2^( 4) =       0.000271274856
  error estimate for blocks of size 2^( 5) =       0.000274552987
  error estimate for blocks of size 2^( 6) =       0.000276312497
  error estimate for blocks of size 2^( 7) =       0.000277153932
  error estimate for blocks of size 2^( 8) =       0.000278623922
  error estimate for blocks of size 2^( 9) =       0.000279687161

      target function =                  N/A
              le_mean =     -22.669475373599
             les_mean =     514.470017165339
             stat err =       0.000277944378
             autocorr =       1.249204687429
              std dev =       0.703373634125
             le_variance =       0.494734469182

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.494512097954
                                         uncertainty =       0.001350441209

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.494512097954
                                         uncertainty =       0.001350441209

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000248624681
  error estimate for blocks of size 2^( 2) =       0.000257665732
  error estimate for blocks of size 2^( 3) =       0.000265626873
  error estimate for blocks of size 2^( 4) =       0.000271213534
  error estimate for blocks of size 2^( 5) =       0.000274489346
  error estimate for blocks of size 2^( 6) =       0.000276253312
  error estimate for blocks of size 2^( 7) =       0.000277095715
  error estimate for blocks of size 2^( 8) =       0.000278580094
  error estimate for blocks of size 2^( 9) =       0.000279645605

      target function =                  N/A
              le_mean =     -22.669466129221
             les_mean =     514.417055112533
             stat err =       0.000277893681
             autocorr =       1.249306120976
              std dev =       0.703216790669
             le_variance =       0.494513854679

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.502618512823
                                         uncertainty =       0.008041552114

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.502618512823
                                         uncertainty =       0.008041552114

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000250654651
  error estimate for blocks of size 2^( 2) =       0.000259614533
  error estimate for blocks of size 2^( 3) =       0.000267508879
  error estimate for blocks of size 2^( 4) =       0.000273071495
  error estimate for blocks of size 2^( 5) =       0.000276300040
  error estimate for blocks of size 2^( 6) =       0.000277893218
  error estimate for blocks of size 2^( 7) =       0.000278720137
  error estimate for blocks of size 2^( 8) =       0.000280328702
  error estimate for blocks of size 2^( 9) =       0.000281260207

      target function =                  N/A
              le_mean =     -22.669443348954
             les_mean =     528.982696704630
             stat err =       0.000279550566
             autocorr =       1.243853458029
              std dev =       0.708958412750
             le_variance =       0.502622031009

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.494548147109
                                         uncertainty =       0.001349416579

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.494548147109
                                         uncertainty =       0.001349416579

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000248633759
  error estimate for blocks of size 2^( 2) =       0.000257675722
  error estimate for blocks of size 2^( 3) =       0.000265640790
  error estimate for blocks of size 2^( 4) =       0.000271230939
  error estimate for blocks of size 2^( 5) =       0.000274511067
  error estimate for blocks of size 2^( 6) =       0.000276270518
  error estimate for blocks of size 2^( 7) =       0.000277110480
  error estimate for blocks of size 2^( 8) =       0.000278588770
  error estimate for blocks of size 2^( 9) =       0.000279632332

      target function =                  N/A
              le_mean =     -22.669465716778
             les_mean =     514.415206558564
             stat err =       0.000277900525
             autocorr =       1.249276419525
              std dev =       0.703242467657
             le_variance =       0.494549968316


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.669475373599        initial  <--
     3.8147e-02     3.8147e-01             2.6138e-03       -22.669466129221
     1.5259e-01     1.5259e+00             1.1739e-03       -22.669443348954
     6.1035e-01     6.1035e+00             4.4837e-04       -22.669465716778

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 175.1055
  </log>
  <optVariables href="FORM.s017.opt.xml">
ci_001                -7.048485e-01 3 1  ON 0
ci_002                -7.059393e-01 3 1  ON 1
ci_003                -3.937056e-02 3 1  ON 2
ci_004                -4.032079e-02 3 1  ON 3
ci_005                 1.605500e-02 3 1  ON 4
ci_006                 1.626617e-02 3 1  ON 5
ci_007                 1.225477e-02 3 1  ON 6
ci_008                 1.263167e-02 3 1  ON 7
ci_009                -1.179911e-02 3 1  ON 8
ci_010                -1.124619e-02 3 1  ON 9
ci_011                -8.521456e-03 3 1  ON 10
ci_012                -1.045965e-02 3 1  ON 11
ci_013                 1.048232e-02 3 1  ON 12
ci_014                 9.551123e-03 3 1  ON 13
ci_015                 1.286516e-02 3 1  ON 14
ci_016                 1.363119e-02 3 1  ON 15
ci_017                 1.186436e-02 3 1  ON 16
ci_018                 1.085978e-02 3 1  ON 17
ci_019                -2.488966e-03 3 1  ON 18
ci_020                -2.533603e-03 3 1  ON 19
ci_021                -7.865647e-03 3 1  ON 20
ci_022                -7.238792e-03 3 1  ON 21
ci_023                 8.000854e-03 3 1  ON 22
ci_024                 7.629138e-03 3 1  ON 23
ci_025                 4.015965e-03 3 1  ON 24
ci_026                 3.934081e-03 3 1  ON 25
ci_027                 5.997530e-03 3 1  ON 26
ci_028                 6.610176e-03 3 1  ON 27
ci_029                -5.475193e-03 3 1  ON 28
ci_030                -4.623406e-03 3 1  ON 29
ci_031                -8.161280e-03 3 1  ON 30
ci_032                -7.795313e-03 3 1  ON 31
ci_033                 4.033518e-03 3 1  ON 32
ci_034                 4.491835e-03 3 1  ON 33
ci_035                 1.322522e-03 3 1  ON 34
ci_036                 8.405670e-04 3 1  ON 35
ci_037                 5.711991e-03 3 1  ON 36
ci_038                 5.758674e-03 3 1  ON 37
ci_039                 4.961884e-03 3 1  ON 38
ci_040                 4.914638e-03 3 1  ON 39
ci_041                 5.159143e-03 3 1  ON 40
ci_042                 5.151273e-03 3 1  ON 41
ci_043                 4.681025e-03 3 1  ON 42
ci_044                 5.533447e-03 3 1  ON 43
ci_045                 2.409696e-03 3 1  ON 44
ci_046                 3.518632e-03 3 1  ON 45
ci_047                -6.154448e-04 3 1  ON 46
ci_048                -7.295618e-04 3 1  ON 47
ci_049                 2.491268e-03 3 1  ON 48
ci_050                 1.250734e-03 3 1  ON 49
ci_051                -1.028749e-03 3 1  ON 50
ci_052                -8.744065e-04 3 1  ON 51
ci_053                -3.464095e-03 3 1  ON 52
ci_054                -1.180923e-03 3 1  ON 53
ci_055                -1.166130e-03 3 1  ON 54
ci_056                -1.991469e-03 3 1  ON 55
ci_057                -1.699768e-03 3 1  ON 56
ci_058                -1.311662e-03 3 1  ON 57
ci_059                 3.888628e-05 3 1  ON 58
ci_060                 8.978753e-05 3 1  ON 59
ci_061                -4.414498e-05 3 1  ON 60
ci_062                -1.451561e-04 3 1  ON 61
ci_063                -1.514068e-04 3 1  ON 62
ci_064                -1.380474e-03 3 1  ON 63
ci_065                -2.315843e-03 3 1  ON 64
ci_066                -2.094318e-03 3 1  ON 65
ci_067                -1.774218e-03 3 1  ON 66
ci_068                -2.331840e-03 3 1  ON 67
ci_069                -2.649799e-04 3 1  ON 68
ci_070                -1.158040e-03 3 1  ON 69
ci_071                -1.630234e-03 3 1  ON 70
ci_072                -2.667822e-03 3 1  ON 71
ci_073                 6.274104e-04 3 1  ON 72
ci_074                 4.154124e-04 3 1  ON 73
ci_075                -9.705945e-04 3 1  ON 74
ci_076                -4.652701e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 2.9799e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s018 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s018 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=18  my_counter=0
  time step      = 5.0000e-02
  blocks         = 250
  steps          = 250
  substeps       = 10
  current        = 0
  target samples = 8.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">250</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">6.2500e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">8.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">6.2500e+04</parameter>
<parameter name="steps" condition="int">250</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2674e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="250">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =8000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 18
    time step          = 0.05
    reference energy   = -22.6816
    reference variance = 0.323252
====================================================
  Execution time = 1.0413e+02
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s018
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 62500 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 6.1086e+04
  VMC Eavg = -2.2669e+01
  VMC Evar = 5.0868e-01
  Total weights = 7.820648311e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.8815e+01
  </log>
</opt>
<opt stage="main" walkers="62500">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.494602124025
                                         uncertainty =       0.001430306852

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.494602124025
                                         uncertainty =       0.001430306852

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000248646954
  error estimate for blocks of size 2^( 2) =       0.000257714845
  error estimate for blocks of size 2^( 3) =       0.000265728987
  error estimate for blocks of size 2^( 4) =       0.000271505783
  error estimate for blocks of size 2^( 5) =       0.000275050140
  error estimate for blocks of size 2^( 6) =       0.000277287384
  error estimate for blocks of size 2^( 7) =       0.000277580195
  error estimate for blocks of size 2^( 8) =       0.000279217671
  error estimate for blocks of size 2^( 9) =       0.000280004528

      target function =                  N/A
              le_mean =     -22.669486113078
             les_mean =     514.414276824922
             stat err =       0.000278522445
             autocorr =       1.254741058761
              std dev =       0.703279789375
             le_variance =       0.494602462143


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266948611308e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.8147e-01, overlap shift 3.8147e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.669486113101       residual = 5.97e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.669490948438       residual = 8.51e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.669491018096       residual = 3.38e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.669491011507       residual = 6.75e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 3.8147e-01 is 5.778182e-04

solving harmonic davidson linear method for identity shift 1.5259e+00, overlap shift 1.5259e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.669486113101       residual = 5.97e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.669487669978       residual = 7.08e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.669487667563       residual = 1.31e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.669487663739       residual = 1.85e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 1.5259e+00 is 1.846278e-04

solving harmonic davidson linear method for identity shift 6.1035e+00, overlap shift 6.1035e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.669486113101       residual = 5.97e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.669486532509       residual = 7.62e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.669486530075       residual = 1.13e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.669486529245       residual = 1.61e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 6.1035e+00 is 4.961663e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.034733 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.2296e+02
  </log>
  <optVariables href="FORM.s018.opt.xml">
ci_001                -7.048648e-01 3 1  ON 0
ci_002                -7.059306e-01 3 1  ON 1
ci_003                -3.937729e-02 3 1  ON 2
ci_004                -4.029284e-02 3 1  ON 3
ci_005                 1.598950e-02 3 1  ON 4
ci_006                 1.625799e-02 3 1  ON 5
ci_007                 1.227216e-02 3 1  ON 6
ci_008                 1.260388e-02 3 1  ON 7
ci_009                -1.186210e-02 3 1  ON 8
ci_010                -1.129580e-02 3 1  ON 9
ci_011                -8.478014e-03 3 1  ON 10
ci_012                -1.029757e-02 3 1  ON 11
ci_013                 1.045459e-02 3 1  ON 12
ci_014                 9.572350e-03 3 1  ON 13
ci_015                 1.283383e-02 3 1  ON 14
ci_016                 1.362343e-02 3 1  ON 15
ci_017                 1.171699e-02 3 1  ON 16
ci_018                 1.091191e-02 3 1  ON 17
ci_019                -2.498054e-03 3 1  ON 18
ci_020                -2.534275e-03 3 1  ON 19
ci_021                -7.906137e-03 3 1  ON 20
ci_022                -7.294793e-03 3 1  ON 21
ci_023                 7.934054e-03 3 1  ON 22
ci_024                 7.610293e-03 3 1  ON 23
ci_025                 4.006428e-03 3 1  ON 24
ci_026                 3.945975e-03 3 1  ON 25
ci_027                 5.964757e-03 3 1  ON 26
ci_028                 6.704845e-03 3 1  ON 27
ci_029                -5.417579e-03 3 1  ON 28
ci_030                -4.678791e-03 3 1  ON 29
ci_031                -8.228257e-03 3 1  ON 30
ci_032                -7.826831e-03 3 1  ON 31
ci_033                 4.028657e-03 3 1  ON 32
ci_034                 4.436605e-03 3 1  ON 33
ci_035                 1.360074e-03 3 1  ON 34
ci_036                 8.766534e-04 3 1  ON 35
ci_037                 5.638700e-03 3 1  ON 36
ci_038                 5.574047e-03 3 1  ON 37
ci_039                 4.953430e-03 3 1  ON 38
ci_040                 5.050176e-03 3 1  ON 39
ci_041                 5.115869e-03 3 1  ON 40
ci_042                 5.129836e-03 3 1  ON 41
ci_043                 4.656905e-03 3 1  ON 42
ci_044                 5.532458e-03 3 1  ON 43
ci_045                 2.470876e-03 3 1  ON 44
ci_046                 3.598831e-03 3 1  ON 45
ci_047                -5.841125e-04 3 1  ON 46
ci_048                -6.971547e-04 3 1  ON 47
ci_049                 2.405645e-03 3 1  ON 48
ci_050                 1.258943e-03 3 1  ON 49
ci_051                -9.950363e-04 3 1  ON 50
ci_052                -8.560710e-04 3 1  ON 51
ci_053                -3.357219e-03 3 1  ON 52
ci_054                -1.251911e-03 3 1  ON 53
ci_055                -1.201880e-03 3 1  ON 54
ci_056                -1.990577e-03 3 1  ON 55
ci_057                -1.681725e-03 3 1  ON 56
ci_058                -1.367213e-03 3 1  ON 57
ci_059                 7.537122e-05 3 1  ON 58
ci_060                 1.202536e-04 3 1  ON 59
ci_061                -7.846006e-06 3 1  ON 60
ci_062                -1.612331e-04 3 1  ON 61
ci_063                -1.738355e-04 3 1  ON 62
ci_064                -1.296437e-03 3 1  ON 63
ci_065                -2.281332e-03 3 1  ON 64
ci_066                -2.165208e-03 3 1  ON 65
ci_067                -1.801867e-03 3 1  ON 66
ci_068                -2.339839e-03 3 1  ON 67
ci_069                -2.964550e-04 3 1  ON 68
ci_070                -1.067900e-03 3 1  ON 69
ci_071                -1.593548e-03 3 1  ON 70
ci_072                -2.645155e-03 3 1  ON 71
ci_073                 5.808286e-04 3 1  ON 72
ci_074                 4.083658e-04 3 1  ON 73
ci_075                -9.107628e-04 3 1  ON 74
ci_076                -4.294420e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="250">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =8000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 18
    time step          = 0.05
    reference energy   = -22.7335
    reference variance = 0.974006
====================================================
  Execution time = 1.0215e+02
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s018
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 62500 
  VMC Eavg = -2.2669e+01
  VMC Evar = 5.0835e-01
  Total weights = 7.8204e+06
  Execution time = 1.4677e+01
  </log>
</opt>
<opt stage="main" walkers="62500">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.496131429651
                                         uncertainty =       0.001678957361

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.496131429651
                                         uncertainty =       0.001678957361

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000249031575
  error estimate for blocks of size 2^( 2) =       0.000257874894
  error estimate for blocks of size 2^( 3) =       0.000266117083
  error estimate for blocks of size 2^( 4) =       0.000271673987
  error estimate for blocks of size 2^( 5) =       0.000275043870
  error estimate for blocks of size 2^( 6) =       0.000276930873
  error estimate for blocks of size 2^( 7) =       0.000277688818
  error estimate for blocks of size 2^( 8) =       0.000278957909
  error estimate for blocks of size 2^( 9) =       0.000279473169

      target function =                  N/A
              le_mean =     -22.669412070107
             les_mean =     514.411061553185
             stat err =       0.000278262692
             autocorr =       1.248536188698
              std dev =       0.704367661943
             le_variance =       0.496133803192

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.496365148094
                                         uncertainty =       0.001699272605

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.496365148094
                                         uncertainty =       0.001699272605

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000249090175
  error estimate for blocks of size 2^( 2) =       0.000257928606
  error estimate for blocks of size 2^( 3) =       0.000266166560
  error estimate for blocks of size 2^( 4) =       0.000271716848
  error estimate for blocks of size 2^( 5) =       0.000275082770
  error estimate for blocks of size 2^( 6) =       0.000276964765
  error estimate for blocks of size 2^( 7) =       0.000277723152
  error estimate for blocks of size 2^( 8) =       0.000278979921
  error estimate for blocks of size 2^( 9) =       0.000279482582

      target function =                  N/A
              le_mean =     -22.669419729926
             les_mean =     515.545430862337
             stat err =       0.000278287605
             autocorr =       1.248172277118
              std dev =       0.704533406423
             le_variance =       0.496367320766

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.496152744335
                                         uncertainty =       0.001685047660

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.496152744335
                                         uncertainty =       0.001685047660

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000249036922
  error estimate for blocks of size 2^( 2) =       0.000257879018
  error estimate for blocks of size 2^( 3) =       0.000266119798
  error estimate for blocks of size 2^( 4) =       0.000271674951
  error estimate for blocks of size 2^( 5) =       0.000275046329
  error estimate for blocks of size 2^( 6) =       0.000276932915
  error estimate for blocks of size 2^( 7) =       0.000277688532
  error estimate for blocks of size 2^( 8) =       0.000278958692
  error estimate for blocks of size 2^( 9) =       0.000279476035

      target function =                  N/A
              le_mean =     -22.669413204981
             les_mean =     514.411736628982
             stat err =       0.000278264044
             autocorr =       1.248494707628
              std dev =       0.704382784093
             le_variance =       0.496155106526

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.496131817580
                                         uncertainty =       0.001679638218

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.496131817580
                                         uncertainty =       0.001679638218

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000249031672
  error estimate for blocks of size 2^( 2) =       0.000257874882
  error estimate for blocks of size 2^( 3) =       0.000266116936
  error estimate for blocks of size 2^( 4) =       0.000271673701
  error estimate for blocks of size 2^( 5) =       0.000275043752
  error estimate for blocks of size 2^( 6) =       0.000276930681
  error estimate for blocks of size 2^( 7) =       0.000277688742
  error estimate for blocks of size 2^( 8) =       0.000278958079
  error estimate for blocks of size 2^( 9) =       0.000279473759

      target function =                  N/A
              le_mean =     -22.669412131491
             les_mean =     514.453791006358
             stat err =       0.000278262815
             autocorr =       1.248536318481
              std dev =       0.704367936505
             le_variance =       0.496134189977


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.669412070107        initial
     3.8147e-01     3.8147e+00             5.7782e-04       -22.669419729926  <--
     1.5259e+00     1.5259e+01             1.8463e-04       -22.669413204981
     6.1035e+00     6.1035e+01             4.9617e-05       -22.669412131491

*****************************************************************************
Applying the update for shift_i =   3.8147e-01     and shift_s =   3.8147e+00
*****************************************************************************

  Execution time = 1.7549e+02
  </log>
  <optVariables href="FORM.s018.opt.xml">
ci_001                -7.049067e-01 3 1  ON 0
ci_002                -7.059058e-01 3 1  ON 1
ci_003                -3.939705e-02 3 1  ON 2
ci_004                -4.022253e-02 3 1  ON 3
ci_005                 1.586956e-02 3 1  ON 4
ci_006                 1.624052e-02 3 1  ON 5
ci_007                 1.230199e-02 3 1  ON 6
ci_008                 1.253922e-02 3 1  ON 7
ci_009                -1.198886e-02 3 1  ON 8
ci_010                -1.141205e-02 3 1  ON 9
ci_011                -8.387877e-03 3 1  ON 10
ci_012                -9.932296e-03 3 1  ON 11
ci_013                 1.038813e-02 3 1  ON 12
ci_014                 9.618614e-03 3 1  ON 13
ci_015                 1.275345e-02 3 1  ON 14
ci_016                 1.361845e-02 3 1  ON 15
ci_017                 1.138519e-02 3 1  ON 16
ci_018                 1.103166e-02 3 1  ON 17
ci_019                -2.517381e-03 3 1  ON 18
ci_020                -2.531001e-03 3 1  ON 19
ci_021                -7.992503e-03 3 1  ON 20
ci_022                -7.422691e-03 3 1  ON 21
ci_023                 7.803627e-03 3 1  ON 22
ci_024                 7.569576e-03 3 1  ON 23
ci_025                 3.989192e-03 3 1  ON 24
ci_026                 3.974586e-03 3 1  ON 25
ci_027                 5.908702e-03 3 1  ON 26
ci_028                 6.868947e-03 3 1  ON 27
ci_029                -5.301920e-03 3 1  ON 28
ci_030                -4.797195e-03 3 1  ON 29
ci_031                -8.377605e-03 3 1  ON 30
ci_032                -7.891226e-03 3 1  ON 31
ci_033                 4.012624e-03 3 1  ON 32
ci_034                 4.311480e-03 3 1  ON 33
ci_035                 1.426306e-03 3 1  ON 34
ci_036                 9.383680e-04 3 1  ON 35
ci_037                 5.480934e-03 3 1  ON 36
ci_038                 5.180856e-03 3 1  ON 37
ci_039                 4.940205e-03 3 1  ON 38
ci_040                 5.290644e-03 3 1  ON 39
ci_041                 5.033315e-03 3 1  ON 40
ci_042                 5.084335e-03 3 1  ON 41
ci_043                 4.595449e-03 3 1  ON 42
ci_044                 5.516430e-03 3 1  ON 43
ci_045                 2.605388e-03 3 1  ON 44
ci_046                 3.774827e-03 3 1  ON 45
ci_047                -5.287558e-04 3 1  ON 46
ci_048                -6.404832e-04 3 1  ON 47
ci_049                 2.223021e-03 3 1  ON 48
ci_050                 1.278571e-03 3 1  ON 49
ci_051                -9.291732e-04 3 1  ON 50
ci_052                -8.192584e-04 3 1  ON 51
ci_053                -3.123761e-03 3 1  ON 52
ci_054                -1.422248e-03 3 1  ON 53
ci_055                -1.280842e-03 3 1  ON 54
ci_056                -1.993009e-03 3 1  ON 55
ci_057                -1.644790e-03 3 1  ON 56
ci_058                -1.479770e-03 3 1  ON 57
ci_059                 1.439173e-04 3 1  ON 58
ci_060                 1.767491e-04 3 1  ON 59
ci_061                 6.634243e-05 3 1  ON 60
ci_062                -1.948923e-04 3 1  ON 61
ci_063                -2.244885e-04 3 1  ON 62
ci_064                -1.109147e-03 3 1  ON 63
ci_065                -2.216845e-03 3 1  ON 64
ci_066                -2.316341e-03 3 1  ON 65
ci_067                -1.855780e-03 3 1  ON 66
ci_068                -2.359455e-03 3 1  ON 67
ci_069                -3.672932e-04 3 1  ON 68
ci_070                -8.778760e-04 3 1  ON 69
ci_071                -1.522056e-03 3 1  ON 70
ci_072                -2.595299e-03 3 1  ON 71
ci_073                 4.962894e-04 3 1  ON 72
ci_074                 3.949405e-04 3 1  ON 73
ci_075                -7.867269e-04 3 1  ON 74
ci_076                -3.587205e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 2.9847e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s019 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s019 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=19  my_counter=0
  time step      = 5.0000e-02
  blocks         = 250
  steps          = 250
  substeps       = 10
  current        = 0
  target samples = 8.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">250</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">6.2500e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">8.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">6.2500e+04</parameter>
<parameter name="steps" condition="int">250</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2676e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="250">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =8000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 19
    time step          = 0.05
    reference energy   = -22.6841
    reference variance = 0.46678
====================================================
  Execution time = 1.0423e+02
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s019
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 62500 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 6.1124e+04
  VMC Eavg = -2.2669e+01
  VMC Evar = 5.1377e-01
  Total weights = 7.820597781e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.8818e+01
  </log>
</opt>
<opt stage="main" walkers="62500">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.498158037928
                                         uncertainty =       0.001764902981

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.498158037928
                                         uncertainty =       0.001764902981

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000249539270
  error estimate for blocks of size 2^( 2) =       0.000258516782
  error estimate for blocks of size 2^( 3) =       0.000266628458
  error estimate for blocks of size 2^( 4) =       0.000272349763
  error estimate for blocks of size 2^( 5) =       0.000275427447
  error estimate for blocks of size 2^( 6) =       0.000277056585
  error estimate for blocks of size 2^( 7) =       0.000277276638
  error estimate for blocks of size 2^( 8) =       0.000278234156
  error estimate for blocks of size 2^( 9) =       0.000278834012

      target function =                  N/A
              le_mean =     -22.669440043700
             les_mean =     514.417285815707
             stat err =       0.000277850348
             autocorr =       1.239778467708
              std dev =       0.705803640563
             le_variance =       0.498158779032


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266944004370e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.5367e-02, overlap shift 9.5367e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.669440043720       residual = 4.60e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.669452423271       residual = 2.07e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.669453097824       residual = 2.32e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.669453426701       residual = 3.27e-08           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.669453340145       residual = 3.87e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          4 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 9.5367e-02 is 9.625628e-04

solving harmonic davidson linear method for identity shift 3.8147e-01, overlap shift 3.8147e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.669440043720       residual = 4.60e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.669446018494       residual = 6.27e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.669446006029       residual = 1.67e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.669446048781       residual = 5.84e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 3.8147e-01 is 4.667146e-04

solving harmonic davidson linear method for identity shift 1.5259e+00, overlap shift 1.5259e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.669440043720       residual = 4.60e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.669441990235       residual = 5.73e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.669441962145       residual = 1.17e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.669441967510       residual = 3.81e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 1.5259e+00 is 1.694800e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.039375 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.2307e+02
  </log>
  <optVariables href="FORM.s019.opt.xml">
ci_001                -7.050900e-01 3 1  ON 0
ci_002                -7.057647e-01 3 1  ON 1
ci_003                -3.930332e-02 3 1  ON 2
ci_004                -3.990321e-02 3 1  ON 3
ci_005                 1.589453e-02 3 1  ON 4
ci_006                 1.615920e-02 3 1  ON 5
ci_007                 1.221704e-02 3 1  ON 6
ci_008                 1.248737e-02 3 1  ON 7
ci_009                -1.174063e-02 3 1  ON 8
ci_010                -1.144884e-02 3 1  ON 9
ci_011                -8.248426e-03 3 1  ON 10
ci_012                -9.706297e-03 3 1  ON 11
ci_013                 1.006247e-02 3 1  ON 12
ci_014                 9.418618e-03 3 1  ON 13
ci_015                 1.277705e-02 3 1  ON 14
ci_016                 1.345113e-02 3 1  ON 15
ci_017                 1.138362e-02 3 1  ON 16
ci_018                 1.091848e-02 3 1  ON 17
ci_019                -2.585258e-03 3 1  ON 18
ci_020                -2.717493e-03 3 1  ON 19
ci_021                -8.016470e-03 3 1  ON 20
ci_022                -7.557684e-03 3 1  ON 21
ci_023                 7.924027e-03 3 1  ON 22
ci_024                 7.773056e-03 3 1  ON 23
ci_025                 3.989449e-03 3 1  ON 24
ci_026                 4.182740e-03 3 1  ON 25
ci_027                 6.375416e-03 3 1  ON 26
ci_028                 6.596277e-03 3 1  ON 27
ci_029                -5.334899e-03 3 1  ON 28
ci_030                -4.854265e-03 3 1  ON 29
ci_031                -8.111815e-03 3 1  ON 30
ci_032                -7.870138e-03 3 1  ON 31
ci_033                 4.152219e-03 3 1  ON 32
ci_034                 4.224373e-03 3 1  ON 33
ci_035                 1.483388e-03 3 1  ON 34
ci_036                 9.629989e-04 3 1  ON 35
ci_037                 5.460217e-03 3 1  ON 36
ci_038                 5.290502e-03 3 1  ON 37
ci_039                 5.032236e-03 3 1  ON 38
ci_040                 5.032342e-03 3 1  ON 39
ci_041                 5.061579e-03 3 1  ON 40
ci_042                 5.054796e-03 3 1  ON 41
ci_043                 4.562773e-03 3 1  ON 42
ci_044                 5.454433e-03 3 1  ON 43
ci_045                 2.756304e-03 3 1  ON 44
ci_046                 3.568825e-03 3 1  ON 45
ci_047                -5.108446e-04 3 1  ON 46
ci_048                -6.243806e-04 3 1  ON 47
ci_049                 2.360827e-03 3 1  ON 48
ci_050                 1.384352e-03 3 1  ON 49
ci_051                -1.170520e-03 3 1  ON 50
ci_052                -1.156350e-03 3 1  ON 51
ci_053                -3.042163e-03 3 1  ON 52
ci_054                -1.564134e-03 3 1  ON 53
ci_055                -1.234739e-03 3 1  ON 54
ci_056                -2.011258e-03 3 1  ON 55
ci_057                -1.621878e-03 3 1  ON 56
ci_058                -1.399092e-03 3 1  ON 57
ci_059                 1.420273e-04 3 1  ON 58
ci_060                 3.057983e-04 3 1  ON 59
ci_061                 2.861136e-04 3 1  ON 60
ci_062                -2.794111e-04 3 1  ON 61
ci_063                -3.939775e-04 3 1  ON 62
ci_064                -1.014659e-03 3 1  ON 63
ci_065                -2.132416e-03 3 1  ON 64
ci_066                -2.427470e-03 3 1  ON 65
ci_067                -1.983514e-03 3 1  ON 66
ci_068                -2.465521e-03 3 1  ON 67
ci_069                -1.923633e-04 3 1  ON 68
ci_070                -6.447047e-04 3 1  ON 69
ci_071                -1.714850e-03 3 1  ON 70
ci_072                -2.591251e-03 3 1  ON 71
ci_073                 3.323629e-04 3 1  ON 72
ci_074                 3.272173e-04 3 1  ON 73
ci_075                -7.357100e-04 3 1  ON 74
ci_076                -2.348826e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="250">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =8000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 19
    time step          = 0.05
    reference energy   = -22.5992
    reference variance = 0.930603
====================================================
  Execution time = 1.0223e+02
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s019
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 62500 
  VMC Eavg = -2.2670e+01
  VMC Evar = 5.1292e-01
  Total weights = 7.8198e+06
  Execution time = 1.4606e+01
  </log>
</opt>
<opt stage="main" walkers="62500">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

ERROR CostFunction-> Number of Effective Walkers is too small! 
  Number of effective walkers (samples) / total number of samples = 0.0242252
  User specified threshold minwalkers = 0.3
  If this message appears frequently. You might have to be cautious. 
  Find info about parameter "minwalkers" in the user manual!
Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.500380249457
                                         uncertainty =       0.002189306391

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.500380249457
                                         uncertainty =       0.002189306391

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000250095392
  error estimate for blocks of size 2^( 2) =       0.000258996667
  error estimate for blocks of size 2^( 3) =       0.000266813784
  error estimate for blocks of size 2^( 4) =       0.000272233802
  error estimate for blocks of size 2^( 5) =       0.000275744470
  error estimate for blocks of size 2^( 6) =       0.000277941675
  error estimate for blocks of size 2^( 7) =       0.000278610817
  error estimate for blocks of size 2^( 8) =       0.000279066768
  error estimate for blocks of size 2^( 9) =       0.000278900181

      target function =                  N/A
              le_mean =     -22.670086067042
             les_mean =     514.449827492499
             stat err =       0.000278629860
             autocorr =       1.241206195380
              std dev =       0.707376590793
             le_variance =       0.500381641202

ERROR CostFunction-> Number of Effective Walkers is too small! 
  Number of effective walkers (samples) / total number of samples = 0.0140797
  User specified threshold minwalkers = 0.3
  If this message appears frequently. You might have to be cautious. 
  Find info about parameter "minwalkers" in the user manual!
Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.500292050386
                                         uncertainty =       0.002192179197

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.500292050386
                                         uncertainty =       0.002192179197

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000250073354
  error estimate for blocks of size 2^( 2) =       0.000258975630
  error estimate for blocks of size 2^( 3) =       0.000266793870
  error estimate for blocks of size 2^( 4) =       0.000272212501
  error estimate for blocks of size 2^( 5) =       0.000275721549
  error estimate for blocks of size 2^( 6) =       0.000277914839
  error estimate for blocks of size 2^( 7) =       0.000278587919
  error estimate for blocks of size 2^( 8) =       0.000279035229
  error estimate for blocks of size 2^( 9) =       0.000278867901

      target function =                  N/A
              le_mean =     -22.670085094045
             les_mean =     514.458462872136
             stat err =       0.000278601472
             autocorr =       1.241172014527
              std dev =       0.707314258227
             le_variance =       0.500293459891

ERROR CostFunction-> Number of Effective Walkers is too small! 
  Number of effective walkers (samples) / total number of samples = 0.0246404
  User specified threshold minwalkers = 0.3
  If this message appears frequently. You might have to be cautious. 
  Find info about parameter "minwalkers" in the user manual!
Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.500321569821
                                         uncertainty =       0.002195047576

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.500321569821
                                         uncertainty =       0.002195047576

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000250080735
  error estimate for blocks of size 2^( 2) =       0.000258983462
  error estimate for blocks of size 2^( 3) =       0.000266803248
  error estimate for blocks of size 2^( 4) =       0.000272222364
  error estimate for blocks of size 2^( 5) =       0.000275731625
  error estimate for blocks of size 2^( 6) =       0.000277929409
  error estimate for blocks of size 2^( 7) =       0.000278605026
  error estimate for blocks of size 2^( 8) =       0.000279049654
  error estimate for blocks of size 2^( 9) =       0.000278887318

      target function =                  N/A
              le_mean =     -22.670086123695
             les_mean =     514.448383036713
             stat err =       0.000278617852
             autocorr =       1.241244694854
              std dev =       0.707335133302
             le_variance =       0.500322990803

ERROR CostFunction-> Number of Effective Walkers is too small! 
  Number of effective walkers (samples) / total number of samples = 0.110298
  User specified threshold minwalkers = 0.3
  If this message appears frequently. You might have to be cautious. 
  Find info about parameter "minwalkers" in the user manual!
Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.500355543679
                                         uncertainty =       0.002190218737

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.500355543679
                                         uncertainty =       0.002190218737

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000250089219
  error estimate for blocks of size 2^( 2) =       0.000258990781
  error estimate for blocks of size 2^( 3) =       0.000266808314
  error estimate for blocks of size 2^( 4) =       0.000272228785
  error estimate for blocks of size 2^( 5) =       0.000275739545
  error estimate for blocks of size 2^( 6) =       0.000277936613
  error estimate for blocks of size 2^( 7) =       0.000278609981
  error estimate for blocks of size 2^( 8) =       0.000279060633
  error estimate for blocks of size 2^( 9) =       0.000278900164

      target function =                  N/A
              le_mean =     -22.670085645632
             les_mean =     514.446385055007
             stat err =       0.000278626848
             autocorr =       1.241240626364
              std dev =       0.707359131032
             le_variance =       0.500356940255


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.670086067042        initial
     9.5367e-02     9.5367e-01             9.6256e-04       -22.670085094045
     3.8147e-01     3.8147e+00             4.6671e-04       -22.670086123695  <--
     1.5259e+00     1.5259e+01             1.6948e-04       -22.670085645632

*****************************************************************************
Applying the update for shift_i =   3.8147e-01     and shift_s =   3.8147e+00
*****************************************************************************

  Execution time = 1.7527e+02
  </log>
  <optVariables href="FORM.s019.opt.xml">
ci_001                -7.050900e-01 3 1  ON 0
ci_002                -7.057647e-01 3 1  ON 1
ci_003                -3.930332e-02 3 1  ON 2
ci_004                -3.990321e-02 3 1  ON 3
ci_005                 1.589453e-02 3 1  ON 4
ci_006                 1.615920e-02 3 1  ON 5
ci_007                 1.221704e-02 3 1  ON 6
ci_008                 1.248737e-02 3 1  ON 7
ci_009                -1.174063e-02 3 1  ON 8
ci_010                -1.144884e-02 3 1  ON 9
ci_011                -8.248426e-03 3 1  ON 10
ci_012                -9.706297e-03 3 1  ON 11
ci_013                 1.006247e-02 3 1  ON 12
ci_014                 9.418618e-03 3 1  ON 13
ci_015                 1.277705e-02 3 1  ON 14
ci_016                 1.345113e-02 3 1  ON 15
ci_017                 1.138362e-02 3 1  ON 16
ci_018                 1.091848e-02 3 1  ON 17
ci_019                -2.585258e-03 3 1  ON 18
ci_020                -2.717493e-03 3 1  ON 19
ci_021                -8.016470e-03 3 1  ON 20
ci_022                -7.557684e-03 3 1  ON 21
ci_023                 7.924027e-03 3 1  ON 22
ci_024                 7.773056e-03 3 1  ON 23
ci_025                 3.989449e-03 3 1  ON 24
ci_026                 4.182740e-03 3 1  ON 25
ci_027                 6.375416e-03 3 1  ON 26
ci_028                 6.596277e-03 3 1  ON 27
ci_029                -5.334899e-03 3 1  ON 28
ci_030                -4.854265e-03 3 1  ON 29
ci_031                -8.111815e-03 3 1  ON 30
ci_032                -7.870138e-03 3 1  ON 31
ci_033                 4.152219e-03 3 1  ON 32
ci_034                 4.224373e-03 3 1  ON 33
ci_035                 1.483388e-03 3 1  ON 34
ci_036                 9.629989e-04 3 1  ON 35
ci_037                 5.460217e-03 3 1  ON 36
ci_038                 5.290502e-03 3 1  ON 37
ci_039                 5.032236e-03 3 1  ON 38
ci_040                 5.032342e-03 3 1  ON 39
ci_041                 5.061579e-03 3 1  ON 40
ci_042                 5.054796e-03 3 1  ON 41
ci_043                 4.562773e-03 3 1  ON 42
ci_044                 5.454433e-03 3 1  ON 43
ci_045                 2.756304e-03 3 1  ON 44
ci_046                 3.568825e-03 3 1  ON 45
ci_047                -5.108446e-04 3 1  ON 46
ci_048                -6.243806e-04 3 1  ON 47
ci_049                 2.360827e-03 3 1  ON 48
ci_050                 1.384352e-03 3 1  ON 49
ci_051                -1.170520e-03 3 1  ON 50
ci_052                -1.156350e-03 3 1  ON 51
ci_053                -3.042163e-03 3 1  ON 52
ci_054                -1.564134e-03 3 1  ON 53
ci_055                -1.234739e-03 3 1  ON 54
ci_056                -2.011258e-03 3 1  ON 55
ci_057                -1.621878e-03 3 1  ON 56
ci_058                -1.399092e-03 3 1  ON 57
ci_059                 1.420273e-04 3 1  ON 58
ci_060                 3.057983e-04 3 1  ON 59
ci_061                 2.861136e-04 3 1  ON 60
ci_062                -2.794111e-04 3 1  ON 61
ci_063                -3.939775e-04 3 1  ON 62
ci_064                -1.014659e-03 3 1  ON 63
ci_065                -2.132416e-03 3 1  ON 64
ci_066                -2.427470e-03 3 1  ON 65
ci_067                -1.983514e-03 3 1  ON 66
ci_068                -2.465521e-03 3 1  ON 67
ci_069                -1.923633e-04 3 1  ON 68
ci_070                -6.447047e-04 3 1  ON 69
ci_071                -1.714850e-03 3 1  ON 70
ci_072                -2.591251e-03 3 1  ON 71
ci_073                 3.323629e-04 3 1  ON 72
ci_074                 3.272173e-04 3 1  ON 73
ci_075                -7.357100e-04 3 1  ON 74
ci_076                -2.348826e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 2.9835e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s020 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s020 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=20  my_counter=0
  time step      = 5.0000e-02
  blocks         = 250
  steps          = 250
  substeps       = 10
  current        = 0
  target samples = 8.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">250</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">6.2500e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">8.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">6.2500e+04</parameter>
<parameter name="steps" condition="int">250</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2674e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="250">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =8000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 20
    time step          = 0.05
    reference energy   = -22.5146
    reference variance = 0.793586
====================================================
  Execution time = 1.0456e+02
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s020
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 62500 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 6.1046e+04
  VMC Eavg = -2.2670e+01
  VMC Evar = 5.1478e-01
  Total weights = 7.820465881e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.9215e+01
  </log>
</opt>
<opt stage="main" walkers="62500">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.500751791048
                                         uncertainty =       0.003291537645

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.500751791048
                                         uncertainty =       0.003291537645

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000250188439
  error estimate for blocks of size 2^( 2) =       0.000259130696
  error estimate for blocks of size 2^( 3) =       0.000267141888
  error estimate for blocks of size 2^( 4) =       0.000272983798
  error estimate for blocks of size 2^( 5) =       0.000276366521
  error estimate for blocks of size 2^( 6) =       0.000278534422
  error estimate for blocks of size 2^( 7) =       0.000279698412
  error estimate for blocks of size 2^( 8) =       0.000280345418
  error estimate for blocks of size 2^( 9) =       0.000280745268

      target function =                  N/A
              le_mean =     -22.669735421319
             les_mean =     514.431681781251
             stat err =       0.000279830880
             autocorr =       1.250998535623
              std dev =       0.707639767996
             le_variance =       0.500754041249


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266973542132e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.5367e-02, overlap shift 9.5367e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.669735421342       residual = 5.30e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.669744923529       residual = 1.79e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.669745286039       residual = 2.32e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.669745486636       residual = 3.05e-08           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.669745378122       residual = 3.71e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          4 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 9.5367e-02 is 9.479264e-04

solving harmonic davidson linear method for identity shift 3.8147e-01, overlap shift 3.8147e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.669735421342       residual = 5.30e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.669739831886       residual = 6.94e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.669739830829       residual = 1.91e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.669739850200       residual = 6.14e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 3.8147e-01 is 3.825031e-04

solving harmonic davidson linear method for identity shift 1.5259e+00, overlap shift 1.5259e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.669735421342       residual = 5.30e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.669736824473       residual = 6.12e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.669736807078       residual = 1.29e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.669736809130       residual = 3.57e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 1.5259e+00 is 1.168620e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.044080 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.2380e+02
  </log>
  <optVariables href="FORM.s020.opt.xml">
ci_001                -7.052531e-01 3 1  ON 0
ci_002                -7.056250e-01 3 1  ON 1
ci_003                -3.898359e-02 3 1  ON 2
ci_004                -3.981273e-02 3 1  ON 3
ci_005                 1.580681e-02 3 1  ON 4
ci_006                 1.599200e-02 3 1  ON 5
ci_007                 1.215693e-02 3 1  ON 6
ci_008                 1.268668e-02 3 1  ON 7
ci_009                -1.164567e-02 3 1  ON 8
ci_010                -1.143285e-02 3 1  ON 9
ci_011                -8.146098e-03 3 1  ON 10
ci_012                -9.418763e-03 3 1  ON 11
ci_013                 9.980543e-03 3 1  ON 12
ci_014                 9.332485e-03 3 1  ON 13
ci_015                 1.280647e-02 3 1  ON 14
ci_016                 1.333278e-02 3 1  ON 15
ci_017                 1.126305e-02 3 1  ON 16
ci_018                 1.104660e-02 3 1  ON 17
ci_019                -2.587580e-03 3 1  ON 18
ci_020                -2.709598e-03 3 1  ON 19
ci_021                -7.912847e-03 3 1  ON 20
ci_022                -7.940187e-03 3 1  ON 21
ci_023                 8.183987e-03 3 1  ON 22
ci_024                 7.910735e-03 3 1  ON 23
ci_025                 4.258393e-03 3 1  ON 24
ci_026                 4.438111e-03 3 1  ON 25
ci_027                 6.562042e-03 3 1  ON 26
ci_028                 6.509487e-03 3 1  ON 27
ci_029                -5.030927e-03 3 1  ON 28
ci_030                -5.098119e-03 3 1  ON 29
ci_031                -8.200459e-03 3 1  ON 30
ci_032                -7.878803e-03 3 1  ON 31
ci_033                 4.296883e-03 3 1  ON 32
ci_034                 4.073928e-03 3 1  ON 33
ci_035                 1.467098e-03 3 1  ON 34
ci_036                 1.009696e-03 3 1  ON 35
ci_037                 5.550137e-03 3 1  ON 36
ci_038                 5.431234e-03 3 1  ON 37
ci_039                 5.311674e-03 3 1  ON 38
ci_040                 5.075394e-03 3 1  ON 39
ci_041                 5.291904e-03 3 1  ON 40
ci_042                 4.965289e-03 3 1  ON 41
ci_043                 4.360523e-03 3 1  ON 42
ci_044                 5.529151e-03 3 1  ON 43
ci_045                 2.876484e-03 3 1  ON 44
ci_046                 3.330966e-03 3 1  ON 45
ci_047                -4.732178e-04 3 1  ON 46
ci_048                -7.790433e-04 3 1  ON 47
ci_049                 2.210266e-03 3 1  ON 48
ci_050                 1.444969e-03 3 1  ON 49
ci_051                -9.972004e-04 3 1  ON 50
ci_052                -1.384068e-03 3 1  ON 51
ci_053                -2.804215e-03 3 1  ON 52
ci_054                -1.636366e-03 3 1  ON 53
ci_055                -1.283700e-03 3 1  ON 54
ci_056                -2.155712e-03 3 1  ON 55
ci_057                -1.373405e-03 3 1  ON 56
ci_058                -1.437229e-03 3 1  ON 57
ci_059                 2.206456e-04 3 1  ON 58
ci_060                 2.771676e-04 3 1  ON 59
ci_061                 2.876603e-04 3 1  ON 60
ci_062                -1.968213e-04 3 1  ON 61
ci_063                -4.086500e-04 3 1  ON 62
ci_064                -6.869547e-04 3 1  ON 63
ci_065                -2.234886e-03 3 1  ON 64
ci_066                -2.374861e-03 3 1  ON 65
ci_067                -2.066124e-03 3 1  ON 66
ci_068                -2.501355e-03 3 1  ON 67
ci_069                 6.162788e-05 3 1  ON 68
ci_070                -5.988558e-04 3 1  ON 69
ci_071                -2.079582e-03 3 1  ON 70
ci_072                -2.301512e-03 3 1  ON 71
ci_073                 3.074634e-04 3 1  ON 72
ci_074                 3.237875e-04 3 1  ON 73
ci_075                -6.921588e-04 3 1  ON 74
ci_076                -4.246685e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="250">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =8000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 20
    time step          = 0.05
    reference energy   = -22.6928
    reference variance = 0.334681
====================================================
  Execution time = 1.0209e+02
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s020
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 62500 
  VMC Eavg = -2.2670e+01
  VMC Evar = 5.1305e-01
  Total weights = 7.8205e+06
  Execution time = 1.4634e+01
  </log>
</opt>
<opt stage="main" walkers="62500">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.497566152518
                                         uncertainty =       0.001304701190

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.497566152518
                                         uncertainty =       0.001304701190

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000249390551
  error estimate for blocks of size 2^( 2) =       0.000258358283
  error estimate for blocks of size 2^( 3) =       0.000266457836
  error estimate for blocks of size 2^( 4) =       0.000272076136
  error estimate for blocks of size 2^( 5) =       0.000275366552
  error estimate for blocks of size 2^( 6) =       0.000276881615
  error estimate for blocks of size 2^( 7) =       0.000277750455
  error estimate for blocks of size 2^( 8) =       0.000278604698
  error estimate for blocks of size 2^( 9) =       0.000279322883

      target function =                  N/A
              le_mean =     -22.669830280662
             les_mean =     514.496123986609
             stat err =       0.000278139913
             autocorr =       1.243846073392
              std dev =       0.705382998419
             le_variance =       0.497565174458

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.497847003137
                                         uncertainty =       0.001385223640

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.497847003137
                                         uncertainty =       0.001385223640

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000249461028
  error estimate for blocks of size 2^( 2) =       0.000258424205
  error estimate for blocks of size 2^( 3) =       0.000266525395
  error estimate for blocks of size 2^( 4) =       0.000272135530
  error estimate for blocks of size 2^( 5) =       0.000275411772
  error estimate for blocks of size 2^( 6) =       0.000276919280
  error estimate for blocks of size 2^( 7) =       0.000277782662
  error estimate for blocks of size 2^( 8) =       0.000278642231
  error estimate for blocks of size 2^( 9) =       0.000279311560

      target function =                  N/A
              le_mean =     -22.669816612943
             les_mean =     514.879355328853
             stat err =       0.000278163933
             autocorr =       1.243358081033
              std dev =       0.705582339096
             le_variance =       0.497846437244

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.497315979488
                                         uncertainty =       0.001241513868

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.497315979488
                                         uncertainty =       0.001241513868

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000249327918
  error estimate for blocks of size 2^( 2) =       0.000258297824
  error estimate for blocks of size 2^( 3) =       0.000266401271
  error estimate for blocks of size 2^( 4) =       0.000272015959
  error estimate for blocks of size 2^( 5) =       0.000275296625
  error estimate for blocks of size 2^( 6) =       0.000276812021
  error estimate for blocks of size 2^( 7) =       0.000277678968
  error estimate for blocks of size 2^( 8) =       0.000278533056
  error estimate for blocks of size 2^( 9) =       0.000279212772

      target function =                  N/A
              le_mean =     -22.669823981132
             les_mean =     514.442904900133
             stat err =       0.000278059205
             autocorr =       1.243748957564
              std dev =       0.705205847217
             le_variance =       0.497315286949

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.497426976686
                                         uncertainty =       0.001256939536

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.497426976686
                                         uncertainty =       0.001256939536

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000249355720
  error estimate for blocks of size 2^( 2) =       0.000258324027
  error estimate for blocks of size 2^( 3) =       0.000266426515
  error estimate for blocks of size 2^( 4) =       0.000272041094
  error estimate for blocks of size 2^( 5) =       0.000275327546
  error estimate for blocks of size 2^( 6) =       0.000276850532
  error estimate for blocks of size 2^( 7) =       0.000277717065
  error estimate for blocks of size 2^( 8) =       0.000278574134
  error estimate for blocks of size 2^( 9) =       0.000279264526

      target function =                  N/A
              le_mean =     -22.669825735740
             les_mean =     514.438261316463
             stat err =       0.000278101564
             autocorr =       1.243850523347
              std dev =       0.705284482490
             le_variance =       0.497426201241


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.669830280662        initial  <--
     9.5367e-02     9.5367e-01             9.4793e-04       -22.669816612943
     3.8147e-01     3.8147e+00             3.8250e-04       -22.669823981132
     1.5259e+00     1.5259e+01             1.1686e-04       -22.669825735740

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 175.2910
  </log>
  <optVariables href="FORM.s020.opt.xml">
ci_001                -7.050900e-01 3 1  ON 0
ci_002                -7.057647e-01 3 1  ON 1
ci_003                -3.930332e-02 3 1  ON 2
ci_004                -3.990321e-02 3 1  ON 3
ci_005                 1.589453e-02 3 1  ON 4
ci_006                 1.615920e-02 3 1  ON 5
ci_007                 1.221704e-02 3 1  ON 6
ci_008                 1.248737e-02 3 1  ON 7
ci_009                -1.174063e-02 3 1  ON 8
ci_010                -1.144884e-02 3 1  ON 9
ci_011                -8.248426e-03 3 1  ON 10
ci_012                -9.706297e-03 3 1  ON 11
ci_013                 1.006247e-02 3 1  ON 12
ci_014                 9.418618e-03 3 1  ON 13
ci_015                 1.277705e-02 3 1  ON 14
ci_016                 1.345113e-02 3 1  ON 15
ci_017                 1.138362e-02 3 1  ON 16
ci_018                 1.091848e-02 3 1  ON 17
ci_019                -2.585258e-03 3 1  ON 18
ci_020                -2.717493e-03 3 1  ON 19
ci_021                -8.016470e-03 3 1  ON 20
ci_022                -7.557684e-03 3 1  ON 21
ci_023                 7.924027e-03 3 1  ON 22
ci_024                 7.773056e-03 3 1  ON 23
ci_025                 3.989449e-03 3 1  ON 24
ci_026                 4.182740e-03 3 1  ON 25
ci_027                 6.375416e-03 3 1  ON 26
ci_028                 6.596277e-03 3 1  ON 27
ci_029                -5.334899e-03 3 1  ON 28
ci_030                -4.854265e-03 3 1  ON 29
ci_031                -8.111815e-03 3 1  ON 30
ci_032                -7.870138e-03 3 1  ON 31
ci_033                 4.152219e-03 3 1  ON 32
ci_034                 4.224373e-03 3 1  ON 33
ci_035                 1.483388e-03 3 1  ON 34
ci_036                 9.629989e-04 3 1  ON 35
ci_037                 5.460217e-03 3 1  ON 36
ci_038                 5.290502e-03 3 1  ON 37
ci_039                 5.032236e-03 3 1  ON 38
ci_040                 5.032342e-03 3 1  ON 39
ci_041                 5.061579e-03 3 1  ON 40
ci_042                 5.054796e-03 3 1  ON 41
ci_043                 4.562773e-03 3 1  ON 42
ci_044                 5.454433e-03 3 1  ON 43
ci_045                 2.756304e-03 3 1  ON 44
ci_046                 3.568825e-03 3 1  ON 45
ci_047                -5.108446e-04 3 1  ON 46
ci_048                -6.243806e-04 3 1  ON 47
ci_049                 2.360827e-03 3 1  ON 48
ci_050                 1.384352e-03 3 1  ON 49
ci_051                -1.170520e-03 3 1  ON 50
ci_052                -1.156350e-03 3 1  ON 51
ci_053                -3.042163e-03 3 1  ON 52
ci_054                -1.564134e-03 3 1  ON 53
ci_055                -1.234739e-03 3 1  ON 54
ci_056                -2.011258e-03 3 1  ON 55
ci_057                -1.621878e-03 3 1  ON 56
ci_058                -1.399092e-03 3 1  ON 57
ci_059                 1.420273e-04 3 1  ON 58
ci_060                 3.057983e-04 3 1  ON 59
ci_061                 2.861136e-04 3 1  ON 60
ci_062                -2.794111e-04 3 1  ON 61
ci_063                -3.939775e-04 3 1  ON 62
ci_064                -1.014659e-03 3 1  ON 63
ci_065                -2.132416e-03 3 1  ON 64
ci_066                -2.427470e-03 3 1  ON 65
ci_067                -1.983514e-03 3 1  ON 66
ci_068                -2.465521e-03 3 1  ON 67
ci_069                -1.923633e-04 3 1  ON 68
ci_070                -6.447047e-04 3 1  ON 69
ci_071                -1.714850e-03 3 1  ON 70
ci_072                -2.591251e-03 3 1  ON 71
ci_073                 3.323629e-04 3 1  ON 72
ci_074                 3.272173e-04 3 1  ON 73
ci_075                -7.357100e-04 3 1  ON 74
ci_076                -2.348826e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 2.9910e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s021 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s021 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=21  my_counter=0
  time step      = 5.0000e-02
  blocks         = 250
  steps          = 250
  substeps       = 10
  current        = 0
  target samples = 8.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">250</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">6.2500e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">8.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">6.2500e+04</parameter>
<parameter name="steps" condition="int">250</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2671e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="250">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =8000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 21
    time step          = 0.05
    reference energy   = -22.757
    reference variance = 0.375321
====================================================
  Execution time = 1.0411e+02
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s021
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 62500 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 6.1046e+04
  VMC Eavg = -2.2670e+01
  VMC Evar = 5.1652e-01
  Total weights = 7.820537671e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.9272e+01
  </log>
</opt>
<opt stage="main" walkers="62500">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.500142521350
                                         uncertainty =       0.001810212367

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.500142521350
                                         uncertainty =       0.001810212367

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000250035545
  error estimate for blocks of size 2^( 2) =       0.000259061170
  error estimate for blocks of size 2^( 3) =       0.000266974171
  error estimate for blocks of size 2^( 4) =       0.000272770135
  error estimate for blocks of size 2^( 5) =       0.000275936856
  error estimate for blocks of size 2^( 6) =       0.000277646392
  error estimate for blocks of size 2^( 7) =       0.000278968033
  error estimate for blocks of size 2^( 8) =       0.000280441932
  error estimate for blocks of size 2^( 9) =       0.000280456193

      target function =                  N/A
              le_mean =     -22.669938088458
             les_mean =     514.442608590938
             stat err =       0.000279378137
             autocorr =       1.248479252841
              std dev =       0.707207318674
             le_variance =       0.500142191586


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266993808846e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.5367e-01, overlap shift 9.5367e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.669938088484       residual = 9.72e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.669939932210       residual = 2.08e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.669939966698       residual = 1.03e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.669939948353       residual = 9.83e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 9.5367e-01 is 2.501990e-04

solving harmonic davidson linear method for identity shift 3.8147e+00, overlap shift 3.8147e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.669938088484       residual = 9.72e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.669938609445       residual = 1.98e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.669938613333       residual = 1.21e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.669938604194       residual = 1.04e-08           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.669938605573       residual = 4.52e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          4 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 3.8147e+00 is 6.982128e-05

solving harmonic davidson linear method for identity shift 1.5259e+01, overlap shift 1.5259e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.669938088484       residual = 9.72e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.669938223108       residual = 2.00e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.669938223733       residual = 1.30e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.669938221091       residual = 1.07e-08           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.669938221436       residual = 4.65e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          4 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 1.5259e+01 is 1.799698e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.045651 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.2340e+02
  </log>
  <optVariables href="FORM.s021.opt.xml">
ci_001                -7.050886e-01 3 1  ON 0
ci_002                -7.057687e-01 3 1  ON 1
ci_003                -3.926875e-02 3 1  ON 2
ci_004                -3.991310e-02 3 1  ON 3
ci_005                 1.591104e-02 3 1  ON 4
ci_006                 1.614830e-02 3 1  ON 5
ci_007                 1.224621e-02 3 1  ON 6
ci_008                 1.251425e-02 3 1  ON 7
ci_009                -1.172308e-02 3 1  ON 8
ci_010                -1.143745e-02 3 1  ON 9
ci_011                -8.268242e-03 3 1  ON 10
ci_012                -9.669873e-03 3 1  ON 11
ci_013                 1.002586e-02 3 1  ON 12
ci_014                 9.387155e-03 3 1  ON 13
ci_015                 1.277292e-02 3 1  ON 14
ci_016                 1.344834e-02 3 1  ON 15
ci_017                 1.135089e-02 3 1  ON 16
ci_018                 1.091705e-02 3 1  ON 17
ci_019                -2.579088e-03 3 1  ON 18
ci_020                -2.743129e-03 3 1  ON 19
ci_021                -7.989285e-03 3 1  ON 20
ci_022                -7.579015e-03 3 1  ON 21
ci_023                 7.904664e-03 3 1  ON 22
ci_024                 7.773072e-03 3 1  ON 23
ci_025                 3.994068e-03 3 1  ON 24
ci_026                 4.203108e-03 3 1  ON 25
ci_027                 6.386798e-03 3 1  ON 26
ci_028                 6.589368e-03 3 1  ON 27
ci_029                -5.278705e-03 3 1  ON 28
ci_030                -4.868923e-03 3 1  ON 29
ci_031                -8.102954e-03 3 1  ON 30
ci_032                -7.863755e-03 3 1  ON 31
ci_033                 4.222040e-03 3 1  ON 32
ci_034                 4.240511e-03 3 1  ON 33
ci_035                 1.444960e-03 3 1  ON 34
ci_036                 1.021571e-03 3 1  ON 35
ci_037                 5.474621e-03 3 1  ON 36
ci_038                 5.270047e-03 3 1  ON 37
ci_039                 5.030352e-03 3 1  ON 38
ci_040                 5.083450e-03 3 1  ON 39
ci_041                 5.105130e-03 3 1  ON 40
ci_042                 5.055913e-03 3 1  ON 41
ci_043                 4.545792e-03 3 1  ON 42
ci_044                 5.430723e-03 3 1  ON 43
ci_045                 2.778617e-03 3 1  ON 44
ci_046                 3.544391e-03 3 1  ON 45
ci_047                -5.030969e-04 3 1  ON 46
ci_048                -6.125731e-04 3 1  ON 47
ci_049                 2.343729e-03 3 1  ON 48
ci_050                 1.354595e-03 3 1  ON 49
ci_051                -1.182770e-03 3 1  ON 50
ci_052                -1.187845e-03 3 1  ON 51
ci_053                -3.061621e-03 3 1  ON 52
ci_054                -1.619347e-03 3 1  ON 53
ci_055                -1.269086e-03 3 1  ON 54
ci_056                -1.945464e-03 3 1  ON 55
ci_057                -1.629872e-03 3 1  ON 56
ci_058                -1.435855e-03 3 1  ON 57
ci_059                 2.001620e-04 3 1  ON 58
ci_060                 2.685777e-04 3 1  ON 59
ci_061                 3.009449e-04 3 1  ON 60
ci_062                -2.953158e-04 3 1  ON 61
ci_063                -3.873442e-04 3 1  ON 62
ci_064                -9.945709e-04 3 1  ON 63
ci_065                -2.136182e-03 3 1  ON 64
ci_066                -2.440077e-03 3 1  ON 65
ci_067                -1.944123e-03 3 1  ON 66
ci_068                -2.416025e-03 3 1  ON 67
ci_069                -1.725942e-04 3 1  ON 68
ci_070                -5.956403e-04 3 1  ON 69
ci_071                -1.699302e-03 3 1  ON 70
ci_072                -2.570732e-03 3 1  ON 71
ci_073                 3.642892e-04 3 1  ON 72
ci_074                 3.158458e-04 3 1  ON 73
ci_075                -7.235816e-04 3 1  ON 74
ci_076                -2.366042e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="250">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =8000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 21
    time step          = 0.05
    reference energy   = -22.6496
    reference variance = 0.62633
====================================================
  Execution time = 1.0223e+02
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s021
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 62500 
  VMC Eavg = -2.2670e+01
  VMC Evar = 5.0885e-01
  Total weights = 7.8204e+06
  Execution time = 1.4634e+01
  </log>
</opt>
<opt stage="main" walkers="62500">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

ERROR CostFunction-> Number of Effective Walkers is too small! 
  Number of effective walkers (samples) / total number of samples = 0.000229614
  User specified threshold minwalkers = 0.3
  If this message appears frequently. You might have to be cautious. 
  Find info about parameter "minwalkers" in the user manual!
Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.496949637048
                                         uncertainty =       0.001504589059

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.496949637048
                                         uncertainty =       0.001504589059

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000249235922
  error estimate for blocks of size 2^( 2) =       0.000258191055
  error estimate for blocks of size 2^( 3) =       0.000266068167
  error estimate for blocks of size 2^( 4) =       0.000271825289
  error estimate for blocks of size 2^( 5) =       0.000275409958
  error estimate for blocks of size 2^( 6) =       0.000276896993
  error estimate for blocks of size 2^( 7) =       0.000278388398
  error estimate for blocks of size 2^( 8) =       0.000279535799
  error estimate for blocks of size 2^( 9) =       0.000280257289

      target function =                  N/A
              le_mean =     -22.670132425781
             les_mean =     514.443758470203
             stat err =       0.000278769620
             autocorr =       1.251035434399
              std dev =       0.704945643487
             le_variance =       0.496948360272

ERROR CostFunction-> Number of Effective Walkers is too small! 
  Number of effective walkers (samples) / total number of samples = 3.35231e-05
  User specified threshold minwalkers = 0.3
  If this message appears frequently. You might have to be cautious. 
  Find info about parameter "minwalkers" in the user manual!
Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.496956564041
                                         uncertainty =       0.001503051837

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.496956564041
                                         uncertainty =       0.001503051837

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000249237651
  error estimate for blocks of size 2^( 2) =       0.000258191977
  error estimate for blocks of size 2^( 3) =       0.000266068716
  error estimate for blocks of size 2^( 4) =       0.000271824121
  error estimate for blocks of size 2^( 5) =       0.000275409125
  error estimate for blocks of size 2^( 6) =       0.000276895026
  error estimate for blocks of size 2^( 7) =       0.000278384501
  error estimate for blocks of size 2^( 8) =       0.000279524564
  error estimate for blocks of size 2^( 9) =       0.000280241707

      target function =                  N/A
              le_mean =     -22.670133216384
             les_mean =     514.466458301366
             stat err =       0.000278761449
             autocorr =       1.250944748662
              std dev =       0.704950532847
             le_variance =       0.496955253761

ERROR CostFunction-> Number of Effective Walkers is too small! 
  Number of effective walkers (samples) / total number of samples = 0.000230411
  User specified threshold minwalkers = 0.3
  If this message appears frequently. You might have to be cautious. 
  Find info about parameter "minwalkers" in the user manual!
Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.496948871412
                                         uncertainty =       0.001503646377

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.496948871412
                                         uncertainty =       0.001503646377

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000249235726
  error estimate for blocks of size 2^( 2) =       0.000258190614
  error estimate for blocks of size 2^( 3) =       0.000266067621
  error estimate for blocks of size 2^( 4) =       0.000271824684
  error estimate for blocks of size 2^( 5) =       0.000275409597
  error estimate for blocks of size 2^( 6) =       0.000276895977
  error estimate for blocks of size 2^( 7) =       0.000278386360
  error estimate for blocks of size 2^( 8) =       0.000279530188
  error estimate for blocks of size 2^( 9) =       0.000280250978

      target function =                  N/A
              le_mean =     -22.670132684326
             les_mean =     514.452269643104
             stat err =       0.000278765876
             autocorr =       1.251003801139
              std dev =       0.704945088181
             le_variance =       0.496947577351

ERROR CostFunction-> Number of Effective Walkers is too small! 
  Number of effective walkers (samples) / total number of samples = 0.000587592
  User specified threshold minwalkers = 0.3
  If this message appears frequently. You might have to be cautious. 
  Find info about parameter "minwalkers" in the user manual!
Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.496949102322
                                         uncertainty =       0.001504459373

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.496949102322
                                         uncertainty =       0.001504459373

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000249235788
  error estimate for blocks of size 2^( 2) =       0.000258190885
  error estimate for blocks of size 2^( 3) =       0.000266067994
  error estimate for blocks of size 2^( 4) =       0.000271825105
  error estimate for blocks of size 2^( 5) =       0.000275409809
  error estimate for blocks of size 2^( 6) =       0.000276896762
  error estimate for blocks of size 2^( 7) =       0.000278388061
  error estimate for blocks of size 2^( 8) =       0.000279534990
  error estimate for blocks of size 2^( 9) =       0.000280256315

      target function =                  N/A
              le_mean =     -22.670132401130
             les_mean =     514.443732212383
             stat err =       0.000278769032
             autocorr =       1.251031509967
              std dev =       0.704945262730
             le_variance =       0.496947823446


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.670132425781        initial
     9.5367e-01     9.5367e+00             2.5020e-04       -22.670133216384  <--
     3.8147e+00     3.8147e+01             6.9821e-05       -22.670132684326
     1.5259e+01     1.5259e+02             1.7997e-05       -22.670132401130

*****************************************************************************
Applying the update for shift_i =   9.5367e-01     and shift_s =   9.5367e+00
*****************************************************************************

  Execution time = 1.7542e+02
  </log>
  <optVariables href="FORM.s021.opt.xml">
ci_001                -7.050852e-01 3 1  ON 0
ci_002                -7.057794e-01 3 1  ON 1
ci_003                -3.916788e-02 3 1  ON 2
ci_004                -3.994456e-02 3 1  ON 3
ci_005                 1.595207e-02 3 1  ON 4
ci_006                 1.612101e-02 3 1  ON 5
ci_007                 1.232123e-02 3 1  ON 6
ci_008                 1.258486e-02 3 1  ON 7
ci_009                -1.167425e-02 3 1  ON 8
ci_010                -1.141063e-02 3 1  ON 9
ci_011                -8.320663e-03 3 1  ON 10
ci_012                -9.572386e-03 3 1  ON 11
ci_013                 9.928694e-03 3 1  ON 12
ci_014                 9.307116e-03 3 1  ON 13
ci_015                 1.276081e-02 3 1  ON 14
ci_016                 1.344352e-02 3 1  ON 15
ci_017                 1.126563e-02 3 1  ON 16
ci_018                 1.091458e-02 3 1  ON 17
ci_019                -2.563698e-03 3 1  ON 18
ci_020                -2.811884e-03 3 1  ON 19
ci_021                -7.916584e-03 3 1  ON 20
ci_022                -7.635789e-03 3 1  ON 21
ci_023                 7.856073e-03 3 1  ON 22
ci_024                 7.772763e-03 3 1  ON 23
ci_025                 4.006411e-03 3 1  ON 24
ci_026                 4.259161e-03 3 1  ON 25
ci_027                 6.413592e-03 3 1  ON 26
ci_028                 6.571330e-03 3 1  ON 27
ci_029                -5.132490e-03 3 1  ON 28
ci_030                -4.905590e-03 3 1  ON 29
ci_031                -8.083521e-03 3 1  ON 30
ci_032                -7.845994e-03 3 1  ON 31
ci_033                 4.402418e-03 3 1  ON 32
ci_034                 4.283612e-03 3 1  ON 33
ci_035                 1.355800e-03 3 1  ON 34
ci_036                 1.153015e-03 3 1  ON 35
ci_037                 5.509481e-03 3 1  ON 36
ci_038                 5.217011e-03 3 1  ON 37
ci_039                 5.024308e-03 3 1  ON 38
ci_040                 5.204143e-03 3 1  ON 39
ci_041                 5.212168e-03 3 1  ON 40
ci_042                 5.057905e-03 3 1  ON 41
ci_043                 4.506802e-03 3 1  ON 42
ci_044                 5.368833e-03 3 1  ON 43
ci_045                 2.835954e-03 3 1  ON 44
ci_046                 3.481090e-03 3 1  ON 45
ci_047                -4.856999e-04 3 1  ON 46
ci_048                -5.854551e-04 3 1  ON 47
ci_049                 2.299252e-03 3 1  ON 48
ci_050                 1.277283e-03 3 1  ON 49
ci_051                -1.217588e-03 3 1  ON 50
ci_052                -1.271272e-03 3 1  ON 51
ci_053                -3.115434e-03 3 1  ON 52
ci_054                -1.766851e-03 3 1  ON 53
ci_055                -1.362290e-03 3 1  ON 54
ci_056                -1.773129e-03 3 1  ON 55
ci_057                -1.649928e-03 3 1  ON 56
ci_058                -1.529342e-03 3 1  ON 57
ci_059                 3.372983e-04 3 1  ON 58
ci_060                 1.798413e-04 3 1  ON 59
ci_061                 3.396940e-04 3 1  ON 60
ci_062                -3.349719e-04 3 1  ON 61
ci_063                -3.712753e-04 3 1  ON 62
ci_064                -9.436029e-04 3 1  ON 63
ci_065                -2.148982e-03 3 1  ON 64
ci_066                -2.471365e-03 3 1  ON 65
ci_067                -1.843065e-03 3 1  ON 66
ci_068                -2.291393e-03 3 1  ON 67
ci_069                -1.227812e-04 3 1  ON 68
ci_070                -4.727433e-04 3 1  ON 69
ci_071                -1.660552e-03 3 1  ON 70
ci_072                -2.517380e-03 3 1  ON 71
ci_073                 4.353297e-04 3 1  ON 72
ci_074                 2.901055e-04 3 1  ON 73
ci_075                -6.928421e-04 3 1  ON 74
ci_076                -2.445654e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 2.9883e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s022 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s022 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=22  my_counter=0
  time step      = 5.0000e-02
  blocks         = 250
  steps          = 250
  substeps       = 10
  current        = 0
  target samples = 8.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">250</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">6.2500e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">8.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">6.2500e+04</parameter>
<parameter name="steps" condition="int">250</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2672e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="250">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =8000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 22
    time step          = 0.05
    reference energy   = -22.6695
    reference variance = 0.390516
====================================================
  Execution time = 1.0397e+02
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s022
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 62500 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 6.1112e+04
  VMC Eavg = -2.2670e+01
  VMC Evar = 5.1314e-01
  Total weights = 7.820541642e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.9047e+01
  </log>
</opt>
<opt stage="main" walkers="62500">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.500087871400
                                         uncertainty =       0.001586407851

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.500087871400
                                         uncertainty =       0.001586407851

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000250021908
  error estimate for blocks of size 2^( 2) =       0.000259046269
  error estimate for blocks of size 2^( 3) =       0.000267081811
  error estimate for blocks of size 2^( 4) =       0.000272704735
  error estimate for blocks of size 2^( 5) =       0.000275971052
  error estimate for blocks of size 2^( 6) =       0.000278086691
  error estimate for blocks of size 2^( 7) =       0.000278932264
  error estimate for blocks of size 2^( 8) =       0.000279123886
  error estimate for blocks of size 2^( 9) =       0.000281269895

      target function =                  N/A
              le_mean =     -22.670044278744
             les_mean =     514.444050861003
             stat err =       0.000279353184
             autocorr =       1.248392419019
              std dev =       0.707168745795
             le_variance =       0.500087635030


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.267004427874e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3842e-01, overlap shift 2.3842e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.670044278768       residual = 4.94e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.670047202162       residual = 1.29e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.670047231075       residual = 6.09e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.670047260525       residual = 1.53e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 2.3842e-01 is 4.742724e-04

solving harmonic davidson linear method for identity shift 9.5367e-01, overlap shift 9.5367e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.670044278768       residual = 4.94e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.670045327018       residual = 6.54e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.670045258753       residual = 2.15e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.670045260174       residual = 5.65e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 9.5367e-01 is 1.674512e-04

solving harmonic davidson linear method for identity shift 3.8147e+00, overlap shift 3.8147e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.670044278768       residual = 4.94e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.670044572749       residual = 6.35e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.670044544903       residual = 1.44e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.670044545226       residual = 4.62e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 3.8147e+00 is 4.670732e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.046986 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.2303e+02
  </log>
  <optVariables href="FORM.s022.opt.xml">
ci_001                -7.050566e-01 3 1  ON 0
ci_002                -7.058171e-01 3 1  ON 1
ci_003                -3.904169e-02 3 1  ON 2
ci_004                -3.998525e-02 3 1  ON 3
ci_005                 1.599077e-02 3 1  ON 4
ci_006                 1.600116e-02 3 1  ON 5
ci_007                 1.234419e-02 3 1  ON 6
ci_008                 1.257813e-02 3 1  ON 7
ci_009                -1.172020e-02 3 1  ON 8
ci_010                -1.149204e-02 3 1  ON 9
ci_011                -8.309946e-03 3 1  ON 10
ci_012                -9.457554e-03 3 1  ON 11
ci_013                 9.842771e-03 3 1  ON 12
ci_014                 9.366594e-03 3 1  ON 13
ci_015                 1.279260e-02 3 1  ON 14
ci_016                 1.330685e-02 3 1  ON 15
ci_017                 1.122300e-02 3 1  ON 16
ci_018                 1.093439e-02 3 1  ON 17
ci_019                -2.612051e-03 3 1  ON 18
ci_020                -2.755435e-03 3 1  ON 19
ci_021                -8.048681e-03 3 1  ON 20
ci_022                -7.696832e-03 3 1  ON 21
ci_023                 7.876077e-03 3 1  ON 22
ci_024                 7.830602e-03 3 1  ON 23
ci_025                 4.092616e-03 3 1  ON 24
ci_026                 4.177926e-03 3 1  ON 25
ci_027                 6.417559e-03 3 1  ON 26
ci_028                 6.562162e-03 3 1  ON 27
ci_029                -4.985030e-03 3 1  ON 28
ci_030                -4.757510e-03 3 1  ON 29
ci_031                -8.165347e-03 3 1  ON 30
ci_032                -7.769400e-03 3 1  ON 31
ci_033                 4.459906e-03 3 1  ON 32
ci_034                 4.225527e-03 3 1  ON 33
ci_035                 1.244839e-03 3 1  ON 34
ci_036                 1.194584e-03 3 1  ON 35
ci_037                 5.537362e-03 3 1  ON 36
ci_038                 5.220743e-03 3 1  ON 37
ci_039                 5.018053e-03 3 1  ON 38
ci_040                 5.139183e-03 3 1  ON 39
ci_041                 5.114698e-03 3 1  ON 40
ci_042                 5.068588e-03 3 1  ON 41
ci_043                 4.597919e-03 3 1  ON 42
ci_044                 5.296029e-03 3 1  ON 43
ci_045                 2.883921e-03 3 1  ON 44
ci_046                 3.545495e-03 3 1  ON 45
ci_047                -4.515512e-04 3 1  ON 46
ci_048                -4.894204e-04 3 1  ON 47
ci_049                 2.141016e-03 3 1  ON 48
ci_050                 1.444734e-03 3 1  ON 49
ci_051                -1.297546e-03 3 1  ON 50
ci_052                -1.310281e-03 3 1  ON 51
ci_053                -2.980126e-03 3 1  ON 52
ci_054                -1.730234e-03 3 1  ON 53
ci_055                -1.288619e-03 3 1  ON 54
ci_056                -1.766031e-03 3 1  ON 55
ci_057                -1.612476e-03 3 1  ON 56
ci_058                -1.458888e-03 3 1  ON 57
ci_059                 2.752980e-04 3 1  ON 58
ci_060                 1.847822e-04 3 1  ON 59
ci_061                 3.118467e-04 3 1  ON 60
ci_062                -1.869745e-04 3 1  ON 61
ci_063                -3.549500e-04 3 1  ON 62
ci_064                -9.782248e-04 3 1  ON 63
ci_065                -2.228728e-03 3 1  ON 64
ci_066                -2.389393e-03 3 1  ON 65
ci_067                -1.958803e-03 3 1  ON 66
ci_068                -2.267671e-03 3 1  ON 67
ci_069                -9.800828e-06 3 1  ON 68
ci_070                -4.044667e-04 3 1  ON 69
ci_071                -1.699704e-03 3 1  ON 70
ci_072                -2.576401e-03 3 1  ON 71
ci_073                 5.228082e-04 3 1  ON 72
ci_074                 3.305012e-04 3 1  ON 73
ci_075                -7.113703e-04 3 1  ON 74
ci_076                -2.599953e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="250">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =8000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 22
    time step          = 0.05
    reference energy   = -22.6306
    reference variance = 0.623219
====================================================
  Execution time = 1.0228e+02
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s022
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 62500 
  VMC Eavg = -2.2669e+01
  VMC Evar = 5.1436e-01
  Total weights = 7.8202e+06
  Execution time = 1.4624e+01
  </log>
</opt>
<opt stage="main" walkers="62500">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.499333844267
                                         uncertainty =       0.002223791409

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.499333844267
                                         uncertainty =       0.002223791409

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000249833356
  error estimate for blocks of size 2^( 2) =       0.000258922092
  error estimate for blocks of size 2^( 3) =       0.000266917486
  error estimate for blocks of size 2^( 4) =       0.000272464983
  error estimate for blocks of size 2^( 5) =       0.000275863061
  error estimate for blocks of size 2^( 6) =       0.000277696640
  error estimate for blocks of size 2^( 7) =       0.000278648782
  error estimate for blocks of size 2^( 8) =       0.000280232781
  error estimate for blocks of size 2^( 9) =       0.000280440176

      target function =                  N/A
              le_mean =     -22.669270628684
             les_mean =     514.410581529343
             stat err =       0.000279254595
             autocorr =       1.249395142381
              std dev =       0.706635439844
             le_variance =       0.499333644843

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.499297438967
                                         uncertainty =       0.002228456360

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.499297438967
                                         uncertainty =       0.002228456360

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000249824241
  error estimate for blocks of size 2^( 2) =       0.000258912670
  error estimate for blocks of size 2^( 3) =       0.000266908844
  error estimate for blocks of size 2^( 4) =       0.000272456442
  error estimate for blocks of size 2^( 5) =       0.000275856826
  error estimate for blocks of size 2^( 6) =       0.000277690323
  error estimate for blocks of size 2^( 7) =       0.000278639813
  error estimate for blocks of size 2^( 8) =       0.000280224058
  error estimate for blocks of size 2^( 9) =       0.000280436616

      target function =                  N/A
              le_mean =     -22.669271816148
             les_mean =     514.411350591782
             stat err =       0.000279247702
             autocorr =       1.249424629855
              std dev =       0.706609660527
             le_variance =       0.499297212349

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.499313429188
                                         uncertainty =       0.002227671915

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.499313429188
                                         uncertainty =       0.002227671915

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000249828245
  error estimate for blocks of size 2^( 2) =       0.000258916039
  error estimate for blocks of size 2^( 3) =       0.000266911546
  error estimate for blocks of size 2^( 4) =       0.000272459012
  error estimate for blocks of size 2^( 5) =       0.000275859662
  error estimate for blocks of size 2^( 6) =       0.000277689989
  error estimate for blocks of size 2^( 7) =       0.000278639246
  error estimate for blocks of size 2^( 8) =       0.000280227314
  error estimate for blocks of size 2^( 9) =       0.000280433062

      target function =                  N/A
              le_mean =     -22.669268482011
             les_mean =     514.507811392095
             stat err =       0.000279247403
             autocorr =       1.249381904289
              std dev =       0.706620985089
             le_variance =       0.499313216568

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.499326015225
                                         uncertainty =       0.002224082972

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.499326015225
                                         uncertainty =       0.002224082972

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000249831397
  error estimate for blocks of size 2^( 2) =       0.000258920113
  error estimate for blocks of size 2^( 3) =       0.000266915599
  error estimate for blocks of size 2^( 4) =       0.000272463111
  error estimate for blocks of size 2^( 5) =       0.000275861405
  error estimate for blocks of size 2^( 6) =       0.000277694978
  error estimate for blocks of size 2^( 7) =       0.000278646835
  error estimate for blocks of size 2^( 8) =       0.000280230786
  error estimate for blocks of size 2^( 9) =       0.000280438638

      target function =                  N/A
              le_mean =     -22.669270266105
             les_mean =     514.410295391021
             stat err =       0.000279252809
             autocorr =       1.249398757510
              std dev =       0.706629899164
             le_variance =       0.499325814392


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.669270628684        initial
     2.3842e-01     2.3842e+00             4.7427e-04       -22.669271816148  <--
     9.5367e-01     9.5367e+00             1.6745e-04       -22.669268482011
     3.8147e+00     3.8147e+01             4.6707e-05       -22.669270266105

*****************************************************************************
Applying the update for shift_i =   2.3842e-01     and shift_s =   2.3842e+00
*****************************************************************************

  Execution time = 1.7546e+02
  </log>
  <optVariables href="FORM.s022.opt.xml">
ci_001                -7.049759e-01 3 1  ON 0
ci_002                -7.059172e-01 3 1  ON 1
ci_003                -3.871487e-02 3 1  ON 2
ci_004                -4.008900e-02 3 1  ON 3
ci_005                 1.604101e-02 3 1  ON 4
ci_006                 1.582287e-02 3 1  ON 5
ci_007                 1.238990e-02 3 1  ON 6
ci_008                 1.256725e-02 3 1  ON 7
ci_009                -1.179152e-02 3 1  ON 8
ci_010                -1.162435e-02 3 1  ON 9
ci_011                -8.311165e-03 3 1  ON 10
ci_012                -9.236551e-03 3 1  ON 11
ci_013                 9.683017e-03 3 1  ON 12
ci_014                 9.485166e-03 3 1  ON 13
ci_015                 1.285886e-02 3 1  ON 14
ci_016                 1.302377e-02 3 1  ON 15
ci_017                 1.115853e-02 3 1  ON 16
ci_018                 1.096130e-02 3 1  ON 17
ci_019                -2.707724e-03 3 1  ON 18
ci_020                -2.624690e-03 3 1  ON 19
ci_021                -8.300197e-03 3 1  ON 20
ci_022                -7.836838e-03 3 1  ON 21
ci_023                 7.907370e-03 3 1  ON 22
ci_024                 7.931380e-03 3 1  ON 23
ci_025                 4.272850e-03 3 1  ON 24
ci_026                 4.008163e-03 3 1  ON 25
ci_027                 6.419693e-03 3 1  ON 26
ci_028                 6.552902e-03 3 1  ON 27
ci_029                -4.711883e-03 3 1  ON 28
ci_030                -4.501697e-03 3 1  ON 29
ci_031                -8.314245e-03 3 1  ON 30
ci_032                -7.620528e-03 3 1  ON 31
ci_033                 4.562129e-03 3 1  ON 32
ci_034                 4.110992e-03 3 1  ON 33
ci_035                 1.089557e-03 3 1  ON 34
ci_036                 1.254337e-03 3 1  ON 35
ci_037                 5.579608e-03 3 1  ON 36
ci_038                 5.238241e-03 3 1  ON 37
ci_039                 5.011470e-03 3 1  ON 38
ci_040                 5.047737e-03 3 1  ON 39
ci_041                 4.959099e-03 3 1  ON 40
ci_042                 5.087320e-03 3 1  ON 41
ci_043                 4.761218e-03 3 1  ON 42
ci_044                 5.161464e-03 3 1  ON 43
ci_045                 2.974411e-03 3 1  ON 44
ci_046                 3.674704e-03 3 1  ON 45
ci_047                -4.101477e-04 3 1  ON 46
ci_048                -3.579755e-04 3 1  ON 47
ci_049                 1.856332e-03 3 1  ON 48
ci_050                 1.751556e-03 3 1  ON 49
ci_051                -1.449770e-03 3 1  ON 50
ci_052                -1.377444e-03 3 1  ON 51
ci_053                -2.729291e-03 3 1  ON 52
ci_054                -1.677385e-03 3 1  ON 53
ci_055                -1.144765e-03 3 1  ON 54
ci_056                -1.756343e-03 3 1  ON 55
ci_057                -1.547770e-03 3 1  ON 56
ci_058                -1.341884e-03 3 1  ON 57
ci_059                 1.791758e-04 3 1  ON 58
ci_060                 1.916241e-04 3 1  ON 59
ci_061                 2.641422e-04 3 1  ON 60
ci_062                 6.769483e-05 3 1  ON 61
ci_063                -3.380616e-04 3 1  ON 62
ci_064                -1.039992e-03 3 1  ON 63
ci_065                -2.386215e-03 3 1  ON 64
ci_066                -2.263424e-03 3 1  ON 65
ci_067                -2.177289e-03 3 1  ON 66
ci_068                -2.230420e-03 3 1  ON 67
ci_069                 1.892265e-04 3 1  ON 68
ci_070                -2.906295e-04 3 1  ON 69
ci_071                -1.761287e-03 3 1  ON 70
ci_072                -2.681540e-03 3 1  ON 71
ci_073                 6.525961e-04 3 1  ON 72
ci_074                 3.849014e-04 3 1  ON 73
ci_075                -7.500381e-04 3 1  ON 74
ci_076                -2.892247e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 2.9852e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s023 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s023 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=23  my_counter=0
  time step      = 5.0000e-02
  blocks         = 250
  steps          = 250
  substeps       = 10
  current        = 0
  target samples = 8.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">250</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">6.2500e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">8.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">6.2500e+04</parameter>
<parameter name="steps" condition="int">250</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2671e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="250">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =8000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 23
    time step          = 0.05
    reference energy   = -22.6506
    reference variance = 0.373716
====================================================
  Execution time = 1.0424e+02
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s023
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 62500 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 6.1069e+04
  VMC Eavg = -2.2669e+01
  VMC Evar = 5.1002e-01
  Total weights = 7.819785576e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.9003e+01
  </log>
</opt>
<opt stage="main" walkers="62500">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.496973723717
                                         uncertainty =       0.001474373400

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.496973723717
                                         uncertainty =       0.001474373400

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000249242270
  error estimate for blocks of size 2^( 2) =       0.000258065646
  error estimate for blocks of size 2^( 3) =       0.000265954891
  error estimate for blocks of size 2^( 4) =       0.000271485661
  error estimate for blocks of size 2^( 5) =       0.000274814105
  error estimate for blocks of size 2^( 6) =       0.000276904856
  error estimate for blocks of size 2^( 7) =       0.000277761057
  error estimate for blocks of size 2^( 8) =       0.000278155057
  error estimate for blocks of size 2^( 9) =       0.000278153841

      target function =                  N/A
              le_mean =     -22.669329607625
             les_mean =     514.408525218942
             stat err =       0.000277743703
             autocorr =       1.241781097382
              std dev =       0.704963598467
             le_variance =       0.496973675164


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266932960763e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.9605e-02, overlap shift 5.9605e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.669329607651       residual = 4.51e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.669337960844       residual = 3.13e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.669339114399       residual = 3.93e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.669339275393       residual = 4.31e-08           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.669339140975       residual = 4.97e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          4 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 5.9605e-02 is 1.726139e-03

solving harmonic davidson linear method for identity shift 2.3842e-01, overlap shift 2.3842e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.669329607651       residual = 4.51e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.669334123140       residual = 1.01e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.669334292412       residual = 4.81e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.669334294186       residual = 1.30e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 2.3842e-01 is 6.405904e-04

solving harmonic davidson linear method for identity shift 9.5367e-01, overlap shift 9.5367e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.669329607651       residual = 4.51e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.669331198889       residual = 5.82e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.669331177846       residual = 1.56e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.669331175354       residual = 3.99e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 9.5367e-01 is 1.821008e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.048547 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.2326e+02
  </log>
  <optVariables href="FORM.s023.opt.xml">
ci_001                -7.049403e-01 3 1  ON 0
ci_002                -7.060037e-01 3 1  ON 1
ci_003                -3.846691e-02 3 1  ON 2
ci_004                -3.944841e-02 3 1  ON 3
ci_005                 1.591663e-02 3 1  ON 4
ci_006                 1.590275e-02 3 1  ON 5
ci_007                 1.233899e-02 3 1  ON 6
ci_008                 1.257776e-02 3 1  ON 7
ci_009                -1.161609e-02 3 1  ON 8
ci_010                -1.168843e-02 3 1  ON 9
ci_011                -8.171211e-03 3 1  ON 10
ci_012                -8.754000e-03 3 1  ON 11
ci_013                 9.540041e-03 3 1  ON 12
ci_014                 9.635297e-03 3 1  ON 13
ci_015                 1.279385e-02 3 1  ON 14
ci_016                 1.322958e-02 3 1  ON 15
ci_017                 1.106586e-02 3 1  ON 16
ci_018                 1.072215e-02 3 1  ON 17
ci_019                -2.634087e-03 3 1  ON 18
ci_020                -2.710972e-03 3 1  ON 19
ci_021                -8.096678e-03 3 1  ON 20
ci_022                -8.219412e-03 3 1  ON 21
ci_023                 7.946316e-03 3 1  ON 22
ci_024                 8.226278e-03 3 1  ON 23
ci_025                 4.050067e-03 3 1  ON 24
ci_026                 4.542636e-03 3 1  ON 25
ci_027                 6.650592e-03 3 1  ON 26
ci_028                 6.822340e-03 3 1  ON 27
ci_029                -4.929952e-03 3 1  ON 28
ci_030                -4.663802e-03 3 1  ON 29
ci_031                -8.067848e-03 3 1  ON 30
ci_032                -7.663103e-03 3 1  ON 31
ci_033                 4.549058e-03 3 1  ON 32
ci_034                 4.100813e-03 3 1  ON 33
ci_035                 1.116810e-03 3 1  ON 34
ci_036                 1.188283e-03 3 1  ON 35
ci_037                 5.673398e-03 3 1  ON 36
ci_038                 4.992941e-03 3 1  ON 37
ci_039                 5.296533e-03 3 1  ON 38
ci_040                 5.168898e-03 3 1  ON 39
ci_041                 4.981080e-03 3 1  ON 40
ci_042                 5.146719e-03 3 1  ON 41
ci_043                 4.929479e-03 3 1  ON 42
ci_044                 5.032864e-03 3 1  ON 43
ci_045                 2.893566e-03 3 1  ON 44
ci_046                 3.584051e-03 3 1  ON 45
ci_047                -5.410035e-04 3 1  ON 46
ci_048                -6.715767e-04 3 1  ON 47
ci_049                 1.778047e-03 3 1  ON 48
ci_050                 2.035857e-03 3 1  ON 49
ci_051                -1.460037e-03 3 1  ON 50
ci_052                -1.468577e-03 3 1  ON 51
ci_053                -2.845932e-03 3 1  ON 52
ci_054                -1.940468e-03 3 1  ON 53
ci_055                -1.113014e-03 3 1  ON 54
ci_056                -1.311951e-03 3 1  ON 55
ci_057                -1.839580e-03 3 1  ON 56
ci_058                -1.496203e-03 3 1  ON 57
ci_059                 1.361973e-04 3 1  ON 58
ci_060                 2.293328e-04 3 1  ON 59
ci_061                -8.629464e-05 3 1  ON 60
ci_062                -8.731413e-07 3 1  ON 61
ci_063                -5.999748e-04 3 1  ON 62
ci_064                -8.711018e-04 3 1  ON 63
ci_065                -2.315289e-03 3 1  ON 64
ci_066                -2.086437e-03 3 1  ON 65
ci_067                -2.136343e-03 3 1  ON 66
ci_068                -2.514775e-03 3 1  ON 67
ci_069                 4.539909e-04 3 1  ON 68
ci_070                -2.180550e-04 3 1  ON 69
ci_071                -1.745796e-03 3 1  ON 70
ci_072                -2.366578e-03 3 1  ON 71
ci_073                 3.519787e-04 3 1  ON 72
ci_074                 2.748025e-04 3 1  ON 73
ci_075                -3.644752e-04 3 1  ON 74
ci_076                -3.302829e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="250">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =8000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 23
    time step          = 0.05
    reference energy   = -22.6271
    reference variance = 0.340386
====================================================
  Execution time = 1.0219e+02
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s023
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 62500 
  VMC Eavg = -2.2670e+01
  VMC Evar = 5.1293e-01
  Total weights = 7.8199e+06
  Execution time = 1.4650e+01
  </log>
</opt>
<opt stage="main" walkers="62500">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.498834793596
                                         uncertainty =       0.001988508480

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.498834793596
                                         uncertainty =       0.001988508480

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000249708982
  error estimate for blocks of size 2^( 2) =       0.000258616746
  error estimate for blocks of size 2^( 3) =       0.000266721228
  error estimate for blocks of size 2^( 4) =       0.000272504466
  error estimate for blocks of size 2^( 5) =       0.000276086243
  error estimate for blocks of size 2^( 6) =       0.000277917526
  error estimate for blocks of size 2^( 7) =       0.000279139924
  error estimate for blocks of size 2^( 8) =       0.000278648095
  error estimate for blocks of size 2^( 9) =       0.000278377666

      target function =                  N/A
              le_mean =     -22.669986520960
             les_mean =     514.466220907123
             stat err =       0.000278520803
             autocorr =       1.244076104693
              std dev =       0.706283658046
             le_variance =       0.498836605623

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.499007646816
                                         uncertainty =       0.002069198561

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.499007646816
                                         uncertainty =       0.002069198561

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000249752247
  error estimate for blocks of size 2^( 2) =       0.000258655534
  error estimate for blocks of size 2^( 3) =       0.000266755535
  error estimate for blocks of size 2^( 4) =       0.000272530723
  error estimate for blocks of size 2^( 5) =       0.000276107281
  error estimate for blocks of size 2^( 6) =       0.000277932498
  error estimate for blocks of size 2^( 7) =       0.000279152031
  error estimate for blocks of size 2^( 8) =       0.000278647009
  error estimate for blocks of size 2^( 9) =       0.000278369819

      target function =                  N/A
              le_mean =     -22.669980628500
             les_mean =     514.463484888581
             stat err =       0.000278525339
             autocorr =       1.243685629631
              std dev =       0.706406028961
             le_variance =       0.499009477752

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.499110847955
                                         uncertainty =       0.002115744253

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.499110847955
                                         uncertainty =       0.002115744253

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000249778093
  error estimate for blocks of size 2^( 2) =       0.000258681032
  error estimate for blocks of size 2^( 3) =       0.000266781110
  error estimate for blocks of size 2^( 4) =       0.000272556264
  error estimate for blocks of size 2^( 5) =       0.000276135971
  error estimate for blocks of size 2^( 6) =       0.000277964746
  error estimate for blocks of size 2^( 7) =       0.000279179557
  error estimate for blocks of size 2^( 8) =       0.000278667805
  error estimate for blocks of size 2^( 9) =       0.000278367891

      target function =                  N/A
              le_mean =     -22.669983728068
             les_mean =     514.501946611194
             stat err =       0.000278545000
             autocorr =       1.243603803754
              std dev =       0.706479133562
             le_variance =       0.499112766159

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.498844969965
                                         uncertainty =       0.002010508668

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.498844969965
                                         uncertainty =       0.002010508668

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000249711533
  error estimate for blocks of size 2^( 2) =       0.000258618731
  error estimate for blocks of size 2^( 3) =       0.000266722521
  error estimate for blocks of size 2^( 4) =       0.000272503061
  error estimate for blocks of size 2^( 5) =       0.000276082588
  error estimate for blocks of size 2^( 6) =       0.000277912319
  error estimate for blocks of size 2^( 7) =       0.000279132181
  error estimate for blocks of size 2^( 8) =       0.000278640829
  error estimate for blocks of size 2^( 9) =       0.000278367177

      target function =                  N/A
              le_mean =     -22.669982007930
             les_mean =     514.442609291259
             stat err =       0.000278513127
             autocorr =       1.243982110661
              std dev =       0.706290873967
             le_variance =       0.498846798649


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.669986520960        initial  <--
     5.9605e-02     5.9605e-01             1.7261e-03       -22.669980628500
     2.3842e-01     2.3842e+00             6.4059e-04       -22.669983728068
     9.5367e-01     9.5367e+00             1.8210e-04       -22.669982007930

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 175.4596
  </log>
  <optVariables href="FORM.s023.opt.xml">
ci_001                -7.049759e-01 3 1  ON 0
ci_002                -7.059172e-01 3 1  ON 1
ci_003                -3.871487e-02 3 1  ON 2
ci_004                -4.008900e-02 3 1  ON 3
ci_005                 1.604101e-02 3 1  ON 4
ci_006                 1.582287e-02 3 1  ON 5
ci_007                 1.238990e-02 3 1  ON 6
ci_008                 1.256725e-02 3 1  ON 7
ci_009                -1.179152e-02 3 1  ON 8
ci_010                -1.162435e-02 3 1  ON 9
ci_011                -8.311165e-03 3 1  ON 10
ci_012                -9.236551e-03 3 1  ON 11
ci_013                 9.683017e-03 3 1  ON 12
ci_014                 9.485166e-03 3 1  ON 13
ci_015                 1.285886e-02 3 1  ON 14
ci_016                 1.302377e-02 3 1  ON 15
ci_017                 1.115853e-02 3 1  ON 16
ci_018                 1.096130e-02 3 1  ON 17
ci_019                -2.707724e-03 3 1  ON 18
ci_020                -2.624690e-03 3 1  ON 19
ci_021                -8.300197e-03 3 1  ON 20
ci_022                -7.836838e-03 3 1  ON 21
ci_023                 7.907370e-03 3 1  ON 22
ci_024                 7.931380e-03 3 1  ON 23
ci_025                 4.272850e-03 3 1  ON 24
ci_026                 4.008163e-03 3 1  ON 25
ci_027                 6.419693e-03 3 1  ON 26
ci_028                 6.552902e-03 3 1  ON 27
ci_029                -4.711883e-03 3 1  ON 28
ci_030                -4.501697e-03 3 1  ON 29
ci_031                -8.314245e-03 3 1  ON 30
ci_032                -7.620528e-03 3 1  ON 31
ci_033                 4.562129e-03 3 1  ON 32
ci_034                 4.110992e-03 3 1  ON 33
ci_035                 1.089557e-03 3 1  ON 34
ci_036                 1.254337e-03 3 1  ON 35
ci_037                 5.579608e-03 3 1  ON 36
ci_038                 5.238241e-03 3 1  ON 37
ci_039                 5.011470e-03 3 1  ON 38
ci_040                 5.047737e-03 3 1  ON 39
ci_041                 4.959099e-03 3 1  ON 40
ci_042                 5.087320e-03 3 1  ON 41
ci_043                 4.761218e-03 3 1  ON 42
ci_044                 5.161464e-03 3 1  ON 43
ci_045                 2.974411e-03 3 1  ON 44
ci_046                 3.674704e-03 3 1  ON 45
ci_047                -4.101477e-04 3 1  ON 46
ci_048                -3.579755e-04 3 1  ON 47
ci_049                 1.856332e-03 3 1  ON 48
ci_050                 1.751556e-03 3 1  ON 49
ci_051                -1.449770e-03 3 1  ON 50
ci_052                -1.377444e-03 3 1  ON 51
ci_053                -2.729291e-03 3 1  ON 52
ci_054                -1.677385e-03 3 1  ON 53
ci_055                -1.144765e-03 3 1  ON 54
ci_056                -1.756343e-03 3 1  ON 55
ci_057                -1.547770e-03 3 1  ON 56
ci_058                -1.341884e-03 3 1  ON 57
ci_059                 1.791758e-04 3 1  ON 58
ci_060                 1.916241e-04 3 1  ON 59
ci_061                 2.641422e-04 3 1  ON 60
ci_062                 6.769483e-05 3 1  ON 61
ci_063                -3.380616e-04 3 1  ON 62
ci_064                -1.039992e-03 3 1  ON 63
ci_065                -2.386215e-03 3 1  ON 64
ci_066                -2.263424e-03 3 1  ON 65
ci_067                -2.177289e-03 3 1  ON 66
ci_068                -2.230420e-03 3 1  ON 67
ci_069                 1.892265e-04 3 1  ON 68
ci_070                -2.906295e-04 3 1  ON 69
ci_071                -1.761287e-03 3 1  ON 70
ci_072                -2.681540e-03 3 1  ON 71
ci_073                 6.525961e-04 3 1  ON 72
ci_074                 3.849014e-04 3 1  ON 73
ci_075                -7.500381e-04 3 1  ON 74
ci_076                -2.892247e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 2.9873e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s024 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s024 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=24  my_counter=0
  time step      = 5.0000e-02
  blocks         = 250
  steps          = 250
  substeps       = 10
  current        = 0
  target samples = 8.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">250</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">6.2500e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">8.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">6.2500e+04</parameter>
<parameter name="steps" condition="int">250</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2670e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="250">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =8000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 24
    time step          = 0.05
    reference energy   = -22.6688
    reference variance = 0.457708
====================================================
  Execution time = 1.0411e+02
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s024
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 62500 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 6.1085e+04
  VMC Eavg = -2.2670e+01
  VMC Evar = 5.0891e-01
  Total weights = 7.820681946e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.8876e+01
  </log>
</opt>
<opt stage="main" walkers="62500">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.495668796485
                                         uncertainty =       0.002005287869

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.495668796485
                                         uncertainty =       0.002005287869

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000248914566
  error estimate for blocks of size 2^( 2) =       0.000257936102
  error estimate for blocks of size 2^( 3) =       0.000266070288
  error estimate for blocks of size 2^( 4) =       0.000271712370
  error estimate for blocks of size 2^( 5) =       0.000274794803
  error estimate for blocks of size 2^( 6) =       0.000276349114
  error estimate for blocks of size 2^( 7) =       0.000277866256
  error estimate for blocks of size 2^( 8) =       0.000278795160
  error estimate for blocks of size 2^( 9) =       0.000279186595

      target function =                  N/A
              le_mean =     -22.669523767031
             les_mean =     514.416222536315
             stat err =       0.000278049281
             autocorr =       1.247794111943
              std dev =       0.704036708814
             le_variance =       0.495667687358


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266952376703e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.9605e-01, overlap shift 5.9605e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.669523767054       residual = 6.12e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.669526279340       residual = 7.32e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.669526351731       residual = 1.51e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.669526374327       residual = 4.40e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 5.9605e-01 is 3.270461e-04

solving harmonic davidson linear method for identity shift 2.3842e+00, overlap shift 2.3842e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.669523767054       residual = 6.12e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.669524515600       residual = 6.31e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.669524527186       residual = 1.31e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.669524531232       residual = 2.85e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 2.3842e+00 is 9.100728e-05

solving harmonic davidson linear method for identity shift 9.5367e+00, overlap shift 9.5367e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.669523767054       residual = 6.12e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.669523963617       residual = 6.94e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.669523966101       residual = 1.58e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.669523967140       residual = 3.71e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 9.5367e+00 is 2.393325e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.053075 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.2300e+02
  </log>
  <optVariables href="FORM.s024.opt.xml">
ci_001                -7.049866e-01 3 1  ON 0
ci_002                -7.059146e-01 3 1  ON 1
ci_003                -3.862750e-02 3 1  ON 2
ci_004                -4.002590e-02 3 1  ON 3
ci_005                 1.604009e-02 3 1  ON 4
ci_006                 1.580266e-02 3 1  ON 5
ci_007                 1.239818e-02 3 1  ON 6
ci_008                 1.257679e-02 3 1  ON 7
ci_009                -1.177403e-02 3 1  ON 8
ci_010                -1.162090e-02 3 1  ON 9
ci_011                -8.339482e-03 3 1  ON 10
ci_012                -9.220664e-03 3 1  ON 11
ci_013                 9.681573e-03 3 1  ON 12
ci_014                 9.421658e-03 3 1  ON 13
ci_015                 1.281367e-02 3 1  ON 14
ci_016                 1.305739e-02 3 1  ON 15
ci_017                 1.116700e-02 3 1  ON 16
ci_018                 1.095155e-02 3 1  ON 17
ci_019                -2.697766e-03 3 1  ON 18
ci_020                -2.639824e-03 3 1  ON 19
ci_021                -8.313851e-03 3 1  ON 20
ci_022                -7.902648e-03 3 1  ON 21
ci_023                 7.875065e-03 3 1  ON 22
ci_024                 7.927955e-03 3 1  ON 23
ci_025                 4.264464e-03 3 1  ON 24
ci_026                 4.068681e-03 3 1  ON 25
ci_027                 6.445210e-03 3 1  ON 26
ci_028                 6.511131e-03 3 1  ON 27
ci_029                -4.706893e-03 3 1  ON 28
ci_030                -4.528648e-03 3 1  ON 29
ci_031                -8.303482e-03 3 1  ON 30
ci_032                -7.644562e-03 3 1  ON 31
ci_033                 4.590256e-03 3 1  ON 32
ci_034                 4.116606e-03 3 1  ON 33
ci_035                 1.133570e-03 3 1  ON 34
ci_036                 1.227849e-03 3 1  ON 35
ci_037                 5.579942e-03 3 1  ON 36
ci_038                 5.212729e-03 3 1  ON 37
ci_039                 5.095839e-03 3 1  ON 38
ci_040                 5.093285e-03 3 1  ON 39
ci_041                 4.969690e-03 3 1  ON 40
ci_042                 5.065244e-03 3 1  ON 41
ci_043                 4.763668e-03 3 1  ON 42
ci_044                 5.152806e-03 3 1  ON 43
ci_045                 3.009766e-03 3 1  ON 44
ci_046                 3.652487e-03 3 1  ON 45
ci_047                -4.238302e-04 3 1  ON 46
ci_048                -4.264908e-04 3 1  ON 47
ci_049                 1.847518e-03 3 1  ON 48
ci_050                 1.752239e-03 3 1  ON 49
ci_051                -1.413893e-03 3 1  ON 50
ci_052                -1.344272e-03 3 1  ON 51
ci_053                -2.726201e-03 3 1  ON 52
ci_054                -1.752170e-03 3 1  ON 53
ci_055                -1.184635e-03 3 1  ON 54
ci_056                -1.737585e-03 3 1  ON 55
ci_057                -1.558410e-03 3 1  ON 56
ci_058                -1.309538e-03 3 1  ON 57
ci_059                 1.849009e-04 3 1  ON 58
ci_060                 2.229374e-04 3 1  ON 59
ci_061                 1.942151e-04 3 1  ON 60
ci_062                 2.815572e-05 3 1  ON 61
ci_063                -3.321228e-04 3 1  ON 62
ci_064                -1.005959e-03 3 1  ON 63
ci_065                -2.404997e-03 3 1  ON 64
ci_066                -2.351264e-03 3 1  ON 65
ci_067                -2.205841e-03 3 1  ON 66
ci_068                -2.253412e-03 3 1  ON 67
ci_069                 9.821917e-05 3 1  ON 68
ci_070                -2.849934e-04 3 1  ON 69
ci_071                -1.752873e-03 3 1  ON 70
ci_072                -2.610466e-03 3 1  ON 71
ci_073                 5.904874e-04 3 1  ON 72
ci_074                 3.689478e-04 3 1  ON 73
ci_075                -7.244443e-04 3 1  ON 74
ci_076                -3.322159e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="250">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =8000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 24
    time step          = 0.05
    reference energy   = -22.7239
    reference variance = 0.530557
====================================================
  Execution time = 1.0189e+02
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s024
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 62500 
  VMC Eavg = -2.2670e+01
  VMC Evar = 5.1415e-01
  Total weights = 7.8210e+06
  Execution time = 1.4635e+01
  </log>
</opt>
<opt stage="main" walkers="62500">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.498463811133
                                         uncertainty =       0.002326892639

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.498463811133
                                         uncertainty =       0.002326892639

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000249615619
  error estimate for blocks of size 2^( 2) =       0.000258492272
  error estimate for blocks of size 2^( 3) =       0.000266535588
  error estimate for blocks of size 2^( 4) =       0.000272228218
  error estimate for blocks of size 2^( 5) =       0.000275176280
  error estimate for blocks of size 2^( 6) =       0.000276977193
  error estimate for blocks of size 2^( 7) =       0.000278250617
  error estimate for blocks of size 2^( 8) =       0.000278940302
  error estimate for blocks of size 2^( 9) =       0.000279745765

      target function =                  N/A
              le_mean =     -22.669668737476
             les_mean =     514.428297750857
             stat err =       0.000278478469
             autocorr =       1.244628472081
              std dev =       0.706019588476
             le_variance =       0.498463659311

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.498492326083
                                         uncertainty =       0.002326670045

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.498492326083
                                         uncertainty =       0.002326670045

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000249622770
  error estimate for blocks of size 2^( 2) =       0.000258498582
  error estimate for blocks of size 2^( 3) =       0.000266541162
  error estimate for blocks of size 2^( 4) =       0.000272233836
  error estimate for blocks of size 2^( 5) =       0.000275180475
  error estimate for blocks of size 2^( 6) =       0.000276980225
  error estimate for blocks of size 2^( 7) =       0.000278251673
  error estimate for blocks of size 2^( 8) =       0.000278937620
  error estimate for blocks of size 2^( 9) =       0.000279736691

      target function =                  N/A
              le_mean =     -22.669669659867
             les_mean =     514.428221982115
             stat err =       0.000278476552
             autocorr =       1.244540034039
              std dev =       0.706039812651
             le_variance =       0.498492217048

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.498473812547
                                         uncertainty =       0.002326232132

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.498473812547
                                         uncertainty =       0.002326232132

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000249618130
  error estimate for blocks of size 2^( 2) =       0.000258494305
  error estimate for blocks of size 2^( 3) =       0.000266537247
  error estimate for blocks of size 2^( 4) =       0.000272229897
  error estimate for blocks of size 2^( 5) =       0.000275177162
  error estimate for blocks of size 2^( 6) =       0.000276977391
  error estimate for blocks of size 2^( 7) =       0.000278249617
  error estimate for blocks of size 2^( 8) =       0.000278937039
  error estimate for blocks of size 2^( 9) =       0.000279738534

      target function =                  N/A
              le_mean =     -22.669668889713
             les_mean =     514.428047661380
             stat err =       0.000278475645
             autocorr =       1.244578195116
              std dev =       0.706026688881
             le_variance =       0.498473685412

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.498464248155
                                         uncertainty =       0.002326775418

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.498464248155
                                         uncertainty =       0.002326775418

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000249615730
  error estimate for blocks of size 2^( 2) =       0.000258492320
  error estimate for blocks of size 2^( 3) =       0.000266535594
  error estimate for blocks of size 2^( 4) =       0.000272228223
  error estimate for blocks of size 2^( 5) =       0.000275176175
  error estimate for blocks of size 2^( 6) =       0.000276977005
  error estimate for blocks of size 2^( 7) =       0.000278250271
  error estimate for blocks of size 2^( 8) =       0.000278939663
  error estimate for blocks of size 2^( 9) =       0.000279744627

      target function =                  N/A
              le_mean =     -22.669668685390
             les_mean =     514.428275210144
             stat err =       0.000278477891
             autocorr =       1.244622207270
              std dev =       0.706019900226
             le_variance =       0.498464099515


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.669668737476        initial
     5.9605e-01     5.9605e+00             3.2705e-04       -22.669669659867  <--
     2.3842e+00     2.3842e+01             9.1007e-05       -22.669668889713
     9.5367e+00     9.5367e+01             2.3933e-05       -22.669668685390

*****************************************************************************
Applying the update for shift_i =   5.9605e-01     and shift_s =   5.9605e+00
*****************************************************************************

  Execution time = 1.7507e+02
  </log>
  <optVariables href="FORM.s024.opt.xml">
ci_001                -7.050194e-01 3 1  ON 0
ci_002                -7.059040e-01 3 1  ON 1
ci_003                -3.838783e-02 3 1  ON 2
ci_004                -3.985198e-02 3 1  ON 3
ci_005                 1.603823e-02 3 1  ON 4
ci_006                 1.576036e-02 3 1  ON 5
ci_007                 1.241642e-02 3 1  ON 6
ci_008                 1.259770e-02 3 1  ON 7
ci_009                -1.173341e-02 3 1  ON 8
ci_010                -1.162103e-02 3 1  ON 9
ci_011                -8.410744e-03 3 1  ON 10
ci_012                -9.175590e-03 3 1  ON 11
ci_013                 9.679495e-03 3 1  ON 12
ci_014                 9.266717e-03 3 1  ON 13
ci_015                 1.269879e-02 3 1  ON 14
ci_016                 1.314133e-02 3 1  ON 15
ci_017                 1.118463e-02 3 1  ON 16
ci_018                 1.093196e-02 3 1  ON 17
ci_019                -2.672156e-03 3 1  ON 18
ci_020                -2.683422e-03 3 1  ON 19
ci_021                -8.348134e-03 3 1  ON 20
ci_022                -8.067818e-03 3 1  ON 21
ci_023                 7.800819e-03 3 1  ON 22
ci_024                 7.920832e-03 3 1  ON 23
ci_025                 4.243546e-03 3 1  ON 24
ci_026                 4.222049e-03 3 1  ON 25
ci_027                 6.497503e-03 3 1  ON 26
ci_028                 6.423519e-03 3 1  ON 27
ci_029                -4.692820e-03 3 1  ON 28
ci_030                -4.587398e-03 3 1  ON 29
ci_031                -8.274112e-03 3 1  ON 30
ci_032                -7.698243e-03 3 1  ON 31
ci_033                 4.654119e-03 3 1  ON 32
ci_034                 4.130721e-03 3 1  ON 33
ci_035                 1.221917e-03 3 1  ON 34
ci_036                 1.170712e-03 3 1  ON 35
ci_037                 5.580082e-03 3 1  ON 36
ci_038                 5.146944e-03 3 1  ON 37
ci_039                 5.271039e-03 3 1  ON 38
ci_040                 5.189521e-03 3 1  ON 39
ci_041                 4.992075e-03 3 1  ON 40
ci_042                 5.015925e-03 3 1  ON 41
ci_043                 4.769738e-03 3 1  ON 42
ci_044                 5.133834e-03 3 1  ON 43
ci_045                 3.091787e-03 3 1  ON 44
ci_046                 3.597279e-03 3 1  ON 45
ci_047                -4.503405e-04 3 1  ON 46
ci_048                -5.673535e-04 3 1  ON 47
ci_049                 1.827328e-03 3 1  ON 48
ci_050                 1.754238e-03 3 1  ON 49
ci_051                -1.329822e-03 3 1  ON 50
ci_052                -1.271083e-03 3 1  ON 51
ci_053                -2.714408e-03 3 1  ON 52
ci_054                -1.933317e-03 3 1  ON 53
ci_055                -1.278416e-03 3 1  ON 54
ci_056                -1.683722e-03 3 1  ON 55
ci_057                -1.583324e-03 3 1  ON 56
ci_058                -1.235431e-03 3 1  ON 57
ci_059                 2.007214e-04 3 1  ON 58
ci_060                 2.890267e-04 3 1  ON 59
ci_061                 2.651543e-05 3 1  ON 60
ci_062                -6.127579e-05 3 1  ON 61
ci_063                -3.174353e-04 3 1  ON 62
ci_064                -9.266355e-04 3 1  ON 63
ci_065                -2.446683e-03 3 1  ON 64
ci_066                -2.556012e-03 3 1  ON 65
ci_067                -2.271492e-03 3 1  ON 66
ci_068                -2.308023e-03 3 1  ON 67
ci_069                -1.145413e-04 3 1  ON 68
ci_070                -2.656746e-04 3 1  ON 69
ci_071                -1.735699e-03 3 1  ON 70
ci_072                -2.444655e-03 3 1  ON 71
ci_073                 4.609131e-04 3 1  ON 72
ci_074                 3.340393e-04 3 1  ON 73
ci_075                -6.628391e-04 3 1  ON 74
ci_076                -4.321447e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 2.9809e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s025 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s025 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=25  my_counter=0
  time step      = 5.0000e-02
  blocks         = 250
  steps          = 250
  substeps       = 10
  current        = 0
  target samples = 8.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">250</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">6.2500e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">8.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">6.2500e+04</parameter>
<parameter name="steps" condition="int">250</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2671e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="250">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =8000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 25
    time step          = 0.05
    reference energy   = -22.6361
    reference variance = 0.368024
====================================================
  Execution time = 1.0410e+02
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s025
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 62500 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 6.1130e+04
  VMC Eavg = -2.2670e+01
  VMC Evar = 5.1687e-01
  Total weights = 7.820430805e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.8986e+01
  </log>
</opt>
<opt stage="main" walkers="62500">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.497074177700
                                         uncertainty =       0.002742873796

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.497074177700
                                         uncertainty =       0.002742873796

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000249268064
  error estimate for blocks of size 2^( 2) =       0.000258279348
  error estimate for blocks of size 2^( 3) =       0.000266345308
  error estimate for blocks of size 2^( 4) =       0.000272056846
  error estimate for blocks of size 2^( 5) =       0.000275531030
  error estimate for blocks of size 2^( 6) =       0.000277190285
  error estimate for blocks of size 2^( 7) =       0.000278421746
  error estimate for blocks of size 2^( 8) =       0.000278377061
  error estimate for blocks of size 2^( 9) =       0.000278541160

      target function =                  N/A
              le_mean =     -22.669641575837
             les_mean =     514.429521639743
             stat err =       0.000278132563
             autocorr =       1.245002989119
              std dev =       0.705036553331
             le_variance =       0.497076541533


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266964157584e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.4901e-01, overlap shift 1.4901e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.669641575861       residual = 4.92e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.669648890805       residual = 1.78e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.669648940026       residual = 1.24e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.669649043158       residual = 4.21e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 1.4901e-01 is 9.457004e-04

solving harmonic davidson linear method for identity shift 5.9605e-01, overlap shift 5.9605e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.669641575861       residual = 4.92e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.669644534057       residual = 6.48e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.669644455170       residual = 1.72e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.669644460051       residual = 3.38e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 5.9605e-01 is 3.773848e-04

solving harmonic davidson linear method for identity shift 2.3842e+00, overlap shift 2.3842e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.669641575861       residual = 4.92e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.669642450450       residual = 4.96e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.669642418216       residual = 8.94e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 2.3842e+00 is 1.101802e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.054353 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.2310e+02
  </log>
  <optVariables href="FORM.s025.opt.xml">
ci_001                -7.050692e-01 3 1  ON 0
ci_002                -7.058942e-01 3 1  ON 1
ci_003                -3.820637e-02 3 1  ON 2
ci_004                -3.962480e-02 3 1  ON 3
ci_005                 1.610786e-02 3 1  ON 4
ci_006                 1.585426e-02 3 1  ON 5
ci_007                 1.234331e-02 3 1  ON 6
ci_008                 1.257335e-02 3 1  ON 7
ci_009                -1.164984e-02 3 1  ON 8
ci_010                -1.153554e-02 3 1  ON 9
ci_011                -8.255105e-03 3 1  ON 10
ci_012                -8.941126e-03 3 1  ON 11
ci_013                 9.574266e-03 3 1  ON 12
ci_014                 9.232133e-03 3 1  ON 13
ci_015                 1.257014e-02 3 1  ON 14
ci_016                 1.308916e-02 3 1  ON 15
ci_017                 1.113410e-02 3 1  ON 16
ci_018                 1.100793e-02 3 1  ON 17
ci_019                -2.785106e-03 3 1  ON 18
ci_020                -2.660409e-03 3 1  ON 19
ci_021                -8.270313e-03 3 1  ON 20
ci_022                -8.151208e-03 3 1  ON 21
ci_023                 7.699265e-03 3 1  ON 22
ci_024                 7.949198e-03 3 1  ON 23
ci_025                 4.353778e-03 3 1  ON 24
ci_026                 4.254309e-03 3 1  ON 25
ci_027                 6.449782e-03 3 1  ON 26
ci_028                 6.350100e-03 3 1  ON 27
ci_029                -4.778540e-03 3 1  ON 28
ci_030                -4.573864e-03 3 1  ON 29
ci_031                -8.057031e-03 3 1  ON 30
ci_032                -7.889180e-03 3 1  ON 31
ci_033                 4.636542e-03 3 1  ON 32
ci_034                 4.155772e-03 3 1  ON 33
ci_035                 1.184765e-03 3 1  ON 34
ci_036                 1.077456e-03 3 1  ON 35
ci_037                 5.202698e-03 3 1  ON 36
ci_038                 5.066459e-03 3 1  ON 37
ci_039                 5.254771e-03 3 1  ON 38
ci_040                 5.176753e-03 3 1  ON 39
ci_041                 4.987579e-03 3 1  ON 40
ci_042                 5.013965e-03 3 1  ON 41
ci_043                 4.716934e-03 3 1  ON 42
ci_044                 5.091066e-03 3 1  ON 43
ci_045                 3.145659e-03 3 1  ON 44
ci_046                 3.665084e-03 3 1  ON 45
ci_047                -6.384103e-04 3 1  ON 46
ci_048                -6.060559e-04 3 1  ON 47
ci_049                 1.825627e-03 3 1  ON 48
ci_050                 1.679867e-03 3 1  ON 49
ci_051                -1.233048e-03 3 1  ON 50
ci_052                -1.144815e-03 3 1  ON 51
ci_053                -2.806205e-03 3 1  ON 52
ci_054                -1.857552e-03 3 1  ON 53
ci_055                -1.239850e-03 3 1  ON 54
ci_056                -1.653327e-03 3 1  ON 55
ci_057                -1.313083e-03 3 1  ON 56
ci_058                -1.330064e-03 3 1  ON 57
ci_059                 2.710651e-04 3 1  ON 58
ci_060                 2.577104e-04 3 1  ON 59
ci_061                 7.041766e-05 3 1  ON 60
ci_062                 3.369163e-05 3 1  ON 61
ci_063                -6.010820e-04 3 1  ON 62
ci_064                -1.008278e-03 3 1  ON 63
ci_065                -2.330444e-03 3 1  ON 64
ci_066                -2.628448e-03 3 1  ON 65
ci_067                -2.118504e-03 3 1  ON 66
ci_068                -2.369110e-03 3 1  ON 67
ci_069                 2.337872e-05 3 1  ON 68
ci_070                -8.788234e-05 3 1  ON 69
ci_071                -1.630471e-03 3 1  ON 70
ci_072                -2.336169e-03 3 1  ON 71
ci_073                 3.859513e-04 3 1  ON 72
ci_074                 2.992893e-04 3 1  ON 73
ci_075                -6.501782e-04 3 1  ON 74
ci_076                -4.025068e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="250">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =8000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 25
    time step          = 0.05
    reference energy   = -22.6568
    reference variance = 0.530602
====================================================
  Execution time = 1.0188e+02
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s025
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 62500 
  VMC Eavg = -2.2670e+01
  VMC Evar = 5.0855e-01
  Total weights = 7.8209e+06
  Execution time = 1.4644e+01
  </log>
</opt>
<opt stage="main" walkers="62500">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.495645072720
                                         uncertainty =       0.001567157194

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.495645072720
                                         uncertainty =       0.001567157194

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000248908747
  error estimate for blocks of size 2^( 2) =       0.000257825814
  error estimate for blocks of size 2^( 3) =       0.000265875398
  error estimate for blocks of size 2^( 4) =       0.000271474062
  error estimate for blocks of size 2^( 5) =       0.000275030491
  error estimate for blocks of size 2^( 6) =       0.000276468942
  error estimate for blocks of size 2^( 7) =       0.000277464472
  error estimate for blocks of size 2^( 8) =       0.000277619953
  error estimate for blocks of size 2^( 9) =       0.000277760850

      target function =                  N/A
              le_mean =     -22.669551189864
             les_mean =     514.436365750568
             stat err =       0.000277328554
             autocorr =       1.241391758464
              std dev =       0.704020252303
             le_variance =       0.495644515652

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.495616015179
                                         uncertainty =       0.001572669017

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.495616015179
                                         uncertainty =       0.001572669017

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000248901450
  error estimate for blocks of size 2^( 2) =       0.000257816716
  error estimate for blocks of size 2^( 3) =       0.000265865581
  error estimate for blocks of size 2^( 4) =       0.000271463102
  error estimate for blocks of size 2^( 5) =       0.000275013579
  error estimate for blocks of size 2^( 6) =       0.000276449896
  error estimate for blocks of size 2^( 7) =       0.000277433403
  error estimate for blocks of size 2^( 8) =       0.000277589340
  error estimate for blocks of size 2^( 9) =       0.000277736341

      target function =                  N/A
              le_mean =     -22.669551815466
             les_mean =     514.435184051023
             stat err =       0.000277302245
             autocorr =       1.241229013017
              std dev =       0.703999612719
             le_variance =       0.495615454708

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.495613699014
                                         uncertainty =       0.001570673559

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.495613699014
                                         uncertainty =       0.001570673559

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000248900870
  error estimate for blocks of size 2^( 2) =       0.000257816846
  error estimate for blocks of size 2^( 3) =       0.000265865792
  error estimate for blocks of size 2^( 4) =       0.000271463585
  error estimate for blocks of size 2^( 5) =       0.000275016939
  error estimate for blocks of size 2^( 6) =       0.000276454657
  error estimate for blocks of size 2^( 7) =       0.000277448371
  error estimate for blocks of size 2^( 8) =       0.000277602045
  error estimate for blocks of size 2^( 9) =       0.000277756482

      target function =                  N/A
              le_mean =     -22.669550145326
             les_mean =     514.419940885732
             stat err =       0.000277315389
             autocorr =       1.241352470393
              std dev =       0.703997970938
             le_variance =       0.495613143084

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.495633862407
                                         uncertainty =       0.001567669422

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.495633862407
                                         uncertainty =       0.001567669422

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000248905933
  error estimate for blocks of size 2^( 2) =       0.000257822788
  error estimate for blocks of size 2^( 3) =       0.000265872613
  error estimate for blocks of size 2^( 4) =       0.000271470997
  error estimate for blocks of size 2^( 5) =       0.000275026797
  error estimate for blocks of size 2^( 6) =       0.000276464848
  error estimate for blocks of size 2^( 7) =       0.000277459666
  error estimate for blocks of size 2^( 8) =       0.000277614698
  error estimate for blocks of size 2^( 9) =       0.000277758146

      target function =                  N/A
              le_mean =     -22.669549529955
             les_mean =     514.419880547719
             stat err =       0.000277324339
             autocorr =       1.241382099911
              std dev =       0.704012291033
             le_variance =       0.495633305926


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.669551189864        initial
     1.4901e-01     1.4901e+00             9.4570e-04       -22.669551815466  <--
     5.9605e-01     5.9605e+00             3.7738e-04       -22.669550145326
     2.3842e+00     2.3842e+01             1.1018e-04       -22.669549529955

*****************************************************************************
Applying the update for shift_i =   1.4901e-01     and shift_s =   1.4901e+00
*****************************************************************************

  Execution time = 1.7514e+02
  </log>
  <optVariables href="FORM.s025.opt.xml">
ci_001                -7.051778e-01 3 1  ON 0
ci_002                -7.058629e-01 3 1  ON 1
ci_003                -3.781193e-02 3 1  ON 2
ci_004                -3.911470e-02 3 1  ON 3
ci_005                 1.619658e-02 3 1  ON 4
ci_006                 1.596053e-02 3 1  ON 5
ci_007                 1.223677e-02 3 1  ON 6
ci_008                 1.252229e-02 3 1  ON 7
ci_009                -1.154748e-02 3 1  ON 8
ci_010                -1.141995e-02 3 1  ON 9
ci_011                -8.000007e-03 3 1  ON 10
ci_012                -8.574910e-03 3 1  ON 11
ci_013                 9.340084e-03 3 1  ON 12
ci_014                 9.178371e-03 3 1  ON 13
ci_015                 1.233763e-02 3 1  ON 14
ci_016                 1.301147e-02 3 1  ON 15
ci_017                 1.105740e-02 3 1  ON 16
ci_018                 1.115316e-02 3 1  ON 17
ci_019                -3.009431e-03 3 1  ON 18
ci_020                -2.617977e-03 3 1  ON 19
ci_021                -8.180202e-03 3 1  ON 20
ci_022                -8.277055e-03 3 1  ON 21
ci_023                 7.569469e-03 3 1  ON 22
ci_024                 7.987737e-03 3 1  ON 23
ci_025                 4.555251e-03 3 1  ON 24
ci_026                 4.308300e-03 3 1  ON 25
ci_027                 6.398009e-03 3 1  ON 26
ci_028                 6.268401e-03 3 1  ON 27
ci_029                -4.919504e-03 3 1  ON 28
ci_030                -4.539919e-03 3 1  ON 29
ci_031                -7.705432e-03 3 1  ON 30
ci_032                -8.193983e-03 3 1  ON 31
ci_033                 4.599845e-03 3 1  ON 32
ci_034                 4.186794e-03 3 1  ON 33
ci_035                 1.134126e-03 3 1  ON 34
ci_036                 9.678974e-04 3 1  ON 35
ci_037                 4.634382e-03 3 1  ON 36
ci_038                 4.945490e-03 3 1  ON 37
ci_039                 5.239425e-03 3 1  ON 38
ci_040                 5.162648e-03 3 1  ON 39
ci_041                 4.986352e-03 3 1  ON 40
ci_042                 5.009836e-03 3 1  ON 41
ci_043                 4.627582e-03 3 1  ON 42
ci_044                 4.998582e-03 3 1  ON 43
ci_045                 3.229346e-03 3 1  ON 44
ci_046                 3.758944e-03 3 1  ON 45
ci_047                -8.315990e-04 3 1  ON 46
ci_048                -6.481538e-04 3 1  ON 47
ci_049                 1.818709e-03 3 1  ON 48
ci_050                 1.571563e-03 3 1  ON 49
ci_051                -1.099884e-03 3 1  ON 50
ci_052                -9.645566e-04 3 1  ON 51
ci_053                -2.958869e-03 3 1  ON 52
ci_054                -1.762118e-03 3 1  ON 53
ci_055                -1.210400e-03 3 1  ON 54
ci_056                -1.601879e-03 3 1  ON 55
ci_057                -9.536349e-04 3 1  ON 56
ci_058                -1.455871e-03 3 1  ON 57
ci_059                 3.508277e-04 3 1  ON 58
ci_060                 2.206838e-04 3 1  ON 59
ci_061                 1.303125e-04 3 1  ON 60
ci_062                 1.641994e-04 3 1  ON 61
ci_063                -1.033122e-03 3 1  ON 62
ci_064                -1.133691e-03 3 1  ON 63
ci_065                -2.158852e-03 3 1  ON 64
ci_066                -2.738104e-03 3 1  ON 65
ci_067                -1.895937e-03 3 1  ON 66
ci_068                -2.465610e-03 3 1  ON 67
ci_069                 2.149345e-04 3 1  ON 68
ci_070                 1.608034e-04 3 1  ON 69
ci_071                -1.485545e-03 3 1  ON 70
ci_072                -2.191527e-03 3 1  ON 71
ci_073                 3.013498e-04 3 1  ON 72
ci_074                 2.622649e-04 3 1  ON 73
ci_075                -6.376526e-04 3 1  ON 74
ci_076                -3.675492e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 2.9826e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s026 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s026 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=26  my_counter=0
  time step      = 5.0000e-02
  blocks         = 250
  steps          = 250
  substeps       = 10
  current        = 0
  target samples = 8.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">250</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">6.2500e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">8.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">6.2500e+04</parameter>
<parameter name="steps" condition="int">250</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2670e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="250">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =8000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 26
    time step          = 0.05
    reference energy   = -22.6401
    reference variance = 0.397825
====================================================
  Execution time = 1.0396e+02
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s026
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 62500 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 6.1060e+04
  VMC Eavg = -2.2670e+01
  VMC Evar = 5.0935e-01
  Total weights = 7.820462909e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.8834e+01
  </log>
</opt>
<opt stage="main" walkers="62500">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.496529944493
                                         uncertainty =       0.001460465330

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.496529944493
                                         uncertainty =       0.001460465330

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000249130299
  error estimate for blocks of size 2^( 2) =       0.000258048895
  error estimate for blocks of size 2^( 3) =       0.000266148678
  error estimate for blocks of size 2^( 4) =       0.000271899430
  error estimate for blocks of size 2^( 5) =       0.000275245125
  error estimate for blocks of size 2^( 6) =       0.000277382744
  error estimate for blocks of size 2^( 7) =       0.000278139826
  error estimate for blocks of size 2^( 8) =       0.000279252464
  error estimate for blocks of size 2^( 9) =       0.000280058227

      target function =                  N/A
              le_mean =     -22.669519608127
             les_mean =     514.416470322373
             stat err =       0.000278708315
             autocorr =       1.251545819136
              std dev =       0.704646894985
             le_variance =       0.496527246613


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266951960813e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.7253e-02, overlap shift 3.7253e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.669519608151       residual = 3.73e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.669527300490       residual = 1.47e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.669528308241       residual = 1.55e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.669528540082       residual = 5.67e-08           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.669528344605       residual = 2.73e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.669528491216       residual = 5.21e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          5 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 3.7253e-02 is 1.016412e-03

solving harmonic davidson linear method for identity shift 1.4901e-01, overlap shift 1.4901e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.669519608151       residual = 3.73e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.669524477238       residual = 6.51e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.669524852774       residual = 3.46e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.669524932314       residual = 3.00e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 1.4901e-01 is 6.378027e-04

solving harmonic davidson linear method for identity shift 5.9605e-01, overlap shift 5.9605e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.669519608151       residual = 3.73e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.669521580969       residual = 3.73e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.669521645911       residual = 1.33e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.669521665535       residual = 3.69e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 5.9605e-01 is 2.565360e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.055942 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.2281e+02
  </log>
  <optVariables href="FORM.s026.opt.xml">
ci_001                -7.050354e-01 3 1  ON 0
ci_002                -7.060302e-01 3 1  ON 1
ci_003                -3.763651e-02 3 1  ON 2
ci_004                -3.907514e-02 3 1  ON 3
ci_005                 1.605211e-02 3 1  ON 4
ci_006                 1.583447e-02 3 1  ON 5
ci_007                 1.249399e-02 3 1  ON 6
ci_008                 1.249914e-02 3 1  ON 7
ci_009                -1.174711e-02 3 1  ON 8
ci_010                -1.180494e-02 3 1  ON 9
ci_011                -8.221810e-03 3 1  ON 10
ci_012                -8.556877e-03 3 1  ON 11
ci_013                 9.504524e-03 3 1  ON 12
ci_014                 9.336881e-03 3 1  ON 13
ci_015                 1.218289e-02 3 1  ON 14
ci_016                 1.242251e-02 3 1  ON 15
ci_017                 1.050643e-02 3 1  ON 16
ci_018                 1.085104e-02 3 1  ON 17
ci_019                -2.724922e-03 3 1  ON 18
ci_020                -2.435066e-03 3 1  ON 19
ci_021                -8.534846e-03 3 1  ON 20
ci_022                -8.488619e-03 3 1  ON 21
ci_023                 7.735649e-03 3 1  ON 22
ci_024                 7.786413e-03 3 1  ON 23
ci_025                 4.835834e-03 3 1  ON 24
ci_026                 4.281480e-03 3 1  ON 25
ci_027                 6.719812e-03 3 1  ON 26
ci_028                 6.140018e-03 3 1  ON 27
ci_029                -4.867217e-03 3 1  ON 28
ci_030                -4.466327e-03 3 1  ON 29
ci_031                -7.193125e-03 3 1  ON 30
ci_032                -8.277940e-03 3 1  ON 31
ci_033                 4.696730e-03 3 1  ON 32
ci_034                 4.151320e-03 3 1  ON 33
ci_035                 1.172858e-03 3 1  ON 34
ci_036                 1.022658e-03 3 1  ON 35
ci_037                 4.998495e-03 3 1  ON 36
ci_038                 4.995126e-03 3 1  ON 37
ci_039                 5.273538e-03 3 1  ON 38
ci_040                 5.420513e-03 3 1  ON 39
ci_041                 4.791478e-03 3 1  ON 40
ci_042                 5.050640e-03 3 1  ON 41
ci_043                 4.999187e-03 3 1  ON 42
ci_044                 4.783196e-03 3 1  ON 43
ci_045                 3.060514e-03 3 1  ON 44
ci_046                 3.121142e-03 3 1  ON 45
ci_047                -7.599321e-04 3 1  ON 46
ci_048                -5.003525e-04 3 1  ON 47
ci_049                 1.503238e-03 3 1  ON 48
ci_050                 1.500390e-03 3 1  ON 49
ci_051                -8.871912e-04 3 1  ON 50
ci_052                -9.731063e-04 3 1  ON 51
ci_053                -2.760022e-03 3 1  ON 52
ci_054                -2.029706e-03 3 1  ON 53
ci_055                -1.157807e-03 3 1  ON 54
ci_056                -1.352779e-03 3 1  ON 55
ci_057                -1.161645e-03 3 1  ON 56
ci_058                -1.569067e-03 3 1  ON 57
ci_059                 2.624127e-04 3 1  ON 58
ci_060                 4.004386e-05 3 1  ON 59
ci_061                -3.413318e-04 3 1  ON 60
ci_062                 6.188906e-05 3 1  ON 61
ci_063                -6.234501e-04 3 1  ON 62
ci_064                -8.161482e-04 3 1  ON 63
ci_065                -2.279649e-03 3 1  ON 64
ci_066                -2.620646e-03 3 1  ON 65
ci_067                -1.837288e-03 3 1  ON 66
ci_068                -2.556500e-03 3 1  ON 67
ci_069                -2.243594e-04 3 1  ON 68
ci_070                 1.443053e-04 3 1  ON 69
ci_071                -1.652243e-03 3 1  ON 70
ci_072                -1.997353e-03 3 1  ON 71
ci_073                 3.976759e-04 3 1  ON 72
ci_074                 4.975746e-04 3 1  ON 73
ci_075                -2.325691e-04 3 1  ON 74
ci_076                -3.955375e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="250">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =8000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 26
    time step          = 0.05
    reference energy   = -22.6009
    reference variance = 0.482971
====================================================
  Execution time = 1.0209e+02
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s026
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 62500 
  VMC Eavg = -2.2669e+01
  VMC Evar = 5.0987e-01
  Total weights = 7.8207e+06
  Execution time = 1.4634e+01
  </log>
</opt>
<opt stage="main" walkers="62500">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.496409529484
                                         uncertainty =       0.001426219080

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.496409529484
                                         uncertainty =       0.001426219080

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000249100909
  error estimate for blocks of size 2^( 2) =       0.000257932767
  error estimate for blocks of size 2^( 3) =       0.000266025329
  error estimate for blocks of size 2^( 4) =       0.000271848629
  error estimate for blocks of size 2^( 5) =       0.000274930790
  error estimate for blocks of size 2^( 6) =       0.000276427143
  error estimate for blocks of size 2^( 7) =       0.000277700964
  error estimate for blocks of size 2^( 8) =       0.000277870680
  error estimate for blocks of size 2^( 9) =       0.000277705290

      target function =                  N/A
              le_mean =     -22.669321455656
             les_mean =     514.421890602863
             stat err =       0.000277426019
             autocorr =       1.240348584139
              std dev =       0.704563767989
             le_variance =       0.496410103163

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.496252680904
                                         uncertainty =       0.001424656063

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.496252680904
                                         uncertainty =       0.001424656063

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000249061539
  error estimate for blocks of size 2^( 2) =       0.000257896187
  error estimate for blocks of size 2^( 3) =       0.000265990327
  error estimate for blocks of size 2^( 4) =       0.000271818636
  error estimate for blocks of size 2^( 5) =       0.000274898317
  error estimate for blocks of size 2^( 6) =       0.000276395028
  error estimate for blocks of size 2^( 7) =       0.000277672988
  error estimate for blocks of size 2^( 8) =       0.000277835407
  error estimate for blocks of size 2^( 9) =       0.000277703233

      target function =                  N/A
              le_mean =     -22.669319730698
             les_mean =     514.413981683104
             stat err =       0.000277401664
             autocorr =       1.240522911148
              std dev =       0.704452412503
             le_variance =       0.496253201481

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.496316135213
                                         uncertainty =       0.001423043078

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.496316135213
                                         uncertainty =       0.001423043078

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000249077442
  error estimate for blocks of size 2^( 2) =       0.000257911657
  error estimate for blocks of size 2^( 3) =       0.000266004852
  error estimate for blocks of size 2^( 4) =       0.000271837132
  error estimate for blocks of size 2^( 5) =       0.000274918684
  error estimate for blocks of size 2^( 6) =       0.000276411524
  error estimate for blocks of size 2^( 7) =       0.000277702200
  error estimate for blocks of size 2^( 8) =       0.000277867061
  error estimate for blocks of size 2^( 9) =       0.000277747150

      target function =                  N/A
              le_mean =     -22.669327118976
             les_mean =     514.437373997925
             stat err =       0.000277431984
             autocorr =       1.240635658005
              std dev =       0.704497393982
             le_variance =       0.496316578127

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.496335242316
                                         uncertainty =       0.001427615651

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.496335242316
                                         uncertainty =       0.001427615651

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000249082265
  error estimate for blocks of size 2^( 2) =       0.000257915060
  error estimate for blocks of size 2^( 3) =       0.000266008284
  error estimate for blocks of size 2^( 4) =       0.000271832328
  error estimate for blocks of size 2^( 5) =       0.000274914268
  error estimate for blocks of size 2^( 6) =       0.000276409193
  error estimate for blocks of size 2^( 7) =       0.000277683796
  error estimate for blocks of size 2^( 8) =       0.000277851933
  error estimate for blocks of size 2^( 9) =       0.000277696450

      target function =                  N/A
              le_mean =     -22.669317150607
             les_mean =     514.408993151276
             stat err =       0.000277410343
             autocorr =       1.240394082791
              std dev =       0.704511034843
             le_variance =       0.496335798215


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.669321455656        initial
     3.7253e-02     3.7253e-01             1.0164e-03       -22.669319730698
     1.4901e-01     1.4901e+00             6.3780e-04       -22.669327118976  <--
     5.9605e-01     5.9605e+00             2.5654e-04       -22.669317150607

*****************************************************************************
Applying the update for shift_i =   1.4901e-01     and shift_s =   1.4901e+00
*****************************************************************************

  Execution time = 1.7524e+02
  </log>
  <optVariables href="FORM.s026.opt.xml">
ci_001                -7.050354e-01 3 1  ON 0
ci_002                -7.060302e-01 3 1  ON 1
ci_003                -3.763651e-02 3 1  ON 2
ci_004                -3.907514e-02 3 1  ON 3
ci_005                 1.605211e-02 3 1  ON 4
ci_006                 1.583447e-02 3 1  ON 5
ci_007                 1.249399e-02 3 1  ON 6
ci_008                 1.249914e-02 3 1  ON 7
ci_009                -1.174711e-02 3 1  ON 8
ci_010                -1.180494e-02 3 1  ON 9
ci_011                -8.221810e-03 3 1  ON 10
ci_012                -8.556877e-03 3 1  ON 11
ci_013                 9.504524e-03 3 1  ON 12
ci_014                 9.336881e-03 3 1  ON 13
ci_015                 1.218289e-02 3 1  ON 14
ci_016                 1.242251e-02 3 1  ON 15
ci_017                 1.050643e-02 3 1  ON 16
ci_018                 1.085104e-02 3 1  ON 17
ci_019                -2.724922e-03 3 1  ON 18
ci_020                -2.435066e-03 3 1  ON 19
ci_021                -8.534846e-03 3 1  ON 20
ci_022                -8.488619e-03 3 1  ON 21
ci_023                 7.735649e-03 3 1  ON 22
ci_024                 7.786413e-03 3 1  ON 23
ci_025                 4.835834e-03 3 1  ON 24
ci_026                 4.281480e-03 3 1  ON 25
ci_027                 6.719812e-03 3 1  ON 26
ci_028                 6.140018e-03 3 1  ON 27
ci_029                -4.867217e-03 3 1  ON 28
ci_030                -4.466327e-03 3 1  ON 29
ci_031                -7.193125e-03 3 1  ON 30
ci_032                -8.277940e-03 3 1  ON 31
ci_033                 4.696730e-03 3 1  ON 32
ci_034                 4.151320e-03 3 1  ON 33
ci_035                 1.172858e-03 3 1  ON 34
ci_036                 1.022658e-03 3 1  ON 35
ci_037                 4.998495e-03 3 1  ON 36
ci_038                 4.995126e-03 3 1  ON 37
ci_039                 5.273538e-03 3 1  ON 38
ci_040                 5.420513e-03 3 1  ON 39
ci_041                 4.791478e-03 3 1  ON 40
ci_042                 5.050640e-03 3 1  ON 41
ci_043                 4.999187e-03 3 1  ON 42
ci_044                 4.783196e-03 3 1  ON 43
ci_045                 3.060514e-03 3 1  ON 44
ci_046                 3.121142e-03 3 1  ON 45
ci_047                -7.599321e-04 3 1  ON 46
ci_048                -5.003525e-04 3 1  ON 47
ci_049                 1.503238e-03 3 1  ON 48
ci_050                 1.500390e-03 3 1  ON 49
ci_051                -8.871912e-04 3 1  ON 50
ci_052                -9.731063e-04 3 1  ON 51
ci_053                -2.760022e-03 3 1  ON 52
ci_054                -2.029706e-03 3 1  ON 53
ci_055                -1.157807e-03 3 1  ON 54
ci_056                -1.352779e-03 3 1  ON 55
ci_057                -1.161645e-03 3 1  ON 56
ci_058                -1.569067e-03 3 1  ON 57
ci_059                 2.624127e-04 3 1  ON 58
ci_060                 4.004386e-05 3 1  ON 59
ci_061                -3.413318e-04 3 1  ON 60
ci_062                 6.188906e-05 3 1  ON 61
ci_063                -6.234501e-04 3 1  ON 62
ci_064                -8.161482e-04 3 1  ON 63
ci_065                -2.279649e-03 3 1  ON 64
ci_066                -2.620646e-03 3 1  ON 65
ci_067                -1.837288e-03 3 1  ON 66
ci_068                -2.556500e-03 3 1  ON 67
ci_069                -2.243594e-04 3 1  ON 68
ci_070                 1.443053e-04 3 1  ON 69
ci_071                -1.652243e-03 3 1  ON 70
ci_072                -1.997353e-03 3 1  ON 71
ci_073                 3.976759e-04 3 1  ON 72
ci_074                 4.975746e-04 3 1  ON 73
ci_075                -2.325691e-04 3 1  ON 74
ci_076                -3.955375e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 2.9808e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s027 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s027 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=27  my_counter=0
  time step      = 5.0000e-02
  blocks         = 250
  steps          = 250
  substeps       = 10
  current        = 0
  target samples = 8.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">250</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">6.2500e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">8.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">6.2500e+04</parameter>
<parameter name="steps" condition="int">250</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2668e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="250">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =8000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 27
    time step          = 0.05
    reference energy   = -22.5979
    reference variance = 0.463518
====================================================
  Execution time = 1.0401e+02
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s027
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 62500 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 6.1101e+04
  VMC Eavg = -2.2670e+01
  VMC Evar = 5.1157e-01
  Total weights = 7.820853452e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.9041e+01
  </log>
</opt>
<opt stage="main" walkers="62500">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.498097726315
                                         uncertainty =       0.001641607504

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.498097726315
                                         uncertainty =       0.001641607504

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000249524262
  error estimate for blocks of size 2^( 2) =       0.000258395631
  error estimate for blocks of size 2^( 3) =       0.000266654473
  error estimate for blocks of size 2^( 4) =       0.000272518711
  error estimate for blocks of size 2^( 5) =       0.000276190802
  error estimate for blocks of size 2^( 6) =       0.000278018325
  error estimate for blocks of size 2^( 7) =       0.000279211592
  error estimate for blocks of size 2^( 8) =       0.000278752892
  error estimate for blocks of size 2^( 9) =       0.000279914773

      target function =                  N/A
              le_mean =     -22.669516818592
             les_mean =     514.418559830573
             stat err =       0.000278974396
             autocorr =       1.249980194066
              std dev =       0.705761190644
             le_variance =       0.498098858219


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266951681859e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.7253e-02, overlap shift 3.7253e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.669516818617       residual = 4.68e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.669522480952       residual = 2.38e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.669523605832       residual = 3.29e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.669523353654       residual = 9.31e-08           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.669523358763       residual = 2.83e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.669523280275       residual = 1.05e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.669523205745       residual = 2.56e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 3.7253e-02 is 1.396659e-03

solving harmonic davidson linear method for identity shift 1.4901e-01, overlap shift 1.4901e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.669516818617       residual = 4.68e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.669520522656       residual = 1.02e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.669520909617       residual = 4.99e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.669520850700       residual = 3.01e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 1.4901e-01 is 8.413353e-04

solving harmonic davidson linear method for identity shift 5.9605e-01, overlap shift 5.9605e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.669516818617       residual = 4.68e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.669518372725       residual = 3.90e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.669518418897       residual = 1.10e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.669518416998       residual = 3.45e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 5.9605e-01 is 3.234974e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.057634 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.2307e+02
  </log>
  <optVariables href="FORM.s027.opt.xml">
ci_001                -7.051618e-01 3 1  ON 0
ci_002                -7.058648e-01 3 1  ON 1
ci_003                -3.809926e-02 3 1  ON 2
ci_004                -3.886706e-02 3 1  ON 3
ci_005                 1.618494e-02 3 1  ON 4
ci_006                 1.598126e-02 3 1  ON 5
ci_007                 1.226483e-02 3 1  ON 6
ci_008                 1.261055e-02 3 1  ON 7
ci_009                -1.184739e-02 3 1  ON 8
ci_010                -1.182544e-02 3 1  ON 9
ci_011                -8.311604e-03 3 1  ON 10
ci_012                -7.715541e-03 3 1  ON 11
ci_013                 9.524403e-03 3 1  ON 12
ci_014                 9.115640e-03 3 1  ON 13
ci_015                 1.232121e-02 3 1  ON 14
ci_016                 1.255057e-02 3 1  ON 15
ci_017                 1.068177e-02 3 1  ON 16
ci_018                 1.114250e-02 3 1  ON 17
ci_019                -2.673337e-03 3 1  ON 18
ci_020                -2.544225e-03 3 1  ON 19
ci_021                -8.603104e-03 3 1  ON 20
ci_022                -8.714100e-03 3 1  ON 21
ci_023                 8.125065e-03 3 1  ON 22
ci_024                 8.226936e-03 3 1  ON 23
ci_025                 4.478838e-03 3 1  ON 24
ci_026                 4.540108e-03 3 1  ON 25
ci_027                 6.619315e-03 3 1  ON 26
ci_028                 6.568542e-03 3 1  ON 27
ci_029                -4.884243e-03 3 1  ON 28
ci_030                -4.943569e-03 3 1  ON 29
ci_031                -7.288181e-03 3 1  ON 30
ci_032                -8.049400e-03 3 1  ON 31
ci_033                 4.919837e-03 3 1  ON 32
ci_034                 4.275679e-03 3 1  ON 33
ci_035                 1.139201e-03 3 1  ON 34
ci_036                 9.218949e-04 3 1  ON 35
ci_037                 4.802785e-03 3 1  ON 36
ci_038                 4.986637e-03 3 1  ON 37
ci_039                 5.084527e-03 3 1  ON 38
ci_040                 5.184122e-03 3 1  ON 39
ci_041                 5.000814e-03 3 1  ON 40
ci_042                 4.887098e-03 3 1  ON 41
ci_043                 4.916469e-03 3 1  ON 42
ci_044                 4.997805e-03 3 1  ON 43
ci_045                 2.778762e-03 3 1  ON 44
ci_046                 3.021038e-03 3 1  ON 45
ci_047                -6.079216e-04 3 1  ON 46
ci_048                -4.849746e-04 3 1  ON 47
ci_049                 1.717167e-03 3 1  ON 48
ci_050                 2.185119e-03 3 1  ON 49
ci_051                -1.257173e-03 3 1  ON 50
ci_052                -1.405659e-03 3 1  ON 51
ci_053                -2.609538e-03 3 1  ON 52
ci_054                -2.364899e-03 3 1  ON 53
ci_055                -1.504791e-03 3 1  ON 54
ci_056                -1.313837e-03 3 1  ON 55
ci_057                -1.217784e-03 3 1  ON 56
ci_058                -1.764475e-03 3 1  ON 57
ci_059                 6.492029e-04 3 1  ON 58
ci_060                 4.630368e-05 3 1  ON 59
ci_061                -4.697393e-04 3 1  ON 60
ci_062                -1.225324e-04 3 1  ON 61
ci_063                -6.750412e-04 3 1  ON 62
ci_064                -1.019340e-03 3 1  ON 63
ci_065                -2.606359e-03 3 1  ON 64
ci_066                -2.638110e-03 3 1  ON 65
ci_067                -2.366663e-03 3 1  ON 66
ci_068                -2.377807e-03 3 1  ON 67
ci_069                -1.810604e-04 3 1  ON 68
ci_070                -5.756947e-05 3 1  ON 69
ci_071                -2.208500e-03 3 1  ON 70
ci_072                -1.725164e-03 3 1  ON 71
ci_073                 6.132575e-04 3 1  ON 72
ci_074                 1.232589e-04 3 1  ON 73
ci_075                -2.929389e-04 3 1  ON 74
ci_076                -3.826256e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="250">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =8000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 27
    time step          = 0.05
    reference energy   = -22.6546
    reference variance = 0.364492
====================================================
  Execution time = 1.0186e+02
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s027
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 62500 
  VMC Eavg = -2.2670e+01
  VMC Evar = 5.0783e-01
  Total weights = 7.8204e+06
  Execution time = 1.4674e+01
  </log>
</opt>
<opt stage="main" walkers="62500">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.495017476000
                                         uncertainty =       0.001438554425

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.495017476000
                                         uncertainty =       0.001438554425

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000248751699
  error estimate for blocks of size 2^( 2) =       0.000257693285
  error estimate for blocks of size 2^( 3) =       0.000265665651
  error estimate for blocks of size 2^( 4) =       0.000271248124
  error estimate for blocks of size 2^( 5) =       0.000274719282
  error estimate for blocks of size 2^( 6) =       0.000276342269
  error estimate for blocks of size 2^( 7) =       0.000276993581
  error estimate for blocks of size 2^( 8) =       0.000277502487
  error estimate for blocks of size 2^( 9) =       0.000279113250

      target function =                  N/A
              le_mean =     -22.669968062184
             les_mean =     514.475786655189
             stat err =       0.000277487897
             autocorr =       1.244388472865
              std dev =       0.703576052386
             le_variance =       0.495019261491

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.495085388869
                                         uncertainty =       0.001445206480

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.495085388869
                                         uncertainty =       0.001445206480

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000248768718
  error estimate for blocks of size 2^( 2) =       0.000257707069
  error estimate for blocks of size 2^( 3) =       0.000265677025
  error estimate for blocks of size 2^( 4) =       0.000271260070
  error estimate for blocks of size 2^( 5) =       0.000274726917
  error estimate for blocks of size 2^( 6) =       0.000276341429
  error estimate for blocks of size 2^( 7) =       0.000276990530
  error estimate for blocks of size 2^( 8) =       0.000277487091
  error estimate for blocks of size 2^( 9) =       0.000279121785

      target function =                  N/A
              le_mean =     -22.669966806553
             les_mean =     514.443453984559
             stat err =       0.000277485209
             autocorr =       1.244194103555
              std dev =       0.703624190672
             le_variance =       0.495087001698

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.495200067344
                                         uncertainty =       0.001450557769

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.495200067344
                                         uncertainty =       0.001450557769

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000248797512
  error estimate for blocks of size 2^( 2) =       0.000257734103
  error estimate for blocks of size 2^( 3) =       0.000265702669
  error estimate for blocks of size 2^( 4) =       0.000271283074
  error estimate for blocks of size 2^( 5) =       0.000274749116
  error estimate for blocks of size 2^( 6) =       0.000276364693
  error estimate for blocks of size 2^( 7) =       0.000277011651
  error estimate for blocks of size 2^( 8) =       0.000277505357
  error estimate for blocks of size 2^( 9) =       0.000279144409

      target function =                  N/A
              le_mean =     -22.669971983902
             les_mean =     514.441359254449
             stat err =       0.000277506527
             autocorr =       1.244097273633
              std dev =       0.703705632778
             le_variance =       0.495201617604

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.495362156184
                                         uncertainty =       0.001457928583

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.495362156184
                                         uncertainty =       0.001457928583

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000248838215
  error estimate for blocks of size 2^( 2) =       0.000257775288
  error estimate for blocks of size 2^( 3) =       0.000265742790
  error estimate for blocks of size 2^( 4) =       0.000271322740
  error estimate for blocks of size 2^( 5) =       0.000274785128
  error estimate for blocks of size 2^( 6) =       0.000276398373
  error estimate for blocks of size 2^( 7) =       0.000277052987
  error estimate for blocks of size 2^( 8) =       0.000277568227
  error estimate for blocks of size 2^( 9) =       0.000279190718

      target function =                  N/A
              le_mean =     -22.669973848421
             les_mean =     515.347970199634
             stat err =       0.000277552576
             autocorr =       1.244103098976
              std dev =       0.703820756214
             le_variance =       0.495363656878


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.669968062184        initial
     3.7253e-02     3.7253e-01             1.3967e-03       -22.669966806553
     1.4901e-01     1.4901e+00             8.4134e-04       -22.669971983902
     5.9605e-01     5.9605e+00             3.2350e-04       -22.669973848421  <--

*****************************************************************************
Applying the update for shift_i =   5.9605e-01     and shift_s =   5.9605e+00
*****************************************************************************

  Execution time = 1.7515e+02
  </log>
  <optVariables href="FORM.s027.opt.xml">
ci_001                -7.050667e-01 3 1  ON 0
ci_002                -7.059838e-01 3 1  ON 1
ci_003                -3.777930e-02 3 1  ON 2
ci_004                -3.900738e-02 3 1  ON 3
ci_005                 1.611275e-02 3 1  ON 4
ci_006                 1.590567e-02 3 1  ON 5
ci_007                 1.239084e-02 3 1  ON 6
ci_008                 1.253971e-02 3 1  ON 7
ci_009                -1.178349e-02 3 1  ON 8
ci_010                -1.180294e-02 3 1  ON 9
ci_011                -8.260280e-03 3 1  ON 10
ci_012                -8.233379e-03 3 1  ON 11
ci_013                 9.519164e-03 3 1  ON 12
ci_014                 9.248199e-03 3 1  ON 13
ci_015                 1.223994e-02 3 1  ON 14
ci_016                 1.247136e-02 3 1  ON 15
ci_017                 1.057383e-02 3 1  ON 16
ci_018                 1.096751e-02 3 1  ON 17
ci_019                -2.714592e-03 3 1  ON 18
ci_020                -2.473491e-03 3 1  ON 19
ci_021                -8.564074e-03 3 1  ON 20
ci_022                -8.567549e-03 3 1  ON 21
ci_023                 7.905790e-03 3 1  ON 22
ci_024                 7.980226e-03 3 1  ON 23
ci_025                 4.705722e-03 3 1  ON 24
ci_026                 4.378328e-03 3 1  ON 25
ci_027                 6.671188e-03 3 1  ON 26
ci_028                 6.347534e-03 3 1  ON 27
ci_029                -4.880263e-03 3 1  ON 28
ci_030                -4.660043e-03 3 1  ON 29
ci_031                -7.229762e-03 3 1  ON 30
ci_032                -8.197303e-03 3 1  ON 31
ci_033                 4.778722e-03 3 1  ON 32
ci_034                 4.198273e-03 3 1  ON 33
ci_035                 1.152009e-03 3 1  ON 34
ci_036                 9.756884e-04 3 1  ON 35
ci_037                 4.921486e-03 3 1  ON 36
ci_038                 4.996965e-03 3 1  ON 37
ci_039                 5.183883e-03 3 1  ON 38
ci_040                 5.310033e-03 3 1  ON 39
ci_041                 4.882911e-03 3 1  ON 40
ci_042                 4.979756e-03 3 1  ON 41
ci_043                 4.961426e-03 3 1  ON 42
ci_044                 4.888333e-03 3 1  ON 43
ci_045                 2.950278e-03 3 1  ON 44
ci_046                 3.086031e-03 3 1  ON 45
ci_047                -6.865227e-04 3 1  ON 46
ci_048                -4.899181e-04 3 1  ON 47
ci_049                 1.589469e-03 3 1  ON 48
ci_050                 1.777220e-03 3 1  ON 49
ci_051                -1.052884e-03 3 1  ON 50
ci_052                -1.141376e-03 3 1  ON 51
ci_053                -2.700554e-03 3 1  ON 52
ci_054                -2.153629e-03 3 1  ON 53
ci_055                -1.300321e-03 3 1  ON 54
ci_056                -1.336523e-03 3 1  ON 55
ci_057                -1.186545e-03 3 1  ON 56
ci_058                -1.654156e-03 3 1  ON 57
ci_059                 4.471420e-04 3 1  ON 58
ci_060                 3.908023e-05 3 1  ON 59
ci_061                -3.915338e-04 3 1  ON 60
ci_062                -1.840878e-05 3 1  ON 61
ci_063                -6.435778e-04 3 1  ON 62
ci_064                -8.936990e-04 3 1  ON 63
ci_065                -2.414264e-03 3 1  ON 64
ci_066                -2.636596e-03 3 1  ON 65
ci_067                -2.055396e-03 3 1  ON 66
ci_068                -2.484238e-03 3 1  ON 67
ci_069                -2.074824e-04 3 1  ON 68
ci_070                 5.673150e-05 3 1  ON 69
ci_071                -1.890730e-03 3 1  ON 70
ci_072                -1.892754e-03 3 1  ON 71
ci_073                 5.070883e-04 3 1  ON 72
ci_074                 3.188997e-04 3 1  ON 73
ci_075                -2.609532e-04 3 1  ON 74
ci_076                -3.919164e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 2.9823e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s028 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s028 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=28  my_counter=0
  time step      = 5.0000e-02
  blocks         = 250
  steps          = 250
  substeps       = 10
  current        = 0
  target samples = 8.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">250</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">6.2500e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">8.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">6.2500e+04</parameter>
<parameter name="steps" condition="int">250</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2667e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="250">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =8000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 28
    time step          = 0.05
    reference energy   = -22.7075
    reference variance = 0.674899
====================================================
  Execution time = 1.0374e+02
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s028
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 62500 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 6.1102e+04
  VMC Eavg = -2.2670e+01
  VMC Evar = 5.1047e-01
  Total weights = 7.819976216e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.9042e+01
  </log>
</opt>
<opt stage="main" walkers="62500">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.497003143119
                                         uncertainty =       0.001442073340

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.497003143119
                                         uncertainty =       0.001442073340

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000249249928
  error estimate for blocks of size 2^( 2) =       0.000258116701
  error estimate for blocks of size 2^( 3) =       0.000266202773
  error estimate for blocks of size 2^( 4) =       0.000271951034
  error estimate for blocks of size 2^( 5) =       0.000275066102
  error estimate for blocks of size 2^( 6) =       0.000277027725
  error estimate for blocks of size 2^( 7) =       0.000279051880
  error estimate for blocks of size 2^( 8) =       0.000279011114
  error estimate for blocks of size 2^( 9) =       0.000279359830

      target function =                  N/A
              le_mean =     -22.669934382603
             les_mean =     514.436397363707
             stat err =       0.000278612637
             autocorr =       1.249486419997
              std dev =       0.704985256397
             le_variance =       0.497004211737


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266993438260e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.4901e-01, overlap shift 1.4901e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.669934382626       residual = 4.87e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.669938223812       residual = 1.39e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.669938204471       residual = 7.25e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.669938177940       residual = 5.65e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 1.4901e-01 is 7.278797e-04

solving harmonic davidson linear method for identity shift 5.9605e-01, overlap shift 5.9605e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.669934382626       residual = 4.87e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.669935997998       residual = 5.53e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.669935996780       residual = 1.40e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.669935990626       residual = 4.47e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 5.9605e-01 is 2.815728e-04

solving harmonic davidson linear method for identity shift 2.3842e+00, overlap shift 2.3842e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.669934382626       residual = 4.87e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.669934869500       residual = 5.49e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.669934874664       residual = 1.11e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.669934873283       residual = 2.79e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 2.3842e+00 is 8.470717e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.058999 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.2280e+02
  </log>
  <optVariables href="FORM.s028.opt.xml">
ci_001                -7.050167e-01 3 1  ON 0
ci_002                -7.060460e-01 3 1  ON 1
ci_003                -3.779153e-02 3 1  ON 2
ci_004                -3.913715e-02 3 1  ON 3
ci_005                 1.601906e-02 3 1  ON 4
ci_006                 1.606158e-02 3 1  ON 5
ci_007                 1.223064e-02 3 1  ON 6
ci_008                 1.246522e-02 3 1  ON 7
ci_009                -1.163528e-02 3 1  ON 8
ci_010                -1.173110e-02 3 1  ON 9
ci_011                -8.146748e-03 3 1  ON 10
ci_012                -8.165819e-03 3 1  ON 11
ci_013                 9.518120e-03 3 1  ON 12
ci_014                 9.334330e-03 3 1  ON 13
ci_015                 1.236515e-02 3 1  ON 14
ci_016                 1.244362e-02 3 1  ON 15
ci_017                 1.045185e-02 3 1  ON 16
ci_018                 1.088425e-02 3 1  ON 17
ci_019                -2.733036e-03 3 1  ON 18
ci_020                -2.485698e-03 3 1  ON 19
ci_021                -8.559967e-03 3 1  ON 20
ci_022                -8.640582e-03 3 1  ON 21
ci_023                 7.757731e-03 3 1  ON 22
ci_024                 8.099775e-03 3 1  ON 23
ci_025                 4.638777e-03 3 1  ON 24
ci_026                 4.241643e-03 3 1  ON 25
ci_027                 6.428174e-03 3 1  ON 26
ci_028                 6.389034e-03 3 1  ON 27
ci_029                -4.813260e-03 3 1  ON 28
ci_030                -4.553117e-03 3 1  ON 29
ci_031                -7.190609e-03 3 1  ON 30
ci_032                -7.925043e-03 3 1  ON 31
ci_033                 4.641037e-03 3 1  ON 32
ci_034                 4.078478e-03 3 1  ON 33
ci_035                 1.166312e-03 3 1  ON 34
ci_036                 1.036706e-03 3 1  ON 35
ci_037                 4.715374e-03 3 1  ON 36
ci_038                 5.054117e-03 3 1  ON 37
ci_039                 5.260416e-03 3 1  ON 38
ci_040                 5.133117e-03 3 1  ON 39
ci_041                 4.810117e-03 3 1  ON 40
ci_042                 4.852875e-03 3 1  ON 41
ci_043                 4.905126e-03 3 1  ON 42
ci_044                 4.956773e-03 3 1  ON 43
ci_045                 2.937738e-03 3 1  ON 44
ci_046                 3.150066e-03 3 1  ON 45
ci_047                -6.411659e-04 3 1  ON 46
ci_048                -4.209773e-04 3 1  ON 47
ci_049                 1.588907e-03 3 1  ON 48
ci_050                 1.868628e-03 3 1  ON 49
ci_051                -1.148543e-03 3 1  ON 50
ci_052                -1.261041e-03 3 1  ON 51
ci_053                -2.617038e-03 3 1  ON 52
ci_054                -2.214167e-03 3 1  ON 53
ci_055                -1.437477e-03 3 1  ON 54
ci_056                -1.364488e-03 3 1  ON 55
ci_057                -1.310263e-03 3 1  ON 56
ci_058                -1.619142e-03 3 1  ON 57
ci_059                 4.674009e-04 3 1  ON 58
ci_060                 2.608926e-04 3 1  ON 59
ci_061                -5.072090e-04 3 1  ON 60
ci_062                 4.549933e-05 3 1  ON 61
ci_063                -5.450094e-04 3 1  ON 62
ci_064                -8.935961e-04 3 1  ON 63
ci_065                -2.231700e-03 3 1  ON 64
ci_066                -2.600632e-03 3 1  ON 65
ci_067                -2.024207e-03 3 1  ON 66
ci_068                -2.474500e-03 3 1  ON 67
ci_069                 3.716595e-05 3 1  ON 68
ci_070                 1.719897e-04 3 1  ON 69
ci_071                -1.958119e-03 3 1  ON 70
ci_072                -2.174327e-03 3 1  ON 71
ci_073                 3.872115e-04 3 1  ON 72
ci_074                 2.328626e-04 3 1  ON 73
ci_075                -2.061327e-04 3 1  ON 74
ci_076                -3.421016e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="250">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =8000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 28
    time step          = 0.05
    reference energy   = -22.6573
    reference variance = 0.384662
====================================================
  Execution time = 9.9907e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s028
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 62500 
  VMC Eavg = -2.2669e+01
  VMC Evar = 5.0788e-01
  Total weights = 7.8209e+06
  Execution time = 1.4638e+01
  </log>
</opt>
<opt stage="main" walkers="62500">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.495144781430
                                         uncertainty =       0.001200325065

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.495144781430
                                         uncertainty =       0.001200325065

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000248782658
  error estimate for blocks of size 2^( 2) =       0.000257666296
  error estimate for blocks of size 2^( 3) =       0.000265696693
  error estimate for blocks of size 2^( 4) =       0.000271340995
  error estimate for blocks of size 2^( 5) =       0.000274789701
  error estimate for blocks of size 2^( 6) =       0.000276001979
  error estimate for blocks of size 2^( 7) =       0.000277148664
  error estimate for blocks of size 2^( 8) =       0.000276732623
  error estimate for blocks of size 2^( 9) =       0.000279387007

      target function =                  N/A
              le_mean =     -22.669386948720
             les_mean =     514.409935876683
             stat err =       0.000277317568
             autocorr =       1.242551966331
              std dev =       0.703663616855
             le_variance =       0.495142485685

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.495155062751
                                         uncertainty =       0.001215624248

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.495155062751
                                         uncertainty =       0.001215624248

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000248785216
  error estimate for blocks of size 2^( 2) =       0.000257670339
  error estimate for blocks of size 2^( 3) =       0.000265703890
  error estimate for blocks of size 2^( 4) =       0.000271350412
  error estimate for blocks of size 2^( 5) =       0.000274801390
  error estimate for blocks of size 2^( 6) =       0.000276014516
  error estimate for blocks of size 2^( 7) =       0.000277156613
  error estimate for blocks of size 2^( 8) =       0.000276747840
  error estimate for blocks of size 2^( 9) =       0.000279406899

      target function =                  N/A
              le_mean =     -22.669388539201
             les_mean =     514.419460213528
             stat err =       0.000277331467
             autocorr =       1.242650961982
              std dev =       0.703670853166
             le_variance =       0.495152669595

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.495142562477
                                         uncertainty =       0.001213467055

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.495142562477
                                         uncertainty =       0.001213467055

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000248782079
  error estimate for blocks of size 2^( 2) =       0.000257667143
  error estimate for blocks of size 2^( 3) =       0.000265699817
  error estimate for blocks of size 2^( 4) =       0.000271346698
  error estimate for blocks of size 2^( 5) =       0.000274797529
  error estimate for blocks of size 2^( 6) =       0.000276011455
  error estimate for blocks of size 2^( 7) =       0.000277154485
  error estimate for blocks of size 2^( 8) =       0.000276742787
  error estimate for blocks of size 2^( 9) =       0.000279394922

      target function =                  N/A
              le_mean =     -22.669388403751
             les_mean =     514.412576009664
             stat err =       0.000277325912
             autocorr =       1.242632519243
              std dev =       0.703661980769
             le_variance =       0.495140183180

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.495303130075
                                         uncertainty =       0.001220304705

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.495303130075
                                         uncertainty =       0.001220304705

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000248822410
  error estimate for blocks of size 2^( 2) =       0.000257704946
  error estimate for blocks of size 2^( 3) =       0.000265735153
  error estimate for blocks of size 2^( 4) =       0.000271379244
  error estimate for blocks of size 2^( 5) =       0.000274835503
  error estimate for blocks of size 2^( 6) =       0.000276057003
  error estimate for blocks of size 2^( 7) =       0.000277209791
  error estimate for blocks of size 2^( 8) =       0.000276781333
  error estimate for blocks of size 2^( 9) =       0.000279447942

      target function =                  N/A
              le_mean =     -22.669391346552
             les_mean =     521.025398212040
             stat err =       0.000277374017
             autocorr =       1.242660710138
              std dev =       0.703776055102
             le_variance =       0.495300735736


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.669386948720        initial
     1.4901e-01     1.4901e+00             7.2788e-04       -22.669388539201
     5.9605e-01     5.9605e+00             2.8157e-04       -22.669388403751
     2.3842e+00     2.3842e+01             8.4707e-05       -22.669391346552  <--

*****************************************************************************
Applying the update for shift_i =   2.3842e+00     and shift_s =   2.3842e+01
*****************************************************************************

  Execution time = 1.7307e+02
  </log>
  <optVariables href="FORM.s028.opt.xml">
ci_001                -7.050559e-01 3 1  ON 0
ci_002                -7.059987e-01 3 1  ON 1
ci_003                -3.778191e-02 3 1  ON 2
ci_004                -3.904100e-02 3 1  ON 3
ci_005                 1.608247e-02 3 1  ON 4
ci_006                 1.595483e-02 3 1  ON 5
ci_007                 1.234217e-02 3 1  ON 6
ci_008                 1.251565e-02 3 1  ON 7
ci_009                -1.174013e-02 3 1  ON 8
ci_010                -1.178240e-02 3 1  ON 9
ci_011                -8.226930e-03 3 1  ON 10
ci_012                -8.214435e-03 3 1  ON 11
ci_013                 9.518925e-03 3 1  ON 12
ci_014                 9.273183e-03 3 1  ON 13
ci_015                 1.227517e-02 3 1  ON 14
ci_016                 1.246297e-02 3 1  ON 15
ci_017                 1.053783e-02 3 1  ON 16
ci_018                 1.094392e-02 3 1  ON 17
ci_019                -2.719925e-03 3 1  ON 18
ci_020                -2.478091e-03 3 1  ON 19
ci_021                -8.562182e-03 3 1  ON 20
ci_022                -8.586804e-03 3 1  ON 21
ci_023                 7.860290e-03 3 1  ON 22
ci_024                 8.016967e-03 3 1  ON 23
ci_025                 4.686169e-03 3 1  ON 24
ci_026                 4.339496e-03 3 1  ON 25
ci_027                 6.591821e-03 3 1  ON 26
ci_028                 6.360824e-03 3 1  ON 27
ci_029                -4.860040e-03 3 1  ON 28
ci_030                -4.628623e-03 3 1  ON 29
ci_031                -7.218374e-03 3 1  ON 30
ci_032                -8.119393e-03 3 1  ON 31
ci_033                 4.738157e-03 3 1  ON 32
ci_034                 4.162949e-03 3 1  ON 33
ci_035                 1.156871e-03 3 1  ON 34
ci_036                 9.950320e-04 3 1  ON 35
ci_037                 4.860951e-03 3 1  ON 36
ci_038                 5.013544e-03 3 1  ON 37
ci_039                 5.208173e-03 3 1  ON 38
ci_040                 5.253066e-03 3 1  ON 39
ci_041                 4.860382e-03 3 1  ON 40
ci_042                 4.940204e-03 3 1  ON 41
ci_043                 4.945820e-03 3 1  ON 42
ci_044                 4.908629e-03 3 1  ON 43
ci_045                 2.945043e-03 3 1  ON 44
ci_046                 3.103467e-03 3 1  ON 45
ci_047                -6.723757e-04 3 1  ON 46
ci_048                -4.677612e-04 3 1  ON 47
ci_049                 1.589884e-03 3 1  ON 48
ci_050                 1.804052e-03 3 1  ON 49
ci_051                -1.082522e-03 3 1  ON 50
ci_052                -1.178932e-03 3 1  ON 51
ci_053                -2.675156e-03 3 1  ON 52
ci_054                -2.170258e-03 3 1  ON 53
ci_055                -1.339624e-03 3 1  ON 54
ci_056                -1.344686e-03 3 1  ON 55
ci_057                -1.223902e-03 3 1  ON 56
ci_058                -1.643948e-03 3 1  ON 57
ci_059                 4.533166e-04 3 1  ON 58
ci_060                 1.095438e-04 3 1  ON 59
ci_061                -4.259975e-04 3 1  ON 60
ci_062                -2.223053e-07 3 1  ON 61
ci_063                -6.147703e-04 3 1  ON 62
ci_064                -8.940122e-04 3 1  ON 63
ci_065                -2.359671e-03 3 1  ON 64
ci_066                -2.625724e-03 3 1  ON 65
ci_067                -2.046602e-03 3 1  ON 66
ci_068                -2.481149e-03 3 1  ON 67
ci_069                -1.333553e-04 3 1  ON 68
ci_070                 9.182275e-05 3 1  ON 69
ci_071                -1.911783e-03 3 1  ON 70
ci_072                -1.977462e-03 3 1  ON 71
ci_073                 4.684670e-04 3 1  ON 72
ci_074                 2.923076e-04 3 1  ON 73
ci_075                -2.437749e-04 3 1  ON 74
ci_076                -3.763320e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 2.9588e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s029 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s029 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=29  my_counter=0
  time step      = 5.0000e-02
  blocks         = 250
  steps          = 250
  substeps       = 10
  current        = 0
  target samples = 8.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">250</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">6.2500e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">8.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">6.2500e+04</parameter>
<parameter name="steps" condition="int">250</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2667e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="250">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =8000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 29
    time step          = 0.05
    reference energy   = -22.6397
    reference variance = 0.567648
====================================================
  Execution time = 1.0037e+02
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s029
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 62500 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 6.1093e+04
  VMC Eavg = -2.2670e+01
  VMC Evar = 5.0890e-01
  Total weights = 7.820734787e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.9072e+01
  </log>
</opt>
<opt stage="main" walkers="62500">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.496211825575
                                         uncertainty =       0.001411716939

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.496211825575
                                         uncertainty =       0.001411716939

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000249051626
  error estimate for blocks of size 2^( 2) =       0.000258107774
  error estimate for blocks of size 2^( 3) =       0.000265904139
  error estimate for blocks of size 2^( 4) =       0.000271830930
  error estimate for blocks of size 2^( 5) =       0.000275205358
  error estimate for blocks of size 2^( 6) =       0.000277314030
  error estimate for blocks of size 2^( 7) =       0.000278391445
  error estimate for blocks of size 2^( 8) =       0.000278940655
  error estimate for blocks of size 2^( 9) =       0.000279045735

      target function =                  N/A
              le_mean =     -22.669863991746
             les_mean =     514.431631706761
             stat err =       0.000278422966
             autocorr =       1.249773611309
              std dev =       0.704424373256
             le_variance =       0.496213697637


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266986399175e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.9605e-01, overlap shift 5.9605e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.669863991771       residual = 3.91e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.669865292984       residual = 4.94e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.669865390455       residual = 2.17e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.669865401166       residual = 8.99e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 5.9605e-01 is 3.312485e-04

solving harmonic davidson linear method for identity shift 2.3842e+00, overlap shift 2.3842e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.669863991771       residual = 3.91e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.669864377709       residual = 5.08e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.669864399265       residual = 1.74e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.669864399657       residual = 5.78e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 2.3842e+00 is 9.650827e-05

solving harmonic davidson linear method for identity shift 9.5367e+00, overlap shift 9.5367e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.669863991771       residual = 3.91e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.669864092972       residual = 5.55e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.669864098027       residual = 1.84e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.669864098148       residual = 6.26e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 9.5367e+00 is 2.517454e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.060350 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.1945e+02
  </log>
  <optVariables href="FORM.s029.opt.xml">
ci_001                -7.050584e-01 3 1  ON 0
ci_002                -7.059959e-01 3 1  ON 1
ci_003                -3.774910e-02 3 1  ON 2
ci_004                -3.900464e-02 3 1  ON 3
ci_005                 1.609076e-02 3 1  ON 4
ci_006                 1.596889e-02 3 1  ON 5
ci_007                 1.231667e-02 3 1  ON 6
ci_008                 1.249852e-02 3 1  ON 7
ci_009                -1.173179e-02 3 1  ON 8
ci_010                -1.179708e-02 3 1  ON 9
ci_011                -8.215279e-03 3 1  ON 10
ci_012                -8.188451e-03 3 1  ON 11
ci_013                 9.562717e-03 3 1  ON 12
ci_014                 9.301176e-03 3 1  ON 13
ci_015                 1.228680e-02 3 1  ON 14
ci_016                 1.248231e-02 3 1  ON 15
ci_017                 1.063434e-02 3 1  ON 16
ci_018                 1.089641e-02 3 1  ON 17
ci_019                -2.657228e-03 3 1  ON 18
ci_020                -2.471900e-03 3 1  ON 19
ci_021                -8.543549e-03 3 1  ON 20
ci_022                -8.613865e-03 3 1  ON 21
ci_023                 7.834969e-03 3 1  ON 22
ci_024                 8.029021e-03 3 1  ON 23
ci_025                 4.691629e-03 3 1  ON 24
ci_026                 4.325715e-03 3 1  ON 25
ci_027                 6.534485e-03 3 1  ON 26
ci_028                 6.383968e-03 3 1  ON 27
ci_029                -4.871441e-03 3 1  ON 28
ci_030                -4.669486e-03 3 1  ON 29
ci_031                -7.262361e-03 3 1  ON 30
ci_032                -8.141956e-03 3 1  ON 31
ci_033                 4.710476e-03 3 1  ON 32
ci_034                 4.227824e-03 3 1  ON 33
ci_035                 1.152592e-03 3 1  ON 34
ci_036                 1.014539e-03 3 1  ON 35
ci_037                 4.883317e-03 3 1  ON 36
ci_038                 5.034926e-03 3 1  ON 37
ci_039                 5.220985e-03 3 1  ON 38
ci_040                 5.271119e-03 3 1  ON 39
ci_041                 4.894620e-03 3 1  ON 40
ci_042                 5.026823e-03 3 1  ON 41
ci_043                 4.943961e-03 3 1  ON 42
ci_044                 4.920917e-03 3 1  ON 43
ci_045                 3.001248e-03 3 1  ON 44
ci_046                 3.132151e-03 3 1  ON 45
ci_047                -7.075297e-04 3 1  ON 46
ci_048                -4.946494e-04 3 1  ON 47
ci_049                 1.589995e-03 3 1  ON 48
ci_050                 1.807151e-03 3 1  ON 49
ci_051                -1.080556e-03 3 1  ON 50
ci_052                -1.197542e-03 3 1  ON 51
ci_053                -2.658155e-03 3 1  ON 52
ci_054                -2.204242e-03 3 1  ON 53
ci_055                -1.370891e-03 3 1  ON 54
ci_056                -1.349265e-03 3 1  ON 55
ci_057                -1.217474e-03 3 1  ON 56
ci_058                -1.657819e-03 3 1  ON 57
ci_059                 4.085387e-04 3 1  ON 58
ci_060                 1.239944e-04 3 1  ON 59
ci_061                -4.036758e-04 3 1  ON 60
ci_062                -4.769660e-06 3 1  ON 61
ci_063                -5.888224e-04 3 1  ON 62
ci_064                -8.979658e-04 3 1  ON 63
ci_065                -2.370947e-03 3 1  ON 64
ci_066                -2.571121e-03 3 1  ON 65
ci_067                -2.059124e-03 3 1  ON 66
ci_068                -2.486671e-03 3 1  ON 67
ci_069                -1.617464e-04 3 1  ON 68
ci_070                 1.047066e-04 3 1  ON 69
ci_071                -1.904048e-03 3 1  ON 70
ci_072                -1.969070e-03 3 1  ON 71
ci_073                 5.123323e-04 3 1  ON 72
ci_074                 2.928159e-04 3 1  ON 73
ci_075                -2.625808e-04 3 1  ON 74
ci_076                -3.638480e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="250">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =8000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 29
    time step          = 0.05
    reference energy   = -22.5397
    reference variance = 0.366294
====================================================
  Execution time = 9.9931e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s029
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 62500 
  VMC Eavg = -2.2670e+01
  VMC Evar = 5.1190e-01
  Total weights = 7.8196e+06
  Execution time = 1.4689e+01
  </log>
</opt>
<opt stage="main" walkers="62500">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.498566607461
                                         uncertainty =       0.001489324809

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.498566607461
                                         uncertainty =       0.001489324809

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000249641868
  error estimate for blocks of size 2^( 2) =       0.000258427928
  error estimate for blocks of size 2^( 3) =       0.000266511828
  error estimate for blocks of size 2^( 4) =       0.000272265876
  error estimate for blocks of size 2^( 5) =       0.000275328423
  error estimate for blocks of size 2^( 6) =       0.000277414613
  error estimate for blocks of size 2^( 7) =       0.000278521276
  error estimate for blocks of size 2^( 8) =       0.000279063894
  error estimate for blocks of size 2^( 9) =       0.000278659842

      target function =                  N/A
              le_mean =     -22.669750599445
             les_mean =     514.430126455799
             stat err =       0.000278414906
             autocorr =       1.243798754480
              std dev =       0.706093832165
             le_variance =       0.498568499822

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.498648792808
                                         uncertainty =       0.001493687931

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.498648792808
                                         uncertainty =       0.001493687931

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000249662445
  error estimate for blocks of size 2^( 2) =       0.000258446497
  error estimate for blocks of size 2^( 3) =       0.000266529291
  error estimate for blocks of size 2^( 4) =       0.000272280896
  error estimate for blocks of size 2^( 5) =       0.000275342309
  error estimate for blocks of size 2^( 6) =       0.000277426588
  error estimate for blocks of size 2^( 7) =       0.000278532570
  error estimate for blocks of size 2^( 8) =       0.000279071237
  error estimate for blocks of size 2^( 9) =       0.000278664819

      target function =                  N/A
              le_mean =     -22.669753130447
             les_mean =     514.433554121113
             stat err =       0.000278423804
             autocorr =       1.243673228671
              std dev =       0.706152031380
             le_variance =       0.498650691422

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.498612046689
                                         uncertainty =       0.001491794463

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.498612046689
                                         uncertainty =       0.001491794463

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000249653245
  error estimate for blocks of size 2^( 2) =       0.000258438181
  error estimate for blocks of size 2^( 3) =       0.000266521368
  error estimate for blocks of size 2^( 4) =       0.000272273923
  error estimate for blocks of size 2^( 5) =       0.000275335893
  error estimate for blocks of size 2^( 6) =       0.000277421246
  error estimate for blocks of size 2^( 7) =       0.000278527544
  error estimate for blocks of size 2^( 8) =       0.000279067405
  error estimate for blocks of size 2^( 9) =       0.000278662062

      target function =                  N/A
              le_mean =     -22.669751756437
             les_mean =     514.429679992263
             stat err =       0.000278419564
             autocorr =       1.243727014545
              std dev =       0.706126010396
             le_variance =       0.498613942558

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.498572080777
                                         uncertainty =       0.001489629258

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.498572080777
                                         uncertainty =       0.001489629258

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000249643239
  error estimate for blocks of size 2^( 2) =       0.000258429148
  error estimate for blocks of size 2^( 3) =       0.000266512934
  error estimate for blocks of size 2^( 4) =       0.000272266797
  error estimate for blocks of size 2^( 5) =       0.000275329265
  error estimate for blocks of size 2^( 6) =       0.000277415331
  error estimate for blocks of size 2^( 7) =       0.000278521961
  error estimate for blocks of size 2^( 8) =       0.000279064209
  error estimate for blocks of size 2^( 9) =       0.000278659835

      target function =                  N/A
              le_mean =     -22.669750718664
             les_mean =     514.429662635530
             stat err =       0.000278415334
             autocorr =       1.243788922886
              std dev =       0.706097708237
             le_variance =       0.498573973577


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.669750599445        initial
     5.9605e-01     5.9605e+00             3.3125e-04       -22.669753130447  <--
     2.3842e+00     2.3842e+01             9.6508e-05       -22.669751756437
     9.5367e+00     9.5367e+01             2.5175e-05       -22.669750718664

*****************************************************************************
Applying the update for shift_i =   5.9605e-01     and shift_s =   5.9605e+00
*****************************************************************************

  Execution time = 1.7332e+02
  </log>
  <optVariables href="FORM.s029.opt.xml">
ci_001                -7.050648e-01 3 1  ON 0
ci_002                -7.059904e-01 3 1  ON 1
ci_003                -3.765740e-02 3 1  ON 2
ci_004                -3.890344e-02 3 1  ON 3
ci_005                 1.611024e-02 3 1  ON 4
ci_006                 1.599927e-02 3 1  ON 5
ci_007                 1.225570e-02 3 1  ON 6
ci_008                 1.245970e-02 3 1  ON 7
ci_009                -1.171480e-02 3 1  ON 8
ci_010                -1.183520e-02 3 1  ON 9
ci_011                -8.187883e-03 3 1  ON 10
ci_012                -8.121344e-03 3 1  ON 11
ci_013                 9.676194e-03 3 1  ON 12
ci_014                 9.372218e-03 3 1  ON 13
ci_015                 1.231894e-02 3 1  ON 14
ci_016                 1.252461e-02 3 1  ON 15
ci_017                 1.086908e-02 3 1  ON 16
ci_018                 1.077701e-02 3 1  ON 17
ci_019                -2.500999e-03 3 1  ON 18
ci_020                -2.454329e-03 3 1  ON 19
ci_021                -8.496336e-03 3 1  ON 20
ci_022                -8.682207e-03 3 1  ON 21
ci_023                 7.778322e-03 3 1  ON 22
ci_024                 8.055431e-03 3 1  ON 23
ci_025                 4.699277e-03 3 1  ON 24
ci_026                 4.291690e-03 3 1  ON 25
ci_027                 6.416390e-03 3 1  ON 26
ci_028                 6.430270e-03 3 1  ON 27
ci_029                -4.895146e-03 3 1  ON 28
ci_030                -4.770424e-03 3 1  ON 29
ci_031                -7.373443e-03 3 1  ON 30
ci_032                -8.192800e-03 3 1  ON 31
ci_033                 4.640281e-03 3 1  ON 32
ci_034                 4.381839e-03 3 1  ON 33
ci_035                 1.141670e-03 3 1  ON 34
ci_036                 1.053499e-03 3 1  ON 35
ci_037                 4.939515e-03 3 1  ON 36
ci_038                 5.087513e-03 3 1  ON 37
ci_039                 5.249036e-03 3 1  ON 38
ci_040                 5.307365e-03 3 1  ON 39
ci_041                 4.970452e-03 3 1  ON 40
ci_042                 5.219080e-03 3 1  ON 41
ci_043                 4.940058e-03 3 1  ON 42
ci_044                 4.946580e-03 3 1  ON 43
ci_045                 3.136312e-03 3 1  ON 44
ci_046                 3.196371e-03 3 1  ON 45
ci_047                -7.793990e-04 3 1  ON 46
ci_048                -5.485947e-04 3 1  ON 47
ci_049                 1.589306e-03 3 1  ON 48
ci_050                 1.814692e-03 3 1  ON 49
ci_051                -1.074571e-03 3 1  ON 50
ci_052                -1.241691e-03 3 1  ON 51
ci_053                -2.617734e-03 3 1  ON 52
ci_054                -2.286729e-03 3 1  ON 53
ci_055                -1.447550e-03 3 1  ON 54
ci_056                -1.360432e-03 3 1  ON 55
ci_057                -1.203210e-03 3 1  ON 56
ci_058                -1.689640e-03 3 1  ON 57
ci_059                 3.109986e-04 3 1  ON 58
ci_060                 1.541752e-04 3 1  ON 59
ci_061                -3.516206e-04 3 1  ON 60
ci_062                -1.287725e-05 3 1  ON 61
ci_063                -5.247849e-04 3 1  ON 62
ci_064                -9.059588e-04 3 1  ON 63
ci_065                -2.395804e-03 3 1  ON 64
ci_066                -2.441848e-03 3 1  ON 65
ci_067                -2.087315e-03 3 1  ON 66
ci_068                -2.497594e-03 3 1  ON 67
ci_069                -2.269140e-04 3 1  ON 68
ci_070                 1.344941e-04 3 1  ON 69
ci_071                -1.884839e-03 3 1  ON 70
ci_072                -1.948813e-03 3 1  ON 71
ci_073                 6.064721e-04 3 1  ON 72
ci_074                 2.923977e-04 3 1  ON 73
ci_075                -3.046789e-04 3 1  ON 74
ci_076                -3.357230e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 2.9278e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s030 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s030 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=30  my_counter=0
  time step      = 5.0000e-02
  blocks         = 250
  steps          = 250
  substeps       = 10
  current        = 0
  target samples = 8.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">250</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">6.2500e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">8.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">6.2500e+04</parameter>
<parameter name="steps" condition="int">250</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2665e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="250">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =8000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 30
    time step          = 0.05
    reference energy   = -22.6403
    reference variance = 0.425726
====================================================
  Execution time = 1.0032e+02
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s030
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 62500 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 6.1089e+04
  VMC Eavg = -2.2669e+01
  VMC Evar = 5.0624e-01
  Total weights = 7.820328457e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.9080e+01
  </log>
</opt>
<opt stage="main" walkers="62500">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.494556114257
                                         uncertainty =       0.001128314762

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.494556114257
                                         uncertainty =       0.001128314762

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000248635828
  error estimate for blocks of size 2^( 2) =       0.000257665777
  error estimate for blocks of size 2^( 3) =       0.000265673538
  error estimate for blocks of size 2^( 4) =       0.000271665808
  error estimate for blocks of size 2^( 5) =       0.000274948610
  error estimate for blocks of size 2^( 6) =       0.000276713033
  error estimate for blocks of size 2^( 7) =       0.000277310842
  error estimate for blocks of size 2^( 8) =       0.000278534682
  error estimate for blocks of size 2^( 9) =       0.000279390706

      target function =                  N/A
              le_mean =     -22.669134611609
             les_mean =     514.395905218359
             stat err =       0.000277987316
             autocorr =       1.250036052821
              std dev =       0.703248321155
             le_variance =       0.494558201208


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266913461161e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.4901e-01, overlap shift 1.4901e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.669134611633       residual = 4.83e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.669139011356       residual = 8.87e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.669139030667       residual = 3.59e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.669138911203       residual = 2.11e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 1.4901e-01 is 8.819049e-04

solving harmonic davidson linear method for identity shift 5.9605e-01, overlap shift 5.9605e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.669134611633       residual = 4.83e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.669136464381       residual = 4.36e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.669136384888       residual = 6.49e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 5.9605e-01 is 3.639713e-04

solving harmonic davidson linear method for identity shift 2.3842e+00, overlap shift 2.3842e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.669134611633       residual = 4.83e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.669135170433       residual = 5.63e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.669135134714       residual = 9.31e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 2.3842e+00 is 1.086623e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.061518 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.1941e+02
  </log>
  <optVariables href="FORM.s030.opt.xml">
ci_001                -7.050748e-01 3 1  ON 0
ci_002                -7.059680e-01 3 1  ON 1
ci_003                -3.775221e-02 3 1  ON 2
ci_004                -3.895679e-02 3 1  ON 3
ci_005                 1.622782e-02 3 1  ON 4
ci_006                 1.600268e-02 3 1  ON 5
ci_007                 1.223924e-02 3 1  ON 6
ci_008                 1.246439e-02 3 1  ON 7
ci_009                -1.175774e-02 3 1  ON 8
ci_010                -1.194754e-02 3 1  ON 9
ci_011                -8.058299e-03 3 1  ON 10
ci_012                -8.231908e-03 3 1  ON 11
ci_013                 9.722206e-03 3 1  ON 12
ci_014                 9.223583e-03 3 1  ON 13
ci_015                 1.226005e-02 3 1  ON 14
ci_016                 1.263381e-02 3 1  ON 15
ci_017                 1.082574e-02 3 1  ON 16
ci_018                 1.074734e-02 3 1  ON 17
ci_019                -2.600712e-03 3 1  ON 18
ci_020                -2.496167e-03 3 1  ON 19
ci_021                -8.462091e-03 3 1  ON 20
ci_022                -8.619399e-03 3 1  ON 21
ci_023                 7.901291e-03 3 1  ON 22
ci_024                 7.877002e-03 3 1  ON 23
ci_025                 4.665792e-03 3 1  ON 24
ci_026                 4.358927e-03 3 1  ON 25
ci_027                 6.571298e-03 3 1  ON 26
ci_028                 6.568055e-03 3 1  ON 27
ci_029                -4.951014e-03 3 1  ON 28
ci_030                -4.838886e-03 3 1  ON 29
ci_031                -7.221771e-03 3 1  ON 30
ci_032                -8.067585e-03 3 1  ON 31
ci_033                 4.535068e-03 3 1  ON 32
ci_034                 4.595919e-03 3 1  ON 33
ci_035                 1.028960e-03 3 1  ON 34
ci_036                 1.048765e-03 3 1  ON 35
ci_037                 4.896347e-03 3 1  ON 36
ci_038                 5.116432e-03 3 1  ON 37
ci_039                 5.501985e-03 3 1  ON 38
ci_040                 5.259910e-03 3 1  ON 39
ci_041                 5.180485e-03 3 1  ON 40
ci_042                 5.129181e-03 3 1  ON 41
ci_043                 4.964298e-03 3 1  ON 42
ci_044                 4.878140e-03 3 1  ON 43
ci_045                 3.051541e-03 3 1  ON 44
ci_046                 3.063568e-03 3 1  ON 45
ci_047                -6.184172e-04 3 1  ON 46
ci_048                -5.381747e-04 3 1  ON 47
ci_049                 1.537962e-03 3 1  ON 48
ci_050                 1.704354e-03 3 1  ON 49
ci_051                -1.083697e-03 3 1  ON 50
ci_052                -1.158609e-03 3 1  ON 51
ci_053                -2.722564e-03 3 1  ON 52
ci_054                -2.457809e-03 3 1  ON 53
ci_055                -1.543354e-03 3 1  ON 54
ci_056                -1.432606e-03 3 1  ON 55
ci_057                -1.300897e-03 3 1  ON 56
ci_058                -1.703119e-03 3 1  ON 57
ci_059                 2.383158e-04 3 1  ON 58
ci_060                 2.783098e-04 3 1  ON 59
ci_061                -2.141554e-04 3 1  ON 60
ci_062                -5.462471e-05 3 1  ON 61
ci_063                -6.104357e-04 3 1  ON 62
ci_064                -8.710907e-04 3 1  ON 63
ci_065                -2.446212e-03 3 1  ON 64
ci_066                -2.420087e-03 3 1  ON 65
ci_067                -2.100756e-03 3 1  ON 66
ci_068                -2.306320e-03 3 1  ON 67
ci_069                 1.370573e-04 3 1  ON 68
ci_070                 7.855380e-05 3 1  ON 69
ci_071                -2.127378e-03 3 1  ON 70
ci_072                -1.835623e-03 3 1  ON 71
ci_073                 5.581174e-04 3 1  ON 72
ci_074                 2.445672e-04 3 1  ON 73
ci_075                -3.539613e-04 3 1  ON 74
ci_076                -3.136345e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="250">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =8000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 30
    time step          = 0.05
    reference energy   = -22.65
    reference variance = 0.380932
====================================================
  Execution time = 1.0013e+02
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s030
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 62500 
  VMC Eavg = -2.2670e+01
  VMC Evar = 5.0993e-01
  Total weights = 7.8210e+06
  Execution time = 1.4691e+01
  </log>
</opt>
<opt stage="main" walkers="62500">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.496732797002
                                         uncertainty =       0.001796192268

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.496732797002
                                         uncertainty =       0.001796192268

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000249182070
  error estimate for blocks of size 2^( 2) =       0.000258242344
  error estimate for blocks of size 2^( 3) =       0.000266245761
  error estimate for blocks of size 2^( 4) =       0.000272032488
  error estimate for blocks of size 2^( 5) =       0.000275520904
  error estimate for blocks of size 2^( 6) =       0.000276617344
  error estimate for blocks of size 2^( 7) =       0.000277834149
  error estimate for blocks of size 2^( 8) =       0.000278946138
  error estimate for blocks of size 2^( 9) =       0.000277594787

      target function =                  N/A
              le_mean =     -22.669927774011
             les_mean =     514.436032554357
             stat err =       0.000277748105
             autocorr =       1.242420557039
              std dev =       0.704793326368
             le_variance =       0.496733632892

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.497365588230
                                         uncertainty =       0.002279374413

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.497365588230
                                         uncertainty =       0.002279374413

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000249340731
  error estimate for blocks of size 2^( 2) =       0.000258392129
  error estimate for blocks of size 2^( 3) =       0.000266388687
  error estimate for blocks of size 2^( 4) =       0.000272177666
  error estimate for blocks of size 2^( 5) =       0.000275662050
  error estimate for blocks of size 2^( 6) =       0.000276765969
  error estimate for blocks of size 2^( 7) =       0.000277992907
  error estimate for blocks of size 2^( 8) =       0.000279105806
  error estimate for blocks of size 2^( 9) =       0.000277782046

      target function =                  N/A
              le_mean =     -22.669924882475
             les_mean =     514.448958848459
             stat err =       0.000277911682
             autocorr =       1.242301902113
              std dev =       0.705242085959
             le_variance =       0.497366399808

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.497291103544
                                         uncertainty =       0.002225953077

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.497291103544
                                         uncertainty =       0.002225953077

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000249322059
  error estimate for blocks of size 2^( 2) =       0.000258374137
  error estimate for blocks of size 2^( 3) =       0.000266370903
  error estimate for blocks of size 2^( 4) =       0.000272159354
  error estimate for blocks of size 2^( 5) =       0.000275643557
  error estimate for blocks of size 2^( 6) =       0.000276746045
  error estimate for blocks of size 2^( 7) =       0.000277969978
  error estimate for blocks of size 2^( 8) =       0.000279081351
  error estimate for blocks of size 2^( 9) =       0.000277757297

      target function =                  N/A
              le_mean =     -22.669923855270
             les_mean =     514.436630310902
             stat err =       0.000277888668
             autocorr =       1.242282208313
              std dev =       0.705189273841
             le_variance =       0.497291911940

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.496799297372
                                         uncertainty =       0.001849926606

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.496799297372
                                         uncertainty =       0.001849926606

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000249198748
  error estimate for blocks of size 2^( 2) =       0.000258257890
  error estimate for blocks of size 2^( 3) =       0.000266260411
  error estimate for blocks of size 2^( 4) =       0.000272047477
  error estimate for blocks of size 2^( 5) =       0.000275535372
  error estimate for blocks of size 2^( 6) =       0.000276632429
  error estimate for blocks of size 2^( 7) =       0.000277850537
  error estimate for blocks of size 2^( 8) =       0.000278962559
  error estimate for blocks of size 2^( 9) =       0.000277614394

      target function =                  N/A
              le_mean =     -22.669926479952
             les_mean =     514.435575876971
             stat err =       0.000277764980
             autocorr =       1.242405213780
              std dev =       0.704840499700
             le_variance =       0.496800130017


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.669927774011        initial  <--
     1.4901e-01     1.4901e+00             8.8190e-04       -22.669924882475
     5.9605e-01     5.9605e+00             3.6397e-04       -22.669923855270
     2.3842e+00     2.3842e+01             1.0866e-04       -22.669926479952

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 173.5720
  </log>
  <optVariables href="FORM.s030.opt.xml">
ci_001                -7.050648e-01 3 1  ON 0
ci_002                -7.059904e-01 3 1  ON 1
ci_003                -3.765740e-02 3 1  ON 2
ci_004                -3.890344e-02 3 1  ON 3
ci_005                 1.611024e-02 3 1  ON 4
ci_006                 1.599927e-02 3 1  ON 5
ci_007                 1.225570e-02 3 1  ON 6
ci_008                 1.245970e-02 3 1  ON 7
ci_009                -1.171480e-02 3 1  ON 8
ci_010                -1.183520e-02 3 1  ON 9
ci_011                -8.187883e-03 3 1  ON 10
ci_012                -8.121344e-03 3 1  ON 11
ci_013                 9.676194e-03 3 1  ON 12
ci_014                 9.372218e-03 3 1  ON 13
ci_015                 1.231894e-02 3 1  ON 14
ci_016                 1.252461e-02 3 1  ON 15
ci_017                 1.086908e-02 3 1  ON 16
ci_018                 1.077701e-02 3 1  ON 17
ci_019                -2.500999e-03 3 1  ON 18
ci_020                -2.454329e-03 3 1  ON 19
ci_021                -8.496336e-03 3 1  ON 20
ci_022                -8.682207e-03 3 1  ON 21
ci_023                 7.778322e-03 3 1  ON 22
ci_024                 8.055431e-03 3 1  ON 23
ci_025                 4.699277e-03 3 1  ON 24
ci_026                 4.291690e-03 3 1  ON 25
ci_027                 6.416390e-03 3 1  ON 26
ci_028                 6.430270e-03 3 1  ON 27
ci_029                -4.895146e-03 3 1  ON 28
ci_030                -4.770424e-03 3 1  ON 29
ci_031                -7.373443e-03 3 1  ON 30
ci_032                -8.192800e-03 3 1  ON 31
ci_033                 4.640281e-03 3 1  ON 32
ci_034                 4.381839e-03 3 1  ON 33
ci_035                 1.141670e-03 3 1  ON 34
ci_036                 1.053499e-03 3 1  ON 35
ci_037                 4.939515e-03 3 1  ON 36
ci_038                 5.087513e-03 3 1  ON 37
ci_039                 5.249036e-03 3 1  ON 38
ci_040                 5.307365e-03 3 1  ON 39
ci_041                 4.970452e-03 3 1  ON 40
ci_042                 5.219080e-03 3 1  ON 41
ci_043                 4.940058e-03 3 1  ON 42
ci_044                 4.946580e-03 3 1  ON 43
ci_045                 3.136312e-03 3 1  ON 44
ci_046                 3.196371e-03 3 1  ON 45
ci_047                -7.793990e-04 3 1  ON 46
ci_048                -5.485947e-04 3 1  ON 47
ci_049                 1.589306e-03 3 1  ON 48
ci_050                 1.814692e-03 3 1  ON 49
ci_051                -1.074571e-03 3 1  ON 50
ci_052                -1.241691e-03 3 1  ON 51
ci_053                -2.617734e-03 3 1  ON 52
ci_054                -2.286729e-03 3 1  ON 53
ci_055                -1.447550e-03 3 1  ON 54
ci_056                -1.360432e-03 3 1  ON 55
ci_057                -1.203210e-03 3 1  ON 56
ci_058                -1.689640e-03 3 1  ON 57
ci_059                 3.109986e-04 3 1  ON 58
ci_060                 1.541752e-04 3 1  ON 59
ci_061                -3.516206e-04 3 1  ON 60
ci_062                -1.287725e-05 3 1  ON 61
ci_063                -5.247849e-04 3 1  ON 62
ci_064                -9.059588e-04 3 1  ON 63
ci_065                -2.395804e-03 3 1  ON 64
ci_066                -2.441848e-03 3 1  ON 65
ci_067                -2.087315e-03 3 1  ON 66
ci_068                -2.497594e-03 3 1  ON 67
ci_069                -2.269140e-04 3 1  ON 68
ci_070                 1.344941e-04 3 1  ON 69
ci_071                -1.884839e-03 3 1  ON 70
ci_072                -1.948813e-03 3 1  ON 71
ci_073                 6.064721e-04 3 1  ON 72
ci_074                 2.923977e-04 3 1  ON 73
ci_075                -3.046789e-04 3 1  ON 74
ci_076                -3.357230e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 2.9299e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s031 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s031 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=31  my_counter=0
  time step      = 5.0000e-02
  blocks         = 250
  steps          = 250
  substeps       = 10
  current        = 0
  target samples = 8.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">250</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">6.2500e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">8.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">6.2500e+04</parameter>
<parameter name="steps" condition="int">250</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2664e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="250">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =8000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 31
    time step          = 0.05
    reference energy   = -22.5906
    reference variance = 0.393176
====================================================
  Execution time = 1.0030e+02
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s031
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 62500 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 6.1016e+04
  VMC Eavg = -2.2670e+01
  VMC Evar = 5.1366e-01
  Total weights = 7.820499185e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.9239e+01
  </log>
</opt>
<opt stage="main" walkers="62500">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.500674814112
                                         uncertainty =       0.002400592923

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.500674814112
                                         uncertainty =       0.002400592923

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000250169389
  error estimate for blocks of size 2^( 2) =       0.000259064868
  error estimate for blocks of size 2^( 3) =       0.000267102258
  error estimate for blocks of size 2^( 4) =       0.000272600369
  error estimate for blocks of size 2^( 5) =       0.000275954945
  error estimate for blocks of size 2^( 6) =       0.000277051612
  error estimate for blocks of size 2^( 7) =       0.000277772957
  error estimate for blocks of size 2^( 8) =       0.000277808461
  error estimate for blocks of size 2^( 9) =       0.000278870668

      target function =                  N/A
              le_mean =     -22.669672345788
             les_mean =     514.427699847183
             stat err =       0.000277875925
             autocorr =       1.233768008154
              std dev =       0.707585886339
             le_variance =       0.500677786546


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266967234579e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.4901e+00, overlap shift 1.4901e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.669672345810       residual = 3.72e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.669673214391       residual = 5.88e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.669673221920       residual = 2.46e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.669673211844       residual = 5.07e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 1.4901e+00 is 1.311839e-04

solving harmonic davidson linear method for identity shift 5.9605e+00, overlap shift 5.9605e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.669672345810       residual = 3.72e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.669672582139       residual = 6.49e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.669672586761       residual = 2.45e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.669672584398       residual = 5.69e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 5.9605e+00 is 3.713118e-05

solving harmonic davidson linear method for identity shift 2.3842e+01, overlap shift 2.3842e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.669672345810       residual = 3.72e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.669672406226       residual = 6.79e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.669672407611       residual = 2.58e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.669672407047       residual = 6.24e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 2.3842e+01 is 9.599460e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.062898 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.2168e+02
  </log>
  <optVariables href="FORM.s031.opt.xml">
ci_001                -7.050630e-01 3 1  ON 0
ci_002                -7.059931e-01 3 1  ON 1
ci_003                -3.767188e-02 3 1  ON 2
ci_004                -3.889008e-02 3 1  ON 3
ci_005                 1.610128e-02 3 1  ON 4
ci_006                 1.600366e-02 3 1  ON 5
ci_007                 1.225726e-02 3 1  ON 6
ci_008                 1.245397e-02 3 1  ON 7
ci_009                -1.170718e-02 3 1  ON 8
ci_010                -1.182002e-02 3 1  ON 9
ci_011                -8.193955e-03 3 1  ON 10
ci_012                -8.113839e-03 3 1  ON 11
ci_013                 9.670674e-03 3 1  ON 12
ci_014                 9.379870e-03 3 1  ON 13
ci_015                 1.232164e-02 3 1  ON 14
ci_016                 1.252741e-02 3 1  ON 15
ci_017                 1.084944e-02 3 1  ON 16
ci_018                 1.078012e-02 3 1  ON 17
ci_019                -2.503388e-03 3 1  ON 18
ci_020                -2.448238e-03 3 1  ON 19
ci_021                -8.485733e-03 3 1  ON 20
ci_022                -8.680209e-03 3 1  ON 21
ci_023                 7.799550e-03 3 1  ON 22
ci_024                 8.049809e-03 3 1  ON 23
ci_025                 4.687909e-03 3 1  ON 24
ci_026                 4.282321e-03 3 1  ON 25
ci_027                 6.429541e-03 3 1  ON 26
ci_028                 6.401145e-03 3 1  ON 27
ci_029                -4.897985e-03 3 1  ON 28
ci_030                -4.766181e-03 3 1  ON 29
ci_031                -7.408212e-03 3 1  ON 30
ci_032                -8.190614e-03 3 1  ON 31
ci_033                 4.626123e-03 3 1  ON 32
ci_034                 4.376082e-03 3 1  ON 33
ci_035                 1.156897e-03 3 1  ON 34
ci_036                 1.067300e-03 3 1  ON 35
ci_037                 4.935374e-03 3 1  ON 36
ci_038                 5.092841e-03 3 1  ON 37
ci_039                 5.251652e-03 3 1  ON 38
ci_040                 5.307162e-03 3 1  ON 39
ci_041                 4.963360e-03 3 1  ON 40
ci_042                 5.200941e-03 3 1  ON 41
ci_043                 4.948936e-03 3 1  ON 42
ci_044                 4.919869e-03 3 1  ON 43
ci_045                 3.136601e-03 3 1  ON 44
ci_046                 3.188714e-03 3 1  ON 45
ci_047                -7.580823e-04 3 1  ON 46
ci_048                -5.449054e-04 3 1  ON 47
ci_049                 1.597262e-03 3 1  ON 48
ci_050                 1.812784e-03 3 1  ON 49
ci_051                -1.084602e-03 3 1  ON 50
ci_052                -1.249971e-03 3 1  ON 51
ci_053                -2.613824e-03 3 1  ON 52
ci_054                -2.287706e-03 3 1  ON 53
ci_055                -1.448780e-03 3 1  ON 54
ci_056                -1.378000e-03 3 1  ON 55
ci_057                -1.214266e-03 3 1  ON 56
ci_058                -1.686172e-03 3 1  ON 57
ci_059                 3.036127e-04 3 1  ON 58
ci_060                 1.701224e-04 3 1  ON 59
ci_061                -3.565818e-04 3 1  ON 60
ci_062                -3.340120e-05 3 1  ON 61
ci_063                -5.473807e-04 3 1  ON 62
ci_064                -9.057590e-04 3 1  ON 63
ci_065                -2.391106e-03 3 1  ON 64
ci_066                -2.441842e-03 3 1  ON 65
ci_067                -2.111295e-03 3 1  ON 66
ci_068                -2.499069e-03 3 1  ON 67
ci_069                -2.204616e-04 3 1  ON 68
ci_070                 1.322422e-04 3 1  ON 69
ci_071                -1.881705e-03 3 1  ON 70
ci_072                -1.968630e-03 3 1  ON 71
ci_073                 5.693409e-04 3 1  ON 72
ci_074                 3.133757e-04 3 1  ON 73
ci_075                -2.910678e-04 3 1  ON 74
ci_076                -3.353558e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="250">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =8000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 31
    time step          = 0.05
    reference energy   = -22.6666
    reference variance = 0.420402
====================================================
  Execution time = 9.9883e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s031
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 62500 
  VMC Eavg = -2.2669e+01
  VMC Evar = 5.0741e-01
  Total weights = 7.8210e+06
  Execution time = 1.4650e+01
  </log>
</opt>
<opt stage="main" walkers="62500">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.495475228679
                                         uncertainty =       0.001314129559

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.495475228679
                                         uncertainty =       0.001314129559

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000248866226
  error estimate for blocks of size 2^( 2) =       0.000257835521
  error estimate for blocks of size 2^( 3) =       0.000265827435
  error estimate for blocks of size 2^( 4) =       0.000271578544
  error estimate for blocks of size 2^( 5) =       0.000274871460
  error estimate for blocks of size 2^( 6) =       0.000276568930
  error estimate for blocks of size 2^( 7) =       0.000277980101
  error estimate for blocks of size 2^( 8) =       0.000278316461
  error estimate for blocks of size 2^( 9) =       0.000278104174

      target function =                  N/A
              le_mean =     -22.669464601407
             les_mean =     514.412052734836
             stat err =       0.000277742416
             autocorr =       1.245525128067
              std dev =       0.703899985421
             le_variance =       0.495475189475

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.495490793615
                                         uncertainty =       0.001315153988

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.495490793615
                                         uncertainty =       0.001315153988

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000248870135
  error estimate for blocks of size 2^( 2) =       0.000257839436
  error estimate for blocks of size 2^( 3) =       0.000265831146
  error estimate for blocks of size 2^( 4) =       0.000271582525
  error estimate for blocks of size 2^( 5) =       0.000274875960
  error estimate for blocks of size 2^( 6) =       0.000276573336
  error estimate for blocks of size 2^( 7) =       0.000277985469
  error estimate for blocks of size 2^( 8) =       0.000278322142
  error estimate for blocks of size 2^( 9) =       0.000278109406

      target function =                  N/A
              le_mean =     -22.669464541257
             les_mean =     514.412187670523
             stat err =       0.000277747589
             autocorr =       1.245532396565
              std dev =       0.703911039599
             le_variance =       0.495490751670

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.495482919952
                                         uncertainty =       0.001314672527

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.495482919952
                                         uncertainty =       0.001314672527

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000248868158
  error estimate for blocks of size 2^( 2) =       0.000257837465
  error estimate for blocks of size 2^( 3) =       0.000265829269
  error estimate for blocks of size 2^( 4) =       0.000271580556
  error estimate for blocks of size 2^( 5) =       0.000274873775
  error estimate for blocks of size 2^( 6) =       0.000276571154
  error estimate for blocks of size 2^( 7) =       0.000277982855
  error estimate for blocks of size 2^( 8) =       0.000278319448
  error estimate for blocks of size 2^( 9) =       0.000278106852

      target function =                  N/A
              le_mean =     -22.669464536656
             les_mean =     514.413028967765
             stat err =       0.000277745077
             autocorr =       1.245529662103
              std dev =       0.703905447671
             le_variance =       0.495482879261

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.495476129903
                                         uncertainty =       0.001314197996

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.495476129903
                                         uncertainty =       0.001314197996

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000248866453
  error estimate for blocks of size 2^( 2) =       0.000257835747
  error estimate for blocks of size 2^( 3) =       0.000265827648
  error estimate for blocks of size 2^( 4) =       0.000271578775
  error estimate for blocks of size 2^( 5) =       0.000274871726
  error estimate for blocks of size 2^( 6) =       0.000276569191
  error estimate for blocks of size 2^( 7) =       0.000277980423
  error estimate for blocks of size 2^( 8) =       0.000278316803
  error estimate for blocks of size 2^( 9) =       0.000278104493

      target function =                  N/A
              le_mean =     -22.669464576273
             les_mean =     514.412135625405
             stat err =       0.000277742728
             autocorr =       1.245525656578
              std dev =       0.703900625446
             le_variance =       0.495476090503


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.669464601407        initial  <--
     1.4901e+00     1.4901e+01             1.3118e-04       -22.669464541257
     5.9605e+00     5.9605e+01             3.7131e-05       -22.669464536656
     2.3842e+01     2.3842e+02             9.5995e-06       -22.669464576273

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 173.1305
  </log>
  <optVariables href="FORM.s031.opt.xml">
ci_001                -7.050648e-01 3 1  ON 0
ci_002                -7.059904e-01 3 1  ON 1
ci_003                -3.765740e-02 3 1  ON 2
ci_004                -3.890344e-02 3 1  ON 3
ci_005                 1.611024e-02 3 1  ON 4
ci_006                 1.599927e-02 3 1  ON 5
ci_007                 1.225570e-02 3 1  ON 6
ci_008                 1.245970e-02 3 1  ON 7
ci_009                -1.171480e-02 3 1  ON 8
ci_010                -1.183520e-02 3 1  ON 9
ci_011                -8.187883e-03 3 1  ON 10
ci_012                -8.121344e-03 3 1  ON 11
ci_013                 9.676194e-03 3 1  ON 12
ci_014                 9.372218e-03 3 1  ON 13
ci_015                 1.231894e-02 3 1  ON 14
ci_016                 1.252461e-02 3 1  ON 15
ci_017                 1.086908e-02 3 1  ON 16
ci_018                 1.077701e-02 3 1  ON 17
ci_019                -2.500999e-03 3 1  ON 18
ci_020                -2.454329e-03 3 1  ON 19
ci_021                -8.496336e-03 3 1  ON 20
ci_022                -8.682207e-03 3 1  ON 21
ci_023                 7.778322e-03 3 1  ON 22
ci_024                 8.055431e-03 3 1  ON 23
ci_025                 4.699277e-03 3 1  ON 24
ci_026                 4.291690e-03 3 1  ON 25
ci_027                 6.416390e-03 3 1  ON 26
ci_028                 6.430270e-03 3 1  ON 27
ci_029                -4.895146e-03 3 1  ON 28
ci_030                -4.770424e-03 3 1  ON 29
ci_031                -7.373443e-03 3 1  ON 30
ci_032                -8.192800e-03 3 1  ON 31
ci_033                 4.640281e-03 3 1  ON 32
ci_034                 4.381839e-03 3 1  ON 33
ci_035                 1.141670e-03 3 1  ON 34
ci_036                 1.053499e-03 3 1  ON 35
ci_037                 4.939515e-03 3 1  ON 36
ci_038                 5.087513e-03 3 1  ON 37
ci_039                 5.249036e-03 3 1  ON 38
ci_040                 5.307365e-03 3 1  ON 39
ci_041                 4.970452e-03 3 1  ON 40
ci_042                 5.219080e-03 3 1  ON 41
ci_043                 4.940058e-03 3 1  ON 42
ci_044                 4.946580e-03 3 1  ON 43
ci_045                 3.136312e-03 3 1  ON 44
ci_046                 3.196371e-03 3 1  ON 45
ci_047                -7.793990e-04 3 1  ON 46
ci_048                -5.485947e-04 3 1  ON 47
ci_049                 1.589306e-03 3 1  ON 48
ci_050                 1.814692e-03 3 1  ON 49
ci_051                -1.074571e-03 3 1  ON 50
ci_052                -1.241691e-03 3 1  ON 51
ci_053                -2.617734e-03 3 1  ON 52
ci_054                -2.286729e-03 3 1  ON 53
ci_055                -1.447550e-03 3 1  ON 54
ci_056                -1.360432e-03 3 1  ON 55
ci_057                -1.203210e-03 3 1  ON 56
ci_058                -1.689640e-03 3 1  ON 57
ci_059                 3.109986e-04 3 1  ON 58
ci_060                 1.541752e-04 3 1  ON 59
ci_061                -3.516206e-04 3 1  ON 60
ci_062                -1.287725e-05 3 1  ON 61
ci_063                -5.247849e-04 3 1  ON 62
ci_064                -9.059588e-04 3 1  ON 63
ci_065                -2.395804e-03 3 1  ON 64
ci_066                -2.441848e-03 3 1  ON 65
ci_067                -2.087315e-03 3 1  ON 66
ci_068                -2.497594e-03 3 1  ON 67
ci_069                -2.269140e-04 3 1  ON 68
ci_070                 1.344941e-04 3 1  ON 69
ci_071                -1.884839e-03 3 1  ON 70
ci_072                -1.948813e-03 3 1  ON 71
ci_073                 6.064721e-04 3 1  ON 72
ci_074                 2.923977e-04 3 1  ON 73
ci_075                -3.046789e-04 3 1  ON 74
ci_076                -3.357230e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 2.9481e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s032 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s032 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=32  my_counter=0
  time step      = 5.0000e-02
  blocks         = 250
  steps          = 250
  substeps       = 10
  current        = 0
  target samples = 8.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">250</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">6.2500e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">8.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">6.2500e+04</parameter>
<parameter name="steps" condition="int">250</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2663e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="250">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =8000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 32
    time step          = 0.05
    reference energy   = -22.6805
    reference variance = 0.455161
====================================================
  Execution time = 1.0059e+02
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s032
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 62500 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 6.1100e+04
  VMC Eavg = -2.2669e+01
  VMC Evar = 5.0760e-01
  Total weights = 7.820847387e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.8922e+01
  </log>
</opt>
<opt stage="main" walkers="62500">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.495896444043
                                         uncertainty =       0.001599111459

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.495896444043
                                         uncertainty =       0.001599111459

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000248972461
  error estimate for blocks of size 2^( 2) =       0.000257969193
  error estimate for blocks of size 2^( 3) =       0.000266059825
  error estimate for blocks of size 2^( 4) =       0.000271666716
  error estimate for blocks of size 2^( 5) =       0.000275326380
  error estimate for blocks of size 2^( 6) =       0.000276852314
  error estimate for blocks of size 2^( 7) =       0.000277812733
  error estimate for blocks of size 2^( 8) =       0.000278980332
  error estimate for blocks of size 2^( 9) =       0.000279895480

      target function =                  N/A
              le_mean =     -22.669381656742
             les_mean =     514.408460891231
             stat err =       0.000278385215
             autocorr =       1.250229393105
              std dev =       0.704200463285
             le_variance =       0.495898292491


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266938165674e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.4901e+01, overlap shift 1.4901e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.669381656767       residual = 3.91e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.669381712596       residual = 5.72e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.669381709991       residual = 1.87e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.669381710569       residual = 5.83e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 1.4901e+01 is 1.320279e-05

solving harmonic davidson linear method for identity shift 5.9605e+01, overlap shift 5.9605e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.669381656767       residual = 3.91e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.669381670846       residual = 5.89e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.669381670126       residual = 1.97e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.669381670289       residual = 6.09e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 5.9605e+01 is 3.326414e-06

solving harmonic davidson linear method for identity shift 2.3842e+02, overlap shift 2.3842e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.669381656767       residual = 3.91e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.669381660295       residual = 5.94e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.669381660110       residual = 2.00e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.669381660152       residual = 6.16e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 2.3842e+02 is 8.332267e-07

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.064262 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.1953e+02
  </log>
  <optVariables href="FORM.s032.opt.xml">
ci_001                -7.050650e-01 3 1  ON 0
ci_002                -7.059901e-01 3 1  ON 1
ci_003                -3.765776e-02 3 1  ON 2
ci_004                -3.890326e-02 3 1  ON 3
ci_005                 1.611091e-02 3 1  ON 4
ci_006                 1.599731e-02 3 1  ON 5
ci_007                 1.225606e-02 3 1  ON 6
ci_008                 1.246016e-02 3 1  ON 7
ci_009                -1.171575e-02 3 1  ON 8
ci_010                -1.183471e-02 3 1  ON 9
ci_011                -8.189212e-03 3 1  ON 10
ci_012                -8.121110e-03 3 1  ON 11
ci_013                 9.675013e-03 3 1  ON 12
ci_014                 9.371593e-03 3 1  ON 13
ci_015                 1.232123e-02 3 1  ON 14
ci_016                 1.252531e-02 3 1  ON 15
ci_017                 1.086800e-02 3 1  ON 16
ci_018                 1.077792e-02 3 1  ON 17
ci_019                -2.502756e-03 3 1  ON 18
ci_020                -2.453718e-03 3 1  ON 19
ci_021                -8.494087e-03 3 1  ON 20
ci_022                -8.680762e-03 3 1  ON 21
ci_023                 7.778704e-03 3 1  ON 22
ci_024                 8.054754e-03 3 1  ON 23
ci_025                 4.698395e-03 3 1  ON 24
ci_026                 4.291774e-03 3 1  ON 25
ci_027                 6.418145e-03 3 1  ON 26
ci_028                 6.433184e-03 3 1  ON 27
ci_029                -4.896034e-03 3 1  ON 28
ci_030                -4.769945e-03 3 1  ON 29
ci_031                -7.373410e-03 3 1  ON 30
ci_032                -8.191741e-03 3 1  ON 31
ci_033                 4.640738e-03 3 1  ON 32
ci_034                 4.381516e-03 3 1  ON 33
ci_035                 1.142815e-03 3 1  ON 34
ci_036                 1.052539e-03 3 1  ON 35
ci_037                 4.941287e-03 3 1  ON 36
ci_038                 5.087140e-03 3 1  ON 37
ci_039                 5.250868e-03 3 1  ON 38
ci_040                 5.309607e-03 3 1  ON 39
ci_041                 4.969787e-03 3 1  ON 40
ci_042                 5.219614e-03 3 1  ON 41
ci_043                 4.940198e-03 3 1  ON 42
ci_044                 4.946657e-03 3 1  ON 43
ci_045                 3.132986e-03 3 1  ON 44
ci_046                 3.194249e-03 3 1  ON 45
ci_047                -7.788227e-04 3 1  ON 46
ci_048                -5.507647e-04 3 1  ON 47
ci_049                 1.589440e-03 3 1  ON 48
ci_050                 1.814296e-03 3 1  ON 49
ci_051                -1.076540e-03 3 1  ON 50
ci_052                -1.244399e-03 3 1  ON 51
ci_053                -2.617695e-03 3 1  ON 52
ci_054                -2.285690e-03 3 1  ON 53
ci_055                -1.447286e-03 3 1  ON 54
ci_056                -1.360252e-03 3 1  ON 55
ci_057                -1.205639e-03 3 1  ON 56
ci_058                -1.690582e-03 3 1  ON 57
ci_059                 3.109896e-04 3 1  ON 58
ci_060                 1.552332e-04 3 1  ON 59
ci_061                -3.519216e-04 3 1  ON 60
ci_062                -1.376930e-05 3 1  ON 61
ci_063                -5.224533e-04 3 1  ON 62
ci_064                -9.064102e-04 3 1  ON 63
ci_065                -2.395153e-03 3 1  ON 64
ci_066                -2.442135e-03 3 1  ON 65
ci_067                -2.088574e-03 3 1  ON 66
ci_068                -2.498508e-03 3 1  ON 67
ci_069                -2.265570e-04 3 1  ON 68
ci_070                 1.335416e-04 3 1  ON 69
ci_071                -1.885785e-03 3 1  ON 70
ci_072                -1.950032e-03 3 1  ON 71
ci_073                 6.037121e-04 3 1  ON 72
ci_074                 2.908807e-04 3 1  ON 73
ci_075                -3.026775e-04 3 1  ON 74
ci_076                -3.350665e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="250">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =8000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 32
    time step          = 0.05
    reference energy   = -22.575
    reference variance = 0.456296
====================================================
  Execution time = 1.0141e+02
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s032
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 62500 
  VMC Eavg = -2.2670e+01
  VMC Evar = 5.1000e-01
  Total weights = 7.8209e+06
  Execution time = 1.4664e+01
  </log>
</opt>
<opt stage="main" walkers="62500">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.495965778913
                                         uncertainty =       0.001241393911

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.495965778913
                                         uncertainty =       0.001241393911

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000248989093
  error estimate for blocks of size 2^( 2) =       0.000257982340
  error estimate for blocks of size 2^( 3) =       0.000265978772
  error estimate for blocks of size 2^( 4) =       0.000271803135
  error estimate for blocks of size 2^( 5) =       0.000275328777
  error estimate for blocks of size 2^( 6) =       0.000277094576
  error estimate for blocks of size 2^( 7) =       0.000277994605
  error estimate for blocks of size 2^( 8) =       0.000279358662
  error estimate for blocks of size 2^( 9) =       0.000280568386

      target function =                  N/A
              le_mean =     -22.669765170949
             les_mean =     514.428248352331
             stat err =       0.000278754057
             autocorr =       1.253377075234
              std dev =       0.704247504983
             le_variance =       0.495964548275

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.495964490778
                                         uncertainty =       0.001241286989

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.495964490778
                                         uncertainty =       0.001241286989

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000248988770
  error estimate for blocks of size 2^( 2) =       0.000257982041
  error estimate for blocks of size 2^( 3) =       0.000265978517
  error estimate for blocks of size 2^( 4) =       0.000271802933
  error estimate for blocks of size 2^( 5) =       0.000275328529
  error estimate for blocks of size 2^( 6) =       0.000277094351
  error estimate for blocks of size 2^( 7) =       0.000277994416
  error estimate for blocks of size 2^( 8) =       0.000279358521
  error estimate for blocks of size 2^( 9) =       0.000280567911

      target function =                  N/A
              le_mean =     -22.669765237859
             les_mean =     514.428253494898
             stat err =       0.000278753800
             autocorr =       1.253378015818
              std dev =       0.704246590619
             le_variance =       0.495963260399

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.495965118036
                                         uncertainty =       0.001241339782

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.495965118036
                                         uncertainty =       0.001241339782

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000248988927
  error estimate for blocks of size 2^( 2) =       0.000257982187
  error estimate for blocks of size 2^( 3) =       0.000265978641
  error estimate for blocks of size 2^( 4) =       0.000271803030
  error estimate for blocks of size 2^( 5) =       0.000275328649
  error estimate for blocks of size 2^( 6) =       0.000277094460
  error estimate for blocks of size 2^( 7) =       0.000277994508
  error estimate for blocks of size 2^( 8) =       0.000279358589
  error estimate for blocks of size 2^( 9) =       0.000280568144

      target function =                  N/A
              le_mean =     -22.669765203660
             les_mean =     514.428249790697
             stat err =       0.000278753925
             autocorr =       1.253377558799
              std dev =       0.704247035869
             le_variance =       0.495963887530

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.495965695149
                                         uncertainty =       0.001241387110

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.495965695149
                                         uncertainty =       0.001241387110

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000248989072
  error estimate for blocks of size 2^( 2) =       0.000257982321
  error estimate for blocks of size 2^( 3) =       0.000265978755
  error estimate for blocks of size 2^( 4) =       0.000271803121
  error estimate for blocks of size 2^( 5) =       0.000275328761
  error estimate for blocks of size 2^( 6) =       0.000277094561
  error estimate for blocks of size 2^( 7) =       0.000277994592
  error estimate for blocks of size 2^( 8) =       0.000279358652
  error estimate for blocks of size 2^( 9) =       0.000280568356

      target function =                  N/A
              le_mean =     -22.669765174943
             les_mean =     514.428248379694
             stat err =       0.000278754040
             autocorr =       1.253377136758
              std dev =       0.704247445524
             le_variance =       0.495964464527


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.669765170949        initial
     1.4901e+01     1.4901e+02             1.3203e-05       -22.669765237859  <--
     5.9605e+01     5.9605e+02             3.3264e-06       -22.669765203660
     2.3842e+02     2.3842e+03             8.3323e-07       -22.669765174943

*****************************************************************************
Applying the update for shift_i =   1.4901e+01     and shift_s =   1.4901e+02
*****************************************************************************

  Execution time = 1.7476e+02
  </log>
  <optVariables href="FORM.s032.opt.xml">
ci_001                -7.050655e-01 3 1  ON 0
ci_002                -7.059894e-01 3 1  ON 1
ci_003                -3.765883e-02 3 1  ON 2
ci_004                -3.890273e-02 3 1  ON 3
ci_005                 1.611289e-02 3 1  ON 4
ci_006                 1.599150e-02 3 1  ON 5
ci_007                 1.225714e-02 3 1  ON 6
ci_008                 1.246157e-02 3 1  ON 7
ci_009                -1.171858e-02 3 1  ON 8
ci_010                -1.183326e-02 3 1  ON 9
ci_011                -8.193171e-03 3 1  ON 10
ci_012                -8.120420e-03 3 1  ON 11
ci_013                 9.671514e-03 3 1  ON 12
ci_014                 9.369734e-03 3 1  ON 13
ci_015                 1.232805e-02 3 1  ON 14
ci_016                 1.252740e-02 3 1  ON 15
ci_017                 1.086480e-02 3 1  ON 16
ci_018                 1.078063e-02 3 1  ON 17
ci_019                -2.507986e-03 3 1  ON 18
ci_020                -2.451907e-03 3 1  ON 19
ci_021                -8.487384e-03 3 1  ON 20
ci_022                -8.676469e-03 3 1  ON 21
ci_023                 7.779829e-03 3 1  ON 22
ci_024                 8.052746e-03 3 1  ON 23
ci_025                 4.695783e-03 3 1  ON 24
ci_026                 4.292021e-03 3 1  ON 25
ci_027                 6.423316e-03 3 1  ON 26
ci_028                 6.441775e-03 3 1  ON 27
ci_029                -4.898681e-03 3 1  ON 28
ci_030                -4.768520e-03 3 1  ON 29
ci_031                -7.373314e-03 3 1  ON 30
ci_032                -8.188598e-03 3 1  ON 31
ci_033                 4.642113e-03 3 1  ON 32
ci_034                 4.380566e-03 3 1  ON 33
ci_035                 1.146188e-03 3 1  ON 34
ci_036                 1.049710e-03 3 1  ON 35
ci_037                 4.946536e-03 3 1  ON 36
ci_038                 5.086028e-03 3 1  ON 37
ci_039                 5.256264e-03 3 1  ON 38
ci_040                 5.316218e-03 3 1  ON 39
ci_041                 4.967818e-03 3 1  ON 40
ci_042                 5.221191e-03 3 1  ON 41
ci_043                 4.940607e-03 3 1  ON 42
ci_044                 4.946881e-03 3 1  ON 43
ci_045                 3.123109e-03 3 1  ON 44
ci_046                 3.187951e-03 3 1  ON 45
ci_047                -7.771233e-04 3 1  ON 46
ci_048                -5.571527e-04 3 1  ON 47
ci_049                 1.589837e-03 3 1  ON 48
ci_050                 1.813121e-03 3 1  ON 49
ci_051                -1.082381e-03 3 1  ON 50
ci_052                -1.252437e-03 3 1  ON 51
ci_053                -2.617569e-03 3 1  ON 52
ci_054                -2.282603e-03 3 1  ON 53
ci_055                -1.446489e-03 3 1  ON 54
ci_056                -1.359714e-03 3 1  ON 55
ci_057                -1.212836e-03 3 1  ON 56
ci_058                -1.693372e-03 3 1  ON 57
ci_059                 3.109753e-04 3 1  ON 58
ci_060                 1.583543e-04 3 1  ON 59
ci_061                -3.528119e-04 3 1  ON 60
ci_062                -1.641570e-05 3 1  ON 61
ci_063                -5.155345e-04 3 1  ON 62
ci_064                -9.077558e-04 3 1  ON 63
ci_065                -2.393224e-03 3 1  ON 64
ci_066                -2.442988e-03 3 1  ON 65
ci_067                -2.092313e-03 3 1  ON 66
ci_068                -2.501230e-03 3 1  ON 67
ci_069                -2.255049e-04 3 1  ON 68
ci_070                 1.307118e-04 3 1  ON 69
ci_071                -1.888581e-03 3 1  ON 70
ci_072                -1.953635e-03 3 1  ON 71
ci_073                 5.955743e-04 3 1  ON 72
ci_074                 2.864034e-04 3 1  ON 73
ci_075                -2.967436e-04 3 1  ON 74
ci_076                -3.331173e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 2.9429e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s033 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s033 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=33  my_counter=0
  time step      = 5.0000e-02
  blocks         = 250
  steps          = 250
  substeps       = 10
  current        = 0
  target samples = 8.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">250</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">6.2500e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">8.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">6.2500e+04</parameter>
<parameter name="steps" condition="int">250</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2662e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="250">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =8000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 33
    time step          = 0.05
    reference energy   = -22.57
    reference variance = 0.645155
====================================================
  Execution time = 1.0033e+02
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s033
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 62500 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 6.1111e+04
  VMC Eavg = -2.2670e+01
  VMC Evar = 5.0875e-01
  Total weights = 7.820778963e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.8954e+01
  </log>
</opt>
<opt stage="main" walkers="62500">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.495954966714
                                         uncertainty =       0.001471905850

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.495954966714
                                         uncertainty =       0.001471905850

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000248987194
  error estimate for blocks of size 2^( 2) =       0.000258009617
  error estimate for blocks of size 2^( 3) =       0.000266063602
  error estimate for blocks of size 2^( 4) =       0.000271574272
  error estimate for blocks of size 2^( 5) =       0.000274751447
  error estimate for blocks of size 2^( 6) =       0.000276211548
  error estimate for blocks of size 2^( 7) =       0.000276952924
  error estimate for blocks of size 2^( 8) =       0.000277392374
  error estimate for blocks of size 2^( 9) =       0.000278272316

      target function =                  N/A
              le_mean =     -22.669759045002
             les_mean =     514.426723544194
             stat err =       0.000277207290
             autocorr =       1.239524953540
              std dev =       0.704242132705
             le_variance =       0.495956981476


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266975904500e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.7253e+00, overlap shift 3.7253e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.669759045025       residual = 4.08e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.669759392480       residual = 4.09e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.669759398270       residual = 1.24e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.669759396944       residual = 5.09e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 3.7253e+00 is 5.057049e-05

solving harmonic davidson linear method for identity shift 1.4901e+01, overlap shift 1.4901e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.669759045025       residual = 4.08e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.669759134612       residual = 4.53e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.669759137136       residual = 1.47e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.669759136684       residual = 5.76e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 1.4901e+01 is 1.330213e-05

solving harmonic davidson linear method for identity shift 5.9605e+01, overlap shift 5.9605e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.669759045025       residual = 4.08e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.669759067599       residual = 4.66e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.669759068303       residual = 1.54e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.669759068183       residual = 5.96e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 5.9605e+01 is 3.369446e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.065631 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.1929e+02
  </log>
  <optVariables href="FORM.s033.opt.xml">
ci_001                -7.050645e-01 3 1  ON 0
ci_002                -7.059900e-01 3 1  ON 1
ci_003                -3.765527e-02 3 1  ON 2
ci_004                -3.890387e-02 3 1  ON 3
ci_005                 1.611626e-02 3 1  ON 4
ci_006                 1.599456e-02 3 1  ON 5
ci_007                 1.226735e-02 3 1  ON 6
ci_008                 1.246254e-02 3 1  ON 7
ci_009                -1.172328e-02 3 1  ON 8
ci_010                -1.183074e-02 3 1  ON 9
ci_011                -8.187221e-03 3 1  ON 10
ci_012                -8.125444e-03 3 1  ON 11
ci_013                 9.666223e-03 3 1  ON 12
ci_014                 9.366087e-03 3 1  ON 13
ci_015                 1.231839e-02 3 1  ON 14
ci_016                 1.253420e-02 3 1  ON 15
ci_017                 1.086938e-02 3 1  ON 16
ci_018                 1.078216e-02 3 1  ON 17
ci_019                -2.510898e-03 3 1  ON 18
ci_020                -2.447247e-03 3 1  ON 19
ci_021                -8.481962e-03 3 1  ON 20
ci_022                -8.672954e-03 3 1  ON 21
ci_023                 7.784651e-03 3 1  ON 22
ci_024                 8.054094e-03 3 1  ON 23
ci_025                 4.700783e-03 3 1  ON 24
ci_026                 4.288799e-03 3 1  ON 25
ci_027                 6.427953e-03 3 1  ON 26
ci_028                 6.451678e-03 3 1  ON 27
ci_029                -4.897211e-03 3 1  ON 28
ci_030                -4.774140e-03 3 1  ON 29
ci_031                -7.378031e-03 3 1  ON 30
ci_032                -8.175759e-03 3 1  ON 31
ci_033                 4.632709e-03 3 1  ON 32
ci_034                 4.389090e-03 3 1  ON 33
ci_035                 1.142294e-03 3 1  ON 34
ci_036                 1.047169e-03 3 1  ON 35
ci_037                 4.945853e-03 3 1  ON 36
ci_038                 5.089893e-03 3 1  ON 37
ci_039                 5.269566e-03 3 1  ON 38
ci_040                 5.319290e-03 3 1  ON 39
ci_041                 4.969127e-03 3 1  ON 40
ci_042                 5.224673e-03 3 1  ON 41
ci_043                 4.945365e-03 3 1  ON 42
ci_044                 4.947612e-03 3 1  ON 43
ci_045                 3.120656e-03 3 1  ON 44
ci_046                 3.186020e-03 3 1  ON 45
ci_047                -7.776802e-04 3 1  ON 46
ci_048                -5.569570e-04 3 1  ON 47
ci_049                 1.587189e-03 3 1  ON 48
ci_050                 1.808503e-03 3 1  ON 49
ci_051                -1.086948e-03 3 1  ON 50
ci_052                -1.253847e-03 3 1  ON 51
ci_053                -2.614530e-03 3 1  ON 52
ci_054                -2.282073e-03 3 1  ON 53
ci_055                -1.453968e-03 3 1  ON 54
ci_056                -1.366428e-03 3 1  ON 55
ci_057                -1.217642e-03 3 1  ON 56
ci_058                -1.705104e-03 3 1  ON 57
ci_059                 3.142187e-04 3 1  ON 58
ci_060                 1.533823e-04 3 1  ON 59
ci_061                -3.478299e-04 3 1  ON 60
ci_062                -1.501933e-05 3 1  ON 61
ci_063                -5.143213e-04 3 1  ON 62
ci_064                -9.026814e-04 3 1  ON 63
ci_065                -2.396677e-03 3 1  ON 64
ci_066                -2.440922e-03 3 1  ON 65
ci_067                -2.096763e-03 3 1  ON 66
ci_068                -2.495163e-03 3 1  ON 67
ci_069                -2.235203e-04 3 1  ON 68
ci_070                 1.308844e-04 3 1  ON 69
ci_071                -1.884030e-03 3 1  ON 70
ci_072                -1.956334e-03 3 1  ON 71
ci_073                 5.903214e-04 3 1  ON 72
ci_074                 2.874718e-04 3 1  ON 73
ci_075                -2.936102e-04 3 1  ON 74
ci_076                -3.243794e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="250">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =8000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 33
    time step          = 0.05
    reference energy   = -22.7496
    reference variance = 0.393291
====================================================
  Execution time = 1.0134e+02
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s033
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 62500 
  VMC Eavg = -2.2670e+01
  VMC Evar = 5.0792e-01
  Total weights = 7.8208e+06
  Execution time = 1.4602e+01
  </log>
</opt>
<opt stage="main" walkers="62500">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.495922205104
                                         uncertainty =       0.001422579574

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.495922205104
                                         uncertainty =       0.001422579574

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000248977629
  error estimate for blocks of size 2^( 2) =       0.000257846797
  error estimate for blocks of size 2^( 3) =       0.000266008007
  error estimate for blocks of size 2^( 4) =       0.000271642716
  error estimate for blocks of size 2^( 5) =       0.000274976413
  error estimate for blocks of size 2^( 6) =       0.000276685227
  error estimate for blocks of size 2^( 7) =       0.000277316254
  error estimate for blocks of size 2^( 8) =       0.000278434137
  error estimate for blocks of size 2^( 9) =       0.000280040546

      target function =                  N/A
              le_mean =     -22.669748479694
             les_mean =     514.425407340016
             stat err =       0.000278119041
             autocorr =       1.247787966928
              std dev =       0.704215078529
             le_variance =       0.495918876828

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.495932762704
                                         uncertainty =       0.001424245128

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.495932762704
                                         uncertainty =       0.001424245128

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000248980277
  error estimate for blocks of size 2^( 2) =       0.000257849069
  error estimate for blocks of size 2^( 3) =       0.000266009947
  error estimate for blocks of size 2^( 4) =       0.000271644393
  error estimate for blocks of size 2^( 5) =       0.000274977682
  error estimate for blocks of size 2^( 6) =       0.000276686669
  error estimate for blocks of size 2^( 7) =       0.000277318448
  error estimate for blocks of size 2^( 8) =       0.000278436904
  error estimate for blocks of size 2^( 9) =       0.000280043760

      target function =                  N/A
              le_mean =     -22.669748895190
             les_mean =     514.428107830659
             stat err =       0.000278121445
             autocorr =       1.247782998018
              std dev =       0.704222568630
             le_variance =       0.495929426168

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.495927339839
                                         uncertainty =       0.001423390295

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.495927339839
                                         uncertainty =       0.001423390295

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000248978917
  error estimate for blocks of size 2^( 2) =       0.000257847893
  error estimate for blocks of size 2^( 3) =       0.000266008958
  error estimate for blocks of size 2^( 4) =       0.000271643552
  error estimate for blocks of size 2^( 5) =       0.000274977031
  error estimate for blocks of size 2^( 6) =       0.000276685959
  error estimate for blocks of size 2^( 7) =       0.000277317379
  error estimate for blocks of size 2^( 8) =       0.000278435370
  error estimate for blocks of size 2^( 9) =       0.000280042020

      target function =                  N/A
              le_mean =     -22.669748644225
             les_mean =     514.426147707543
             stat err =       0.000278120182
             autocorr =       1.247785296239
              std dev =       0.704218721360
             le_variance =       0.495924007514

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.495922821795
                                         uncertainty =       0.001422677347

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.495922821795
                                         uncertainty =       0.001422677347

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000248977783
  error estimate for blocks of size 2^( 2) =       0.000257846928
  error estimate for blocks of size 2^( 3) =       0.000266008118
  error estimate for blocks of size 2^( 4) =       0.000271642811
  error estimate for blocks of size 2^( 5) =       0.000274976481
  error estimate for blocks of size 2^( 6) =       0.000276685306
  error estimate for blocks of size 2^( 7) =       0.000277316380
  error estimate for blocks of size 2^( 8) =       0.000278434277
  error estimate for blocks of size 2^( 9) =       0.000280040719

      target function =                  N/A
              le_mean =     -22.669748500319
             les_mean =     514.425408845456
             stat err =       0.000278119170
             autocorr =       1.247787579501
              std dev =       0.704215516035
             le_variance =       0.495919493024


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.669748479694        initial
     3.7253e+00     3.7253e+01             5.0570e-05       -22.669748895190  <--
     1.4901e+01     1.4901e+02             1.3302e-05       -22.669748644225
     5.9605e+01     5.9605e+02             3.3694e-06       -22.669748500319

*****************************************************************************
Applying the update for shift_i =   3.7253e+00     and shift_s =   3.7253e+01
*****************************************************************************

  Execution time = 1.7440e+02
  </log>
  <optVariables href="FORM.s033.opt.xml">
ci_001                -7.050616e-01 3 1  ON 0
ci_002                -7.059918e-01 3 1  ON 1
ci_003                -3.764466e-02 3 1  ON 2
ci_004                -3.890721e-02 3 1  ON 3
ci_005                 1.612563e-02 3 1  ON 4
ci_006                 1.600313e-02 3 1  ON 5
ci_007                 1.229676e-02 3 1  ON 6
ci_008                 1.246543e-02 3 1  ON 7
ci_009                -1.173671e-02 3 1  ON 8
ci_010                -1.182346e-02 3 1  ON 9
ci_011                -8.170119e-03 3 1  ON 10
ci_012                -8.140060e-03 3 1  ON 11
ci_013                 9.650897e-03 3 1  ON 12
ci_014                 9.355696e-03 3 1  ON 13
ci_015                 1.229022e-02 3 1  ON 14
ci_016                 1.255395e-02 3 1  ON 15
ci_017                 1.088261e-02 3 1  ON 16
ci_018                 1.078678e-02 3 1  ON 17
ci_019                -2.519472e-03 3 1  ON 18
ci_020                -2.433609e-03 3 1  ON 19
ci_021                -8.466121e-03 3 1  ON 20
ci_022                -8.662894e-03 3 1  ON 21
ci_023                 7.798363e-03 3 1  ON 22
ci_024                 8.057878e-03 3 1  ON 23
ci_025                 4.715397e-03 3 1  ON 24
ci_026                 4.279339e-03 3 1  ON 25
ci_027                 6.440830e-03 3 1  ON 26
ci_028                 6.479331e-03 3 1  ON 27
ci_029                -4.893006e-03 3 1  ON 28
ci_030                -4.790375e-03 3 1  ON 29
ci_031                -7.391760e-03 3 1  ON 30
ci_032                -8.138508e-03 3 1  ON 31
ci_033                 4.605633e-03 3 1  ON 32
ci_034                 4.413727e-03 3 1  ON 33
ci_035                 1.131429e-03 3 1  ON 34
ci_036                 1.040076e-03 3 1  ON 35
ci_037                 4.943756e-03 3 1  ON 36
ci_038                 5.100942e-03 3 1  ON 37
ci_039                 5.306834e-03 3 1  ON 38
ci_040                 5.327862e-03 3 1  ON 39
ci_041                 4.972760e-03 3 1  ON 40
ci_042                 5.234512e-03 3 1  ON 41
ci_043                 4.958850e-03 3 1  ON 42
ci_044                 4.949699e-03 3 1  ON 43
ci_045                 3.113691e-03 3 1  ON 44
ci_046                 3.180325e-03 3 1  ON 45
ci_047                -7.793578e-04 3 1  ON 46
ci_048                -5.563985e-04 3 1  ON 47
ci_049                 1.579580e-03 3 1  ON 48
ci_050                 1.795168e-03 3 1  ON 49
ci_051                -1.100339e-03 3 1  ON 50
ci_052                -1.257869e-03 3 1  ON 51
ci_053                -2.605870e-03 3 1  ON 52
ci_054                -2.280528e-03 3 1  ON 53
ci_055                -1.475649e-03 3 1  ON 54
ci_056                -1.385986e-03 3 1  ON 55
ci_057                -1.231335e-03 3 1  ON 56
ci_058                -1.738648e-03 3 1  ON 57
ci_059                 3.234028e-04 3 1  ON 58
ci_060                 1.393568e-04 3 1  ON 59
ci_061                -3.333849e-04 3 1  ON 60
ci_062                -1.090028e-05 3 1  ON 61
ci_063                -5.109128e-04 3 1  ON 62
ci_064                -8.881167e-04 3 1  ON 63
ci_065                -2.406697e-03 3 1  ON 64
ci_066                -2.434926e-03 3 1  ON 65
ci_067                -2.109480e-03 3 1  ON 66
ci_068                -2.477613e-03 3 1  ON 67
ci_069                -2.178573e-04 3 1  ON 68
ci_070                 1.313462e-04 3 1  ON 69
ci_071                -1.870935e-03 3 1  ON 70
ci_072                -1.964081e-03 3 1  ON 71
ci_073                 5.755669e-04 3 1  ON 72
ci_074                 2.905643e-04 3 1  ON 73
ci_075                -2.846523e-04 3 1  ON 74
ci_076                -2.993287e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 2.9370e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s034 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s034 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=34  my_counter=0
  time step      = 5.0000e-02
  blocks         = 250
  steps          = 250
  substeps       = 10
  current        = 0
  target samples = 8.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">250</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">6.2500e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">8.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">6.2500e+04</parameter>
<parameter name="steps" condition="int">250</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2662e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="250">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =8000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 34
    time step          = 0.05
    reference energy   = -22.7102
    reference variance = 0.438047
====================================================
  Execution time = 1.0048e+02
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s034
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 62500 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 6.1127e+04
  VMC Eavg = -2.2670e+01
  VMC Evar = 5.1061e-01
  Total weights = 7.820395496e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.8811e+01
  </log>
</opt>
<opt stage="main" walkers="62500">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.495765086364
                                         uncertainty =       0.001318109666

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.495765086364
                                         uncertainty =       0.001318109666

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000248939489
  error estimate for blocks of size 2^( 2) =       0.000257907372
  error estimate for blocks of size 2^( 3) =       0.000265942299
  error estimate for blocks of size 2^( 4) =       0.000271694514
  error estimate for blocks of size 2^( 5) =       0.000275136364
  error estimate for blocks of size 2^( 6) =       0.000276285625
  error estimate for blocks of size 2^( 7) =       0.000277631763
  error estimate for blocks of size 2^( 8) =       0.000277177767
  error estimate for blocks of size 2^( 9) =       0.000276678450

      target function =                  N/A
              le_mean =     -22.669660647462
             les_mean =     514.424120890664
             stat err =       0.000276943401
             autocorr =       1.237640335457
              std dev =       0.704107203603
             le_variance =       0.495766954165


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266966064746e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.3132e-01, overlap shift 9.3132e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.669660647487       residual = 4.79e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.669660594027       residual = 7.08e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.669660601168       residual = 2.03e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.669660610373       residual = 6.19e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 9.3132e-01 is 2.013053e-04

solving harmonic davidson linear method for identity shift 3.7253e+00, overlap shift 3.7253e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.669660647487       residual = 4.79e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.669660632442       residual = 7.99e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.669660622658       residual = 2.03e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.669660625934       residual = 7.62e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 3.7253e+00 is 5.956416e-05

solving harmonic davidson linear method for identity shift 1.4901e+01, overlap shift 1.4901e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.669660647487       residual = 4.79e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.669660643604       residual = 8.63e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.669660640205       residual = 2.31e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.669660641032       residual = 8.93e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 1.4901e+01 is 1.560783e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.066962 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.1930e+02
  </log>
  <optVariables href="FORM.s034.opt.xml">
ci_001                -7.050443e-01 3 1  ON 0
ci_002                -7.060057e-01 3 1  ON 1
ci_003                -3.769191e-02 3 1  ON 2
ci_004                -3.889874e-02 3 1  ON 3
ci_005                 1.613521e-02 3 1  ON 4
ci_006                 1.606269e-02 3 1  ON 5
ci_007                 1.227232e-02 3 1  ON 6
ci_008                 1.244682e-02 3 1  ON 7
ci_009                -1.174134e-02 3 1  ON 8
ci_010                -1.180683e-02 3 1  ON 9
ci_011                -8.144636e-03 3 1  ON 10
ci_012                -8.137038e-03 3 1  ON 11
ci_013                 9.677866e-03 3 1  ON 12
ci_014                 9.346382e-03 3 1  ON 13
ci_015                 1.229983e-02 3 1  ON 14
ci_016                 1.255355e-02 3 1  ON 15
ci_017                 1.086679e-02 3 1  ON 16
ci_018                 1.075911e-02 3 1  ON 17
ci_019                -2.511812e-03 3 1  ON 18
ci_020                -2.451163e-03 3 1  ON 19
ci_021                -8.466819e-03 3 1  ON 20
ci_022                -8.668961e-03 3 1  ON 21
ci_023                 7.802046e-03 3 1  ON 22
ci_024                 8.058778e-03 3 1  ON 23
ci_025                 4.713849e-03 3 1  ON 24
ci_026                 4.259258e-03 3 1  ON 25
ci_027                 6.421631e-03 3 1  ON 26
ci_028                 6.537479e-03 3 1  ON 27
ci_029                -4.900980e-03 3 1  ON 28
ci_030                -4.809223e-03 3 1  ON 29
ci_031                -7.421020e-03 3 1  ON 30
ci_032                -8.106733e-03 3 1  ON 31
ci_033                 4.600737e-03 3 1  ON 32
ci_034                 4.419038e-03 3 1  ON 33
ci_035                 1.129797e-03 3 1  ON 34
ci_036                 1.052962e-03 3 1  ON 35
ci_037                 4.992658e-03 3 1  ON 36
ci_038                 5.088903e-03 3 1  ON 37
ci_039                 5.321654e-03 3 1  ON 38
ci_040                 5.354526e-03 3 1  ON 39
ci_041                 4.990806e-03 3 1  ON 40
ci_042                 5.241791e-03 3 1  ON 41
ci_043                 4.950548e-03 3 1  ON 42
ci_044                 4.947863e-03 3 1  ON 43
ci_045                 3.094212e-03 3 1  ON 44
ci_046                 3.189620e-03 3 1  ON 45
ci_047                -7.798846e-04 3 1  ON 46
ci_048                -5.361242e-04 3 1  ON 47
ci_049                 1.564533e-03 3 1  ON 48
ci_050                 1.756393e-03 3 1  ON 49
ci_051                -1.115765e-03 3 1  ON 50
ci_052                -1.274843e-03 3 1  ON 51
ci_053                -2.631841e-03 3 1  ON 52
ci_054                -2.315567e-03 3 1  ON 53
ci_055                -1.465191e-03 3 1  ON 54
ci_056                -1.380356e-03 3 1  ON 55
ci_057                -1.232525e-03 3 1  ON 56
ci_058                -1.749029e-03 3 1  ON 57
ci_059                 3.522283e-04 3 1  ON 58
ci_060                 1.333783e-04 3 1  ON 59
ci_061                -3.348573e-04 3 1  ON 60
ci_062                 1.836321e-05 3 1  ON 61
ci_063                -5.573776e-04 3 1  ON 62
ci_064                -8.526835e-04 3 1  ON 63
ci_065                -2.435228e-03 3 1  ON 64
ci_066                -2.416960e-03 3 1  ON 65
ci_067                -2.132557e-03 3 1  ON 66
ci_068                -2.477443e-03 3 1  ON 67
ci_069                -2.224406e-04 3 1  ON 68
ci_070                 1.427657e-04 3 1  ON 69
ci_071                -1.852489e-03 3 1  ON 70
ci_072                -1.959603e-03 3 1  ON 71
ci_073                 5.295158e-04 3 1  ON 72
ci_074                 3.093958e-04 3 1  ON 73
ci_075                -3.027321e-04 3 1  ON 74
ci_076                -2.986199e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="250">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =8000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 34
    time step          = 0.05
    reference energy   = -22.6868
    reference variance = 0.266192
====================================================
  Execution time = 1.0216e+02
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s034
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 62500 
  VMC Eavg = -2.2669e+01
  VMC Evar = 5.1374e-01
  Total weights = 7.8208e+06
  Execution time = 1.4621e+01
  </log>
</opt>
<opt stage="main" walkers="62500">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.498927901512
                                         uncertainty =       0.002283803504

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.498927901512
                                         uncertainty =       0.002283803504

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000249732033
  error estimate for blocks of size 2^( 2) =       0.000258624427
  error estimate for blocks of size 2^( 3) =       0.000266751684
  error estimate for blocks of size 2^( 4) =       0.000272557461
  error estimate for blocks of size 2^( 5) =       0.000275996627
  error estimate for blocks of size 2^( 6) =       0.000277806555
  error estimate for blocks of size 2^( 7) =       0.000278918078
  error estimate for blocks of size 2^( 8) =       0.000279132379
  error estimate for blocks of size 2^( 9) =       0.000279909528

      target function =                  N/A
              le_mean =     -22.669394346761
             les_mean =     514.422321479695
             stat err =       0.000278941635
             autocorr =       1.247608081220
              std dev =       0.706348856308
             le_variance =       0.498928706807

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.498927378523
                                         uncertainty =       0.002280689680

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.498927378523
                                         uncertainty =       0.002280689680

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000249731906
  error estimate for blocks of size 2^( 2) =       0.000258623415
  error estimate for blocks of size 2^( 3) =       0.000266750564
  error estimate for blocks of size 2^( 4) =       0.000272556076
  error estimate for blocks of size 2^( 5) =       0.000275994191
  error estimate for blocks of size 2^( 6) =       0.000277805230
  error estimate for blocks of size 2^( 7) =       0.000278914171
  error estimate for blocks of size 2^( 8) =       0.000279130605
  error estimate for blocks of size 2^( 9) =       0.000279899693

      target function =                  N/A
              le_mean =     -22.669393906865
             les_mean =     514.419594389744
             stat err =       0.000278937425
             autocorr =       1.247571685228
              std dev =       0.706348497714
             le_variance =       0.498928200222

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.498926050608
                                         uncertainty =       0.002282111351

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.498926050608
                                         uncertainty =       0.002282111351

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000249731572
  error estimate for blocks of size 2^( 2) =       0.000258623440
  error estimate for blocks of size 2^( 3) =       0.000266750606
  error estimate for blocks of size 2^( 4) =       0.000272556294
  error estimate for blocks of size 2^( 5) =       0.000275994996
  error estimate for blocks of size 2^( 6) =       0.000277805508
  error estimate for blocks of size 2^( 7) =       0.000278915495
  error estimate for blocks of size 2^( 8) =       0.000279131161
  error estimate for blocks of size 2^( 9) =       0.000279903991

      target function =                  N/A
              le_mean =     -22.669393741865
             les_mean =     514.415228855616
             stat err =       0.000278939039
             autocorr =       1.247589459618
              std dev =       0.706347553160
             le_variance =       0.498926865855

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.498927372492
                                         uncertainty =       0.002283591922

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.498927372492
                                         uncertainty =       0.002283591922

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000249731901
  error estimate for blocks of size 2^( 2) =       0.000258624210
  error estimate for blocks of size 2^( 3) =       0.000266751414
  error estimate for blocks of size 2^( 4) =       0.000272557192
  error estimate for blocks of size 2^( 5) =       0.000275996261
  error estimate for blocks of size 2^( 6) =       0.000277806259
  error estimate for blocks of size 2^( 7) =       0.000278917461
  error estimate for blocks of size 2^( 8) =       0.000279131873
  error estimate for blocks of size 2^( 9) =       0.000279908080

      target function =                  N/A
              le_mean =     -22.669394124503
             les_mean =     514.415977183535
             stat err =       0.000278940918
             autocorr =       1.247602989078
              std dev =       0.706348482756
             le_variance =       0.498928179092


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.669394346761        initial  <--
     9.3132e-01     9.3132e+00             2.0131e-04       -22.669393906865
     3.7253e+00     3.7253e+01             5.9564e-05       -22.669393741865
     1.4901e+01     1.4901e+02             1.5608e-05       -22.669394124503

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 175.2401
  </log>
  <optVariables href="FORM.s034.opt.xml">
ci_001                -7.050616e-01 3 1  ON 0
ci_002                -7.059918e-01 3 1  ON 1
ci_003                -3.764466e-02 3 1  ON 2
ci_004                -3.890721e-02 3 1  ON 3
ci_005                 1.612563e-02 3 1  ON 4
ci_006                 1.600313e-02 3 1  ON 5
ci_007                 1.229676e-02 3 1  ON 6
ci_008                 1.246543e-02 3 1  ON 7
ci_009                -1.173671e-02 3 1  ON 8
ci_010                -1.182346e-02 3 1  ON 9
ci_011                -8.170119e-03 3 1  ON 10
ci_012                -8.140060e-03 3 1  ON 11
ci_013                 9.650897e-03 3 1  ON 12
ci_014                 9.355696e-03 3 1  ON 13
ci_015                 1.229022e-02 3 1  ON 14
ci_016                 1.255395e-02 3 1  ON 15
ci_017                 1.088261e-02 3 1  ON 16
ci_018                 1.078678e-02 3 1  ON 17
ci_019                -2.519472e-03 3 1  ON 18
ci_020                -2.433609e-03 3 1  ON 19
ci_021                -8.466121e-03 3 1  ON 20
ci_022                -8.662894e-03 3 1  ON 21
ci_023                 7.798363e-03 3 1  ON 22
ci_024                 8.057878e-03 3 1  ON 23
ci_025                 4.715397e-03 3 1  ON 24
ci_026                 4.279339e-03 3 1  ON 25
ci_027                 6.440830e-03 3 1  ON 26
ci_028                 6.479331e-03 3 1  ON 27
ci_029                -4.893006e-03 3 1  ON 28
ci_030                -4.790375e-03 3 1  ON 29
ci_031                -7.391760e-03 3 1  ON 30
ci_032                -8.138508e-03 3 1  ON 31
ci_033                 4.605633e-03 3 1  ON 32
ci_034                 4.413727e-03 3 1  ON 33
ci_035                 1.131429e-03 3 1  ON 34
ci_036                 1.040076e-03 3 1  ON 35
ci_037                 4.943756e-03 3 1  ON 36
ci_038                 5.100942e-03 3 1  ON 37
ci_039                 5.306834e-03 3 1  ON 38
ci_040                 5.327862e-03 3 1  ON 39
ci_041                 4.972760e-03 3 1  ON 40
ci_042                 5.234512e-03 3 1  ON 41
ci_043                 4.958850e-03 3 1  ON 42
ci_044                 4.949699e-03 3 1  ON 43
ci_045                 3.113691e-03 3 1  ON 44
ci_046                 3.180325e-03 3 1  ON 45
ci_047                -7.793578e-04 3 1  ON 46
ci_048                -5.563985e-04 3 1  ON 47
ci_049                 1.579580e-03 3 1  ON 48
ci_050                 1.795168e-03 3 1  ON 49
ci_051                -1.100339e-03 3 1  ON 50
ci_052                -1.257869e-03 3 1  ON 51
ci_053                -2.605870e-03 3 1  ON 52
ci_054                -2.280528e-03 3 1  ON 53
ci_055                -1.475649e-03 3 1  ON 54
ci_056                -1.385986e-03 3 1  ON 55
ci_057                -1.231335e-03 3 1  ON 56
ci_058                -1.738648e-03 3 1  ON 57
ci_059                 3.234028e-04 3 1  ON 58
ci_060                 1.393568e-04 3 1  ON 59
ci_061                -3.333849e-04 3 1  ON 60
ci_062                -1.090028e-05 3 1  ON 61
ci_063                -5.109128e-04 3 1  ON 62
ci_064                -8.881167e-04 3 1  ON 63
ci_065                -2.406697e-03 3 1  ON 64
ci_066                -2.434926e-03 3 1  ON 65
ci_067                -2.109480e-03 3 1  ON 66
ci_068                -2.477613e-03 3 1  ON 67
ci_069                -2.178573e-04 3 1  ON 68
ci_070                 1.313462e-04 3 1  ON 69
ci_071                -1.870935e-03 3 1  ON 70
ci_072                -1.964081e-03 3 1  ON 71
ci_073                 5.755669e-04 3 1  ON 72
ci_074                 2.905643e-04 3 1  ON 73
ci_075                -2.846523e-04 3 1  ON 74
ci_076                -2.993287e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 2.9455e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s035 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s035 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=35  my_counter=0
  time step      = 5.0000e-02
  blocks         = 250
  steps          = 250
  substeps       = 10
  current        = 0
  target samples = 8.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">250</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">6.2500e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">8.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">6.2500e+04</parameter>
<parameter name="steps" condition="int">250</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2663e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="250">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =8000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 35
    time step          = 0.05
    reference energy   = -22.6216
    reference variance = 0.547452
====================================================
  Execution time = 1.0178e+02
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s035
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 62500 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 6.1055e+04
  VMC Eavg = -2.2670e+01
  VMC Evar = 5.1157e-01
  Total weights = 7.820930242e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.9074e+01
  </log>
</opt>
<opt stage="main" walkers="62500">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.498224518016
                                         uncertainty =       0.001485894497

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.498224518016
                                         uncertainty =       0.001485894497

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000249556885
  error estimate for blocks of size 2^( 2) =       0.000258553861
  error estimate for blocks of size 2^( 3) =       0.000266654840
  error estimate for blocks of size 2^( 4) =       0.000272323319
  error estimate for blocks of size 2^( 5) =       0.000275569786
  error estimate for blocks of size 2^( 6) =       0.000277162439
  error estimate for blocks of size 2^( 7) =       0.000278350091
  error estimate for blocks of size 2^( 8) =       0.000278554358
  error estimate for blocks of size 2^( 9) =       0.000278160149

      target function =                  N/A
              le_mean =     -22.669958229955
             les_mean =     514.438573984124
             stat err =       0.000278056759
             autocorr =       1.241445910652
              std dev =       0.705853462409
             le_variance =       0.498229110394


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266995822996e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.3132e+00, overlap shift 9.3132e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.669958229985       residual = 3.00e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.669958396881       residual = 3.48e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.669958399298       residual = 9.16e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 9.3132e+00 is 2.137686e-05

solving harmonic davidson linear method for identity shift 3.7253e+01, overlap shift 3.7253e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.669958229985       residual = 3.00e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.669958272240       residual = 3.56e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.669958273009       residual = 9.55e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 3.7253e+01 is 5.404500e-06

solving harmonic davidson linear method for identity shift 1.4901e+02, overlap shift 1.4901e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.669958229985       residual = 3.00e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.669958240582       residual = 3.59e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.669958240785       residual = 9.66e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 1.4901e+02 is 1.354955e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.068060 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.2087e+02
  </log>
  <optVariables href="FORM.s035.opt.xml">
ci_001                -7.050616e-01 3 1  ON 0
ci_002                -7.059920e-01 3 1  ON 1
ci_003                -3.764635e-02 3 1  ON 2
ci_004                -3.890630e-02 3 1  ON 3
ci_005                 1.612532e-02 3 1  ON 4
ci_006                 1.600258e-02 3 1  ON 5
ci_007                 1.229434e-02 3 1  ON 6
ci_008                 1.246543e-02 3 1  ON 7
ci_009                -1.173718e-02 3 1  ON 8
ci_010                -1.182484e-02 3 1  ON 9
ci_011                -8.171769e-03 3 1  ON 10
ci_012                -8.139604e-03 3 1  ON 11
ci_013                 9.650005e-03 3 1  ON 12
ci_014                 9.356898e-03 3 1  ON 13
ci_015                 1.228945e-02 3 1  ON 14
ci_016                 1.255396e-02 3 1  ON 15
ci_017                 1.088266e-02 3 1  ON 16
ci_018                 1.078534e-02 3 1  ON 17
ci_019                -2.518206e-03 3 1  ON 18
ci_020                -2.431179e-03 3 1  ON 19
ci_021                -8.464560e-03 3 1  ON 20
ci_022                -8.661413e-03 3 1  ON 21
ci_023                 7.800122e-03 3 1  ON 22
ci_024                 8.053837e-03 3 1  ON 23
ci_025                 4.712253e-03 3 1  ON 24
ci_026                 4.277719e-03 3 1  ON 25
ci_027                 6.444283e-03 3 1  ON 26
ci_028                 6.478577e-03 3 1  ON 27
ci_029                -4.889156e-03 3 1  ON 28
ci_030                -4.789157e-03 3 1  ON 29
ci_031                -7.390945e-03 3 1  ON 30
ci_032                -8.134666e-03 3 1  ON 31
ci_033                 4.604376e-03 3 1  ON 32
ci_034                 4.413655e-03 3 1  ON 33
ci_035                 1.130213e-03 3 1  ON 34
ci_036                 1.040757e-03 3 1  ON 35
ci_037                 4.946175e-03 3 1  ON 36
ci_038                 5.100561e-03 3 1  ON 37
ci_039                 5.306727e-03 3 1  ON 38
ci_040                 5.326601e-03 3 1  ON 39
ci_041                 4.972197e-03 3 1  ON 40
ci_042                 5.233671e-03 3 1  ON 41
ci_043                 4.954910e-03 3 1  ON 42
ci_044                 4.948323e-03 3 1  ON 43
ci_045                 3.116280e-03 3 1  ON 44
ci_046                 3.178788e-03 3 1  ON 45
ci_047                -7.792588e-04 3 1  ON 46
ci_048                -5.577756e-04 3 1  ON 47
ci_049                 1.579759e-03 3 1  ON 48
ci_050                 1.794540e-03 3 1  ON 49
ci_051                -1.101897e-03 3 1  ON 50
ci_052                -1.254194e-03 3 1  ON 51
ci_053                -2.607016e-03 3 1  ON 52
ci_054                -2.285933e-03 3 1  ON 53
ci_055                -1.477594e-03 3 1  ON 54
ci_056                -1.383632e-03 3 1  ON 55
ci_057                -1.233713e-03 3 1  ON 56
ci_058                -1.736727e-03 3 1  ON 57
ci_059                 3.218507e-04 3 1  ON 58
ci_060                 1.398711e-04 3 1  ON 59
ci_061                -3.326587e-04 3 1  ON 60
ci_062                -1.052321e-05 3 1  ON 61
ci_063                -5.139896e-04 3 1  ON 62
ci_064                -8.890607e-04 3 1  ON 63
ci_065                -2.407002e-03 3 1  ON 64
ci_066                -2.434990e-03 3 1  ON 65
ci_067                -2.107340e-03 3 1  ON 66
ci_068                -2.476626e-03 3 1  ON 67
ci_069                -2.154858e-04 3 1  ON 68
ci_070                 1.317645e-04 3 1  ON 69
ci_071                -1.871787e-03 3 1  ON 70
ci_072                -1.962795e-03 3 1  ON 71
ci_073                 5.754829e-04 3 1  ON 72
ci_074                 2.893314e-04 3 1  ON 73
ci_075                -2.862902e-04 3 1  ON 74
ci_076                -2.992881e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="250">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =8000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 35
    time step          = 0.05
    reference energy   = -22.7194
    reference variance = 0.535481
====================================================
  Execution time = 1.0253e+02
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s035
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 62500 
  VMC Eavg = -2.2670e+01
  VMC Evar = 5.1005e-01
  Total weights = 7.8208e+06
  Execution time = 1.4646e+01
  </log>
</opt>
<opt stage="main" walkers="62500">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.497230182724
                                         uncertainty =       0.001517275193

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.497230182724
                                         uncertainty =       0.001517275193

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000249307369
  error estimate for blocks of size 2^( 2) =       0.000258352975
  error estimate for blocks of size 2^( 3) =       0.000266423077
  error estimate for blocks of size 2^( 4) =       0.000272281436
  error estimate for blocks of size 2^( 5) =       0.000275638867
  error estimate for blocks of size 2^( 6) =       0.000277732755
  error estimate for blocks of size 2^( 7) =       0.000279052357
  error estimate for blocks of size 2^( 8) =       0.000279172393
  error estimate for blocks of size 2^( 9) =       0.000279815810

      target function =                  N/A
              le_mean =     -22.669887792277
             les_mean =     514.433857268032
             stat err =       0.000278943329
             autocorr =       1.251877190945
              std dev =       0.705147725316
             le_variance =       0.497233314518

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.497228538286
                                         uncertainty =       0.001517443571

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.497228538286
                                         uncertainty =       0.001517443571

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000249306957
  error estimate for blocks of size 2^( 2) =       0.000258352604
  error estimate for blocks of size 2^( 3) =       0.000266422780
  error estimate for blocks of size 2^( 4) =       0.000272281200
  error estimate for blocks of size 2^( 5) =       0.000275638652
  error estimate for blocks of size 2^( 6) =       0.000277732519
  error estimate for blocks of size 2^( 7) =       0.000279052072
  error estimate for blocks of size 2^( 8) =       0.000279172119
  error estimate for blocks of size 2^( 9) =       0.000279815484

      target function =                  N/A
              le_mean =     -22.669887819945
             les_mean =     514.433873566555
             stat err =       0.000278943048
             autocorr =       1.251878815499
              std dev =       0.705146559342
             le_variance =       0.497231670152

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.497229332596
                                         uncertainty =       0.001517360102

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.497229332596
                                         uncertainty =       0.001517360102

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000249307156
  error estimate for blocks of size 2^( 2) =       0.000258352783
  error estimate for blocks of size 2^( 3) =       0.000266422923
  error estimate for blocks of size 2^( 4) =       0.000272281313
  error estimate for blocks of size 2^( 5) =       0.000275638754
  error estimate for blocks of size 2^( 6) =       0.000277732631
  error estimate for blocks of size 2^( 7) =       0.000279052208
  error estimate for blocks of size 2^( 8) =       0.000279172250
  error estimate for blocks of size 2^( 9) =       0.000279815638

      target function =                  N/A
              le_mean =     -22.669887804830
             les_mean =     514.433867878802
             stat err =       0.000278943182
             autocorr =       1.251878011055
              std dev =       0.705147122542
             le_variance =       0.497232464429

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.497230074476
                                         uncertainty =       0.001517285806

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.497230074476
                                         uncertainty =       0.001517285806

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000249307342
  error estimate for blocks of size 2^( 2) =       0.000258352950
  error estimate for blocks of size 2^( 3) =       0.000266423057
  error estimate for blocks of size 2^( 4) =       0.000272281420
  error estimate for blocks of size 2^( 5) =       0.000275638853
  error estimate for blocks of size 2^( 6) =       0.000277732739
  error estimate for blocks of size 2^( 7) =       0.000279052338
  error estimate for blocks of size 2^( 8) =       0.000279172375
  error estimate for blocks of size 2^( 9) =       0.000279815788

      target function =                  N/A
              le_mean =     -22.669887793717
             les_mean =     514.433857573898
             stat err =       0.000278943310
             autocorr =       1.251877295920
              std dev =       0.705147648564
             le_variance =       0.497233206275


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.669887792277        initial
     9.3132e+00     9.3132e+01             2.1377e-05       -22.669887819945  <--
     3.7253e+01     3.7253e+02             5.4045e-06       -22.669887804830
     1.4901e+02     1.4901e+03             1.3550e-06       -22.669887793717

*****************************************************************************
Applying the update for shift_i =   9.3132e+00     and shift_s =   9.3132e+01
*****************************************************************************

  Execution time = 1.7576e+02
  </log>
  <optVariables href="FORM.s035.opt.xml">
ci_001                -7.050617e-01 3 1  ON 0
ci_002                -7.059927e-01 3 1  ON 1
ci_003                -3.765140e-02 3 1  ON 2
ci_004                -3.890358e-02 3 1  ON 3
ci_005                 1.612442e-02 3 1  ON 4
ci_006                 1.600100e-02 3 1  ON 5
ci_007                 1.228720e-02 3 1  ON 6
ci_008                 1.246541e-02 3 1  ON 7
ci_009                -1.173856e-02 3 1  ON 8
ci_010                -1.182889e-02 3 1  ON 9
ci_011                -8.176622e-03 3 1  ON 10
ci_012                -8.138205e-03 3 1  ON 11
ci_013                 9.647351e-03 3 1  ON 12
ci_014                 9.360450e-03 3 1  ON 13
ci_015                 1.228718e-02 3 1  ON 14
ci_016                 1.255401e-02 3 1  ON 15
ci_017                 1.088281e-02 3 1  ON 16
ci_018                 1.078111e-02 3 1  ON 17
ci_019                -2.514433e-03 3 1  ON 18
ci_020                -2.423970e-03 3 1  ON 19
ci_021                -8.459934e-03 3 1  ON 20
ci_022                -8.657079e-03 3 1  ON 21
ci_023                 7.805283e-03 3 1  ON 22
ci_024                 8.041975e-03 3 1  ON 23
ci_025                 4.702938e-03 3 1  ON 24
ci_026                 4.272897e-03 3 1  ON 25
ci_027                 6.454365e-03 3 1  ON 26
ci_028                 6.476374e-03 3 1  ON 27
ci_029                -4.877804e-03 3 1  ON 28
ci_030                -4.785588e-03 3 1  ON 29
ci_031                -7.388555e-03 3 1  ON 30
ci_032                -8.123297e-03 3 1  ON 31
ci_033                 4.600646e-03 3 1  ON 32
ci_034                 4.413460e-03 3 1  ON 33
ci_035                 1.126695e-03 3 1  ON 34
ci_036                 1.042723e-03 3 1  ON 35
ci_037                 4.953316e-03 3 1  ON 36
ci_038                 5.099454e-03 3 1  ON 37
ci_039                 5.306423e-03 3 1  ON 38
ci_040                 5.322908e-03 3 1  ON 39
ci_041                 4.970538e-03 3 1  ON 40
ci_042                 5.231208e-03 3 1  ON 41
ci_043                 4.943306e-03 3 1  ON 42
ci_044                 4.944271e-03 3 1  ON 43
ci_045                 3.123936e-03 3 1  ON 44
ci_046                 3.174262e-03 3 1  ON 45
ci_047                -7.789725e-04 3 1  ON 46
ci_048                -5.617838e-04 3 1  ON 47
ci_049                 1.580293e-03 3 1  ON 48
ci_050                 1.792687e-03 3 1  ON 49
ci_051                -1.106460e-03 3 1  ON 50
ci_052                -1.243365e-03 3 1  ON 51
ci_053                -2.610393e-03 3 1  ON 52
ci_054                -2.301905e-03 3 1  ON 53
ci_055                -1.483370e-03 3 1  ON 54
ci_056                -1.376677e-03 3 1  ON 55
ci_057                -1.240706e-03 3 1  ON 56
ci_058                -1.731089e-03 3 1  ON 57
ci_059                 3.173373e-04 3 1  ON 58
ci_060                 1.413845e-04 3 1  ON 59
ci_061                -3.305361e-04 3 1  ON 60
ci_062                -9.395588e-06 3 1  ON 61
ci_063                -5.230783e-04 3 1  ON 62
ci_064                -8.918249e-04 3 1  ON 63
ci_065                -2.407935e-03 3 1  ON 64
ci_066                -2.435196e-03 3 1  ON 65
ci_067                -2.101008e-03 3 1  ON 66
ci_068                -2.473734e-03 3 1  ON 67
ci_069                -2.085008e-04 3 1  ON 68
ci_070                 1.330080e-04 3 1  ON 69
ci_071                -1.874287e-03 3 1  ON 70
ci_072                -1.959038e-03 3 1  ON 71
ci_073                 5.752663e-04 3 1  ON 72
ci_074                 2.857250e-04 3 1  ON 73
ci_075                -2.911210e-04 3 1  ON 74
ci_076                -2.991699e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 2.9665e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s036 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s036 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=36  my_counter=0
  time step      = 5.0000e-02
  blocks         = 250
  steps          = 250
  substeps       = 10
  current        = 0
  target samples = 8.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">250</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">6.2500e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">8.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">6.2500e+04</parameter>
<parameter name="steps" condition="int">250</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2663e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="250">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =8000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 36
    time step          = 0.05
    reference energy   = -22.6381
    reference variance = 0.581045
====================================================
  Execution time = 1.0162e+02
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s036
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 62500 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 6.1036e+04
  VMC Eavg = -2.2670e+01
  VMC Evar = 5.1418e-01
  Total weights = 7.819947892e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.9024e+01
  </log>
</opt>
<opt stage="main" walkers="62500">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.501511783341
                                         uncertainty =       0.003910940255

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.501511783341
                                         uncertainty =       0.003910940255

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000250377408
  error estimate for blocks of size 2^( 2) =       0.000259401524
  error estimate for blocks of size 2^( 3) =       0.000267415753
  error estimate for blocks of size 2^( 4) =       0.000273362939
  error estimate for blocks of size 2^( 5) =       0.000276763706
  error estimate for blocks of size 2^( 6) =       0.000278442563
  error estimate for blocks of size 2^( 7) =       0.000279081641
  error estimate for blocks of size 2^( 8) =       0.000278864711
  error estimate for blocks of size 2^( 9) =       0.000279363431

      target function =                  N/A
              le_mean =     -22.670123823149
             les_mean =     514.448692654189
             stat err =       0.000278938087
             autocorr =       1.241153097863
              std dev =       0.708174253163
             le_variance =       0.501510772843


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.267012382315e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3283e+00, overlap shift 2.3283e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.670123823172       residual = 9.35e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.670124269175       residual = 3.66e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.670124416343       residual = 7.45e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.670124407346       residual = 2.43e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 2.3283e+00 is 5.726725e-04

solving harmonic davidson linear method for identity shift 9.3132e+00, overlap shift 9.3132e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.670123823172       residual = 9.35e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.670123938512       residual = 4.15e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.670123983212       residual = 9.42e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.670123980857       residual = 1.00e-08           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.670123981042       residual = 7.67e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          4 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 9.3132e+00 is 1.487205e-04

solving harmonic davidson linear method for identity shift 3.7253e+01, overlap shift 3.7253e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.670123823172       residual = 9.35e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.670123852257       residual = 4.32e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.670123863956       residual = 1.02e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.670123863388       residual = 1.24e-08           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.670123863427       residual = 8.11e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          4 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 3.7253e+01 is 3.754533e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.069707 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.2066e+02
  </log>
  <optVariables href="FORM.s036.opt.xml">
ci_001                -7.050270e-01 3 1  ON 0
ci_002                -7.060292e-01 3 1  ON 1
ci_003                -3.767284e-02 3 1  ON 2
ci_004                -3.890411e-02 3 1  ON 3
ci_005                 1.611403e-02 3 1  ON 4
ci_006                 1.600416e-02 3 1  ON 5
ci_007                 1.231589e-02 3 1  ON 6
ci_008                 1.244327e-02 3 1  ON 7
ci_009                -1.173983e-02 3 1  ON 8
ci_010                -1.183057e-02 3 1  ON 9
ci_011                -8.180935e-03 3 1  ON 10
ci_012                -8.130436e-03 3 1  ON 11
ci_013                 9.617202e-03 3 1  ON 12
ci_014                 9.354422e-03 3 1  ON 13
ci_015                 1.227878e-02 3 1  ON 14
ci_016                 1.261334e-02 3 1  ON 15
ci_017                 1.078152e-02 3 1  ON 16
ci_018                 1.076554e-02 3 1  ON 17
ci_019                -2.498695e-03 3 1  ON 18
ci_020                -2.442396e-03 3 1  ON 19
ci_021                -8.462696e-03 3 1  ON 20
ci_022                -8.629730e-03 3 1  ON 21
ci_023                 7.736904e-03 3 1  ON 22
ci_024                 8.039476e-03 3 1  ON 23
ci_025                 4.695148e-03 3 1  ON 24
ci_026                 4.298241e-03 3 1  ON 25
ci_027                 6.472279e-03 3 1  ON 26
ci_028                 6.499249e-03 3 1  ON 27
ci_029                -4.884684e-03 3 1  ON 28
ci_030                -4.768778e-03 3 1  ON 29
ci_031                -7.393581e-03 3 1  ON 30
ci_032                -8.071476e-03 3 1  ON 31
ci_033                 4.623421e-03 3 1  ON 32
ci_034                 4.405866e-03 3 1  ON 33
ci_035                 1.122820e-03 3 1  ON 34
ci_036                 1.047140e-03 3 1  ON 35
ci_037                 4.988251e-03 3 1  ON 36
ci_038                 5.126747e-03 3 1  ON 37
ci_039                 5.308737e-03 3 1  ON 38
ci_040                 5.309579e-03 3 1  ON 39
ci_041                 4.941998e-03 3 1  ON 40
ci_042                 5.211678e-03 3 1  ON 41
ci_043                 4.943453e-03 3 1  ON 42
ci_044                 4.962958e-03 3 1  ON 43
ci_045                 3.076227e-03 3 1  ON 44
ci_046                 3.181509e-03 3 1  ON 45
ci_047                -7.625918e-04 3 1  ON 46
ci_048                -5.697725e-04 3 1  ON 47
ci_049                 1.431572e-03 3 1  ON 48
ci_050                 1.808870e-03 3 1  ON 49
ci_051                -1.107037e-03 3 1  ON 50
ci_052                -1.232136e-03 3 1  ON 51
ci_053                -2.612861e-03 3 1  ON 52
ci_054                -2.266472e-03 3 1  ON 53
ci_055                -1.477295e-03 3 1  ON 54
ci_056                -1.403886e-03 3 1  ON 55
ci_057                -1.200692e-03 3 1  ON 56
ci_058                -1.713739e-03 3 1  ON 57
ci_059                 3.220041e-04 3 1  ON 58
ci_060                 1.553320e-04 3 1  ON 59
ci_061                -2.889262e-04 3 1  ON 60
ci_062                -1.348053e-05 3 1  ON 61
ci_063                -4.907218e-04 3 1  ON 62
ci_064                -8.801630e-04 3 1  ON 63
ci_065                -2.406045e-03 3 1  ON 64
ci_066                -2.400469e-03 3 1  ON 65
ci_067                -2.106320e-03 3 1  ON 66
ci_068                -2.496875e-03 3 1  ON 67
ci_069                -2.099634e-04 3 1  ON 68
ci_070                 1.524284e-04 3 1  ON 69
ci_071                -1.902738e-03 3 1  ON 70
ci_072                -1.966616e-03 3 1  ON 71
ci_073                 5.587216e-04 3 1  ON 72
ci_074                 2.733929e-04 3 1  ON 73
ci_075                -2.887821e-04 3 1  ON 74
ci_076                -2.864085e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="250">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =8000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 36
    time step          = 0.05
    reference energy   = -22.6889
    reference variance = 0.426999
====================================================
  Execution time = 1.0238e+02
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s036
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 62500 
  VMC Eavg = -2.2670e+01
  VMC Evar = 5.0694e-01
  Total weights = 7.8205e+06
  Execution time = 1.4663e+01
  </log>
</opt>
<opt stage="main" walkers="62500">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.495260784200
                                         uncertainty =       0.001803606908

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.495260784200
                                         uncertainty =       0.001803606908

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000248812449
  error estimate for blocks of size 2^( 2) =       0.000257719891
  error estimate for blocks of size 2^( 3) =       0.000265549941
  error estimate for blocks of size 2^( 4) =       0.000270955642
  error estimate for blocks of size 2^( 5) =       0.000274339149
  error estimate for blocks of size 2^( 6) =       0.000276275189
  error estimate for blocks of size 2^( 7) =       0.000277021357
  error estimate for blocks of size 2^( 8) =       0.000277062808
  error estimate for blocks of size 2^( 9) =       0.000277700780

      target function =                  N/A
              le_mean =     -22.669537776512
             les_mean =     514.415311074014
             stat err =       0.000277015034
             autocorr =       1.239545479011
              std dev =       0.703747879664
             le_variance =       0.495261078131

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.495222821839
                                         uncertainty =       0.001800247753

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.495222821839
                                         uncertainty =       0.001800247753

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000248802912
  error estimate for blocks of size 2^( 2) =       0.000257712207
  error estimate for blocks of size 2^( 3) =       0.000265543082
  error estimate for blocks of size 2^( 4) =       0.000270949664
  error estimate for blocks of size 2^( 5) =       0.000274333502
  error estimate for blocks of size 2^( 6) =       0.000276270023
  error estimate for blocks of size 2^( 7) =       0.000277018838
  error estimate for blocks of size 2^( 8) =       0.000277061357
  error estimate for blocks of size 2^( 9) =       0.000277703159

      target function =                  N/A
              le_mean =     -22.669537096522
             les_mean =     514.420678664820
             stat err =       0.000277013344
             autocorr =       1.239625387987
              std dev =       0.703720905352
             le_variance =       0.495223112629

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.495235952685
                                         uncertainty =       0.001801804116

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.495235952685
                                         uncertainty =       0.001801804116

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000248806211
  error estimate for blocks of size 2^( 2) =       0.000257714665
  error estimate for blocks of size 2^( 3) =       0.000265545105
  error estimate for blocks of size 2^( 4) =       0.000270951298
  error estimate for blocks of size 2^( 5) =       0.000274335110
  error estimate for blocks of size 2^( 6) =       0.000276271578
  error estimate for blocks of size 2^( 7) =       0.000277019257
  error estimate for blocks of size 2^( 8) =       0.000277060945
  error estimate for blocks of size 2^( 9) =       0.000277700482

      target function =                  N/A
              le_mean =     -22.669537116858
             les_mean =     514.414927549551
             stat err =       0.000277013065
             autocorr =       1.239590018430
              std dev =       0.703730236445
             le_variance =       0.495236245687

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.495257086592
                                         uncertainty =       0.001803366357

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.495257086592
                                         uncertainty =       0.001803366357

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000248811520
  error estimate for blocks of size 2^( 2) =       0.000257719091
  error estimate for blocks of size 2^( 3) =       0.000265549207
  error estimate for blocks of size 2^( 4) =       0.000270954977
  error estimate for blocks of size 2^( 5) =       0.000274338558
  error estimate for blocks of size 2^( 6) =       0.000276274727
  error estimate for blocks of size 2^( 7) =       0.000277021140
  error estimate for blocks of size 2^( 8) =       0.000277062646
  error estimate for blocks of size 2^( 9) =       0.000277700778

      target function =                  N/A
              le_mean =     -22.669537616065
             les_mean =     514.415655867363
             stat err =       0.000277014823
             autocorr =       1.239552845287
              std dev =       0.703745252582
             le_variance =       0.495257380532


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.669537776512        initial  <--
     2.3283e+00     2.3283e+01             5.7267e-04       -22.669537096522
     9.3132e+00     9.3132e+01             1.4872e-04       -22.669537116858
     3.7253e+01     3.7253e+02             3.7545e-05       -22.669537616065

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 175.6648
  </log>
  <optVariables href="FORM.s036.opt.xml">
ci_001                -7.050617e-01 3 1  ON 0
ci_002                -7.059927e-01 3 1  ON 1
ci_003                -3.765140e-02 3 1  ON 2
ci_004                -3.890358e-02 3 1  ON 3
ci_005                 1.612442e-02 3 1  ON 4
ci_006                 1.600100e-02 3 1  ON 5
ci_007                 1.228720e-02 3 1  ON 6
ci_008                 1.246541e-02 3 1  ON 7
ci_009                -1.173856e-02 3 1  ON 8
ci_010                -1.182889e-02 3 1  ON 9
ci_011                -8.176622e-03 3 1  ON 10
ci_012                -8.138205e-03 3 1  ON 11
ci_013                 9.647351e-03 3 1  ON 12
ci_014                 9.360450e-03 3 1  ON 13
ci_015                 1.228718e-02 3 1  ON 14
ci_016                 1.255401e-02 3 1  ON 15
ci_017                 1.088281e-02 3 1  ON 16
ci_018                 1.078111e-02 3 1  ON 17
ci_019                -2.514433e-03 3 1  ON 18
ci_020                -2.423970e-03 3 1  ON 19
ci_021                -8.459934e-03 3 1  ON 20
ci_022                -8.657079e-03 3 1  ON 21
ci_023                 7.805283e-03 3 1  ON 22
ci_024                 8.041975e-03 3 1  ON 23
ci_025                 4.702938e-03 3 1  ON 24
ci_026                 4.272897e-03 3 1  ON 25
ci_027                 6.454365e-03 3 1  ON 26
ci_028                 6.476374e-03 3 1  ON 27
ci_029                -4.877804e-03 3 1  ON 28
ci_030                -4.785588e-03 3 1  ON 29
ci_031                -7.388555e-03 3 1  ON 30
ci_032                -8.123297e-03 3 1  ON 31
ci_033                 4.600646e-03 3 1  ON 32
ci_034                 4.413460e-03 3 1  ON 33
ci_035                 1.126695e-03 3 1  ON 34
ci_036                 1.042723e-03 3 1  ON 35
ci_037                 4.953316e-03 3 1  ON 36
ci_038                 5.099454e-03 3 1  ON 37
ci_039                 5.306423e-03 3 1  ON 38
ci_040                 5.322908e-03 3 1  ON 39
ci_041                 4.970538e-03 3 1  ON 40
ci_042                 5.231208e-03 3 1  ON 41
ci_043                 4.943306e-03 3 1  ON 42
ci_044                 4.944271e-03 3 1  ON 43
ci_045                 3.123936e-03 3 1  ON 44
ci_046                 3.174262e-03 3 1  ON 45
ci_047                -7.789725e-04 3 1  ON 46
ci_048                -5.617838e-04 3 1  ON 47
ci_049                 1.580293e-03 3 1  ON 48
ci_050                 1.792687e-03 3 1  ON 49
ci_051                -1.106460e-03 3 1  ON 50
ci_052                -1.243365e-03 3 1  ON 51
ci_053                -2.610393e-03 3 1  ON 52
ci_054                -2.301905e-03 3 1  ON 53
ci_055                -1.483370e-03 3 1  ON 54
ci_056                -1.376677e-03 3 1  ON 55
ci_057                -1.240706e-03 3 1  ON 56
ci_058                -1.731089e-03 3 1  ON 57
ci_059                 3.173373e-04 3 1  ON 58
ci_060                 1.413845e-04 3 1  ON 59
ci_061                -3.305361e-04 3 1  ON 60
ci_062                -9.395588e-06 3 1  ON 61
ci_063                -5.230783e-04 3 1  ON 62
ci_064                -8.918249e-04 3 1  ON 63
ci_065                -2.407935e-03 3 1  ON 64
ci_066                -2.435196e-03 3 1  ON 65
ci_067                -2.101008e-03 3 1  ON 66
ci_068                -2.473734e-03 3 1  ON 67
ci_069                -2.085008e-04 3 1  ON 68
ci_070                 1.330080e-04 3 1  ON 69
ci_071                -1.874287e-03 3 1  ON 70
ci_072                -1.959038e-03 3 1  ON 71
ci_073                 5.752663e-04 3 1  ON 72
ci_074                 2.857250e-04 3 1  ON 73
ci_075                -2.911210e-04 3 1  ON 74
ci_076                -2.991699e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 2.9633e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s037 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s037 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=37  my_counter=0
  time step      = 5.0000e-02
  blocks         = 250
  steps          = 250
  substeps       = 10
  current        = 0
  target samples = 8.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">250</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">6.2500e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">8.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">6.2500e+04</parameter>
<parameter name="steps" condition="int">250</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2663e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="250">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =8000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 37
    time step          = 0.05
    reference energy   = -22.5669
    reference variance = 0.316984
====================================================
  Execution time = 1.0166e+02
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s037
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 62500 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 6.1038e+04
  VMC Eavg = -2.2670e+01
  VMC Evar = 5.0807e-01
  Total weights = 7.820235601e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.9019e+01
  </log>
</opt>
<opt stage="main" walkers="62500">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.495853092056
                                         uncertainty =       0.001436920330

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.495853092056
                                         uncertainty =       0.001436920330

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000248961573
  error estimate for blocks of size 2^( 2) =       0.000257856745
  error estimate for blocks of size 2^( 3) =       0.000265967148
  error estimate for blocks of size 2^( 4) =       0.000271667242
  error estimate for blocks of size 2^( 5) =       0.000275036085
  error estimate for blocks of size 2^( 6) =       0.000277277212
  error estimate for blocks of size 2^( 7) =       0.000278086773
  error estimate for blocks of size 2^( 8) =       0.000279167491
  error estimate for blocks of size 2^( 9) =       0.000279163283

      target function =                  N/A
              le_mean =     -22.670101648310
             les_mean =     514.441580918073
             stat err =       0.000278423690
             autocorr =       1.250684388062
              std dev =       0.704169667363
             le_variance =       0.495854920434


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.267010164831e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3283e+01, overlap shift 2.3283e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.670101648333       residual = 4.35e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.670101669008       residual = 5.14e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.670101672935       residual = 1.37e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.670101673273       residual = 6.20e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 2.3283e+01 is 9.568912e-06

solving harmonic davidson linear method for identity shift 9.3132e+01, overlap shift 9.3132e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.670101648333       residual = 4.35e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.670101653532       residual = 5.17e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.670101654546       residual = 1.38e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.670101654625       residual = 6.33e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 9.3132e+01 is 2.413791e-06

solving harmonic davidson linear method for identity shift 3.7253e+02, overlap shift 3.7253e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.670101648333       residual = 4.35e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.670101649635       residual = 5.18e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.670101649890       residual = 1.38e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.670101649910       residual = 6.36e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 3.7253e+02 is 6.048111e-07

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.074202 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.2070e+02
  </log>
  <optVariables href="FORM.s037.opt.xml">
ci_001                -7.050617e-01 3 1  ON 0
ci_002                -7.059926e-01 3 1  ON 1
ci_003                -3.765039e-02 3 1  ON 2
ci_004                -3.890408e-02 3 1  ON 3
ci_005                 1.612547e-02 3 1  ON 4
ci_006                 1.600035e-02 3 1  ON 5
ci_007                 1.228733e-02 3 1  ON 6
ci_008                 1.246473e-02 3 1  ON 7
ci_009                -1.173789e-02 3 1  ON 8
ci_010                -1.182928e-02 3 1  ON 9
ci_011                -8.177261e-03 3 1  ON 10
ci_012                -8.138752e-03 3 1  ON 11
ci_013                 9.648125e-03 3 1  ON 12
ci_014                 9.361872e-03 3 1  ON 13
ci_015                 1.228696e-02 3 1  ON 14
ci_016                 1.255564e-02 3 1  ON 15
ci_017                 1.088266e-02 3 1  ON 16
ci_018                 1.078127e-02 3 1  ON 17
ci_019                -2.514863e-03 3 1  ON 18
ci_020                -2.423538e-03 3 1  ON 19
ci_021                -8.460979e-03 3 1  ON 20
ci_022                -8.657422e-03 3 1  ON 21
ci_023                 7.807246e-03 3 1  ON 22
ci_024                 8.041483e-03 3 1  ON 23
ci_025                 4.702013e-03 3 1  ON 24
ci_026                 4.272713e-03 3 1  ON 25
ci_027                 6.454876e-03 3 1  ON 26
ci_028                 6.477163e-03 3 1  ON 27
ci_029                -4.876518e-03 3 1  ON 28
ci_030                -4.785797e-03 3 1  ON 29
ci_031                -7.389449e-03 3 1  ON 30
ci_032                -8.123093e-03 3 1  ON 31
ci_033                 4.600153e-03 3 1  ON 32
ci_034                 4.413592e-03 3 1  ON 33
ci_035                 1.126317e-03 3 1  ON 34
ci_036                 1.040309e-03 3 1  ON 35
ci_037                 4.951612e-03 3 1  ON 36
ci_038                 5.099813e-03 3 1  ON 37
ci_039                 5.305825e-03 3 1  ON 38
ci_040                 5.322493e-03 3 1  ON 39
ci_041                 4.970439e-03 3 1  ON 40
ci_042                 5.231397e-03 3 1  ON 41
ci_043                 4.943794e-03 3 1  ON 42
ci_044                 4.945886e-03 3 1  ON 43
ci_045                 3.124036e-03 3 1  ON 44
ci_046                 3.174252e-03 3 1  ON 45
ci_047                -7.788945e-04 3 1  ON 46
ci_048                -5.633395e-04 3 1  ON 47
ci_049                 1.580041e-03 3 1  ON 48
ci_050                 1.791248e-03 3 1  ON 49
ci_051                -1.107552e-03 3 1  ON 50
ci_052                -1.244013e-03 3 1  ON 51
ci_053                -2.611036e-03 3 1  ON 52
ci_054                -2.301291e-03 3 1  ON 53
ci_055                -1.484602e-03 3 1  ON 54
ci_056                -1.377154e-03 3 1  ON 55
ci_057                -1.241029e-03 3 1  ON 56
ci_058                -1.731861e-03 3 1  ON 57
ci_059                 3.178420e-04 3 1  ON 58
ci_060                 1.424394e-04 3 1  ON 59
ci_061                -3.307884e-04 3 1  ON 60
ci_062                -9.233631e-06 3 1  ON 61
ci_063                -5.228502e-04 3 1  ON 62
ci_064                -8.919416e-04 3 1  ON 63
ci_065                -2.409704e-03 3 1  ON 64
ci_066                -2.436063e-03 3 1  ON 65
ci_067                -2.100031e-03 3 1  ON 66
ci_068                -2.473906e-03 3 1  ON 67
ci_069                -2.086597e-04 3 1  ON 68
ci_070                 1.320076e-04 3 1  ON 69
ci_071                -1.875487e-03 3 1  ON 70
ci_072                -1.960316e-03 3 1  ON 71
ci_073                 5.759006e-04 3 1  ON 72
ci_074                 2.845532e-04 3 1  ON 73
ci_075                -2.916474e-04 3 1  ON 74
ci_076                -2.996577e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="250">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =8000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 37
    time step          = 0.05
    reference energy   = -22.6964
    reference variance = 0.723985
====================================================
  Execution time = 1.0274e+02
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s037
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 62500 
  VMC Eavg = -2.2669e+01
  VMC Evar = 5.0871e-01
  Total weights = 7.8203e+06
  Execution time = 1.4659e+01
  </log>
</opt>
<opt stage="main" walkers="62500">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.495846024211
                                         uncertainty =       0.001558263188

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.495846024211
                                         uncertainty =       0.001558263188

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000248959653
  error estimate for blocks of size 2^( 2) =       0.000257932827
  error estimate for blocks of size 2^( 3) =       0.000266133678
  error estimate for blocks of size 2^( 4) =       0.000271870778
  error estimate for blocks of size 2^( 5) =       0.000275364648
  error estimate for blocks of size 2^( 6) =       0.000277081479
  error estimate for blocks of size 2^( 7) =       0.000277828906
  error estimate for blocks of size 2^( 8) =       0.000277623876
  error estimate for blocks of size 2^( 9) =       0.000277129706

      target function =                  N/A
              le_mean =     -22.669086590645
             les_mean =     514.396198677976
             stat err =       0.000277415992
             autocorr =       1.241666729552
              std dev =       0.704164236078
             le_variance =       0.495847271371

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.495846705851
                                         uncertainty =       0.001558209761

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.495846705851
                                         uncertainty =       0.001558209761

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000248959824
  error estimate for blocks of size 2^( 2) =       0.000257932995
  error estimate for blocks of size 2^( 3) =       0.000266133870
  error estimate for blocks of size 2^( 4) =       0.000271870995
  error estimate for blocks of size 2^( 5) =       0.000275364830
  error estimate for blocks of size 2^( 6) =       0.000277081647
  error estimate for blocks of size 2^( 7) =       0.000277829049
  error estimate for blocks of size 2^( 8) =       0.000277624117
  error estimate for blocks of size 2^( 9) =       0.000277129832

      target function =                  N/A
              le_mean =     -22.669086574474
             les_mean =     514.396197957680
             stat err =       0.000277416161
             autocorr =       1.241666541201
              std dev =       0.704164719662
             le_variance =       0.495847952417

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.495846363214
                                         uncertainty =       0.001558236183

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.495846363214
                                         uncertainty =       0.001558236183

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000248959738
  error estimate for blocks of size 2^( 2) =       0.000257932910
  error estimate for blocks of size 2^( 3) =       0.000266133774
  error estimate for blocks of size 2^( 4) =       0.000271870886
  error estimate for blocks of size 2^( 5) =       0.000275364739
  error estimate for blocks of size 2^( 6) =       0.000277081563
  error estimate for blocks of size 2^( 7) =       0.000277828977
  error estimate for blocks of size 2^( 8) =       0.000277623996
  error estimate for blocks of size 2^( 9) =       0.000277129768

      target function =                  N/A
              le_mean =     -22.669086582147
             les_mean =     514.396197884789
             stat err =       0.000277416076
             autocorr =       1.241666636675
              std dev =       0.704164476579
             le_variance =       0.495847610076

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.495846066273
                                         uncertainty =       0.001558259798

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.495846066273
                                         uncertainty =       0.001558259798

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000248959664
  error estimate for blocks of size 2^( 2) =       0.000257932837
  error estimate for blocks of size 2^( 3) =       0.000266133690
  error estimate for blocks of size 2^( 4) =       0.000271870791
  error estimate for blocks of size 2^( 5) =       0.000275364659
  error estimate for blocks of size 2^( 6) =       0.000277081490
  error estimate for blocks of size 2^( 7) =       0.000277828914
  error estimate for blocks of size 2^( 8) =       0.000277623891
  error estimate for blocks of size 2^( 9) =       0.000277129714

      target function =                  N/A
              le_mean =     -22.669086589537
             les_mean =     514.396198502302
             stat err =       0.000277416002
             autocorr =       1.241666718065
              std dev =       0.704164265918
             le_variance =       0.495847313396


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.669086590645        initial  <--
     2.3283e+01     2.3283e+02             9.5689e-06       -22.669086574474
     9.3132e+01     9.3132e+02             2.4138e-06       -22.669086582147
     3.7253e+02     3.7253e+03             6.0481e-07       -22.669086589537

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 176.0313
  </log>
  <optVariables href="FORM.s037.opt.xml">
ci_001                -7.050617e-01 3 1  ON 0
ci_002                -7.059927e-01 3 1  ON 1
ci_003                -3.765140e-02 3 1  ON 2
ci_004                -3.890358e-02 3 1  ON 3
ci_005                 1.612442e-02 3 1  ON 4
ci_006                 1.600100e-02 3 1  ON 5
ci_007                 1.228720e-02 3 1  ON 6
ci_008                 1.246541e-02 3 1  ON 7
ci_009                -1.173856e-02 3 1  ON 8
ci_010                -1.182889e-02 3 1  ON 9
ci_011                -8.176622e-03 3 1  ON 10
ci_012                -8.138205e-03 3 1  ON 11
ci_013                 9.647351e-03 3 1  ON 12
ci_014                 9.360450e-03 3 1  ON 13
ci_015                 1.228718e-02 3 1  ON 14
ci_016                 1.255401e-02 3 1  ON 15
ci_017                 1.088281e-02 3 1  ON 16
ci_018                 1.078111e-02 3 1  ON 17
ci_019                -2.514433e-03 3 1  ON 18
ci_020                -2.423970e-03 3 1  ON 19
ci_021                -8.459934e-03 3 1  ON 20
ci_022                -8.657079e-03 3 1  ON 21
ci_023                 7.805283e-03 3 1  ON 22
ci_024                 8.041975e-03 3 1  ON 23
ci_025                 4.702938e-03 3 1  ON 24
ci_026                 4.272897e-03 3 1  ON 25
ci_027                 6.454365e-03 3 1  ON 26
ci_028                 6.476374e-03 3 1  ON 27
ci_029                -4.877804e-03 3 1  ON 28
ci_030                -4.785588e-03 3 1  ON 29
ci_031                -7.388555e-03 3 1  ON 30
ci_032                -8.123297e-03 3 1  ON 31
ci_033                 4.600646e-03 3 1  ON 32
ci_034                 4.413460e-03 3 1  ON 33
ci_035                 1.126695e-03 3 1  ON 34
ci_036                 1.042723e-03 3 1  ON 35
ci_037                 4.953316e-03 3 1  ON 36
ci_038                 5.099454e-03 3 1  ON 37
ci_039                 5.306423e-03 3 1  ON 38
ci_040                 5.322908e-03 3 1  ON 39
ci_041                 4.970538e-03 3 1  ON 40
ci_042                 5.231208e-03 3 1  ON 41
ci_043                 4.943306e-03 3 1  ON 42
ci_044                 4.944271e-03 3 1  ON 43
ci_045                 3.123936e-03 3 1  ON 44
ci_046                 3.174262e-03 3 1  ON 45
ci_047                -7.789725e-04 3 1  ON 46
ci_048                -5.617838e-04 3 1  ON 47
ci_049                 1.580293e-03 3 1  ON 48
ci_050                 1.792687e-03 3 1  ON 49
ci_051                -1.106460e-03 3 1  ON 50
ci_052                -1.243365e-03 3 1  ON 51
ci_053                -2.610393e-03 3 1  ON 52
ci_054                -2.301905e-03 3 1  ON 53
ci_055                -1.483370e-03 3 1  ON 54
ci_056                -1.376677e-03 3 1  ON 55
ci_057                -1.240706e-03 3 1  ON 56
ci_058                -1.731089e-03 3 1  ON 57
ci_059                 3.173373e-04 3 1  ON 58
ci_060                 1.413845e-04 3 1  ON 59
ci_061                -3.305361e-04 3 1  ON 60
ci_062                -9.395588e-06 3 1  ON 61
ci_063                -5.230783e-04 3 1  ON 62
ci_064                -8.918249e-04 3 1  ON 63
ci_065                -2.407935e-03 3 1  ON 64
ci_066                -2.435196e-03 3 1  ON 65
ci_067                -2.101008e-03 3 1  ON 66
ci_068                -2.473734e-03 3 1  ON 67
ci_069                -2.085008e-04 3 1  ON 68
ci_070                 1.330080e-04 3 1  ON 69
ci_071                -1.874287e-03 3 1  ON 70
ci_072                -1.959038e-03 3 1  ON 71
ci_073                 5.752663e-04 3 1  ON 72
ci_074                 2.857250e-04 3 1  ON 73
ci_075                -2.911210e-04 3 1  ON 74
ci_076                -2.991699e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 2.9674e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s038 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s038 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=38  my_counter=0
  time step      = 5.0000e-02
  blocks         = 250
  steps          = 250
  substeps       = 10
  current        = 0
  target samples = 8.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">250</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">6.2500e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">8.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">6.2500e+04</parameter>
<parameter name="steps" condition="int">250</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2662e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="250">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =8000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 38
    time step          = 0.05
    reference energy   = -22.6968
    reference variance = 1.08421
====================================================
  Execution time = 1.0195e+02
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s038
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 62500 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 6.1049e+04
  VMC Eavg = -2.2670e+01
  VMC Evar = 5.1211e-01
  Total weights = 7.820504667e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.8976e+01
  </log>
</opt>
<opt stage="main" walkers="62500">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.498481974440
                                         uncertainty =       0.002438125260

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.498481974440
                                         uncertainty =       0.002438125260

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000249620967
  error estimate for blocks of size 2^( 2) =       0.000258638729
  error estimate for blocks of size 2^( 3) =       0.000266788913
  error estimate for blocks of size 2^( 4) =       0.000272553366
  error estimate for blocks of size 2^( 5) =       0.000276485497
  error estimate for blocks of size 2^( 6) =       0.000278628227
  error estimate for blocks of size 2^( 7) =       0.000279658146
  error estimate for blocks of size 2^( 8) =       0.000280253742
  error estimate for blocks of size 2^( 9) =       0.000280546726

      target function =                  N/A
              le_mean =     -22.669816670959
             les_mean =     514.432698066671
             stat err =       0.000279771710
             autocorr =       1.256161485463
              std dev =       0.706034713781
             le_variance =       0.498485017064


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266981667096e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3283e+02, overlap shift 2.3283e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.669816670985       residual = 4.36e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.669816673780       residual = 6.78e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.669816673875       residual = 1.82e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.669816673897       residual = 5.94e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 2.3283e+02 is 9.165828e-07

solving harmonic davidson linear method for identity shift 9.3132e+02, overlap shift 9.3132e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.669816670985       residual = 4.36e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.669816671684       residual = 6.78e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.669816671708       residual = 1.82e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.669816671713       residual = 5.96e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 9.3132e+02 is 2.292490e-07

solving harmonic davidson linear method for identity shift 3.7253e+03, overlap shift 3.7253e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.669816670985       residual = 4.36e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.669816671159       residual = 6.79e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.669816671165       residual = 1.82e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.669816671167       residual = 5.96e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 3.7253e+03 is 5.731871e-08

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.075544 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.2094e+02
  </log>
  <optVariables href="FORM.s038.opt.xml">
ci_001                -7.050616e-01 3 1  ON 0
ci_002                -7.059927e-01 3 1  ON 1
ci_003                -3.765142e-02 3 1  ON 2
ci_004                -3.890349e-02 3 1  ON 3
ci_005                 1.612429e-02 3 1  ON 4
ci_006                 1.600105e-02 3 1  ON 5
ci_007                 1.228720e-02 3 1  ON 6
ci_008                 1.246539e-02 3 1  ON 7
ci_009                -1.173853e-02 3 1  ON 8
ci_010                -1.182884e-02 3 1  ON 9
ci_011                -8.176621e-03 3 1  ON 10
ci_012                -8.138060e-03 3 1  ON 11
ci_013                 9.647255e-03 3 1  ON 12
ci_014                 9.360463e-03 3 1  ON 13
ci_015                 1.228714e-02 3 1  ON 14
ci_016                 1.255395e-02 3 1  ON 15
ci_017                 1.088284e-02 3 1  ON 16
ci_018                 1.078107e-02 3 1  ON 17
ci_019                -2.514462e-03 3 1  ON 18
ci_020                -2.424051e-03 3 1  ON 19
ci_021                -8.459869e-03 3 1  ON 20
ci_022                -8.657169e-03 3 1  ON 21
ci_023                 7.805219e-03 3 1  ON 22
ci_024                 8.041932e-03 3 1  ON 23
ci_025                 4.702846e-03 3 1  ON 24
ci_026                 4.272731e-03 3 1  ON 25
ci_027                 6.454419e-03 3 1  ON 26
ci_028                 6.476577e-03 3 1  ON 27
ci_029                -4.877903e-03 3 1  ON 28
ci_030                -4.785661e-03 3 1  ON 29
ci_031                -7.388584e-03 3 1  ON 30
ci_032                -8.123255e-03 3 1  ON 31
ci_033                 4.600463e-03 3 1  ON 32
ci_034                 4.413425e-03 3 1  ON 33
ci_035                 1.126732e-03 3 1  ON 34
ci_036                 1.042667e-03 3 1  ON 35
ci_037                 4.953454e-03 3 1  ON 36
ci_038                 5.099493e-03 3 1  ON 37
ci_039                 5.306573e-03 3 1  ON 38
ci_040                 5.322870e-03 3 1  ON 39
ci_041                 4.970659e-03 3 1  ON 40
ci_042                 5.231127e-03 3 1  ON 41
ci_043                 4.943457e-03 3 1  ON 42
ci_044                 4.944252e-03 3 1  ON 43
ci_045                 3.123972e-03 3 1  ON 44
ci_046                 3.174419e-03 3 1  ON 45
ci_047                -7.789954e-04 3 1  ON 46
ci_048                -5.618527e-04 3 1  ON 47
ci_049                 1.580420e-03 3 1  ON 48
ci_050                 1.792636e-03 3 1  ON 49
ci_051                -1.106464e-03 3 1  ON 50
ci_052                -1.243409e-03 3 1  ON 51
ci_053                -2.610622e-03 3 1  ON 52
ci_054                -2.302030e-03 3 1  ON 53
ci_055                -1.483183e-03 3 1  ON 54
ci_056                -1.376734e-03 3 1  ON 55
ci_057                -1.240823e-03 3 1  ON 56
ci_058                -1.731190e-03 3 1  ON 57
ci_059                 3.172992e-04 3 1  ON 58
ci_060                 1.414369e-04 3 1  ON 59
ci_061                -3.305271e-04 3 1  ON 60
ci_062                -9.431786e-06 3 1  ON 61
ci_063                -5.230896e-04 3 1  ON 62
ci_064                -8.917748e-04 3 1  ON 63
ci_065                -2.407914e-03 3 1  ON 64
ci_066                -2.435320e-03 3 1  ON 65
ci_067                -2.100928e-03 3 1  ON 66
ci_068                -2.473705e-03 3 1  ON 67
ci_069                -2.084441e-04 3 1  ON 68
ci_070                 1.330338e-04 3 1  ON 69
ci_071                -1.874455e-03 3 1  ON 70
ci_072                -1.959120e-03 3 1  ON 71
ci_073                 5.752027e-04 3 1  ON 72
ci_074                 2.857960e-04 3 1  ON 73
ci_075                -2.910627e-04 3 1  ON 74
ci_076                -2.991829e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="250">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =8000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 38
    time step          = 0.05
    reference energy   = -22.5976
    reference variance = 0.541894
====================================================
  Execution time = 1.0258e+02
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s038
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 62500 
  VMC Eavg = -2.2670e+01
  VMC Evar = 5.1021e-01
  Total weights = 7.8210e+06
  Execution time = 1.4671e+01
  </log>
</opt>
<opt stage="main" walkers="62500">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.497747279682
                                         uncertainty =       0.001871546675

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.497747279682
                                         uncertainty =       0.001871546675

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000249435949
  error estimate for blocks of size 2^( 2) =       0.000258273765
  error estimate for blocks of size 2^( 3) =       0.000266290355
  error estimate for blocks of size 2^( 4) =       0.000272255981
  error estimate for blocks of size 2^( 5) =       0.000275684748
  error estimate for blocks of size 2^( 6) =       0.000277335414
  error estimate for blocks of size 2^( 7) =       0.000278717059
  error estimate for blocks of size 2^( 8) =       0.000279135977
  error estimate for blocks of size 2^( 9) =       0.000280984256

      target function =                  N/A
              le_mean =     -22.669759799104
             les_mean =     514.428217088125
             stat err =       0.000279043177
             autocorr =       1.251482341322
              std dev =       0.705511403561
             le_variance =       0.497746340554

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.497747220996
                                         uncertainty =       0.001871503023

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.497747220996
                                         uncertainty =       0.001871503023

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000249435934
  error estimate for blocks of size 2^( 2) =       0.000258273750
  error estimate for blocks of size 2^( 3) =       0.000266290343
  error estimate for blocks of size 2^( 4) =       0.000272255968
  error estimate for blocks of size 2^( 5) =       0.000275684732
  error estimate for blocks of size 2^( 6) =       0.000277335406
  error estimate for blocks of size 2^( 7) =       0.000278717055
  error estimate for blocks of size 2^( 8) =       0.000279135985
  error estimate for blocks of size 2^( 9) =       0.000280984275

      target function =                  N/A
              le_mean =     -22.669759797987
             les_mean =     514.428215043697
             stat err =       0.000279043180
             autocorr =       1.251482520362
              std dev =       0.705511361955
             le_variance =       0.497746281848

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.497747250282
                                         uncertainty =       0.001871524834

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.497747250282
                                         uncertainty =       0.001871524834

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000249435941
  error estimate for blocks of size 2^( 2) =       0.000258273758
  error estimate for blocks of size 2^( 3) =       0.000266290349
  error estimate for blocks of size 2^( 4) =       0.000272255974
  error estimate for blocks of size 2^( 5) =       0.000275684740
  error estimate for blocks of size 2^( 6) =       0.000277335410
  error estimate for blocks of size 2^( 7) =       0.000278717057
  error estimate for blocks of size 2^( 8) =       0.000279135981
  error estimate for blocks of size 2^( 9) =       0.000280984265

      target function =                  N/A
              le_mean =     -22.669759798541
             les_mean =     514.428215637726
             stat err =       0.000279043178
             autocorr =       1.251482430955
              std dev =       0.705511382717
             le_variance =       0.497746311143

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.497747276003
                                         uncertainty =       0.001871543944

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.497747276003
                                         uncertainty =       0.001871543944

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000249435948
  error estimate for blocks of size 2^( 2) =       0.000258273764
  error estimate for blocks of size 2^( 3) =       0.000266290354
  error estimate for blocks of size 2^( 4) =       0.000272255980
  error estimate for blocks of size 2^( 5) =       0.000275684747
  error estimate for blocks of size 2^( 6) =       0.000277335414
  error estimate for blocks of size 2^( 7) =       0.000278717059
  error estimate for blocks of size 2^( 8) =       0.000279135978
  error estimate for blocks of size 2^( 9) =       0.000280984257

      target function =                  N/A
              le_mean =     -22.669759799033
             les_mean =     514.428216843740
             stat err =       0.000279043177
             autocorr =       1.251482352525
              std dev =       0.705511400952
             le_variance =       0.497746336873


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.669759799104        initial  <--
     2.3283e+02     2.3283e+03             9.1658e-07       -22.669759797987
     9.3132e+02     9.3132e+03             2.2925e-07       -22.669759798541
     3.7253e+03     3.7253e+04             5.7319e-08       -22.669759799033

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 175.8836
  </log>
  <optVariables href="FORM.s038.opt.xml">
ci_001                -7.050617e-01 3 1  ON 0
ci_002                -7.059927e-01 3 1  ON 1
ci_003                -3.765140e-02 3 1  ON 2
ci_004                -3.890358e-02 3 1  ON 3
ci_005                 1.612442e-02 3 1  ON 4
ci_006                 1.600100e-02 3 1  ON 5
ci_007                 1.228720e-02 3 1  ON 6
ci_008                 1.246541e-02 3 1  ON 7
ci_009                -1.173856e-02 3 1  ON 8
ci_010                -1.182889e-02 3 1  ON 9
ci_011                -8.176622e-03 3 1  ON 10
ci_012                -8.138205e-03 3 1  ON 11
ci_013                 9.647351e-03 3 1  ON 12
ci_014                 9.360450e-03 3 1  ON 13
ci_015                 1.228718e-02 3 1  ON 14
ci_016                 1.255401e-02 3 1  ON 15
ci_017                 1.088281e-02 3 1  ON 16
ci_018                 1.078111e-02 3 1  ON 17
ci_019                -2.514433e-03 3 1  ON 18
ci_020                -2.423970e-03 3 1  ON 19
ci_021                -8.459934e-03 3 1  ON 20
ci_022                -8.657079e-03 3 1  ON 21
ci_023                 7.805283e-03 3 1  ON 22
ci_024                 8.041975e-03 3 1  ON 23
ci_025                 4.702938e-03 3 1  ON 24
ci_026                 4.272897e-03 3 1  ON 25
ci_027                 6.454365e-03 3 1  ON 26
ci_028                 6.476374e-03 3 1  ON 27
ci_029                -4.877804e-03 3 1  ON 28
ci_030                -4.785588e-03 3 1  ON 29
ci_031                -7.388555e-03 3 1  ON 30
ci_032                -8.123297e-03 3 1  ON 31
ci_033                 4.600646e-03 3 1  ON 32
ci_034                 4.413460e-03 3 1  ON 33
ci_035                 1.126695e-03 3 1  ON 34
ci_036                 1.042723e-03 3 1  ON 35
ci_037                 4.953316e-03 3 1  ON 36
ci_038                 5.099454e-03 3 1  ON 37
ci_039                 5.306423e-03 3 1  ON 38
ci_040                 5.322908e-03 3 1  ON 39
ci_041                 4.970538e-03 3 1  ON 40
ci_042                 5.231208e-03 3 1  ON 41
ci_043                 4.943306e-03 3 1  ON 42
ci_044                 4.944271e-03 3 1  ON 43
ci_045                 3.123936e-03 3 1  ON 44
ci_046                 3.174262e-03 3 1  ON 45
ci_047                -7.789725e-04 3 1  ON 46
ci_048                -5.617838e-04 3 1  ON 47
ci_049                 1.580293e-03 3 1  ON 48
ci_050                 1.792687e-03 3 1  ON 49
ci_051                -1.106460e-03 3 1  ON 50
ci_052                -1.243365e-03 3 1  ON 51
ci_053                -2.610393e-03 3 1  ON 52
ci_054                -2.301905e-03 3 1  ON 53
ci_055                -1.483370e-03 3 1  ON 54
ci_056                -1.376677e-03 3 1  ON 55
ci_057                -1.240706e-03 3 1  ON 56
ci_058                -1.731089e-03 3 1  ON 57
ci_059                 3.173373e-04 3 1  ON 58
ci_060                 1.413845e-04 3 1  ON 59
ci_061                -3.305361e-04 3 1  ON 60
ci_062                -9.395588e-06 3 1  ON 61
ci_063                -5.230783e-04 3 1  ON 62
ci_064                -8.918249e-04 3 1  ON 63
ci_065                -2.407935e-03 3 1  ON 64
ci_066                -2.435196e-03 3 1  ON 65
ci_067                -2.101008e-03 3 1  ON 66
ci_068                -2.473734e-03 3 1  ON 67
ci_069                -2.085008e-04 3 1  ON 68
ci_070                 1.330080e-04 3 1  ON 69
ci_071                -1.874287e-03 3 1  ON 70
ci_072                -1.959038e-03 3 1  ON 71
ci_073                 5.752663e-04 3 1  ON 72
ci_074                 2.857250e-04 3 1  ON 73
ci_075                -2.911210e-04 3 1  ON 74
ci_076                -2.991699e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 2.9683e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s039 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s039 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=39  my_counter=0
  time step      = 5.0000e-02
  blocks         = 250
  steps          = 250
  substeps       = 10
  current        = 0
  target samples = 8.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">250</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">6.2500e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">8.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">6.2500e+04</parameter>
<parameter name="steps" condition="int">250</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2662e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="250">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =8000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 39
    time step          = 0.05
    reference energy   = -22.6032
    reference variance = 0.343815
====================================================
  Execution time = 1.0178e+02
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s039
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 62500 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 6.1078e+04
  VMC Eavg = -2.2669e+01
  VMC Evar = 5.1655e-01
  Total weights = 7.820357954e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.9044e+01
  </log>
</opt>
<opt stage="main" walkers="62500">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.500926407861
                                         uncertainty =       0.004370987196

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.500926407861
                                         uncertainty =       0.004370987196

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000250231920
  error estimate for blocks of size 2^( 2) =       0.000259185307
  error estimate for blocks of size 2^( 3) =       0.000267157924
  error estimate for blocks of size 2^( 4) =       0.000272955490
  error estimate for blocks of size 2^( 5) =       0.000276577363
  error estimate for blocks of size 2^( 6) =       0.000277927496
  error estimate for blocks of size 2^( 7) =       0.000278510256
  error estimate for blocks of size 2^( 8) =       0.000279773579
  error estimate for blocks of size 2^( 9) =       0.000280807949

      target function =                  N/A
              le_mean =     -22.669335820368
             les_mean =     514.415338776070
             stat err =       0.000279254820
             autocorr =       1.245420300307
              std dev =       0.707762749102
             le_variance =       0.500928109017


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266933582037e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3283e+03, overlap shift 2.3283e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.669335820388       residual = 3.72e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.669335820573       residual = 5.34e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.669335820586       residual = 1.27e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.669335820571       residual = 5.86e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 2.3283e+03 is 7.416014e-08

solving harmonic davidson linear method for identity shift 9.3132e+03, overlap shift 9.3132e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.669335820388       residual = 3.72e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.669335820434       residual = 5.34e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.669335820437       residual = 1.27e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.669335820437       residual = 5.87e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 9.3132e+03 is 1.854172e-08

solving harmonic davidson linear method for identity shift 3.7253e+04, overlap shift 3.7253e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.669335820388       residual = 3.72e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.669335820399       residual = 5.34e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.669335820400       residual = 1.27e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.669335820399       residual = 5.87e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 3.7253e+04 is 4.635537e-09

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.076918 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.2083e+02
  </log>
  <optVariables href="FORM.s039.opt.xml">
ci_001                -7.050617e-01 3 1  ON 0
ci_002                -7.059927e-01 3 1  ON 1
ci_003                -3.765140e-02 3 1  ON 2
ci_004                -3.890357e-02 3 1  ON 3
ci_005                 1.612441e-02 3 1  ON 4
ci_006                 1.600101e-02 3 1  ON 5
ci_007                 1.228720e-02 3 1  ON 6
ci_008                 1.246541e-02 3 1  ON 7
ci_009                -1.173856e-02 3 1  ON 8
ci_010                -1.182888e-02 3 1  ON 9
ci_011                -8.176621e-03 3 1  ON 10
ci_012                -8.138202e-03 3 1  ON 11
ci_013                 9.647346e-03 3 1  ON 12
ci_014                 9.360450e-03 3 1  ON 13
ci_015                 1.228719e-02 3 1  ON 14
ci_016                 1.255399e-02 3 1  ON 15
ci_017                 1.088282e-02 3 1  ON 16
ci_018                 1.078110e-02 3 1  ON 17
ci_019                -2.514435e-03 3 1  ON 18
ci_020                -2.423960e-03 3 1  ON 19
ci_021                -8.459935e-03 3 1  ON 20
ci_022                -8.657070e-03 3 1  ON 21
ci_023                 7.805284e-03 3 1  ON 22
ci_024                 8.041978e-03 3 1  ON 23
ci_025                 4.702926e-03 3 1  ON 24
ci_026                 4.272881e-03 3 1  ON 25
ci_027                 6.454359e-03 3 1  ON 26
ci_028                 6.476392e-03 3 1  ON 27
ci_029                -4.877813e-03 3 1  ON 28
ci_030                -4.785587e-03 3 1  ON 29
ci_031                -7.388553e-03 3 1  ON 30
ci_032                -8.123294e-03 3 1  ON 31
ci_033                 4.600655e-03 3 1  ON 32
ci_034                 4.413463e-03 3 1  ON 33
ci_035                 1.126712e-03 3 1  ON 34
ci_036                 1.042740e-03 3 1  ON 35
ci_037                 4.953303e-03 3 1  ON 36
ci_038                 5.099449e-03 3 1  ON 37
ci_039                 5.306417e-03 3 1  ON 38
ci_040                 5.322923e-03 3 1  ON 39
ci_041                 4.970535e-03 3 1  ON 40
ci_042                 5.231207e-03 3 1  ON 41
ci_043                 4.943304e-03 3 1  ON 42
ci_044                 4.944271e-03 3 1  ON 43
ci_045                 3.123929e-03 3 1  ON 44
ci_046                 3.174258e-03 3 1  ON 45
ci_047                -7.789640e-04 3 1  ON 46
ci_048                -5.617843e-04 3 1  ON 47
ci_049                 1.580292e-03 3 1  ON 48
ci_050                 1.792679e-03 3 1  ON 49
ci_051                -1.106462e-03 3 1  ON 50
ci_052                -1.243367e-03 3 1  ON 51
ci_053                -2.610403e-03 3 1  ON 52
ci_054                -2.301915e-03 3 1  ON 53
ci_055                -1.483369e-03 3 1  ON 54
ci_056                -1.376679e-03 3 1  ON 55
ci_057                -1.240709e-03 3 1  ON 56
ci_058                -1.731088e-03 3 1  ON 57
ci_059                 3.173195e-04 3 1  ON 58
ci_060                 1.413771e-04 3 1  ON 59
ci_061                -3.305387e-04 3 1  ON 60
ci_062                -9.386831e-06 3 1  ON 61
ci_063                -5.230744e-04 3 1  ON 62
ci_064                -8.918110e-04 3 1  ON 63
ci_065                -2.407938e-03 3 1  ON 64
ci_066                -2.435203e-03 3 1  ON 65
ci_067                -2.101005e-03 3 1  ON 66
ci_068                -2.473729e-03 3 1  ON 67
ci_069                -2.084936e-04 3 1  ON 68
ci_070                 1.329990e-04 3 1  ON 69
ci_071                -1.874296e-03 3 1  ON 70
ci_072                -1.959046e-03 3 1  ON 71
ci_073                 5.752477e-04 3 1  ON 72
ci_074                 2.857132e-04 3 1  ON 73
ci_075                -2.911228e-04 3 1  ON 74
ci_076                -2.991594e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="250">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =8000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 39
    time step          = 0.05
    reference energy   = -22.7102
    reference variance = 0.326364
====================================================
  Execution time = 1.0260e+02
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s039
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 62500 
  VMC Eavg = -2.2670e+01
  VMC Evar = 5.1136e-01
  Total weights = 7.8205e+06
  Execution time = 1.4674e+01
  </log>
</opt>
<opt stage="main" walkers="62500">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.496979958305
                                         uncertainty =       0.001421555517

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.496979958305
                                         uncertainty =       0.001421555517

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000249243928
  error estimate for blocks of size 2^( 2) =       0.000258165687
  error estimate for blocks of size 2^( 3) =       0.000266187989
  error estimate for blocks of size 2^( 4) =       0.000271845174
  error estimate for blocks of size 2^( 5) =       0.000275085162
  error estimate for blocks of size 2^( 6) =       0.000277229686
  error estimate for blocks of size 2^( 7) =       0.000278342183
  error estimate for blocks of size 2^( 8) =       0.000278260637
  error estimate for blocks of size 2^( 9) =       0.000278591713

      target function =                  N/A
              le_mean =     -22.669597568060
             les_mean =     514.422013979441
             stat err =       0.000278106055
             autocorr =       1.245006775944
              std dev =       0.704968285624
             le_variance =       0.496980283735

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.496979966496
                                         uncertainty =       0.001421555147

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.496979966496
                                         uncertainty =       0.001421555147

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000249243930
  error estimate for blocks of size 2^( 2) =       0.000258165689
  error estimate for blocks of size 2^( 3) =       0.000266187990
  error estimate for blocks of size 2^( 4) =       0.000271845176
  error estimate for blocks of size 2^( 5) =       0.000275085164
  error estimate for blocks of size 2^( 6) =       0.000277229688
  error estimate for blocks of size 2^( 7) =       0.000278342184
  error estimate for blocks of size 2^( 8) =       0.000278260637
  error estimate for blocks of size 2^( 9) =       0.000278591715

      target function =                  N/A
              le_mean =     -22.669597568272
             les_mean =     514.422015263490
             stat err =       0.000278106056
             autocorr =       1.245006768833
              std dev =       0.704968291438
             le_variance =       0.496980291934

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.496979962400
                                         uncertainty =       0.001421555332

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.496979962400
                                         uncertainty =       0.001421555332

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000249243929
  error estimate for blocks of size 2^( 2) =       0.000258165688
  error estimate for blocks of size 2^( 3) =       0.000266187989
  error estimate for blocks of size 2^( 4) =       0.000271845175
  error estimate for blocks of size 2^( 5) =       0.000275085163
  error estimate for blocks of size 2^( 6) =       0.000277229687
  error estimate for blocks of size 2^( 7) =       0.000278342183
  error estimate for blocks of size 2^( 8) =       0.000278260637
  error estimate for blocks of size 2^( 9) =       0.000278591714

      target function =                  N/A
              le_mean =     -22.669597568166
             les_mean =     514.422014614045
             stat err =       0.000278106055
             autocorr =       1.245006772387
              std dev =       0.704968288531
             le_variance =       0.496980287834

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.496979958817
                                         uncertainty =       0.001421555494

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.496979958817
                                         uncertainty =       0.001421555494

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000249243928
  error estimate for blocks of size 2^( 2) =       0.000258165687
  error estimate for blocks of size 2^( 3) =       0.000266187989
  error estimate for blocks of size 2^( 4) =       0.000271845174
  error estimate for blocks of size 2^( 5) =       0.000275085162
  error estimate for blocks of size 2^( 6) =       0.000277229686
  error estimate for blocks of size 2^( 7) =       0.000278342183
  error estimate for blocks of size 2^( 8) =       0.000278260637
  error estimate for blocks of size 2^( 9) =       0.000278591713

      target function =                  N/A
              le_mean =     -22.669597568073
             les_mean =     514.422014057993
             stat err =       0.000278106055
             autocorr =       1.245006775484
              std dev =       0.704968285987
             le_variance =       0.496980284248


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.669597568060        initial
     2.3283e+03     2.3283e+04             7.4160e-08       -22.669597568272  <--
     9.3132e+03     9.3132e+04             1.8542e-08       -22.669597568166
     3.7253e+04     3.7253e+05             4.6355e-09       -22.669597568073

*****************************************************************************
Applying the update for shift_i =   2.3283e+03     and shift_s =   2.3283e+04
*****************************************************************************

  Execution time = 1.7601e+02
  </log>
  <optVariables href="FORM.s039.opt.xml">
ci_001                -7.050617e-01 3 1  ON 0
ci_002                -7.059927e-01 3 1  ON 1
ci_003                -3.765139e-02 3 1  ON 2
ci_004                -3.890356e-02 3 1  ON 3
ci_005                 1.612439e-02 3 1  ON 4
ci_006                 1.600104e-02 3 1  ON 5
ci_007                 1.228720e-02 3 1  ON 6
ci_008                 1.246544e-02 3 1  ON 7
ci_009                -1.173857e-02 3 1  ON 8
ci_010                -1.182885e-02 3 1  ON 9
ci_011                -8.176616e-03 3 1  ON 10
ci_012                -8.138192e-03 3 1  ON 11
ci_013                 9.647331e-03 3 1  ON 12
ci_014                 9.360453e-03 3 1  ON 13
ci_015                 1.228722e-02 3 1  ON 14
ci_016                 1.255396e-02 3 1  ON 15
ci_017                 1.088285e-02 3 1  ON 16
ci_018                 1.078109e-02 3 1  ON 17
ci_019                -2.514439e-03 3 1  ON 18
ci_020                -2.423927e-03 3 1  ON 19
ci_021                -8.459939e-03 3 1  ON 20
ci_022                -8.657045e-03 3 1  ON 21
ci_023                 7.805287e-03 3 1  ON 22
ci_024                 8.041984e-03 3 1  ON 23
ci_025                 4.702888e-03 3 1  ON 24
ci_026                 4.272832e-03 3 1  ON 25
ci_027                 6.454342e-03 3 1  ON 26
ci_028                 6.476443e-03 3 1  ON 27
ci_029                -4.877840e-03 3 1  ON 28
ci_030                -4.785583e-03 3 1  ON 29
ci_031                -7.388546e-03 3 1  ON 30
ci_032                -8.123285e-03 3 1  ON 31
ci_033                 4.600682e-03 3 1  ON 32
ci_034                 4.413471e-03 3 1  ON 33
ci_035                 1.126765e-03 3 1  ON 34
ci_036                 1.042791e-03 3 1  ON 35
ci_037                 4.953265e-03 3 1  ON 36
ci_038                 5.099434e-03 3 1  ON 37
ci_039                 5.306400e-03 3 1  ON 38
ci_040                 5.322968e-03 3 1  ON 39
ci_041                 4.970524e-03 3 1  ON 40
ci_042                 5.231204e-03 3 1  ON 41
ci_043                 4.943300e-03 3 1  ON 42
ci_044                 4.944271e-03 3 1  ON 43
ci_045                 3.123908e-03 3 1  ON 44
ci_046                 3.174249e-03 3 1  ON 45
ci_047                -7.789385e-04 3 1  ON 46
ci_048                -5.617857e-04 3 1  ON 47
ci_049                 1.580291e-03 3 1  ON 48
ci_050                 1.792656e-03 3 1  ON 49
ci_051                -1.106468e-03 3 1  ON 50
ci_052                -1.243375e-03 3 1  ON 51
ci_053                -2.610435e-03 3 1  ON 52
ci_054                -2.301944e-03 3 1  ON 53
ci_055                -1.483366e-03 3 1  ON 54
ci_056                -1.376683e-03 3 1  ON 55
ci_057                -1.240716e-03 3 1  ON 56
ci_058                -1.731085e-03 3 1  ON 57
ci_059                 3.172661e-04 3 1  ON 58
ci_060                 1.413548e-04 3 1  ON 59
ci_061                -3.305465e-04 3 1  ON 60
ci_062                -9.360564e-06 3 1  ON 61
ci_063                -5.230627e-04 3 1  ON 62
ci_064                -8.917695e-04 3 1  ON 63
ci_065                -2.407946e-03 3 1  ON 64
ci_066                -2.435225e-03 3 1  ON 65
ci_067                -2.100994e-03 3 1  ON 66
ci_068                -2.473714e-03 3 1  ON 67
ci_069                -2.084720e-04 3 1  ON 68
ci_070                 1.329721e-04 3 1  ON 69
ci_071                -1.874324e-03 3 1  ON 70
ci_072                -1.959070e-03 3 1  ON 71
ci_073                 5.751921e-04 3 1  ON 72
ci_074                 2.856779e-04 3 1  ON 73
ci_075                -2.911279e-04 3 1  ON 74
ci_076                -2.991280e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 2.9688e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s040 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s040 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=40  my_counter=0
  time step      = 5.0000e-02
  blocks         = 250
  steps          = 250
  substeps       = 10
  current        = 0
  target samples = 8.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">250</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">6.2500e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">8.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">6.2500e+04</parameter>
<parameter name="steps" condition="int">250</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2662e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="250">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =8000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 40
    time step          = 0.05
    reference energy   = -22.6411
    reference variance = 0.288391
====================================================
  Execution time = 1.0143e+02
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s040
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 62500 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 6.1102e+04
  VMC Eavg = -2.2670e+01
  VMC Evar = 5.1162e-01
  Total weights = 7.820474659e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.8820e+01
  </log>
</opt>
<opt stage="main" walkers="62500">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.497238386712
                                         uncertainty =       0.002012259606

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.497238386712
                                         uncertainty =       0.002012259606

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000249308901
  error estimate for blocks of size 2^( 2) =       0.000258282422
  error estimate for blocks of size 2^( 3) =       0.000266437931
  error estimate for blocks of size 2^( 4) =       0.000272217069
  error estimate for blocks of size 2^( 5) =       0.000275591243
  error estimate for blocks of size 2^( 6) =       0.000277244230
  error estimate for blocks of size 2^( 7) =       0.000277570537
  error estimate for blocks of size 2^( 8) =       0.000278021291
  error estimate for blocks of size 2^( 9) =       0.000277957814

      target function =                  N/A
              le_mean =     -22.670206067789
             les_mean =     514.449863585353
             stat err =       0.000277698468
             autocorr =       1.240713191917
              std dev =       0.705152057890
             le_variance =       0.497239424747


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.267020606779e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.8208e+02, overlap shift 5.8208e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.670206067811       residual = 4.25e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.670206068606       residual = 3.53e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.670206068727       residual = 6.86e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 5.8208e+02 is 3.945590e-07

solving harmonic davidson linear method for identity shift 2.3283e+03, overlap shift 2.3283e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.670206067811       residual = 4.25e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.670206068010       residual = 3.53e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.670206068040       residual = 6.86e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 2.3283e+03 is 9.865615e-08

solving harmonic davidson linear method for identity shift 9.3132e+03, overlap shift 9.3132e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.670206067811       residual = 4.25e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.670206067861       residual = 3.53e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.670206067868       residual = 6.87e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 9.3132e+03 is 2.466506e-08

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.077998 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.2026e+02
  </log>
  <optVariables href="FORM.s040.opt.xml">
ci_001                -7.050617e-01 3 1  ON 0
ci_002                -7.059927e-01 3 1  ON 1
ci_003                -3.765137e-02 3 1  ON 2
ci_004                -3.890350e-02 3 1  ON 3
ci_005                 1.612440e-02 3 1  ON 4
ci_006                 1.600101e-02 3 1  ON 5
ci_007                 1.228718e-02 3 1  ON 6
ci_008                 1.246542e-02 3 1  ON 7
ci_009                -1.173859e-02 3 1  ON 8
ci_010                -1.182883e-02 3 1  ON 9
ci_011                -8.176572e-03 3 1  ON 10
ci_012                -8.138218e-03 3 1  ON 11
ci_013                 9.647283e-03 3 1  ON 12
ci_014                 9.360488e-03 3 1  ON 13
ci_015                 1.228720e-02 3 1  ON 14
ci_016                 1.255397e-02 3 1  ON 15
ci_017                 1.088288e-02 3 1  ON 16
ci_018                 1.078119e-02 3 1  ON 17
ci_019                -2.514413e-03 3 1  ON 18
ci_020                -2.423898e-03 3 1  ON 19
ci_021                -8.459893e-03 3 1  ON 20
ci_022                -8.657047e-03 3 1  ON 21
ci_023                 7.805228e-03 3 1  ON 22
ci_024                 8.041954e-03 3 1  ON 23
ci_025                 4.702834e-03 3 1  ON 24
ci_026                 4.272923e-03 3 1  ON 25
ci_027                 6.454287e-03 3 1  ON 26
ci_028                 6.476438e-03 3 1  ON 27
ci_029                -4.877837e-03 3 1  ON 28
ci_030                -4.785588e-03 3 1  ON 29
ci_031                -7.388571e-03 3 1  ON 30
ci_032                -8.123270e-03 3 1  ON 31
ci_033                 4.600677e-03 3 1  ON 32
ci_034                 4.413472e-03 3 1  ON 33
ci_035                 1.126785e-03 3 1  ON 34
ci_036                 1.042871e-03 3 1  ON 35
ci_037                 4.953284e-03 3 1  ON 36
ci_038                 5.099397e-03 3 1  ON 37
ci_039                 5.306394e-03 3 1  ON 38
ci_040                 5.322998e-03 3 1  ON 39
ci_041                 4.970507e-03 3 1  ON 40
ci_042                 5.231228e-03 3 1  ON 41
ci_043                 4.943241e-03 3 1  ON 42
ci_044                 4.944257e-03 3 1  ON 43
ci_045                 3.123923e-03 3 1  ON 44
ci_046                 3.174256e-03 3 1  ON 45
ci_047                -7.789671e-04 3 1  ON 46
ci_048                -5.617563e-04 3 1  ON 47
ci_049                 1.580286e-03 3 1  ON 48
ci_050                 1.792628e-03 3 1  ON 49
ci_051                -1.106508e-03 3 1  ON 50
ci_052                -1.243337e-03 3 1  ON 51
ci_053                -2.610440e-03 3 1  ON 52
ci_054                -2.301941e-03 3 1  ON 53
ci_055                -1.483386e-03 3 1  ON 54
ci_056                -1.376687e-03 3 1  ON 55
ci_057                -1.240708e-03 3 1  ON 56
ci_058                -1.731094e-03 3 1  ON 57
ci_059                 3.172494e-04 3 1  ON 58
ci_060                 1.413782e-04 3 1  ON 59
ci_061                -3.305411e-04 3 1  ON 60
ci_062                -9.393102e-06 3 1  ON 61
ci_063                -5.231020e-04 3 1  ON 62
ci_064                -8.917935e-04 3 1  ON 63
ci_065                -2.407990e-03 3 1  ON 64
ci_066                -2.435237e-03 3 1  ON 65
ci_067                -2.101006e-03 3 1  ON 66
ci_068                -2.473676e-03 3 1  ON 67
ci_069                -2.085144e-04 3 1  ON 68
ci_070                 1.329499e-04 3 1  ON 69
ci_071                -1.874285e-03 3 1  ON 70
ci_072                -1.959152e-03 3 1  ON 71
ci_073                 5.751426e-04 3 1  ON 72
ci_074                 2.856921e-04 3 1  ON 73
ci_075                -2.911185e-04 3 1  ON 74
ci_076                -2.991318e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="250">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =8000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 40
    time step          = 0.05
    reference energy   = -22.6655
    reference variance = 0.318226
====================================================
  Execution time = 1.0236e+02
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s040
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 62500 
  VMC Eavg = -2.2670e+01
  VMC Evar = 5.1249e-01
  Total weights = 7.8205e+06
  Execution time = 1.4627e+01
  </log>
</opt>
<opt stage="main" walkers="62500">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.498421740667
                                         uncertainty =       0.001615288254

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.498421740667
                                         uncertainty =       0.001615288254

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000249604878
  error estimate for blocks of size 2^( 2) =       0.000258568718
  error estimate for blocks of size 2^( 3) =       0.000266574476
  error estimate for blocks of size 2^( 4) =       0.000272194204
  error estimate for blocks of size 2^( 5) =       0.000275666084
  error estimate for blocks of size 2^( 6) =       0.000277173015
  error estimate for blocks of size 2^( 7) =       0.000277660888
  error estimate for blocks of size 2^( 8) =       0.000277913721
  error estimate for blocks of size 2^( 9) =       0.000279345358

      target function =                  N/A
              le_mean =     -22.670209823051
             les_mean =     514.450903823827
             stat err =       0.000278023246
             autocorr =       1.240669427067
              std dev =       0.705989207879
             le_variance =       0.498420761641

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.498421824542
                                         uncertainty =       0.001615302270

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.498421824542
                                         uncertainty =       0.001615302270

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000249604899
  error estimate for blocks of size 2^( 2) =       0.000258568739
  error estimate for blocks of size 2^( 3) =       0.000266574496
  error estimate for blocks of size 2^( 4) =       0.000272194223
  error estimate for blocks of size 2^( 5) =       0.000275666102
  error estimate for blocks of size 2^( 6) =       0.000277173035
  error estimate for blocks of size 2^( 7) =       0.000277660908
  error estimate for blocks of size 2^( 8) =       0.000277913743
  error estimate for blocks of size 2^( 9) =       0.000279345388

      target function =                  N/A
              le_mean =     -22.670209824482
             les_mean =     514.450904220702
             stat err =       0.000278023269
             autocorr =       1.240669423219
              std dev =       0.705989267185
             le_variance =       0.498420845381

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.498421782605
                                         uncertainty =       0.001615295262

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.498421782605
                                         uncertainty =       0.001615295262

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000249604889
  error estimate for blocks of size 2^( 2) =       0.000258568728
  error estimate for blocks of size 2^( 3) =       0.000266574486
  error estimate for blocks of size 2^( 4) =       0.000272194214
  error estimate for blocks of size 2^( 5) =       0.000275666093
  error estimate for blocks of size 2^( 6) =       0.000277173025
  error estimate for blocks of size 2^( 7) =       0.000277660898
  error estimate for blocks of size 2^( 8) =       0.000277913732
  error estimate for blocks of size 2^( 9) =       0.000279345373

      target function =                  N/A
              le_mean =     -22.670209823766
             les_mean =     514.450904019475
             stat err =       0.000278023257
             autocorr =       1.240669425163
              std dev =       0.705989237532
             le_variance =       0.498420803511

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.498421745909
                                         uncertainty =       0.001615289130

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.498421745909
                                         uncertainty =       0.001615289130

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000249604879
  error estimate for blocks of size 2^( 2) =       0.000258568720
  error estimate for blocks of size 2^( 3) =       0.000266574478
  error estimate for blocks of size 2^( 4) =       0.000272194205
  error estimate for blocks of size 2^( 5) =       0.000275666085
  error estimate for blocks of size 2^( 6) =       0.000277173016
  error estimate for blocks of size 2^( 7) =       0.000277660889
  error estimate for blocks of size 2^( 8) =       0.000277913722
  error estimate for blocks of size 2^( 9) =       0.000279345360

      target function =                  N/A
              le_mean =     -22.670209823140
             les_mean =     514.450903847958
             stat err =       0.000278023247
             autocorr =       1.240669426862
              std dev =       0.705989211585
             le_variance =       0.498420766875


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.670209823051        initial
     5.8208e+02     5.8208e+03             3.9456e-07       -22.670209824482  <--
     2.3283e+03     2.3283e+04             9.8656e-08       -22.670209823766
     9.3132e+03     9.3132e+04             2.4665e-08       -22.670209823140

*****************************************************************************
Applying the update for shift_i =   5.8208e+02     and shift_s =   5.8208e+03
*****************************************************************************

  Execution time = 1.7551e+02
  </log>
  <optVariables href="FORM.s040.opt.xml">
ci_001                -7.050617e-01 3 1  ON 0
ci_002                -7.059926e-01 3 1  ON 1
ci_003                -3.765130e-02 3 1  ON 2
ci_004                -3.890330e-02 3 1  ON 3
ci_005                 1.612444e-02 3 1  ON 4
ci_006                 1.600093e-02 3 1  ON 5
ci_007                 1.228711e-02 3 1  ON 6
ci_008                 1.246535e-02 3 1  ON 7
ci_009                -1.173864e-02 3 1  ON 8
ci_010                -1.182879e-02 3 1  ON 9
ci_011                -8.176440e-03 3 1  ON 10
ci_012                -8.138293e-03 3 1  ON 11
ci_013                 9.647139e-03 3 1  ON 12
ci_014                 9.360592e-03 3 1  ON 13
ci_015                 1.228714e-02 3 1  ON 14
ci_016                 1.255398e-02 3 1  ON 15
ci_017                 1.088298e-02 3 1  ON 16
ci_018                 1.078149e-02 3 1  ON 17
ci_019                -2.514332e-03 3 1  ON 18
ci_020                -2.423810e-03 3 1  ON 19
ci_021                -8.459754e-03 3 1  ON 20
ci_022                -8.657055e-03 3 1  ON 21
ci_023                 7.805052e-03 3 1  ON 22
ci_024                 8.041866e-03 3 1  ON 23
ci_025                 4.702669e-03 3 1  ON 24
ci_026                 4.273194e-03 3 1  ON 25
ci_027                 6.454122e-03 3 1  ON 26
ci_028                 6.476422e-03 3 1  ON 27
ci_029                -4.877830e-03 3 1  ON 28
ci_030                -4.785602e-03 3 1  ON 29
ci_031                -7.388649e-03 3 1  ON 30
ci_032                -8.123225e-03 3 1  ON 31
ci_033                 4.600662e-03 3 1  ON 32
ci_034                 4.413476e-03 3 1  ON 33
ci_035                 1.126845e-03 3 1  ON 34
ci_036                 1.043112e-03 3 1  ON 35
ci_037                 4.953339e-03 3 1  ON 36
ci_038                 5.099284e-03 3 1  ON 37
ci_039                 5.306378e-03 3 1  ON 38
ci_040                 5.323090e-03 3 1  ON 39
ci_041                 4.970456e-03 3 1  ON 40
ci_042                 5.231300e-03 3 1  ON 41
ci_043                 4.943063e-03 3 1  ON 42
ci_044                 4.944217e-03 3 1  ON 43
ci_045                 3.123966e-03 3 1  ON 44
ci_046                 3.174277e-03 3 1  ON 45
ci_047                -7.790530e-04 3 1  ON 46
ci_048                -5.616681e-04 3 1  ON 47
ci_049                 1.580272e-03 3 1  ON 48
ci_050                 1.792545e-03 3 1  ON 49
ci_051                -1.106628e-03 3 1  ON 50
ci_052                -1.243226e-03 3 1  ON 51
ci_053                -2.610456e-03 3 1  ON 52
ci_054                -2.301931e-03 3 1  ON 53
ci_055                -1.483444e-03 3 1  ON 54
ci_056                -1.376698e-03 3 1  ON 55
ci_057                -1.240684e-03 3 1  ON 56
ci_058                -1.731122e-03 3 1  ON 57
ci_059                 3.171993e-04 3 1  ON 58
ci_060                 1.414483e-04 3 1  ON 59
ci_061                -3.305250e-04 3 1  ON 60
ci_062                -9.490686e-06 3 1  ON 61
ci_063                -5.232201e-04 3 1  ON 62
ci_064                -8.918653e-04 3 1  ON 63
ci_065                -2.408122e-03 3 1  ON 64
ci_066                -2.435274e-03 3 1  ON 65
ci_067                -2.101041e-03 3 1  ON 66
ci_068                -2.473560e-03 3 1  ON 67
ci_069                -2.086415e-04 3 1  ON 68
ci_070                 1.328834e-04 3 1  ON 69
ci_071                -1.874166e-03 3 1  ON 70
ci_072                -1.959398e-03 3 1  ON 71
ci_073                 5.749944e-04 3 1  ON 72
ci_074                 2.857349e-04 3 1  ON 73
ci_075                -2.910902e-04 3 1  ON 74
ci_076                -2.991431e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 2.9581e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s041 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s041 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=41  my_counter=0
  time step      = 5.0000e-02
  blocks         = 250
  steps          = 250
  substeps       = 10
  current        = 0
  target samples = 8.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">250</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">6.2500e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">8.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">6.2500e+04</parameter>
<parameter name="steps" condition="int">250</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2661e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="250">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =8000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 41
    time step          = 0.05
    reference energy   = -22.5718
    reference variance = 0.470003
====================================================
  Execution time = 1.0181e+02
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s041
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 62500 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 6.1077e+04
  VMC Eavg = -2.2670e+01
  VMC Evar = 5.1235e-01
  Total weights = 7.820433967e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.9094e+01
  </log>
</opt>
<opt stage="main" walkers="62500">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.498413921810
                                         uncertainty =       0.001929727370

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.498413921810
                                         uncertainty =       0.001929727370

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000249603184
  error estimate for blocks of size 2^( 2) =       0.000258639334
  error estimate for blocks of size 2^( 3) =       0.000266834901
  error estimate for blocks of size 2^( 4) =       0.000272522847
  error estimate for blocks of size 2^( 5) =       0.000275731838
  error estimate for blocks of size 2^( 6) =       0.000277327760
  error estimate for blocks of size 2^( 7) =       0.000278117550
  error estimate for blocks of size 2^( 8) =       0.000278512478
  error estimate for blocks of size 2^( 9) =       0.000278033007

      target function =                  N/A
              le_mean =     -22.670308984739
             les_mean =     514.455259765513
             stat err =       0.000277997699
             autocorr =       1.240458271149
              std dev =       0.705984416104
             le_variance =       0.498413995782


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.267030898474e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.4552e+02, overlap shift 1.4552e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.670308984764       residual = 5.21e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.670308985830       residual = 9.06e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.670308986852       residual = 3.88e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.670308986610       residual = 1.29e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 1.4552e+02 is 1.632896e-06

solving harmonic davidson linear method for identity shift 5.8208e+02, overlap shift 5.8208e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.670308984764       residual = 5.21e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.670308985031       residual = 9.07e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.670308985286       residual = 3.89e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.670308985226       residual = 1.30e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 5.8208e+02 is 4.085698e-07

solving harmonic davidson linear method for identity shift 2.3283e+03, overlap shift 2.3283e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.670308984764       residual = 5.21e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.670308984831       residual = 9.07e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.670308984895       residual = 3.89e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.670308984880       residual = 1.30e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 2.3283e+03 is 1.021641e-07

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.079375 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.2092e+02
  </log>
  <optVariables href="FORM.s041.opt.xml">
ci_001                -7.050617e-01 3 1  ON 0
ci_002                -7.059927e-01 3 1  ON 1
ci_003                -3.765137e-02 3 1  ON 2
ci_004                -3.890327e-02 3 1  ON 3
ci_005                 1.612431e-02 3 1  ON 4
ci_006                 1.600093e-02 3 1  ON 5
ci_007                 1.228724e-02 3 1  ON 6
ci_008                 1.246547e-02 3 1  ON 7
ci_009                -1.173840e-02 3 1  ON 8
ci_010                -1.182868e-02 3 1  ON 9
ci_011                -8.176380e-03 3 1  ON 10
ci_012                -8.138299e-03 3 1  ON 11
ci_013                 9.647157e-03 3 1  ON 12
ci_014                 9.360755e-03 3 1  ON 13
ci_015                 1.228716e-02 3 1  ON 14
ci_016                 1.255381e-02 3 1  ON 15
ci_017                 1.088278e-02 3 1  ON 16
ci_018                 1.078148e-02 3 1  ON 17
ci_019                -2.514350e-03 3 1  ON 18
ci_020                -2.423746e-03 3 1  ON 19
ci_021                -8.459649e-03 3 1  ON 20
ci_022                -8.657071e-03 3 1  ON 21
ci_023                 7.804705e-03 3 1  ON 22
ci_024                 8.041654e-03 3 1  ON 23
ci_025                 4.702422e-03 3 1  ON 24
ci_026                 4.273097e-03 3 1  ON 25
ci_027                 6.454446e-03 3 1  ON 26
ci_028                 6.476548e-03 3 1  ON 27
ci_029                -4.877773e-03 3 1  ON 28
ci_030                -4.785380e-03 3 1  ON 29
ci_031                -7.388795e-03 3 1  ON 30
ci_032                -8.123181e-03 3 1  ON 31
ci_033                 4.600628e-03 3 1  ON 32
ci_034                 4.413557e-03 3 1  ON 33
ci_035                 1.126685e-03 3 1  ON 34
ci_036                 1.043163e-03 3 1  ON 35
ci_037                 4.953362e-03 3 1  ON 36
ci_038                 5.099148e-03 3 1  ON 37
ci_039                 5.306465e-03 3 1  ON 38
ci_040                 5.323017e-03 3 1  ON 39
ci_041                 4.970649e-03 3 1  ON 40
ci_042                 5.230967e-03 3 1  ON 41
ci_043                 4.943148e-03 3 1  ON 42
ci_044                 4.944125e-03 3 1  ON 43
ci_045                 3.124060e-03 3 1  ON 44
ci_046                 3.174377e-03 3 1  ON 45
ci_047                -7.790815e-04 3 1  ON 46
ci_048                -5.615508e-04 3 1  ON 47
ci_049                 1.580336e-03 3 1  ON 48
ci_050                 1.792495e-03 3 1  ON 49
ci_051                -1.107037e-03 3 1  ON 50
ci_052                -1.243327e-03 3 1  ON 51
ci_053                -2.610609e-03 3 1  ON 52
ci_054                -2.301805e-03 3 1  ON 53
ci_055                -1.483446e-03 3 1  ON 54
ci_056                -1.376693e-03 3 1  ON 55
ci_057                -1.240823e-03 3 1  ON 56
ci_058                -1.731136e-03 3 1  ON 57
ci_059                 3.171292e-04 3 1  ON 58
ci_060                 1.416582e-04 3 1  ON 59
ci_061                -3.304922e-04 3 1  ON 60
ci_062                -9.421958e-06 3 1  ON 61
ci_063                -5.231936e-04 3 1  ON 62
ci_064                -8.917970e-04 3 1  ON 63
ci_065                -2.408124e-03 3 1  ON 64
ci_066                -2.435212e-03 3 1  ON 65
ci_067                -2.100923e-03 3 1  ON 66
ci_068                -2.473561e-03 3 1  ON 67
ci_069                -2.087030e-04 3 1  ON 68
ci_070                 1.325453e-04 3 1  ON 69
ci_071                -1.874516e-03 3 1  ON 70
ci_072                -1.959542e-03 3 1  ON 71
ci_073                 5.748461e-04 3 1  ON 72
ci_074                 2.859500e-04 3 1  ON 73
ci_075                -2.908856e-04 3 1  ON 74
ci_076                -2.991018e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="250">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =8000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 41
    time step          = 0.05
    reference energy   = -22.5748
    reference variance = 0.583013
====================================================
  Execution time = 1.0269e+02
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s041
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 62500 
  VMC Eavg = -2.2670e+01
  VMC Evar = 5.0844e-01
  Total weights = 7.8204e+06
  Execution time = 1.4664e+01
  </log>
</opt>
<opt stage="main" walkers="62500">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.495485251782
                                         uncertainty =       0.001948659733

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.495485251782
                                         uncertainty =       0.001948659733

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000248869534
  error estimate for blocks of size 2^( 2) =       0.000257883864
  error estimate for blocks of size 2^( 3) =       0.000265977344
  error estimate for blocks of size 2^( 4) =       0.000271847314
  error estimate for blocks of size 2^( 5) =       0.000275115164
  error estimate for blocks of size 2^( 6) =       0.000276686924
  error estimate for blocks of size 2^( 7) =       0.000277520092
  error estimate for blocks of size 2^( 8) =       0.000277295942
  error estimate for blocks of size 2^( 9) =       0.000278880477

      target function =                  N/A
              le_mean =     -22.670325186623
             les_mean =     514.452085813673
             stat err =       0.000277595859
             autocorr =       1.244177940139
              std dev =       0.703909340514
             le_variance =       0.495488359663

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.495488286088
                                         uncertainty =       0.001950655975

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.495488286088
                                         uncertainty =       0.001950655975

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000248870296
  error estimate for blocks of size 2^( 2) =       0.000257884616
  error estimate for blocks of size 2^( 3) =       0.000265978080
  error estimate for blocks of size 2^( 4) =       0.000271848054
  error estimate for blocks of size 2^( 5) =       0.000275115894
  error estimate for blocks of size 2^( 6) =       0.000276687658
  error estimate for blocks of size 2^( 7) =       0.000277520825
  error estimate for blocks of size 2^( 8) =       0.000277296666
  error estimate for blocks of size 2^( 9) =       0.000278881111

      target function =                  N/A
              le_mean =     -22.670325177058
             les_mean =     514.452090538855
             stat err =       0.000277596565
             autocorr =       1.244176654545
              std dev =       0.703911495244
             le_variance =       0.495491393136

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.495486768832
                                         uncertainty =       0.001949657499

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.495486768832
                                         uncertainty =       0.001949657499

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000248869915
  error estimate for blocks of size 2^( 2) =       0.000257884240
  error estimate for blocks of size 2^( 3) =       0.000265977712
  error estimate for blocks of size 2^( 4) =       0.000271847684
  error estimate for blocks of size 2^( 5) =       0.000275115529
  error estimate for blocks of size 2^( 6) =       0.000276687291
  error estimate for blocks of size 2^( 7) =       0.000277520459
  error estimate for blocks of size 2^( 8) =       0.000277296304
  error estimate for blocks of size 2^( 9) =       0.000278880794

      target function =                  N/A
              le_mean =     -22.670325181832
             les_mean =     514.452088082563
             stat err =       0.000277596212
             autocorr =       1.244177297485
              std dev =       0.703910417807
             le_variance =       0.495489876298

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.495485441280
                                         uncertainty =       0.001948784335

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.495485441280
                                         uncertainty =       0.001948784335

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000248869582
  error estimate for blocks of size 2^( 2) =       0.000257883911
  error estimate for blocks of size 2^( 3) =       0.000265977390
  error estimate for blocks of size 2^( 4) =       0.000271847361
  error estimate for blocks of size 2^( 5) =       0.000275115210
  error estimate for blocks of size 2^( 6) =       0.000276686969
  error estimate for blocks of size 2^( 7) =       0.000277520138
  error estimate for blocks of size 2^( 8) =       0.000277295988
  error estimate for blocks of size 2^( 9) =       0.000278880517

      target function =                  N/A
              le_mean =     -22.670325186024
             les_mean =     514.452086087450
             stat err =       0.000277595903
             autocorr =       1.244177859860
              std dev =       0.703909475082
             le_variance =       0.495488549110


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.670325186623        initial  <--
     1.4552e+02     1.4552e+03             1.6329e-06       -22.670325177058
     5.8208e+02     5.8208e+03             4.0857e-07       -22.670325181832
     2.3283e+03     2.3283e+04             1.0216e-07       -22.670325186024

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 175.9878
  </log>
  <optVariables href="FORM.s041.opt.xml">
ci_001                -7.050617e-01 3 1  ON 0
ci_002                -7.059926e-01 3 1  ON 1
ci_003                -3.765130e-02 3 1  ON 2
ci_004                -3.890330e-02 3 1  ON 3
ci_005                 1.612444e-02 3 1  ON 4
ci_006                 1.600093e-02 3 1  ON 5
ci_007                 1.228711e-02 3 1  ON 6
ci_008                 1.246535e-02 3 1  ON 7
ci_009                -1.173864e-02 3 1  ON 8
ci_010                -1.182879e-02 3 1  ON 9
ci_011                -8.176440e-03 3 1  ON 10
ci_012                -8.138293e-03 3 1  ON 11
ci_013                 9.647139e-03 3 1  ON 12
ci_014                 9.360592e-03 3 1  ON 13
ci_015                 1.228714e-02 3 1  ON 14
ci_016                 1.255398e-02 3 1  ON 15
ci_017                 1.088298e-02 3 1  ON 16
ci_018                 1.078149e-02 3 1  ON 17
ci_019                -2.514332e-03 3 1  ON 18
ci_020                -2.423810e-03 3 1  ON 19
ci_021                -8.459754e-03 3 1  ON 20
ci_022                -8.657055e-03 3 1  ON 21
ci_023                 7.805052e-03 3 1  ON 22
ci_024                 8.041866e-03 3 1  ON 23
ci_025                 4.702669e-03 3 1  ON 24
ci_026                 4.273194e-03 3 1  ON 25
ci_027                 6.454122e-03 3 1  ON 26
ci_028                 6.476422e-03 3 1  ON 27
ci_029                -4.877830e-03 3 1  ON 28
ci_030                -4.785602e-03 3 1  ON 29
ci_031                -7.388649e-03 3 1  ON 30
ci_032                -8.123225e-03 3 1  ON 31
ci_033                 4.600662e-03 3 1  ON 32
ci_034                 4.413476e-03 3 1  ON 33
ci_035                 1.126845e-03 3 1  ON 34
ci_036                 1.043112e-03 3 1  ON 35
ci_037                 4.953339e-03 3 1  ON 36
ci_038                 5.099284e-03 3 1  ON 37
ci_039                 5.306378e-03 3 1  ON 38
ci_040                 5.323090e-03 3 1  ON 39
ci_041                 4.970456e-03 3 1  ON 40
ci_042                 5.231300e-03 3 1  ON 41
ci_043                 4.943063e-03 3 1  ON 42
ci_044                 4.944217e-03 3 1  ON 43
ci_045                 3.123966e-03 3 1  ON 44
ci_046                 3.174277e-03 3 1  ON 45
ci_047                -7.790530e-04 3 1  ON 46
ci_048                -5.616681e-04 3 1  ON 47
ci_049                 1.580272e-03 3 1  ON 48
ci_050                 1.792545e-03 3 1  ON 49
ci_051                -1.106628e-03 3 1  ON 50
ci_052                -1.243226e-03 3 1  ON 51
ci_053                -2.610456e-03 3 1  ON 52
ci_054                -2.301931e-03 3 1  ON 53
ci_055                -1.483444e-03 3 1  ON 54
ci_056                -1.376698e-03 3 1  ON 55
ci_057                -1.240684e-03 3 1  ON 56
ci_058                -1.731122e-03 3 1  ON 57
ci_059                 3.171993e-04 3 1  ON 58
ci_060                 1.414483e-04 3 1  ON 59
ci_061                -3.305250e-04 3 1  ON 60
ci_062                -9.490686e-06 3 1  ON 61
ci_063                -5.232201e-04 3 1  ON 62
ci_064                -8.918653e-04 3 1  ON 63
ci_065                -2.408122e-03 3 1  ON 64
ci_066                -2.435274e-03 3 1  ON 65
ci_067                -2.101041e-03 3 1  ON 66
ci_068                -2.473560e-03 3 1  ON 67
ci_069                -2.086415e-04 3 1  ON 68
ci_070                 1.328834e-04 3 1  ON 69
ci_071                -1.874166e-03 3 1  ON 70
ci_072                -1.959398e-03 3 1  ON 71
ci_073                 5.749944e-04 3 1  ON 72
ci_074                 2.857349e-04 3 1  ON 73
ci_075                -2.910902e-04 3 1  ON 74
ci_076                -2.991431e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 2.9691e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s042 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s042 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=42  my_counter=0
  time step      = 5.0000e-02
  blocks         = 250
  steps          = 250
  substeps       = 10
  current        = 0
  target samples = 8.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">250</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">6.2500e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">8.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">6.2500e+04</parameter>
<parameter name="steps" condition="int">250</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2659e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="250">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =8000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 42
    time step          = 0.05
    reference energy   = -22.6957
    reference variance = 0.320472
====================================================
  Execution time = 1.0172e+02
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s042
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 62500 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 6.1077e+04
  VMC Eavg = -2.2670e+01
  VMC Evar = 5.0988e-01
  Total weights = 7.821117577e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.8927e+01
  </log>
</opt>
<opt stage="main" walkers="62500">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.496984258053
                                         uncertainty =       0.001554018900

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.496984258053
                                         uncertainty =       0.001554018900

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000249245409
  error estimate for blocks of size 2^( 2) =       0.000258226463
  error estimate for blocks of size 2^( 3) =       0.000266345056
  error estimate for blocks of size 2^( 4) =       0.000272036890
  error estimate for blocks of size 2^( 5) =       0.000275499021
  error estimate for blocks of size 2^( 6) =       0.000277219947
  error estimate for blocks of size 2^( 7) =       0.000279123279
  error estimate for blocks of size 2^( 8) =       0.000279468546
  error estimate for blocks of size 2^( 9) =       0.000280181564

      target function =                  N/A
              le_mean =     -22.669736688378
             les_mean =     514.426846243709
             stat err =       0.000278998334
             autocorr =       1.252993687195
              std dev =       0.704972476520
             le_variance =       0.496986192651


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266973668838e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.4552e+03, overlap shift 1.4552e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.669736688402       residual = 4.88e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.669736689366       residual = 7.10e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.669736689302       residual = 3.36e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.669736689334       residual = 1.20e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 1.4552e+03 is 1.187741e-07

solving harmonic davidson linear method for identity shift 5.8208e+03, overlap shift 5.8208e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.669736688402       residual = 4.88e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.669736688643       residual = 7.10e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.669736688627       residual = 3.36e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.669736688636       residual = 1.20e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 5.8208e+03 is 2.969654e-08

solving harmonic davidson linear method for identity shift 2.3283e+04, overlap shift 2.3283e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.669736688402       residual = 4.88e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.669736688463       residual = 7.10e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.669736688459       residual = 3.36e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.669736688466       residual = 1.20e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 2.3283e+04 is 7.424324e-09

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.083864 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.2067e+02
  </log>
  <optVariables href="FORM.s042.opt.xml">
ci_001                -7.050617e-01 3 1  ON 0
ci_002                -7.059926e-01 3 1  ON 1
ci_003                -3.765130e-02 3 1  ON 2
ci_004                -3.890331e-02 3 1  ON 3
ci_005                 1.612444e-02 3 1  ON 4
ci_006                 1.600091e-02 3 1  ON 5
ci_007                 1.228710e-02 3 1  ON 6
ci_008                 1.246538e-02 3 1  ON 7
ci_009                -1.173866e-02 3 1  ON 8
ci_010                -1.182879e-02 3 1  ON 9
ci_011                -8.176450e-03 3 1  ON 10
ci_012                -8.138305e-03 3 1  ON 11
ci_013                 9.647129e-03 3 1  ON 12
ci_014                 9.360601e-03 3 1  ON 13
ci_015                 1.228717e-02 3 1  ON 14
ci_016                 1.255399e-02 3 1  ON 15
ci_017                 1.088299e-02 3 1  ON 16
ci_018                 1.078148e-02 3 1  ON 17
ci_019                -2.514344e-03 3 1  ON 18
ci_020                -2.423820e-03 3 1  ON 19
ci_021                -8.459740e-03 3 1  ON 20
ci_022                -8.657041e-03 3 1  ON 21
ci_023                 7.805047e-03 3 1  ON 22
ci_024                 8.041836e-03 3 1  ON 23
ci_025                 4.702664e-03 3 1  ON 24
ci_026                 4.273218e-03 3 1  ON 25
ci_027                 6.454120e-03 3 1  ON 26
ci_028                 6.476413e-03 3 1  ON 27
ci_029                -4.877830e-03 3 1  ON 28
ci_030                -4.785603e-03 3 1  ON 29
ci_031                -7.388667e-03 3 1  ON 30
ci_032                -8.123200e-03 3 1  ON 31
ci_033                 4.600656e-03 3 1  ON 32
ci_034                 4.413491e-03 3 1  ON 33
ci_035                 1.126841e-03 3 1  ON 34
ci_036                 1.043103e-03 3 1  ON 35
ci_037                 4.953365e-03 3 1  ON 36
ci_038                 5.099279e-03 3 1  ON 37
ci_039                 5.306391e-03 3 1  ON 38
ci_040                 5.323108e-03 3 1  ON 39
ci_041                 4.970482e-03 3 1  ON 40
ci_042                 5.231291e-03 3 1  ON 41
ci_043                 4.943077e-03 3 1  ON 42
ci_044                 4.944204e-03 3 1  ON 43
ci_045                 3.123948e-03 3 1  ON 44
ci_046                 3.174263e-03 3 1  ON 45
ci_047                -7.790413e-04 3 1  ON 46
ci_048                -5.616682e-04 3 1  ON 47
ci_049                 1.580296e-03 3 1  ON 48
ci_050                 1.792523e-03 3 1  ON 49
ci_051                -1.106656e-03 3 1  ON 50
ci_052                -1.243237e-03 3 1  ON 51
ci_053                -2.610472e-03 3 1  ON 52
ci_054                -2.301945e-03 3 1  ON 53
ci_055                -1.483426e-03 3 1  ON 54
ci_056                -1.376694e-03 3 1  ON 55
ci_057                -1.240667e-03 3 1  ON 56
ci_058                -1.731112e-03 3 1  ON 57
ci_059                 3.171890e-04 3 1  ON 58
ci_060                 1.414604e-04 3 1  ON 59
ci_061                -3.305162e-04 3 1  ON 60
ci_062                -9.469128e-06 3 1  ON 61
ci_063                -5.232104e-04 3 1  ON 62
ci_064                -8.918556e-04 3 1  ON 63
ci_065                -2.408129e-03 3 1  ON 64
ci_066                -2.435278e-03 3 1  ON 65
ci_067                -2.101061e-03 3 1  ON 66
ci_068                -2.473541e-03 3 1  ON 67
ci_069                -2.086534e-04 3 1  ON 68
ci_070                 1.328801e-04 3 1  ON 69
ci_071                -1.874179e-03 3 1  ON 70
ci_072                -1.959413e-03 3 1  ON 71
ci_073                 5.749833e-04 3 1  ON 72
ci_074                 2.857520e-04 3 1  ON 73
ci_075                -2.910979e-04 3 1  ON 74
ci_076                -2.991158e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="250">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =8000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 42
    time step          = 0.05
    reference energy   = -22.7687
    reference variance = 0.614579
====================================================
  Execution time = 1.0239e+02
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s042
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 62500 
  VMC Eavg = -2.2670e+01
  VMC Evar = 5.1135e-01
  Total weights = 7.8206e+06
  Execution time = 1.4643e+01
  </log>
</opt>
<opt stage="main" walkers="62500">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.498894005394
                                         uncertainty =       0.002490166742

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.498894005394
                                         uncertainty =       0.002490166742

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000249724030
  error estimate for blocks of size 2^( 2) =       0.000258639811
  error estimate for blocks of size 2^( 3) =       0.000266655923
  error estimate for blocks of size 2^( 4) =       0.000272580819
  error estimate for blocks of size 2^( 5) =       0.000275645678
  error estimate for blocks of size 2^( 6) =       0.000277086836
  error estimate for blocks of size 2^( 7) =       0.000278326598
  error estimate for blocks of size 2^( 8) =       0.000278307658
  error estimate for blocks of size 2^( 9) =       0.000278851479

      target function =                  N/A
              le_mean =     -22.669752194664
             les_mean =     514.429016904429
             stat err =       0.000278143143
             autocorr =       1.240555059157
              std dev =       0.706326220824
             le_variance =       0.498896730224

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.498893975924
                                         uncertainty =       0.002490156337

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.498893975924
                                         uncertainty =       0.002490156337

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000249724023
  error estimate for blocks of size 2^( 2) =       0.000258639804
  error estimate for blocks of size 2^( 3) =       0.000266655916
  error estimate for blocks of size 2^( 4) =       0.000272580813
  error estimate for blocks of size 2^( 5) =       0.000275645671
  error estimate for blocks of size 2^( 6) =       0.000277086829
  error estimate for blocks of size 2^( 7) =       0.000278326592
  error estimate for blocks of size 2^( 8) =       0.000278307652
  error estimate for blocks of size 2^( 9) =       0.000278851474

      target function =                  N/A
              le_mean =     -22.669752194573
             les_mean =     514.429016719723
             stat err =       0.000278143137
             autocorr =       1.240555081580
              std dev =       0.706326199953
             le_variance =       0.498896700740

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.498893990657
                                         uncertainty =       0.002490161539

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.498893990657
                                         uncertainty =       0.002490161539

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000249724027
  error estimate for blocks of size 2^( 2) =       0.000258639808
  error estimate for blocks of size 2^( 3) =       0.000266655919
  error estimate for blocks of size 2^( 4) =       0.000272580816
  error estimate for blocks of size 2^( 5) =       0.000275645674
  error estimate for blocks of size 2^( 6) =       0.000277086833
  error estimate for blocks of size 2^( 7) =       0.000278326595
  error estimate for blocks of size 2^( 8) =       0.000278307655
  error estimate for blocks of size 2^( 9) =       0.000278851477

      target function =                  N/A
              le_mean =     -22.669752194618
             les_mean =     514.429016810823
             stat err =       0.000278143140
             autocorr =       1.240555070376
              std dev =       0.706326210387
             le_variance =       0.498896715480

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.498894003552
                                         uncertainty =       0.002490166092

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.498894003552
                                         uncertainty =       0.002490166092

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000249724030
  error estimate for blocks of size 2^( 2) =       0.000258639811
  error estimate for blocks of size 2^( 3) =       0.000266655922
  error estimate for blocks of size 2^( 4) =       0.000272580819
  error estimate for blocks of size 2^( 5) =       0.000275645677
  error estimate for blocks of size 2^( 6) =       0.000277086836
  error estimate for blocks of size 2^( 7) =       0.000278326598
  error estimate for blocks of size 2^( 8) =       0.000278307657
  error estimate for blocks of size 2^( 9) =       0.000278851479

      target function =                  N/A
              le_mean =     -22.669752194658
             les_mean =     514.429016892592
             stat err =       0.000278143142
             autocorr =       1.240555060538
              std dev =       0.706326219519
             le_variance =       0.498896728380


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.669752194664        initial  <--
     1.4552e+03     1.4552e+04             1.1877e-07       -22.669752194573
     5.8208e+03     5.8208e+04             2.9697e-08       -22.669752194618
     2.3283e+04     2.3283e+05             7.4243e-09       -22.669752194658

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 175.6235
  </log>
  <optVariables href="FORM.s042.opt.xml">
ci_001                -7.050617e-01 3 1  ON 0
ci_002                -7.059926e-01 3 1  ON 1
ci_003                -3.765130e-02 3 1  ON 2
ci_004                -3.890330e-02 3 1  ON 3
ci_005                 1.612444e-02 3 1  ON 4
ci_006                 1.600093e-02 3 1  ON 5
ci_007                 1.228711e-02 3 1  ON 6
ci_008                 1.246535e-02 3 1  ON 7
ci_009                -1.173864e-02 3 1  ON 8
ci_010                -1.182879e-02 3 1  ON 9
ci_011                -8.176440e-03 3 1  ON 10
ci_012                -8.138293e-03 3 1  ON 11
ci_013                 9.647139e-03 3 1  ON 12
ci_014                 9.360592e-03 3 1  ON 13
ci_015                 1.228714e-02 3 1  ON 14
ci_016                 1.255398e-02 3 1  ON 15
ci_017                 1.088298e-02 3 1  ON 16
ci_018                 1.078149e-02 3 1  ON 17
ci_019                -2.514332e-03 3 1  ON 18
ci_020                -2.423810e-03 3 1  ON 19
ci_021                -8.459754e-03 3 1  ON 20
ci_022                -8.657055e-03 3 1  ON 21
ci_023                 7.805052e-03 3 1  ON 22
ci_024                 8.041866e-03 3 1  ON 23
ci_025                 4.702669e-03 3 1  ON 24
ci_026                 4.273194e-03 3 1  ON 25
ci_027                 6.454122e-03 3 1  ON 26
ci_028                 6.476422e-03 3 1  ON 27
ci_029                -4.877830e-03 3 1  ON 28
ci_030                -4.785602e-03 3 1  ON 29
ci_031                -7.388649e-03 3 1  ON 30
ci_032                -8.123225e-03 3 1  ON 31
ci_033                 4.600662e-03 3 1  ON 32
ci_034                 4.413476e-03 3 1  ON 33
ci_035                 1.126845e-03 3 1  ON 34
ci_036                 1.043112e-03 3 1  ON 35
ci_037                 4.953339e-03 3 1  ON 36
ci_038                 5.099284e-03 3 1  ON 37
ci_039                 5.306378e-03 3 1  ON 38
ci_040                 5.323090e-03 3 1  ON 39
ci_041                 4.970456e-03 3 1  ON 40
ci_042                 5.231300e-03 3 1  ON 41
ci_043                 4.943063e-03 3 1  ON 42
ci_044                 4.944217e-03 3 1  ON 43
ci_045                 3.123966e-03 3 1  ON 44
ci_046                 3.174277e-03 3 1  ON 45
ci_047                -7.790530e-04 3 1  ON 46
ci_048                -5.616681e-04 3 1  ON 47
ci_049                 1.580272e-03 3 1  ON 48
ci_050                 1.792545e-03 3 1  ON 49
ci_051                -1.106628e-03 3 1  ON 50
ci_052                -1.243226e-03 3 1  ON 51
ci_053                -2.610456e-03 3 1  ON 52
ci_054                -2.301931e-03 3 1  ON 53
ci_055                -1.483444e-03 3 1  ON 54
ci_056                -1.376698e-03 3 1  ON 55
ci_057                -1.240684e-03 3 1  ON 56
ci_058                -1.731122e-03 3 1  ON 57
ci_059                 3.171993e-04 3 1  ON 58
ci_060                 1.414483e-04 3 1  ON 59
ci_061                -3.305250e-04 3 1  ON 60
ci_062                -9.490686e-06 3 1  ON 61
ci_063                -5.232201e-04 3 1  ON 62
ci_064                -8.918653e-04 3 1  ON 63
ci_065                -2.408122e-03 3 1  ON 64
ci_066                -2.435274e-03 3 1  ON 65
ci_067                -2.101041e-03 3 1  ON 66
ci_068                -2.473560e-03 3 1  ON 67
ci_069                -2.086415e-04 3 1  ON 68
ci_070                 1.328834e-04 3 1  ON 69
ci_071                -1.874166e-03 3 1  ON 70
ci_072                -1.959398e-03 3 1  ON 71
ci_073                 5.749944e-04 3 1  ON 72
ci_074                 2.857349e-04 3 1  ON 73
ci_075                -2.910902e-04 3 1  ON 74
ci_076                -2.991431e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 2.9633e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s043 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s043 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=43  my_counter=0
  time step      = 5.0000e-02
  blocks         = 250
  steps          = 250
  substeps       = 10
  current        = 0
  target samples = 8.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">250</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">6.2500e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">8.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">6.2500e+04</parameter>
<parameter name="steps" condition="int">250</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2661e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="250">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =8000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 43
    time step          = 0.05
    reference energy   = -22.6442
    reference variance = 0.400279
====================================================
  Execution time = 1.0164e+02
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s043
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 62500 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 6.1095e+04
  VMC Eavg = -2.2669e+01
  VMC Evar = 5.0875e-01
  Total weights = 7.820296136e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.9068e+01
  </log>
</opt>
<opt stage="main" walkers="62500">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.494902973735
                                         uncertainty =       0.001342537169

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.494902973735
                                         uncertainty =       0.001342537169

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000248722177
  error estimate for blocks of size 2^( 2) =       0.000257815933
  error estimate for blocks of size 2^( 3) =       0.000265643178
  error estimate for blocks of size 2^( 4) =       0.000271394030
  error estimate for blocks of size 2^( 5) =       0.000274887979
  error estimate for blocks of size 2^( 6) =       0.000276436659
  error estimate for blocks of size 2^( 7) =       0.000276873254
  error estimate for blocks of size 2^( 8) =       0.000277164806
  error estimate for blocks of size 2^( 9) =       0.000277549966

      target function =                  N/A
              le_mean =     -22.669426497735
             les_mean =     514.411645614584
             stat err =       0.000277006171
             autocorr =       1.240366037301
              std dev =       0.703492553254
             le_variance =       0.494901772484


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266942649774e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.4552e+04, overlap shift 1.4552e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.669426497752       residual = 4.82e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.669426497806       residual = 7.72e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.669426497796       residual = 2.36e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.669426497796       residual = 9.44e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 1.4552e+04 is 1.815132e-08

solving harmonic davidson linear method for identity shift 5.8208e+04, overlap shift 5.8208e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.669426497752       residual = 4.82e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.669426497766       residual = 7.72e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.669426497763       residual = 2.36e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.669426497763       residual = 9.44e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 5.8208e+04 is 4.537860e-09

solving harmonic davidson linear method for identity shift 2.3283e+05, overlap shift 2.3283e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.669426497752       residual = 4.82e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.669426497756       residual = 7.72e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.669426497755       residual = 2.36e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.669426497753       residual = 9.44e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 2.3283e+05 is 1.134467e-09

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.088303 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.2073e+02
  </log>
  <optVariables href="FORM.s043.opt.xml">
ci_001                -7.050617e-01 3 1  ON 0
ci_002                -7.059926e-01 3 1  ON 1
ci_003                -3.765130e-02 3 1  ON 2
ci_004                -3.890330e-02 3 1  ON 3
ci_005                 1.612444e-02 3 1  ON 4
ci_006                 1.600093e-02 3 1  ON 5
ci_007                 1.228711e-02 3 1  ON 6
ci_008                 1.246535e-02 3 1  ON 7
ci_009                -1.173864e-02 3 1  ON 8
ci_010                -1.182879e-02 3 1  ON 9
ci_011                -8.176439e-03 3 1  ON 10
ci_012                -8.138293e-03 3 1  ON 11
ci_013                 9.647137e-03 3 1  ON 12
ci_014                 9.360591e-03 3 1  ON 13
ci_015                 1.228715e-02 3 1  ON 14
ci_016                 1.255398e-02 3 1  ON 15
ci_017                 1.088298e-02 3 1  ON 16
ci_018                 1.078148e-02 3 1  ON 17
ci_019                -2.514331e-03 3 1  ON 18
ci_020                -2.423811e-03 3 1  ON 19
ci_021                -8.459753e-03 3 1  ON 20
ci_022                -8.657055e-03 3 1  ON 21
ci_023                 7.805051e-03 3 1  ON 22
ci_024                 8.041865e-03 3 1  ON 23
ci_025                 4.702669e-03 3 1  ON 24
ci_026                 4.273193e-03 3 1  ON 25
ci_027                 6.454123e-03 3 1  ON 26
ci_028                 6.476419e-03 3 1  ON 27
ci_029                -4.877829e-03 3 1  ON 28
ci_030                -4.785601e-03 3 1  ON 29
ci_031                -7.388649e-03 3 1  ON 30
ci_032                -8.123221e-03 3 1  ON 31
ci_033                 4.600661e-03 3 1  ON 32
ci_034                 4.413476e-03 3 1  ON 33
ci_035                 1.126847e-03 3 1  ON 34
ci_036                 1.043112e-03 3 1  ON 35
ci_037                 4.953339e-03 3 1  ON 36
ci_038                 5.099285e-03 3 1  ON 37
ci_039                 5.306379e-03 3 1  ON 38
ci_040                 5.323087e-03 3 1  ON 39
ci_041                 4.970457e-03 3 1  ON 40
ci_042                 5.231299e-03 3 1  ON 41
ci_043                 4.943062e-03 3 1  ON 42
ci_044                 4.944216e-03 3 1  ON 43
ci_045                 3.123966e-03 3 1  ON 44
ci_046                 3.174275e-03 3 1  ON 45
ci_047                -7.790536e-04 3 1  ON 46
ci_048                -5.616691e-04 3 1  ON 47
ci_049                 1.580270e-03 3 1  ON 48
ci_050                 1.792542e-03 3 1  ON 49
ci_051                -1.106630e-03 3 1  ON 50
ci_052                -1.243226e-03 3 1  ON 51
ci_053                -2.610454e-03 3 1  ON 52
ci_054                -2.301931e-03 3 1  ON 53
ci_055                -1.483448e-03 3 1  ON 54
ci_056                -1.376699e-03 3 1  ON 55
ci_057                -1.240684e-03 3 1  ON 56
ci_058                -1.731120e-03 3 1  ON 57
ci_059                 3.171983e-04 3 1  ON 58
ci_060                 1.414494e-04 3 1  ON 59
ci_061                -3.305246e-04 3 1  ON 60
ci_062                -9.492990e-06 3 1  ON 61
ci_063                -5.232217e-04 3 1  ON 62
ci_064                -8.918652e-04 3 1  ON 63
ci_065                -2.408122e-03 3 1  ON 64
ci_066                -2.435274e-03 3 1  ON 65
ci_067                -2.101044e-03 3 1  ON 66
ci_068                -2.473559e-03 3 1  ON 67
ci_069                -2.086396e-04 3 1  ON 68
ci_070                 1.328819e-04 3 1  ON 69
ci_071                -1.874166e-03 3 1  ON 70
ci_072                -1.959399e-03 3 1  ON 71
ci_073                 5.749925e-04 3 1  ON 72
ci_074                 2.857360e-04 3 1  ON 73
ci_075                -2.910918e-04 3 1  ON 74
ci_076                -2.991428e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="250">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =8000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 43
    time step          = 0.05
    reference energy   = -22.6643
    reference variance = 0.354444
====================================================
  Execution time = 1.0282e+02
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s043
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 62500 
  VMC Eavg = -2.2670e+01
  VMC Evar = 5.0959e-01
  Total weights = 7.8201e+06
  Execution time = 1.4612e+01
  </log>
</opt>
<opt stage="main" walkers="62500">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.496234734224
                                         uncertainty =       0.001357229578

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.496234734224
                                         uncertainty =       0.001357229578

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000249057114
  error estimate for blocks of size 2^( 2) =       0.000258049580
  error estimate for blocks of size 2^( 3) =       0.000266185183
  error estimate for blocks of size 2^( 4) =       0.000271991796
  error estimate for blocks of size 2^( 5) =       0.000275345753
  error estimate for blocks of size 2^( 6) =       0.000277085667
  error estimate for blocks of size 2^( 7) =       0.000278503461
  error estimate for blocks of size 2^( 8) =       0.000280495953
  error estimate for blocks of size 2^( 9) =       0.000279761625

      target function =                  N/A
              le_mean =     -22.669883735768
             les_mean =     514.433223399768
             stat err =       0.000278961677
             autocorr =       1.254559277386
              std dev =       0.704439897247
             le_variance =       0.496235568833

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.496234733254
                                         uncertainty =       0.001357229703

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.496234733254
                                         uncertainty =       0.001357229703

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000249057114
  error estimate for blocks of size 2^( 2) =       0.000258049579
  error estimate for blocks of size 2^( 3) =       0.000266185183
  error estimate for blocks of size 2^( 4) =       0.000271991796
  error estimate for blocks of size 2^( 5) =       0.000275345753
  error estimate for blocks of size 2^( 6) =       0.000277085667
  error estimate for blocks of size 2^( 7) =       0.000278503461
  error estimate for blocks of size 2^( 8) =       0.000280495953
  error estimate for blocks of size 2^( 9) =       0.000279761625

      target function =                  N/A
              le_mean =     -22.669883735791
             les_mean =     514.433223403370
             stat err =       0.000278961676
             autocorr =       1.254559277591
              std dev =       0.704439896558
             le_variance =       0.496235567863

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.496234733739
                                         uncertainty =       0.001357229640

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.496234733739
                                         uncertainty =       0.001357229640

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000249057114
  error estimate for blocks of size 2^( 2) =       0.000258049579
  error estimate for blocks of size 2^( 3) =       0.000266185183
  error estimate for blocks of size 2^( 4) =       0.000271991796
  error estimate for blocks of size 2^( 5) =       0.000275345753
  error estimate for blocks of size 2^( 6) =       0.000277085667
  error estimate for blocks of size 2^( 7) =       0.000278503461
  error estimate for blocks of size 2^( 8) =       0.000280495953
  error estimate for blocks of size 2^( 9) =       0.000279761625

      target function =                  N/A
              le_mean =     -22.669883735780
             les_mean =     514.433223401568
             stat err =       0.000278961677
             autocorr =       1.254559277526
              std dev =       0.704439896902
             le_variance =       0.496235568348

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.496234734163
                                         uncertainty =       0.001357229586

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.496234734163
                                         uncertainty =       0.001357229586

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000249057114
  error estimate for blocks of size 2^( 2) =       0.000258049579
  error estimate for blocks of size 2^( 3) =       0.000266185183
  error estimate for blocks of size 2^( 4) =       0.000271991796
  error estimate for blocks of size 2^( 5) =       0.000275345753
  error estimate for blocks of size 2^( 6) =       0.000277085667
  error estimate for blocks of size 2^( 7) =       0.000278503461
  error estimate for blocks of size 2^( 8) =       0.000280495953
  error estimate for blocks of size 2^( 9) =       0.000279761625

      target function =                  N/A
              le_mean =     -22.669883735770
             les_mean =     514.433223399993
             stat err =       0.000278961677
             autocorr =       1.254559277421
              std dev =       0.704439897204
             le_variance =       0.496235568773


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.669883735768        initial
     1.4552e+04     1.4552e+05             1.8151e-08       -22.669883735791  <--
     5.8208e+04     5.8208e+05             4.5379e-09       -22.669883735780
     2.3283e+05     2.3283e+06             1.1345e-09       -22.669883735770

*****************************************************************************
Applying the update for shift_i =   1.4552e+04     and shift_s =   1.4552e+05
*****************************************************************************

  Execution time = 1.7594e+02
  </log>
  <optVariables href="FORM.s043.opt.xml">
ci_001                -7.050617e-01 3 1  ON 0
ci_002                -7.059926e-01 3 1  ON 1
ci_003                -3.765130e-02 3 1  ON 2
ci_004                -3.890329e-02 3 1  ON 3
ci_005                 1.612444e-02 3 1  ON 4
ci_006                 1.600093e-02 3 1  ON 5
ci_007                 1.228711e-02 3 1  ON 6
ci_008                 1.246535e-02 3 1  ON 7
ci_009                -1.173865e-02 3 1  ON 8
ci_010                -1.182878e-02 3 1  ON 9
ci_011                -8.176436e-03 3 1  ON 10
ci_012                -8.138294e-03 3 1  ON 11
ci_013                 9.647133e-03 3 1  ON 12
ci_014                 9.360588e-03 3 1  ON 13
ci_015                 1.228715e-02 3 1  ON 14
ci_016                 1.255398e-02 3 1  ON 15
ci_017                 1.088298e-02 3 1  ON 16
ci_018                 1.078148e-02 3 1  ON 17
ci_019                -2.514328e-03 3 1  ON 18
ci_020                -2.423814e-03 3 1  ON 19
ci_021                -8.459751e-03 3 1  ON 20
ci_022                -8.657053e-03 3 1  ON 21
ci_023                 7.805049e-03 3 1  ON 22
ci_024                 8.041861e-03 3 1  ON 23
ci_025                 4.702667e-03 3 1  ON 24
ci_026                 4.273191e-03 3 1  ON 25
ci_027                 6.454124e-03 3 1  ON 26
ci_028                 6.476409e-03 3 1  ON 27
ci_029                -4.877827e-03 3 1  ON 28
ci_030                -4.785599e-03 3 1  ON 29
ci_031                -7.388648e-03 3 1  ON 30
ci_032                -8.123207e-03 3 1  ON 31
ci_033                 4.600657e-03 3 1  ON 32
ci_034                 4.413478e-03 3 1  ON 33
ci_035                 1.126853e-03 3 1  ON 34
ci_036                 1.043113e-03 3 1  ON 35
ci_037                 4.953340e-03 3 1  ON 36
ci_038                 5.099289e-03 3 1  ON 37
ci_039                 5.306381e-03 3 1  ON 38
ci_040                 5.323076e-03 3 1  ON 39
ci_041                 4.970460e-03 3 1  ON 40
ci_042                 5.231296e-03 3 1  ON 41
ci_043                 4.943059e-03 3 1  ON 42
ci_044                 4.944213e-03 3 1  ON 43
ci_045                 3.123965e-03 3 1  ON 44
ci_046                 3.174271e-03 3 1  ON 45
ci_047                -7.790555e-04 3 1  ON 46
ci_048                -5.616720e-04 3 1  ON 47
ci_049                 1.580262e-03 3 1  ON 48
ci_050                 1.792534e-03 3 1  ON 49
ci_051                -1.106633e-03 3 1  ON 50
ci_052                -1.243228e-03 3 1  ON 51
ci_053                -2.610449e-03 3 1  ON 52
ci_054                -2.301932e-03 3 1  ON 53
ci_055                -1.483458e-03 3 1  ON 54
ci_056                -1.376704e-03 3 1  ON 55
ci_057                -1.240683e-03 3 1  ON 56
ci_058                -1.731115e-03 3 1  ON 57
ci_059                 3.171955e-04 3 1  ON 58
ci_060                 1.414526e-04 3 1  ON 59
ci_061                -3.305236e-04 3 1  ON 60
ci_062                -9.499901e-06 3 1  ON 61
ci_063                -5.232267e-04 3 1  ON 62
ci_064                -8.918649e-04 3 1  ON 63
ci_065                -2.408123e-03 3 1  ON 64
ci_066                -2.435273e-03 3 1  ON 65
ci_067                -2.101050e-03 3 1  ON 66
ci_068                -2.473555e-03 3 1  ON 67
ci_069                -2.086339e-04 3 1  ON 68
ci_070                 1.328771e-04 3 1  ON 69
ci_071                -1.874165e-03 3 1  ON 70
ci_072                -1.959401e-03 3 1  ON 71
ci_073                 5.749870e-04 3 1  ON 72
ci_074                 2.857394e-04 3 1  ON 73
ci_075                -2.910966e-04 3 1  ON 74
ci_076                -2.991421e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 2.9668e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s044 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s044 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=44  my_counter=0
  time step      = 5.0000e-02
  blocks         = 250
  steps          = 250
  substeps       = 10
  current        = 0
  target samples = 8.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">250</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">6.2500e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">8.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">6.2500e+04</parameter>
<parameter name="steps" condition="int">250</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2661e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="250">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =8000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 44
    time step          = 0.05
    reference energy   = -22.6878
    reference variance = 0.306253
====================================================
  Execution time = 1.0163e+02
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s044
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 62500 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 6.1144e+04
  VMC Eavg = -2.2670e+01
  VMC Evar = 5.0988e-01
  Total weights = 7.820081917e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.9089e+01
  </log>
</opt>
<opt stage="main" walkers="62500">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.495498788289
                                         uncertainty =       0.001476667712

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.495498788289
                                         uncertainty =       0.001476667712

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000248871752
  error estimate for blocks of size 2^( 2) =       0.000257818633
  error estimate for blocks of size 2^( 3) =       0.000265888205
  error estimate for blocks of size 2^( 4) =       0.000271458082
  error estimate for blocks of size 2^( 5) =       0.000275033418
  error estimate for blocks of size 2^( 6) =       0.000276564477
  error estimate for blocks of size 2^( 7) =       0.000277939611
  error estimate for blocks of size 2^( 8) =       0.000279420353
  error estimate for blocks of size 2^( 9) =       0.000278352366

      target function =                  N/A
              le_mean =     -22.669971433326
             les_mean =     514.437489434450
             stat err =       0.000278069202
             autocorr =       1.248402329623
              std dev =       0.703915613307
             le_variance =       0.495497190657


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266997143333e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.6380e+03, overlap shift 3.6380e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.669971433349       residual = 5.25e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.669971433684       residual = 4.89e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.669971433717       residual = 1.60e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.669971433716       residual = 7.70e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 3.6380e+03 is 6.197259e-08

solving harmonic davidson linear method for identity shift 1.4552e+04, overlap shift 1.4552e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.669971433349       residual = 5.25e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.669971433433       residual = 4.89e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.669971433441       residual = 1.60e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.669971433441       residual = 7.70e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 1.4552e+04 is 1.549329e-08

solving harmonic davidson linear method for identity shift 5.8208e+04, overlap shift 5.8208e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.669971433349       residual = 5.25e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.669971433370       residual = 4.89e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.669971433372       residual = 1.60e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.669971433372       residual = 7.70e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 5.8208e+04 is 3.873332e-09

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.089655 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.2074e+02
  </log>
  <optVariables href="FORM.s044.opt.xml">
ci_001                -7.050617e-01 3 1  ON 0
ci_002                -7.059926e-01 3 1  ON 1
ci_003                -3.765131e-02 3 1  ON 2
ci_004                -3.890329e-02 3 1  ON 3
ci_005                 1.612444e-02 3 1  ON 4
ci_006                 1.600093e-02 3 1  ON 5
ci_007                 1.228712e-02 3 1  ON 6
ci_008                 1.246535e-02 3 1  ON 7
ci_009                -1.173866e-02 3 1  ON 8
ci_010                -1.182878e-02 3 1  ON 9
ci_011                -8.176427e-03 3 1  ON 10
ci_012                -8.138292e-03 3 1  ON 11
ci_013                 9.647135e-03 3 1  ON 12
ci_014                 9.360591e-03 3 1  ON 13
ci_015                 1.228715e-02 3 1  ON 14
ci_016                 1.255399e-02 3 1  ON 15
ci_017                 1.088299e-02 3 1  ON 16
ci_018                 1.078148e-02 3 1  ON 17
ci_019                -2.514325e-03 3 1  ON 18
ci_020                -2.423804e-03 3 1  ON 19
ci_021                -8.459762e-03 3 1  ON 20
ci_022                -8.657050e-03 3 1  ON 21
ci_023                 7.805050e-03 3 1  ON 22
ci_024                 8.041865e-03 3 1  ON 23
ci_025                 4.702666e-03 3 1  ON 24
ci_026                 4.273189e-03 3 1  ON 25
ci_027                 6.454123e-03 3 1  ON 26
ci_028                 6.476415e-03 3 1  ON 27
ci_029                -4.877826e-03 3 1  ON 28
ci_030                -4.785596e-03 3 1  ON 29
ci_031                -7.388653e-03 3 1  ON 30
ci_032                -8.123204e-03 3 1  ON 31
ci_033                 4.600648e-03 3 1  ON 32
ci_034                 4.413492e-03 3 1  ON 33
ci_035                 1.126860e-03 3 1  ON 34
ci_036                 1.043116e-03 3 1  ON 35
ci_037                 4.953337e-03 3 1  ON 36
ci_038                 5.099288e-03 3 1  ON 37
ci_039                 5.306384e-03 3 1  ON 38
ci_040                 5.323079e-03 3 1  ON 39
ci_041                 4.970472e-03 3 1  ON 40
ci_042                 5.231291e-03 3 1  ON 41
ci_043                 4.943059e-03 3 1  ON 42
ci_044                 4.944211e-03 3 1  ON 43
ci_045                 3.123969e-03 3 1  ON 44
ci_046                 3.174264e-03 3 1  ON 45
ci_047                -7.790540e-04 3 1  ON 46
ci_048                -5.616712e-04 3 1  ON 47
ci_049                 1.580262e-03 3 1  ON 48
ci_050                 1.792532e-03 3 1  ON 49
ci_051                -1.106634e-03 3 1  ON 50
ci_052                -1.243238e-03 3 1  ON 51
ci_053                -2.610452e-03 3 1  ON 52
ci_054                -2.301940e-03 3 1  ON 53
ci_055                -1.483455e-03 3 1  ON 54
ci_056                -1.376711e-03 3 1  ON 55
ci_057                -1.240687e-03 3 1  ON 56
ci_058                -1.731108e-03 3 1  ON 57
ci_059                 3.171863e-04 3 1  ON 58
ci_060                 1.414598e-04 3 1  ON 59
ci_061                -3.305215e-04 3 1  ON 60
ci_062                -9.496848e-06 3 1  ON 61
ci_063                -5.232410e-04 3 1  ON 62
ci_064                -8.918677e-04 3 1  ON 63
ci_065                -2.408129e-03 3 1  ON 64
ci_066                -2.435274e-03 3 1  ON 65
ci_067                -2.101050e-03 3 1  ON 66
ci_068                -2.473558e-03 3 1  ON 67
ci_069                -2.086311e-04 3 1  ON 68
ci_070                 1.328778e-04 3 1  ON 69
ci_071                -1.874170e-03 3 1  ON 70
ci_072                -1.959406e-03 3 1  ON 71
ci_073                 5.749811e-04 3 1  ON 72
ci_074                 2.857411e-04 3 1  ON 73
ci_075                -2.910850e-04 3 1  ON 74
ci_076                -2.991340e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="250">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =8000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 44
    time step          = 0.05
    reference energy   = -22.7241
    reference variance = 0.537973
====================================================
  Execution time = 1.0178e+02
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s044
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 62500 
  VMC Eavg = -2.2669e+01
  VMC Evar = 5.0589e-01
  Total weights = 7.8205e+06
  Execution time = 1.4614e+01
  </log>
</opt>
<opt stage="main" walkers="62500">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.493885537447
                                         uncertainty =       0.001228489934

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.493885537447
                                         uncertainty =       0.001228489934

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000248466377
  error estimate for blocks of size 2^( 2) =       0.000257474274
  error estimate for blocks of size 2^( 3) =       0.000265294195
  error estimate for blocks of size 2^( 4) =       0.000270973929
  error estimate for blocks of size 2^( 5) =       0.000274111947
  error estimate for blocks of size 2^( 6) =       0.000275927454
  error estimate for blocks of size 2^( 7) =       0.000276945150
  error estimate for blocks of size 2^( 8) =       0.000277779440
  error estimate for blocks of size 2^( 9) =       0.000277847237

      target function =                  N/A
              le_mean =     -22.669464395822
             les_mean =     514.410505285862
             stat err =       0.000277124820
             autocorr =       1.243986295937
              std dev =       0.702769038995
             le_variance =       0.493884322170

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.493885539156
                                         uncertainty =       0.001228490299

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.493885539156
                                         uncertainty =       0.001228490299

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000248466377
  error estimate for blocks of size 2^( 2) =       0.000257474275
  error estimate for blocks of size 2^( 3) =       0.000265294195
  error estimate for blocks of size 2^( 4) =       0.000270973929
  error estimate for blocks of size 2^( 5) =       0.000274111948
  error estimate for blocks of size 2^( 6) =       0.000275927455
  error estimate for blocks of size 2^( 7) =       0.000276945150
  error estimate for blocks of size 2^( 8) =       0.000277779440
  error estimate for blocks of size 2^( 9) =       0.000277847238

      target function =                  N/A
              le_mean =     -22.669464395862
             les_mean =     514.410505170540
             stat err =       0.000277124821
             autocorr =       1.243986295218
              std dev =       0.702769040209
             le_variance =       0.493884323877

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.493885538302
                                         uncertainty =       0.001228490117

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.493885538302
                                         uncertainty =       0.001228490117

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000248466377
  error estimate for blocks of size 2^( 2) =       0.000257474275
  error estimate for blocks of size 2^( 3) =       0.000265294195
  error estimate for blocks of size 2^( 4) =       0.000270973929
  error estimate for blocks of size 2^( 5) =       0.000274111947
  error estimate for blocks of size 2^( 6) =       0.000275927454
  error estimate for blocks of size 2^( 7) =       0.000276945150
  error estimate for blocks of size 2^( 8) =       0.000277779440
  error estimate for blocks of size 2^( 9) =       0.000277847238

      target function =                  N/A
              le_mean =     -22.669464395842
             les_mean =     514.410505226892
             stat err =       0.000277124821
             autocorr =       1.243986295566
              std dev =       0.702769039602
             le_variance =       0.493884323023

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.493885537554
                                         uncertainty =       0.001228489957

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.493885537554
                                         uncertainty =       0.001228489957

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000248466377
  error estimate for blocks of size 2^( 2) =       0.000257474274
  error estimate for blocks of size 2^( 3) =       0.000265294195
  error estimate for blocks of size 2^( 4) =       0.000270973929
  error estimate for blocks of size 2^( 5) =       0.000274111947
  error estimate for blocks of size 2^( 6) =       0.000275927454
  error estimate for blocks of size 2^( 7) =       0.000276945150
  error estimate for blocks of size 2^( 8) =       0.000277779440
  error estimate for blocks of size 2^( 9) =       0.000277847237

      target function =                  N/A
              le_mean =     -22.669464395824
             les_mean =     514.410505278344
             stat err =       0.000277124820
             autocorr =       1.243986295894
              std dev =       0.702769039071
             le_variance =       0.493884322276


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.669464395822        initial
     3.6380e+03     3.6380e+04             6.1973e-08       -22.669464395862  <--
     1.4552e+04     1.4552e+05             1.5493e-08       -22.669464395842
     5.8208e+04     5.8208e+05             3.8733e-09       -22.669464395824

*****************************************************************************
Applying the update for shift_i =   3.6380e+03     and shift_s =   3.6380e+04
*****************************************************************************

  Execution time = 1.7489e+02
  </log>
  <optVariables href="FORM.s044.opt.xml">
ci_001                -7.050617e-01 3 1  ON 0
ci_002                -7.059926e-01 3 1  ON 1
ci_003                -3.765136e-02 3 1  ON 2
ci_004                -3.890329e-02 3 1  ON 3
ci_005                 1.612443e-02 3 1  ON 4
ci_006                 1.600091e-02 3 1  ON 5
ci_007                 1.228713e-02 3 1  ON 6
ci_008                 1.246534e-02 3 1  ON 7
ci_009                -1.173869e-02 3 1  ON 8
ci_010                -1.182876e-02 3 1  ON 9
ci_011                -8.176402e-03 3 1  ON 10
ci_012                -8.138288e-03 3 1  ON 11
ci_013                 9.647143e-03 3 1  ON 12
ci_014                 9.360597e-03 3 1  ON 13
ci_015                 1.228716e-02 3 1  ON 14
ci_016                 1.255401e-02 3 1  ON 15
ci_017                 1.088302e-02 3 1  ON 16
ci_018                 1.078147e-02 3 1  ON 17
ci_019                -2.514317e-03 3 1  ON 18
ci_020                -2.423777e-03 3 1  ON 19
ci_021                -8.459798e-03 3 1  ON 20
ci_022                -8.657040e-03 3 1  ON 21
ci_023                 7.805053e-03 3 1  ON 22
ci_024                 8.041877e-03 3 1  ON 23
ci_025                 4.702662e-03 3 1  ON 24
ci_026                 4.273186e-03 3 1  ON 25
ci_027                 6.454118e-03 3 1  ON 26
ci_028                 6.476433e-03 3 1  ON 27
ci_029                -4.877823e-03 3 1  ON 28
ci_030                -4.785589e-03 3 1  ON 29
ci_031                -7.388668e-03 3 1  ON 30
ci_032                -8.123196e-03 3 1  ON 31
ci_033                 4.600622e-03 3 1  ON 32
ci_034                 4.413536e-03 3 1  ON 33
ci_035                 1.126881e-03 3 1  ON 34
ci_036                 1.043126e-03 3 1  ON 35
ci_037                 4.953327e-03 3 1  ON 36
ci_038                 5.099286e-03 3 1  ON 37
ci_039                 5.306395e-03 3 1  ON 38
ci_040                 5.323088e-03 3 1  ON 39
ci_041                 4.970507e-03 3 1  ON 40
ci_042                 5.231273e-03 3 1  ON 41
ci_043                 4.943061e-03 3 1  ON 42
ci_044                 4.944204e-03 3 1  ON 43
ci_045                 3.123982e-03 3 1  ON 44
ci_046                 3.174244e-03 3 1  ON 45
ci_047                -7.790495e-04 3 1  ON 46
ci_048                -5.616688e-04 3 1  ON 47
ci_049                 1.580260e-03 3 1  ON 48
ci_050                 1.792529e-03 3 1  ON 49
ci_051                -1.106636e-03 3 1  ON 50
ci_052                -1.243267e-03 3 1  ON 51
ci_053                -2.610462e-03 3 1  ON 52
ci_054                -2.301965e-03 3 1  ON 53
ci_055                -1.483445e-03 3 1  ON 54
ci_056                -1.376731e-03 3 1  ON 55
ci_057                -1.240699e-03 3 1  ON 56
ci_058                -1.731088e-03 3 1  ON 57
ci_059                 3.171587e-04 3 1  ON 58
ci_060                 1.414813e-04 3 1  ON 59
ci_061                -3.305153e-04 3 1  ON 60
ci_062                -9.487690e-06 3 1  ON 61
ci_063                -5.232840e-04 3 1  ON 62
ci_064                -8.918762e-04 3 1  ON 63
ci_065                -2.408147e-03 3 1  ON 64
ci_066                -2.435276e-03 3 1  ON 65
ci_067                -2.101051e-03 3 1  ON 66
ci_068                -2.473565e-03 3 1  ON 67
ci_069                -2.086227e-04 3 1  ON 68
ci_070                 1.328797e-04 3 1  ON 69
ci_071                -1.874185e-03 3 1  ON 70
ci_072                -1.959418e-03 3 1  ON 71
ci_073                 5.749633e-04 3 1  ON 72
ci_074                 2.857462e-04 3 1  ON 73
ci_075                -2.910501e-04 3 1  ON 74
ci_076                -2.991096e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 2.9564e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s045 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s045 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=45  my_counter=0
  time step      = 5.0000e-02
  blocks         = 250
  steps          = 250
  substeps       = 10
  current        = 0
  target samples = 8.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">250</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">6.2500e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">8.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">6.2500e+04</parameter>
<parameter name="steps" condition="int">250</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2662e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="250">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =8000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 45
    time step          = 0.05
    reference energy   = -22.6803
    reference variance = 0.492755
====================================================
  Execution time = 1.0040e+02
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s045
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 62500 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 6.1076e+04
  VMC Eavg = -2.2670e+01
  VMC Evar = 5.1447e-01
  Total weights = 7.820385435e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.9046e+01
  </log>
</opt>
<opt stage="main" walkers="62500">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.498690958274
                                         uncertainty =       0.002535589666

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.498690958274
                                         uncertainty =       0.002535589666

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000249672948
  error estimate for blocks of size 2^( 2) =       0.000258577729
  error estimate for blocks of size 2^( 3) =       0.000266465874
  error estimate for blocks of size 2^( 4) =       0.000272327580
  error estimate for blocks of size 2^( 5) =       0.000275800767
  error estimate for blocks of size 2^( 6) =       0.000277039356
  error estimate for blocks of size 2^( 7) =       0.000277751553
  error estimate for blocks of size 2^( 8) =       0.000278856014
  error estimate for blocks of size 2^( 9) =       0.000279597634

      target function =                  N/A
              le_mean =     -22.669637154142
             les_mean =     514.426918025892
             stat err =       0.000278311139
             autocorr =       1.242562376736
              std dev =       0.706181738171
             le_variance =       0.498692647326


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266963715414e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.0949e+02, overlap shift 9.0949e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.669637154164       residual = 4.09e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.669637154347       residual = 6.47e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.669637154316       residual = 2.60e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.669637154340       residual = 8.26e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 9.0949e+02 is 2.371514e-07

solving harmonic davidson linear method for identity shift 3.6380e+03, overlap shift 3.6380e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.669637154164       residual = 4.09e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.669637154210       residual = 6.48e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.669637154202       residual = 2.60e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.669637154208       residual = 8.27e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 3.6380e+03 is 5.929543e-08

solving harmonic davidson linear method for identity shift 1.4552e+04, overlap shift 1.4552e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.669637154164       residual = 4.09e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.669637154176       residual = 6.48e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.669637154174       residual = 2.60e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.669637154170       residual = 8.27e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 1.4552e+04 is 1.482433e-08

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.094120 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.1947e+02
  </log>
  <optVariables href="FORM.s045.opt.xml">
ci_001                -7.050617e-01 3 1  ON 0
ci_002                -7.059926e-01 3 1  ON 1
ci_003                -3.765137e-02 3 1  ON 2
ci_004                -3.890325e-02 3 1  ON 3
ci_005                 1.612441e-02 3 1  ON 4
ci_006                 1.600092e-02 3 1  ON 5
ci_007                 1.228713e-02 3 1  ON 6
ci_008                 1.246533e-02 3 1  ON 7
ci_009                -1.173869e-02 3 1  ON 8
ci_010                -1.182878e-02 3 1  ON 9
ci_011                -8.176393e-03 3 1  ON 10
ci_012                -8.138300e-03 3 1  ON 11
ci_013                 9.647129e-03 3 1  ON 12
ci_014                 9.360573e-03 3 1  ON 13
ci_015                 1.228716e-02 3 1  ON 14
ci_016                 1.255400e-02 3 1  ON 15
ci_017                 1.088301e-02 3 1  ON 16
ci_018                 1.078146e-02 3 1  ON 17
ci_019                -2.514332e-03 3 1  ON 18
ci_020                -2.423798e-03 3 1  ON 19
ci_021                -8.459803e-03 3 1  ON 20
ci_022                -8.657019e-03 3 1  ON 21
ci_023                 7.805104e-03 3 1  ON 22
ci_024                 8.041884e-03 3 1  ON 23
ci_025                 4.702638e-03 3 1  ON 24
ci_026                 4.273196e-03 3 1  ON 25
ci_027                 6.454105e-03 3 1  ON 26
ci_028                 6.476425e-03 3 1  ON 27
ci_029                -4.877822e-03 3 1  ON 28
ci_030                -4.785609e-03 3 1  ON 29
ci_031                -7.388712e-03 3 1  ON 30
ci_032                -8.123183e-03 3 1  ON 31
ci_033                 4.600642e-03 3 1  ON 32
ci_034                 4.413533e-03 3 1  ON 33
ci_035                 1.126888e-03 3 1  ON 34
ci_036                 1.043146e-03 3 1  ON 35
ci_037                 4.953309e-03 3 1  ON 36
ci_038                 5.099285e-03 3 1  ON 37
ci_039                 5.306413e-03 3 1  ON 38
ci_040                 5.323103e-03 3 1  ON 39
ci_041                 4.970478e-03 3 1  ON 40
ci_042                 5.231282e-03 3 1  ON 41
ci_043                 4.943082e-03 3 1  ON 42
ci_044                 4.944189e-03 3 1  ON 43
ci_045                 3.123983e-03 3 1  ON 44
ci_046                 3.174260e-03 3 1  ON 45
ci_047                -7.790456e-04 3 1  ON 46
ci_048                -5.616896e-04 3 1  ON 47
ci_049                 1.580260e-03 3 1  ON 48
ci_050                 1.792535e-03 3 1  ON 49
ci_051                -1.106676e-03 3 1  ON 50
ci_052                -1.243227e-03 3 1  ON 51
ci_053                -2.610521e-03 3 1  ON 52
ci_054                -2.301977e-03 3 1  ON 53
ci_055                -1.483465e-03 3 1  ON 54
ci_056                -1.376735e-03 3 1  ON 55
ci_057                -1.240746e-03 3 1  ON 56
ci_058                -1.731086e-03 3 1  ON 57
ci_059                 3.171285e-04 3 1  ON 58
ci_060                 1.414276e-04 3 1  ON 59
ci_061                -3.305149e-04 3 1  ON 60
ci_062                -9.484624e-06 3 1  ON 61
ci_063                -5.233008e-04 3 1  ON 62
ci_064                -8.918344e-04 3 1  ON 63
ci_065                -2.408139e-03 3 1  ON 64
ci_066                -2.435268e-03 3 1  ON 65
ci_067                -2.101084e-03 3 1  ON 66
ci_068                -2.473544e-03 3 1  ON 67
ci_069                -2.086371e-04 3 1  ON 68
ci_070                 1.328657e-04 3 1  ON 69
ci_071                -1.874228e-03 3 1  ON 70
ci_072                -1.959431e-03 3 1  ON 71
ci_073                 5.749329e-04 3 1  ON 72
ci_074                 2.857559e-04 3 1  ON 73
ci_075                -2.910480e-04 3 1  ON 74
ci_076                -2.991180e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="250">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =8000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 45
    time step          = 0.05
    reference energy   = -22.6636
    reference variance = 0.634771
====================================================
  Execution time = 1.0165e+02
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s045
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 62500 
  VMC Eavg = -2.2670e+01
  VMC Evar = 5.0805e-01
  Total weights = 7.8212e+06
  Execution time = 1.4649e+01
  </log>
</opt>
<opt stage="main" walkers="62500">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.494715631842
                                         uncertainty =       0.001533562965

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.494715631842
                                         uncertainty =       0.001533562965

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000248674909
  error estimate for blocks of size 2^( 2) =       0.000257652804
  error estimate for blocks of size 2^( 3) =       0.000265744319
  error estimate for blocks of size 2^( 4) =       0.000271283540
  error estimate for blocks of size 2^( 5) =       0.000274378786
  error estimate for blocks of size 2^( 6) =       0.000276018366
  error estimate for blocks of size 2^( 7) =       0.000277241542
  error estimate for blocks of size 2^( 8) =       0.000276986116
  error estimate for blocks of size 2^( 9) =       0.000277849829

      target function =                  N/A
              le_mean =     -22.670019715831
             les_mean =     514.437848129932
             stat err =       0.000277023963
             autocorr =       1.240997022771
              std dev =       0.703358858910
             le_variance =       0.494713684408

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.494715625060
                                         uncertainty =       0.001533561900

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.494715625060
                                         uncertainty =       0.001533561900

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000248674908
  error estimate for blocks of size 2^( 2) =       0.000257652802
  error estimate for blocks of size 2^( 3) =       0.000265744316
  error estimate for blocks of size 2^( 4) =       0.000271283536
  error estimate for blocks of size 2^( 5) =       0.000274378782
  error estimate for blocks of size 2^( 6) =       0.000276018362
  error estimate for blocks of size 2^( 7) =       0.000277241536
  error estimate for blocks of size 2^( 8) =       0.000276986108
  error estimate for blocks of size 2^( 9) =       0.000277849819

      target function =                  N/A
              le_mean =     -22.670019713280
             les_mean =     514.437851148297
             stat err =       0.000277023956
             autocorr =       1.240996978540
              std dev =       0.703358854078
             le_variance =       0.494713677610

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.494715628449
                                         uncertainty =       0.001533562433

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.494715628449
                                         uncertainty =       0.001533562433

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000248674909
  error estimate for blocks of size 2^( 2) =       0.000257652803
  error estimate for blocks of size 2^( 3) =       0.000265744318
  error estimate for blocks of size 2^( 4) =       0.000271283538
  error estimate for blocks of size 2^( 5) =       0.000274378784
  error estimate for blocks of size 2^( 6) =       0.000276018364
  error estimate for blocks of size 2^( 7) =       0.000277241539
  error estimate for blocks of size 2^( 8) =       0.000276986112
  error estimate for blocks of size 2^( 9) =       0.000277849824

      target function =                  N/A
              le_mean =     -22.670019714558
             les_mean =     514.437848793026
             stat err =       0.000277023960
             autocorr =       1.240997000706
              std dev =       0.703358856493
             le_variance =       0.494713681007

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.494715631418
                                         uncertainty =       0.001533562899

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.494715631418
                                         uncertainty =       0.001533562899

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000248674909
  error estimate for blocks of size 2^( 2) =       0.000257652804
  error estimate for blocks of size 2^( 3) =       0.000265744319
  error estimate for blocks of size 2^( 4) =       0.000271283540
  error estimate for blocks of size 2^( 5) =       0.000274378786
  error estimate for blocks of size 2^( 6) =       0.000276018366
  error estimate for blocks of size 2^( 7) =       0.000277241541
  error estimate for blocks of size 2^( 8) =       0.000276986115
  error estimate for blocks of size 2^( 9) =       0.000277849828

      target function =                  N/A
              le_mean =     -22.670019715672
             les_mean =     514.437848175480
             stat err =       0.000277023963
             autocorr =       1.240997020037
              std dev =       0.703358858608
             le_variance =       0.494713683982


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.670019715831        initial  <--
     9.0949e+02     9.0949e+03             2.3715e-07       -22.670019713280
     3.6380e+03     3.6380e+04             5.9295e-08       -22.670019714558
     1.4552e+04     1.4552e+05             1.4824e-08       -22.670019715672

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 174.9047
  </log>
  <optVariables href="FORM.s045.opt.xml">
ci_001                -7.050617e-01 3 1  ON 0
ci_002                -7.059926e-01 3 1  ON 1
ci_003                -3.765136e-02 3 1  ON 2
ci_004                -3.890329e-02 3 1  ON 3
ci_005                 1.612443e-02 3 1  ON 4
ci_006                 1.600091e-02 3 1  ON 5
ci_007                 1.228713e-02 3 1  ON 6
ci_008                 1.246534e-02 3 1  ON 7
ci_009                -1.173869e-02 3 1  ON 8
ci_010                -1.182876e-02 3 1  ON 9
ci_011                -8.176402e-03 3 1  ON 10
ci_012                -8.138288e-03 3 1  ON 11
ci_013                 9.647143e-03 3 1  ON 12
ci_014                 9.360597e-03 3 1  ON 13
ci_015                 1.228716e-02 3 1  ON 14
ci_016                 1.255401e-02 3 1  ON 15
ci_017                 1.088302e-02 3 1  ON 16
ci_018                 1.078147e-02 3 1  ON 17
ci_019                -2.514317e-03 3 1  ON 18
ci_020                -2.423777e-03 3 1  ON 19
ci_021                -8.459798e-03 3 1  ON 20
ci_022                -8.657040e-03 3 1  ON 21
ci_023                 7.805053e-03 3 1  ON 22
ci_024                 8.041877e-03 3 1  ON 23
ci_025                 4.702662e-03 3 1  ON 24
ci_026                 4.273186e-03 3 1  ON 25
ci_027                 6.454118e-03 3 1  ON 26
ci_028                 6.476433e-03 3 1  ON 27
ci_029                -4.877823e-03 3 1  ON 28
ci_030                -4.785589e-03 3 1  ON 29
ci_031                -7.388668e-03 3 1  ON 30
ci_032                -8.123196e-03 3 1  ON 31
ci_033                 4.600622e-03 3 1  ON 32
ci_034                 4.413536e-03 3 1  ON 33
ci_035                 1.126881e-03 3 1  ON 34
ci_036                 1.043126e-03 3 1  ON 35
ci_037                 4.953327e-03 3 1  ON 36
ci_038                 5.099286e-03 3 1  ON 37
ci_039                 5.306395e-03 3 1  ON 38
ci_040                 5.323088e-03 3 1  ON 39
ci_041                 4.970507e-03 3 1  ON 40
ci_042                 5.231273e-03 3 1  ON 41
ci_043                 4.943061e-03 3 1  ON 42
ci_044                 4.944204e-03 3 1  ON 43
ci_045                 3.123982e-03 3 1  ON 44
ci_046                 3.174244e-03 3 1  ON 45
ci_047                -7.790495e-04 3 1  ON 46
ci_048                -5.616688e-04 3 1  ON 47
ci_049                 1.580260e-03 3 1  ON 48
ci_050                 1.792529e-03 3 1  ON 49
ci_051                -1.106636e-03 3 1  ON 50
ci_052                -1.243267e-03 3 1  ON 51
ci_053                -2.610462e-03 3 1  ON 52
ci_054                -2.301965e-03 3 1  ON 53
ci_055                -1.483445e-03 3 1  ON 54
ci_056                -1.376731e-03 3 1  ON 55
ci_057                -1.240699e-03 3 1  ON 56
ci_058                -1.731088e-03 3 1  ON 57
ci_059                 3.171587e-04 3 1  ON 58
ci_060                 1.414813e-04 3 1  ON 59
ci_061                -3.305153e-04 3 1  ON 60
ci_062                -9.487690e-06 3 1  ON 61
ci_063                -5.232840e-04 3 1  ON 62
ci_064                -8.918762e-04 3 1  ON 63
ci_065                -2.408147e-03 3 1  ON 64
ci_066                -2.435276e-03 3 1  ON 65
ci_067                -2.101051e-03 3 1  ON 66
ci_068                -2.473565e-03 3 1  ON 67
ci_069                -2.086227e-04 3 1  ON 68
ci_070                 1.328797e-04 3 1  ON 69
ci_071                -1.874185e-03 3 1  ON 70
ci_072                -1.959418e-03 3 1  ON 71
ci_073                 5.749633e-04 3 1  ON 72
ci_074                 2.857462e-04 3 1  ON 73
ci_075                -2.910501e-04 3 1  ON 74
ci_076                -2.991096e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 2.9439e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s046 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s046 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=46  my_counter=0
  time step      = 5.0000e-02
  blocks         = 250
  steps          = 250
  substeps       = 10
  current        = 0
  target samples = 8.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">250</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">6.2500e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">8.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">6.2500e+04</parameter>
<parameter name="steps" condition="int">250</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2662e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="250">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =8000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 46
    time step          = 0.05
    reference energy   = -22.6097
    reference variance = 0.454882
====================================================
  Execution time = 1.0033e+02
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s046
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 62500 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 6.1065e+04
  VMC Eavg = -2.2670e+01
  VMC Evar = 5.1229e-01
  Total weights = 7.820582314e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.9057e+01
  </log>
</opt>
<opt stage="main" walkers="62500">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.499222299525
                                         uncertainty =       0.001708972370

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.499222299525
                                         uncertainty =       0.001708972370

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000249805486
  error estimate for blocks of size 2^( 2) =       0.000258668690
  error estimate for blocks of size 2^( 3) =       0.000266625305
  error estimate for blocks of size 2^( 4) =       0.000272442168
  error estimate for blocks of size 2^( 5) =       0.000276064660
  error estimate for blocks of size 2^( 6) =       0.000277606669
  error estimate for blocks of size 2^( 7) =       0.000279073928
  error estimate for blocks of size 2^( 8) =       0.000279801146
  error estimate for blocks of size 2^( 9) =       0.000280789385

      target function =                  N/A
              le_mean =     -22.669575924378
             les_mean =     514.421965519129
             stat err =       0.000279317782
             autocorr =       1.250239534384
              std dev =       0.706556611637
             le_variance =       0.499222245448


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266957592438e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.0949e+03, overlap shift 9.0949e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.669575924401       residual = 3.41e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.669575924515       residual = 4.03e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.669575924523       residual = 8.96e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 9.0949e+03 is 2.135015e-08

solving harmonic davidson linear method for identity shift 3.6380e+04, overlap shift 3.6380e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.669575924401       residual = 3.41e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.669575924430       residual = 4.03e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.669575924432       residual = 8.96e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 3.6380e+04 is 5.337602e-09

solving harmonic davidson linear method for identity shift 1.4552e+05, overlap shift 1.4552e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.669575924401       residual = 3.41e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.669575924408       residual = 4.03e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.669575924409       residual = 8.96e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 1.4552e+05 is 1.334405e-09

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.098094 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.1941e+02
  </log>
  <optVariables href="FORM.s046.opt.xml">
ci_001                -7.050617e-01 3 1  ON 0
ci_002                -7.059926e-01 3 1  ON 1
ci_003                -3.765136e-02 3 1  ON 2
ci_004                -3.890329e-02 3 1  ON 3
ci_005                 1.612443e-02 3 1  ON 4
ci_006                 1.600091e-02 3 1  ON 5
ci_007                 1.228713e-02 3 1  ON 6
ci_008                 1.246534e-02 3 1  ON 7
ci_009                -1.173869e-02 3 1  ON 8
ci_010                -1.182876e-02 3 1  ON 9
ci_011                -8.176402e-03 3 1  ON 10
ci_012                -8.138287e-03 3 1  ON 11
ci_013                 9.647137e-03 3 1  ON 12
ci_014                 9.360597e-03 3 1  ON 13
ci_015                 1.228716e-02 3 1  ON 14
ci_016                 1.255401e-02 3 1  ON 15
ci_017                 1.088301e-02 3 1  ON 16
ci_018                 1.078147e-02 3 1  ON 17
ci_019                -2.514317e-03 3 1  ON 18
ci_020                -2.423776e-03 3 1  ON 19
ci_021                -8.459795e-03 3 1  ON 20
ci_022                -8.657039e-03 3 1  ON 21
ci_023                 7.805053e-03 3 1  ON 22
ci_024                 8.041874e-03 3 1  ON 23
ci_025                 4.702660e-03 3 1  ON 24
ci_026                 4.273183e-03 3 1  ON 25
ci_027                 6.454117e-03 3 1  ON 26
ci_028                 6.476436e-03 3 1  ON 27
ci_029                -4.877825e-03 3 1  ON 28
ci_030                -4.785591e-03 3 1  ON 29
ci_031                -7.388668e-03 3 1  ON 30
ci_032                -8.123192e-03 3 1  ON 31
ci_033                 4.600620e-03 3 1  ON 32
ci_034                 4.413537e-03 3 1  ON 33
ci_035                 1.126883e-03 3 1  ON 34
ci_036                 1.043129e-03 3 1  ON 35
ci_037                 4.953331e-03 3 1  ON 36
ci_038                 5.099289e-03 3 1  ON 37
ci_039                 5.306395e-03 3 1  ON 38
ci_040                 5.323085e-03 3 1  ON 39
ci_041                 4.970508e-03 3 1  ON 40
ci_042                 5.231273e-03 3 1  ON 41
ci_043                 4.943061e-03 3 1  ON 42
ci_044                 4.944204e-03 3 1  ON 43
ci_045                 3.123981e-03 3 1  ON 44
ci_046                 3.174246e-03 3 1  ON 45
ci_047                -7.790498e-04 3 1  ON 46
ci_048                -5.616679e-04 3 1  ON 47
ci_049                 1.580262e-03 3 1  ON 48
ci_050                 1.792529e-03 3 1  ON 49
ci_051                -1.106637e-03 3 1  ON 50
ci_052                -1.243267e-03 3 1  ON 51
ci_053                -2.610463e-03 3 1  ON 52
ci_054                -2.301966e-03 3 1  ON 53
ci_055                -1.483442e-03 3 1  ON 54
ci_056                -1.376732e-03 3 1  ON 55
ci_057                -1.240699e-03 3 1  ON 56
ci_058                -1.731091e-03 3 1  ON 57
ci_059                 3.171602e-04 3 1  ON 58
ci_060                 1.414791e-04 3 1  ON 59
ci_061                -3.305164e-04 3 1  ON 60
ci_062                -9.488685e-06 3 1  ON 61
ci_063                -5.232851e-04 3 1  ON 62
ci_064                -8.918725e-04 3 1  ON 63
ci_065                -2.408146e-03 3 1  ON 64
ci_066                -2.435276e-03 3 1  ON 65
ci_067                -2.101050e-03 3 1  ON 66
ci_068                -2.473567e-03 3 1  ON 67
ci_069                -2.086224e-04 3 1  ON 68
ci_070                 1.328768e-04 3 1  ON 69
ci_071                -1.874188e-03 3 1  ON 70
ci_072                -1.959419e-03 3 1  ON 71
ci_073                 5.749597e-04 3 1  ON 72
ci_074                 2.857453e-04 3 1  ON 73
ci_075                -2.910516e-04 3 1  ON 74
ci_076                -2.991114e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="250">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =8000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 46
    time step          = 0.05
    reference energy   = -22.6349
    reference variance = 0.424824
====================================================
  Execution time = 1.0159e+02
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s046
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 62500 
  VMC Eavg = -2.2670e+01
  VMC Evar = 5.0612e-01
  Total weights = 7.8201e+06
  Execution time = 1.4629e+01
  </log>
</opt>
<opt stage="main" walkers="62500">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.493513442022
                                         uncertainty =       0.001285313234

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.493513442022
                                         uncertainty =       0.001285313234

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000248373427
  error estimate for blocks of size 2^( 2) =       0.000257344420
  error estimate for blocks of size 2^( 3) =       0.000265415467
  error estimate for blocks of size 2^( 4) =       0.000271056810
  error estimate for blocks of size 2^( 5) =       0.000274463112
  error estimate for blocks of size 2^( 6) =       0.000276116266
  error estimate for blocks of size 2^( 7) =       0.000277178065
  error estimate for blocks of size 2^( 8) =       0.000277326435
  error estimate for blocks of size 2^( 9) =       0.000278530592

      target function =                  N/A
              le_mean =     -22.669916706110
             les_mean =     514.431247242890
             stat err =       0.000277287840
             autocorr =       1.246382629215
              std dev =       0.702506139005
             le_variance =       0.493514875340

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.493513441408
                                         uncertainty =       0.001285313366

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.493513441408
                                         uncertainty =       0.001285313366

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000248373427
  error estimate for blocks of size 2^( 2) =       0.000257344420
  error estimate for blocks of size 2^( 3) =       0.000265415467
  error estimate for blocks of size 2^( 4) =       0.000271056810
  error estimate for blocks of size 2^( 5) =       0.000274463112
  error estimate for blocks of size 2^( 6) =       0.000276116266
  error estimate for blocks of size 2^( 7) =       0.000277178065
  error estimate for blocks of size 2^( 8) =       0.000277326435
  error estimate for blocks of size 2^( 9) =       0.000278530592

      target function =                  N/A
              le_mean =     -22.669916706118
             les_mean =     514.431247147777
             stat err =       0.000277287840
             autocorr =       1.246382630323
              std dev =       0.702506138569
             le_variance =       0.493514874727

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.493513441715
                                         uncertainty =       0.001285313300

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.493513441715
                                         uncertainty =       0.001285313300

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000248373427
  error estimate for blocks of size 2^( 2) =       0.000257344420
  error estimate for blocks of size 2^( 3) =       0.000265415467
  error estimate for blocks of size 2^( 4) =       0.000271056810
  error estimate for blocks of size 2^( 5) =       0.000274463112
  error estimate for blocks of size 2^( 6) =       0.000276116266
  error estimate for blocks of size 2^( 7) =       0.000277178065
  error estimate for blocks of size 2^( 8) =       0.000277326435
  error estimate for blocks of size 2^( 9) =       0.000278530592

      target function =                  N/A
              le_mean =     -22.669916706114
             les_mean =     514.431247195183
             stat err =       0.000277287840
             autocorr =       1.246382629775
              std dev =       0.702506138787
             le_variance =       0.493514875034

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.493513441983
                                         uncertainty =       0.001285313242

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.493513441983
                                         uncertainty =       0.001285313242

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000248373427
  error estimate for blocks of size 2^( 2) =       0.000257344420
  error estimate for blocks of size 2^( 3) =       0.000265415467
  error estimate for blocks of size 2^( 4) =       0.000271056810
  error estimate for blocks of size 2^( 5) =       0.000274463112
  error estimate for blocks of size 2^( 6) =       0.000276116266
  error estimate for blocks of size 2^( 7) =       0.000277178065
  error estimate for blocks of size 2^( 8) =       0.000277326435
  error estimate for blocks of size 2^( 9) =       0.000278530592

      target function =                  N/A
              le_mean =     -22.669916706110
             les_mean =     514.431247236910
             stat err =       0.000277287840
             autocorr =       1.246382629288
              std dev =       0.702506138978
             le_variance =       0.493514875302


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.669916706110        initial
     9.0949e+03     9.0949e+04             2.1350e-08       -22.669916706118  <--
     3.6380e+04     3.6380e+05             5.3376e-09       -22.669916706114
     1.4552e+05     1.4552e+06             1.3344e-09       -22.669916706110

*****************************************************************************
Applying the update for shift_i =   9.0949e+03     and shift_s =   9.0949e+04
*****************************************************************************

  Execution time = 1.7474e+02
  </log>
  <optVariables href="FORM.s046.opt.xml">
ci_001                -7.050617e-01 3 1  ON 0
ci_002                -7.059926e-01 3 1  ON 1
ci_003                -3.765135e-02 3 1  ON 2
ci_004                -3.890327e-02 3 1  ON 3
ci_005                 1.612442e-02 3 1  ON 4
ci_006                 1.600090e-02 3 1  ON 5
ci_007                 1.228712e-02 3 1  ON 6
ci_008                 1.246534e-02 3 1  ON 7
ci_009                -1.173869e-02 3 1  ON 8
ci_010                -1.182877e-02 3 1  ON 9
ci_011                -8.176399e-03 3 1  ON 10
ci_012                -8.138286e-03 3 1  ON 11
ci_013                 9.647121e-03 3 1  ON 12
ci_014                 9.360595e-03 3 1  ON 13
ci_015                 1.228716e-02 3 1  ON 14
ci_016                 1.255401e-02 3 1  ON 15
ci_017                 1.088301e-02 3 1  ON 16
ci_018                 1.078148e-02 3 1  ON 17
ci_019                -2.514316e-03 3 1  ON 18
ci_020                -2.423776e-03 3 1  ON 19
ci_021                -8.459787e-03 3 1  ON 20
ci_022                -8.657037e-03 3 1  ON 21
ci_023                 7.805055e-03 3 1  ON 22
ci_024                 8.041868e-03 3 1  ON 23
ci_025                 4.702652e-03 3 1  ON 24
ci_026                 4.273176e-03 3 1  ON 25
ci_027                 6.454114e-03 3 1  ON 26
ci_028                 6.476444e-03 3 1  ON 27
ci_029                -4.877830e-03 3 1  ON 28
ci_030                -4.785597e-03 3 1  ON 29
ci_031                -7.388669e-03 3 1  ON 30
ci_032                -8.123182e-03 3 1  ON 31
ci_033                 4.600615e-03 3 1  ON 32
ci_034                 4.413539e-03 3 1  ON 33
ci_035                 1.126891e-03 3 1  ON 34
ci_036                 1.043136e-03 3 1  ON 35
ci_037                 4.953342e-03 3 1  ON 36
ci_038                 5.099299e-03 3 1  ON 37
ci_039                 5.306393e-03 3 1  ON 38
ci_040                 5.323077e-03 3 1  ON 39
ci_041                 4.970512e-03 3 1  ON 40
ci_042                 5.231275e-03 3 1  ON 41
ci_043                 4.943060e-03 3 1  ON 42
ci_044                 4.944205e-03 3 1  ON 43
ci_045                 3.123978e-03 3 1  ON 44
ci_046                 3.174250e-03 3 1  ON 45
ci_047                -7.790506e-04 3 1  ON 46
ci_048                -5.616655e-04 3 1  ON 47
ci_049                 1.580266e-03 3 1  ON 48
ci_050                 1.792530e-03 3 1  ON 49
ci_051                -1.106640e-03 3 1  ON 50
ci_052                -1.243264e-03 3 1  ON 51
ci_053                -2.610467e-03 3 1  ON 52
ci_054                -2.301971e-03 3 1  ON 53
ci_055                -1.483436e-03 3 1  ON 54
ci_056                -1.376734e-03 3 1  ON 55
ci_057                -1.240699e-03 3 1  ON 56
ci_058                -1.731102e-03 3 1  ON 57
ci_059                 3.171644e-04 3 1  ON 58
ci_060                 1.414726e-04 3 1  ON 59
ci_061                -3.305195e-04 3 1  ON 60
ci_062                -9.491672e-06 3 1  ON 61
ci_063                -5.232886e-04 3 1  ON 62
ci_064                -8.918616e-04 3 1  ON 63
ci_065                -2.408142e-03 3 1  ON 64
ci_066                -2.435277e-03 3 1  ON 65
ci_067                -2.101048e-03 3 1  ON 66
ci_068                -2.473574e-03 3 1  ON 67
ci_069                -2.086214e-04 3 1  ON 68
ci_070                 1.328682e-04 3 1  ON 69
ci_071                -1.874194e-03 3 1  ON 70
ci_072                -1.959422e-03 3 1  ON 71
ci_073                 5.749489e-04 3 1  ON 72
ci_074                 2.857427e-04 3 1  ON 73
ci_075                -2.910561e-04 3 1  ON 74
ci_076                -2.991166e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 2.9416e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s047 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s047 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=47  my_counter=0
  time step      = 5.0000e-02
  blocks         = 250
  steps          = 250
  substeps       = 10
  current        = 0
  target samples = 8.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">250</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">6.2500e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">8.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">6.2500e+04</parameter>
<parameter name="steps" condition="int">250</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2661e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="250">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =8000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 47
    time step          = 0.05
    reference energy   = -22.6383
    reference variance = 0.438893
====================================================
  Execution time = 1.0058e+02
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s047
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 62500 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 6.1091e+04
  VMC Eavg = -2.2670e+01
  VMC Evar = 5.1015e-01
  Total weights = 7.820488591e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.9084e+01
  </log>
</opt>
<opt stage="main" walkers="62500">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.497322715861
                                         uncertainty =       0.001635500153

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.497322715861
                                         uncertainty =       0.001635500153

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000249330357
  error estimate for blocks of size 2^( 2) =       0.000258307554
  error estimate for blocks of size 2^( 3) =       0.000266331011
  error estimate for blocks of size 2^( 4) =       0.000271891342
  error estimate for blocks of size 2^( 5) =       0.000275127481
  error estimate for blocks of size 2^( 6) =       0.000277022534
  error estimate for blocks of size 2^( 7) =       0.000277860249
  error estimate for blocks of size 2^( 8) =       0.000278072429
  error estimate for blocks of size 2^( 9) =       0.000277907144

      target function =                  N/A
              le_mean =     -22.669815848937
             les_mean =     514.430703316525
             stat err =       0.000277715589
             autocorr =       1.240652630084
              std dev =       0.705212744748
             le_variance =       0.497325015355


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266981584894e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.2737e+03, overlap shift 2.2737e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.669815848963       residual = 4.31e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.669815849691       residual = 5.66e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.669815849708       residual = 1.96e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.669815849716       residual = 6.14e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 2.2737e+03 is 8.701151e-08

solving harmonic davidson linear method for identity shift 9.0949e+03, overlap shift 9.0949e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.669815848963       residual = 4.31e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.669815849145       residual = 5.66e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.669815849149       residual = 1.96e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.669815849151       residual = 6.14e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 9.0949e+03 is 2.175400e-08

solving harmonic davidson linear method for identity shift 3.6380e+04, overlap shift 3.6380e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.669815848963       residual = 4.31e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.669815849008       residual = 5.66e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.669815849009       residual = 1.96e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.669815849010       residual = 6.14e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 3.6380e+04 is 5.438570e-09

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.099452 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.1968e+02
  </log>
  <optVariables href="FORM.s047.opt.xml">
ci_001                -7.050617e-01 3 1  ON 0
ci_002                -7.059927e-01 3 1  ON 1
ci_003                -3.765135e-02 3 1  ON 2
ci_004                -3.890326e-02 3 1  ON 3
ci_005                 1.612443e-02 3 1  ON 4
ci_006                 1.600091e-02 3 1  ON 5
ci_007                 1.228713e-02 3 1  ON 6
ci_008                 1.246533e-02 3 1  ON 7
ci_009                -1.173870e-02 3 1  ON 8
ci_010                -1.182877e-02 3 1  ON 9
ci_011                -8.176400e-03 3 1  ON 10
ci_012                -8.138295e-03 3 1  ON 11
ci_013                 9.647122e-03 3 1  ON 12
ci_014                 9.360597e-03 3 1  ON 13
ci_015                 1.228715e-02 3 1  ON 14
ci_016                 1.255403e-02 3 1  ON 15
ci_017                 1.088300e-02 3 1  ON 16
ci_018                 1.078147e-02 3 1  ON 17
ci_019                -2.514319e-03 3 1  ON 18
ci_020                -2.423782e-03 3 1  ON 19
ci_021                -8.459781e-03 3 1  ON 20
ci_022                -8.657031e-03 3 1  ON 21
ci_023                 7.805048e-03 3 1  ON 22
ci_024                 8.041883e-03 3 1  ON 23
ci_025                 4.702655e-03 3 1  ON 24
ci_026                 4.273178e-03 3 1  ON 25
ci_027                 6.454121e-03 3 1  ON 26
ci_028                 6.476459e-03 3 1  ON 27
ci_029                -4.877845e-03 3 1  ON 28
ci_030                -4.785596e-03 3 1  ON 29
ci_031                -7.388674e-03 3 1  ON 30
ci_032                -8.123165e-03 3 1  ON 31
ci_033                 4.600613e-03 3 1  ON 32
ci_034                 4.413536e-03 3 1  ON 33
ci_035                 1.126891e-03 3 1  ON 34
ci_036                 1.043149e-03 3 1  ON 35
ci_037                 4.953341e-03 3 1  ON 36
ci_038                 5.099302e-03 3 1  ON 37
ci_039                 5.306399e-03 3 1  ON 38
ci_040                 5.323073e-03 3 1  ON 39
ci_041                 4.970511e-03 3 1  ON 40
ci_042                 5.231271e-03 3 1  ON 41
ci_043                 4.943038e-03 3 1  ON 42
ci_044                 4.944205e-03 3 1  ON 43
ci_045                 3.123966e-03 3 1  ON 44
ci_046                 3.174255e-03 3 1  ON 45
ci_047                -7.790455e-04 3 1  ON 46
ci_048                -5.616711e-04 3 1  ON 47
ci_049                 1.580260e-03 3 1  ON 48
ci_050                 1.792519e-03 3 1  ON 49
ci_051                -1.106652e-03 3 1  ON 50
ci_052                -1.243278e-03 3 1  ON 51
ci_053                -2.610471e-03 3 1  ON 52
ci_054                -2.301981e-03 3 1  ON 53
ci_055                -1.483430e-03 3 1  ON 54
ci_056                -1.376745e-03 3 1  ON 55
ci_057                -1.240703e-03 3 1  ON 56
ci_058                -1.731085e-03 3 1  ON 57
ci_059                 3.171639e-04 3 1  ON 58
ci_060                 1.414819e-04 3 1  ON 59
ci_061                -3.305215e-04 3 1  ON 60
ci_062                -9.508750e-06 3 1  ON 61
ci_063                -5.232928e-04 3 1  ON 62
ci_064                -8.918609e-04 3 1  ON 63
ci_065                -2.408147e-03 3 1  ON 64
ci_066                -2.435274e-03 3 1  ON 65
ci_067                -2.101053e-03 3 1  ON 66
ci_068                -2.473567e-03 3 1  ON 67
ci_069                -2.086197e-04 3 1  ON 68
ci_070                 1.328514e-04 3 1  ON 69
ci_071                -1.874201e-03 3 1  ON 70
ci_072                -1.959418e-03 3 1  ON 71
ci_073                 5.749368e-04 3 1  ON 72
ci_074                 2.857371e-04 3 1  ON 73
ci_075                -2.910691e-04 3 1  ON 74
ci_076                -2.991178e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="250">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =8000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 47
    time step          = 0.05
    reference energy   = -22.6627
    reference variance = 0.324809
====================================================
  Execution time = 1.0166e+02
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s047
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 62500 
  VMC Eavg = -2.2670e+01
  VMC Evar = 5.0609e-01
  Total weights = 7.8200e+06
  Execution time = 1.4661e+01
  </log>
</opt>
<opt stage="main" walkers="62500">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.494216519194
                                         uncertainty =       0.001432690003

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.494216519194
                                         uncertainty =       0.001432690003

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000248550961
  error estimate for blocks of size 2^( 2) =       0.000257526629
  error estimate for blocks of size 2^( 3) =       0.000265662941
  error estimate for blocks of size 2^( 4) =       0.000271461914
  error estimate for blocks of size 2^( 5) =       0.000274619932
  error estimate for blocks of size 2^( 6) =       0.000275885784
  error estimate for blocks of size 2^( 7) =       0.000276491829
  error estimate for blocks of size 2^( 8) =       0.000276960489
  error estimate for blocks of size 2^( 9) =       0.000278201240

      target function =                  N/A
              le_mean =     -22.669828796409
             les_mean =     514.427226040541
             stat err =       0.000276884835
             autocorr =       1.240987614517
              std dev =       0.703008280714
             le_variance =       0.494220642753

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.494216509111
                                         uncertainty =       0.001432688875

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.494216509111
                                         uncertainty =       0.001432688875

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000248550959
  error estimate for blocks of size 2^( 2) =       0.000257526626
  error estimate for blocks of size 2^( 3) =       0.000265662939
  error estimate for blocks of size 2^( 4) =       0.000271461912
  error estimate for blocks of size 2^( 5) =       0.000274619930
  error estimate for blocks of size 2^( 6) =       0.000275885783
  error estimate for blocks of size 2^( 7) =       0.000276491829
  error estimate for blocks of size 2^( 8) =       0.000276960488
  error estimate for blocks of size 2^( 9) =       0.000278201238

      target function =                  N/A
              le_mean =     -22.669828796273
             les_mean =     514.427225716342
             stat err =       0.000276884834
             autocorr =       1.240987630765
              std dev =       0.703008273546
             le_variance =       0.494220632674

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.494216514152
                                         uncertainty =       0.001432689439

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.494216514152
                                         uncertainty =       0.001432689439

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000248550960
  error estimate for blocks of size 2^( 2) =       0.000257526627
  error estimate for blocks of size 2^( 3) =       0.000265662940
  error estimate for blocks of size 2^( 4) =       0.000271461913
  error estimate for blocks of size 2^( 5) =       0.000274619931
  error estimate for blocks of size 2^( 6) =       0.000275885783
  error estimate for blocks of size 2^( 7) =       0.000276491829
  error estimate for blocks of size 2^( 8) =       0.000276960488
  error estimate for blocks of size 2^( 9) =       0.000278201239

      target function =                  N/A
              le_mean =     -22.669828796341
             les_mean =     514.427225872335
             stat err =       0.000276884835
             autocorr =       1.240987622678
              std dev =       0.703008277130
             le_variance =       0.494220637713

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.494216518564
                                         uncertainty =       0.001432689933

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.494216518564
                                         uncertainty =       0.001432689933

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000248550961
  error estimate for blocks of size 2^( 2) =       0.000257526629
  error estimate for blocks of size 2^( 3) =       0.000265662941
  error estimate for blocks of size 2^( 4) =       0.000271461914
  error estimate for blocks of size 2^( 5) =       0.000274619932
  error estimate for blocks of size 2^( 6) =       0.000275885784
  error estimate for blocks of size 2^( 7) =       0.000276491829
  error estimate for blocks of size 2^( 8) =       0.000276960488
  error estimate for blocks of size 2^( 9) =       0.000278201240

      target function =                  N/A
              le_mean =     -22.669828796401
             les_mean =     514.427226018795
             stat err =       0.000276884835
             autocorr =       1.240987615565
              std dev =       0.703008280266
             le_variance =       0.494220642123


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.669828796409        initial  <--
     2.2737e+03     2.2737e+04             8.7012e-08       -22.669828796273
     9.0949e+03     9.0949e+04             2.1754e-08       -22.669828796341
     3.6380e+04     3.6380e+05             5.4386e-09       -22.669828796401

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 175.0205
  </log>
  <optVariables href="FORM.s047.opt.xml">
ci_001                -7.050617e-01 3 1  ON 0
ci_002                -7.059926e-01 3 1  ON 1
ci_003                -3.765135e-02 3 1  ON 2
ci_004                -3.890327e-02 3 1  ON 3
ci_005                 1.612442e-02 3 1  ON 4
ci_006                 1.600090e-02 3 1  ON 5
ci_007                 1.228712e-02 3 1  ON 6
ci_008                 1.246534e-02 3 1  ON 7
ci_009                -1.173869e-02 3 1  ON 8
ci_010                -1.182877e-02 3 1  ON 9
ci_011                -8.176399e-03 3 1  ON 10
ci_012                -8.138286e-03 3 1  ON 11
ci_013                 9.647121e-03 3 1  ON 12
ci_014                 9.360595e-03 3 1  ON 13
ci_015                 1.228716e-02 3 1  ON 14
ci_016                 1.255401e-02 3 1  ON 15
ci_017                 1.088301e-02 3 1  ON 16
ci_018                 1.078148e-02 3 1  ON 17
ci_019                -2.514316e-03 3 1  ON 18
ci_020                -2.423776e-03 3 1  ON 19
ci_021                -8.459787e-03 3 1  ON 20
ci_022                -8.657037e-03 3 1  ON 21
ci_023                 7.805055e-03 3 1  ON 22
ci_024                 8.041868e-03 3 1  ON 23
ci_025                 4.702652e-03 3 1  ON 24
ci_026                 4.273176e-03 3 1  ON 25
ci_027                 6.454114e-03 3 1  ON 26
ci_028                 6.476444e-03 3 1  ON 27
ci_029                -4.877830e-03 3 1  ON 28
ci_030                -4.785597e-03 3 1  ON 29
ci_031                -7.388669e-03 3 1  ON 30
ci_032                -8.123182e-03 3 1  ON 31
ci_033                 4.600615e-03 3 1  ON 32
ci_034                 4.413539e-03 3 1  ON 33
ci_035                 1.126891e-03 3 1  ON 34
ci_036                 1.043136e-03 3 1  ON 35
ci_037                 4.953342e-03 3 1  ON 36
ci_038                 5.099299e-03 3 1  ON 37
ci_039                 5.306393e-03 3 1  ON 38
ci_040                 5.323077e-03 3 1  ON 39
ci_041                 4.970512e-03 3 1  ON 40
ci_042                 5.231275e-03 3 1  ON 41
ci_043                 4.943060e-03 3 1  ON 42
ci_044                 4.944205e-03 3 1  ON 43
ci_045                 3.123978e-03 3 1  ON 44
ci_046                 3.174250e-03 3 1  ON 45
ci_047                -7.790506e-04 3 1  ON 46
ci_048                -5.616655e-04 3 1  ON 47
ci_049                 1.580266e-03 3 1  ON 48
ci_050                 1.792530e-03 3 1  ON 49
ci_051                -1.106640e-03 3 1  ON 50
ci_052                -1.243264e-03 3 1  ON 51
ci_053                -2.610467e-03 3 1  ON 52
ci_054                -2.301971e-03 3 1  ON 53
ci_055                -1.483436e-03 3 1  ON 54
ci_056                -1.376734e-03 3 1  ON 55
ci_057                -1.240699e-03 3 1  ON 56
ci_058                -1.731102e-03 3 1  ON 57
ci_059                 3.171644e-04 3 1  ON 58
ci_060                 1.414726e-04 3 1  ON 59
ci_061                -3.305195e-04 3 1  ON 60
ci_062                -9.491672e-06 3 1  ON 61
ci_063                -5.232886e-04 3 1  ON 62
ci_064                -8.918616e-04 3 1  ON 63
ci_065                -2.408142e-03 3 1  ON 64
ci_066                -2.435277e-03 3 1  ON 65
ci_067                -2.101048e-03 3 1  ON 66
ci_068                -2.473574e-03 3 1  ON 67
ci_069                -2.086214e-04 3 1  ON 68
ci_070                 1.328682e-04 3 1  ON 69
ci_071                -1.874194e-03 3 1  ON 70
ci_072                -1.959422e-03 3 1  ON 71
ci_073                 5.749489e-04 3 1  ON 72
ci_074                 2.857427e-04 3 1  ON 73
ci_075                -2.910561e-04 3 1  ON 74
ci_076                -2.991166e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 2.9470e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s048 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s048 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=48  my_counter=0
  time step      = 5.0000e-02
  blocks         = 250
  steps          = 250
  substeps       = 10
  current        = 0
  target samples = 8.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">250</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">6.2500e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">8.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">6.2500e+04</parameter>
<parameter name="steps" condition="int">250</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2661e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="250">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =8000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 48
    time step          = 0.05
    reference energy   = -22.8387
    reference variance = 3.06155
====================================================
  Execution time = 1.0043e+02
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s048
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 62500 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 6.1042e+04
  VMC Eavg = -2.2670e+01
  VMC Evar = 5.0775e-01
  Total weights = 7.820021857e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.8963e+01
  </log>
</opt>
<opt stage="main" walkers="62500">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.494828785545
                                         uncertainty =       0.001435138545

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.494828785545
                                         uncertainty =       0.001435138545

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000248704362
  error estimate for blocks of size 2^( 2) =       0.000257591064
  error estimate for blocks of size 2^( 3) =       0.000265550669
  error estimate for blocks of size 2^( 4) =       0.000271068563
  error estimate for blocks of size 2^( 5) =       0.000274497997
  error estimate for blocks of size 2^( 6) =       0.000276124449
  error estimate for blocks of size 2^( 7) =       0.000277013796
  error estimate for blocks of size 2^( 8) =       0.000277758444
  error estimate for blocks of size 2^( 9) =       0.000278666333

      target function =                  N/A
              le_mean =     -22.669674278420
             les_mean =     514.421878960407
             stat err =       0.000277390756
             autocorr =       1.243990780148
              std dev =       0.703442164897
             le_variance =       0.494830879355


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266967427842e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.2737e+04, overlap shift 2.2737e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.669674278436       residual = 4.45e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.669674278511       residual = 5.17e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.669674278510       residual = 1.87e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.669674278509       residual = 7.68e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 2.2737e+04 is 1.346127e-08

solving harmonic davidson linear method for identity shift 9.0949e+04, overlap shift 9.0949e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.669674278436       residual = 4.45e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.669674278455       residual = 5.17e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.669674278454       residual = 1.87e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.669674278455       residual = 7.68e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 9.0949e+04 is 3.365347e-09

solving harmonic davidson linear method for identity shift 3.6380e+05, overlap shift 3.6380e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.669674278436       residual = 4.45e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.669674278441       residual = 5.17e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.669674278440       residual = 1.87e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.669674278441       residual = 7.68e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 3.6380e+05 is 8.413385e-10

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.100801 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.1941e+02
  </log>
  <optVariables href="FORM.s048.opt.xml">
ci_001                -7.050617e-01 3 1  ON 0
ci_002                -7.059926e-01 3 1  ON 1
ci_003                -3.765135e-02 3 1  ON 2
ci_004                -3.890327e-02 3 1  ON 3
ci_005                 1.612442e-02 3 1  ON 4
ci_006                 1.600090e-02 3 1  ON 5
ci_007                 1.228713e-02 3 1  ON 6
ci_008                 1.246534e-02 3 1  ON 7
ci_009                -1.173869e-02 3 1  ON 8
ci_010                -1.182877e-02 3 1  ON 9
ci_011                -8.176398e-03 3 1  ON 10
ci_012                -8.138286e-03 3 1  ON 11
ci_013                 9.647122e-03 3 1  ON 12
ci_014                 9.360596e-03 3 1  ON 13
ci_015                 1.228716e-02 3 1  ON 14
ci_016                 1.255401e-02 3 1  ON 15
ci_017                 1.088301e-02 3 1  ON 16
ci_018                 1.078148e-02 3 1  ON 17
ci_019                -2.514317e-03 3 1  ON 18
ci_020                -2.423775e-03 3 1  ON 19
ci_021                -8.459786e-03 3 1  ON 20
ci_022                -8.657036e-03 3 1  ON 21
ci_023                 7.805055e-03 3 1  ON 22
ci_024                 8.041865e-03 3 1  ON 23
ci_025                 4.702651e-03 3 1  ON 24
ci_026                 4.273176e-03 3 1  ON 25
ci_027                 6.454115e-03 3 1  ON 26
ci_028                 6.476444e-03 3 1  ON 27
ci_029                -4.877831e-03 3 1  ON 28
ci_030                -4.785597e-03 3 1  ON 29
ci_031                -7.388669e-03 3 1  ON 30
ci_032                -8.123182e-03 3 1  ON 31
ci_033                 4.600614e-03 3 1  ON 32
ci_034                 4.413540e-03 3 1  ON 33
ci_035                 1.126891e-03 3 1  ON 34
ci_036                 1.043137e-03 3 1  ON 35
ci_037                 4.953342e-03 3 1  ON 36
ci_038                 5.099299e-03 3 1  ON 37
ci_039                 5.306392e-03 3 1  ON 38
ci_040                 5.323077e-03 3 1  ON 39
ci_041                 4.970512e-03 3 1  ON 40
ci_042                 5.231275e-03 3 1  ON 41
ci_043                 4.943060e-03 3 1  ON 42
ci_044                 4.944205e-03 3 1  ON 43
ci_045                 3.123978e-03 3 1  ON 44
ci_046                 3.174250e-03 3 1  ON 45
ci_047                -7.790490e-04 3 1  ON 46
ci_048                -5.616666e-04 3 1  ON 47
ci_049                 1.580267e-03 3 1  ON 48
ci_050                 1.792530e-03 3 1  ON 49
ci_051                -1.106641e-03 3 1  ON 50
ci_052                -1.243264e-03 3 1  ON 51
ci_053                -2.610468e-03 3 1  ON 52
ci_054                -2.301972e-03 3 1  ON 53
ci_055                -1.483435e-03 3 1  ON 54
ci_056                -1.376734e-03 3 1  ON 55
ci_057                -1.240699e-03 3 1  ON 56
ci_058                -1.731102e-03 3 1  ON 57
ci_059                 3.171658e-04 3 1  ON 58
ci_060                 1.414738e-04 3 1  ON 59
ci_061                -3.305182e-04 3 1  ON 60
ci_062                -9.490102e-06 3 1  ON 61
ci_063                -5.232900e-04 3 1  ON 62
ci_064                -8.918604e-04 3 1  ON 63
ci_065                -2.408143e-03 3 1  ON 64
ci_066                -2.435278e-03 3 1  ON 65
ci_067                -2.101046e-03 3 1  ON 66
ci_068                -2.473574e-03 3 1  ON 67
ci_069                -2.086213e-04 3 1  ON 68
ci_070                 1.328685e-04 3 1  ON 69
ci_071                -1.874195e-03 3 1  ON 70
ci_072                -1.959422e-03 3 1  ON 71
ci_073                 5.749455e-04 3 1  ON 72
ci_074                 2.857430e-04 3 1  ON 73
ci_075                -2.910559e-04 3 1  ON 74
ci_076                -2.991159e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="250">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =8000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 48
    time step          = 0.05
    reference energy   = -22.5938
    reference variance = 0.488633
====================================================
  Execution time = 1.0126e+02
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s048
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 62500 
  VMC Eavg = -2.2670e+01
  VMC Evar = 5.0862e-01
  Total weights = 7.8205e+06
  Execution time = 1.4619e+01
  </log>
</opt>
<opt stage="main" walkers="62500">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.495802835153
                                         uncertainty =       0.001409162687

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.495802835153
                                         uncertainty =       0.001409162687

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000248948914
  error estimate for blocks of size 2^( 2) =       0.000257884070
  error estimate for blocks of size 2^( 3) =       0.000266088671
  error estimate for blocks of size 2^( 4) =       0.000271786036
  error estimate for blocks of size 2^( 5) =       0.000275275137
  error estimate for blocks of size 2^( 6) =       0.000277304607
  error estimate for blocks of size 2^( 7) =       0.000278487676
  error estimate for blocks of size 2^( 8) =       0.000278496632
  error estimate for blocks of size 2^( 9) =       0.000278645892

      target function =                  N/A
              le_mean =     -22.669928370373
             les_mean =     514.434271265235
             stat err =       0.000278233702
             autocorr =       1.249105139571
              std dev =       0.704133860856
             le_variance =       0.495804494004

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.495802834927
                                         uncertainty =       0.001409162604

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.495802834927
                                         uncertainty =       0.001409162604

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000248948914
  error estimate for blocks of size 2^( 2) =       0.000257884070
  error estimate for blocks of size 2^( 3) =       0.000266088671
  error estimate for blocks of size 2^( 4) =       0.000271786036
  error estimate for blocks of size 2^( 5) =       0.000275275137
  error estimate for blocks of size 2^( 6) =       0.000277304607
  error estimate for blocks of size 2^( 7) =       0.000278487675
  error estimate for blocks of size 2^( 8) =       0.000278496631
  error estimate for blocks of size 2^( 9) =       0.000278645892

      target function =                  N/A
              le_mean =     -22.669928370444
             les_mean =     514.434271264443
             stat err =       0.000278233701
             autocorr =       1.249105138673
              std dev =       0.704133860695
             le_variance =       0.495804493778

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.495802835040
                                         uncertainty =       0.001409162646

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.495802835040
                                         uncertainty =       0.001409162646

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000248948914
  error estimate for blocks of size 2^( 2) =       0.000257884070
  error estimate for blocks of size 2^( 3) =       0.000266088671
  error estimate for blocks of size 2^( 4) =       0.000271786036
  error estimate for blocks of size 2^( 5) =       0.000275275137
  error estimate for blocks of size 2^( 6) =       0.000277304607
  error estimate for blocks of size 2^( 7) =       0.000278487676
  error estimate for blocks of size 2^( 8) =       0.000278496632
  error estimate for blocks of size 2^( 9) =       0.000278645892

      target function =                  N/A
              le_mean =     -22.669928370409
             les_mean =     514.434271264812
             stat err =       0.000278233702
             autocorr =       1.249105139112
              std dev =       0.704133860776
             le_variance =       0.495804493891

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.495802835139
                                         uncertainty =       0.001409162682

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.495802835139
                                         uncertainty =       0.001409162682

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000248948914
  error estimate for blocks of size 2^( 2) =       0.000257884070
  error estimate for blocks of size 2^( 3) =       0.000266088671
  error estimate for blocks of size 2^( 4) =       0.000271786036
  error estimate for blocks of size 2^( 5) =       0.000275275137
  error estimate for blocks of size 2^( 6) =       0.000277304607
  error estimate for blocks of size 2^( 7) =       0.000278487676
  error estimate for blocks of size 2^( 8) =       0.000278496632
  error estimate for blocks of size 2^( 9) =       0.000278645892

      target function =                  N/A
              le_mean =     -22.669928370378
             les_mean =     514.434271265179
             stat err =       0.000278233702
             autocorr =       1.249105139553
              std dev =       0.704133860846
             le_variance =       0.495804493990


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.669928370373        initial
     2.2737e+04     2.2737e+05             1.3461e-08       -22.669928370444  <--
     9.0949e+04     9.0949e+05             3.3653e-09       -22.669928370409
     3.6380e+05     3.6380e+06             8.4134e-10       -22.669928370378

*****************************************************************************
Applying the update for shift_i =   2.2737e+04     and shift_s =   2.2737e+05
*****************************************************************************

  Execution time = 1.7438e+02
  </log>
  <optVariables href="FORM.s048.opt.xml">
ci_001                -7.050617e-01 3 1  ON 0
ci_002                -7.059926e-01 3 1  ON 1
ci_003                -3.765136e-02 3 1  ON 2
ci_004                -3.890327e-02 3 1  ON 3
ci_005                 1.612443e-02 3 1  ON 4
ci_006                 1.600090e-02 3 1  ON 5
ci_007                 1.228713e-02 3 1  ON 6
ci_008                 1.246534e-02 3 1  ON 7
ci_009                -1.173869e-02 3 1  ON 8
ci_010                -1.182877e-02 3 1  ON 9
ci_011                -8.176393e-03 3 1  ON 10
ci_012                -8.138289e-03 3 1  ON 11
ci_013                 9.647123e-03 3 1  ON 12
ci_014                 9.360596e-03 3 1  ON 13
ci_015                 1.228716e-02 3 1  ON 14
ci_016                 1.255401e-02 3 1  ON 15
ci_017                 1.088301e-02 3 1  ON 16
ci_018                 1.078148e-02 3 1  ON 17
ci_019                -2.514321e-03 3 1  ON 18
ci_020                -2.423774e-03 3 1  ON 19
ci_021                -8.459783e-03 3 1  ON 20
ci_022                -8.657033e-03 3 1  ON 21
ci_023                 7.805058e-03 3 1  ON 22
ci_024                 8.041858e-03 3 1  ON 23
ci_025                 4.702648e-03 3 1  ON 24
ci_026                 4.273175e-03 3 1  ON 25
ci_027                 6.454116e-03 3 1  ON 26
ci_028                 6.476447e-03 3 1  ON 27
ci_029                -4.877834e-03 3 1  ON 28
ci_030                -4.785598e-03 3 1  ON 29
ci_031                -7.388671e-03 3 1  ON 30
ci_032                -8.123181e-03 3 1  ON 31
ci_033                 4.600613e-03 3 1  ON 32
ci_034                 4.413544e-03 3 1  ON 33
ci_035                 1.126890e-03 3 1  ON 34
ci_036                 1.043137e-03 3 1  ON 35
ci_037                 4.953342e-03 3 1  ON 36
ci_038                 5.099300e-03 3 1  ON 37
ci_039                 5.306391e-03 3 1  ON 38
ci_040                 5.323078e-03 3 1  ON 39
ci_041                 4.970511e-03 3 1  ON 40
ci_042                 5.231276e-03 3 1  ON 41
ci_043                 4.943060e-03 3 1  ON 42
ci_044                 4.944204e-03 3 1  ON 43
ci_045                 3.123981e-03 3 1  ON 44
ci_046                 3.174249e-03 3 1  ON 45
ci_047                -7.790440e-04 3 1  ON 46
ci_048                -5.616697e-04 3 1  ON 47
ci_049                 1.580269e-03 3 1  ON 48
ci_050                 1.792532e-03 3 1  ON 49
ci_051                -1.106642e-03 3 1  ON 50
ci_052                -1.243265e-03 3 1  ON 51
ci_053                -2.610468e-03 3 1  ON 52
ci_054                -2.301975e-03 3 1  ON 53
ci_055                -1.483435e-03 3 1  ON 54
ci_056                -1.376734e-03 3 1  ON 55
ci_057                -1.240698e-03 3 1  ON 56
ci_058                -1.731101e-03 3 1  ON 57
ci_059                 3.171697e-04 3 1  ON 58
ci_060                 1.414772e-04 3 1  ON 59
ci_061                -3.305145e-04 3 1  ON 60
ci_062                -9.485391e-06 3 1  ON 61
ci_063                -5.232943e-04 3 1  ON 62
ci_064                -8.918567e-04 3 1  ON 63
ci_065                -2.408144e-03 3 1  ON 64
ci_066                -2.435279e-03 3 1  ON 65
ci_067                -2.101043e-03 3 1  ON 66
ci_068                -2.473575e-03 3 1  ON 67
ci_069                -2.086210e-04 3 1  ON 68
ci_070                 1.328694e-04 3 1  ON 69
ci_071                -1.874197e-03 3 1  ON 70
ci_072                -1.959422e-03 3 1  ON 71
ci_073                 5.749354e-04 3 1  ON 72
ci_074                 2.857439e-04 3 1  ON 73
ci_075                -2.910556e-04 3 1  ON 74
ci_076                -2.991141e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 2.9379e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s049 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s049 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=49  my_counter=0
  time step      = 5.0000e-02
  blocks         = 250
  steps          = 250
  substeps       = 10
  current        = 0
  target samples = 8.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">250</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">6.2500e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">8.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">6.2500e+04</parameter>
<parameter name="steps" condition="int">250</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2662e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="250">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =8000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 49
    time step          = 0.05
    reference energy   = -22.6414
    reference variance = 0.394305
====================================================
  Execution time = 1.0022e+02
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s049
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 62500 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 6.1081e+04
  VMC Eavg = -2.2669e+01
  VMC Evar = 5.1044e-01
  Total weights = 7.820571202e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.9025e+01
  </log>
</opt>
<opt stage="main" walkers="62500">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.495598150997
                                         uncertainty =       0.001562904644

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.495598150997
                                         uncertainty =       0.001562904644

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000248897018
  error estimate for blocks of size 2^( 2) =       0.000257988630
  error estimate for blocks of size 2^( 3) =       0.000265915122
  error estimate for blocks of size 2^( 4) =       0.000271748152
  error estimate for blocks of size 2^( 5) =       0.000275156158
  error estimate for blocks of size 2^( 6) =       0.000277082347
  error estimate for blocks of size 2^( 7) =       0.000277947389
  error estimate for blocks of size 2^( 8) =       0.000277807030
  error estimate for blocks of size 2^( 9) =       0.000277626441

      target function =                  N/A
              le_mean =     -22.669267361004
             les_mean =     514.406120237387
             stat err =       0.000277615802
             autocorr =       1.244081914421
              std dev =       0.703987077575
             le_variance =       0.495597805392


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266926736100e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.6843e+03, overlap shift 5.6843e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.669267361030       residual = 4.18e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.669267361126       residual = 4.19e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.669267361120       residual = 1.38e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.669267361123       residual = 6.74e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 5.6843e+03 is 4.603812e-08

solving harmonic davidson linear method for identity shift 2.2737e+04, overlap shift 2.2737e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.669267361030       residual = 4.18e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.669267361054       residual = 4.19e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.669267361053       residual = 1.38e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.669267361054       residual = 6.74e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 2.2737e+04 is 1.150993e-08

solving harmonic davidson linear method for identity shift 9.0949e+04, overlap shift 9.0949e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.669267361030       residual = 4.18e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.669267361036       residual = 4.19e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.669267361036       residual = 1.38e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.669267361036       residual = 6.74e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 9.0949e+04 is 2.877508e-09

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.102278 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.1926e+02
  </log>
  <optVariables href="FORM.s049.opt.xml">
ci_001                -7.050617e-01 3 1  ON 0
ci_002                -7.059926e-01 3 1  ON 1
ci_003                -3.765135e-02 3 1  ON 2
ci_004                -3.890327e-02 3 1  ON 3
ci_005                 1.612442e-02 3 1  ON 4
ci_006                 1.600090e-02 3 1  ON 5
ci_007                 1.228713e-02 3 1  ON 6
ci_008                 1.246534e-02 3 1  ON 7
ci_009                -1.173869e-02 3 1  ON 8
ci_010                -1.182877e-02 3 1  ON 9
ci_011                -8.176395e-03 3 1  ON 10
ci_012                -8.138285e-03 3 1  ON 11
ci_013                 9.647124e-03 3 1  ON 12
ci_014                 9.360591e-03 3 1  ON 13
ci_015                 1.228716e-02 3 1  ON 14
ci_016                 1.255401e-02 3 1  ON 15
ci_017                 1.088300e-02 3 1  ON 16
ci_018                 1.078148e-02 3 1  ON 17
ci_019                -2.514322e-03 3 1  ON 18
ci_020                -2.423773e-03 3 1  ON 19
ci_021                -8.459781e-03 3 1  ON 20
ci_022                -8.657035e-03 3 1  ON 21
ci_023                 7.805052e-03 3 1  ON 22
ci_024                 8.041857e-03 3 1  ON 23
ci_025                 4.702650e-03 3 1  ON 24
ci_026                 4.273176e-03 3 1  ON 25
ci_027                 6.454112e-03 3 1  ON 26
ci_028                 6.476458e-03 3 1  ON 27
ci_029                -4.877832e-03 3 1  ON 28
ci_030                -4.785597e-03 3 1  ON 29
ci_031                -7.388676e-03 3 1  ON 30
ci_032                -8.123181e-03 3 1  ON 31
ci_033                 4.600618e-03 3 1  ON 32
ci_034                 4.413546e-03 3 1  ON 33
ci_035                 1.126892e-03 3 1  ON 34
ci_036                 1.043139e-03 3 1  ON 35
ci_037                 4.953342e-03 3 1  ON 36
ci_038                 5.099304e-03 3 1  ON 37
ci_039                 5.306391e-03 3 1  ON 38
ci_040                 5.323079e-03 3 1  ON 39
ci_041                 4.970509e-03 3 1  ON 40
ci_042                 5.231266e-03 3 1  ON 41
ci_043                 4.943058e-03 3 1  ON 42
ci_044                 4.944200e-03 3 1  ON 43
ci_045                 3.123982e-03 3 1  ON 44
ci_046                 3.174247e-03 3 1  ON 45
ci_047                -7.790409e-04 3 1  ON 46
ci_048                -5.616718e-04 3 1  ON 47
ci_049                 1.580272e-03 3 1  ON 48
ci_050                 1.792530e-03 3 1  ON 49
ci_051                -1.106641e-03 3 1  ON 50
ci_052                -1.243269e-03 3 1  ON 51
ci_053                -2.610468e-03 3 1  ON 52
ci_054                -2.301974e-03 3 1  ON 53
ci_055                -1.483442e-03 3 1  ON 54
ci_056                -1.376730e-03 3 1  ON 55
ci_057                -1.240699e-03 3 1  ON 56
ci_058                -1.731097e-03 3 1  ON 57
ci_059                 3.171703e-04 3 1  ON 58
ci_060                 1.414765e-04 3 1  ON 59
ci_061                -3.305123e-04 3 1  ON 60
ci_062                -9.488574e-06 3 1  ON 61
ci_063                -5.232927e-04 3 1  ON 62
ci_064                -8.918554e-04 3 1  ON 63
ci_065                -2.408143e-03 3 1  ON 64
ci_066                -2.435281e-03 3 1  ON 65
ci_067                -2.101052e-03 3 1  ON 66
ci_068                -2.473574e-03 3 1  ON 67
ci_069                -2.086174e-04 3 1  ON 68
ci_070                 1.328649e-04 3 1  ON 69
ci_071                -1.874205e-03 3 1  ON 70
ci_072                -1.959422e-03 3 1  ON 71
ci_073                 5.749296e-04 3 1  ON 72
ci_074                 2.857459e-04 3 1  ON 73
ci_075                -2.910512e-04 3 1  ON 74
ci_076                -2.991108e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="250">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =8000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 49
    time step          = 0.05
    reference energy   = -22.6333
    reference variance = 0.436734
====================================================
  Execution time = 1.0168e+02
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s049
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 62500 
  VMC Eavg = -2.2670e+01
  VMC Evar = 5.0685e-01
  Total weights = 7.8212e+06
  Execution time = 1.4650e+01
  </log>
</opt>
<opt stage="main" walkers="62500">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.494308477913
                                         uncertainty =       0.001212349593

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.494308477913
                                         uncertainty =       0.001212349593

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000248573578
  error estimate for blocks of size 2^( 2) =       0.000257480227
  error estimate for blocks of size 2^( 3) =       0.000265441971
  error estimate for blocks of size 2^( 4) =       0.000271130499
  error estimate for blocks of size 2^( 5) =       0.000274209224
  error estimate for blocks of size 2^( 6) =       0.000275732587
  error estimate for blocks of size 2^( 7) =       0.000277520744
  error estimate for blocks of size 2^( 8) =       0.000277975185
  error estimate for blocks of size 2^( 9) =       0.000278277145

      target function =                  N/A
              le_mean =     -22.670051070992
             les_mean =     514.438062758805
             stat err =       0.000277376415
             autocorr =       1.245171394307
              std dev =       0.703072249782
             le_variance =       0.494310588413

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.494308478396
                                         uncertainty =       0.001212350366

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.494308478396
                                         uncertainty =       0.001212350366

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000248573578
  error estimate for blocks of size 2^( 2) =       0.000257480227
  error estimate for blocks of size 2^( 3) =       0.000265441971
  error estimate for blocks of size 2^( 4) =       0.000271130499
  error estimate for blocks of size 2^( 5) =       0.000274209224
  error estimate for blocks of size 2^( 6) =       0.000275732587
  error estimate for blocks of size 2^( 7) =       0.000277520745
  error estimate for blocks of size 2^( 8) =       0.000277975186
  error estimate for blocks of size 2^( 9) =       0.000278277146

      target function =                  N/A
              le_mean =     -22.670051071215
             les_mean =     514.438062081347
             stat err =       0.000277376416
             autocorr =       1.245171400876
              std dev =       0.703072250125
             le_variance =       0.494310588895

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.494308478154
                                         uncertainty =       0.001212349979

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.494308478154
                                         uncertainty =       0.001212349979

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000248573578
  error estimate for blocks of size 2^( 2) =       0.000257480227
  error estimate for blocks of size 2^( 3) =       0.000265441971
  error estimate for blocks of size 2^( 4) =       0.000271130499
  error estimate for blocks of size 2^( 5) =       0.000274209224
  error estimate for blocks of size 2^( 6) =       0.000275732587
  error estimate for blocks of size 2^( 7) =       0.000277520744
  error estimate for blocks of size 2^( 8) =       0.000277975185
  error estimate for blocks of size 2^( 9) =       0.000278277145

      target function =                  N/A
              le_mean =     -22.670051071104
             les_mean =     514.438062174643
             stat err =       0.000277376415
             autocorr =       1.245171397565
              std dev =       0.703072249953
             le_variance =       0.494310588655

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.494308477943
                                         uncertainty =       0.001212349641

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.494308477943
                                         uncertainty =       0.001212349641

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000248573578
  error estimate for blocks of size 2^( 2) =       0.000257480227
  error estimate for blocks of size 2^( 3) =       0.000265441971
  error estimate for blocks of size 2^( 4) =       0.000271130499
  error estimate for blocks of size 2^( 5) =       0.000274209224
  error estimate for blocks of size 2^( 6) =       0.000275732587
  error estimate for blocks of size 2^( 7) =       0.000277520744
  error estimate for blocks of size 2^( 8) =       0.000277975185
  error estimate for blocks of size 2^( 9) =       0.000278277145

      target function =                  N/A
              le_mean =     -22.670051071006
             les_mean =     514.438062605180
             stat err =       0.000277376415
             autocorr =       1.245171394736
              std dev =       0.703072249804
             le_variance =       0.494310588444


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.670051070992        initial
     5.6843e+03     5.6843e+04             4.6038e-08       -22.670051071215  <--
     2.2737e+04     2.2737e+05             1.1510e-08       -22.670051071104
     9.0949e+04     9.0949e+05             2.8775e-09       -22.670051071006

*****************************************************************************
Applying the update for shift_i =   5.6843e+03     and shift_s =   5.6843e+04
*****************************************************************************

  Execution time = 1.7496e+02
  </log>
  <optVariables href="FORM.s049.opt.xml">
ci_001                -7.050617e-01 3 1  ON 0
ci_002                -7.059926e-01 3 1  ON 1
ci_003                -3.765135e-02 3 1  ON 2
ci_004                -3.890326e-02 3 1  ON 3
ci_005                 1.612441e-02 3 1  ON 4
ci_006                 1.600090e-02 3 1  ON 5
ci_007                 1.228712e-02 3 1  ON 6
ci_008                 1.246533e-02 3 1  ON 7
ci_009                -1.173869e-02 3 1  ON 8
ci_010                -1.182876e-02 3 1  ON 9
ci_011                -8.176402e-03 3 1  ON 10
ci_012                -8.138274e-03 3 1  ON 11
ci_013                 9.647127e-03 3 1  ON 12
ci_014                 9.360575e-03 3 1  ON 13
ci_015                 1.228715e-02 3 1  ON 14
ci_016                 1.255401e-02 3 1  ON 15
ci_017                 1.088299e-02 3 1  ON 16
ci_018                 1.078149e-02 3 1  ON 17
ci_019                -2.514327e-03 3 1  ON 18
ci_020                -2.423770e-03 3 1  ON 19
ci_021                -8.459776e-03 3 1  ON 20
ci_022                -8.657040e-03 3 1  ON 21
ci_023                 7.805035e-03 3 1  ON 22
ci_024                 8.041856e-03 3 1  ON 23
ci_025                 4.702654e-03 3 1  ON 24
ci_026                 4.273176e-03 3 1  ON 25
ci_027                 6.454102e-03 3 1  ON 26
ci_028                 6.476493e-03 3 1  ON 27
ci_029                -4.877824e-03 3 1  ON 28
ci_030                -4.785592e-03 3 1  ON 29
ci_031                -7.388691e-03 3 1  ON 30
ci_032                -8.123180e-03 3 1  ON 31
ci_033                 4.600634e-03 3 1  ON 32
ci_034                 4.413554e-03 3 1  ON 33
ci_035                 1.126899e-03 3 1  ON 34
ci_036                 1.043146e-03 3 1  ON 35
ci_037                 4.953341e-03 3 1  ON 36
ci_038                 5.099316e-03 3 1  ON 37
ci_039                 5.306390e-03 3 1  ON 38
ci_040                 5.323083e-03 3 1  ON 39
ci_041                 4.970501e-03 3 1  ON 40
ci_042                 5.231238e-03 3 1  ON 41
ci_043                 4.943053e-03 3 1  ON 42
ci_044                 4.944188e-03 3 1  ON 43
ci_045                 3.123986e-03 3 1  ON 44
ci_046                 3.174240e-03 3 1  ON 45
ci_047                -7.790317e-04 3 1  ON 46
ci_048                -5.616783e-04 3 1  ON 47
ci_049                 1.580280e-03 3 1  ON 48
ci_050                 1.792525e-03 3 1  ON 49
ci_051                -1.106639e-03 3 1  ON 50
ci_052                -1.243281e-03 3 1  ON 51
ci_053                -2.610467e-03 3 1  ON 52
ci_054                -2.301971e-03 3 1  ON 53
ci_055                -1.483465e-03 3 1  ON 54
ci_056                -1.376716e-03 3 1  ON 55
ci_057                -1.240700e-03 3 1  ON 56
ci_058                -1.731087e-03 3 1  ON 57
ci_059                 3.171722e-04 3 1  ON 58
ci_060                 1.414743e-04 3 1  ON 59
ci_061                -3.305059e-04 3 1  ON 60
ci_062                -9.498122e-06 3 1  ON 61
ci_063                -5.232879e-04 3 1  ON 62
ci_064                -8.918512e-04 3 1  ON 63
ci_065                -2.408140e-03 3 1  ON 64
ci_066                -2.435287e-03 3 1  ON 65
ci_067                -2.101081e-03 3 1  ON 66
ci_068                -2.473568e-03 3 1  ON 67
ci_069                -2.086065e-04 3 1  ON 68
ci_070                 1.328517e-04 3 1  ON 69
ci_071                -1.874227e-03 3 1  ON 70
ci_072                -1.959420e-03 3 1  ON 71
ci_073                 5.749120e-04 3 1  ON 72
ci_074                 2.857519e-04 3 1  ON 73
ci_075                -2.910379e-04 3 1  ON 74
ci_076                -2.991008e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 2.9423e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s050 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s050 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=50  my_counter=0
  time step      = 5.0000e-02
  blocks         = 250
  steps          = 250
  substeps       = 10
  current        = 0
  target samples = 8.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">250</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">6.2500e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">8.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">6.2500e+04</parameter>
<parameter name="steps" condition="int">250</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2662e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="250">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =8000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 50
    time step          = 0.05
    reference energy   = -22.6455
    reference variance = 0.560882
====================================================
  Execution time = 1.0021e+02
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s050
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 62500 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 6.1089e+04
  VMC Eavg = -2.2669e+01
  VMC Evar = 5.1138e-01
  Total weights = 7.820533848e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.8861e+01
  </log>
</opt>
<opt stage="main" walkers="62500">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.497919701318
                                         uncertainty =       0.002157421674

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.497919701318
                                         uncertainty =       0.002157421674

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000249480194
  error estimate for blocks of size 2^( 2) =       0.000258430444
  error estimate for blocks of size 2^( 3) =       0.000266470690
  error estimate for blocks of size 2^( 4) =       0.000272305018
  error estimate for blocks of size 2^( 5) =       0.000275588151
  error estimate for blocks of size 2^( 6) =       0.000277430148
  error estimate for blocks of size 2^( 7) =       0.000278043096
  error estimate for blocks of size 2^( 8) =       0.000277863729
  error estimate for blocks of size 2^( 9) =       0.000277213659

      target function =                  N/A
              le_mean =     -22.669483959277
             les_mean =     514.416883883640
             stat err =       0.000277637658
             autocorr =       1.238467454958
              std dev =       0.705636547818
             le_variance =       0.497922937617


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266948395928e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.4211e+03, overlap shift 1.4211e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.669483959300       residual = 3.58e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.669483960039       residual = 4.39e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.669483960025       residual = 1.76e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.669483960035       residual = 6.50e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 1.4211e+03 is 1.318815e-07

solving harmonic davidson linear method for identity shift 5.6843e+03, overlap shift 5.6843e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.669483959300       residual = 3.58e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.669483959485       residual = 4.39e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.669483959481       residual = 1.77e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.669483959484       residual = 6.50e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 5.6843e+03 is 3.297358e-08

solving harmonic davidson linear method for identity shift 2.2737e+04, overlap shift 2.2737e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.669483959300       residual = 3.58e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.669483959346       residual = 4.39e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.669483959345       residual = 1.77e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.669483959341       residual = 6.50e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 2.2737e+04 is 8.243596e-09

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.103621 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.1909e+02
  </log>
  <optVariables href="FORM.s050.opt.xml">
ci_001                -7.050617e-01 3 1  ON 0
ci_002                -7.059926e-01 3 1  ON 1
ci_003                -3.765135e-02 3 1  ON 2
ci_004                -3.890325e-02 3 1  ON 3
ci_005                 1.612442e-02 3 1  ON 4
ci_006                 1.600090e-02 3 1  ON 5
ci_007                 1.228713e-02 3 1  ON 6
ci_008                 1.246534e-02 3 1  ON 7
ci_009                -1.173869e-02 3 1  ON 8
ci_010                -1.182875e-02 3 1  ON 9
ci_011                -8.176404e-03 3 1  ON 10
ci_012                -8.138283e-03 3 1  ON 11
ci_013                 9.647140e-03 3 1  ON 12
ci_014                 9.360582e-03 3 1  ON 13
ci_015                 1.228715e-02 3 1  ON 14
ci_016                 1.255400e-02 3 1  ON 15
ci_017                 1.088298e-02 3 1  ON 16
ci_018                 1.078151e-02 3 1  ON 17
ci_019                -2.514331e-03 3 1  ON 18
ci_020                -2.423773e-03 3 1  ON 19
ci_021                -8.459756e-03 3 1  ON 20
ci_022                -8.657022e-03 3 1  ON 21
ci_023                 7.805025e-03 3 1  ON 22
ci_024                 8.041862e-03 3 1  ON 23
ci_025                 4.702623e-03 3 1  ON 24
ci_026                 4.273181e-03 3 1  ON 25
ci_027                 6.454110e-03 3 1  ON 26
ci_028                 6.476489e-03 3 1  ON 27
ci_029                -4.877800e-03 3 1  ON 28
ci_030                -4.785603e-03 3 1  ON 29
ci_031                -7.388719e-03 3 1  ON 30
ci_032                -8.123169e-03 3 1  ON 31
ci_033                 4.600621e-03 3 1  ON 32
ci_034                 4.413561e-03 3 1  ON 33
ci_035                 1.126893e-03 3 1  ON 34
ci_036                 1.043164e-03 3 1  ON 35
ci_037                 4.953335e-03 3 1  ON 36
ci_038                 5.099328e-03 3 1  ON 37
ci_039                 5.306391e-03 3 1  ON 38
ci_040                 5.323078e-03 3 1  ON 39
ci_041                 4.970509e-03 3 1  ON 40
ci_042                 5.231227e-03 3 1  ON 41
ci_043                 4.943048e-03 3 1  ON 42
ci_044                 4.944186e-03 3 1  ON 43
ci_045                 3.123961e-03 3 1  ON 44
ci_046                 3.174236e-03 3 1  ON 45
ci_047                -7.790327e-04 3 1  ON 46
ci_048                -5.616837e-04 3 1  ON 47
ci_049                 1.580282e-03 3 1  ON 48
ci_050                 1.792519e-03 3 1  ON 49
ci_051                -1.106669e-03 3 1  ON 50
ci_052                -1.243295e-03 3 1  ON 51
ci_053                -2.610488e-03 3 1  ON 52
ci_054                -2.301984e-03 3 1  ON 53
ci_055                -1.483469e-03 3 1  ON 54
ci_056                -1.376722e-03 3 1  ON 55
ci_057                -1.240709e-03 3 1  ON 56
ci_058                -1.731064e-03 3 1  ON 57
ci_059                 3.171735e-04 3 1  ON 58
ci_060                 1.414898e-04 3 1  ON 59
ci_061                -3.305018e-04 3 1  ON 60
ci_062                -9.483267e-06 3 1  ON 61
ci_063                -5.232831e-04 3 1  ON 62
ci_064                -8.918607e-04 3 1  ON 63
ci_065                -2.408150e-03 3 1  ON 64
ci_066                -2.435274e-03 3 1  ON 65
ci_067                -2.101093e-03 3 1  ON 66
ci_068                -2.473574e-03 3 1  ON 67
ci_069                -2.085933e-04 3 1  ON 68
ci_070                 1.328591e-04 3 1  ON 69
ci_071                -1.874260e-03 3 1  ON 70
ci_072                -1.959434e-03 3 1  ON 71
ci_073                 5.748807e-04 3 1  ON 72
ci_074                 2.857324e-04 3 1  ON 73
ci_075                -2.910338e-04 3 1  ON 74
ci_076                -2.991017e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="250">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =8000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 50
    time step          = 0.05
    reference energy   = -22.7624
    reference variance = 0.779622
====================================================
  Execution time = 1.0115e+02
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s050
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 62500 
  VMC Eavg = -2.2669e+01
  VMC Evar = 5.1129e-01
  Total weights = 7.8208e+06
  Execution time = 1.4675e+01
  </log>
</opt>
<opt stage="main" walkers="62500">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.498016964673
                                         uncertainty =       0.001571818455

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.498016964673
                                         uncertainty =       0.001571818455

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000249504239
  error estimate for blocks of size 2^( 2) =       0.000258439447
  error estimate for blocks of size 2^( 3) =       0.000266609077
  error estimate for blocks of size 2^( 4) =       0.000272483081
  error estimate for blocks of size 2^( 5) =       0.000275851789
  error estimate for blocks of size 2^( 6) =       0.000277675242
  error estimate for blocks of size 2^( 7) =       0.000278716982
  error estimate for blocks of size 2^( 8) =       0.000279199971
  error estimate for blocks of size 2^( 9) =       0.000279391319

      target function =                  N/A
              le_mean =     -22.669409894351
             les_mean =     514.413432125842
             stat err =       0.000278745878
             autocorr =       1.248133535657
              std dev =       0.705704556887
             le_variance =       0.498018921611

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.498016976439
                                         uncertainty =       0.001571819957

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.498016976439
                                         uncertainty =       0.001571819957

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000249504242
  error estimate for blocks of size 2^( 2) =       0.000258439450
  error estimate for blocks of size 2^( 3) =       0.000266609079
  error estimate for blocks of size 2^( 4) =       0.000272483083
  error estimate for blocks of size 2^( 5) =       0.000275851791
  error estimate for blocks of size 2^( 6) =       0.000277675244
  error estimate for blocks of size 2^( 7) =       0.000278716986
  error estimate for blocks of size 2^( 8) =       0.000279199974
  error estimate for blocks of size 2^( 9) =       0.000279391323

      target function =                  N/A
              le_mean =     -22.669409894232
             les_mean =     514.413432159483
             stat err =       0.000278745882
             autocorr =       1.248133538396
              std dev =       0.705704565232
             le_variance =       0.498018933390

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.498016970556
                                         uncertainty =       0.001571819206

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.498016970556
                                         uncertainty =       0.001571819206

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000249504240
  error estimate for blocks of size 2^( 2) =       0.000258439448
  error estimate for blocks of size 2^( 3) =       0.000266609078
  error estimate for blocks of size 2^( 4) =       0.000272483082
  error estimate for blocks of size 2^( 5) =       0.000275851790
  error estimate for blocks of size 2^( 6) =       0.000277675243
  error estimate for blocks of size 2^( 7) =       0.000278716984
  error estimate for blocks of size 2^( 8) =       0.000279199972
  error estimate for blocks of size 2^( 9) =       0.000279391321

      target function =                  N/A
              le_mean =     -22.669409894291
             les_mean =     514.413432141604
             stat err =       0.000278745880
             autocorr =       1.248133537031
              std dev =       0.705704561060
             le_variance =       0.498018927500

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.498016965409
                                         uncertainty =       0.001571818549

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.498016965409
                                         uncertainty =       0.001571818549

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000249504239
  error estimate for blocks of size 2^( 2) =       0.000258439447
  error estimate for blocks of size 2^( 3) =       0.000266609077
  error estimate for blocks of size 2^( 4) =       0.000272483081
  error estimate for blocks of size 2^( 5) =       0.000275851789
  error estimate for blocks of size 2^( 6) =       0.000277675242
  error estimate for blocks of size 2^( 7) =       0.000278716982
  error estimate for blocks of size 2^( 8) =       0.000279199971
  error estimate for blocks of size 2^( 9) =       0.000279391319

      target function =                  N/A
              le_mean =     -22.669409894343
             les_mean =     514.413432127697
             stat err =       0.000278745879
             autocorr =       1.248133535798
              std dev =       0.705704557408
             le_variance =       0.498018922347


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.669409894351        initial  <--
     1.4211e+03     1.4211e+04             1.3188e-07       -22.669409894232
     5.6843e+03     5.6843e+04             3.2974e-08       -22.669409894291
     2.2737e+04     2.2737e+05             8.2436e-09       -22.669409894343

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 174.5549
  </log>
  <optVariables href="FORM.s050.opt.xml">
ci_001                -7.050617e-01 3 1  ON 0
ci_002                -7.059926e-01 3 1  ON 1
ci_003                -3.765135e-02 3 1  ON 2
ci_004                -3.890326e-02 3 1  ON 3
ci_005                 1.612441e-02 3 1  ON 4
ci_006                 1.600090e-02 3 1  ON 5
ci_007                 1.228712e-02 3 1  ON 6
ci_008                 1.246533e-02 3 1  ON 7
ci_009                -1.173869e-02 3 1  ON 8
ci_010                -1.182876e-02 3 1  ON 9
ci_011                -8.176402e-03 3 1  ON 10
ci_012                -8.138274e-03 3 1  ON 11
ci_013                 9.647127e-03 3 1  ON 12
ci_014                 9.360575e-03 3 1  ON 13
ci_015                 1.228715e-02 3 1  ON 14
ci_016                 1.255401e-02 3 1  ON 15
ci_017                 1.088299e-02 3 1  ON 16
ci_018                 1.078149e-02 3 1  ON 17
ci_019                -2.514327e-03 3 1  ON 18
ci_020                -2.423770e-03 3 1  ON 19
ci_021                -8.459776e-03 3 1  ON 20
ci_022                -8.657040e-03 3 1  ON 21
ci_023                 7.805035e-03 3 1  ON 22
ci_024                 8.041856e-03 3 1  ON 23
ci_025                 4.702654e-03 3 1  ON 24
ci_026                 4.273176e-03 3 1  ON 25
ci_027                 6.454102e-03 3 1  ON 26
ci_028                 6.476493e-03 3 1  ON 27
ci_029                -4.877824e-03 3 1  ON 28
ci_030                -4.785592e-03 3 1  ON 29
ci_031                -7.388691e-03 3 1  ON 30
ci_032                -8.123180e-03 3 1  ON 31
ci_033                 4.600634e-03 3 1  ON 32
ci_034                 4.413554e-03 3 1  ON 33
ci_035                 1.126899e-03 3 1  ON 34
ci_036                 1.043146e-03 3 1  ON 35
ci_037                 4.953341e-03 3 1  ON 36
ci_038                 5.099316e-03 3 1  ON 37
ci_039                 5.306390e-03 3 1  ON 38
ci_040                 5.323083e-03 3 1  ON 39
ci_041                 4.970501e-03 3 1  ON 40
ci_042                 5.231238e-03 3 1  ON 41
ci_043                 4.943053e-03 3 1  ON 42
ci_044                 4.944188e-03 3 1  ON 43
ci_045                 3.123986e-03 3 1  ON 44
ci_046                 3.174240e-03 3 1  ON 45
ci_047                -7.790317e-04 3 1  ON 46
ci_048                -5.616783e-04 3 1  ON 47
ci_049                 1.580280e-03 3 1  ON 48
ci_050                 1.792525e-03 3 1  ON 49
ci_051                -1.106639e-03 3 1  ON 50
ci_052                -1.243281e-03 3 1  ON 51
ci_053                -2.610467e-03 3 1  ON 52
ci_054                -2.301971e-03 3 1  ON 53
ci_055                -1.483465e-03 3 1  ON 54
ci_056                -1.376716e-03 3 1  ON 55
ci_057                -1.240700e-03 3 1  ON 56
ci_058                -1.731087e-03 3 1  ON 57
ci_059                 3.171722e-04 3 1  ON 58
ci_060                 1.414743e-04 3 1  ON 59
ci_061                -3.305059e-04 3 1  ON 60
ci_062                -9.498122e-06 3 1  ON 61
ci_063                -5.232879e-04 3 1  ON 62
ci_064                -8.918512e-04 3 1  ON 63
ci_065                -2.408140e-03 3 1  ON 64
ci_066                -2.435287e-03 3 1  ON 65
ci_067                -2.101081e-03 3 1  ON 66
ci_068                -2.473568e-03 3 1  ON 67
ci_069                -2.086065e-04 3 1  ON 68
ci_070                 1.328517e-04 3 1  ON 69
ci_071                -1.874227e-03 3 1  ON 70
ci_072                -1.959420e-03 3 1  ON 71
ci_073                 5.749120e-04 3 1  ON 72
ci_074                 2.857519e-04 3 1  ON 73
ci_075                -2.910379e-04 3 1  ON 74
ci_076                -2.991008e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 2.9365e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s051 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s051 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=51  my_counter=0
  time step      = 5.0000e-02
  blocks         = 250
  steps          = 250
  substeps       = 10
  current        = 0
  target samples = 8.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">250</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">6.2500e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">8.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">6.2500e+04</parameter>
<parameter name="steps" condition="int">250</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2663e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="250">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =8000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 51
    time step          = 0.05
    reference energy   = -22.731
    reference variance = 0.568472
====================================================
  Execution time = 1.0061e+02
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s051
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 62500 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 6.1093e+04
  VMC Eavg = -2.2670e+01
  VMC Evar = 5.1497e-01
  Total weights = 7.820796191e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.9137e+01
  </log>
</opt>
<opt stage="main" walkers="62500">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.497407737548
                                         uncertainty =       0.002119380678

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.497407737548
                                         uncertainty =       0.002119380678

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000249350960
  error estimate for blocks of size 2^( 2) =       0.000258281690
  error estimate for blocks of size 2^( 3) =       0.000266296528
  error estimate for blocks of size 2^( 4) =       0.000272096461
  error estimate for blocks of size 2^( 5) =       0.000275601341
  error estimate for blocks of size 2^( 6) =       0.000277981292
  error estimate for blocks of size 2^( 7) =       0.000278904163
  error estimate for blocks of size 2^( 8) =       0.000279115730
  error estimate for blocks of size 2^( 9) =       0.000280124882

      target function =                  N/A
              le_mean =     -22.669867041913
             les_mean =     514.437844757631
             stat err =       0.000279031517
             autocorr =       1.252230936636
              std dev =       0.705271020070
             le_variance =       0.497407211750


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266986704191e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.4211e+04, overlap shift 1.4211e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.669867041940       residual = 3.73e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.669867042035       residual = 5.01e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.669867042037       residual = 1.86e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.669867042038       residual = 6.57e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 1.4211e+04 is 1.288345e-08

solving harmonic davidson linear method for identity shift 5.6843e+04, overlap shift 5.6843e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.669867041940       residual = 3.73e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.669867041964       residual = 5.01e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.669867041964       residual = 1.87e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.669867041964       residual = 6.57e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 5.6843e+04 is 3.220882e-09

solving harmonic davidson linear method for identity shift 2.2737e+05, overlap shift 2.2737e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.669867041940       residual = 3.73e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.669867041946       residual = 5.01e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.669867041946       residual = 1.87e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.669867041946       residual = 6.57e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 2.2737e+05 is 8.052218e-10

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.104982 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.1976e+02
  </log>
  <optVariables href="FORM.s051.opt.xml">
ci_001                -7.050617e-01 3 1  ON 0
ci_002                -7.059926e-01 3 1  ON 1
ci_003                -3.765135e-02 3 1  ON 2
ci_004                -3.890326e-02 3 1  ON 3
ci_005                 1.612441e-02 3 1  ON 4
ci_006                 1.600090e-02 3 1  ON 5
ci_007                 1.228713e-02 3 1  ON 6
ci_008                 1.246533e-02 3 1  ON 7
ci_009                -1.173869e-02 3 1  ON 8
ci_010                -1.182876e-02 3 1  ON 9
ci_011                -8.176403e-03 3 1  ON 10
ci_012                -8.138276e-03 3 1  ON 11
ci_013                 9.647125e-03 3 1  ON 12
ci_014                 9.360575e-03 3 1  ON 13
ci_015                 1.228715e-02 3 1  ON 14
ci_016                 1.255401e-02 3 1  ON 15
ci_017                 1.088299e-02 3 1  ON 16
ci_018                 1.078149e-02 3 1  ON 17
ci_019                -2.514328e-03 3 1  ON 18
ci_020                -2.423771e-03 3 1  ON 19
ci_021                -8.459772e-03 3 1  ON 20
ci_022                -8.657040e-03 3 1  ON 21
ci_023                 7.805034e-03 3 1  ON 22
ci_024                 8.041856e-03 3 1  ON 23
ci_025                 4.702651e-03 3 1  ON 24
ci_026                 4.273176e-03 3 1  ON 25
ci_027                 6.454102e-03 3 1  ON 26
ci_028                 6.476493e-03 3 1  ON 27
ci_029                -4.877824e-03 3 1  ON 28
ci_030                -4.785593e-03 3 1  ON 29
ci_031                -7.388690e-03 3 1  ON 30
ci_032                -8.123178e-03 3 1  ON 31
ci_033                 4.600633e-03 3 1  ON 32
ci_034                 4.413554e-03 3 1  ON 33
ci_035                 1.126899e-03 3 1  ON 34
ci_036                 1.043147e-03 3 1  ON 35
ci_037                 4.953340e-03 3 1  ON 36
ci_038                 5.099317e-03 3 1  ON 37
ci_039                 5.306387e-03 3 1  ON 38
ci_040                 5.323081e-03 3 1  ON 39
ci_041                 4.970502e-03 3 1  ON 40
ci_042                 5.231239e-03 3 1  ON 41
ci_043                 4.943053e-03 3 1  ON 42
ci_044                 4.944185e-03 3 1  ON 43
ci_045                 3.123986e-03 3 1  ON 44
ci_046                 3.174239e-03 3 1  ON 45
ci_047                -7.790313e-04 3 1  ON 46
ci_048                -5.616788e-04 3 1  ON 47
ci_049                 1.580282e-03 3 1  ON 48
ci_050                 1.792525e-03 3 1  ON 49
ci_051                -1.106641e-03 3 1  ON 50
ci_052                -1.243281e-03 3 1  ON 51
ci_053                -2.610466e-03 3 1  ON 52
ci_054                -2.301973e-03 3 1  ON 53
ci_055                -1.483466e-03 3 1  ON 54
ci_056                -1.376716e-03 3 1  ON 55
ci_057                -1.240701e-03 3 1  ON 56
ci_058                -1.731086e-03 3 1  ON 57
ci_059                 3.171720e-04 3 1  ON 58
ci_060                 1.414736e-04 3 1  ON 59
ci_061                -3.305062e-04 3 1  ON 60
ci_062                -9.499286e-06 3 1  ON 61
ci_063                -5.232906e-04 3 1  ON 62
ci_064                -8.918499e-04 3 1  ON 63
ci_065                -2.408137e-03 3 1  ON 64
ci_066                -2.435289e-03 3 1  ON 65
ci_067                -2.101081e-03 3 1  ON 66
ci_068                -2.473567e-03 3 1  ON 67
ci_069                -2.086065e-04 3 1  ON 68
ci_070                 1.328511e-04 3 1  ON 69
ci_071                -1.874226e-03 3 1  ON 70
ci_072                -1.959420e-03 3 1  ON 71
ci_073                 5.749132e-04 3 1  ON 72
ci_074                 2.857539e-04 3 1  ON 73
ci_075                -2.910384e-04 3 1  ON 74
ci_076                -2.991018e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="250">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =8000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 51
    time step          = 0.05
    reference energy   = -22.6349
    reference variance = 0.311256
====================================================
  Execution time = 1.0166e+02
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s051
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 62500 
  VMC Eavg = -2.2669e+01
  VMC Evar = 5.0952e-01
  Total weights = 7.8211e+06
  Execution time = 1.4653e+01
  </log>
</opt>
<opt stage="main" walkers="62500">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.496880493887
                                         uncertainty =       0.001249495043

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.496880493887
                                         uncertainty =       0.001249495043

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000249219715
  error estimate for blocks of size 2^( 2) =       0.000258143507
  error estimate for blocks of size 2^( 3) =       0.000266237015
  error estimate for blocks of size 2^( 4) =       0.000271855530
  error estimate for blocks of size 2^( 5) =       0.000275243330
  error estimate for blocks of size 2^( 6) =       0.000277027636
  error estimate for blocks of size 2^( 7) =       0.000278045236
  error estimate for blocks of size 2^( 8) =       0.000279306640
  error estimate for blocks of size 2^( 9) =       0.000279196421

      target function =                  N/A
              le_mean =     -22.669492412933
             les_mean =     514.415401308060
             stat err =       0.000278393983
             autocorr =       1.247828498248
              std dev =       0.704899801968
             le_variance =       0.496883730815

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.496880491501
                                         uncertainty =       0.001249494528

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.496880491501
                                         uncertainty =       0.001249494528

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000249219714
  error estimate for blocks of size 2^( 2) =       0.000258143507
  error estimate for blocks of size 2^( 3) =       0.000266237015
  error estimate for blocks of size 2^( 4) =       0.000271855530
  error estimate for blocks of size 2^( 5) =       0.000275243330
  error estimate for blocks of size 2^( 6) =       0.000277027636
  error estimate for blocks of size 2^( 7) =       0.000278045236
  error estimate for blocks of size 2^( 8) =       0.000279306640
  error estimate for blocks of size 2^( 9) =       0.000279196421

      target function =                  N/A
              le_mean =     -22.669492412924
             les_mean =     514.415401300766
             stat err =       0.000278393983
             autocorr =       1.247828501810
              std dev =       0.704899800277
             le_variance =       0.496883728431

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.496880492694
                                         uncertainty =       0.001249494785

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.496880492694
                                         uncertainty =       0.001249494785

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000249219715
  error estimate for blocks of size 2^( 2) =       0.000258143507
  error estimate for blocks of size 2^( 3) =       0.000266237015
  error estimate for blocks of size 2^( 4) =       0.000271855530
  error estimate for blocks of size 2^( 5) =       0.000275243330
  error estimate for blocks of size 2^( 6) =       0.000277027636
  error estimate for blocks of size 2^( 7) =       0.000278045236
  error estimate for blocks of size 2^( 8) =       0.000279306640
  error estimate for blocks of size 2^( 9) =       0.000279196421

      target function =                  N/A
              le_mean =     -22.669492412929
             les_mean =     514.415401304411
             stat err =       0.000278393983
             autocorr =       1.247828500025
              std dev =       0.704899801123
             le_variance =       0.496883729624

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.496880493738
                                         uncertainty =       0.001249495011

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.496880493738
                                         uncertainty =       0.001249495011

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000249219715
  error estimate for blocks of size 2^( 2) =       0.000258143507
  error estimate for blocks of size 2^( 3) =       0.000266237015
  error estimate for blocks of size 2^( 4) =       0.000271855530
  error estimate for blocks of size 2^( 5) =       0.000275243330
  error estimate for blocks of size 2^( 6) =       0.000277027636
  error estimate for blocks of size 2^( 7) =       0.000278045236
  error estimate for blocks of size 2^( 8) =       0.000279306640
  error estimate for blocks of size 2^( 9) =       0.000279196421

      target function =                  N/A
              le_mean =     -22.669492412933
             les_mean =     514.415401307604
             stat err =       0.000278393983
             autocorr =       1.247828498483
              std dev =       0.704899801863
             le_variance =       0.496883730666


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.669492412933        initial  <--
     1.4211e+04     1.4211e+05             1.2883e-08       -22.669492412924
     5.6843e+04     5.6843e+05             3.2209e-09       -22.669492412929
     2.2737e+05     2.2737e+06             8.0522e-10       -22.669492412933

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 174.8727
  </log>
  <optVariables href="FORM.s051.opt.xml">
ci_001                -7.050617e-01 3 1  ON 0
ci_002                -7.059926e-01 3 1  ON 1
ci_003                -3.765135e-02 3 1  ON 2
ci_004                -3.890326e-02 3 1  ON 3
ci_005                 1.612441e-02 3 1  ON 4
ci_006                 1.600090e-02 3 1  ON 5
ci_007                 1.228712e-02 3 1  ON 6
ci_008                 1.246533e-02 3 1  ON 7
ci_009                -1.173869e-02 3 1  ON 8
ci_010                -1.182876e-02 3 1  ON 9
ci_011                -8.176402e-03 3 1  ON 10
ci_012                -8.138274e-03 3 1  ON 11
ci_013                 9.647127e-03 3 1  ON 12
ci_014                 9.360575e-03 3 1  ON 13
ci_015                 1.228715e-02 3 1  ON 14
ci_016                 1.255401e-02 3 1  ON 15
ci_017                 1.088299e-02 3 1  ON 16
ci_018                 1.078149e-02 3 1  ON 17
ci_019                -2.514327e-03 3 1  ON 18
ci_020                -2.423770e-03 3 1  ON 19
ci_021                -8.459776e-03 3 1  ON 20
ci_022                -8.657040e-03 3 1  ON 21
ci_023                 7.805035e-03 3 1  ON 22
ci_024                 8.041856e-03 3 1  ON 23
ci_025                 4.702654e-03 3 1  ON 24
ci_026                 4.273176e-03 3 1  ON 25
ci_027                 6.454102e-03 3 1  ON 26
ci_028                 6.476493e-03 3 1  ON 27
ci_029                -4.877824e-03 3 1  ON 28
ci_030                -4.785592e-03 3 1  ON 29
ci_031                -7.388691e-03 3 1  ON 30
ci_032                -8.123180e-03 3 1  ON 31
ci_033                 4.600634e-03 3 1  ON 32
ci_034                 4.413554e-03 3 1  ON 33
ci_035                 1.126899e-03 3 1  ON 34
ci_036                 1.043146e-03 3 1  ON 35
ci_037                 4.953341e-03 3 1  ON 36
ci_038                 5.099316e-03 3 1  ON 37
ci_039                 5.306390e-03 3 1  ON 38
ci_040                 5.323083e-03 3 1  ON 39
ci_041                 4.970501e-03 3 1  ON 40
ci_042                 5.231238e-03 3 1  ON 41
ci_043                 4.943053e-03 3 1  ON 42
ci_044                 4.944188e-03 3 1  ON 43
ci_045                 3.123986e-03 3 1  ON 44
ci_046                 3.174240e-03 3 1  ON 45
ci_047                -7.790317e-04 3 1  ON 46
ci_048                -5.616783e-04 3 1  ON 47
ci_049                 1.580280e-03 3 1  ON 48
ci_050                 1.792525e-03 3 1  ON 49
ci_051                -1.106639e-03 3 1  ON 50
ci_052                -1.243281e-03 3 1  ON 51
ci_053                -2.610467e-03 3 1  ON 52
ci_054                -2.301971e-03 3 1  ON 53
ci_055                -1.483465e-03 3 1  ON 54
ci_056                -1.376716e-03 3 1  ON 55
ci_057                -1.240700e-03 3 1  ON 56
ci_058                -1.731087e-03 3 1  ON 57
ci_059                 3.171722e-04 3 1  ON 58
ci_060                 1.414743e-04 3 1  ON 59
ci_061                -3.305059e-04 3 1  ON 60
ci_062                -9.498122e-06 3 1  ON 61
ci_063                -5.232879e-04 3 1  ON 62
ci_064                -8.918512e-04 3 1  ON 63
ci_065                -2.408140e-03 3 1  ON 64
ci_066                -2.435287e-03 3 1  ON 65
ci_067                -2.101081e-03 3 1  ON 66
ci_068                -2.473568e-03 3 1  ON 67
ci_069                -2.086065e-04 3 1  ON 68
ci_070                 1.328517e-04 3 1  ON 69
ci_071                -1.874227e-03 3 1  ON 70
ci_072                -1.959420e-03 3 1  ON 71
ci_073                 5.749120e-04 3 1  ON 72
ci_074                 2.857519e-04 3 1  ON 73
ci_075                -2.910379e-04 3 1  ON 74
ci_076                -2.991008e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 2.9470e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s052 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s052 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=52  my_counter=0
  time step      = 5.0000e-02
  blocks         = 250
  steps          = 250
  substeps       = 10
  current        = 0
  target samples = 8.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">250</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">6.2500e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">8.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">6.2500e+04</parameter>
<parameter name="steps" condition="int">250</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2663e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="250">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =8000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 52
    time step          = 0.05
    reference energy   = -22.5673
    reference variance = 0.712872
====================================================
  Execution time = 1.0050e+02
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s052
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 62500 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 6.1119e+04
  VMC Eavg = -2.2670e+01
  VMC Evar = 5.0836e-01
  Total weights = 7.820011069e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.9745e+01
  </log>
</opt>
<opt stage="main" walkers="62500">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.495761829771
                                         uncertainty =       0.001407177195

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.495761829771
                                         uncertainty =       0.001407177195

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000248938268
  error estimate for blocks of size 2^( 2) =       0.000257973845
  error estimate for blocks of size 2^( 3) =       0.000266086153
  error estimate for blocks of size 2^( 4) =       0.000272020574
  error estimate for blocks of size 2^( 5) =       0.000275735098
  error estimate for blocks of size 2^( 6) =       0.000277944828
  error estimate for blocks of size 2^( 7) =       0.000278941442
  error estimate for blocks of size 2^( 8) =       0.000278935988
  error estimate for blocks of size 2^( 9) =       0.000279443205

      target function =                  N/A
              le_mean =     -22.669634232766
             les_mean =     514.420673277592
             stat err =       0.000278816366
             autocorr =       1.254449538796
              std dev =       0.704103750267
             le_variance =       0.495762091140


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266963423277e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.4211e+05, overlap shift 1.4211e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.669634232788       residual = 3.57e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.669634232795       residual = 4.97e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.669634232795       residual = 1.82e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.669634232796       residual = 7.59e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 1.4211e+05 is 1.655903e-09

solving harmonic davidson linear method for identity shift 5.6843e+05, overlap shift 5.6843e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.669634232788       residual = 3.57e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.669634232789       residual = 4.97e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.669634232789       residual = 1.82e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.669634232789       residual = 7.59e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 5.6843e+05 is 4.139761e-10

solving harmonic davidson linear method for identity shift 2.2737e+06, overlap shift 2.2737e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.669634232788       residual = 3.57e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.669634232788       residual = 4.97e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.669634232788       residual = 1.82e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.669634232788       residual = 7.59e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 2.2737e+06 is 1.034941e-10

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.106339 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.2026e+02
  </log>
  <optVariables href="FORM.s052.opt.xml">
ci_001                -7.050617e-01 3 1  ON 0
ci_002                -7.059926e-01 3 1  ON 1
ci_003                -3.765135e-02 3 1  ON 2
ci_004                -3.890326e-02 3 1  ON 3
ci_005                 1.612441e-02 3 1  ON 4
ci_006                 1.600090e-02 3 1  ON 5
ci_007                 1.228712e-02 3 1  ON 6
ci_008                 1.246533e-02 3 1  ON 7
ci_009                -1.173869e-02 3 1  ON 8
ci_010                -1.182876e-02 3 1  ON 9
ci_011                -8.176402e-03 3 1  ON 10
ci_012                -8.138274e-03 3 1  ON 11
ci_013                 9.647127e-03 3 1  ON 12
ci_014                 9.360575e-03 3 1  ON 13
ci_015                 1.228715e-02 3 1  ON 14
ci_016                 1.255401e-02 3 1  ON 15
ci_017                 1.088299e-02 3 1  ON 16
ci_018                 1.078149e-02 3 1  ON 17
ci_019                -2.514327e-03 3 1  ON 18
ci_020                -2.423770e-03 3 1  ON 19
ci_021                -8.459775e-03 3 1  ON 20
ci_022                -8.657040e-03 3 1  ON 21
ci_023                 7.805034e-03 3 1  ON 22
ci_024                 8.041856e-03 3 1  ON 23
ci_025                 4.702654e-03 3 1  ON 24
ci_026                 4.273176e-03 3 1  ON 25
ci_027                 6.454102e-03 3 1  ON 26
ci_028                 6.476493e-03 3 1  ON 27
ci_029                -4.877824e-03 3 1  ON 28
ci_030                -4.785592e-03 3 1  ON 29
ci_031                -7.388691e-03 3 1  ON 30
ci_032                -8.123180e-03 3 1  ON 31
ci_033                 4.600634e-03 3 1  ON 32
ci_034                 4.413554e-03 3 1  ON 33
ci_035                 1.126899e-03 3 1  ON 34
ci_036                 1.043146e-03 3 1  ON 35
ci_037                 4.953341e-03 3 1  ON 36
ci_038                 5.099316e-03 3 1  ON 37
ci_039                 5.306390e-03 3 1  ON 38
ci_040                 5.323083e-03 3 1  ON 39
ci_041                 4.970501e-03 3 1  ON 40
ci_042                 5.231238e-03 3 1  ON 41
ci_043                 4.943053e-03 3 1  ON 42
ci_044                 4.944188e-03 3 1  ON 43
ci_045                 3.123986e-03 3 1  ON 44
ci_046                 3.174240e-03 3 1  ON 45
ci_047                -7.790317e-04 3 1  ON 46
ci_048                -5.616782e-04 3 1  ON 47
ci_049                 1.580281e-03 3 1  ON 48
ci_050                 1.792525e-03 3 1  ON 49
ci_051                -1.106639e-03 3 1  ON 50
ci_052                -1.243281e-03 3 1  ON 51
ci_053                -2.610467e-03 3 1  ON 52
ci_054                -2.301972e-03 3 1  ON 53
ci_055                -1.483465e-03 3 1  ON 54
ci_056                -1.376716e-03 3 1  ON 55
ci_057                -1.240700e-03 3 1  ON 56
ci_058                -1.731087e-03 3 1  ON 57
ci_059                 3.171722e-04 3 1  ON 58
ci_060                 1.414743e-04 3 1  ON 59
ci_061                -3.305059e-04 3 1  ON 60
ci_062                -9.498128e-06 3 1  ON 61
ci_063                -5.232881e-04 3 1  ON 62
ci_064                -8.918511e-04 3 1  ON 63
ci_065                -2.408140e-03 3 1  ON 64
ci_066                -2.435287e-03 3 1  ON 65
ci_067                -2.101081e-03 3 1  ON 66
ci_068                -2.473568e-03 3 1  ON 67
ci_069                -2.086067e-04 3 1  ON 68
ci_070                 1.328517e-04 3 1  ON 69
ci_071                -1.874227e-03 3 1  ON 70
ci_072                -1.959421e-03 3 1  ON 71
ci_073                 5.749119e-04 3 1  ON 72
ci_074                 2.857517e-04 3 1  ON 73
ci_075                -2.910378e-04 3 1  ON 74
ci_076                -2.991010e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="250">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =8000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 52
    time step          = 0.05
    reference energy   = -22.6412
    reference variance = 0.642398
====================================================
  Execution time = 1.0119e+02
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s052
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 62500 
  VMC Eavg = -2.2670e+01
  VMC Evar = 5.1446e-01
  Total weights = 7.8205e+06
  Execution time = 1.4638e+01
  </log>
</opt>
<opt stage="main" walkers="62500">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.499563703313
                                         uncertainty =       0.002188149333

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.499563703313
                                         uncertainty =       0.002188149333

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000249890145
  error estimate for blocks of size 2^( 2) =       0.000258849396
  error estimate for blocks of size 2^( 3) =       0.000266903672
  error estimate for blocks of size 2^( 4) =       0.000272711590
  error estimate for blocks of size 2^( 5) =       0.000276253424
  error estimate for blocks of size 2^( 6) =       0.000278061956
  error estimate for blocks of size 2^( 7) =       0.000278852538
  error estimate for blocks of size 2^( 8) =       0.000278828394
  error estimate for blocks of size 2^( 9) =       0.000280098678

      target function =                  N/A
              le_mean =     -22.669589545790
             les_mean =     514.424751195966
             stat err =       0.000278960391
             autocorr =       1.246197365472
              std dev =       0.706796064409
             le_variance =       0.499560676664

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.499563703358
                                         uncertainty =       0.002188149381

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.499563703358
                                         uncertainty =       0.002188149381

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000249890145
  error estimate for blocks of size 2^( 2) =       0.000258849396
  error estimate for blocks of size 2^( 3) =       0.000266903672
  error estimate for blocks of size 2^( 4) =       0.000272711590
  error estimate for blocks of size 2^( 5) =       0.000276253424
  error estimate for blocks of size 2^( 6) =       0.000278061956
  error estimate for blocks of size 2^( 7) =       0.000278852538
  error estimate for blocks of size 2^( 8) =       0.000278828394
  error estimate for blocks of size 2^( 9) =       0.000280098678

      target function =                  N/A
              le_mean =     -22.669589545790
             les_mean =     514.424751207719
             stat err =       0.000278960391
             autocorr =       1.246197365504
              std dev =       0.706796064441
             le_variance =       0.499560676709

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.499563703336
                                         uncertainty =       0.002188149357

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.499563703336
                                         uncertainty =       0.002188149357

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000249890145
  error estimate for blocks of size 2^( 2) =       0.000258849396
  error estimate for blocks of size 2^( 3) =       0.000266903672
  error estimate for blocks of size 2^( 4) =       0.000272711590
  error estimate for blocks of size 2^( 5) =       0.000276253424
  error estimate for blocks of size 2^( 6) =       0.000278061956
  error estimate for blocks of size 2^( 7) =       0.000278852538
  error estimate for blocks of size 2^( 8) =       0.000278828394
  error estimate for blocks of size 2^( 9) =       0.000280098678

      target function =                  N/A
              le_mean =     -22.669589545790
             les_mean =     514.424751201842
             stat err =       0.000278960391
             autocorr =       1.246197365482
              std dev =       0.706796064425
             le_variance =       0.499560676686

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.499563703316
                                         uncertainty =       0.002188149336

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.499563703316
                                         uncertainty =       0.002188149336

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000249890145
  error estimate for blocks of size 2^( 2) =       0.000258849396
  error estimate for blocks of size 2^( 3) =       0.000266903672
  error estimate for blocks of size 2^( 4) =       0.000272711590
  error estimate for blocks of size 2^( 5) =       0.000276253424
  error estimate for blocks of size 2^( 6) =       0.000278061956
  error estimate for blocks of size 2^( 7) =       0.000278852538
  error estimate for blocks of size 2^( 8) =       0.000278828394
  error estimate for blocks of size 2^( 9) =       0.000280098678

      target function =                  N/A
              le_mean =     -22.669589545790
             les_mean =     514.424751196701
             stat err =       0.000278960391
             autocorr =       1.246197365479
              std dev =       0.706796064411
             le_variance =       0.499560676667


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.669589545790        initial  <--
     1.4211e+05     1.4211e+06             1.6559e-09       -22.669589545790
     5.6843e+05     5.6843e+06             4.1398e-10       -22.669589545790
     2.2737e+06     2.2737e+07             1.0349e-10       -22.669589545790

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 174.3607
  </log>
  <optVariables href="FORM.s052.opt.xml">
ci_001                -7.050617e-01 3 1  ON 0
ci_002                -7.059926e-01 3 1  ON 1
ci_003                -3.765135e-02 3 1  ON 2
ci_004                -3.890326e-02 3 1  ON 3
ci_005                 1.612441e-02 3 1  ON 4
ci_006                 1.600090e-02 3 1  ON 5
ci_007                 1.228712e-02 3 1  ON 6
ci_008                 1.246533e-02 3 1  ON 7
ci_009                -1.173869e-02 3 1  ON 8
ci_010                -1.182876e-02 3 1  ON 9
ci_011                -8.176402e-03 3 1  ON 10
ci_012                -8.138274e-03 3 1  ON 11
ci_013                 9.647127e-03 3 1  ON 12
ci_014                 9.360575e-03 3 1  ON 13
ci_015                 1.228715e-02 3 1  ON 14
ci_016                 1.255401e-02 3 1  ON 15
ci_017                 1.088299e-02 3 1  ON 16
ci_018                 1.078149e-02 3 1  ON 17
ci_019                -2.514327e-03 3 1  ON 18
ci_020                -2.423770e-03 3 1  ON 19
ci_021                -8.459776e-03 3 1  ON 20
ci_022                -8.657040e-03 3 1  ON 21
ci_023                 7.805035e-03 3 1  ON 22
ci_024                 8.041856e-03 3 1  ON 23
ci_025                 4.702654e-03 3 1  ON 24
ci_026                 4.273176e-03 3 1  ON 25
ci_027                 6.454102e-03 3 1  ON 26
ci_028                 6.476493e-03 3 1  ON 27
ci_029                -4.877824e-03 3 1  ON 28
ci_030                -4.785592e-03 3 1  ON 29
ci_031                -7.388691e-03 3 1  ON 30
ci_032                -8.123180e-03 3 1  ON 31
ci_033                 4.600634e-03 3 1  ON 32
ci_034                 4.413554e-03 3 1  ON 33
ci_035                 1.126899e-03 3 1  ON 34
ci_036                 1.043146e-03 3 1  ON 35
ci_037                 4.953341e-03 3 1  ON 36
ci_038                 5.099316e-03 3 1  ON 37
ci_039                 5.306390e-03 3 1  ON 38
ci_040                 5.323083e-03 3 1  ON 39
ci_041                 4.970501e-03 3 1  ON 40
ci_042                 5.231238e-03 3 1  ON 41
ci_043                 4.943053e-03 3 1  ON 42
ci_044                 4.944188e-03 3 1  ON 43
ci_045                 3.123986e-03 3 1  ON 44
ci_046                 3.174240e-03 3 1  ON 45
ci_047                -7.790317e-04 3 1  ON 46
ci_048                -5.616783e-04 3 1  ON 47
ci_049                 1.580280e-03 3 1  ON 48
ci_050                 1.792525e-03 3 1  ON 49
ci_051                -1.106639e-03 3 1  ON 50
ci_052                -1.243281e-03 3 1  ON 51
ci_053                -2.610467e-03 3 1  ON 52
ci_054                -2.301971e-03 3 1  ON 53
ci_055                -1.483465e-03 3 1  ON 54
ci_056                -1.376716e-03 3 1  ON 55
ci_057                -1.240700e-03 3 1  ON 56
ci_058                -1.731087e-03 3 1  ON 57
ci_059                 3.171722e-04 3 1  ON 58
ci_060                 1.414743e-04 3 1  ON 59
ci_061                -3.305059e-04 3 1  ON 60
ci_062                -9.498122e-06 3 1  ON 61
ci_063                -5.232879e-04 3 1  ON 62
ci_064                -8.918512e-04 3 1  ON 63
ci_065                -2.408140e-03 3 1  ON 64
ci_066                -2.435287e-03 3 1  ON 65
ci_067                -2.101081e-03 3 1  ON 66
ci_068                -2.473568e-03 3 1  ON 67
ci_069                -2.086065e-04 3 1  ON 68
ci_070                 1.328517e-04 3 1  ON 69
ci_071                -1.874227e-03 3 1  ON 70
ci_072                -1.959420e-03 3 1  ON 71
ci_073                 5.749120e-04 3 1  ON 72
ci_074                 2.857519e-04 3 1  ON 73
ci_075                -2.910379e-04 3 1  ON 74
ci_076                -2.991008e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 2.9462e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s053 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s053 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=53  my_counter=0
  time step      = 5.0000e-02
  blocks         = 250
  steps          = 250
  substeps       = 10
  current        = 0
  target samples = 8.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">250</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">6.2500e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">8.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">6.2500e+04</parameter>
<parameter name="steps" condition="int">250</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2662e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="250">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =8000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 53
    time step          = 0.05
    reference energy   = -22.6205
    reference variance = 0.434774
====================================================
  Execution time = 1.0026e+02
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s053
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 62500 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 6.1170e+04
  VMC Eavg = -2.2670e+01
  VMC Evar = 5.1151e-01
  Total weights = 7.820438286e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.9104e+01
  </log>
</opt>
<opt stage="main" walkers="62500">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.497817996713
                                         uncertainty =       0.001503975888

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.497817996713
                                         uncertainty =       0.001503975888

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000249454312
  error estimate for blocks of size 2^( 2) =       0.000258435746
  error estimate for blocks of size 2^( 3) =       0.000266389238
  error estimate for blocks of size 2^( 4) =       0.000272030078
  error estimate for blocks of size 2^( 5) =       0.000275207290
  error estimate for blocks of size 2^( 6) =       0.000277005282
  error estimate for blocks of size 2^( 7) =       0.000278063296
  error estimate for blocks of size 2^( 8) =       0.000277192467
  error estimate for blocks of size 2^( 9) =       0.000278288030

      target function =                  N/A
              le_mean =     -22.669590318847
             les_mean =     514.421832737235
             stat err =       0.000277637269
             autocorr =       1.238720988067
              std dev =       0.705563342952
             le_variance =       0.497819630917


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266959031885e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.4211e+06, overlap shift 1.4211e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.669590318872       residual = 3.83e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.669590318872       residual = 4.91e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.669590318872       residual = 1.17e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.669590318872       residual = 5.02e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 1.4211e+06 is 1.517806e-10

solving harmonic davidson linear method for identity shift 5.6843e+06, overlap shift 5.6843e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.669590318872       residual = 3.83e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.669590318872       residual = 4.91e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.669590318872       residual = 1.17e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.669590319738       residual = 5.02e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 5.6843e+06 is 3.794513e-11

solving harmonic davidson linear method for identity shift 2.2737e+07, overlap shift 2.2737e+08 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.669590318872       residual = 3.83e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.669590318872       residual = 4.91e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.669590318872       residual = 1.17e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.669590318872       residual = 5.02e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 2.2737e+07 is 9.486300e-12

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.107746 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.1938e+02
  </log>
  <optVariables href="FORM.s053.opt.xml">
ci_001                -7.050617e-01 3 1  ON 0
ci_002                -7.059926e-01 3 1  ON 1
ci_003                -3.765135e-02 3 1  ON 2
ci_004                -3.890326e-02 3 1  ON 3
ci_005                 1.612441e-02 3 1  ON 4
ci_006                 1.600090e-02 3 1  ON 5
ci_007                 1.228712e-02 3 1  ON 6
ci_008                 1.246533e-02 3 1  ON 7
ci_009                -1.173869e-02 3 1  ON 8
ci_010                -1.182876e-02 3 1  ON 9
ci_011                -8.176402e-03 3 1  ON 10
ci_012                -8.138274e-03 3 1  ON 11
ci_013                 9.647127e-03 3 1  ON 12
ci_014                 9.360575e-03 3 1  ON 13
ci_015                 1.228715e-02 3 1  ON 14
ci_016                 1.255401e-02 3 1  ON 15
ci_017                 1.088299e-02 3 1  ON 16
ci_018                 1.078149e-02 3 1  ON 17
ci_019                -2.514327e-03 3 1  ON 18
ci_020                -2.423770e-03 3 1  ON 19
ci_021                -8.459776e-03 3 1  ON 20
ci_022                -8.657040e-03 3 1  ON 21
ci_023                 7.805035e-03 3 1  ON 22
ci_024                 8.041856e-03 3 1  ON 23
ci_025                 4.702654e-03 3 1  ON 24
ci_026                 4.273176e-03 3 1  ON 25
ci_027                 6.454102e-03 3 1  ON 26
ci_028                 6.476493e-03 3 1  ON 27
ci_029                -4.877824e-03 3 1  ON 28
ci_030                -4.785592e-03 3 1  ON 29
ci_031                -7.388691e-03 3 1  ON 30
ci_032                -8.123180e-03 3 1  ON 31
ci_033                 4.600634e-03 3 1  ON 32
ci_034                 4.413554e-03 3 1  ON 33
ci_035                 1.126899e-03 3 1  ON 34
ci_036                 1.043146e-03 3 1  ON 35
ci_037                 4.953341e-03 3 1  ON 36
ci_038                 5.099316e-03 3 1  ON 37
ci_039                 5.306390e-03 3 1  ON 38
ci_040                 5.323083e-03 3 1  ON 39
ci_041                 4.970501e-03 3 1  ON 40
ci_042                 5.231238e-03 3 1  ON 41
ci_043                 4.943053e-03 3 1  ON 42
ci_044                 4.944188e-03 3 1  ON 43
ci_045                 3.123986e-03 3 1  ON 44
ci_046                 3.174240e-03 3 1  ON 45
ci_047                -7.790317e-04 3 1  ON 46
ci_048                -5.616783e-04 3 1  ON 47
ci_049                 1.580280e-03 3 1  ON 48
ci_050                 1.792525e-03 3 1  ON 49
ci_051                -1.106639e-03 3 1  ON 50
ci_052                -1.243281e-03 3 1  ON 51
ci_053                -2.610467e-03 3 1  ON 52
ci_054                -2.301971e-03 3 1  ON 53
ci_055                -1.483465e-03 3 1  ON 54
ci_056                -1.376716e-03 3 1  ON 55
ci_057                -1.240700e-03 3 1  ON 56
ci_058                -1.731087e-03 3 1  ON 57
ci_059                 3.171722e-04 3 1  ON 58
ci_060                 1.414743e-04 3 1  ON 59
ci_061                -3.305059e-04 3 1  ON 60
ci_062                -9.498139e-06 3 1  ON 61
ci_063                -5.232879e-04 3 1  ON 62
ci_064                -8.918512e-04 3 1  ON 63
ci_065                -2.408140e-03 3 1  ON 64
ci_066                -2.435287e-03 3 1  ON 65
ci_067                -2.101081e-03 3 1  ON 66
ci_068                -2.473568e-03 3 1  ON 67
ci_069                -2.086065e-04 3 1  ON 68
ci_070                 1.328517e-04 3 1  ON 69
ci_071                -1.874227e-03 3 1  ON 70
ci_072                -1.959420e-03 3 1  ON 71
ci_073                 5.749120e-04 3 1  ON 72
ci_074                 2.857519e-04 3 1  ON 73
ci_075                -2.910379e-04 3 1  ON 74
ci_076                -2.991009e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="250">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =8000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 53
    time step          = 0.05
    reference energy   = -22.6512
    reference variance = 0.598946
====================================================
  Execution time = 9.9847e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s053
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 62500 
  VMC Eavg = -2.2669e+01
  VMC Evar = 5.1233e-01
  Total weights = 7.8207e+06
  Execution time = 1.5014e+01
  </log>
</opt>
<opt stage="main" walkers="62500">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.499058544141
                                         uncertainty =       0.002905114461

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.499058544141
                                         uncertainty =       0.002905114461

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000249766204
  error estimate for blocks of size 2^( 2) =       0.000258711282
  error estimate for blocks of size 2^( 3) =       0.000266635298
  error estimate for blocks of size 2^( 4) =       0.000272167099
  error estimate for blocks of size 2^( 5) =       0.000275239506
  error estimate for blocks of size 2^( 6) =       0.000276865130
  error estimate for blocks of size 2^( 7) =       0.000278257439
  error estimate for blocks of size 2^( 8) =       0.000278934098
  error estimate for blocks of size 2^( 9) =       0.000279693853

      target function =                  N/A
              le_mean =     -22.669385298747
             les_mean =     514.413355595945
             stat err =       0.000278437630
             autocorr =       1.242763563374
              std dev =       0.706445504892
             le_variance =       0.499065251382

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.499058544148
                                         uncertainty =       0.002905114461

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.499058544148
                                         uncertainty =       0.002905114461

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000249766204
  error estimate for blocks of size 2^( 2) =       0.000258711282
  error estimate for blocks of size 2^( 3) =       0.000266635298
  error estimate for blocks of size 2^( 4) =       0.000272167099
  error estimate for blocks of size 2^( 5) =       0.000275239506
  error estimate for blocks of size 2^( 6) =       0.000276865130
  error estimate for blocks of size 2^( 7) =       0.000278257439
  error estimate for blocks of size 2^( 8) =       0.000278934098
  error estimate for blocks of size 2^( 9) =       0.000279693853

      target function =                  N/A
              le_mean =     -22.669385298746
             les_mean =     514.413355595953
             stat err =       0.000278437630
             autocorr =       1.242763563362
              std dev =       0.706445504897
             le_variance =       0.499065251390

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.499058544144
                                         uncertainty =       0.002905114461

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.499058544144
                                         uncertainty =       0.002905114461

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000249766204
  error estimate for blocks of size 2^( 2) =       0.000258711282
  error estimate for blocks of size 2^( 3) =       0.000266635298
  error estimate for blocks of size 2^( 4) =       0.000272167099
  error estimate for blocks of size 2^( 5) =       0.000275239506
  error estimate for blocks of size 2^( 6) =       0.000276865130
  error estimate for blocks of size 2^( 7) =       0.000278257439
  error estimate for blocks of size 2^( 8) =       0.000278934098
  error estimate for blocks of size 2^( 9) =       0.000279693853

      target function =                  N/A
              le_mean =     -22.669385298747
             les_mean =     514.413355595949
             stat err =       0.000278437630
             autocorr =       1.242763563376
              std dev =       0.706445504895
             le_variance =       0.499065251386

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.499058544141
                                         uncertainty =       0.002905114461

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.499058544141
                                         uncertainty =       0.002905114461

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000249766204
  error estimate for blocks of size 2^( 2) =       0.000258711282
  error estimate for blocks of size 2^( 3) =       0.000266635298
  error estimate for blocks of size 2^( 4) =       0.000272167099
  error estimate for blocks of size 2^( 5) =       0.000275239506
  error estimate for blocks of size 2^( 6) =       0.000276865130
  error estimate for blocks of size 2^( 7) =       0.000278257439
  error estimate for blocks of size 2^( 8) =       0.000278934098
  error estimate for blocks of size 2^( 9) =       0.000279693853

      target function =                  N/A
              le_mean =     -22.669385298747
             les_mean =     514.413355595946
             stat err =       0.000278437630
             autocorr =       1.242763563361
              std dev =       0.706445504892
             le_variance =       0.499065251383


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.669385298747        initial  <--
     1.4211e+06     1.4211e+07             1.5178e-10       -22.669385298746
     5.6843e+06     5.6843e+07             3.7945e-11       -22.669385298747
     2.2737e+07     2.2737e+08             9.4863e-12       -22.669385298747

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 173.4731
  </log>
  <optVariables href="FORM.s053.opt.xml">
ci_001                -7.050617e-01 3 1  ON 0
ci_002                -7.059926e-01 3 1  ON 1
ci_003                -3.765135e-02 3 1  ON 2
ci_004                -3.890326e-02 3 1  ON 3
ci_005                 1.612441e-02 3 1  ON 4
ci_006                 1.600090e-02 3 1  ON 5
ci_007                 1.228712e-02 3 1  ON 6
ci_008                 1.246533e-02 3 1  ON 7
ci_009                -1.173869e-02 3 1  ON 8
ci_010                -1.182876e-02 3 1  ON 9
ci_011                -8.176402e-03 3 1  ON 10
ci_012                -8.138274e-03 3 1  ON 11
ci_013                 9.647127e-03 3 1  ON 12
ci_014                 9.360575e-03 3 1  ON 13
ci_015                 1.228715e-02 3 1  ON 14
ci_016                 1.255401e-02 3 1  ON 15
ci_017                 1.088299e-02 3 1  ON 16
ci_018                 1.078149e-02 3 1  ON 17
ci_019                -2.514327e-03 3 1  ON 18
ci_020                -2.423770e-03 3 1  ON 19
ci_021                -8.459776e-03 3 1  ON 20
ci_022                -8.657040e-03 3 1  ON 21
ci_023                 7.805035e-03 3 1  ON 22
ci_024                 8.041856e-03 3 1  ON 23
ci_025                 4.702654e-03 3 1  ON 24
ci_026                 4.273176e-03 3 1  ON 25
ci_027                 6.454102e-03 3 1  ON 26
ci_028                 6.476493e-03 3 1  ON 27
ci_029                -4.877824e-03 3 1  ON 28
ci_030                -4.785592e-03 3 1  ON 29
ci_031                -7.388691e-03 3 1  ON 30
ci_032                -8.123180e-03 3 1  ON 31
ci_033                 4.600634e-03 3 1  ON 32
ci_034                 4.413554e-03 3 1  ON 33
ci_035                 1.126899e-03 3 1  ON 34
ci_036                 1.043146e-03 3 1  ON 35
ci_037                 4.953341e-03 3 1  ON 36
ci_038                 5.099316e-03 3 1  ON 37
ci_039                 5.306390e-03 3 1  ON 38
ci_040                 5.323083e-03 3 1  ON 39
ci_041                 4.970501e-03 3 1  ON 40
ci_042                 5.231238e-03 3 1  ON 41
ci_043                 4.943053e-03 3 1  ON 42
ci_044                 4.944188e-03 3 1  ON 43
ci_045                 3.123986e-03 3 1  ON 44
ci_046                 3.174240e-03 3 1  ON 45
ci_047                -7.790317e-04 3 1  ON 46
ci_048                -5.616783e-04 3 1  ON 47
ci_049                 1.580280e-03 3 1  ON 48
ci_050                 1.792525e-03 3 1  ON 49
ci_051                -1.106639e-03 3 1  ON 50
ci_052                -1.243281e-03 3 1  ON 51
ci_053                -2.610467e-03 3 1  ON 52
ci_054                -2.301971e-03 3 1  ON 53
ci_055                -1.483465e-03 3 1  ON 54
ci_056                -1.376716e-03 3 1  ON 55
ci_057                -1.240700e-03 3 1  ON 56
ci_058                -1.731087e-03 3 1  ON 57
ci_059                 3.171722e-04 3 1  ON 58
ci_060                 1.414743e-04 3 1  ON 59
ci_061                -3.305059e-04 3 1  ON 60
ci_062                -9.498122e-06 3 1  ON 61
ci_063                -5.232879e-04 3 1  ON 62
ci_064                -8.918512e-04 3 1  ON 63
ci_065                -2.408140e-03 3 1  ON 64
ci_066                -2.435287e-03 3 1  ON 65
ci_067                -2.101081e-03 3 1  ON 66
ci_068                -2.473568e-03 3 1  ON 67
ci_069                -2.086065e-04 3 1  ON 68
ci_070                 1.328517e-04 3 1  ON 69
ci_071                -1.874227e-03 3 1  ON 70
ci_072                -1.959420e-03 3 1  ON 71
ci_073                 5.749120e-04 3 1  ON 72
ci_074                 2.857519e-04 3 1  ON 73
ci_075                -2.910379e-04 3 1  ON 74
ci_076                -2.991008e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 2.9286e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s054 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s054 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=54  my_counter=0
  time step      = 5.0000e-02
  blocks         = 250
  steps          = 250
  substeps       = 10
  current        = 0
  target samples = 8.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">250</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">6.2500e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">8.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">6.2500e+04</parameter>
<parameter name="steps" condition="int">250</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2661e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="250">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =8000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 54
    time step          = 0.05
    reference energy   = -22.7644
    reference variance = 0.36567
====================================================
  Execution time = 1.0034e+02
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s054
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 62500 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 6.1113e+04
  VMC Eavg = -2.2670e+01
  VMC Evar = 5.0993e-01
  Total weights = 7.820391863e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.9131e+01
  </log>
</opt>
<opt stage="main" walkers="62500">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.497977626914
                                         uncertainty =       0.001833392255

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.497977626914
                                         uncertainty =       0.001833392255

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000249493699
  error estimate for blocks of size 2^( 2) =       0.000258448359
  error estimate for blocks of size 2^( 3) =       0.000266650806
  error estimate for blocks of size 2^( 4) =       0.000272713493
  error estimate for blocks of size 2^( 5) =       0.000276042702
  error estimate for blocks of size 2^( 6) =       0.000277397999
  error estimate for blocks of size 2^( 7) =       0.000278213410
  error estimate for blocks of size 2^( 8) =       0.000278888825
  error estimate for blocks of size 2^( 9) =       0.000280112529

      target function =                  N/A
              le_mean =     -22.669574370058
             les_mean =     514.419536275899
             stat err =       0.000278653191
             autocorr =       1.247409006529
              std dev =       0.705674746837
             le_variance =       0.497976848323


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266957437006e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.4211e+07, overlap shift 1.4211e+08 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.669574370084       residual = 3.88e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.669574370084       residual = 3.19e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.669574370084       residual = 9.20e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 1.4211e+07 is 1.691258e-11

solving harmonic davidson linear method for identity shift 5.6843e+07, overlap shift 5.6843e+08 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.669574370084       residual = 3.88e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.669574370084       residual = 3.19e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.669574370084       residual = 9.20e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 5.6843e+07 is 4.228144e-12

solving harmonic davidson linear method for identity shift 2.2737e+08, overlap shift 2.2737e+09 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.669574370084       residual = 3.88e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.669574370084       residual = 3.19e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.669574370084       residual = 9.20e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 2.2737e+08 is 1.057036e-12

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.108837 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.1948e+02
  </log>
  <optVariables href="FORM.s054.opt.xml">
ci_001                -7.050617e-01 3 1  ON 0
ci_002                -7.059926e-01 3 1  ON 1
ci_003                -3.765135e-02 3 1  ON 2
ci_004                -3.890326e-02 3 1  ON 3
ci_005                 1.612441e-02 3 1  ON 4
ci_006                 1.600090e-02 3 1  ON 5
ci_007                 1.228712e-02 3 1  ON 6
ci_008                 1.246533e-02 3 1  ON 7
ci_009                -1.173869e-02 3 1  ON 8
ci_010                -1.182876e-02 3 1  ON 9
ci_011                -8.176402e-03 3 1  ON 10
ci_012                -8.138274e-03 3 1  ON 11
ci_013                 9.647127e-03 3 1  ON 12
ci_014                 9.360575e-03 3 1  ON 13
ci_015                 1.228715e-02 3 1  ON 14
ci_016                 1.255401e-02 3 1  ON 15
ci_017                 1.088299e-02 3 1  ON 16
ci_018                 1.078149e-02 3 1  ON 17
ci_019                -2.514327e-03 3 1  ON 18
ci_020                -2.423770e-03 3 1  ON 19
ci_021                -8.459776e-03 3 1  ON 20
ci_022                -8.657040e-03 3 1  ON 21
ci_023                 7.805035e-03 3 1  ON 22
ci_024                 8.041856e-03 3 1  ON 23
ci_025                 4.702654e-03 3 1  ON 24
ci_026                 4.273176e-03 3 1  ON 25
ci_027                 6.454102e-03 3 1  ON 26
ci_028                 6.476493e-03 3 1  ON 27
ci_029                -4.877824e-03 3 1  ON 28
ci_030                -4.785592e-03 3 1  ON 29
ci_031                -7.388691e-03 3 1  ON 30
ci_032                -8.123180e-03 3 1  ON 31
ci_033                 4.600634e-03 3 1  ON 32
ci_034                 4.413554e-03 3 1  ON 33
ci_035                 1.126899e-03 3 1  ON 34
ci_036                 1.043146e-03 3 1  ON 35
ci_037                 4.953341e-03 3 1  ON 36
ci_038                 5.099316e-03 3 1  ON 37
ci_039                 5.306390e-03 3 1  ON 38
ci_040                 5.323083e-03 3 1  ON 39
ci_041                 4.970501e-03 3 1  ON 40
ci_042                 5.231238e-03 3 1  ON 41
ci_043                 4.943053e-03 3 1  ON 42
ci_044                 4.944188e-03 3 1  ON 43
ci_045                 3.123986e-03 3 1  ON 44
ci_046                 3.174240e-03 3 1  ON 45
ci_047                -7.790317e-04 3 1  ON 46
ci_048                -5.616783e-04 3 1  ON 47
ci_049                 1.580280e-03 3 1  ON 48
ci_050                 1.792525e-03 3 1  ON 49
ci_051                -1.106639e-03 3 1  ON 50
ci_052                -1.243281e-03 3 1  ON 51
ci_053                -2.610467e-03 3 1  ON 52
ci_054                -2.301971e-03 3 1  ON 53
ci_055                -1.483465e-03 3 1  ON 54
ci_056                -1.376716e-03 3 1  ON 55
ci_057                -1.240700e-03 3 1  ON 56
ci_058                -1.731087e-03 3 1  ON 57
ci_059                 3.171722e-04 3 1  ON 58
ci_060                 1.414743e-04 3 1  ON 59
ci_061                -3.305059e-04 3 1  ON 60
ci_062                -9.498124e-06 3 1  ON 61
ci_063                -5.232879e-04 3 1  ON 62
ci_064                -8.918512e-04 3 1  ON 63
ci_065                -2.408140e-03 3 1  ON 64
ci_066                -2.435287e-03 3 1  ON 65
ci_067                -2.101081e-03 3 1  ON 66
ci_068                -2.473568e-03 3 1  ON 67
ci_069                -2.086065e-04 3 1  ON 68
ci_070                 1.328517e-04 3 1  ON 69
ci_071                -1.874227e-03 3 1  ON 70
ci_072                -1.959420e-03 3 1  ON 71
ci_073                 5.749120e-04 3 1  ON 72
ci_074                 2.857519e-04 3 1  ON 73
ci_075                -2.910379e-04 3 1  ON 74
ci_076                -2.991009e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="250">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =8000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 54
    time step          = 0.05
    reference energy   = -22.8268
    reference variance = 2.86412
====================================================
  Execution time = 9.9778e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s054
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 62500 
  VMC Eavg = -2.2669e+01
  VMC Evar = 5.0918e-01
  Total weights = 7.8203e+06
  Execution time = 1.4814e+01
  </log>
</opt>
<opt stage="main" walkers="62500">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.496673592309
                                         uncertainty =       0.002131417322

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.496673592309
                                         uncertainty =       0.002131417322

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000249166496
  error estimate for blocks of size 2^( 2) =       0.000258070226
  error estimate for blocks of size 2^( 3) =       0.000266086801
  error estimate for blocks of size 2^( 4) =       0.000271876949
  error estimate for blocks of size 2^( 5) =       0.000275124801
  error estimate for blocks of size 2^( 6) =       0.000276860379
  error estimate for blocks of size 2^( 7) =       0.000277459536
  error estimate for blocks of size 2^( 8) =       0.000278208906
  error estimate for blocks of size 2^( 9) =       0.000279385602

      target function =                  N/A
              le_mean =     -22.669407029613
             les_mean =     514.411191051469
             stat err =       0.000277978606
             autocorr =       1.244639143305
              std dev =       0.704749275542
             le_variance =       0.496671541376

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.496673592309
                                         uncertainty =       0.002131417323

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.496673592309
                                         uncertainty =       0.002131417323

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000249166496
  error estimate for blocks of size 2^( 2) =       0.000258070226
  error estimate for blocks of size 2^( 3) =       0.000266086801
  error estimate for blocks of size 2^( 4) =       0.000271876949
  error estimate for blocks of size 2^( 5) =       0.000275124801
  error estimate for blocks of size 2^( 6) =       0.000276860379
  error estimate for blocks of size 2^( 7) =       0.000277459536
  error estimate for blocks of size 2^( 8) =       0.000278208906
  error estimate for blocks of size 2^( 9) =       0.000279385602

      target function =                  N/A
              le_mean =     -22.669407029613
             les_mean =     514.411191051444
             stat err =       0.000277978606
             autocorr =       1.244639143305
              std dev =       0.704749275542
             le_variance =       0.496671541376

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.496673592308
                                         uncertainty =       0.002131417323

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.496673592308
                                         uncertainty =       0.002131417323

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000249166496
  error estimate for blocks of size 2^( 2) =       0.000258070226
  error estimate for blocks of size 2^( 3) =       0.000266086801
  error estimate for blocks of size 2^( 4) =       0.000271876949
  error estimate for blocks of size 2^( 5) =       0.000275124801
  error estimate for blocks of size 2^( 6) =       0.000276860379
  error estimate for blocks of size 2^( 7) =       0.000277459536
  error estimate for blocks of size 2^( 8) =       0.000278208906
  error estimate for blocks of size 2^( 9) =       0.000279385602

      target function =                  N/A
              le_mean =     -22.669407029613
             les_mean =     514.411191051457
             stat err =       0.000277978606
             autocorr =       1.244639143286
              std dev =       0.704749275541
             le_variance =       0.496671541376

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.496673592309
                                         uncertainty =       0.002131417322

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.496673592309
                                         uncertainty =       0.002131417322

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000249166496
  error estimate for blocks of size 2^( 2) =       0.000258070226
  error estimate for blocks of size 2^( 3) =       0.000266086801
  error estimate for blocks of size 2^( 4) =       0.000271876949
  error estimate for blocks of size 2^( 5) =       0.000275124801
  error estimate for blocks of size 2^( 6) =       0.000276860379
  error estimate for blocks of size 2^( 7) =       0.000277459536
  error estimate for blocks of size 2^( 8) =       0.000278208906
  error estimate for blocks of size 2^( 9) =       0.000279385602

      target function =                  N/A
              le_mean =     -22.669407029613
             les_mean =     514.411191051468
             stat err =       0.000277978606
             autocorr =       1.244639143319
              std dev =       0.704749275542
             le_variance =       0.496671541376


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.669407029613        initial
     1.4211e+07     1.4211e+08             1.6913e-11       -22.669407029613  <--
     5.6843e+07     5.6843e+08             4.2281e-12       -22.669407029613
     2.2737e+08     2.2737e+09             1.0570e-12       -22.669407029613

*****************************************************************************
Applying the update for shift_i =   1.4211e+07     and shift_s =   1.4211e+08
*****************************************************************************

  Execution time = 1.7319e+02
  </log>
  <optVariables href="FORM.s054.opt.xml">
ci_001                -7.050617e-01 3 1  ON 0
ci_002                -7.059926e-01 3 1  ON 1
ci_003                -3.765135e-02 3 1  ON 2
ci_004                -3.890326e-02 3 1  ON 3
ci_005                 1.612441e-02 3 1  ON 4
ci_006                 1.600090e-02 3 1  ON 5
ci_007                 1.228712e-02 3 1  ON 6
ci_008                 1.246533e-02 3 1  ON 7
ci_009                -1.173869e-02 3 1  ON 8
ci_010                -1.182876e-02 3 1  ON 9
ci_011                -8.176402e-03 3 1  ON 10
ci_012                -8.138274e-03 3 1  ON 11
ci_013                 9.647127e-03 3 1  ON 12
ci_014                 9.360575e-03 3 1  ON 13
ci_015                 1.228715e-02 3 1  ON 14
ci_016                 1.255401e-02 3 1  ON 15
ci_017                 1.088299e-02 3 1  ON 16
ci_018                 1.078149e-02 3 1  ON 17
ci_019                -2.514327e-03 3 1  ON 18
ci_020                -2.423770e-03 3 1  ON 19
ci_021                -8.459776e-03 3 1  ON 20
ci_022                -8.657040e-03 3 1  ON 21
ci_023                 7.805035e-03 3 1  ON 22
ci_024                 8.041856e-03 3 1  ON 23
ci_025                 4.702654e-03 3 1  ON 24
ci_026                 4.273176e-03 3 1  ON 25
ci_027                 6.454102e-03 3 1  ON 26
ci_028                 6.476493e-03 3 1  ON 27
ci_029                -4.877824e-03 3 1  ON 28
ci_030                -4.785592e-03 3 1  ON 29
ci_031                -7.388691e-03 3 1  ON 30
ci_032                -8.123180e-03 3 1  ON 31
ci_033                 4.600634e-03 3 1  ON 32
ci_034                 4.413554e-03 3 1  ON 33
ci_035                 1.126899e-03 3 1  ON 34
ci_036                 1.043146e-03 3 1  ON 35
ci_037                 4.953341e-03 3 1  ON 36
ci_038                 5.099316e-03 3 1  ON 37
ci_039                 5.306390e-03 3 1  ON 38
ci_040                 5.323083e-03 3 1  ON 39
ci_041                 4.970501e-03 3 1  ON 40
ci_042                 5.231238e-03 3 1  ON 41
ci_043                 4.943053e-03 3 1  ON 42
ci_044                 4.944188e-03 3 1  ON 43
ci_045                 3.123986e-03 3 1  ON 44
ci_046                 3.174240e-03 3 1  ON 45
ci_047                -7.790317e-04 3 1  ON 46
ci_048                -5.616783e-04 3 1  ON 47
ci_049                 1.580280e-03 3 1  ON 48
ci_050                 1.792525e-03 3 1  ON 49
ci_051                -1.106639e-03 3 1  ON 50
ci_052                -1.243281e-03 3 1  ON 51
ci_053                -2.610467e-03 3 1  ON 52
ci_054                -2.301971e-03 3 1  ON 53
ci_055                -1.483465e-03 3 1  ON 54
ci_056                -1.376716e-03 3 1  ON 55
ci_057                -1.240700e-03 3 1  ON 56
ci_058                -1.731087e-03 3 1  ON 57
ci_059                 3.171722e-04 3 1  ON 58
ci_060                 1.414743e-04 3 1  ON 59
ci_061                -3.305059e-04 3 1  ON 60
ci_062                -9.498129e-06 3 1  ON 61
ci_063                -5.232879e-04 3 1  ON 62
ci_064                -8.918512e-04 3 1  ON 63
ci_065                -2.408140e-03 3 1  ON 64
ci_066                -2.435287e-03 3 1  ON 65
ci_067                -2.101081e-03 3 1  ON 66
ci_068                -2.473568e-03 3 1  ON 67
ci_069                -2.086065e-04 3 1  ON 68
ci_070                 1.328517e-04 3 1  ON 69
ci_071                -1.874227e-03 3 1  ON 70
ci_072                -1.959420e-03 3 1  ON 71
ci_073                 5.749120e-04 3 1  ON 72
ci_074                 2.857519e-04 3 1  ON 73
ci_075                -2.910379e-04 3 1  ON 74
ci_076                -2.991009e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 2.9269e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s055 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s055 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=55  my_counter=0
  time step      = 5.0000e-02
  blocks         = 250
  steps          = 250
  substeps       = 10
  current        = 0
  target samples = 8.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">250</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">6.2500e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">8.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">6.2500e+04</parameter>
<parameter name="steps" condition="int">250</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2664e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="250">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =8000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 55
    time step          = 0.05
    reference energy   = -22.6559
    reference variance = 0.373598
====================================================
  Execution time = 1.0024e+02
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s055
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 62500 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 6.1128e+04
  VMC Eavg = -2.2670e+01
  VMC Evar = 5.0763e-01
  Total weights = 7.820459220e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.9031e+01
  </log>
</opt>
<opt stage="main" walkers="62500">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.495522565777
                                         uncertainty =       0.001584822448

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.495522565777
                                         uncertainty =       0.001584822448

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000248877810
  error estimate for blocks of size 2^( 2) =       0.000257794541
  error estimate for blocks of size 2^( 3) =       0.000265845835
  error estimate for blocks of size 2^( 4) =       0.000271730783
  error estimate for blocks of size 2^( 5) =       0.000274770616
  error estimate for blocks of size 2^( 6) =       0.000275921208
  error estimate for blocks of size 2^( 7) =       0.000277138066
  error estimate for blocks of size 2^( 8) =       0.000278104043
  error estimate for blocks of size 2^( 9) =       0.000278678624

      target function =                  N/A
              le_mean =     -22.669827850785
             les_mean =     514.428720121145
             stat err =       0.000277460485
             autocorr =       1.242882091899
              std dev =       0.703932748077
             le_variance =       0.495521313815


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266982785079e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.5527e+06, overlap shift 3.5527e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.669827850809       residual = 2.62e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.669827850809       residual = 4.01e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.669827850809       residual = 8.67e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 3.5527e+06 is 4.450655e-11

solving harmonic davidson linear method for identity shift 1.4211e+07, overlap shift 1.4211e+08 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.669827850809       residual = 2.62e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.669827850809       residual = 4.01e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.669827850809       residual = 8.67e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 1.4211e+07 is 1.112664e-11

solving harmonic davidson linear method for identity shift 5.6843e+07, overlap shift 5.6843e+08 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.669827850809       residual = 2.62e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.669827850809       residual = 4.01e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.669827850809       residual = 8.67e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 5.6843e+07 is 2.781660e-12

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.109930 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.1929e+02
  </log>
  <optVariables href="FORM.s055.opt.xml">
ci_001                -7.050617e-01 3 1  ON 0
ci_002                -7.059926e-01 3 1  ON 1
ci_003                -3.765135e-02 3 1  ON 2
ci_004                -3.890326e-02 3 1  ON 3
ci_005                 1.612441e-02 3 1  ON 4
ci_006                 1.600090e-02 3 1  ON 5
ci_007                 1.228712e-02 3 1  ON 6
ci_008                 1.246533e-02 3 1  ON 7
ci_009                -1.173869e-02 3 1  ON 8
ci_010                -1.182876e-02 3 1  ON 9
ci_011                -8.176402e-03 3 1  ON 10
ci_012                -8.138274e-03 3 1  ON 11
ci_013                 9.647127e-03 3 1  ON 12
ci_014                 9.360575e-03 3 1  ON 13
ci_015                 1.228715e-02 3 1  ON 14
ci_016                 1.255401e-02 3 1  ON 15
ci_017                 1.088299e-02 3 1  ON 16
ci_018                 1.078149e-02 3 1  ON 17
ci_019                -2.514327e-03 3 1  ON 18
ci_020                -2.423770e-03 3 1  ON 19
ci_021                -8.459776e-03 3 1  ON 20
ci_022                -8.657040e-03 3 1  ON 21
ci_023                 7.805035e-03 3 1  ON 22
ci_024                 8.041856e-03 3 1  ON 23
ci_025                 4.702654e-03 3 1  ON 24
ci_026                 4.273176e-03 3 1  ON 25
ci_027                 6.454102e-03 3 1  ON 26
ci_028                 6.476493e-03 3 1  ON 27
ci_029                -4.877824e-03 3 1  ON 28
ci_030                -4.785592e-03 3 1  ON 29
ci_031                -7.388691e-03 3 1  ON 30
ci_032                -8.123180e-03 3 1  ON 31
ci_033                 4.600634e-03 3 1  ON 32
ci_034                 4.413554e-03 3 1  ON 33
ci_035                 1.126899e-03 3 1  ON 34
ci_036                 1.043146e-03 3 1  ON 35
ci_037                 4.953341e-03 3 1  ON 36
ci_038                 5.099316e-03 3 1  ON 37
ci_039                 5.306390e-03 3 1  ON 38
ci_040                 5.323083e-03 3 1  ON 39
ci_041                 4.970501e-03 3 1  ON 40
ci_042                 5.231238e-03 3 1  ON 41
ci_043                 4.943053e-03 3 1  ON 42
ci_044                 4.944188e-03 3 1  ON 43
ci_045                 3.123986e-03 3 1  ON 44
ci_046                 3.174240e-03 3 1  ON 45
ci_047                -7.790317e-04 3 1  ON 46
ci_048                -5.616783e-04 3 1  ON 47
ci_049                 1.580280e-03 3 1  ON 48
ci_050                 1.792525e-03 3 1  ON 49
ci_051                -1.106639e-03 3 1  ON 50
ci_052                -1.243281e-03 3 1  ON 51
ci_053                -2.610467e-03 3 1  ON 52
ci_054                -2.301971e-03 3 1  ON 53
ci_055                -1.483465e-03 3 1  ON 54
ci_056                -1.376716e-03 3 1  ON 55
ci_057                -1.240700e-03 3 1  ON 56
ci_058                -1.731087e-03 3 1  ON 57
ci_059                 3.171722e-04 3 1  ON 58
ci_060                 1.414743e-04 3 1  ON 59
ci_061                -3.305059e-04 3 1  ON 60
ci_062                -9.498130e-06 3 1  ON 61
ci_063                -5.232879e-04 3 1  ON 62
ci_064                -8.918512e-04 3 1  ON 63
ci_065                -2.408140e-03 3 1  ON 64
ci_066                -2.435287e-03 3 1  ON 65
ci_067                -2.101081e-03 3 1  ON 66
ci_068                -2.473568e-03 3 1  ON 67
ci_069                -2.086065e-04 3 1  ON 68
ci_070                 1.328517e-04 3 1  ON 69
ci_071                -1.874227e-03 3 1  ON 70
ci_072                -1.959420e-03 3 1  ON 71
ci_073                 5.749120e-04 3 1  ON 72
ci_074                 2.857519e-04 3 1  ON 73
ci_075                -2.910379e-04 3 1  ON 74
ci_076                -2.991009e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="250">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =8000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 55
    time step          = 0.05
    reference energy   = -22.6739
    reference variance = 0.317825
====================================================
  Execution time = 1.0033e+02
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s055
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 62500 
  VMC Eavg = -2.2669e+01
  VMC Evar = 5.0987e-01
  Total weights = 7.8200e+06
  Execution time = 1.4603e+01
  </log>
</opt>
<opt stage="main" walkers="62500">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.496050510797
                                         uncertainty =       0.001493598924

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.496050510797
                                         uncertainty =       0.001493598924

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000249010277
  error estimate for blocks of size 2^( 2) =       0.000257917631
  error estimate for blocks of size 2^( 3) =       0.000265917043
  error estimate for blocks of size 2^( 4) =       0.000271942272
  error estimate for blocks of size 2^( 5) =       0.000275305207
  error estimate for blocks of size 2^( 6) =       0.000276812862
  error estimate for blocks of size 2^( 7) =       0.000277895743
  error estimate for blocks of size 2^( 8) =       0.000279441659
  error estimate for blocks of size 2^( 9) =       0.000280040007

      target function =                  N/A
              le_mean =     -22.669488047774
             les_mean =     514.415560638224
             stat err =       0.000278547568
             autocorr =       1.251307932213
              std dev =       0.704307422241
             le_variance =       0.496048945023

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.496050510793
                                         uncertainty =       0.001493598924

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.496050510793
                                         uncertainty =       0.001493598924

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000249010277
  error estimate for blocks of size 2^( 2) =       0.000257917631
  error estimate for blocks of size 2^( 3) =       0.000265917043
  error estimate for blocks of size 2^( 4) =       0.000271942272
  error estimate for blocks of size 2^( 5) =       0.000275305207
  error estimate for blocks of size 2^( 6) =       0.000276812862
  error estimate for blocks of size 2^( 7) =       0.000277895743
  error estimate for blocks of size 2^( 8) =       0.000279441659
  error estimate for blocks of size 2^( 9) =       0.000280040007

      target function =                  N/A
              le_mean =     -22.669488047774
             les_mean =     514.415560637963
             stat err =       0.000278547568
             autocorr =       1.251307932245
              std dev =       0.704307422238
             le_variance =       0.496048945020

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.496050510795
                                         uncertainty =       0.001493598924

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.496050510795
                                         uncertainty =       0.001493598924

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000249010277
  error estimate for blocks of size 2^( 2) =       0.000257917631
  error estimate for blocks of size 2^( 3) =       0.000265917043
  error estimate for blocks of size 2^( 4) =       0.000271942272
  error estimate for blocks of size 2^( 5) =       0.000275305207
  error estimate for blocks of size 2^( 6) =       0.000276812862
  error estimate for blocks of size 2^( 7) =       0.000277895743
  error estimate for blocks of size 2^( 8) =       0.000279441659
  error estimate for blocks of size 2^( 9) =       0.000280040007

      target function =                  N/A
              le_mean =     -22.669488047774
             les_mean =     514.415560638094
             stat err =       0.000278547568
             autocorr =       1.251307932261
              std dev =       0.704307422240
             le_variance =       0.496048945022

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.496050510797
                                         uncertainty =       0.001493598924

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.496050510797
                                         uncertainty =       0.001493598924

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000249010277
  error estimate for blocks of size 2^( 2) =       0.000257917631
  error estimate for blocks of size 2^( 3) =       0.000265917043
  error estimate for blocks of size 2^( 4) =       0.000271942272
  error estimate for blocks of size 2^( 5) =       0.000275305207
  error estimate for blocks of size 2^( 6) =       0.000276812862
  error estimate for blocks of size 2^( 7) =       0.000277895743
  error estimate for blocks of size 2^( 8) =       0.000279441659
  error estimate for blocks of size 2^( 9) =       0.000280040007

      target function =                  N/A
              le_mean =     -22.669488047774
             les_mean =     514.415560638208
             stat err =       0.000278547568
             autocorr =       1.251307932235
              std dev =       0.704307422241
             le_variance =       0.496048945023


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.669488047774        initial
     3.5527e+06     3.5527e+07             4.4507e-11       -22.669488047774  <--
     1.4211e+07     1.4211e+08             1.1127e-11       -22.669488047774
     5.6843e+07     5.6843e+08             2.7817e-12       -22.669488047774

*****************************************************************************
Applying the update for shift_i =   3.5527e+06     and shift_s =   3.5527e+07
*****************************************************************************

  Execution time = 1.7362e+02
  </log>
  <optVariables href="FORM.s055.opt.xml">
ci_001                -7.050617e-01 3 1  ON 0
ci_002                -7.059926e-01 3 1  ON 1
ci_003                -3.765135e-02 3 1  ON 2
ci_004                -3.890326e-02 3 1  ON 3
ci_005                 1.612441e-02 3 1  ON 4
ci_006                 1.600090e-02 3 1  ON 5
ci_007                 1.228712e-02 3 1  ON 6
ci_008                 1.246533e-02 3 1  ON 7
ci_009                -1.173869e-02 3 1  ON 8
ci_010                -1.182876e-02 3 1  ON 9
ci_011                -8.176402e-03 3 1  ON 10
ci_012                -8.138274e-03 3 1  ON 11
ci_013                 9.647127e-03 3 1  ON 12
ci_014                 9.360575e-03 3 1  ON 13
ci_015                 1.228715e-02 3 1  ON 14
ci_016                 1.255401e-02 3 1  ON 15
ci_017                 1.088299e-02 3 1  ON 16
ci_018                 1.078149e-02 3 1  ON 17
ci_019                -2.514327e-03 3 1  ON 18
ci_020                -2.423770e-03 3 1  ON 19
ci_021                -8.459776e-03 3 1  ON 20
ci_022                -8.657040e-03 3 1  ON 21
ci_023                 7.805035e-03 3 1  ON 22
ci_024                 8.041856e-03 3 1  ON 23
ci_025                 4.702654e-03 3 1  ON 24
ci_026                 4.273176e-03 3 1  ON 25
ci_027                 6.454102e-03 3 1  ON 26
ci_028                 6.476493e-03 3 1  ON 27
ci_029                -4.877824e-03 3 1  ON 28
ci_030                -4.785592e-03 3 1  ON 29
ci_031                -7.388691e-03 3 1  ON 30
ci_032                -8.123180e-03 3 1  ON 31
ci_033                 4.600634e-03 3 1  ON 32
ci_034                 4.413554e-03 3 1  ON 33
ci_035                 1.126899e-03 3 1  ON 34
ci_036                 1.043146e-03 3 1  ON 35
ci_037                 4.953341e-03 3 1  ON 36
ci_038                 5.099316e-03 3 1  ON 37
ci_039                 5.306390e-03 3 1  ON 38
ci_040                 5.323083e-03 3 1  ON 39
ci_041                 4.970501e-03 3 1  ON 40
ci_042                 5.231238e-03 3 1  ON 41
ci_043                 4.943053e-03 3 1  ON 42
ci_044                 4.944188e-03 3 1  ON 43
ci_045                 3.123986e-03 3 1  ON 44
ci_046                 3.174240e-03 3 1  ON 45
ci_047                -7.790317e-04 3 1  ON 46
ci_048                -5.616783e-04 3 1  ON 47
ci_049                 1.580280e-03 3 1  ON 48
ci_050                 1.792525e-03 3 1  ON 49
ci_051                -1.106639e-03 3 1  ON 50
ci_052                -1.243281e-03 3 1  ON 51
ci_053                -2.610467e-03 3 1  ON 52
ci_054                -2.301971e-03 3 1  ON 53
ci_055                -1.483465e-03 3 1  ON 54
ci_056                -1.376716e-03 3 1  ON 55
ci_057                -1.240700e-03 3 1  ON 56
ci_058                -1.731087e-03 3 1  ON 57
ci_059                 3.171722e-04 3 1  ON 58
ci_060                 1.414743e-04 3 1  ON 59
ci_061                -3.305059e-04 3 1  ON 60
ci_062                -9.498133e-06 3 1  ON 61
ci_063                -5.232879e-04 3 1  ON 62
ci_064                -8.918512e-04 3 1  ON 63
ci_065                -2.408140e-03 3 1  ON 64
ci_066                -2.435287e-03 3 1  ON 65
ci_067                -2.101081e-03 3 1  ON 66
ci_068                -2.473568e-03 3 1  ON 67
ci_069                -2.086065e-04 3 1  ON 68
ci_070                 1.328517e-04 3 1  ON 69
ci_071                -1.874227e-03 3 1  ON 70
ci_072                -1.959420e-03 3 1  ON 71
ci_073                 5.749119e-04 3 1  ON 72
ci_074                 2.857519e-04 3 1  ON 73
ci_075                -2.910379e-04 3 1  ON 74
ci_076                -2.991008e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 2.9295e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s056 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s056 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=56  my_counter=0
  time step      = 5.0000e-02
  blocks         = 250
  steps          = 250
  substeps       = 10
  current        = 0
  target samples = 8.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">250</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">6.2500e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">8.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">6.2500e+04</parameter>
<parameter name="steps" condition="int">250</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2664e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="250">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =8000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 56
    time step          = 0.05
    reference energy   = -22.7044
    reference variance = 0.598581
====================================================
  Execution time = 1.0074e+02
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s056
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 62500 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 6.1093e+04
  VMC Eavg = -2.2670e+01
  VMC Evar = 5.1143e-01
  Total weights = 7.820327953e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.9064e+01
  </log>
</opt>
<opt stage="main" walkers="62500">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.498686130960
                                         uncertainty =       0.001795171451

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.498686130960
                                         uncertainty =       0.001795171451

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000249672115
  error estimate for blocks of size 2^( 2) =       0.000258582110
  error estimate for blocks of size 2^( 3) =       0.000266658524
  error estimate for blocks of size 2^( 4) =       0.000272518252
  error estimate for blocks of size 2^( 5) =       0.000275671805
  error estimate for blocks of size 2^( 6) =       0.000277400819
  error estimate for blocks of size 2^( 7) =       0.000278184018
  error estimate for blocks of size 2^( 8) =       0.000278278066
  error estimate for blocks of size 2^( 9) =       0.000278614781

      target function =                  N/A
              le_mean =     -22.669762059139
             les_mean =     514.429539155596
             stat err =       0.000278119421
             autocorr =       1.240859337883
              std dev =       0.706179381738
             le_variance =       0.498689319191


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266976205914e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 8.8818e+05, overlap shift 8.8818e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.669762059159       residual = 3.87e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.669762059159       residual = 4.75e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.669762059159       residual = 1.26e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.669762059114       residual = 4.64e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 8.8818e+05 is 2.430769e-10

solving harmonic davidson linear method for identity shift 3.5527e+06, overlap shift 3.5527e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.669762059159       residual = 3.87e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.669762059159       residual = 4.75e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.669762059159       residual = 1.26e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.669762059159       residual = 4.64e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 3.5527e+06 is 6.076923e-11

solving harmonic davidson linear method for identity shift 1.4211e+07, overlap shift 1.4211e+08 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.669762059159       residual = 3.87e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.669762059159       residual = 4.75e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.669762059159       residual = 1.26e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.669762059128       residual = 4.64e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 1.4211e+07 is 1.519229e-11

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.111276 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.1982e+02
  </log>
  <optVariables href="FORM.s056.opt.xml">
ci_001                -7.050617e-01 3 1  ON 0
ci_002                -7.059926e-01 3 1  ON 1
ci_003                -3.765135e-02 3 1  ON 2
ci_004                -3.890326e-02 3 1  ON 3
ci_005                 1.612441e-02 3 1  ON 4
ci_006                 1.600090e-02 3 1  ON 5
ci_007                 1.228712e-02 3 1  ON 6
ci_008                 1.246533e-02 3 1  ON 7
ci_009                -1.173869e-02 3 1  ON 8
ci_010                -1.182876e-02 3 1  ON 9
ci_011                -8.176402e-03 3 1  ON 10
ci_012                -8.138274e-03 3 1  ON 11
ci_013                 9.647127e-03 3 1  ON 12
ci_014                 9.360575e-03 3 1  ON 13
ci_015                 1.228715e-02 3 1  ON 14
ci_016                 1.255401e-02 3 1  ON 15
ci_017                 1.088299e-02 3 1  ON 16
ci_018                 1.078149e-02 3 1  ON 17
ci_019                -2.514327e-03 3 1  ON 18
ci_020                -2.423770e-03 3 1  ON 19
ci_021                -8.459776e-03 3 1  ON 20
ci_022                -8.657040e-03 3 1  ON 21
ci_023                 7.805035e-03 3 1  ON 22
ci_024                 8.041856e-03 3 1  ON 23
ci_025                 4.702654e-03 3 1  ON 24
ci_026                 4.273176e-03 3 1  ON 25
ci_027                 6.454102e-03 3 1  ON 26
ci_028                 6.476493e-03 3 1  ON 27
ci_029                -4.877824e-03 3 1  ON 28
ci_030                -4.785592e-03 3 1  ON 29
ci_031                -7.388691e-03 3 1  ON 30
ci_032                -8.123180e-03 3 1  ON 31
ci_033                 4.600634e-03 3 1  ON 32
ci_034                 4.413554e-03 3 1  ON 33
ci_035                 1.126899e-03 3 1  ON 34
ci_036                 1.043146e-03 3 1  ON 35
ci_037                 4.953341e-03 3 1  ON 36
ci_038                 5.099316e-03 3 1  ON 37
ci_039                 5.306390e-03 3 1  ON 38
ci_040                 5.323083e-03 3 1  ON 39
ci_041                 4.970501e-03 3 1  ON 40
ci_042                 5.231238e-03 3 1  ON 41
ci_043                 4.943053e-03 3 1  ON 42
ci_044                 4.944188e-03 3 1  ON 43
ci_045                 3.123986e-03 3 1  ON 44
ci_046                 3.174240e-03 3 1  ON 45
ci_047                -7.790317e-04 3 1  ON 46
ci_048                -5.616783e-04 3 1  ON 47
ci_049                 1.580280e-03 3 1  ON 48
ci_050                 1.792525e-03 3 1  ON 49
ci_051                -1.106639e-03 3 1  ON 50
ci_052                -1.243281e-03 3 1  ON 51
ci_053                -2.610467e-03 3 1  ON 52
ci_054                -2.301971e-03 3 1  ON 53
ci_055                -1.483465e-03 3 1  ON 54
ci_056                -1.376716e-03 3 1  ON 55
ci_057                -1.240700e-03 3 1  ON 56
ci_058                -1.731087e-03 3 1  ON 57
ci_059                 3.171722e-04 3 1  ON 58
ci_060                 1.414743e-04 3 1  ON 59
ci_061                -3.305060e-04 3 1  ON 60
ci_062                -9.498142e-06 3 1  ON 61
ci_063                -5.232879e-04 3 1  ON 62
ci_064                -8.918512e-04 3 1  ON 63
ci_065                -2.408140e-03 3 1  ON 64
ci_066                -2.435287e-03 3 1  ON 65
ci_067                -2.101081e-03 3 1  ON 66
ci_068                -2.473568e-03 3 1  ON 67
ci_069                -2.086064e-04 3 1  ON 68
ci_070                 1.328517e-04 3 1  ON 69
ci_071                -1.874227e-03 3 1  ON 70
ci_072                -1.959420e-03 3 1  ON 71
ci_073                 5.749119e-04 3 1  ON 72
ci_074                 2.857519e-04 3 1  ON 73
ci_075                -2.910379e-04 3 1  ON 74
ci_076                -2.991009e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="250">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =8000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 56
    time step          = 0.05
    reference energy   = -22.6231
    reference variance = 0.382408
====================================================
  Execution time = 1.0019e+02
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s056
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 62500 
  VMC Eavg = -2.2670e+01
  VMC Evar = 5.0680e-01
  Total weights = 7.8208e+06
  Execution time = 1.4688e+01
  </log>
</opt>
<opt stage="main" walkers="62500">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.494456487451
                                         uncertainty =       0.001483477384

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.494456487451
                                         uncertainty =       0.001483477384

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000248609809
  error estimate for blocks of size 2^( 2) =       0.000257527676
  error estimate for blocks of size 2^( 3) =       0.000265507257
  error estimate for blocks of size 2^( 4) =       0.000271321680
  error estimate for blocks of size 2^( 5) =       0.000274821353
  error estimate for blocks of size 2^( 6) =       0.000276918449
  error estimate for blocks of size 2^( 7) =       0.000277909845
  error estimate for blocks of size 2^( 8) =       0.000278733588
  error estimate for blocks of size 2^( 9) =       0.000281187009

      target function =                  N/A
              le_mean =     -22.669597286354
             les_mean =     514.417445726777
             stat err =       0.000278687223
             autocorr =       1.256601560065
              std dev =       0.703174728147
             le_variance =       0.494454698304

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.494456487431
                                         uncertainty =       0.001483477382

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.494456487431
                                         uncertainty =       0.001483477382

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000248609809
  error estimate for blocks of size 2^( 2) =       0.000257527676
  error estimate for blocks of size 2^( 3) =       0.000265507257
  error estimate for blocks of size 2^( 4) =       0.000271321680
  error estimate for blocks of size 2^( 5) =       0.000274821353
  error estimate for blocks of size 2^( 6) =       0.000276918449
  error estimate for blocks of size 2^( 7) =       0.000277909845
  error estimate for blocks of size 2^( 8) =       0.000278733588
  error estimate for blocks of size 2^( 9) =       0.000281187009

      target function =                  N/A
              le_mean =     -22.669597286355
             les_mean =     514.417445727312
             stat err =       0.000278687223
             autocorr =       1.256601560123
              std dev =       0.703174728133
             le_variance =       0.494454698285

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.494456487441
                                         uncertainty =       0.001483477383

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.494456487441
                                         uncertainty =       0.001483477383

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000248609809
  error estimate for blocks of size 2^( 2) =       0.000257527676
  error estimate for blocks of size 2^( 3) =       0.000265507257
  error estimate for blocks of size 2^( 4) =       0.000271321680
  error estimate for blocks of size 2^( 5) =       0.000274821353
  error estimate for blocks of size 2^( 6) =       0.000276918449
  error estimate for blocks of size 2^( 7) =       0.000277909845
  error estimate for blocks of size 2^( 8) =       0.000278733588
  error estimate for blocks of size 2^( 9) =       0.000281187009

      target function =                  N/A
              le_mean =     -22.669597286354
             les_mean =     514.417445727045
             stat err =       0.000278687223
             autocorr =       1.256601560093
              std dev =       0.703174728139
             le_variance =       0.494454698294

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.494456487450
                                         uncertainty =       0.001483477384

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.494456487450
                                         uncertainty =       0.001483477384

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000248609809
  error estimate for blocks of size 2^( 2) =       0.000257527676
  error estimate for blocks of size 2^( 3) =       0.000265507257
  error estimate for blocks of size 2^( 4) =       0.000271321680
  error estimate for blocks of size 2^( 5) =       0.000274821353
  error estimate for blocks of size 2^( 6) =       0.000276918449
  error estimate for blocks of size 2^( 7) =       0.000277909845
  error estimate for blocks of size 2^( 8) =       0.000278733588
  error estimate for blocks of size 2^( 9) =       0.000281187009

      target function =                  N/A
              le_mean =     -22.669597286354
             les_mean =     514.417445726810
             stat err =       0.000278687223
             autocorr =       1.256601560094
              std dev =       0.703174728146
             le_variance =       0.494454698303


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.669597286354        initial
     8.8818e+05     8.8818e+06             2.4308e-10       -22.669597286355  <--
     3.5527e+06     3.5527e+07             6.0769e-11       -22.669597286354
     1.4211e+07     1.4211e+08             1.5192e-11       -22.669597286354

*****************************************************************************
Applying the update for shift_i =   8.8818e+05     and shift_s =   8.8818e+06
*****************************************************************************

  Execution time = 1.7375e+02
  </log>
  <optVariables href="FORM.s056.opt.xml">
ci_001                -7.050617e-01 3 1  ON 0
ci_002                -7.059926e-01 3 1  ON 1
ci_003                -3.765135e-02 3 1  ON 2
ci_004                -3.890326e-02 3 1  ON 3
ci_005                 1.612441e-02 3 1  ON 4
ci_006                 1.600090e-02 3 1  ON 5
ci_007                 1.228712e-02 3 1  ON 6
ci_008                 1.246533e-02 3 1  ON 7
ci_009                -1.173869e-02 3 1  ON 8
ci_010                -1.182876e-02 3 1  ON 9
ci_011                -8.176402e-03 3 1  ON 10
ci_012                -8.138274e-03 3 1  ON 11
ci_013                 9.647126e-03 3 1  ON 12
ci_014                 9.360575e-03 3 1  ON 13
ci_015                 1.228715e-02 3 1  ON 14
ci_016                 1.255401e-02 3 1  ON 15
ci_017                 1.088299e-02 3 1  ON 16
ci_018                 1.078149e-02 3 1  ON 17
ci_019                -2.514327e-03 3 1  ON 18
ci_020                -2.423770e-03 3 1  ON 19
ci_021                -8.459776e-03 3 1  ON 20
ci_022                -8.657040e-03 3 1  ON 21
ci_023                 7.805035e-03 3 1  ON 22
ci_024                 8.041856e-03 3 1  ON 23
ci_025                 4.702654e-03 3 1  ON 24
ci_026                 4.273176e-03 3 1  ON 25
ci_027                 6.454101e-03 3 1  ON 26
ci_028                 6.476493e-03 3 1  ON 27
ci_029                -4.877824e-03 3 1  ON 28
ci_030                -4.785592e-03 3 1  ON 29
ci_031                -7.388691e-03 3 1  ON 30
ci_032                -8.123180e-03 3 1  ON 31
ci_033                 4.600634e-03 3 1  ON 32
ci_034                 4.413554e-03 3 1  ON 33
ci_035                 1.126899e-03 3 1  ON 34
ci_036                 1.043146e-03 3 1  ON 35
ci_037                 4.953341e-03 3 1  ON 36
ci_038                 5.099316e-03 3 1  ON 37
ci_039                 5.306390e-03 3 1  ON 38
ci_040                 5.323084e-03 3 1  ON 39
ci_041                 4.970501e-03 3 1  ON 40
ci_042                 5.231238e-03 3 1  ON 41
ci_043                 4.943053e-03 3 1  ON 42
ci_044                 4.944188e-03 3 1  ON 43
ci_045                 3.123985e-03 3 1  ON 44
ci_046                 3.174240e-03 3 1  ON 45
ci_047                -7.790316e-04 3 1  ON 46
ci_048                -5.616782e-04 3 1  ON 47
ci_049                 1.580280e-03 3 1  ON 48
ci_050                 1.792525e-03 3 1  ON 49
ci_051                -1.106639e-03 3 1  ON 50
ci_052                -1.243282e-03 3 1  ON 51
ci_053                -2.610467e-03 3 1  ON 52
ci_054                -2.301971e-03 3 1  ON 53
ci_055                -1.483465e-03 3 1  ON 54
ci_056                -1.376716e-03 3 1  ON 55
ci_057                -1.240700e-03 3 1  ON 56
ci_058                -1.731087e-03 3 1  ON 57
ci_059                 3.171723e-04 3 1  ON 58
ci_060                 1.414743e-04 3 1  ON 59
ci_061                -3.305060e-04 3 1  ON 60
ci_062                -9.498172e-06 3 1  ON 61
ci_063                -5.232879e-04 3 1  ON 62
ci_064                -8.918512e-04 3 1  ON 63
ci_065                -2.408140e-03 3 1  ON 64
ci_066                -2.435287e-03 3 1  ON 65
ci_067                -2.101081e-03 3 1  ON 66
ci_068                -2.473568e-03 3 1  ON 67
ci_069                -2.086063e-04 3 1  ON 68
ci_070                 1.328517e-04 3 1  ON 69
ci_071                -1.874227e-03 3 1  ON 70
ci_072                -1.959420e-03 3 1  ON 71
ci_073                 5.749117e-04 3 1  ON 72
ci_074                 2.857520e-04 3 1  ON 73
ci_075                -2.910379e-04 3 1  ON 74
ci_076                -2.991010e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 2.9360e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s057 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s057 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=57  my_counter=0
  time step      = 5.0000e-02
  blocks         = 250
  steps          = 250
  substeps       = 10
  current        = 0
  target samples = 8.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">250</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">6.2500e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">8.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">6.2500e+04</parameter>
<parameter name="steps" condition="int">250</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2664e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="250">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =8000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 57
    time step          = 0.05
    reference energy   = -22.6821
    reference variance = 1.19225
====================================================
  Execution time = 1.0064e+02
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s057
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 62500 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 6.1096e+04
  VMC Eavg = -2.2670e+01
  VMC Evar = 5.0925e-01
  Total weights = 7.820403196e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.8804e+01
  </log>
</opt>
<opt stage="main" walkers="62500">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.495291891270
                                         uncertainty =       0.001653358216

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.495291891270
                                         uncertainty =       0.001653358216

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000248820703
  error estimate for blocks of size 2^( 2) =       0.000257837165
  error estimate for blocks of size 2^( 3) =       0.000265853252
  error estimate for blocks of size 2^( 4) =       0.000271712653
  error estimate for blocks of size 2^( 5) =       0.000274917559
  error estimate for blocks of size 2^( 6) =       0.000276723413
  error estimate for blocks of size 2^( 7) =       0.000277130665
  error estimate for blocks of size 2^( 8) =       0.000277863364
  error estimate for blocks of size 2^( 9) =       0.000277870308

      target function =                  N/A
              le_mean =     -22.669613958112
             les_mean =     514.420645520957
             stat err =       0.000277396938
             autocorr =       1.242883148983
              std dev =       0.703771224811
             le_variance =       0.495293936872


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266961395811e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.2204e+05, overlap shift 2.2204e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.669613958133       residual = 5.93e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.669613958131       residual = 5.50e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.669613958131       residual = 1.53e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.669613958131       residual = 3.64e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 2.2204e+05 is 1.053573e-09

solving harmonic davidson linear method for identity shift 8.8818e+05, overlap shift 8.8818e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.669613958133       residual = 5.93e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.669613958132       residual = 5.50e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.669613958132       residual = 1.53e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.669613958485       residual = 3.64e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 8.8818e+05 is 2.633934e-10

solving harmonic davidson linear method for identity shift 3.5527e+06, overlap shift 3.5527e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.669613958133       residual = 5.93e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.669613958133       residual = 5.50e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.669613958133       residual = 1.53e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.669613958133       residual = 3.64e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 3.5527e+06 is 6.584836e-11

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.112625 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.1946e+02
  </log>
  <optVariables href="FORM.s057.opt.xml">
ci_001                -7.050617e-01 3 1  ON 0
ci_002                -7.059926e-01 3 1  ON 1
ci_003                -3.765135e-02 3 1  ON 2
ci_004                -3.890326e-02 3 1  ON 3
ci_005                 1.612441e-02 3 1  ON 4
ci_006                 1.600090e-02 3 1  ON 5
ci_007                 1.228712e-02 3 1  ON 6
ci_008                 1.246533e-02 3 1  ON 7
ci_009                -1.173869e-02 3 1  ON 8
ci_010                -1.182876e-02 3 1  ON 9
ci_011                -8.176402e-03 3 1  ON 10
ci_012                -8.138274e-03 3 1  ON 11
ci_013                 9.647126e-03 3 1  ON 12
ci_014                 9.360575e-03 3 1  ON 13
ci_015                 1.228715e-02 3 1  ON 14
ci_016                 1.255401e-02 3 1  ON 15
ci_017                 1.088299e-02 3 1  ON 16
ci_018                 1.078149e-02 3 1  ON 17
ci_019                -2.514327e-03 3 1  ON 18
ci_020                -2.423770e-03 3 1  ON 19
ci_021                -8.459776e-03 3 1  ON 20
ci_022                -8.657040e-03 3 1  ON 21
ci_023                 7.805035e-03 3 1  ON 22
ci_024                 8.041856e-03 3 1  ON 23
ci_025                 4.702654e-03 3 1  ON 24
ci_026                 4.273176e-03 3 1  ON 25
ci_027                 6.454102e-03 3 1  ON 26
ci_028                 6.476493e-03 3 1  ON 27
ci_029                -4.877824e-03 3 1  ON 28
ci_030                -4.785592e-03 3 1  ON 29
ci_031                -7.388691e-03 3 1  ON 30
ci_032                -8.123180e-03 3 1  ON 31
ci_033                 4.600634e-03 3 1  ON 32
ci_034                 4.413554e-03 3 1  ON 33
ci_035                 1.126899e-03 3 1  ON 34
ci_036                 1.043146e-03 3 1  ON 35
ci_037                 4.953341e-03 3 1  ON 36
ci_038                 5.099316e-03 3 1  ON 37
ci_039                 5.306390e-03 3 1  ON 38
ci_040                 5.323084e-03 3 1  ON 39
ci_041                 4.970501e-03 3 1  ON 40
ci_042                 5.231238e-03 3 1  ON 41
ci_043                 4.943052e-03 3 1  ON 42
ci_044                 4.944188e-03 3 1  ON 43
ci_045                 3.123986e-03 3 1  ON 44
ci_046                 3.174240e-03 3 1  ON 45
ci_047                -7.790317e-04 3 1  ON 46
ci_048                -5.616781e-04 3 1  ON 47
ci_049                 1.580280e-03 3 1  ON 48
ci_050                 1.792525e-03 3 1  ON 49
ci_051                -1.106639e-03 3 1  ON 50
ci_052                -1.243282e-03 3 1  ON 51
ci_053                -2.610467e-03 3 1  ON 52
ci_054                -2.301971e-03 3 1  ON 53
ci_055                -1.483465e-03 3 1  ON 54
ci_056                -1.376716e-03 3 1  ON 55
ci_057                -1.240700e-03 3 1  ON 56
ci_058                -1.731086e-03 3 1  ON 57
ci_059                 3.171721e-04 3 1  ON 58
ci_060                 1.414745e-04 3 1  ON 59
ci_061                -3.305059e-04 3 1  ON 60
ci_062                -9.498171e-06 3 1  ON 61
ci_063                -5.232879e-04 3 1  ON 62
ci_064                -8.918511e-04 3 1  ON 63
ci_065                -2.408140e-03 3 1  ON 64
ci_066                -2.435287e-03 3 1  ON 65
ci_067                -2.101081e-03 3 1  ON 66
ci_068                -2.473568e-03 3 1  ON 67
ci_069                -2.086063e-04 3 1  ON 68
ci_070                 1.328515e-04 3 1  ON 69
ci_071                -1.874227e-03 3 1  ON 70
ci_072                -1.959420e-03 3 1  ON 71
ci_073                 5.749117e-04 3 1  ON 72
ci_074                 2.857519e-04 3 1  ON 73
ci_075                -2.910379e-04 3 1  ON 74
ci_076                -2.991011e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="250">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =8000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 57
    time step          = 0.05
    reference energy   = -22.6859
    reference variance = 0.447276
====================================================
  Execution time = 9.9864e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s057
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 62500 
  VMC Eavg = -2.2670e+01
  VMC Evar = 5.0672e-01
  Total weights = 7.8214e+06
  Execution time = 1.4631e+01
  </log>
</opt>
<opt stage="main" walkers="62500">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.495340925003
                                         uncertainty =       0.001372925578

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.495340925003
                                         uncertainty =       0.001372925578

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000248831816
  error estimate for blocks of size 2^( 2) =       0.000257733245
  error estimate for blocks of size 2^( 3) =       0.000265777209
  error estimate for blocks of size 2^( 4) =       0.000271387406
  error estimate for blocks of size 2^( 5) =       0.000274355992
  error estimate for blocks of size 2^( 6) =       0.000276710818
  error estimate for blocks of size 2^( 7) =       0.000277888994
  error estimate for blocks of size 2^( 8) =       0.000279033502
  error estimate for blocks of size 2^( 9) =       0.000279710509

      target function =                  N/A
              le_mean =     -22.669652594491
             les_mean =     514.419867285672
             stat err =       0.000278335956
             autocorr =       1.251200206531
              std dev =       0.703802657149
             le_variance =       0.495338180210

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.495340925060
                                         uncertainty =       0.001372925586

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.495340925060
                                         uncertainty =       0.001372925586

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000248831816
  error estimate for blocks of size 2^( 2) =       0.000257733245
  error estimate for blocks of size 2^( 3) =       0.000265777209
  error estimate for blocks of size 2^( 4) =       0.000271387406
  error estimate for blocks of size 2^( 5) =       0.000274355993
  error estimate for blocks of size 2^( 6) =       0.000276710818
  error estimate for blocks of size 2^( 7) =       0.000277888994
  error estimate for blocks of size 2^( 8) =       0.000279033502
  error estimate for blocks of size 2^( 9) =       0.000279710509

      target function =                  N/A
              le_mean =     -22.669652594491
             les_mean =     514.419867179423
             stat err =       0.000278335956
             autocorr =       1.251200206583
              std dev =       0.703802657189
             le_variance =       0.495338180267

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.495340925032
                                         uncertainty =       0.001372925582

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.495340925032
                                         uncertainty =       0.001372925582

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000248831816
  error estimate for blocks of size 2^( 2) =       0.000257733245
  error estimate for blocks of size 2^( 3) =       0.000265777209
  error estimate for blocks of size 2^( 4) =       0.000271387406
  error estimate for blocks of size 2^( 5) =       0.000274355992
  error estimate for blocks of size 2^( 6) =       0.000276710818
  error estimate for blocks of size 2^( 7) =       0.000277888994
  error estimate for blocks of size 2^( 8) =       0.000279033502
  error estimate for blocks of size 2^( 9) =       0.000279710509

      target function =                  N/A
              le_mean =     -22.669652594491
             les_mean =     514.419867232532
             stat err =       0.000278335956
             autocorr =       1.251200206532
              std dev =       0.703802657169
             le_variance =       0.495338180238

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.495340925007
                                         uncertainty =       0.001372925579

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.495340925007
                                         uncertainty =       0.001372925579

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000248831816
  error estimate for blocks of size 2^( 2) =       0.000257733245
  error estimate for blocks of size 2^( 3) =       0.000265777209
  error estimate for blocks of size 2^( 4) =       0.000271387406
  error estimate for blocks of size 2^( 5) =       0.000274355992
  error estimate for blocks of size 2^( 6) =       0.000276710818
  error estimate for blocks of size 2^( 7) =       0.000277888994
  error estimate for blocks of size 2^( 8) =       0.000279033502
  error estimate for blocks of size 2^( 9) =       0.000279710509

      target function =                  N/A
              le_mean =     -22.669652594491
             les_mean =     514.419867279028
             stat err =       0.000278335956
             autocorr =       1.251200206550
              std dev =       0.703802657151
             le_variance =       0.495338180213


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.669652594491        initial
     2.2204e+05     2.2204e+06             1.0536e-09       -22.669652594491  <--
     8.8818e+05     8.8818e+06             2.6339e-10       -22.669652594491
     3.5527e+06     3.5527e+07             6.5848e-11       -22.669652594491

*****************************************************************************
Applying the update for shift_i =   2.2204e+05     and shift_s =   2.2204e+06
*****************************************************************************

  Execution time = 1.7680e+02
  </log>
  <optVariables href="FORM.s057.opt.xml">
ci_001                -7.050617e-01 3 1  ON 0
ci_002                -7.059926e-01 3 1  ON 1
ci_003                -3.765135e-02 3 1  ON 2
ci_004                -3.890326e-02 3 1  ON 3
ci_005                 1.612441e-02 3 1  ON 4
ci_006                 1.600090e-02 3 1  ON 5
ci_007                 1.228712e-02 3 1  ON 6
ci_008                 1.246533e-02 3 1  ON 7
ci_009                -1.173869e-02 3 1  ON 8
ci_010                -1.182876e-02 3 1  ON 9
ci_011                -8.176402e-03 3 1  ON 10
ci_012                -8.138274e-03 3 1  ON 11
ci_013                 9.647126e-03 3 1  ON 12
ci_014                 9.360575e-03 3 1  ON 13
ci_015                 1.228715e-02 3 1  ON 14
ci_016                 1.255401e-02 3 1  ON 15
ci_017                 1.088299e-02 3 1  ON 16
ci_018                 1.078149e-02 3 1  ON 17
ci_019                -2.514327e-03 3 1  ON 18
ci_020                -2.423770e-03 3 1  ON 19
ci_021                -8.459776e-03 3 1  ON 20
ci_022                -8.657040e-03 3 1  ON 21
ci_023                 7.805035e-03 3 1  ON 22
ci_024                 8.041857e-03 3 1  ON 23
ci_025                 4.702654e-03 3 1  ON 24
ci_026                 4.273176e-03 3 1  ON 25
ci_027                 6.454102e-03 3 1  ON 26
ci_028                 6.476493e-03 3 1  ON 27
ci_029                -4.877824e-03 3 1  ON 28
ci_030                -4.785592e-03 3 1  ON 29
ci_031                -7.388691e-03 3 1  ON 30
ci_032                -8.123179e-03 3 1  ON 31
ci_033                 4.600634e-03 3 1  ON 32
ci_034                 4.413554e-03 3 1  ON 33
ci_035                 1.126899e-03 3 1  ON 34
ci_036                 1.043146e-03 3 1  ON 35
ci_037                 4.953341e-03 3 1  ON 36
ci_038                 5.099316e-03 3 1  ON 37
ci_039                 5.306389e-03 3 1  ON 38
ci_040                 5.323084e-03 3 1  ON 39
ci_041                 4.970501e-03 3 1  ON 40
ci_042                 5.231238e-03 3 1  ON 41
ci_043                 4.943052e-03 3 1  ON 42
ci_044                 4.944188e-03 3 1  ON 43
ci_045                 3.123986e-03 3 1  ON 44
ci_046                 3.174240e-03 3 1  ON 45
ci_047                -7.790320e-04 3 1  ON 46
ci_048                -5.616776e-04 3 1  ON 47
ci_049                 1.580280e-03 3 1  ON 48
ci_050                 1.792524e-03 3 1  ON 49
ci_051                -1.106640e-03 3 1  ON 50
ci_052                -1.243282e-03 3 1  ON 51
ci_053                -2.610466e-03 3 1  ON 52
ci_054                -2.301971e-03 3 1  ON 53
ci_055                -1.483465e-03 3 1  ON 54
ci_056                -1.376716e-03 3 1  ON 55
ci_057                -1.240700e-03 3 1  ON 56
ci_058                -1.731086e-03 3 1  ON 57
ci_059                 3.171716e-04 3 1  ON 58
ci_060                 1.414748e-04 3 1  ON 59
ci_061                -3.305057e-04 3 1  ON 60
ci_062                -9.498167e-06 3 1  ON 61
ci_063                -5.232879e-04 3 1  ON 62
ci_064                -8.918508e-04 3 1  ON 63
ci_065                -2.408140e-03 3 1  ON 64
ci_066                -2.435287e-03 3 1  ON 65
ci_067                -2.101082e-03 3 1  ON 66
ci_068                -2.473567e-03 3 1  ON 67
ci_069                -2.086061e-04 3 1  ON 68
ci_070                 1.328510e-04 3 1  ON 69
ci_071                -1.874226e-03 3 1  ON 70
ci_072                -1.959421e-03 3 1  ON 71
ci_073                 5.749115e-04 3 1  ON 72
ci_074                 2.857517e-04 3 1  ON 73
ci_075                -2.910379e-04 3 1  ON 74
ci_076                -2.991014e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 2.9627e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s058 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s058 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=58  my_counter=0
  time step      = 5.0000e-02
  blocks         = 250
  steps          = 250
  substeps       = 10
  current        = 0
  target samples = 8.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">250</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">6.2500e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">8.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">6.2500e+04</parameter>
<parameter name="steps" condition="int">250</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2664e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="250">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =8000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 58
    time step          = 0.05
    reference energy   = -22.5836
    reference variance = 0.411407
====================================================
  Execution time = 1.0046e+02
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s058
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 62500 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 6.1100e+04
  VMC Eavg = -2.2670e+01
  VMC Evar = 5.0700e-01
  Total weights = 7.820899762e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.8863e+01
  </log>
</opt>
<opt stage="main" walkers="62500">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.495161067838
                                         uncertainty =       0.001819289624

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.495161067838
                                         uncertainty =       0.001819289624

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000248788382
  error estimate for blocks of size 2^( 2) =       0.000257689974
  error estimate for blocks of size 2^( 3) =       0.000265728658
  error estimate for blocks of size 2^( 4) =       0.000271676925
  error estimate for blocks of size 2^( 5) =       0.000275071083
  error estimate for blocks of size 2^( 6) =       0.000276878297
  error estimate for blocks of size 2^( 7) =       0.000277864156
  error estimate for blocks of size 2^( 8) =       0.000279551791
  error estimate for blocks of size 2^( 9) =       0.000279527591

      target function =                  N/A
              le_mean =     -22.669666168708
             les_mean =     514.420763054919
             stat err =       0.000278455459
             autocorr =       1.252712125872
              std dev =       0.703679808330
             le_variance =       0.495165272652


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266966616871e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.5511e+04, overlap shift 5.5511e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.669666168732       residual = 4.80e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.669666168730       residual = 7.83e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.669666168731       residual = 2.42e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.669666168731       residual = 7.66e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 5.5511e+04 is 3.798774e-09

solving harmonic davidson linear method for identity shift 2.2204e+05, overlap shift 2.2204e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.669666168732       residual = 4.80e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.669666168731       residual = 7.83e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.669666168732       residual = 2.42e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.669666168732       residual = 7.66e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 2.2204e+05 is 9.496956e-10

solving harmonic davidson linear method for identity shift 8.8818e+05, overlap shift 8.8818e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.669666168732       residual = 4.80e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.669666168732       residual = 7.83e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.669666168732       residual = 2.42e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.669666168732       residual = 7.66e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 8.8818e+05 is 2.374240e-10

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.113990 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.1934e+02
  </log>
  <optVariables href="FORM.s058.opt.xml">
ci_001                -7.050617e-01 3 1  ON 0
ci_002                -7.059926e-01 3 1  ON 1
ci_003                -3.765135e-02 3 1  ON 2
ci_004                -3.890326e-02 3 1  ON 3
ci_005                 1.612441e-02 3 1  ON 4
ci_006                 1.600090e-02 3 1  ON 5
ci_007                 1.228712e-02 3 1  ON 6
ci_008                 1.246533e-02 3 1  ON 7
ci_009                -1.173869e-02 3 1  ON 8
ci_010                -1.182876e-02 3 1  ON 9
ci_011                -8.176402e-03 3 1  ON 10
ci_012                -8.138275e-03 3 1  ON 11
ci_013                 9.647127e-03 3 1  ON 12
ci_014                 9.360575e-03 3 1  ON 13
ci_015                 1.228715e-02 3 1  ON 14
ci_016                 1.255401e-02 3 1  ON 15
ci_017                 1.088299e-02 3 1  ON 16
ci_018                 1.078149e-02 3 1  ON 17
ci_019                -2.514327e-03 3 1  ON 18
ci_020                -2.423770e-03 3 1  ON 19
ci_021                -8.459775e-03 3 1  ON 20
ci_022                -8.657040e-03 3 1  ON 21
ci_023                 7.805035e-03 3 1  ON 22
ci_024                 8.041856e-03 3 1  ON 23
ci_025                 4.702653e-03 3 1  ON 24
ci_026                 4.273176e-03 3 1  ON 25
ci_027                 6.454101e-03 3 1  ON 26
ci_028                 6.476493e-03 3 1  ON 27
ci_029                -4.877824e-03 3 1  ON 28
ci_030                -4.785592e-03 3 1  ON 29
ci_031                -7.388691e-03 3 1  ON 30
ci_032                -8.123179e-03 3 1  ON 31
ci_033                 4.600634e-03 3 1  ON 32
ci_034                 4.413555e-03 3 1  ON 33
ci_035                 1.126899e-03 3 1  ON 34
ci_036                 1.043147e-03 3 1  ON 35
ci_037                 4.953342e-03 3 1  ON 36
ci_038                 5.099316e-03 3 1  ON 37
ci_039                 5.306390e-03 3 1  ON 38
ci_040                 5.323083e-03 3 1  ON 39
ci_041                 4.970501e-03 3 1  ON 40
ci_042                 5.231238e-03 3 1  ON 41
ci_043                 4.943052e-03 3 1  ON 42
ci_044                 4.944188e-03 3 1  ON 43
ci_045                 3.123986e-03 3 1  ON 44
ci_046                 3.174240e-03 3 1  ON 45
ci_047                -7.790317e-04 3 1  ON 46
ci_048                -5.616776e-04 3 1  ON 47
ci_049                 1.580281e-03 3 1  ON 48
ci_050                 1.792524e-03 3 1  ON 49
ci_051                -1.106640e-03 3 1  ON 50
ci_052                -1.243282e-03 3 1  ON 51
ci_053                -2.610467e-03 3 1  ON 52
ci_054                -2.301972e-03 3 1  ON 53
ci_055                -1.483465e-03 3 1  ON 54
ci_056                -1.376716e-03 3 1  ON 55
ci_057                -1.240700e-03 3 1  ON 56
ci_058                -1.731085e-03 3 1  ON 57
ci_059                 3.171713e-04 3 1  ON 58
ci_060                 1.414751e-04 3 1  ON 59
ci_061                -3.305056e-04 3 1  ON 60
ci_062                -9.498109e-06 3 1  ON 61
ci_063                -5.232889e-04 3 1  ON 62
ci_064                -8.918502e-04 3 1  ON 63
ci_065                -2.408140e-03 3 1  ON 64
ci_066                -2.435287e-03 3 1  ON 65
ci_067                -2.101082e-03 3 1  ON 66
ci_068                -2.473567e-03 3 1  ON 67
ci_069                -2.086063e-04 3 1  ON 68
ci_070                 1.328514e-04 3 1  ON 69
ci_071                -1.874227e-03 3 1  ON 70
ci_072                -1.959421e-03 3 1  ON 71
ci_073                 5.749110e-04 3 1  ON 72
ci_074                 2.857511e-04 3 1  ON 73
ci_075                -2.910376e-04 3 1  ON 74
ci_076                -2.991006e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="250">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =8000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 58
    time step          = 0.05
    reference energy   = -22.7343
    reference variance = 0.868654
====================================================
  Execution time = 9.9831e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s058
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 62500 
  VMC Eavg = -2.2670e+01
  VMC Evar = 5.0986e-01
  Total weights = 7.8206e+06
  Execution time = 1.4663e+01
  </log>
</opt>
<opt stage="main" walkers="62500">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.496971322477
                                         uncertainty =       0.001380685972

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.496971322477
                                         uncertainty =       0.001380685972

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000249241286
  error estimate for blocks of size 2^( 2) =       0.000258251393
  error estimate for blocks of size 2^( 3) =       0.000266398718
  error estimate for blocks of size 2^( 4) =       0.000272168446
  error estimate for blocks of size 2^( 5) =       0.000275536513
  error estimate for blocks of size 2^( 6) =       0.000277721730
  error estimate for blocks of size 2^( 7) =       0.000278811500
  error estimate for blocks of size 2^( 8) =       0.000279468015
  error estimate for blocks of size 2^( 9) =       0.000278816577

      target function =                  N/A
              le_mean =     -22.670024855077
             les_mean =     514.439886830384
             stat err =       0.000278704455
             autocorr =       1.250396806777
              std dev =       0.704960814310
             le_variance =       0.496969749712

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.496971322668
                                         uncertainty =       0.001380685959

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.496971322668
                                         uncertainty =       0.001380685959

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000249241286
  error estimate for blocks of size 2^( 2) =       0.000258251393
  error estimate for blocks of size 2^( 3) =       0.000266398718
  error estimate for blocks of size 2^( 4) =       0.000272168446
  error estimate for blocks of size 2^( 5) =       0.000275536513
  error estimate for blocks of size 2^( 6) =       0.000277721730
  error estimate for blocks of size 2^( 7) =       0.000278811500
  error estimate for blocks of size 2^( 8) =       0.000279468015
  error estimate for blocks of size 2^( 9) =       0.000278816577

      target function =                  N/A
              le_mean =     -22.670024855082
             les_mean =     514.439886843136
             stat err =       0.000278704455
             autocorr =       1.250396806299
              std dev =       0.704960814445
             le_variance =       0.496969749903

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.496971322573
                                         uncertainty =       0.001380685965

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.496971322573
                                         uncertainty =       0.001380685965

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000249241286
  error estimate for blocks of size 2^( 2) =       0.000258251393
  error estimate for blocks of size 2^( 3) =       0.000266398718
  error estimate for blocks of size 2^( 4) =       0.000272168446
  error estimate for blocks of size 2^( 5) =       0.000275536513
  error estimate for blocks of size 2^( 6) =       0.000277721730
  error estimate for blocks of size 2^( 7) =       0.000278811500
  error estimate for blocks of size 2^( 8) =       0.000279468015
  error estimate for blocks of size 2^( 9) =       0.000278816577

      target function =                  N/A
              le_mean =     -22.670024855079
             les_mean =     514.439886836759
             stat err =       0.000278704455
             autocorr =       1.250396806546
              std dev =       0.704960814377
             le_variance =       0.496969749807

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.496971322489
                                         uncertainty =       0.001380685971

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.496971322489
                                         uncertainty =       0.001380685971

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000249241286
  error estimate for blocks of size 2^( 2) =       0.000258251393
  error estimate for blocks of size 2^( 3) =       0.000266398718
  error estimate for blocks of size 2^( 4) =       0.000272168446
  error estimate for blocks of size 2^( 5) =       0.000275536513
  error estimate for blocks of size 2^( 6) =       0.000277721730
  error estimate for blocks of size 2^( 7) =       0.000278811500
  error estimate for blocks of size 2^( 8) =       0.000279468015
  error estimate for blocks of size 2^( 9) =       0.000278816577

      target function =                  N/A
              le_mean =     -22.670024855077
             les_mean =     514.439886831181
             stat err =       0.000278704455
             autocorr =       1.250396806753
              std dev =       0.704960814318
             le_variance =       0.496969749724


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.670024855077        initial
     5.5511e+04     5.5511e+05             3.7988e-09       -22.670024855082  <--
     2.2204e+05     2.2204e+06             9.4970e-10       -22.670024855079
     8.8818e+05     8.8818e+06             2.3742e-10       -22.670024855077

*****************************************************************************
Applying the update for shift_i =   5.5511e+04     and shift_s =   5.5511e+05
*****************************************************************************

  Execution time = 1.7331e+02
  </log>
  <optVariables href="FORM.s058.opt.xml">
ci_001                -7.050617e-01 3 1  ON 0
ci_002                -7.059926e-01 3 1  ON 1
ci_003                -3.765135e-02 3 1  ON 2
ci_004                -3.890326e-02 3 1  ON 3
ci_005                 1.612441e-02 3 1  ON 4
ci_006                 1.600090e-02 3 1  ON 5
ci_007                 1.228713e-02 3 1  ON 6
ci_008                 1.246533e-02 3 1  ON 7
ci_009                -1.173869e-02 3 1  ON 8
ci_010                -1.182876e-02 3 1  ON 9
ci_011                -8.176400e-03 3 1  ON 10
ci_012                -8.138276e-03 3 1  ON 11
ci_013                 9.647128e-03 3 1  ON 12
ci_014                 9.360574e-03 3 1  ON 13
ci_015                 1.228715e-02 3 1  ON 14
ci_016                 1.255401e-02 3 1  ON 15
ci_017                 1.088299e-02 3 1  ON 16
ci_018                 1.078149e-02 3 1  ON 17
ci_019                -2.514327e-03 3 1  ON 18
ci_020                -2.423770e-03 3 1  ON 19
ci_021                -8.459775e-03 3 1  ON 20
ci_022                -8.657038e-03 3 1  ON 21
ci_023                 7.805035e-03 3 1  ON 22
ci_024                 8.041855e-03 3 1  ON 23
ci_025                 4.702650e-03 3 1  ON 24
ci_026                 4.273176e-03 3 1  ON 25
ci_027                 6.454100e-03 3 1  ON 26
ci_028                 6.476492e-03 3 1  ON 27
ci_029                -4.877823e-03 3 1  ON 28
ci_030                -4.785591e-03 3 1  ON 29
ci_031                -7.388691e-03 3 1  ON 30
ci_032                -8.123178e-03 3 1  ON 31
ci_033                 4.600635e-03 3 1  ON 32
ci_034                 4.413557e-03 3 1  ON 33
ci_035                 1.126899e-03 3 1  ON 34
ci_036                 1.043147e-03 3 1  ON 35
ci_037                 4.953343e-03 3 1  ON 36
ci_038                 5.099318e-03 3 1  ON 37
ci_039                 5.306392e-03 3 1  ON 38
ci_040                 5.323083e-03 3 1  ON 39
ci_041                 4.970500e-03 3 1  ON 40
ci_042                 5.231240e-03 3 1  ON 41
ci_043                 4.943051e-03 3 1  ON 42
ci_044                 4.944187e-03 3 1  ON 43
ci_045                 3.123985e-03 3 1  ON 44
ci_046                 3.174240e-03 3 1  ON 45
ci_047                -7.790309e-04 3 1  ON 46
ci_048                -5.616774e-04 3 1  ON 47
ci_049                 1.580281e-03 3 1  ON 48
ci_050                 1.792524e-03 3 1  ON 49
ci_051                -1.106642e-03 3 1  ON 50
ci_052                -1.243283e-03 3 1  ON 51
ci_053                -2.610468e-03 3 1  ON 52
ci_054                -2.301974e-03 3 1  ON 53
ci_055                -1.483465e-03 3 1  ON 54
ci_056                -1.376716e-03 3 1  ON 55
ci_057                -1.240702e-03 3 1  ON 56
ci_058                -1.731083e-03 3 1  ON 57
ci_059                 3.171701e-04 3 1  ON 58
ci_060                 1.414761e-04 3 1  ON 59
ci_061                -3.305053e-04 3 1  ON 60
ci_062                -9.497934e-06 3 1  ON 61
ci_063                -5.232917e-04 3 1  ON 62
ci_064                -8.918484e-04 3 1  ON 63
ci_065                -2.408141e-03 3 1  ON 64
ci_066                -2.435287e-03 3 1  ON 65
ci_067                -2.101082e-03 3 1  ON 66
ci_068                -2.473566e-03 3 1  ON 67
ci_069                -2.086067e-04 3 1  ON 68
ci_070                 1.328527e-04 3 1  ON 69
ci_071                -1.874228e-03 3 1  ON 70
ci_072                -1.959423e-03 3 1  ON 71
ci_073                 5.749096e-04 3 1  ON 72
ci_074                 2.857495e-04 3 1  ON 73
ci_075                -2.910369e-04 3 1  ON 74
ci_076                -2.990985e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 2.9268e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s059 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s059 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=59  my_counter=0
  time step      = 5.0000e-02
  blocks         = 250
  steps          = 250
  substeps       = 10
  current        = 0
  target samples = 8.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">250</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">6.2500e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">8.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">6.2500e+04</parameter>
<parameter name="steps" condition="int">250</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2664e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="250">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =8000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 59
    time step          = 0.05
    reference energy   = -22.5777
    reference variance = 0.28057
====================================================
  Execution time = 1.0053e+02
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s059
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 62500 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 6.1109e+04
  VMC Eavg = -2.2669e+01
  VMC Evar = 5.1060e-01
  Total weights = 7.820637902e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.8901e+01
  </log>
</opt>
<opt stage="main" walkers="62500">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.498079044980
                                         uncertainty =       0.002156667801

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.498079044980
                                         uncertainty =       0.002156667801

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000249520168
  error estimate for blocks of size 2^( 2) =       0.000258365457
  error estimate for blocks of size 2^( 3) =       0.000266457818
  error estimate for blocks of size 2^( 4) =       0.000272558565
  error estimate for blocks of size 2^( 5) =       0.000276215859
  error estimate for blocks of size 2^( 6) =       0.000278394953
  error estimate for blocks of size 2^( 7) =       0.000280195316
  error estimate for blocks of size 2^( 8) =       0.000282681863
  error estimate for blocks of size 2^( 9) =       0.000285438204

      target function =                  N/A
              le_mean =     -22.669477694700
             les_mean =     514.415815771521
             stat err =       0.000281677584
             autocorr =       1.274363326752
              std dev =       0.705749612103
             le_variance =       0.498082514984


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266947769470e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.3878e+04, overlap shift 1.3878e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.669477694725       residual = 4.56e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.669477694746       residual = 4.13e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.669477694741       residual = 1.18e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.669477694742       residual = 4.16e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 1.3878e+04 is 1.739621e-08

solving harmonic davidson linear method for identity shift 5.5511e+04, overlap shift 5.5511e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.669477694725       residual = 4.56e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.669477694731       residual = 4.13e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.669477694729       residual = 1.18e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.669477694729       residual = 4.16e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 5.5511e+04 is 4.349087e-09

solving harmonic davidson linear method for identity shift 2.2204e+05, overlap shift 2.2204e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.669477694725       residual = 4.56e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.669477694727       residual = 4.13e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.669477694726       residual = 1.18e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.669477694726       residual = 4.16e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 2.2204e+05 is 1.087274e-09

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.118436 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.1945e+02
  </log>
  <optVariables href="FORM.s059.opt.xml">
ci_001                -7.050617e-01 3 1  ON 0
ci_002                -7.059926e-01 3 1  ON 1
ci_003                -3.765135e-02 3 1  ON 2
ci_004                -3.890326e-02 3 1  ON 3
ci_005                 1.612441e-02 3 1  ON 4
ci_006                 1.600090e-02 3 1  ON 5
ci_007                 1.228713e-02 3 1  ON 6
ci_008                 1.246533e-02 3 1  ON 7
ci_009                -1.173869e-02 3 1  ON 8
ci_010                -1.182876e-02 3 1  ON 9
ci_011                -8.176401e-03 3 1  ON 10
ci_012                -8.138276e-03 3 1  ON 11
ci_013                 9.647130e-03 3 1  ON 12
ci_014                 9.360576e-03 3 1  ON 13
ci_015                 1.228715e-02 3 1  ON 14
ci_016                 1.255401e-02 3 1  ON 15
ci_017                 1.088299e-02 3 1  ON 16
ci_018                 1.078149e-02 3 1  ON 17
ci_019                -2.514325e-03 3 1  ON 18
ci_020                -2.423768e-03 3 1  ON 19
ci_021                -8.459775e-03 3 1  ON 20
ci_022                -8.657037e-03 3 1  ON 21
ci_023                 7.805037e-03 3 1  ON 22
ci_024                 8.041854e-03 3 1  ON 23
ci_025                 4.702648e-03 3 1  ON 24
ci_026                 4.273175e-03 3 1  ON 25
ci_027                 6.454097e-03 3 1  ON 26
ci_028                 6.476490e-03 3 1  ON 27
ci_029                -4.877822e-03 3 1  ON 28
ci_030                -4.785592e-03 3 1  ON 29
ci_031                -7.388692e-03 3 1  ON 30
ci_032                -8.123178e-03 3 1  ON 31
ci_033                 4.600635e-03 3 1  ON 32
ci_034                 4.413556e-03 3 1  ON 33
ci_035                 1.126901e-03 3 1  ON 34
ci_036                 1.043147e-03 3 1  ON 35
ci_037                 4.953344e-03 3 1  ON 36
ci_038                 5.099316e-03 3 1  ON 37
ci_039                 5.306390e-03 3 1  ON 38
ci_040                 5.323083e-03 3 1  ON 39
ci_041                 4.970500e-03 3 1  ON 40
ci_042                 5.231238e-03 3 1  ON 41
ci_043                 4.943051e-03 3 1  ON 42
ci_044                 4.944186e-03 3 1  ON 43
ci_045                 3.123981e-03 3 1  ON 44
ci_046                 3.174242e-03 3 1  ON 45
ci_047                -7.790287e-04 3 1  ON 46
ci_048                -5.616789e-04 3 1  ON 47
ci_049                 1.580283e-03 3 1  ON 48
ci_050                 1.792522e-03 3 1  ON 49
ci_051                -1.106644e-03 3 1  ON 50
ci_052                -1.243282e-03 3 1  ON 51
ci_053                -2.610469e-03 3 1  ON 52
ci_054                -2.301975e-03 3 1  ON 53
ci_055                -1.483468e-03 3 1  ON 54
ci_056                -1.376716e-03 3 1  ON 55
ci_057                -1.240703e-03 3 1  ON 56
ci_058                -1.731082e-03 3 1  ON 57
ci_059                 3.171699e-04 3 1  ON 58
ci_060                 1.414746e-04 3 1  ON 59
ci_061                -3.305062e-04 3 1  ON 60
ci_062                -9.498393e-06 3 1  ON 61
ci_063                -5.232918e-04 3 1  ON 62
ci_064                -8.918494e-04 3 1  ON 63
ci_065                -2.408141e-03 3 1  ON 64
ci_066                -2.435287e-03 3 1  ON 65
ci_067                -2.101083e-03 3 1  ON 66
ci_068                -2.473565e-03 3 1  ON 67
ci_069                -2.086041e-04 3 1  ON 68
ci_070                 1.328508e-04 3 1  ON 69
ci_071                -1.874229e-03 3 1  ON 70
ci_072                -1.959425e-03 3 1  ON 71
ci_073                 5.749078e-04 3 1  ON 72
ci_074                 2.857498e-04 3 1  ON 73
ci_075                -2.910358e-04 3 1  ON 74
ci_076                -2.990988e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="250">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =8000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 59
    time step          = 0.05
    reference energy   = -22.5954
    reference variance = 0.300706
====================================================
  Execution time = 9.9778e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s059
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 62500 
  VMC Eavg = -2.2670e+01
  VMC Evar = 5.1016e-01
  Total weights = 7.8207e+06
  Execution time = 1.4654e+01
  </log>
</opt>
<opt stage="main" walkers="62500">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.496996958153
                                         uncertainty =       0.001397211311

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.496996958153
                                         uncertainty =       0.001397211311

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000249248133
  error estimate for blocks of size 2^( 2) =       0.000258180003
  error estimate for blocks of size 2^( 3) =       0.000266154261
  error estimate for blocks of size 2^( 4) =       0.000271619586
  error estimate for blocks of size 2^( 5) =       0.000274696833
  error estimate for blocks of size 2^( 6) =       0.000276366989
  error estimate for blocks of size 2^( 7) =       0.000277685947
  error estimate for blocks of size 2^( 8) =       0.000278016561
  error estimate for blocks of size 2^( 9) =       0.000278348932

      target function =                  N/A
              le_mean =     -22.669600715322
             les_mean =     514.420952572464
             stat err =       0.000277604607
             autocorr =       1.240479269540
              std dev =       0.704980180756
             le_variance =       0.496997055259

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.496996958912
                                         uncertainty =       0.001397211224

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.496996958912
                                         uncertainty =       0.001397211224

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000249248133
  error estimate for blocks of size 2^( 2) =       0.000258180003
  error estimate for blocks of size 2^( 3) =       0.000266154261
  error estimate for blocks of size 2^( 4) =       0.000271619587
  error estimate for blocks of size 2^( 5) =       0.000274696833
  error estimate for blocks of size 2^( 6) =       0.000276366990
  error estimate for blocks of size 2^( 7) =       0.000277685947
  error estimate for blocks of size 2^( 8) =       0.000278016562
  error estimate for blocks of size 2^( 9) =       0.000278348932

      target function =                  N/A
              le_mean =     -22.669600715349
             les_mean =     514.420952547515
             stat err =       0.000277604608
             autocorr =       1.240479270351
              std dev =       0.704980181294
             le_variance =       0.496997056018

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.496996958532
                                         uncertainty =       0.001397211267

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.496996958532
                                         uncertainty =       0.001397211267

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000249248133
  error estimate for blocks of size 2^( 2) =       0.000258180003
  error estimate for blocks of size 2^( 3) =       0.000266154261
  error estimate for blocks of size 2^( 4) =       0.000271619586
  error estimate for blocks of size 2^( 5) =       0.000274696833
  error estimate for blocks of size 2^( 6) =       0.000276366990
  error estimate for blocks of size 2^( 7) =       0.000277685947
  error estimate for blocks of size 2^( 8) =       0.000278016561
  error estimate for blocks of size 2^( 9) =       0.000278348932

      target function =                  N/A
              le_mean =     -22.669600715336
             les_mean =     514.420952559936
             stat err =       0.000277604607
             autocorr =       1.240479269941
              std dev =       0.704980181025
             le_variance =       0.496997055638

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.496996958200
                                         uncertainty =       0.001397211305

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.496996958200
                                         uncertainty =       0.001397211305

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000249248133
  error estimate for blocks of size 2^( 2) =       0.000258180003
  error estimate for blocks of size 2^( 3) =       0.000266154261
  error estimate for blocks of size 2^( 4) =       0.000271619586
  error estimate for blocks of size 2^( 5) =       0.000274696833
  error estimate for blocks of size 2^( 6) =       0.000276366989
  error estimate for blocks of size 2^( 7) =       0.000277685947
  error estimate for blocks of size 2^( 8) =       0.000278016561
  error estimate for blocks of size 2^( 9) =       0.000278348932

      target function =                  N/A
              le_mean =     -22.669600715324
             les_mean =     514.420952570893
             stat err =       0.000277604607
             autocorr =       1.240479269591
              std dev =       0.704980180790
             le_variance =       0.496997055307


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.669600715322        initial
     1.3878e+04     1.3878e+05             1.7396e-08       -22.669600715349  <--
     5.5511e+04     5.5511e+05             4.3491e-09       -22.669600715336
     2.2204e+05     2.2204e+06             1.0873e-09       -22.669600715324

*****************************************************************************
Applying the update for shift_i =   1.3878e+04     and shift_s =   1.3878e+05
*****************************************************************************

  Execution time = 1.7342e+02
  </log>
  <optVariables href="FORM.s059.opt.xml">
ci_001                -7.050617e-01 3 1  ON 0
ci_002                -7.059926e-01 3 1  ON 1
ci_003                -3.765135e-02 3 1  ON 2
ci_004                -3.890325e-02 3 1  ON 3
ci_005                 1.612441e-02 3 1  ON 4
ci_006                 1.600090e-02 3 1  ON 5
ci_007                 1.228713e-02 3 1  ON 6
ci_008                 1.246533e-02 3 1  ON 7
ci_009                -1.173869e-02 3 1  ON 8
ci_010                -1.182876e-02 3 1  ON 9
ci_011                -8.176403e-03 3 1  ON 10
ci_012                -8.138278e-03 3 1  ON 11
ci_013                 9.647137e-03 3 1  ON 12
ci_014                 9.360580e-03 3 1  ON 13
ci_015                 1.228715e-02 3 1  ON 14
ci_016                 1.255400e-02 3 1  ON 15
ci_017                 1.088300e-02 3 1  ON 16
ci_018                 1.078149e-02 3 1  ON 17
ci_019                -2.514322e-03 3 1  ON 18
ci_020                -2.423765e-03 3 1  ON 19
ci_021                -8.459776e-03 3 1  ON 20
ci_022                -8.657034e-03 3 1  ON 21
ci_023                 7.805043e-03 3 1  ON 22
ci_024                 8.041852e-03 3 1  ON 23
ci_025                 4.702642e-03 3 1  ON 24
ci_026                 4.273172e-03 3 1  ON 25
ci_027                 6.454089e-03 3 1  ON 26
ci_028                 6.476482e-03 3 1  ON 27
ci_029                -4.877820e-03 3 1  ON 28
ci_030                -4.785596e-03 3 1  ON 29
ci_031                -7.388694e-03 3 1  ON 30
ci_032                -8.123179e-03 3 1  ON 31
ci_033                 4.600637e-03 3 1  ON 32
ci_034                 4.413553e-03 3 1  ON 33
ci_035                 1.126907e-03 3 1  ON 34
ci_036                 1.043146e-03 3 1  ON 35
ci_037                 4.953347e-03 3 1  ON 36
ci_038                 5.099310e-03 3 1  ON 37
ci_039                 5.306386e-03 3 1  ON 38
ci_040                 5.323086e-03 3 1  ON 39
ci_041                 4.970499e-03 3 1  ON 40
ci_042                 5.231233e-03 3 1  ON 41
ci_043                 4.943052e-03 3 1  ON 42
ci_044                 4.944182e-03 3 1  ON 43
ci_045                 3.123967e-03 3 1  ON 44
ci_046                 3.174246e-03 3 1  ON 45
ci_047                -7.790222e-04 3 1  ON 46
ci_048                -5.616836e-04 3 1  ON 47
ci_049                 1.580289e-03 3 1  ON 48
ci_050                 1.792516e-03 3 1  ON 49
ci_051                -1.106651e-03 3 1  ON 50
ci_052                -1.243279e-03 3 1  ON 51
ci_053                -2.610471e-03 3 1  ON 52
ci_054                -2.301978e-03 3 1  ON 53
ci_055                -1.483475e-03 3 1  ON 54
ci_056                -1.376714e-03 3 1  ON 55
ci_057                -1.240708e-03 3 1  ON 56
ci_058                -1.731077e-03 3 1  ON 57
ci_059                 3.171692e-04 3 1  ON 58
ci_060                 1.414703e-04 3 1  ON 59
ci_061                -3.305088e-04 3 1  ON 60
ci_062                -9.499769e-06 3 1  ON 61
ci_063                -5.232922e-04 3 1  ON 62
ci_064                -8.918525e-04 3 1  ON 63
ci_065                -2.408143e-03 3 1  ON 64
ci_066                -2.435285e-03 3 1  ON 65
ci_067                -2.101084e-03 3 1  ON 66
ci_068                -2.473560e-03 3 1  ON 67
ci_069                -2.085964e-04 3 1  ON 68
ci_070                 1.328450e-04 3 1  ON 69
ci_071                -1.874230e-03 3 1  ON 70
ci_072                -1.959430e-03 3 1  ON 71
ci_073                 5.749021e-04 3 1  ON 72
ci_074                 2.857507e-04 3 1  ON 73
ci_075                -2.910323e-04 3 1  ON 74
ci_076                -2.990999e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 2.9288e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s060 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s060 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=60  my_counter=0
  time step      = 5.0000e-02
  blocks         = 250
  steps          = 250
  substeps       = 10
  current        = 0
  target samples = 8.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">250</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">6.2500e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">8.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">6.2500e+04</parameter>
<parameter name="steps" condition="int">250</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2663e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="250">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =8000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 60
    time step          = 0.05
    reference energy   = -22.6062
    reference variance = 0.184522
====================================================
  Execution time = 1.0027e+02
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s060
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 62500 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 6.1070e+04
  VMC Eavg = -2.2669e+01
  VMC Evar = 5.0677e-01
  Total weights = 7.820830282e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.9068e+01
  </log>
</opt>
<opt stage="main" walkers="62500">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.493660704265
                                         uncertainty =       0.001335416119

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.493660704265
                                         uncertainty =       0.001335416119

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000248410768
  error estimate for blocks of size 2^( 2) =       0.000257486651
  error estimate for blocks of size 2^( 3) =       0.000265546904
  error estimate for blocks of size 2^( 4) =       0.000271449629
  error estimate for blocks of size 2^( 5) =       0.000275069587
  error estimate for blocks of size 2^( 6) =       0.000277485794
  error estimate for blocks of size 2^( 7) =       0.000278762647
  error estimate for blocks of size 2^( 8) =       0.000280204256
  error estimate for blocks of size 2^( 9) =       0.000280335179

      target function =                  N/A
              le_mean =     -22.669450057919
             les_mean =     514.410740015519
             stat err =       0.000279196969
             autocorr =       1.263224565043
              std dev =       0.702611754546
             le_variance =       0.493663277626


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266945005792e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.4694e+03, overlap shift 3.4694e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.669450057940       residual = 5.01e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.669450058077       residual = 7.77e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.669450058050       residual = 1.63e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.669450058052       residual = 3.60e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 3.4694e+03 is 6.196312e-08

solving harmonic davidson linear method for identity shift 1.3878e+04, overlap shift 1.3878e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.669450057940       residual = 5.01e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.669450057974       residual = 7.77e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.669450057968       residual = 1.63e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.669450057968       residual = 3.60e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 1.3878e+04 is 1.549124e-08

solving harmonic davidson linear method for identity shift 5.5511e+04, overlap shift 5.5511e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.669450057940       residual = 5.01e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.669450057949       residual = 7.77e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.669450057947       residual = 1.63e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.669450057945       residual = 3.60e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 5.5511e+04 is 3.872839e-09

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.119777 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.1935e+02
  </log>
  <optVariables href="FORM.s060.opt.xml">
ci_001                -7.050617e-01 3 1  ON 0
ci_002                -7.059926e-01 3 1  ON 1
ci_003                -3.765135e-02 3 1  ON 2
ci_004                -3.890324e-02 3 1  ON 3
ci_005                 1.612440e-02 3 1  ON 4
ci_006                 1.600090e-02 3 1  ON 5
ci_007                 1.228712e-02 3 1  ON 6
ci_008                 1.246533e-02 3 1  ON 7
ci_009                -1.173869e-02 3 1  ON 8
ci_010                -1.182876e-02 3 1  ON 9
ci_011                -8.176399e-03 3 1  ON 10
ci_012                -8.138282e-03 3 1  ON 11
ci_013                 9.647138e-03 3 1  ON 12
ci_014                 9.360584e-03 3 1  ON 13
ci_015                 1.228714e-02 3 1  ON 14
ci_016                 1.255400e-02 3 1  ON 15
ci_017                 1.088300e-02 3 1  ON 16
ci_018                 1.078149e-02 3 1  ON 17
ci_019                -2.514325e-03 3 1  ON 18
ci_020                -2.423764e-03 3 1  ON 19
ci_021                -8.459773e-03 3 1  ON 20
ci_022                -8.657040e-03 3 1  ON 21
ci_023                 7.805048e-03 3 1  ON 22
ci_024                 8.041856e-03 3 1  ON 23
ci_025                 4.702627e-03 3 1  ON 24
ci_026                 4.273185e-03 3 1  ON 25
ci_027                 6.454101e-03 3 1  ON 26
ci_028                 6.476479e-03 3 1  ON 27
ci_029                -4.877822e-03 3 1  ON 28
ci_030                -4.785594e-03 3 1  ON 29
ci_031                -7.388695e-03 3 1  ON 30
ci_032                -8.123175e-03 3 1  ON 31
ci_033                 4.600640e-03 3 1  ON 32
ci_034                 4.413553e-03 3 1  ON 33
ci_035                 1.126911e-03 3 1  ON 34
ci_036                 1.043145e-03 3 1  ON 35
ci_037                 4.953346e-03 3 1  ON 36
ci_038                 5.099304e-03 3 1  ON 37
ci_039                 5.306398e-03 3 1  ON 38
ci_040                 5.323078e-03 3 1  ON 39
ci_041                 4.970499e-03 3 1  ON 40
ci_042                 5.231223e-03 3 1  ON 41
ci_043                 4.943049e-03 3 1  ON 42
ci_044                 4.944179e-03 3 1  ON 43
ci_045                 3.123964e-03 3 1  ON 44
ci_046                 3.174255e-03 3 1  ON 45
ci_047                -7.790168e-04 3 1  ON 46
ci_048                -5.616932e-04 3 1  ON 47
ci_049                 1.580280e-03 3 1  ON 48
ci_050                 1.792518e-03 3 1  ON 49
ci_051                -1.106652e-03 3 1  ON 50
ci_052                -1.243277e-03 3 1  ON 51
ci_053                -2.610477e-03 3 1  ON 52
ci_054                -2.301970e-03 3 1  ON 53
ci_055                -1.483466e-03 3 1  ON 54
ci_056                -1.376722e-03 3 1  ON 55
ci_057                -1.240712e-03 3 1  ON 56
ci_058                -1.731068e-03 3 1  ON 57
ci_059                 3.171771e-04 3 1  ON 58
ci_060                 1.414787e-04 3 1  ON 59
ci_061                -3.305039e-04 3 1  ON 60
ci_062                -9.503876e-06 3 1  ON 61
ci_063                -5.233031e-04 3 1  ON 62
ci_064                -8.918426e-04 3 1  ON 63
ci_065                -2.408136e-03 3 1  ON 64
ci_066                -2.435293e-03 3 1  ON 65
ci_067                -2.101087e-03 3 1  ON 66
ci_068                -2.473559e-03 3 1  ON 67
ci_069                -2.085987e-04 3 1  ON 68
ci_070                 1.328498e-04 3 1  ON 69
ci_071                -1.874234e-03 3 1  ON 70
ci_072                -1.959422e-03 3 1  ON 71
ci_073                 5.748997e-04 3 1  ON 72
ci_074                 2.857372e-04 3 1  ON 73
ci_075                -2.910314e-04 3 1  ON 74
ci_076                -2.990974e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="250">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =8000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 60
    time step          = 0.05
    reference energy   = -22.6864
    reference variance = 0.252904
====================================================
  Execution time = 1.0065e+02
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s060
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 62500 
  VMC Eavg = -2.2670e+01
  VMC Evar = 5.1091e-01
  Total weights = 7.8202e+06
  Execution time = 1.4632e+01
  </log>
</opt>
<opt stage="main" walkers="62500">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.496901521053
                                         uncertainty =       0.001408848487

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.496901521053
                                         uncertainty =       0.001408848487

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000249223920
  error estimate for blocks of size 2^( 2) =       0.000258110845
  error estimate for blocks of size 2^( 3) =       0.000266195865
  error estimate for blocks of size 2^( 4) =       0.000272112291
  error estimate for blocks of size 2^( 5) =       0.000275462148
  error estimate for blocks of size 2^( 6) =       0.000277209271
  error estimate for blocks of size 2^( 7) =       0.000278843433
  error estimate for blocks of size 2^( 8) =       0.000279043380
  error estimate for blocks of size 2^( 9) =       0.000279424091

      target function =                  N/A
              le_mean =     -22.669580793553
             les_mean =     514.420806605858
             stat err =       0.000278630044
             autocorr =       1.249903375797
              std dev =       0.704911695024
             le_variance =       0.496900497781

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.496901532304
                                         uncertainty =       0.001408855115

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.496901532304
                                         uncertainty =       0.001408855115

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000249223923
  error estimate for blocks of size 2^( 2) =       0.000258110848
  error estimate for blocks of size 2^( 3) =       0.000266195868
  error estimate for blocks of size 2^( 4) =       0.000272112293
  error estimate for blocks of size 2^( 5) =       0.000275462151
  error estimate for blocks of size 2^( 6) =       0.000277209274
  error estimate for blocks of size 2^( 7) =       0.000278843435
  error estimate for blocks of size 2^( 8) =       0.000279043382
  error estimate for blocks of size 2^( 9) =       0.000279424093

      target function =                  N/A
              le_mean =     -22.669580793456
             les_mean =     514.420807143612
             stat err =       0.000278630046
             autocorr =       1.249903370535
              std dev =       0.704911703009
             le_variance =       0.496900509039

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.496901526678
                                         uncertainty =       0.001408851801

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.496901526678
                                         uncertainty =       0.001408851801

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000249223921
  error estimate for blocks of size 2^( 2) =       0.000258110847
  error estimate for blocks of size 2^( 3) =       0.000266195867
  error estimate for blocks of size 2^( 4) =       0.000272112292
  error estimate for blocks of size 2^( 5) =       0.000275462149
  error estimate for blocks of size 2^( 6) =       0.000277209273
  error estimate for blocks of size 2^( 7) =       0.000278843434
  error estimate for blocks of size 2^( 8) =       0.000279043381
  error estimate for blocks of size 2^( 9) =       0.000279424092

      target function =                  N/A
              le_mean =     -22.669580793504
             les_mean =     514.420806874335
             stat err =       0.000278630045
             autocorr =       1.249903373152
              std dev =       0.704911699016
             le_variance =       0.496900503410

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.496901521756
                                         uncertainty =       0.001408848901

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.496901521756
                                         uncertainty =       0.001408848901

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000249223920
  error estimate for blocks of size 2^( 2) =       0.000258110846
  error estimate for blocks of size 2^( 3) =       0.000266195866
  error estimate for blocks of size 2^( 4) =       0.000272112291
  error estimate for blocks of size 2^( 5) =       0.000275462148
  error estimate for blocks of size 2^( 6) =       0.000277209271
  error estimate for blocks of size 2^( 7) =       0.000278843433
  error estimate for blocks of size 2^( 8) =       0.000279043380
  error estimate for blocks of size 2^( 9) =       0.000279424091

      target function =                  N/A
              le_mean =     -22.669580793547
             les_mean =     514.420806639373
             stat err =       0.000278630044
             autocorr =       1.249903375426
              std dev =       0.704911695522
             le_variance =       0.496900498484


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.669580793553        initial  <--
     3.4694e+03     3.4694e+04             6.1963e-08       -22.669580793456
     1.3878e+04     1.3878e+05             1.5491e-08       -22.669580793504
     5.5511e+04     5.5511e+05             3.8728e-09       -22.669580793547

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 174.0443
  </log>
  <optVariables href="FORM.s060.opt.xml">
ci_001                -7.050617e-01 3 1  ON 0
ci_002                -7.059926e-01 3 1  ON 1
ci_003                -3.765135e-02 3 1  ON 2
ci_004                -3.890325e-02 3 1  ON 3
ci_005                 1.612441e-02 3 1  ON 4
ci_006                 1.600090e-02 3 1  ON 5
ci_007                 1.228713e-02 3 1  ON 6
ci_008                 1.246533e-02 3 1  ON 7
ci_009                -1.173869e-02 3 1  ON 8
ci_010                -1.182876e-02 3 1  ON 9
ci_011                -8.176403e-03 3 1  ON 10
ci_012                -8.138278e-03 3 1  ON 11
ci_013                 9.647137e-03 3 1  ON 12
ci_014                 9.360580e-03 3 1  ON 13
ci_015                 1.228715e-02 3 1  ON 14
ci_016                 1.255400e-02 3 1  ON 15
ci_017                 1.088300e-02 3 1  ON 16
ci_018                 1.078149e-02 3 1  ON 17
ci_019                -2.514322e-03 3 1  ON 18
ci_020                -2.423765e-03 3 1  ON 19
ci_021                -8.459776e-03 3 1  ON 20
ci_022                -8.657034e-03 3 1  ON 21
ci_023                 7.805043e-03 3 1  ON 22
ci_024                 8.041852e-03 3 1  ON 23
ci_025                 4.702642e-03 3 1  ON 24
ci_026                 4.273172e-03 3 1  ON 25
ci_027                 6.454089e-03 3 1  ON 26
ci_028                 6.476482e-03 3 1  ON 27
ci_029                -4.877820e-03 3 1  ON 28
ci_030                -4.785596e-03 3 1  ON 29
ci_031                -7.388694e-03 3 1  ON 30
ci_032                -8.123179e-03 3 1  ON 31
ci_033                 4.600637e-03 3 1  ON 32
ci_034                 4.413553e-03 3 1  ON 33
ci_035                 1.126907e-03 3 1  ON 34
ci_036                 1.043146e-03 3 1  ON 35
ci_037                 4.953347e-03 3 1  ON 36
ci_038                 5.099310e-03 3 1  ON 37
ci_039                 5.306386e-03 3 1  ON 38
ci_040                 5.323086e-03 3 1  ON 39
ci_041                 4.970499e-03 3 1  ON 40
ci_042                 5.231233e-03 3 1  ON 41
ci_043                 4.943052e-03 3 1  ON 42
ci_044                 4.944182e-03 3 1  ON 43
ci_045                 3.123967e-03 3 1  ON 44
ci_046                 3.174246e-03 3 1  ON 45
ci_047                -7.790222e-04 3 1  ON 46
ci_048                -5.616836e-04 3 1  ON 47
ci_049                 1.580289e-03 3 1  ON 48
ci_050                 1.792516e-03 3 1  ON 49
ci_051                -1.106651e-03 3 1  ON 50
ci_052                -1.243279e-03 3 1  ON 51
ci_053                -2.610471e-03 3 1  ON 52
ci_054                -2.301978e-03 3 1  ON 53
ci_055                -1.483475e-03 3 1  ON 54
ci_056                -1.376714e-03 3 1  ON 55
ci_057                -1.240708e-03 3 1  ON 56
ci_058                -1.731077e-03 3 1  ON 57
ci_059                 3.171692e-04 3 1  ON 58
ci_060                 1.414703e-04 3 1  ON 59
ci_061                -3.305088e-04 3 1  ON 60
ci_062                -9.499769e-06 3 1  ON 61
ci_063                -5.232922e-04 3 1  ON 62
ci_064                -8.918525e-04 3 1  ON 63
ci_065                -2.408143e-03 3 1  ON 64
ci_066                -2.435285e-03 3 1  ON 65
ci_067                -2.101084e-03 3 1  ON 66
ci_068                -2.473560e-03 3 1  ON 67
ci_069                -2.085964e-04 3 1  ON 68
ci_070                 1.328450e-04 3 1  ON 69
ci_071                -1.874230e-03 3 1  ON 70
ci_072                -1.959430e-03 3 1  ON 71
ci_073                 5.749021e-04 3 1  ON 72
ci_074                 2.857507e-04 3 1  ON 73
ci_075                -2.910323e-04 3 1  ON 74
ci_076                -2.990999e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 2.9342e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s061 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s061 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=61  my_counter=0
  time step      = 5.0000e-02
  blocks         = 250
  steps          = 250
  substeps       = 10
  current        = 0
  target samples = 8.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">250</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">6.2500e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">8.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">6.2500e+04</parameter>
<parameter name="steps" condition="int">250</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2662e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="250">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =8000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 61
    time step          = 0.05
    reference energy   = -22.6816
    reference variance = 0.564204
====================================================
  Execution time = 1.0286e+02
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s061
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 62500 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 6.1108e+04
  VMC Eavg = -2.2670e+01
  VMC Evar = 5.0569e-01
  Total weights = 7.819961003e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.9027e+01
  </log>
</opt>
<opt stage="main" walkers="62500">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.493775598560
                                         uncertainty =       0.001232775431

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.493775598560
                                         uncertainty =       0.001232775431

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000248439069
  error estimate for blocks of size 2^( 2) =       0.000257437344
  error estimate for blocks of size 2^( 3) =       0.000265677112
  error estimate for blocks of size 2^( 4) =       0.000271608322
  error estimate for blocks of size 2^( 5) =       0.000275158146
  error estimate for blocks of size 2^( 6) =       0.000276961545
  error estimate for blocks of size 2^( 7) =       0.000277961036
  error estimate for blocks of size 2^( 8) =       0.000277960527
  error estimate for blocks of size 2^( 9) =       0.000279558302

      target function =                  N/A
              le_mean =     -22.669648233273
             les_mean =     514.418642699883
             stat err =       0.000278110352
             autocorr =       1.253125372967
              std dev =       0.702691802494
             le_variance =       0.493775769292


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266964823327e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.4694e+04, overlap shift 3.4694e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.669648233296       residual = 3.78e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.669648233284       residual = 6.79e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.669648233284       residual = 1.60e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.669648233284       residual = 6.74e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 3.4694e+04 is 5.297859e-09

solving harmonic davidson linear method for identity shift 1.3878e+05, overlap shift 1.3878e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.669648233296       residual = 3.78e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.669648233293       residual = 6.79e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.669648233293       residual = 1.60e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.669648233293       residual = 6.74e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 1.3878e+05 is 1.324472e-09

solving harmonic davidson linear method for identity shift 5.5511e+05, overlap shift 5.5511e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.669648233296       residual = 3.78e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.669648233295       residual = 6.79e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.669648233295       residual = 1.60e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.669648233488       residual = 6.74e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 5.5511e+05 is 3.311185e-10

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.121154 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.2190e+02
  </log>
  <optVariables href="FORM.s061.opt.xml">
ci_001                -7.050617e-01 3 1  ON 0
ci_002                -7.059926e-01 3 1  ON 1
ci_003                -3.765135e-02 3 1  ON 2
ci_004                -3.890325e-02 3 1  ON 3
ci_005                 1.612441e-02 3 1  ON 4
ci_006                 1.600090e-02 3 1  ON 5
ci_007                 1.228713e-02 3 1  ON 6
ci_008                 1.246533e-02 3 1  ON 7
ci_009                -1.173869e-02 3 1  ON 8
ci_010                -1.182876e-02 3 1  ON 9
ci_011                -8.176402e-03 3 1  ON 10
ci_012                -8.138277e-03 3 1  ON 11
ci_013                 9.647137e-03 3 1  ON 12
ci_014                 9.360580e-03 3 1  ON 13
ci_015                 1.228715e-02 3 1  ON 14
ci_016                 1.255400e-02 3 1  ON 15
ci_017                 1.088300e-02 3 1  ON 16
ci_018                 1.078149e-02 3 1  ON 17
ci_019                -2.514322e-03 3 1  ON 18
ci_020                -2.423764e-03 3 1  ON 19
ci_021                -8.459776e-03 3 1  ON 20
ci_022                -8.657033e-03 3 1  ON 21
ci_023                 7.805042e-03 3 1  ON 22
ci_024                 8.041852e-03 3 1  ON 23
ci_025                 4.702641e-03 3 1  ON 24
ci_026                 4.273172e-03 3 1  ON 25
ci_027                 6.454089e-03 3 1  ON 26
ci_028                 6.476482e-03 3 1  ON 27
ci_029                -4.877820e-03 3 1  ON 28
ci_030                -4.785596e-03 3 1  ON 29
ci_031                -7.388696e-03 3 1  ON 30
ci_032                -8.123178e-03 3 1  ON 31
ci_033                 4.600636e-03 3 1  ON 32
ci_034                 4.413553e-03 3 1  ON 33
ci_035                 1.126908e-03 3 1  ON 34
ci_036                 1.043146e-03 3 1  ON 35
ci_037                 4.953347e-03 3 1  ON 36
ci_038                 5.099310e-03 3 1  ON 37
ci_039                 5.306386e-03 3 1  ON 38
ci_040                 5.323088e-03 3 1  ON 39
ci_041                 4.970498e-03 3 1  ON 40
ci_042                 5.231232e-03 3 1  ON 41
ci_043                 4.943052e-03 3 1  ON 42
ci_044                 4.944182e-03 3 1  ON 43
ci_045                 3.123968e-03 3 1  ON 44
ci_046                 3.174246e-03 3 1  ON 45
ci_047                -7.790218e-04 3 1  ON 46
ci_048                -5.616841e-04 3 1  ON 47
ci_049                 1.580290e-03 3 1  ON 48
ci_050                 1.792516e-03 3 1  ON 49
ci_051                -1.106650e-03 3 1  ON 50
ci_052                -1.243279e-03 3 1  ON 51
ci_053                -2.610471e-03 3 1  ON 52
ci_054                -2.301979e-03 3 1  ON 53
ci_055                -1.483476e-03 3 1  ON 54
ci_056                -1.376715e-03 3 1  ON 55
ci_057                -1.240708e-03 3 1  ON 56
ci_058                -1.731077e-03 3 1  ON 57
ci_059                 3.171687e-04 3 1  ON 58
ci_060                 1.414699e-04 3 1  ON 59
ci_061                -3.305084e-04 3 1  ON 60
ci_062                -9.500490e-06 3 1  ON 61
ci_063                -5.232922e-04 3 1  ON 62
ci_064                -8.918517e-04 3 1  ON 63
ci_065                -2.408143e-03 3 1  ON 64
ci_066                -2.435285e-03 3 1  ON 65
ci_067                -2.101083e-03 3 1  ON 66
ci_068                -2.473560e-03 3 1  ON 67
ci_069                -2.085956e-04 3 1  ON 68
ci_070                 1.328451e-04 3 1  ON 69
ci_071                -1.874229e-03 3 1  ON 70
ci_072                -1.959430e-03 3 1  ON 71
ci_073                 5.749009e-04 3 1  ON 72
ci_074                 2.857508e-04 3 1  ON 73
ci_075                -2.910320e-04 3 1  ON 74
ci_076                -2.990992e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="250">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =8000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 61
    time step          = 0.05
    reference energy   = -22.7136
    reference variance = 0.543423
====================================================
  Execution time = 1.0199e+02
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s061
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 62500 
  VMC Eavg = -2.2670e+01
  VMC Evar = 5.1284e-01
  Total weights = 7.8203e+06
  Execution time = 1.4659e+01
  </log>
</opt>
<opt stage="main" walkers="62500">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.497208088499
                                         uncertainty =       0.001701659236

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.497208088499
                                         uncertainty =       0.001701659236

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000249301365
  error estimate for blocks of size 2^( 2) =       0.000258202869
  error estimate for blocks of size 2^( 3) =       0.000266147941
  error estimate for blocks of size 2^( 4) =       0.000271784461
  error estimate for blocks of size 2^( 5) =       0.000274827472
  error estimate for blocks of size 2^( 6) =       0.000276151673
  error estimate for blocks of size 2^( 7) =       0.000277091811
  error estimate for blocks of size 2^( 8) =       0.000278203770
  error estimate for blocks of size 2^( 9) =       0.000278550551

      target function =                  N/A
              le_mean =     -22.669890949782
             les_mean =     514.436797879766
             stat err =       0.000277499451
             autocorr =       1.239010380970
              std dev =       0.705130742206
             le_variance =       0.497209363604

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.497208087010
                                         uncertainty =       0.001701659361

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.497208087010
                                         uncertainty =       0.001701659361

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000249301364
  error estimate for blocks of size 2^( 2) =       0.000258202868
  error estimate for blocks of size 2^( 3) =       0.000266147941
  error estimate for blocks of size 2^( 4) =       0.000271784461
  error estimate for blocks of size 2^( 5) =       0.000274827472
  error estimate for blocks of size 2^( 6) =       0.000276151672
  error estimate for blocks of size 2^( 7) =       0.000277091810
  error estimate for blocks of size 2^( 8) =       0.000278203769
  error estimate for blocks of size 2^( 9) =       0.000278550551

      target function =                  N/A
              le_mean =     -22.669890949719
             les_mean =     514.436797722111
             stat err =       0.000277499451
             autocorr =       1.239010381676
              std dev =       0.705130741150
             le_variance =       0.497209362115

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.497208087755
                                         uncertainty =       0.001701659298

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.497208087755
                                         uncertainty =       0.001701659298

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000249301365
  error estimate for blocks of size 2^( 2) =       0.000258202868
  error estimate for blocks of size 2^( 3) =       0.000266147941
  error estimate for blocks of size 2^( 4) =       0.000271784461
  error estimate for blocks of size 2^( 5) =       0.000274827472
  error estimate for blocks of size 2^( 6) =       0.000276151672
  error estimate for blocks of size 2^( 7) =       0.000277091811
  error estimate for blocks of size 2^( 8) =       0.000278203770
  error estimate for blocks of size 2^( 9) =       0.000278550551

      target function =                  N/A
              le_mean =     -22.669890949750
             les_mean =     514.436797800924
             stat err =       0.000277499451
             autocorr =       1.239010381309
              std dev =       0.705130741678
             le_variance =       0.497209362859

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.497208088406
                                         uncertainty =       0.001701659243

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.497208088406
                                         uncertainty =       0.001701659243

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000249301365
  error estimate for blocks of size 2^( 2) =       0.000258202869
  error estimate for blocks of size 2^( 3) =       0.000266147941
  error estimate for blocks of size 2^( 4) =       0.000271784461
  error estimate for blocks of size 2^( 5) =       0.000274827472
  error estimate for blocks of size 2^( 6) =       0.000276151673
  error estimate for blocks of size 2^( 7) =       0.000277091811
  error estimate for blocks of size 2^( 8) =       0.000278203770
  error estimate for blocks of size 2^( 9) =       0.000278550552

      target function =                  N/A
              le_mean =     -22.669890949778
             les_mean =     514.436797869909
             stat err =       0.000277499451
             autocorr =       1.239010381055
              std dev =       0.705130742139
             le_variance =       0.497209363510


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.669890949782        initial  <--
     3.4694e+04     3.4694e+05             5.2979e-09       -22.669890949719
     1.3878e+05     1.3878e+06             1.3245e-09       -22.669890949750
     5.5511e+05     5.5511e+06             3.3112e-10       -22.669890949778

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 175.4893
  </log>
  <optVariables href="FORM.s061.opt.xml">
ci_001                -7.050617e-01 3 1  ON 0
ci_002                -7.059926e-01 3 1  ON 1
ci_003                -3.765135e-02 3 1  ON 2
ci_004                -3.890325e-02 3 1  ON 3
ci_005                 1.612441e-02 3 1  ON 4
ci_006                 1.600090e-02 3 1  ON 5
ci_007                 1.228713e-02 3 1  ON 6
ci_008                 1.246533e-02 3 1  ON 7
ci_009                -1.173869e-02 3 1  ON 8
ci_010                -1.182876e-02 3 1  ON 9
ci_011                -8.176403e-03 3 1  ON 10
ci_012                -8.138278e-03 3 1  ON 11
ci_013                 9.647137e-03 3 1  ON 12
ci_014                 9.360580e-03 3 1  ON 13
ci_015                 1.228715e-02 3 1  ON 14
ci_016                 1.255400e-02 3 1  ON 15
ci_017                 1.088300e-02 3 1  ON 16
ci_018                 1.078149e-02 3 1  ON 17
ci_019                -2.514322e-03 3 1  ON 18
ci_020                -2.423765e-03 3 1  ON 19
ci_021                -8.459776e-03 3 1  ON 20
ci_022                -8.657034e-03 3 1  ON 21
ci_023                 7.805043e-03 3 1  ON 22
ci_024                 8.041852e-03 3 1  ON 23
ci_025                 4.702642e-03 3 1  ON 24
ci_026                 4.273172e-03 3 1  ON 25
ci_027                 6.454089e-03 3 1  ON 26
ci_028                 6.476482e-03 3 1  ON 27
ci_029                -4.877820e-03 3 1  ON 28
ci_030                -4.785596e-03 3 1  ON 29
ci_031                -7.388694e-03 3 1  ON 30
ci_032                -8.123179e-03 3 1  ON 31
ci_033                 4.600637e-03 3 1  ON 32
ci_034                 4.413553e-03 3 1  ON 33
ci_035                 1.126907e-03 3 1  ON 34
ci_036                 1.043146e-03 3 1  ON 35
ci_037                 4.953347e-03 3 1  ON 36
ci_038                 5.099310e-03 3 1  ON 37
ci_039                 5.306386e-03 3 1  ON 38
ci_040                 5.323086e-03 3 1  ON 39
ci_041                 4.970499e-03 3 1  ON 40
ci_042                 5.231233e-03 3 1  ON 41
ci_043                 4.943052e-03 3 1  ON 42
ci_044                 4.944182e-03 3 1  ON 43
ci_045                 3.123967e-03 3 1  ON 44
ci_046                 3.174246e-03 3 1  ON 45
ci_047                -7.790222e-04 3 1  ON 46
ci_048                -5.616836e-04 3 1  ON 47
ci_049                 1.580289e-03 3 1  ON 48
ci_050                 1.792516e-03 3 1  ON 49
ci_051                -1.106651e-03 3 1  ON 50
ci_052                -1.243279e-03 3 1  ON 51
ci_053                -2.610471e-03 3 1  ON 52
ci_054                -2.301978e-03 3 1  ON 53
ci_055                -1.483475e-03 3 1  ON 54
ci_056                -1.376714e-03 3 1  ON 55
ci_057                -1.240708e-03 3 1  ON 56
ci_058                -1.731077e-03 3 1  ON 57
ci_059                 3.171692e-04 3 1  ON 58
ci_060                 1.414703e-04 3 1  ON 59
ci_061                -3.305088e-04 3 1  ON 60
ci_062                -9.499769e-06 3 1  ON 61
ci_063                -5.232922e-04 3 1  ON 62
ci_064                -8.918525e-04 3 1  ON 63
ci_065                -2.408143e-03 3 1  ON 64
ci_066                -2.435285e-03 3 1  ON 65
ci_067                -2.101084e-03 3 1  ON 66
ci_068                -2.473560e-03 3 1  ON 67
ci_069                -2.085964e-04 3 1  ON 68
ci_070                 1.328450e-04 3 1  ON 69
ci_071                -1.874230e-03 3 1  ON 70
ci_072                -1.959430e-03 3 1  ON 71
ci_073                 5.749021e-04 3 1  ON 72
ci_074                 2.857507e-04 3 1  ON 73
ci_075                -2.910323e-04 3 1  ON 74
ci_076                -2.990999e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 2.9740e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s062 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s062 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=62  my_counter=0
  time step      = 5.0000e-02
  blocks         = 250
  steps          = 250
  substeps       = 10
  current        = 0
  target samples = 8.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">250</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">6.2500e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">8.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">6.2500e+04</parameter>
<parameter name="steps" condition="int">250</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2663e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="250">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =8000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 62
    time step          = 0.05
    reference energy   = -22.6416
    reference variance = 0.333195
====================================================
  Execution time = 1.0254e+02
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s062
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 62500 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 6.1064e+04
  VMC Eavg = -2.2670e+01
  VMC Evar = 5.1139e-01
  Total weights = 7.820897135e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.9271e+01
  </log>
</opt>
<opt stage="main" walkers="62500">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.498128632495
                                         uncertainty =       0.002126918725

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.498128632495
                                         uncertainty =       0.002126918725

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000249531521
  error estimate for blocks of size 2^( 2) =       0.000258464312
  error estimate for blocks of size 2^( 3) =       0.000266494242
  error estimate for blocks of size 2^( 4) =       0.000272331473
  error estimate for blocks of size 2^( 5) =       0.000275921699
  error estimate for blocks of size 2^( 6) =       0.000277894546
  error estimate for blocks of size 2^( 7) =       0.000278636902
  error estimate for blocks of size 2^( 8) =       0.000279837064
  error estimate for blocks of size 2^( 9) =       0.000279878290

      target function =                  N/A
              le_mean =     -22.670005216948
             les_mean =     514.440525614646
             stat err =       0.000279061701
             autocorr =       1.250689905346
              std dev =       0.705781723050
             le_variance =       0.498127840591


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.267000521695e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.4694e+05, overlap shift 3.4694e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.670005216975       residual = 4.05e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.670005216979       residual = 4.67e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.670005216979       residual = 1.45e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.670005216979       residual = 4.20e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 3.4694e+05 is 6.483417e-10

solving harmonic davidson linear method for identity shift 1.3878e+06, overlap shift 1.3878e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.670005216975       residual = 4.05e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.670005216976       residual = 4.67e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.670005216976       residual = 1.45e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.670005216976       residual = 4.20e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 1.3878e+06 is 1.620855e-10

solving harmonic davidson linear method for identity shift 5.5511e+06, overlap shift 5.5511e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.670005216975       residual = 4.05e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.670005216975       residual = 4.67e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.670005216975       residual = 1.45e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.670005216975       residual = 4.20e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 5.5511e+06 is 4.052143e-11

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.122600 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.2183e+02
  </log>
  <optVariables href="FORM.s062.opt.xml">
ci_001                -7.050617e-01 3 1  ON 0
ci_002                -7.059926e-01 3 1  ON 1
ci_003                -3.765135e-02 3 1  ON 2
ci_004                -3.890325e-02 3 1  ON 3
ci_005                 1.612441e-02 3 1  ON 4
ci_006                 1.600090e-02 3 1  ON 5
ci_007                 1.228713e-02 3 1  ON 6
ci_008                 1.246533e-02 3 1  ON 7
ci_009                -1.173869e-02 3 1  ON 8
ci_010                -1.182876e-02 3 1  ON 9
ci_011                -8.176403e-03 3 1  ON 10
ci_012                -8.138278e-03 3 1  ON 11
ci_013                 9.647137e-03 3 1  ON 12
ci_014                 9.360580e-03 3 1  ON 13
ci_015                 1.228715e-02 3 1  ON 14
ci_016                 1.255400e-02 3 1  ON 15
ci_017                 1.088300e-02 3 1  ON 16
ci_018                 1.078149e-02 3 1  ON 17
ci_019                -2.514322e-03 3 1  ON 18
ci_020                -2.423765e-03 3 1  ON 19
ci_021                -8.459776e-03 3 1  ON 20
ci_022                -8.657034e-03 3 1  ON 21
ci_023                 7.805043e-03 3 1  ON 22
ci_024                 8.041852e-03 3 1  ON 23
ci_025                 4.702642e-03 3 1  ON 24
ci_026                 4.273172e-03 3 1  ON 25
ci_027                 6.454089e-03 3 1  ON 26
ci_028                 6.476482e-03 3 1  ON 27
ci_029                -4.877820e-03 3 1  ON 28
ci_030                -4.785596e-03 3 1  ON 29
ci_031                -7.388694e-03 3 1  ON 30
ci_032                -8.123179e-03 3 1  ON 31
ci_033                 4.600636e-03 3 1  ON 32
ci_034                 4.413553e-03 3 1  ON 33
ci_035                 1.126907e-03 3 1  ON 34
ci_036                 1.043146e-03 3 1  ON 35
ci_037                 4.953347e-03 3 1  ON 36
ci_038                 5.099310e-03 3 1  ON 37
ci_039                 5.306386e-03 3 1  ON 38
ci_040                 5.323086e-03 3 1  ON 39
ci_041                 4.970499e-03 3 1  ON 40
ci_042                 5.231233e-03 3 1  ON 41
ci_043                 4.943052e-03 3 1  ON 42
ci_044                 4.944181e-03 3 1  ON 43
ci_045                 3.123967e-03 3 1  ON 44
ci_046                 3.174246e-03 3 1  ON 45
ci_047                -7.790222e-04 3 1  ON 46
ci_048                -5.616835e-04 3 1  ON 47
ci_049                 1.580289e-03 3 1  ON 48
ci_050                 1.792516e-03 3 1  ON 49
ci_051                -1.106651e-03 3 1  ON 50
ci_052                -1.243278e-03 3 1  ON 51
ci_053                -2.610471e-03 3 1  ON 52
ci_054                -2.301978e-03 3 1  ON 53
ci_055                -1.483475e-03 3 1  ON 54
ci_056                -1.376714e-03 3 1  ON 55
ci_057                -1.240708e-03 3 1  ON 56
ci_058                -1.731077e-03 3 1  ON 57
ci_059                 3.171691e-04 3 1  ON 58
ci_060                 1.414703e-04 3 1  ON 59
ci_061                -3.305087e-04 3 1  ON 60
ci_062                -9.499805e-06 3 1  ON 61
ci_063                -5.232921e-04 3 1  ON 62
ci_064                -8.918524e-04 3 1  ON 63
ci_065                -2.408143e-03 3 1  ON 64
ci_066                -2.435285e-03 3 1  ON 65
ci_067                -2.101084e-03 3 1  ON 66
ci_068                -2.473560e-03 3 1  ON 67
ci_069                -2.085964e-04 3 1  ON 68
ci_070                 1.328450e-04 3 1  ON 69
ci_071                -1.874230e-03 3 1  ON 70
ci_072                -1.959430e-03 3 1  ON 71
ci_073                 5.749021e-04 3 1  ON 72
ci_074                 2.857508e-04 3 1  ON 73
ci_075                -2.910322e-04 3 1  ON 74
ci_076                -2.990999e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="250">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =8000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 62
    time step          = 0.05
    reference energy   = -22.5684
    reference variance = 0.352147
====================================================
  Execution time = 1.0226e+02
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s062
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 62500 
  VMC Eavg = -2.2670e+01
  VMC Evar = 5.0838e-01
  Total weights = 7.8205e+06
  Execution time = 1.4659e+01
  </log>
</opt>
<opt stage="main" walkers="62500">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.495327446466
                                         uncertainty =       0.001339366096

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.495327446466
                                         uncertainty =       0.001339366096

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000248829149
  error estimate for blocks of size 2^( 2) =       0.000257865942
  error estimate for blocks of size 2^( 3) =       0.000265981744
  error estimate for blocks of size 2^( 4) =       0.000271713957
  error estimate for blocks of size 2^( 5) =       0.000275036364
  error estimate for blocks of size 2^( 6) =       0.000276442263
  error estimate for blocks of size 2^( 7) =       0.000277176012
  error estimate for blocks of size 2^( 8) =       0.000277730534
  error estimate for blocks of size 2^( 9) =       0.000277122830

      target function =                  N/A
              le_mean =     -22.669631162136
             les_mean =     514.420552547646
             stat err =       0.000277117910
             autocorr =       1.240299821332
              std dev =       0.703795114066
             le_variance =       0.495327562583

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.495327446356
                                         uncertainty =       0.001339366097

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.495327446356
                                         uncertainty =       0.001339366097

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000248829149
  error estimate for blocks of size 2^( 2) =       0.000257865942
  error estimate for blocks of size 2^( 3) =       0.000265981744
  error estimate for blocks of size 2^( 4) =       0.000271713957
  error estimate for blocks of size 2^( 5) =       0.000275036364
  error estimate for blocks of size 2^( 6) =       0.000276442263
  error estimate for blocks of size 2^( 7) =       0.000277176012
  error estimate for blocks of size 2^( 8) =       0.000277730534
  error estimate for blocks of size 2^( 9) =       0.000277122830

      target function =                  N/A
              le_mean =     -22.669631162136
             les_mean =     514.420552547152
             stat err =       0.000277117910
             autocorr =       1.240299821435
              std dev =       0.703795113988
             le_variance =       0.495327562473

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.495327446411
                                         uncertainty =       0.001339366096

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.495327446411
                                         uncertainty =       0.001339366096

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000248829149
  error estimate for blocks of size 2^( 2) =       0.000257865942
  error estimate for blocks of size 2^( 3) =       0.000265981744
  error estimate for blocks of size 2^( 4) =       0.000271713957
  error estimate for blocks of size 2^( 5) =       0.000275036364
  error estimate for blocks of size 2^( 6) =       0.000276442263
  error estimate for blocks of size 2^( 7) =       0.000277176012
  error estimate for blocks of size 2^( 8) =       0.000277730534
  error estimate for blocks of size 2^( 9) =       0.000277122830

      target function =                  N/A
              le_mean =     -22.669631162136
             les_mean =     514.420552547399
             stat err =       0.000277117910
             autocorr =       1.240299821393
              std dev =       0.703795114026
             le_variance =       0.495327562527

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.495327446459
                                         uncertainty =       0.001339366096

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.495327446459
                                         uncertainty =       0.001339366096

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000248829149
  error estimate for blocks of size 2^( 2) =       0.000257865942
  error estimate for blocks of size 2^( 3) =       0.000265981744
  error estimate for blocks of size 2^( 4) =       0.000271713957
  error estimate for blocks of size 2^( 5) =       0.000275036364
  error estimate for blocks of size 2^( 6) =       0.000276442263
  error estimate for blocks of size 2^( 7) =       0.000277176012
  error estimate for blocks of size 2^( 8) =       0.000277730534
  error estimate for blocks of size 2^( 9) =       0.000277122830

      target function =                  N/A
              le_mean =     -22.669631162136
             les_mean =     514.420552547615
             stat err =       0.000277117910
             autocorr =       1.240299821342
              std dev =       0.703795114061
             le_variance =       0.495327562576


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.669631162136        initial  <--
     3.4694e+05     3.4694e+06             6.4834e-10       -22.669631162136
     1.3878e+06     1.3878e+07             1.6209e-10       -22.669631162136
     5.5511e+06     5.5511e+07             4.0521e-11       -22.669631162136

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 175.8308
  </log>
  <optVariables href="FORM.s062.opt.xml">
ci_001                -7.050617e-01 3 1  ON 0
ci_002                -7.059926e-01 3 1  ON 1
ci_003                -3.765135e-02 3 1  ON 2
ci_004                -3.890325e-02 3 1  ON 3
ci_005                 1.612441e-02 3 1  ON 4
ci_006                 1.600090e-02 3 1  ON 5
ci_007                 1.228713e-02 3 1  ON 6
ci_008                 1.246533e-02 3 1  ON 7
ci_009                -1.173869e-02 3 1  ON 8
ci_010                -1.182876e-02 3 1  ON 9
ci_011                -8.176403e-03 3 1  ON 10
ci_012                -8.138278e-03 3 1  ON 11
ci_013                 9.647137e-03 3 1  ON 12
ci_014                 9.360580e-03 3 1  ON 13
ci_015                 1.228715e-02 3 1  ON 14
ci_016                 1.255400e-02 3 1  ON 15
ci_017                 1.088300e-02 3 1  ON 16
ci_018                 1.078149e-02 3 1  ON 17
ci_019                -2.514322e-03 3 1  ON 18
ci_020                -2.423765e-03 3 1  ON 19
ci_021                -8.459776e-03 3 1  ON 20
ci_022                -8.657034e-03 3 1  ON 21
ci_023                 7.805043e-03 3 1  ON 22
ci_024                 8.041852e-03 3 1  ON 23
ci_025                 4.702642e-03 3 1  ON 24
ci_026                 4.273172e-03 3 1  ON 25
ci_027                 6.454089e-03 3 1  ON 26
ci_028                 6.476482e-03 3 1  ON 27
ci_029                -4.877820e-03 3 1  ON 28
ci_030                -4.785596e-03 3 1  ON 29
ci_031                -7.388694e-03 3 1  ON 30
ci_032                -8.123179e-03 3 1  ON 31
ci_033                 4.600637e-03 3 1  ON 32
ci_034                 4.413553e-03 3 1  ON 33
ci_035                 1.126907e-03 3 1  ON 34
ci_036                 1.043146e-03 3 1  ON 35
ci_037                 4.953347e-03 3 1  ON 36
ci_038                 5.099310e-03 3 1  ON 37
ci_039                 5.306386e-03 3 1  ON 38
ci_040                 5.323086e-03 3 1  ON 39
ci_041                 4.970499e-03 3 1  ON 40
ci_042                 5.231233e-03 3 1  ON 41
ci_043                 4.943052e-03 3 1  ON 42
ci_044                 4.944182e-03 3 1  ON 43
ci_045                 3.123967e-03 3 1  ON 44
ci_046                 3.174246e-03 3 1  ON 45
ci_047                -7.790222e-04 3 1  ON 46
ci_048                -5.616836e-04 3 1  ON 47
ci_049                 1.580289e-03 3 1  ON 48
ci_050                 1.792516e-03 3 1  ON 49
ci_051                -1.106651e-03 3 1  ON 50
ci_052                -1.243279e-03 3 1  ON 51
ci_053                -2.610471e-03 3 1  ON 52
ci_054                -2.301978e-03 3 1  ON 53
ci_055                -1.483475e-03 3 1  ON 54
ci_056                -1.376714e-03 3 1  ON 55
ci_057                -1.240708e-03 3 1  ON 56
ci_058                -1.731077e-03 3 1  ON 57
ci_059                 3.171692e-04 3 1  ON 58
ci_060                 1.414703e-04 3 1  ON 59
ci_061                -3.305088e-04 3 1  ON 60
ci_062                -9.499769e-06 3 1  ON 61
ci_063                -5.232922e-04 3 1  ON 62
ci_064                -8.918525e-04 3 1  ON 63
ci_065                -2.408143e-03 3 1  ON 64
ci_066                -2.435285e-03 3 1  ON 65
ci_067                -2.101084e-03 3 1  ON 66
ci_068                -2.473560e-03 3 1  ON 67
ci_069                -2.085964e-04 3 1  ON 68
ci_070                 1.328450e-04 3 1  ON 69
ci_071                -1.874230e-03 3 1  ON 70
ci_072                -1.959430e-03 3 1  ON 71
ci_073                 5.749021e-04 3 1  ON 72
ci_074                 2.857507e-04 3 1  ON 73
ci_075                -2.910323e-04 3 1  ON 74
ci_076                -2.990999e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 2.9767e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s063 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s063 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=63  my_counter=0
  time step      = 5.0000e-02
  blocks         = 250
  steps          = 250
  substeps       = 10
  current        = 0
  target samples = 8.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">250</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">6.2500e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">8.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">6.2500e+04</parameter>
<parameter name="steps" condition="int">250</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2662e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="250">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =8000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 63
    time step          = 0.05
    reference energy   = -22.579
    reference variance = 0.515202
====================================================
  Execution time = 1.0258e+02
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s063
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 62500 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 6.1057e+04
  VMC Eavg = -2.2670e+01
  VMC Evar = 5.1004e-01
  Total weights = 7.820055997e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.9323e+01
  </log>
</opt>
<opt stage="main" walkers="62500">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.496161643587
                                         uncertainty =       0.002337365720

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.496161643587
                                         uncertainty =       0.002337365720

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000249037918
  error estimate for blocks of size 2^( 2) =       0.000257992686
  error estimate for blocks of size 2^( 3) =       0.000265940937
  error estimate for blocks of size 2^( 4) =       0.000271700140
  error estimate for blocks of size 2^( 5) =       0.000275333754
  error estimate for blocks of size 2^( 6) =       0.000277457104
  error estimate for blocks of size 2^( 7) =       0.000278426603
  error estimate for blocks of size 2^( 8) =       0.000279300653
  error estimate for blocks of size 2^( 9) =       0.000280194493

      target function =                  N/A
              le_mean =     -22.669555416763
             les_mean =     514.418778128239
             stat err =       0.000278844713
             autocorr =       1.253700725200
              std dev =       0.704385601682
             le_variance =       0.496159075857


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266955541676e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.4694e+06, overlap shift 3.4694e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.669555416787       residual = 3.17e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.669555416787       residual = 4.47e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.669555416787       residual = 1.21e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.669555416787       residual = 2.77e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 3.4694e+06 is 6.321456e-11

solving harmonic davidson linear method for identity shift 1.3878e+07, overlap shift 1.3878e+08 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.669555416787       residual = 3.17e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.669555416787       residual = 4.47e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.669555416787       residual = 1.21e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.669555416787       residual = 2.77e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 1.3878e+07 is 1.580364e-11

solving harmonic davidson linear method for identity shift 5.5511e+07, overlap shift 5.5511e+08 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.669555416787       residual = 3.17e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.669555416787       residual = 4.47e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.669555416787       residual = 1.21e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.669555415170       residual = 2.77e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 5.5511e+07 is 3.950917e-12

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.123953 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.2191e+02
  </log>
  <optVariables href="FORM.s063.opt.xml">
ci_001                -7.050617e-01 3 1  ON 0
ci_002                -7.059926e-01 3 1  ON 1
ci_003                -3.765135e-02 3 1  ON 2
ci_004                -3.890325e-02 3 1  ON 3
ci_005                 1.612441e-02 3 1  ON 4
ci_006                 1.600090e-02 3 1  ON 5
ci_007                 1.228713e-02 3 1  ON 6
ci_008                 1.246533e-02 3 1  ON 7
ci_009                -1.173869e-02 3 1  ON 8
ci_010                -1.182876e-02 3 1  ON 9
ci_011                -8.176403e-03 3 1  ON 10
ci_012                -8.138278e-03 3 1  ON 11
ci_013                 9.647137e-03 3 1  ON 12
ci_014                 9.360580e-03 3 1  ON 13
ci_015                 1.228715e-02 3 1  ON 14
ci_016                 1.255400e-02 3 1  ON 15
ci_017                 1.088300e-02 3 1  ON 16
ci_018                 1.078149e-02 3 1  ON 17
ci_019                -2.514322e-03 3 1  ON 18
ci_020                -2.423765e-03 3 1  ON 19
ci_021                -8.459776e-03 3 1  ON 20
ci_022                -8.657034e-03 3 1  ON 21
ci_023                 7.805043e-03 3 1  ON 22
ci_024                 8.041852e-03 3 1  ON 23
ci_025                 4.702642e-03 3 1  ON 24
ci_026                 4.273172e-03 3 1  ON 25
ci_027                 6.454089e-03 3 1  ON 26
ci_028                 6.476482e-03 3 1  ON 27
ci_029                -4.877820e-03 3 1  ON 28
ci_030                -4.785596e-03 3 1  ON 29
ci_031                -7.388694e-03 3 1  ON 30
ci_032                -8.123179e-03 3 1  ON 31
ci_033                 4.600637e-03 3 1  ON 32
ci_034                 4.413553e-03 3 1  ON 33
ci_035                 1.126907e-03 3 1  ON 34
ci_036                 1.043146e-03 3 1  ON 35
ci_037                 4.953347e-03 3 1  ON 36
ci_038                 5.099310e-03 3 1  ON 37
ci_039                 5.306386e-03 3 1  ON 38
ci_040                 5.323086e-03 3 1  ON 39
ci_041                 4.970499e-03 3 1  ON 40
ci_042                 5.231233e-03 3 1  ON 41
ci_043                 4.943052e-03 3 1  ON 42
ci_044                 4.944182e-03 3 1  ON 43
ci_045                 3.123967e-03 3 1  ON 44
ci_046                 3.174246e-03 3 1  ON 45
ci_047                -7.790222e-04 3 1  ON 46
ci_048                -5.616836e-04 3 1  ON 47
ci_049                 1.580289e-03 3 1  ON 48
ci_050                 1.792516e-03 3 1  ON 49
ci_051                -1.106651e-03 3 1  ON 50
ci_052                -1.243279e-03 3 1  ON 51
ci_053                -2.610471e-03 3 1  ON 52
ci_054                -2.301978e-03 3 1  ON 53
ci_055                -1.483475e-03 3 1  ON 54
ci_056                -1.376714e-03 3 1  ON 55
ci_057                -1.240708e-03 3 1  ON 56
ci_058                -1.731077e-03 3 1  ON 57
ci_059                 3.171691e-04 3 1  ON 58
ci_060                 1.414703e-04 3 1  ON 59
ci_061                -3.305087e-04 3 1  ON 60
ci_062                -9.499781e-06 3 1  ON 61
ci_063                -5.232922e-04 3 1  ON 62
ci_064                -8.918525e-04 3 1  ON 63
ci_065                -2.408143e-03 3 1  ON 64
ci_066                -2.435285e-03 3 1  ON 65
ci_067                -2.101084e-03 3 1  ON 66
ci_068                -2.473560e-03 3 1  ON 67
ci_069                -2.085964e-04 3 1  ON 68
ci_070                 1.328450e-04 3 1  ON 69
ci_071                -1.874230e-03 3 1  ON 70
ci_072                -1.959430e-03 3 1  ON 71
ci_073                 5.749021e-04 3 1  ON 72
ci_074                 2.857507e-04 3 1  ON 73
ci_075                -2.910323e-04 3 1  ON 74
ci_076                -2.990999e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="250">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =8000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 63
    time step          = 0.05
    reference energy   = -22.6946
    reference variance = 0.588554
====================================================
  Execution time = 1.0214e+02
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s063
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 62500 
  VMC Eavg = -2.2670e+01
  VMC Evar = 5.0849e-01
  Total weights = 7.8203e+06
  Execution time = 1.4644e+01
  </log>
</opt>
<opt stage="main" walkers="62500">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.495500034332
                                         uncertainty =       0.001557751908

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.495500034332
                                         uncertainty =       0.001557751908

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000248872073
  error estimate for blocks of size 2^( 2) =       0.000257881836
  error estimate for blocks of size 2^( 3) =       0.000266074460
  error estimate for blocks of size 2^( 4) =       0.000271756929
  error estimate for blocks of size 2^( 5) =       0.000275290661
  error estimate for blocks of size 2^( 6) =       0.000277200763
  error estimate for blocks of size 2^( 7) =       0.000277868311
  error estimate for blocks of size 2^( 8) =       0.000277779237
  error estimate for blocks of size 2^( 9) =       0.000279777274

      target function =                  N/A
              le_mean =     -22.669802459581
             les_mean =     514.428428661914
             stat err =       0.000278156396
             autocorr =       1.249182156515
              std dev =       0.703916521706
             le_variance =       0.495498469531

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.495500034337
                                         uncertainty =       0.001557751908

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.495500034337
                                         uncertainty =       0.001557751908

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000248872073
  error estimate for blocks of size 2^( 2) =       0.000257881836
  error estimate for blocks of size 2^( 3) =       0.000266074460
  error estimate for blocks of size 2^( 4) =       0.000271756929
  error estimate for blocks of size 2^( 5) =       0.000275290661
  error estimate for blocks of size 2^( 6) =       0.000277200763
  error estimate for blocks of size 2^( 7) =       0.000277868311
  error estimate for blocks of size 2^( 8) =       0.000277779237
  error estimate for blocks of size 2^( 9) =       0.000279777274

      target function =                  N/A
              le_mean =     -22.669802459581
             les_mean =     514.428428661888
             stat err =       0.000278156396
             autocorr =       1.249182156475
              std dev =       0.703916521710
             le_variance =       0.495498469536

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.495500034335
                                         uncertainty =       0.001557751908

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.495500034335
                                         uncertainty =       0.001557751908

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000248872073
  error estimate for blocks of size 2^( 2) =       0.000257881836
  error estimate for blocks of size 2^( 3) =       0.000266074460
  error estimate for blocks of size 2^( 4) =       0.000271756929
  error estimate for blocks of size 2^( 5) =       0.000275290661
  error estimate for blocks of size 2^( 6) =       0.000277200763
  error estimate for blocks of size 2^( 7) =       0.000277868311
  error estimate for blocks of size 2^( 8) =       0.000277779237
  error estimate for blocks of size 2^( 9) =       0.000279777274

      target function =                  N/A
              le_mean =     -22.669802459581
             les_mean =     514.428428661901
             stat err =       0.000278156396
             autocorr =       1.249182156476
              std dev =       0.703916521708
             le_variance =       0.495498469534

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.495500034332
                                         uncertainty =       0.001557751908

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.495500034332
                                         uncertainty =       0.001557751908

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000248872073
  error estimate for blocks of size 2^( 2) =       0.000257881836
  error estimate for blocks of size 2^( 3) =       0.000266074460
  error estimate for blocks of size 2^( 4) =       0.000271756929
  error estimate for blocks of size 2^( 5) =       0.000275290661
  error estimate for blocks of size 2^( 6) =       0.000277200763
  error estimate for blocks of size 2^( 7) =       0.000277868311
  error estimate for blocks of size 2^( 8) =       0.000277779237
  error estimate for blocks of size 2^( 9) =       0.000279777274

      target function =                  N/A
              le_mean =     -22.669802459581
             les_mean =     514.428428661913
             stat err =       0.000278156396
             autocorr =       1.249182156507
              std dev =       0.703916521706
             le_variance =       0.495498469531


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.669802459581        initial  <--
     3.4694e+06     3.4694e+07             6.3215e-11       -22.669802459581
     1.3878e+07     1.3878e+08             1.5804e-11       -22.669802459581
     5.5511e+07     5.5511e+08             3.9509e-12       -22.669802459581

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 175.9272
  </log>
  <optVariables href="FORM.s063.opt.xml">
ci_001                -7.050617e-01 3 1  ON 0
ci_002                -7.059926e-01 3 1  ON 1
ci_003                -3.765135e-02 3 1  ON 2
ci_004                -3.890325e-02 3 1  ON 3
ci_005                 1.612441e-02 3 1  ON 4
ci_006                 1.600090e-02 3 1  ON 5
ci_007                 1.228713e-02 3 1  ON 6
ci_008                 1.246533e-02 3 1  ON 7
ci_009                -1.173869e-02 3 1  ON 8
ci_010                -1.182876e-02 3 1  ON 9
ci_011                -8.176403e-03 3 1  ON 10
ci_012                -8.138278e-03 3 1  ON 11
ci_013                 9.647137e-03 3 1  ON 12
ci_014                 9.360580e-03 3 1  ON 13
ci_015                 1.228715e-02 3 1  ON 14
ci_016                 1.255400e-02 3 1  ON 15
ci_017                 1.088300e-02 3 1  ON 16
ci_018                 1.078149e-02 3 1  ON 17
ci_019                -2.514322e-03 3 1  ON 18
ci_020                -2.423765e-03 3 1  ON 19
ci_021                -8.459776e-03 3 1  ON 20
ci_022                -8.657034e-03 3 1  ON 21
ci_023                 7.805043e-03 3 1  ON 22
ci_024                 8.041852e-03 3 1  ON 23
ci_025                 4.702642e-03 3 1  ON 24
ci_026                 4.273172e-03 3 1  ON 25
ci_027                 6.454089e-03 3 1  ON 26
ci_028                 6.476482e-03 3 1  ON 27
ci_029                -4.877820e-03 3 1  ON 28
ci_030                -4.785596e-03 3 1  ON 29
ci_031                -7.388694e-03 3 1  ON 30
ci_032                -8.123179e-03 3 1  ON 31
ci_033                 4.600637e-03 3 1  ON 32
ci_034                 4.413553e-03 3 1  ON 33
ci_035                 1.126907e-03 3 1  ON 34
ci_036                 1.043146e-03 3 1  ON 35
ci_037                 4.953347e-03 3 1  ON 36
ci_038                 5.099310e-03 3 1  ON 37
ci_039                 5.306386e-03 3 1  ON 38
ci_040                 5.323086e-03 3 1  ON 39
ci_041                 4.970499e-03 3 1  ON 40
ci_042                 5.231233e-03 3 1  ON 41
ci_043                 4.943052e-03 3 1  ON 42
ci_044                 4.944182e-03 3 1  ON 43
ci_045                 3.123967e-03 3 1  ON 44
ci_046                 3.174246e-03 3 1  ON 45
ci_047                -7.790222e-04 3 1  ON 46
ci_048                -5.616836e-04 3 1  ON 47
ci_049                 1.580289e-03 3 1  ON 48
ci_050                 1.792516e-03 3 1  ON 49
ci_051                -1.106651e-03 3 1  ON 50
ci_052                -1.243279e-03 3 1  ON 51
ci_053                -2.610471e-03 3 1  ON 52
ci_054                -2.301978e-03 3 1  ON 53
ci_055                -1.483475e-03 3 1  ON 54
ci_056                -1.376714e-03 3 1  ON 55
ci_057                -1.240708e-03 3 1  ON 56
ci_058                -1.731077e-03 3 1  ON 57
ci_059                 3.171692e-04 3 1  ON 58
ci_060                 1.414703e-04 3 1  ON 59
ci_061                -3.305088e-04 3 1  ON 60
ci_062                -9.499769e-06 3 1  ON 61
ci_063                -5.232922e-04 3 1  ON 62
ci_064                -8.918525e-04 3 1  ON 63
ci_065                -2.408143e-03 3 1  ON 64
ci_066                -2.435285e-03 3 1  ON 65
ci_067                -2.101084e-03 3 1  ON 66
ci_068                -2.473560e-03 3 1  ON 67
ci_069                -2.085964e-04 3 1  ON 68
ci_070                 1.328450e-04 3 1  ON 69
ci_071                -1.874230e-03 3 1  ON 70
ci_072                -1.959430e-03 3 1  ON 71
ci_073                 5.749021e-04 3 1  ON 72
ci_074                 2.857507e-04 3 1  ON 73
ci_075                -2.910323e-04 3 1  ON 74
ci_076                -2.990999e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 2.9785e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s064 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s064 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=64  my_counter=0
  time step      = 5.0000e-02
  blocks         = 250
  steps          = 250
  substeps       = 10
  current        = 0
  target samples = 8.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">250</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">6.2500e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">8.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">6.2500e+04</parameter>
<parameter name="steps" condition="int">250</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2662e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="250">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =8000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 64
    time step          = 0.05
    reference energy   = -22.6635
    reference variance = 0.488182
====================================================
  Execution time = 1.0265e+02
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s064
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 62500 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 6.1122e+04
  VMC Eavg = -2.2670e+01
  VMC Evar = 5.0749e-01
  Total weights = 7.820245146e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.9256e+01
  </log>
</opt>
<opt stage="main" walkers="62500">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.494259246688
                                         uncertainty =       0.001047492364

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.494259246688
                                         uncertainty =       0.001047492364

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000248560974
  error estimate for blocks of size 2^( 2) =       0.000257591933
  error estimate for blocks of size 2^( 3) =       0.000265545189
  error estimate for blocks of size 2^( 4) =       0.000271242462
  error estimate for blocks of size 2^( 5) =       0.000274912874
  error estimate for blocks of size 2^( 6) =       0.000276378301
  error estimate for blocks of size 2^( 7) =       0.000277312786
  error estimate for blocks of size 2^( 8) =       0.000276957749
  error estimate for blocks of size 2^( 9) =       0.000277898754

      target function =                  N/A
              le_mean =     -22.669987630705
             les_mean =     514.435833713702
             stat err =       0.000277136898
             autocorr =       1.243147951654
              std dev =       0.703036600036
             le_variance =       0.494260460990


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266998763071e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.4694e+07, overlap shift 3.4694e+08 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.669987630732       residual = 5.36e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.669987630732       residual = 7.07e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.669987630732       residual = 2.39e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.669987634780       residual = 8.56e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 3.4694e+07 is 7.192488e-12

solving harmonic davidson linear method for identity shift 1.3878e+08, overlap shift 1.3878e+09 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.669987630732       residual = 5.36e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.669987630732       residual = 7.07e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.669987630732       residual = 2.39e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.669987630732       residual = 8.56e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 1.3878e+08 is 1.798134e-12

solving harmonic davidson linear method for identity shift 5.5511e+08, overlap shift 5.5511e+09 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.669987630732       residual = 5.36e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.669987630732       residual = 7.07e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.669987630732       residual = 2.39e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.669987630732       residual = 8.56e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 5.5511e+08 is 4.495325e-13

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.125299 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.2192e+02
  </log>
  <optVariables href="FORM.s064.opt.xml">
ci_001                -7.050617e-01 3 1  ON 0
ci_002                -7.059926e-01 3 1  ON 1
ci_003                -3.765135e-02 3 1  ON 2
ci_004                -3.890325e-02 3 1  ON 3
ci_005                 1.612441e-02 3 1  ON 4
ci_006                 1.600090e-02 3 1  ON 5
ci_007                 1.228713e-02 3 1  ON 6
ci_008                 1.246533e-02 3 1  ON 7
ci_009                -1.173869e-02 3 1  ON 8
ci_010                -1.182876e-02 3 1  ON 9
ci_011                -8.176403e-03 3 1  ON 10
ci_012                -8.138278e-03 3 1  ON 11
ci_013                 9.647137e-03 3 1  ON 12
ci_014                 9.360580e-03 3 1  ON 13
ci_015                 1.228715e-02 3 1  ON 14
ci_016                 1.255400e-02 3 1  ON 15
ci_017                 1.088300e-02 3 1  ON 16
ci_018                 1.078149e-02 3 1  ON 17
ci_019                -2.514322e-03 3 1  ON 18
ci_020                -2.423765e-03 3 1  ON 19
ci_021                -8.459776e-03 3 1  ON 20
ci_022                -8.657034e-03 3 1  ON 21
ci_023                 7.805043e-03 3 1  ON 22
ci_024                 8.041852e-03 3 1  ON 23
ci_025                 4.702642e-03 3 1  ON 24
ci_026                 4.273172e-03 3 1  ON 25
ci_027                 6.454089e-03 3 1  ON 26
ci_028                 6.476482e-03 3 1  ON 27
ci_029                -4.877820e-03 3 1  ON 28
ci_030                -4.785596e-03 3 1  ON 29
ci_031                -7.388694e-03 3 1  ON 30
ci_032                -8.123179e-03 3 1  ON 31
ci_033                 4.600637e-03 3 1  ON 32
ci_034                 4.413553e-03 3 1  ON 33
ci_035                 1.126907e-03 3 1  ON 34
ci_036                 1.043146e-03 3 1  ON 35
ci_037                 4.953347e-03 3 1  ON 36
ci_038                 5.099310e-03 3 1  ON 37
ci_039                 5.306386e-03 3 1  ON 38
ci_040                 5.323086e-03 3 1  ON 39
ci_041                 4.970499e-03 3 1  ON 40
ci_042                 5.231233e-03 3 1  ON 41
ci_043                 4.943052e-03 3 1  ON 42
ci_044                 4.944182e-03 3 1  ON 43
ci_045                 3.123967e-03 3 1  ON 44
ci_046                 3.174246e-03 3 1  ON 45
ci_047                -7.790222e-04 3 1  ON 46
ci_048                -5.616836e-04 3 1  ON 47
ci_049                 1.580289e-03 3 1  ON 48
ci_050                 1.792516e-03 3 1  ON 49
ci_051                -1.106651e-03 3 1  ON 50
ci_052                -1.243279e-03 3 1  ON 51
ci_053                -2.610471e-03 3 1  ON 52
ci_054                -2.301978e-03 3 1  ON 53
ci_055                -1.483475e-03 3 1  ON 54
ci_056                -1.376714e-03 3 1  ON 55
ci_057                -1.240708e-03 3 1  ON 56
ci_058                -1.731077e-03 3 1  ON 57
ci_059                 3.171692e-04 3 1  ON 58
ci_060                 1.414703e-04 3 1  ON 59
ci_061                -3.305088e-04 3 1  ON 60
ci_062                -9.499770e-06 3 1  ON 61
ci_063                -5.232922e-04 3 1  ON 62
ci_064                -8.918525e-04 3 1  ON 63
ci_065                -2.408143e-03 3 1  ON 64
ci_066                -2.435285e-03 3 1  ON 65
ci_067                -2.101084e-03 3 1  ON 66
ci_068                -2.473560e-03 3 1  ON 67
ci_069                -2.085964e-04 3 1  ON 68
ci_070                 1.328450e-04 3 1  ON 69
ci_071                -1.874230e-03 3 1  ON 70
ci_072                -1.959430e-03 3 1  ON 71
ci_073                 5.749021e-04 3 1  ON 72
ci_074                 2.857507e-04 3 1  ON 73
ci_075                -2.910323e-04 3 1  ON 74
ci_076                -2.990999e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="250">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =8000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 64
    time step          = 0.05
    reference energy   = -22.7008
    reference variance = 0.27341
====================================================
  Execution time = 1.0226e+02
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s064
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 62500 
  VMC Eavg = -2.2670e+01
  VMC Evar = 5.0939e-01
  Total weights = 7.8205e+06
  Execution time = 1.4665e+01
  </log>
</opt>
<opt stage="main" walkers="62500">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.497477312482
                                         uncertainty =       0.001446429729

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.497477312482
                                         uncertainty =       0.001446429729

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000249369283
  error estimate for blocks of size 2^( 2) =       0.000258336217
  error estimate for blocks of size 2^( 3) =       0.000266342965
  error estimate for blocks of size 2^( 4) =       0.000271820908
  error estimate for blocks of size 2^( 5) =       0.000275375457
  error estimate for blocks of size 2^( 6) =       0.000277382014
  error estimate for blocks of size 2^( 7) =       0.000278606269
  error estimate for blocks of size 2^( 8) =       0.000279589451
  error estimate for blocks of size 2^( 9) =       0.000280627720

      target function =                  N/A
              le_mean =     -22.669679640023
             les_mean =     514.423760693549
             stat err =       0.000279051363
             autocorr =       1.252225037844
              std dev =       0.705322845318
             le_variance =       0.497480316127

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.497477312483
                                         uncertainty =       0.001446429729

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.497477312483
                                         uncertainty =       0.001446429729

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000249369283
  error estimate for blocks of size 2^( 2) =       0.000258336217
  error estimate for blocks of size 2^( 3) =       0.000266342965
  error estimate for blocks of size 2^( 4) =       0.000271820908
  error estimate for blocks of size 2^( 5) =       0.000275375457
  error estimate for blocks of size 2^( 6) =       0.000277382014
  error estimate for blocks of size 2^( 7) =       0.000278606269
  error estimate for blocks of size 2^( 8) =       0.000279589451
  error estimate for blocks of size 2^( 9) =       0.000280627720

      target function =                  N/A
              le_mean =     -22.669679640023
             les_mean =     514.423760693596
             stat err =       0.000279051363
             autocorr =       1.252225037850
              std dev =       0.705322845319
             le_variance =       0.497480316129

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.497477312483
                                         uncertainty =       0.001446429729

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.497477312483
                                         uncertainty =       0.001446429729

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000249369283
  error estimate for blocks of size 2^( 2) =       0.000258336217
  error estimate for blocks of size 2^( 3) =       0.000266342965
  error estimate for blocks of size 2^( 4) =       0.000271820908
  error estimate for blocks of size 2^( 5) =       0.000275375457
  error estimate for blocks of size 2^( 6) =       0.000277382014
  error estimate for blocks of size 2^( 7) =       0.000278606269
  error estimate for blocks of size 2^( 8) =       0.000279589451
  error estimate for blocks of size 2^( 9) =       0.000280627720

      target function =                  N/A
              le_mean =     -22.669679640023
             les_mean =     514.423760693573
             stat err =       0.000279051363
             autocorr =       1.252225037870
              std dev =       0.705322845318
             le_variance =       0.497480316128

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.497477312482
                                         uncertainty =       0.001446429729

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.497477312482
                                         uncertainty =       0.001446429729

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000249369283
  error estimate for blocks of size 2^( 2) =       0.000258336217
  error estimate for blocks of size 2^( 3) =       0.000266342965
  error estimate for blocks of size 2^( 4) =       0.000271820908
  error estimate for blocks of size 2^( 5) =       0.000275375457
  error estimate for blocks of size 2^( 6) =       0.000277382014
  error estimate for blocks of size 2^( 7) =       0.000278606269
  error estimate for blocks of size 2^( 8) =       0.000279589451
  error estimate for blocks of size 2^( 9) =       0.000280627720

      target function =                  N/A
              le_mean =     -22.669679640023
             les_mean =     514.423760693552
             stat err =       0.000279051363
             autocorr =       1.252225037834
              std dev =       0.705322845317
             le_variance =       0.497480316127


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.669679640023        initial
     3.4694e+07     3.4694e+08             7.1925e-12       -22.669679640023
     1.3878e+08     1.3878e+09             1.7981e-12       -22.669679640023
     5.5511e+08     5.5511e+09             4.4953e-13       -22.669679640023  <--

*****************************************************************************
Applying the update for shift_i =   5.5511e+08     and shift_s =   5.5511e+09
*****************************************************************************

  Execution time = 1.7707e+02
  </log>
  <optVariables href="FORM.s064.opt.xml">
ci_001                -7.050617e-01 3 1  ON 0
ci_002                -7.059926e-01 3 1  ON 1
ci_003                -3.765135e-02 3 1  ON 2
ci_004                -3.890325e-02 3 1  ON 3
ci_005                 1.612441e-02 3 1  ON 4
ci_006                 1.600090e-02 3 1  ON 5
ci_007                 1.228713e-02 3 1  ON 6
ci_008                 1.246533e-02 3 1  ON 7
ci_009                -1.173869e-02 3 1  ON 8
ci_010                -1.182876e-02 3 1  ON 9
ci_011                -8.176403e-03 3 1  ON 10
ci_012                -8.138278e-03 3 1  ON 11
ci_013                 9.647137e-03 3 1  ON 12
ci_014                 9.360580e-03 3 1  ON 13
ci_015                 1.228715e-02 3 1  ON 14
ci_016                 1.255400e-02 3 1  ON 15
ci_017                 1.088300e-02 3 1  ON 16
ci_018                 1.078149e-02 3 1  ON 17
ci_019                -2.514322e-03 3 1  ON 18
ci_020                -2.423765e-03 3 1  ON 19
ci_021                -8.459776e-03 3 1  ON 20
ci_022                -8.657034e-03 3 1  ON 21
ci_023                 7.805043e-03 3 1  ON 22
ci_024                 8.041852e-03 3 1  ON 23
ci_025                 4.702642e-03 3 1  ON 24
ci_026                 4.273172e-03 3 1  ON 25
ci_027                 6.454089e-03 3 1  ON 26
ci_028                 6.476482e-03 3 1  ON 27
ci_029                -4.877820e-03 3 1  ON 28
ci_030                -4.785596e-03 3 1  ON 29
ci_031                -7.388694e-03 3 1  ON 30
ci_032                -8.123179e-03 3 1  ON 31
ci_033                 4.600637e-03 3 1  ON 32
ci_034                 4.413553e-03 3 1  ON 33
ci_035                 1.126907e-03 3 1  ON 34
ci_036                 1.043146e-03 3 1  ON 35
ci_037                 4.953347e-03 3 1  ON 36
ci_038                 5.099310e-03 3 1  ON 37
ci_039                 5.306386e-03 3 1  ON 38
ci_040                 5.323086e-03 3 1  ON 39
ci_041                 4.970499e-03 3 1  ON 40
ci_042                 5.231233e-03 3 1  ON 41
ci_043                 4.943052e-03 3 1  ON 42
ci_044                 4.944182e-03 3 1  ON 43
ci_045                 3.123967e-03 3 1  ON 44
ci_046                 3.174246e-03 3 1  ON 45
ci_047                -7.790222e-04 3 1  ON 46
ci_048                -5.616836e-04 3 1  ON 47
ci_049                 1.580289e-03 3 1  ON 48
ci_050                 1.792516e-03 3 1  ON 49
ci_051                -1.106651e-03 3 1  ON 50
ci_052                -1.243279e-03 3 1  ON 51
ci_053                -2.610471e-03 3 1  ON 52
ci_054                -2.301978e-03 3 1  ON 53
ci_055                -1.483475e-03 3 1  ON 54
ci_056                -1.376714e-03 3 1  ON 55
ci_057                -1.240708e-03 3 1  ON 56
ci_058                -1.731077e-03 3 1  ON 57
ci_059                 3.171692e-04 3 1  ON 58
ci_060                 1.414703e-04 3 1  ON 59
ci_061                -3.305088e-04 3 1  ON 60
ci_062                -9.499769e-06 3 1  ON 61
ci_063                -5.232922e-04 3 1  ON 62
ci_064                -8.918525e-04 3 1  ON 63
ci_065                -2.408143e-03 3 1  ON 64
ci_066                -2.435285e-03 3 1  ON 65
ci_067                -2.101084e-03 3 1  ON 66
ci_068                -2.473560e-03 3 1  ON 67
ci_069                -2.085964e-04 3 1  ON 68
ci_070                 1.328450e-04 3 1  ON 69
ci_071                -1.874230e-03 3 1  ON 70
ci_072                -1.959430e-03 3 1  ON 71
ci_073                 5.749021e-04 3 1  ON 72
ci_074                 2.857507e-04 3 1  ON 73
ci_075                -2.910323e-04 3 1  ON 74
ci_076                -2.990999e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 2.9902e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s065 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s065 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=65  my_counter=0
  time step      = 5.0000e-02
  blocks         = 250
  steps          = 250
  substeps       = 10
  current        = 0
  target samples = 8.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">250</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">6.2500e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">8.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">6.2500e+04</parameter>
<parameter name="steps" condition="int">250</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2662e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="250">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =8000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 65
    time step          = 0.05
    reference energy   = -22.7215
    reference variance = 0.382828
====================================================
  Execution time = 1.0254e+02
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s065
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 62500 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 6.1099e+04
  VMC Eavg = -2.2670e+01
  VMC Evar = 5.1253e-01
  Total weights = 7.819818888e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.9027e+01
  </log>
</opt>
<opt stage="main" walkers="62500">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.499772261932
                                         uncertainty =       0.001956172953

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.499772261932
                                         uncertainty =       0.001956172953

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000249942818
  error estimate for blocks of size 2^( 2) =       0.000258863792
  error estimate for blocks of size 2^( 3) =       0.000266926229
  error estimate for blocks of size 2^( 4) =       0.000272438941
  error estimate for blocks of size 2^( 5) =       0.000275346201
  error estimate for blocks of size 2^( 6) =       0.000277458552
  error estimate for blocks of size 2^( 7) =       0.000278683952
  error estimate for blocks of size 2^( 8) =       0.000279374505
  error estimate for blocks of size 2^( 9) =       0.000279415274

      target function =                  N/A
              le_mean =     -22.669642382494
             les_mean =     514.425213720801
             stat err =       0.000278733071
             autocorr =       1.243642841936
              std dev =       0.706945046158
             le_variance =       0.499771298287


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266964238249e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.3878e+08, overlap shift 1.3878e+09 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.669642382516       residual = 4.07e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.669642382516       residual = 5.60e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.669642382516       residual = 2.68e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.669642385749       residual = 8.89e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 1.3878e+08 is 1.458388e-12

solving harmonic davidson linear method for identity shift 5.5511e+08, overlap shift 5.5511e+09 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.669642382516       residual = 4.07e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.669642382516       residual = 5.60e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.669642382516       residual = 2.68e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.669642382516       residual = 8.94e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 5.5511e+08 is 3.645722e-13

solving harmonic davidson linear method for identity shift 2.2204e+09, overlap shift 2.2204e+10 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.669642382516       residual = 4.07e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.669642382516       residual = 5.60e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.669642382516       residual = 2.68e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.669642382516       residual = 8.94e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 2.2204e+09 is 9.114306e-14

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.126636 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.2158e+02
  </log>
  <optVariables href="FORM.s065.opt.xml">
ci_001                -7.050617e-01 3 1  ON 0
ci_002                -7.059926e-01 3 1  ON 1
ci_003                -3.765135e-02 3 1  ON 2
ci_004                -3.890325e-02 3 1  ON 3
ci_005                 1.612441e-02 3 1  ON 4
ci_006                 1.600090e-02 3 1  ON 5
ci_007                 1.228713e-02 3 1  ON 6
ci_008                 1.246533e-02 3 1  ON 7
ci_009                -1.173869e-02 3 1  ON 8
ci_010                -1.182876e-02 3 1  ON 9
ci_011                -8.176403e-03 3 1  ON 10
ci_012                -8.138278e-03 3 1  ON 11
ci_013                 9.647137e-03 3 1  ON 12
ci_014                 9.360580e-03 3 1  ON 13
ci_015                 1.228715e-02 3 1  ON 14
ci_016                 1.255400e-02 3 1  ON 15
ci_017                 1.088300e-02 3 1  ON 16
ci_018                 1.078149e-02 3 1  ON 17
ci_019                -2.514322e-03 3 1  ON 18
ci_020                -2.423765e-03 3 1  ON 19
ci_021                -8.459776e-03 3 1  ON 20
ci_022                -8.657034e-03 3 1  ON 21
ci_023                 7.805043e-03 3 1  ON 22
ci_024                 8.041852e-03 3 1  ON 23
ci_025                 4.702642e-03 3 1  ON 24
ci_026                 4.273172e-03 3 1  ON 25
ci_027                 6.454089e-03 3 1  ON 26
ci_028                 6.476482e-03 3 1  ON 27
ci_029                -4.877820e-03 3 1  ON 28
ci_030                -4.785596e-03 3 1  ON 29
ci_031                -7.388694e-03 3 1  ON 30
ci_032                -8.123179e-03 3 1  ON 31
ci_033                 4.600637e-03 3 1  ON 32
ci_034                 4.413553e-03 3 1  ON 33
ci_035                 1.126907e-03 3 1  ON 34
ci_036                 1.043146e-03 3 1  ON 35
ci_037                 4.953347e-03 3 1  ON 36
ci_038                 5.099310e-03 3 1  ON 37
ci_039                 5.306386e-03 3 1  ON 38
ci_040                 5.323086e-03 3 1  ON 39
ci_041                 4.970499e-03 3 1  ON 40
ci_042                 5.231233e-03 3 1  ON 41
ci_043                 4.943052e-03 3 1  ON 42
ci_044                 4.944182e-03 3 1  ON 43
ci_045                 3.123967e-03 3 1  ON 44
ci_046                 3.174246e-03 3 1  ON 45
ci_047                -7.790222e-04 3 1  ON 46
ci_048                -5.616836e-04 3 1  ON 47
ci_049                 1.580289e-03 3 1  ON 48
ci_050                 1.792516e-03 3 1  ON 49
ci_051                -1.106651e-03 3 1  ON 50
ci_052                -1.243279e-03 3 1  ON 51
ci_053                -2.610471e-03 3 1  ON 52
ci_054                -2.301978e-03 3 1  ON 53
ci_055                -1.483475e-03 3 1  ON 54
ci_056                -1.376714e-03 3 1  ON 55
ci_057                -1.240708e-03 3 1  ON 56
ci_058                -1.731077e-03 3 1  ON 57
ci_059                 3.171692e-04 3 1  ON 58
ci_060                 1.414703e-04 3 1  ON 59
ci_061                -3.305088e-04 3 1  ON 60
ci_062                -9.499769e-06 3 1  ON 61
ci_063                -5.232922e-04 3 1  ON 62
ci_064                -8.918525e-04 3 1  ON 63
ci_065                -2.408143e-03 3 1  ON 64
ci_066                -2.435285e-03 3 1  ON 65
ci_067                -2.101084e-03 3 1  ON 66
ci_068                -2.473560e-03 3 1  ON 67
ci_069                -2.085964e-04 3 1  ON 68
ci_070                 1.328450e-04 3 1  ON 69
ci_071                -1.874230e-03 3 1  ON 70
ci_072                -1.959430e-03 3 1  ON 71
ci_073                 5.749021e-04 3 1  ON 72
ci_074                 2.857507e-04 3 1  ON 73
ci_075                -2.910323e-04 3 1  ON 74
ci_076                -2.990999e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="250">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =8000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 65
    time step          = 0.05
    reference energy   = -22.6701
    reference variance = 0.725043
====================================================
  Execution time = 1.0230e+02
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s065
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 62500 
  VMC Eavg = -2.2670e+01
  VMC Evar = 5.0910e-01
  Total weights = 7.8209e+06
  Execution time = 1.4663e+01
  </log>
</opt>
<opt stage="main" walkers="62500">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.495610469447
                                         uncertainty =       0.001367700653

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.495610469447
                                         uncertainty =       0.001367700653

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000248900234
  error estimate for blocks of size 2^( 2) =       0.000257839862
  error estimate for blocks of size 2^( 3) =       0.000265851578
  error estimate for blocks of size 2^( 4) =       0.000271625672
  error estimate for blocks of size 2^( 5) =       0.000274983497
  error estimate for blocks of size 2^( 6) =       0.000276722817
  error estimate for blocks of size 2^( 7) =       0.000278459082
  error estimate for blocks of size 2^( 8) =       0.000278841879
  error estimate for blocks of size 2^( 9) =       0.000279908494

      target function =                  N/A
              le_mean =     -22.669695489018
             les_mean =     514.424190223407
             stat err =       0.000278483068
             autocorr =       1.251834678230
              std dev =       0.703996174132
             le_variance =       0.495610613192

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.495610469447
                                         uncertainty =       0.001367700653

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.495610469447
                                         uncertainty =       0.001367700653

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000248900234
  error estimate for blocks of size 2^( 2) =       0.000257839862
  error estimate for blocks of size 2^( 3) =       0.000265851578
  error estimate for blocks of size 2^( 4) =       0.000271625672
  error estimate for blocks of size 2^( 5) =       0.000274983497
  error estimate for blocks of size 2^( 6) =       0.000276722817
  error estimate for blocks of size 2^( 7) =       0.000278459082
  error estimate for blocks of size 2^( 8) =       0.000278841879
  error estimate for blocks of size 2^( 9) =       0.000279908494

      target function =                  N/A
              le_mean =     -22.669695489018
             les_mean =     514.424190223407
             stat err =       0.000278483068
             autocorr =       1.251834678236
              std dev =       0.703996174132
             le_variance =       0.495610613192

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.495610469447
                                         uncertainty =       0.001367700653

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.495610469447
                                         uncertainty =       0.001367700653

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000248900234
  error estimate for blocks of size 2^( 2) =       0.000257839862
  error estimate for blocks of size 2^( 3) =       0.000265851578
  error estimate for blocks of size 2^( 4) =       0.000271625672
  error estimate for blocks of size 2^( 5) =       0.000274983497
  error estimate for blocks of size 2^( 6) =       0.000276722817
  error estimate for blocks of size 2^( 7) =       0.000278459082
  error estimate for blocks of size 2^( 8) =       0.000278841879
  error estimate for blocks of size 2^( 9) =       0.000279908494

      target function =                  N/A
              le_mean =     -22.669695489018
             les_mean =     514.424190223407
             stat err =       0.000278483068
             autocorr =       1.251834678241
              std dev =       0.703996174132
             le_variance =       0.495610613192

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.495610469447
                                         uncertainty =       0.001367700653

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.495610469447
                                         uncertainty =       0.001367700653

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000248900234
  error estimate for blocks of size 2^( 2) =       0.000257839862
  error estimate for blocks of size 2^( 3) =       0.000265851578
  error estimate for blocks of size 2^( 4) =       0.000271625672
  error estimate for blocks of size 2^( 5) =       0.000274983497
  error estimate for blocks of size 2^( 6) =       0.000276722817
  error estimate for blocks of size 2^( 7) =       0.000278459082
  error estimate for blocks of size 2^( 8) =       0.000278841879
  error estimate for blocks of size 2^( 9) =       0.000279908494

      target function =                  N/A
              le_mean =     -22.669695489018
             les_mean =     514.424190223407
             stat err =       0.000278483068
             autocorr =       1.251834678223
              std dev =       0.703996174132
             le_variance =       0.495610613192


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.669695489018        initial  <--
     1.3878e+08     1.3878e+09             1.4584e-12       -22.669695489018
     5.5511e+08     5.5511e+09             3.6457e-13       -22.669695489018
     2.2204e+09     2.2204e+10             9.1143e-14       -22.669695489018

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 177.7614
  </log>
  <optVariables href="FORM.s065.opt.xml">
ci_001                -7.050617e-01 3 1  ON 0
ci_002                -7.059926e-01 3 1  ON 1
ci_003                -3.765135e-02 3 1  ON 2
ci_004                -3.890325e-02 3 1  ON 3
ci_005                 1.612441e-02 3 1  ON 4
ci_006                 1.600090e-02 3 1  ON 5
ci_007                 1.228713e-02 3 1  ON 6
ci_008                 1.246533e-02 3 1  ON 7
ci_009                -1.173869e-02 3 1  ON 8
ci_010                -1.182876e-02 3 1  ON 9
ci_011                -8.176403e-03 3 1  ON 10
ci_012                -8.138278e-03 3 1  ON 11
ci_013                 9.647137e-03 3 1  ON 12
ci_014                 9.360580e-03 3 1  ON 13
ci_015                 1.228715e-02 3 1  ON 14
ci_016                 1.255400e-02 3 1  ON 15
ci_017                 1.088300e-02 3 1  ON 16
ci_018                 1.078149e-02 3 1  ON 17
ci_019                -2.514322e-03 3 1  ON 18
ci_020                -2.423765e-03 3 1  ON 19
ci_021                -8.459776e-03 3 1  ON 20
ci_022                -8.657034e-03 3 1  ON 21
ci_023                 7.805043e-03 3 1  ON 22
ci_024                 8.041852e-03 3 1  ON 23
ci_025                 4.702642e-03 3 1  ON 24
ci_026                 4.273172e-03 3 1  ON 25
ci_027                 6.454089e-03 3 1  ON 26
ci_028                 6.476482e-03 3 1  ON 27
ci_029                -4.877820e-03 3 1  ON 28
ci_030                -4.785596e-03 3 1  ON 29
ci_031                -7.388694e-03 3 1  ON 30
ci_032                -8.123179e-03 3 1  ON 31
ci_033                 4.600637e-03 3 1  ON 32
ci_034                 4.413553e-03 3 1  ON 33
ci_035                 1.126907e-03 3 1  ON 34
ci_036                 1.043146e-03 3 1  ON 35
ci_037                 4.953347e-03 3 1  ON 36
ci_038                 5.099310e-03 3 1  ON 37
ci_039                 5.306386e-03 3 1  ON 38
ci_040                 5.323086e-03 3 1  ON 39
ci_041                 4.970499e-03 3 1  ON 40
ci_042                 5.231233e-03 3 1  ON 41
ci_043                 4.943052e-03 3 1  ON 42
ci_044                 4.944182e-03 3 1  ON 43
ci_045                 3.123967e-03 3 1  ON 44
ci_046                 3.174246e-03 3 1  ON 45
ci_047                -7.790222e-04 3 1  ON 46
ci_048                -5.616836e-04 3 1  ON 47
ci_049                 1.580289e-03 3 1  ON 48
ci_050                 1.792516e-03 3 1  ON 49
ci_051                -1.106651e-03 3 1  ON 50
ci_052                -1.243279e-03 3 1  ON 51
ci_053                -2.610471e-03 3 1  ON 52
ci_054                -2.301978e-03 3 1  ON 53
ci_055                -1.483475e-03 3 1  ON 54
ci_056                -1.376714e-03 3 1  ON 55
ci_057                -1.240708e-03 3 1  ON 56
ci_058                -1.731077e-03 3 1  ON 57
ci_059                 3.171692e-04 3 1  ON 58
ci_060                 1.414703e-04 3 1  ON 59
ci_061                -3.305088e-04 3 1  ON 60
ci_062                -9.499769e-06 3 1  ON 61
ci_063                -5.232922e-04 3 1  ON 62
ci_064                -8.918525e-04 3 1  ON 63
ci_065                -2.408143e-03 3 1  ON 64
ci_066                -2.435285e-03 3 1  ON 65
ci_067                -2.101084e-03 3 1  ON 66
ci_068                -2.473560e-03 3 1  ON 67
ci_069                -2.085964e-04 3 1  ON 68
ci_070                 1.328450e-04 3 1  ON 69
ci_071                -1.874230e-03 3 1  ON 70
ci_072                -1.959430e-03 3 1  ON 71
ci_073                 5.749021e-04 3 1  ON 72
ci_074                 2.857507e-04 3 1  ON 73
ci_075                -2.910323e-04 3 1  ON 74
ci_076                -2.990999e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 2.9935e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s066 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s066 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=66  my_counter=0
  time step      = 5.0000e-02
  blocks         = 250
  steps          = 250
  substeps       = 10
  current        = 0
  target samples = 8.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">250</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">6.2500e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">8.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">6.2500e+04</parameter>
<parameter name="steps" condition="int">250</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2663e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="250">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =8000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 66
    time step          = 0.05
    reference energy   = -22.6808
    reference variance = 0.42438
====================================================
  Execution time = 1.0237e+02
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s066
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 62500 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 6.1128e+04
  VMC Eavg = -2.2670e+01
  VMC Evar = 5.0689e-01
  Total weights = 7.821602732e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.9235e+01
  </log>
</opt>
<opt stage="main" walkers="62500">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.495407588801
                                         uncertainty =       0.001496199894

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.495407588801
                                         uncertainty =       0.001496199894

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000248850065
  error estimate for blocks of size 2^( 2) =       0.000257707208
  error estimate for blocks of size 2^( 3) =       0.000265713397
  error estimate for blocks of size 2^( 4) =       0.000271602191
  error estimate for blocks of size 2^( 5) =       0.000274794692
  error estimate for blocks of size 2^( 6) =       0.000276658331
  error estimate for blocks of size 2^( 7) =       0.000277425754
  error estimate for blocks of size 2^( 8) =       0.000278551166
  error estimate for blocks of size 2^( 9) =       0.000279684659

      target function =                  N/A
              le_mean =     -22.669756452132
             les_mean =     514.424750654324
             stat err =       0.000278079978
             autocorr =       1.248716707517
              std dev =       0.703854273765
             le_variance =       0.495410838697


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266975645213e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.3878e+09, overlap shift 1.3878e+10 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.669756452155       residual = 3.92e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.669756452155       residual = 6.55e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.669756452155       residual = 1.27e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.669756452155       residual = 4.85e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 1.3878e+09 is 1.426153e-13

solving harmonic davidson linear method for identity shift 5.5511e+09, overlap shift 5.5511e+10 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.669756452155       residual = 3.92e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.669756452155       residual = 6.55e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.669756452155       residual = 1.27e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.669756452155       residual = 4.73e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 5.5511e+09 is 3.565442e-14

solving harmonic davidson linear method for identity shift 2.2204e+10, overlap shift 2.2204e+11 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.669756452155       residual = 3.92e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.669756452155       residual = 6.55e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.669756452155       residual = 1.27e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.669756452155       residual = 5.95e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 2.2204e+10 is 8.925377e-15

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.127993 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.2161e+02
  </log>
  <optVariables href="FORM.s066.opt.xml">
ci_001                -7.050617e-01 3 1  ON 0
ci_002                -7.059926e-01 3 1  ON 1
ci_003                -3.765135e-02 3 1  ON 2
ci_004                -3.890325e-02 3 1  ON 3
ci_005                 1.612441e-02 3 1  ON 4
ci_006                 1.600090e-02 3 1  ON 5
ci_007                 1.228713e-02 3 1  ON 6
ci_008                 1.246533e-02 3 1  ON 7
ci_009                -1.173869e-02 3 1  ON 8
ci_010                -1.182876e-02 3 1  ON 9
ci_011                -8.176403e-03 3 1  ON 10
ci_012                -8.138278e-03 3 1  ON 11
ci_013                 9.647137e-03 3 1  ON 12
ci_014                 9.360580e-03 3 1  ON 13
ci_015                 1.228715e-02 3 1  ON 14
ci_016                 1.255400e-02 3 1  ON 15
ci_017                 1.088300e-02 3 1  ON 16
ci_018                 1.078149e-02 3 1  ON 17
ci_019                -2.514322e-03 3 1  ON 18
ci_020                -2.423765e-03 3 1  ON 19
ci_021                -8.459776e-03 3 1  ON 20
ci_022                -8.657034e-03 3 1  ON 21
ci_023                 7.805043e-03 3 1  ON 22
ci_024                 8.041852e-03 3 1  ON 23
ci_025                 4.702642e-03 3 1  ON 24
ci_026                 4.273172e-03 3 1  ON 25
ci_027                 6.454089e-03 3 1  ON 26
ci_028                 6.476482e-03 3 1  ON 27
ci_029                -4.877820e-03 3 1  ON 28
ci_030                -4.785596e-03 3 1  ON 29
ci_031                -7.388694e-03 3 1  ON 30
ci_032                -8.123179e-03 3 1  ON 31
ci_033                 4.600637e-03 3 1  ON 32
ci_034                 4.413553e-03 3 1  ON 33
ci_035                 1.126907e-03 3 1  ON 34
ci_036                 1.043146e-03 3 1  ON 35
ci_037                 4.953347e-03 3 1  ON 36
ci_038                 5.099310e-03 3 1  ON 37
ci_039                 5.306386e-03 3 1  ON 38
ci_040                 5.323086e-03 3 1  ON 39
ci_041                 4.970499e-03 3 1  ON 40
ci_042                 5.231233e-03 3 1  ON 41
ci_043                 4.943052e-03 3 1  ON 42
ci_044                 4.944182e-03 3 1  ON 43
ci_045                 3.123967e-03 3 1  ON 44
ci_046                 3.174246e-03 3 1  ON 45
ci_047                -7.790222e-04 3 1  ON 46
ci_048                -5.616836e-04 3 1  ON 47
ci_049                 1.580289e-03 3 1  ON 48
ci_050                 1.792516e-03 3 1  ON 49
ci_051                -1.106651e-03 3 1  ON 50
ci_052                -1.243279e-03 3 1  ON 51
ci_053                -2.610471e-03 3 1  ON 52
ci_054                -2.301978e-03 3 1  ON 53
ci_055                -1.483475e-03 3 1  ON 54
ci_056                -1.376714e-03 3 1  ON 55
ci_057                -1.240708e-03 3 1  ON 56
ci_058                -1.731077e-03 3 1  ON 57
ci_059                 3.171692e-04 3 1  ON 58
ci_060                 1.414703e-04 3 1  ON 59
ci_061                -3.305088e-04 3 1  ON 60
ci_062                -9.499769e-06 3 1  ON 61
ci_063                -5.232922e-04 3 1  ON 62
ci_064                -8.918525e-04 3 1  ON 63
ci_065                -2.408143e-03 3 1  ON 64
ci_066                -2.435285e-03 3 1  ON 65
ci_067                -2.101084e-03 3 1  ON 66
ci_068                -2.473560e-03 3 1  ON 67
ci_069                -2.085964e-04 3 1  ON 68
ci_070                 1.328450e-04 3 1  ON 69
ci_071                -1.874230e-03 3 1  ON 70
ci_072                -1.959430e-03 3 1  ON 71
ci_073                 5.749021e-04 3 1  ON 72
ci_074                 2.857507e-04 3 1  ON 73
ci_075                -2.910323e-04 3 1  ON 74
ci_076                -2.990999e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="250">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =8000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 66
    time step          = 0.05
    reference energy   = -22.4786
    reference variance = 0.419666
====================================================
  Execution time = 1.0232e+02
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s066
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 62500 
  VMC Eavg = -2.2669e+01
  VMC Evar = 5.0906e-01
  Total weights = 7.8207e+06
  Execution time = 1.4685e+01
  </log>
</opt>
<opt stage="main" walkers="62500">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.495749262854
                                         uncertainty =       0.001331794127

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.495749262854
                                         uncertainty =       0.001331794127

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000248935578
  error estimate for blocks of size 2^( 2) =       0.000257820571
  error estimate for blocks of size 2^( 3) =       0.000265862631
  error estimate for blocks of size 2^( 4) =       0.000271386658
  error estimate for blocks of size 2^( 5) =       0.000274943433
  error estimate for blocks of size 2^( 6) =       0.000276708212
  error estimate for blocks of size 2^( 7) =       0.000278523635
  error estimate for blocks of size 2^( 8) =       0.000279142274
  error estimate for blocks of size 2^( 9) =       0.000278728135

      target function =                  N/A
              le_mean =     -22.669464718642
             les_mean =     514.413689661153
             stat err =       0.000278275564
             autocorr =       1.249614920275
              std dev =       0.704096141398
             le_variance =       0.495751376331

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.495749262854
                                         uncertainty =       0.001331794127

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.495749262854
                                         uncertainty =       0.001331794127

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000248935578
  error estimate for blocks of size 2^( 2) =       0.000257820571
  error estimate for blocks of size 2^( 3) =       0.000265862631
  error estimate for blocks of size 2^( 4) =       0.000271386658
  error estimate for blocks of size 2^( 5) =       0.000274943433
  error estimate for blocks of size 2^( 6) =       0.000276708212
  error estimate for blocks of size 2^( 7) =       0.000278523635
  error estimate for blocks of size 2^( 8) =       0.000279142274
  error estimate for blocks of size 2^( 9) =       0.000278728135

      target function =                  N/A
              le_mean =     -22.669464718642
             les_mean =     514.413689661153
             stat err =       0.000278275564
             autocorr =       1.249614920278
              std dev =       0.704096141398
             le_variance =       0.495751376331

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.495749262854
                                         uncertainty =       0.001331794127

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.495749262854
                                         uncertainty =       0.001331794127

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000248935578
  error estimate for blocks of size 2^( 2) =       0.000257820571
  error estimate for blocks of size 2^( 3) =       0.000265862631
  error estimate for blocks of size 2^( 4) =       0.000271386658
  error estimate for blocks of size 2^( 5) =       0.000274943433
  error estimate for blocks of size 2^( 6) =       0.000276708212
  error estimate for blocks of size 2^( 7) =       0.000278523635
  error estimate for blocks of size 2^( 8) =       0.000279142274
  error estimate for blocks of size 2^( 9) =       0.000278728135

      target function =                  N/A
              le_mean =     -22.669464718642
             les_mean =     514.413689661153
             stat err =       0.000278275564
             autocorr =       1.249614920251
              std dev =       0.704096141398
             le_variance =       0.495751376331

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.495749262854
                                         uncertainty =       0.001331794127

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.495749262854
                                         uncertainty =       0.001331794127

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000248935578
  error estimate for blocks of size 2^( 2) =       0.000257820571
  error estimate for blocks of size 2^( 3) =       0.000265862631
  error estimate for blocks of size 2^( 4) =       0.000271386658
  error estimate for blocks of size 2^( 5) =       0.000274943433
  error estimate for blocks of size 2^( 6) =       0.000276708212
  error estimate for blocks of size 2^( 7) =       0.000278523635
  error estimate for blocks of size 2^( 8) =       0.000279142274
  error estimate for blocks of size 2^( 9) =       0.000278728135

      target function =                  N/A
              le_mean =     -22.669464718642
             les_mean =     514.413689661153
             stat err =       0.000278275564
             autocorr =       1.249614920294
              std dev =       0.704096141398
             le_variance =       0.495751376331


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.669464718642        initial  <--
     1.3878e+09     1.3878e+10             1.4262e-13       -22.669464718642
     5.5511e+09     5.5511e+10             3.5654e-14       -22.669464718642
     2.2204e+10     2.2204e+11             8.9254e-15       -22.669464718642

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 178.4417
  </log>
  <optVariables href="FORM.s066.opt.xml">
ci_001                -7.050617e-01 3 1  ON 0
ci_002                -7.059926e-01 3 1  ON 1
ci_003                -3.765135e-02 3 1  ON 2
ci_004                -3.890325e-02 3 1  ON 3
ci_005                 1.612441e-02 3 1  ON 4
ci_006                 1.600090e-02 3 1  ON 5
ci_007                 1.228713e-02 3 1  ON 6
ci_008                 1.246533e-02 3 1  ON 7
ci_009                -1.173869e-02 3 1  ON 8
ci_010                -1.182876e-02 3 1  ON 9
ci_011                -8.176403e-03 3 1  ON 10
ci_012                -8.138278e-03 3 1  ON 11
ci_013                 9.647137e-03 3 1  ON 12
ci_014                 9.360580e-03 3 1  ON 13
ci_015                 1.228715e-02 3 1  ON 14
ci_016                 1.255400e-02 3 1  ON 15
ci_017                 1.088300e-02 3 1  ON 16
ci_018                 1.078149e-02 3 1  ON 17
ci_019                -2.514322e-03 3 1  ON 18
ci_020                -2.423765e-03 3 1  ON 19
ci_021                -8.459776e-03 3 1  ON 20
ci_022                -8.657034e-03 3 1  ON 21
ci_023                 7.805043e-03 3 1  ON 22
ci_024                 8.041852e-03 3 1  ON 23
ci_025                 4.702642e-03 3 1  ON 24
ci_026                 4.273172e-03 3 1  ON 25
ci_027                 6.454089e-03 3 1  ON 26
ci_028                 6.476482e-03 3 1  ON 27
ci_029                -4.877820e-03 3 1  ON 28
ci_030                -4.785596e-03 3 1  ON 29
ci_031                -7.388694e-03 3 1  ON 30
ci_032                -8.123179e-03 3 1  ON 31
ci_033                 4.600637e-03 3 1  ON 32
ci_034                 4.413553e-03 3 1  ON 33
ci_035                 1.126907e-03 3 1  ON 34
ci_036                 1.043146e-03 3 1  ON 35
ci_037                 4.953347e-03 3 1  ON 36
ci_038                 5.099310e-03 3 1  ON 37
ci_039                 5.306386e-03 3 1  ON 38
ci_040                 5.323086e-03 3 1  ON 39
ci_041                 4.970499e-03 3 1  ON 40
ci_042                 5.231233e-03 3 1  ON 41
ci_043                 4.943052e-03 3 1  ON 42
ci_044                 4.944182e-03 3 1  ON 43
ci_045                 3.123967e-03 3 1  ON 44
ci_046                 3.174246e-03 3 1  ON 45
ci_047                -7.790222e-04 3 1  ON 46
ci_048                -5.616836e-04 3 1  ON 47
ci_049                 1.580289e-03 3 1  ON 48
ci_050                 1.792516e-03 3 1  ON 49
ci_051                -1.106651e-03 3 1  ON 50
ci_052                -1.243279e-03 3 1  ON 51
ci_053                -2.610471e-03 3 1  ON 52
ci_054                -2.301978e-03 3 1  ON 53
ci_055                -1.483475e-03 3 1  ON 54
ci_056                -1.376714e-03 3 1  ON 55
ci_057                -1.240708e-03 3 1  ON 56
ci_058                -1.731077e-03 3 1  ON 57
ci_059                 3.171692e-04 3 1  ON 58
ci_060                 1.414703e-04 3 1  ON 59
ci_061                -3.305088e-04 3 1  ON 60
ci_062                -9.499769e-06 3 1  ON 61
ci_063                -5.232922e-04 3 1  ON 62
ci_064                -8.918525e-04 3 1  ON 63
ci_065                -2.408143e-03 3 1  ON 64
ci_066                -2.435285e-03 3 1  ON 65
ci_067                -2.101084e-03 3 1  ON 66
ci_068                -2.473560e-03 3 1  ON 67
ci_069                -2.085964e-04 3 1  ON 68
ci_070                 1.328450e-04 3 1  ON 69
ci_071                -1.874230e-03 3 1  ON 70
ci_072                -1.959430e-03 3 1  ON 71
ci_073                 5.749021e-04 3 1  ON 72
ci_074                 2.857507e-04 3 1  ON 73
ci_075                -2.910323e-04 3 1  ON 74
ci_076                -2.990999e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 3.0007e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s067 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s067 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=67  my_counter=0
  time step      = 5.0000e-02
  blocks         = 250
  steps          = 250
  substeps       = 10
  current        = 0
  target samples = 8.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">250</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">6.2500e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">8.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">6.2500e+04</parameter>
<parameter name="steps" condition="int">250</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2661e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="250">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =8000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 67
    time step          = 0.05
    reference energy   = -22.6048
    reference variance = 0.439759
====================================================
  Execution time = 1.0235e+02
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s067
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 62500 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 6.1142e+04
  VMC Eavg = -2.2670e+01
  VMC Evar = 5.0855e-01
  Total weights = 7.821207989e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.9062e+01
  </log>
</opt>
<opt stage="main" walkers="62500">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.496500450889
                                         uncertainty =       0.002186446228

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.496500450889
                                         uncertainty =       0.002186446228

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000249125024
  error estimate for blocks of size 2^( 2) =       0.000258070309
  error estimate for blocks of size 2^( 3) =       0.000265937502
  error estimate for blocks of size 2^( 4) =       0.000271617467
  error estimate for blocks of size 2^( 5) =       0.000274865914
  error estimate for blocks of size 2^( 6) =       0.000276642477
  error estimate for blocks of size 2^( 7) =       0.000277579090
  error estimate for blocks of size 2^( 8) =       0.000278360173
  error estimate for blocks of size 2^( 9) =       0.000279343533

      target function =                  N/A
              le_mean =     -22.669741350806
             les_mean =     514.425725652323
             stat err =       0.000277981318
             autocorr =       1.245077865592
              std dev =       0.704631975639
             le_variance =       0.496506221093


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266974135081e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.3878e+10, overlap shift 1.3878e+11 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.669741350832       residual = 2.57e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.669741350832       residual = 2.41e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.669741350832       residual = 4.80e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 1.3878e+10 is 1.221640e-14

solving harmonic davidson linear method for identity shift 5.5511e+10, overlap shift 5.5511e+11 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.669741350832       residual = 2.57e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.669741350832       residual = 2.41e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.669741350832       residual = 5.14e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 5.5511e+10 is 3.063928e-15

solving harmonic davidson linear method for identity shift 2.2204e+11, overlap shift 2.2204e+12 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.669741350832       residual = 2.57e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.669741350832       residual = 2.41e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.669741350832       residual = 4.79e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 2.2204e+11 is 7.635929e-16

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.129080 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.2142e+02
  </log>
  <optVariables href="FORM.s067.opt.xml">
ci_001                -7.050617e-01 3 1  ON 0
ci_002                -7.059926e-01 3 1  ON 1
ci_003                -3.765135e-02 3 1  ON 2
ci_004                -3.890325e-02 3 1  ON 3
ci_005                 1.612441e-02 3 1  ON 4
ci_006                 1.600090e-02 3 1  ON 5
ci_007                 1.228713e-02 3 1  ON 6
ci_008                 1.246533e-02 3 1  ON 7
ci_009                -1.173869e-02 3 1  ON 8
ci_010                -1.182876e-02 3 1  ON 9
ci_011                -8.176403e-03 3 1  ON 10
ci_012                -8.138278e-03 3 1  ON 11
ci_013                 9.647137e-03 3 1  ON 12
ci_014                 9.360580e-03 3 1  ON 13
ci_015                 1.228715e-02 3 1  ON 14
ci_016                 1.255400e-02 3 1  ON 15
ci_017                 1.088300e-02 3 1  ON 16
ci_018                 1.078149e-02 3 1  ON 17
ci_019                -2.514322e-03 3 1  ON 18
ci_020                -2.423765e-03 3 1  ON 19
ci_021                -8.459776e-03 3 1  ON 20
ci_022                -8.657034e-03 3 1  ON 21
ci_023                 7.805043e-03 3 1  ON 22
ci_024                 8.041852e-03 3 1  ON 23
ci_025                 4.702642e-03 3 1  ON 24
ci_026                 4.273172e-03 3 1  ON 25
ci_027                 6.454089e-03 3 1  ON 26
ci_028                 6.476482e-03 3 1  ON 27
ci_029                -4.877820e-03 3 1  ON 28
ci_030                -4.785596e-03 3 1  ON 29
ci_031                -7.388694e-03 3 1  ON 30
ci_032                -8.123179e-03 3 1  ON 31
ci_033                 4.600637e-03 3 1  ON 32
ci_034                 4.413553e-03 3 1  ON 33
ci_035                 1.126907e-03 3 1  ON 34
ci_036                 1.043146e-03 3 1  ON 35
ci_037                 4.953347e-03 3 1  ON 36
ci_038                 5.099310e-03 3 1  ON 37
ci_039                 5.306386e-03 3 1  ON 38
ci_040                 5.323086e-03 3 1  ON 39
ci_041                 4.970499e-03 3 1  ON 40
ci_042                 5.231233e-03 3 1  ON 41
ci_043                 4.943052e-03 3 1  ON 42
ci_044                 4.944182e-03 3 1  ON 43
ci_045                 3.123967e-03 3 1  ON 44
ci_046                 3.174246e-03 3 1  ON 45
ci_047                -7.790222e-04 3 1  ON 46
ci_048                -5.616836e-04 3 1  ON 47
ci_049                 1.580289e-03 3 1  ON 48
ci_050                 1.792516e-03 3 1  ON 49
ci_051                -1.106651e-03 3 1  ON 50
ci_052                -1.243279e-03 3 1  ON 51
ci_053                -2.610471e-03 3 1  ON 52
ci_054                -2.301978e-03 3 1  ON 53
ci_055                -1.483475e-03 3 1  ON 54
ci_056                -1.376714e-03 3 1  ON 55
ci_057                -1.240708e-03 3 1  ON 56
ci_058                -1.731077e-03 3 1  ON 57
ci_059                 3.171692e-04 3 1  ON 58
ci_060                 1.414703e-04 3 1  ON 59
ci_061                -3.305088e-04 3 1  ON 60
ci_062                -9.499769e-06 3 1  ON 61
ci_063                -5.232922e-04 3 1  ON 62
ci_064                -8.918525e-04 3 1  ON 63
ci_065                -2.408143e-03 3 1  ON 64
ci_066                -2.435285e-03 3 1  ON 65
ci_067                -2.101084e-03 3 1  ON 66
ci_068                -2.473560e-03 3 1  ON 67
ci_069                -2.085964e-04 3 1  ON 68
ci_070                 1.328450e-04 3 1  ON 69
ci_071                -1.874230e-03 3 1  ON 70
ci_072                -1.959430e-03 3 1  ON 71
ci_073                 5.749021e-04 3 1  ON 72
ci_074                 2.857507e-04 3 1  ON 73
ci_075                -2.910323e-04 3 1  ON 74
ci_076                -2.990999e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="250">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =8000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 67
    time step          = 0.05
    reference energy   = -22.6658
    reference variance = 0.33629
====================================================
  Execution time = 1.0216e+02
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s067
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 62500 
  VMC Eavg = -2.2669e+01
  VMC Evar = 5.0807e-01
  Total weights = 7.8211e+06
  Execution time = 1.4643e+01
  </log>
</opt>
<opt stage="main" walkers="62500">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.495322933470
                                         uncertainty =       0.001588098066

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.495322933470
                                         uncertainty =       0.001588098066

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000248828109
  error estimate for blocks of size 2^( 2) =       0.000257860463
  error estimate for blocks of size 2^( 3) =       0.000265996621
  error estimate for blocks of size 2^( 4) =       0.000271575539
  error estimate for blocks of size 2^( 5) =       0.000274973139
  error estimate for blocks of size 2^( 6) =       0.000276721099
  error estimate for blocks of size 2^( 7) =       0.000278126585
  error estimate for blocks of size 2^( 8) =       0.000278354309
  error estimate for blocks of size 2^( 9) =       0.000277600092

      target function =                  N/A
              le_mean =     -22.669387605446
             les_mean =     514.409201455870
             stat err =       0.000277700521
             autocorr =       1.245530915590
              std dev =       0.703792172952
             le_variance =       0.495323422709

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.495322933470
                                         uncertainty =       0.001588098066

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.495322933470
                                         uncertainty =       0.001588098066

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000248828109
  error estimate for blocks of size 2^( 2) =       0.000257860463
  error estimate for blocks of size 2^( 3) =       0.000265996621
  error estimate for blocks of size 2^( 4) =       0.000271575539
  error estimate for blocks of size 2^( 5) =       0.000274973139
  error estimate for blocks of size 2^( 6) =       0.000276721099
  error estimate for blocks of size 2^( 7) =       0.000278126585
  error estimate for blocks of size 2^( 8) =       0.000278354309
  error estimate for blocks of size 2^( 9) =       0.000277600092

      target function =                  N/A
              le_mean =     -22.669387605446
             les_mean =     514.409201455870
             stat err =       0.000277700521
             autocorr =       1.245530915598
              std dev =       0.703792172953
             le_variance =       0.495323422709

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.495322933470
                                         uncertainty =       0.001588098066

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.495322933470
                                         uncertainty =       0.001588098066

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000248828109
  error estimate for blocks of size 2^( 2) =       0.000257860463
  error estimate for blocks of size 2^( 3) =       0.000265996621
  error estimate for blocks of size 2^( 4) =       0.000271575539
  error estimate for blocks of size 2^( 5) =       0.000274973139
  error estimate for blocks of size 2^( 6) =       0.000276721099
  error estimate for blocks of size 2^( 7) =       0.000278126585
  error estimate for blocks of size 2^( 8) =       0.000278354309
  error estimate for blocks of size 2^( 9) =       0.000277600092

      target function =                  N/A
              le_mean =     -22.669387605446
             les_mean =     514.409201455870
             stat err =       0.000277700521
             autocorr =       1.245530915610
              std dev =       0.703792172952
             le_variance =       0.495323422709

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.495322933470
                                         uncertainty =       0.001588098066

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.495322933470
                                         uncertainty =       0.001588098066

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000248828109
  error estimate for blocks of size 2^( 2) =       0.000257860463
  error estimate for blocks of size 2^( 3) =       0.000265996621
  error estimate for blocks of size 2^( 4) =       0.000271575539
  error estimate for blocks of size 2^( 5) =       0.000274973139
  error estimate for blocks of size 2^( 6) =       0.000276721099
  error estimate for blocks of size 2^( 7) =       0.000278126585
  error estimate for blocks of size 2^( 8) =       0.000278354309
  error estimate for blocks of size 2^( 9) =       0.000277600092

      target function =                  N/A
              le_mean =     -22.669387605446
             les_mean =     514.409201455870
             stat err =       0.000277700521
             autocorr =       1.245530915602
              std dev =       0.703792172952
             le_variance =       0.495323422709


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.669387605446        initial
     1.3878e+10     1.3878e+11             1.2216e-14       -22.669387605446
     5.5511e+10     5.5511e+11             3.0639e-15       -22.669387605446  <--
     2.2204e+11     2.2204e+12             7.6359e-16       -22.669387605446

*****************************************************************************
Applying the update for shift_i =   5.5511e+10     and shift_s =   5.5511e+11
*****************************************************************************

  Execution time = 1.7894e+02
  </log>
  <optVariables href="FORM.s067.opt.xml">
ci_001                -7.050617e-01 3 1  ON 0
ci_002                -7.059926e-01 3 1  ON 1
ci_003                -3.765135e-02 3 1  ON 2
ci_004                -3.890325e-02 3 1  ON 3
ci_005                 1.612441e-02 3 1  ON 4
ci_006                 1.600090e-02 3 1  ON 5
ci_007                 1.228713e-02 3 1  ON 6
ci_008                 1.246533e-02 3 1  ON 7
ci_009                -1.173869e-02 3 1  ON 8
ci_010                -1.182876e-02 3 1  ON 9
ci_011                -8.176403e-03 3 1  ON 10
ci_012                -8.138278e-03 3 1  ON 11
ci_013                 9.647137e-03 3 1  ON 12
ci_014                 9.360580e-03 3 1  ON 13
ci_015                 1.228715e-02 3 1  ON 14
ci_016                 1.255400e-02 3 1  ON 15
ci_017                 1.088300e-02 3 1  ON 16
ci_018                 1.078149e-02 3 1  ON 17
ci_019                -2.514322e-03 3 1  ON 18
ci_020                -2.423765e-03 3 1  ON 19
ci_021                -8.459776e-03 3 1  ON 20
ci_022                -8.657034e-03 3 1  ON 21
ci_023                 7.805043e-03 3 1  ON 22
ci_024                 8.041852e-03 3 1  ON 23
ci_025                 4.702642e-03 3 1  ON 24
ci_026                 4.273172e-03 3 1  ON 25
ci_027                 6.454089e-03 3 1  ON 26
ci_028                 6.476482e-03 3 1  ON 27
ci_029                -4.877820e-03 3 1  ON 28
ci_030                -4.785596e-03 3 1  ON 29
ci_031                -7.388694e-03 3 1  ON 30
ci_032                -8.123179e-03 3 1  ON 31
ci_033                 4.600637e-03 3 1  ON 32
ci_034                 4.413553e-03 3 1  ON 33
ci_035                 1.126907e-03 3 1  ON 34
ci_036                 1.043146e-03 3 1  ON 35
ci_037                 4.953347e-03 3 1  ON 36
ci_038                 5.099310e-03 3 1  ON 37
ci_039                 5.306386e-03 3 1  ON 38
ci_040                 5.323086e-03 3 1  ON 39
ci_041                 4.970499e-03 3 1  ON 40
ci_042                 5.231233e-03 3 1  ON 41
ci_043                 4.943052e-03 3 1  ON 42
ci_044                 4.944182e-03 3 1  ON 43
ci_045                 3.123967e-03 3 1  ON 44
ci_046                 3.174246e-03 3 1  ON 45
ci_047                -7.790222e-04 3 1  ON 46
ci_048                -5.616836e-04 3 1  ON 47
ci_049                 1.580289e-03 3 1  ON 48
ci_050                 1.792516e-03 3 1  ON 49
ci_051                -1.106651e-03 3 1  ON 50
ci_052                -1.243279e-03 3 1  ON 51
ci_053                -2.610471e-03 3 1  ON 52
ci_054                -2.301978e-03 3 1  ON 53
ci_055                -1.483475e-03 3 1  ON 54
ci_056                -1.376714e-03 3 1  ON 55
ci_057                -1.240708e-03 3 1  ON 56
ci_058                -1.731077e-03 3 1  ON 57
ci_059                 3.171692e-04 3 1  ON 58
ci_060                 1.414703e-04 3 1  ON 59
ci_061                -3.305088e-04 3 1  ON 60
ci_062                -9.499769e-06 3 1  ON 61
ci_063                -5.232922e-04 3 1  ON 62
ci_064                -8.918525e-04 3 1  ON 63
ci_065                -2.408143e-03 3 1  ON 64
ci_066                -2.435285e-03 3 1  ON 65
ci_067                -2.101084e-03 3 1  ON 66
ci_068                -2.473560e-03 3 1  ON 67
ci_069                -2.085964e-04 3 1  ON 68
ci_070                 1.328450e-04 3 1  ON 69
ci_071                -1.874230e-03 3 1  ON 70
ci_072                -1.959430e-03 3 1  ON 71
ci_073                 5.749021e-04 3 1  ON 72
ci_074                 2.857507e-04 3 1  ON 73
ci_075                -2.910323e-04 3 1  ON 74
ci_076                -2.990999e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 3.0042e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s068 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s068 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=68  my_counter=0
  time step      = 5.0000e-02
  blocks         = 250
  steps          = 250
  substeps       = 10
  current        = 0
  target samples = 8.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">250</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">6.2500e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">8.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">6.2500e+04</parameter>
<parameter name="steps" condition="int">250</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2661e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="250">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =8000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 68
    time step          = 0.05
    reference energy   = -22.7401
    reference variance = 0.367645
====================================================
  Execution time = 1.0243e+02
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s068
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 62500 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 6.1086e+04
  VMC Eavg = -2.2670e+01
  VMC Evar = 5.1216e-01
  Total weights = 7.820821258e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.9319e+01
  </log>
</opt>
<opt stage="main" walkers="62500">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.498354260281
                                         uncertainty =       0.001868550525

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.498354260281
                                         uncertainty =       0.001868550525

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000249588584
  error estimate for blocks of size 2^( 2) =       0.000258545101
  error estimate for blocks of size 2^( 3) =       0.000266503841
  error estimate for blocks of size 2^( 4) =       0.000272181651
  error estimate for blocks of size 2^( 5) =       0.000275477831
  error estimate for blocks of size 2^( 6) =       0.000276929502
  error estimate for blocks of size 2^( 7) =       0.000277904191
  error estimate for blocks of size 2^( 8) =       0.000278536648
  error estimate for blocks of size 2^( 9) =       0.000279531430

      target function =                  N/A
              le_mean =     -22.669711199543
             les_mean =     514.427965325068
             stat err =       0.000278225443
             autocorr =       1.242636907429
              std dev =       0.705943122200
             le_variance =       0.498355691782


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266971119954e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.3878e+10, overlap shift 1.3878e+11 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.669711199566       residual = 4.99e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.669711199566       residual = 4.10e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.669711199567       residual = 1.59e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.669711199566       residual = 5.91e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 1.3878e+10 is 1.568603e-14

solving harmonic davidson linear method for identity shift 5.5511e+10, overlap shift 5.5511e+11 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.669711199566       residual = 4.99e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.669711199566       residual = 4.10e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.669711199566       residual = 1.52e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.669699277900       residual = 3.44e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 5.5511e+10 is 3.907083e-15

solving harmonic davidson linear method for identity shift 2.2204e+11, overlap shift 2.2204e+12 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.669711199566       residual = 4.99e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.669711199566       residual = 4.10e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.669711199567       residual = 6.22e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.669663210583       residual = 7.20e-08           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.669711199566       residual = 8.51e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          4 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 2.2204e+11 is 9.841846e-16

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.130528 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.2176e+02
  </log>
  <optVariables href="FORM.s068.opt.xml">
ci_001                -7.050617e-01 3 1  ON 0
ci_002                -7.059926e-01 3 1  ON 1
ci_003                -3.765135e-02 3 1  ON 2
ci_004                -3.890325e-02 3 1  ON 3
ci_005                 1.612441e-02 3 1  ON 4
ci_006                 1.600090e-02 3 1  ON 5
ci_007                 1.228713e-02 3 1  ON 6
ci_008                 1.246533e-02 3 1  ON 7
ci_009                -1.173869e-02 3 1  ON 8
ci_010                -1.182876e-02 3 1  ON 9
ci_011                -8.176403e-03 3 1  ON 10
ci_012                -8.138278e-03 3 1  ON 11
ci_013                 9.647137e-03 3 1  ON 12
ci_014                 9.360580e-03 3 1  ON 13
ci_015                 1.228715e-02 3 1  ON 14
ci_016                 1.255400e-02 3 1  ON 15
ci_017                 1.088300e-02 3 1  ON 16
ci_018                 1.078149e-02 3 1  ON 17
ci_019                -2.514322e-03 3 1  ON 18
ci_020                -2.423765e-03 3 1  ON 19
ci_021                -8.459776e-03 3 1  ON 20
ci_022                -8.657034e-03 3 1  ON 21
ci_023                 7.805043e-03 3 1  ON 22
ci_024                 8.041852e-03 3 1  ON 23
ci_025                 4.702642e-03 3 1  ON 24
ci_026                 4.273172e-03 3 1  ON 25
ci_027                 6.454089e-03 3 1  ON 26
ci_028                 6.476482e-03 3 1  ON 27
ci_029                -4.877820e-03 3 1  ON 28
ci_030                -4.785596e-03 3 1  ON 29
ci_031                -7.388694e-03 3 1  ON 30
ci_032                -8.123179e-03 3 1  ON 31
ci_033                 4.600637e-03 3 1  ON 32
ci_034                 4.413553e-03 3 1  ON 33
ci_035                 1.126907e-03 3 1  ON 34
ci_036                 1.043146e-03 3 1  ON 35
ci_037                 4.953347e-03 3 1  ON 36
ci_038                 5.099310e-03 3 1  ON 37
ci_039                 5.306386e-03 3 1  ON 38
ci_040                 5.323086e-03 3 1  ON 39
ci_041                 4.970499e-03 3 1  ON 40
ci_042                 5.231233e-03 3 1  ON 41
ci_043                 4.943052e-03 3 1  ON 42
ci_044                 4.944182e-03 3 1  ON 43
ci_045                 3.123967e-03 3 1  ON 44
ci_046                 3.174246e-03 3 1  ON 45
ci_047                -7.790222e-04 3 1  ON 46
ci_048                -5.616836e-04 3 1  ON 47
ci_049                 1.580289e-03 3 1  ON 48
ci_050                 1.792516e-03 3 1  ON 49
ci_051                -1.106651e-03 3 1  ON 50
ci_052                -1.243279e-03 3 1  ON 51
ci_053                -2.610471e-03 3 1  ON 52
ci_054                -2.301978e-03 3 1  ON 53
ci_055                -1.483475e-03 3 1  ON 54
ci_056                -1.376714e-03 3 1  ON 55
ci_057                -1.240708e-03 3 1  ON 56
ci_058                -1.731077e-03 3 1  ON 57
ci_059                 3.171692e-04 3 1  ON 58
ci_060                 1.414703e-04 3 1  ON 59
ci_061                -3.305088e-04 3 1  ON 60
ci_062                -9.499769e-06 3 1  ON 61
ci_063                -5.232922e-04 3 1  ON 62
ci_064                -8.918525e-04 3 1  ON 63
ci_065                -2.408143e-03 3 1  ON 64
ci_066                -2.435285e-03 3 1  ON 65
ci_067                -2.101084e-03 3 1  ON 66
ci_068                -2.473560e-03 3 1  ON 67
ci_069                -2.085964e-04 3 1  ON 68
ci_070                 1.328450e-04 3 1  ON 69
ci_071                -1.874230e-03 3 1  ON 70
ci_072                -1.959430e-03 3 1  ON 71
ci_073                 5.749021e-04 3 1  ON 72
ci_074                 2.857507e-04 3 1  ON 73
ci_075                -2.910323e-04 3 1  ON 74
ci_076                -2.990999e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="250">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =8000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 68
    time step          = 0.05
    reference energy   = -22.7594
    reference variance = 0.53685
====================================================
  Execution time = 1.0246e+02
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s068
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 62500 
  VMC Eavg = -2.2669e+01
  VMC Evar = 5.1541e-01
  Total weights = 7.8195e+06
  Execution time = 1.4631e+01
  </log>
</opt>
<opt stage="main" walkers="62500">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.499282056060
                                         uncertainty =       0.002192994921

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.499282056060
                                         uncertainty =       0.002192994921

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000249819107
  error estimate for blocks of size 2^( 2) =       0.000258754531
  error estimate for blocks of size 2^( 3) =       0.000266727820
  error estimate for blocks of size 2^( 4) =       0.000272441049
  error estimate for blocks of size 2^( 5) =       0.000275719864
  error estimate for blocks of size 2^( 6) =       0.000277677657
  error estimate for blocks of size 2^( 7) =       0.000278833148
  error estimate for blocks of size 2^( 8) =       0.000279867279
  error estimate for blocks of size 2^( 9) =       0.000281037764

      target function =                  N/A
              le_mean =     -22.669462884511
             les_mean =     514.419961094765
             stat err =       0.000279353962
             autocorr =       1.250427067477
              std dev =       0.706595139027
             le_variance =       0.499276690497

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.499282056060
                                         uncertainty =       0.002192994921

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.499282056060
                                         uncertainty =       0.002192994921

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000249819107
  error estimate for blocks of size 2^( 2) =       0.000258754531
  error estimate for blocks of size 2^( 3) =       0.000266727820
  error estimate for blocks of size 2^( 4) =       0.000272441049
  error estimate for blocks of size 2^( 5) =       0.000275719864
  error estimate for blocks of size 2^( 6) =       0.000277677657
  error estimate for blocks of size 2^( 7) =       0.000278833148
  error estimate for blocks of size 2^( 8) =       0.000279867279
  error estimate for blocks of size 2^( 9) =       0.000281037764

      target function =                  N/A
              le_mean =     -22.669462884511
             les_mean =     514.419961094765
             stat err =       0.000279353962
             autocorr =       1.250427067456
              std dev =       0.706595139027
             le_variance =       0.499276690497

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.499282056060
                                         uncertainty =       0.002192994921

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.499282056060
                                         uncertainty =       0.002192994921

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000249819107
  error estimate for blocks of size 2^( 2) =       0.000258754531
  error estimate for blocks of size 2^( 3) =       0.000266727820
  error estimate for blocks of size 2^( 4) =       0.000272441049
  error estimate for blocks of size 2^( 5) =       0.000275719864
  error estimate for blocks of size 2^( 6) =       0.000277677657
  error estimate for blocks of size 2^( 7) =       0.000278833148
  error estimate for blocks of size 2^( 8) =       0.000279867279
  error estimate for blocks of size 2^( 9) =       0.000281037764

      target function =                  N/A
              le_mean =     -22.669462884511
             les_mean =     514.419961094765
             stat err =       0.000279353962
             autocorr =       1.250427067457
              std dev =       0.706595139027
             le_variance =       0.499276690497

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.499282056060
                                         uncertainty =       0.002192994921

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.499282056060
                                         uncertainty =       0.002192994921

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000249819107
  error estimate for blocks of size 2^( 2) =       0.000258754531
  error estimate for blocks of size 2^( 3) =       0.000266727820
  error estimate for blocks of size 2^( 4) =       0.000272441049
  error estimate for blocks of size 2^( 5) =       0.000275719864
  error estimate for blocks of size 2^( 6) =       0.000277677657
  error estimate for blocks of size 2^( 7) =       0.000278833148
  error estimate for blocks of size 2^( 8) =       0.000279867279
  error estimate for blocks of size 2^( 9) =       0.000281037764

      target function =                  N/A
              le_mean =     -22.669462884511
             les_mean =     514.419961094765
             stat err =       0.000279353962
             autocorr =       1.250427067463
              std dev =       0.706595139027
             le_variance =       0.499276690497


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.669462884511        initial  <--
     1.3878e+10     1.3878e+11             1.5686e-14       -22.669462884511
     5.5511e+10     5.5511e+11             3.9071e-15       -22.669462884511
     2.2204e+11     2.2204e+12             9.8418e-16       -22.669462884511

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 177.8222
  </log>
  <optVariables href="FORM.s068.opt.xml">
ci_001                -7.050617e-01 3 1  ON 0
ci_002                -7.059926e-01 3 1  ON 1
ci_003                -3.765135e-02 3 1  ON 2
ci_004                -3.890325e-02 3 1  ON 3
ci_005                 1.612441e-02 3 1  ON 4
ci_006                 1.600090e-02 3 1  ON 5
ci_007                 1.228713e-02 3 1  ON 6
ci_008                 1.246533e-02 3 1  ON 7
ci_009                -1.173869e-02 3 1  ON 8
ci_010                -1.182876e-02 3 1  ON 9
ci_011                -8.176403e-03 3 1  ON 10
ci_012                -8.138278e-03 3 1  ON 11
ci_013                 9.647137e-03 3 1  ON 12
ci_014                 9.360580e-03 3 1  ON 13
ci_015                 1.228715e-02 3 1  ON 14
ci_016                 1.255400e-02 3 1  ON 15
ci_017                 1.088300e-02 3 1  ON 16
ci_018                 1.078149e-02 3 1  ON 17
ci_019                -2.514322e-03 3 1  ON 18
ci_020                -2.423765e-03 3 1  ON 19
ci_021                -8.459776e-03 3 1  ON 20
ci_022                -8.657034e-03 3 1  ON 21
ci_023                 7.805043e-03 3 1  ON 22
ci_024                 8.041852e-03 3 1  ON 23
ci_025                 4.702642e-03 3 1  ON 24
ci_026                 4.273172e-03 3 1  ON 25
ci_027                 6.454089e-03 3 1  ON 26
ci_028                 6.476482e-03 3 1  ON 27
ci_029                -4.877820e-03 3 1  ON 28
ci_030                -4.785596e-03 3 1  ON 29
ci_031                -7.388694e-03 3 1  ON 30
ci_032                -8.123179e-03 3 1  ON 31
ci_033                 4.600637e-03 3 1  ON 32
ci_034                 4.413553e-03 3 1  ON 33
ci_035                 1.126907e-03 3 1  ON 34
ci_036                 1.043146e-03 3 1  ON 35
ci_037                 4.953347e-03 3 1  ON 36
ci_038                 5.099310e-03 3 1  ON 37
ci_039                 5.306386e-03 3 1  ON 38
ci_040                 5.323086e-03 3 1  ON 39
ci_041                 4.970499e-03 3 1  ON 40
ci_042                 5.231233e-03 3 1  ON 41
ci_043                 4.943052e-03 3 1  ON 42
ci_044                 4.944182e-03 3 1  ON 43
ci_045                 3.123967e-03 3 1  ON 44
ci_046                 3.174246e-03 3 1  ON 45
ci_047                -7.790222e-04 3 1  ON 46
ci_048                -5.616836e-04 3 1  ON 47
ci_049                 1.580289e-03 3 1  ON 48
ci_050                 1.792516e-03 3 1  ON 49
ci_051                -1.106651e-03 3 1  ON 50
ci_052                -1.243279e-03 3 1  ON 51
ci_053                -2.610471e-03 3 1  ON 52
ci_054                -2.301978e-03 3 1  ON 53
ci_055                -1.483475e-03 3 1  ON 54
ci_056                -1.376714e-03 3 1  ON 55
ci_057                -1.240708e-03 3 1  ON 56
ci_058                -1.731077e-03 3 1  ON 57
ci_059                 3.171692e-04 3 1  ON 58
ci_060                 1.414703e-04 3 1  ON 59
ci_061                -3.305088e-04 3 1  ON 60
ci_062                -9.499769e-06 3 1  ON 61
ci_063                -5.232922e-04 3 1  ON 62
ci_064                -8.918525e-04 3 1  ON 63
ci_065                -2.408143e-03 3 1  ON 64
ci_066                -2.435285e-03 3 1  ON 65
ci_067                -2.101084e-03 3 1  ON 66
ci_068                -2.473560e-03 3 1  ON 67
ci_069                -2.085964e-04 3 1  ON 68
ci_070                 1.328450e-04 3 1  ON 69
ci_071                -1.874230e-03 3 1  ON 70
ci_072                -1.959430e-03 3 1  ON 71
ci_073                 5.749021e-04 3 1  ON 72
ci_074                 2.857507e-04 3 1  ON 73
ci_075                -2.910323e-04 3 1  ON 74
ci_076                -2.990999e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 2.9968e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s069 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s069 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=69  my_counter=0
  time step      = 5.0000e-02
  blocks         = 250
  steps          = 250
  substeps       = 10
  current        = 0
  target samples = 8.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">250</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">6.2500e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">8.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">6.2500e+04</parameter>
<parameter name="steps" condition="int">250</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2662e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="250">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =8000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 69
    time step          = 0.05
    reference energy   = -22.5983
    reference variance = 0.846543
====================================================
  Execution time = 1.0244e+02
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s069
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 62500 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 6.1135e+04
  VMC Eavg = -2.2669e+01
  VMC Evar = 5.0965e-01
  Total weights = 7.820275376e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.9059e+01
  </log>
</opt>
<opt stage="main" walkers="62500">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.496228502974
                                         uncertainty =       0.001446185903

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.496228502974
                                         uncertainty =       0.001446185903

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000249054752
  error estimate for blocks of size 2^( 2) =       0.000258065762
  error estimate for blocks of size 2^( 3) =       0.000266087141
  error estimate for blocks of size 2^( 4) =       0.000271945225
  error estimate for blocks of size 2^( 5) =       0.000274994093
  error estimate for blocks of size 2^( 6) =       0.000276506882
  error estimate for blocks of size 2^( 7) =       0.000278061879
  error estimate for blocks of size 2^( 8) =       0.000278697731
  error estimate for blocks of size 2^( 9) =       0.000278519473

      target function =                  N/A
              le_mean =     -22.669362748953
             les_mean =     514.409652862452
             stat err =       0.000277946491
             autocorr =       1.245468441243
              std dev =       0.704433215566
             le_variance =       0.496226155192


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266936274895e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.3878e+11, overlap shift 1.3878e+12 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.669362748981       residual = 3.81e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.669362748981       residual = 4.26e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.669362748981       residual = 7.07e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.669345091306       residual = 2.05e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 1.3878e+11 is 1.822687e-15

solving harmonic davidson linear method for identity shift 5.5511e+11, overlap shift 5.5511e+12 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.669362748981       residual = 3.81e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.669362748981       residual = 4.26e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.669362748981       residual = 2.24e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.669388799534       residual = 1.74e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.669353801906       residual = 2.62e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.670037780671       residual = 7.75e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.669405723007       residual = 6.51e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.680365255692       residual = 9.97e-03           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.663973043178       residual = 2.54e-03           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.674695157327       residual = 6.08e-04           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -22.658962283393       residual = 1.91e-03           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -22.688264495233       residual = 5.50e-03           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -22.648399207296       residual = 3.72e-02           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -22.629468152727       residual = 6.06e-02           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -22.680963385791       residual = 5.13e-02           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -22.637880186595       residual = 3.77e-01           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -22.729295079213       residual = 1.87e-01           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   energy =     -22.655356248364       residual = 7.59e-02           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   energy =     -22.640301266610       residual = 1.09e-01           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   energy =     -22.595892016259       residual = 2.25e-01           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   energy =     -22.802105693987       residual = 7.79e+00           smallest_sin_value = 9.98e-01
davidson iteration   21:   krylov dim =  22   energy =     -22.732530707580       residual = 1.13e+01           smallest_sin_value = 9.92e-01
davidson iteration   22 stopping due to small subspace S singular value of 9.32e-01
davidson solver did not converge after         22 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 5.5511e+11 is 4.731687e-16

solving harmonic davidson linear method for identity shift 2.2204e+12, overlap shift 2.2204e+13 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.669362748981       residual = 3.81e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.669362748981       residual = 4.26e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.669362748981       residual = 7.79e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.668591200612       residual = 6.60e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.669362748981       residual = 1.24e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.669362748981       residual = 1.22e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.669547507910       residual = 1.30e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.667299551538       residual = 8.79e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.662876172302       residual = 8.68e-04           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.672810719119       residual = 6.86e-04           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -22.710293717141       residual = 9.39e-03           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -23.619043625726       residual = 4.98e+00           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -22.086419255304       residual = 6.28e+00           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -22.753753742990       residual = 1.95e-01           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -23.788281102068       residual = 2.33e+02           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -22.701015187247       residual = 2.10e+01           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -18.998127284971       residual = 1.09e+02           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   energy =     -24.242440087214       residual = 2.42e+01           smallest_sin_value = 1.00e+00
davidson iteration   18 stopping due to too large eigenvalue change
davidson solver did not converge after         18 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 2.2204e+12 is 1.144980e-16

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.159862 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.2154e+02
  </log>
  <optVariables href="FORM.s069.opt.xml">
ci_001                -7.050617e-01 3 1  ON 0
ci_002                -7.059926e-01 3 1  ON 1
ci_003                -3.765135e-02 3 1  ON 2
ci_004                -3.890325e-02 3 1  ON 3
ci_005                 1.612441e-02 3 1  ON 4
ci_006                 1.600090e-02 3 1  ON 5
ci_007                 1.228713e-02 3 1  ON 6
ci_008                 1.246533e-02 3 1  ON 7
ci_009                -1.173869e-02 3 1  ON 8
ci_010                -1.182876e-02 3 1  ON 9
ci_011                -8.176403e-03 3 1  ON 10
ci_012                -8.138278e-03 3 1  ON 11
ci_013                 9.647137e-03 3 1  ON 12
ci_014                 9.360580e-03 3 1  ON 13
ci_015                 1.228715e-02 3 1  ON 14
ci_016                 1.255400e-02 3 1  ON 15
ci_017                 1.088300e-02 3 1  ON 16
ci_018                 1.078149e-02 3 1  ON 17
ci_019                -2.514322e-03 3 1  ON 18
ci_020                -2.423765e-03 3 1  ON 19
ci_021                -8.459776e-03 3 1  ON 20
ci_022                -8.657034e-03 3 1  ON 21
ci_023                 7.805043e-03 3 1  ON 22
ci_024                 8.041852e-03 3 1  ON 23
ci_025                 4.702642e-03 3 1  ON 24
ci_026                 4.273172e-03 3 1  ON 25
ci_027                 6.454089e-03 3 1  ON 26
ci_028                 6.476482e-03 3 1  ON 27
ci_029                -4.877820e-03 3 1  ON 28
ci_030                -4.785596e-03 3 1  ON 29
ci_031                -7.388694e-03 3 1  ON 30
ci_032                -8.123179e-03 3 1  ON 31
ci_033                 4.600637e-03 3 1  ON 32
ci_034                 4.413553e-03 3 1  ON 33
ci_035                 1.126907e-03 3 1  ON 34
ci_036                 1.043146e-03 3 1  ON 35
ci_037                 4.953347e-03 3 1  ON 36
ci_038                 5.099310e-03 3 1  ON 37
ci_039                 5.306386e-03 3 1  ON 38
ci_040                 5.323086e-03 3 1  ON 39
ci_041                 4.970499e-03 3 1  ON 40
ci_042                 5.231233e-03 3 1  ON 41
ci_043                 4.943052e-03 3 1  ON 42
ci_044                 4.944182e-03 3 1  ON 43
ci_045                 3.123967e-03 3 1  ON 44
ci_046                 3.174246e-03 3 1  ON 45
ci_047                -7.790222e-04 3 1  ON 46
ci_048                -5.616836e-04 3 1  ON 47
ci_049                 1.580289e-03 3 1  ON 48
ci_050                 1.792516e-03 3 1  ON 49
ci_051                -1.106651e-03 3 1  ON 50
ci_052                -1.243279e-03 3 1  ON 51
ci_053                -2.610471e-03 3 1  ON 52
ci_054                -2.301978e-03 3 1  ON 53
ci_055                -1.483475e-03 3 1  ON 54
ci_056                -1.376714e-03 3 1  ON 55
ci_057                -1.240708e-03 3 1  ON 56
ci_058                -1.731077e-03 3 1  ON 57
ci_059                 3.171692e-04 3 1  ON 58
ci_060                 1.414703e-04 3 1  ON 59
ci_061                -3.305088e-04 3 1  ON 60
ci_062                -9.499769e-06 3 1  ON 61
ci_063                -5.232922e-04 3 1  ON 62
ci_064                -8.918525e-04 3 1  ON 63
ci_065                -2.408143e-03 3 1  ON 64
ci_066                -2.435285e-03 3 1  ON 65
ci_067                -2.101084e-03 3 1  ON 66
ci_068                -2.473560e-03 3 1  ON 67
ci_069                -2.085964e-04 3 1  ON 68
ci_070                 1.328450e-04 3 1  ON 69
ci_071                -1.874230e-03 3 1  ON 70
ci_072                -1.959430e-03 3 1  ON 71
ci_073                 5.749021e-04 3 1  ON 72
ci_074                 2.857507e-04 3 1  ON 73
ci_075                -2.910323e-04 3 1  ON 74
ci_076                -2.990999e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="250">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =8000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 69
    time step          = 0.05
    reference energy   = -22.7328
    reference variance = 0.36044
====================================================
  Execution time = 1.0221e+02
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s069
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 62500 
  VMC Eavg = -2.2670e+01
  VMC Evar = 5.1063e-01
  Total weights = 7.8213e+06
  Execution time = 1.4661e+01
  </log>
</opt>
<opt stage="main" walkers="62500">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.496051857660
                                         uncertainty =       0.001390441465

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.496051857660
                                         uncertainty =       0.001390441465

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000249011082
  error estimate for blocks of size 2^( 2) =       0.000257856018
  error estimate for blocks of size 2^( 3) =       0.000265927230
  error estimate for blocks of size 2^( 4) =       0.000271760289
  error estimate for blocks of size 2^( 5) =       0.000275083170
  error estimate for blocks of size 2^( 6) =       0.000277032267
  error estimate for blocks of size 2^( 7) =       0.000277601945
  error estimate for blocks of size 2^( 8) =       0.000277887647
  error estimate for blocks of size 2^( 9) =       0.000278317666

      target function =                  N/A
              le_mean =     -22.669933612037
             les_mean =     514.436517661005
             stat err =       0.000277709881
             autocorr =       1.243785004245
              std dev =       0.704309697479
             le_variance =       0.496052149963

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.496051857660
                                         uncertainty =       0.001390441465

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.496051857660
                                         uncertainty =       0.001390441465

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000249011082
  error estimate for blocks of size 2^( 2) =       0.000257856018
  error estimate for blocks of size 2^( 3) =       0.000265927230
  error estimate for blocks of size 2^( 4) =       0.000271760289
  error estimate for blocks of size 2^( 5) =       0.000275083170
  error estimate for blocks of size 2^( 6) =       0.000277032267
  error estimate for blocks of size 2^( 7) =       0.000277601945
  error estimate for blocks of size 2^( 8) =       0.000277887647
  error estimate for blocks of size 2^( 9) =       0.000278317666

      target function =                  N/A
              le_mean =     -22.669933612037
             les_mean =     514.436517661005
             stat err =       0.000277709881
             autocorr =       1.243785004252
              std dev =       0.704309697479
             le_variance =       0.496052149963

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.496051857660
                                         uncertainty =       0.001390441465

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.496051857660
                                         uncertainty =       0.001390441465

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000249011082
  error estimate for blocks of size 2^( 2) =       0.000257856018
  error estimate for blocks of size 2^( 3) =       0.000265927230
  error estimate for blocks of size 2^( 4) =       0.000271760289
  error estimate for blocks of size 2^( 5) =       0.000275083170
  error estimate for blocks of size 2^( 6) =       0.000277032267
  error estimate for blocks of size 2^( 7) =       0.000277601945
  error estimate for blocks of size 2^( 8) =       0.000277887647
  error estimate for blocks of size 2^( 9) =       0.000278317666

      target function =                  N/A
              le_mean =     -22.669933612037
             les_mean =     514.436517661005
             stat err =       0.000277709881
             autocorr =       1.243785004248
              std dev =       0.704309697479
             le_variance =       0.496052149963

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.496051857660
                                         uncertainty =       0.001390441465

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.496051857660
                                         uncertainty =       0.001390441465

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000249011082
  error estimate for blocks of size 2^( 2) =       0.000257856018
  error estimate for blocks of size 2^( 3) =       0.000265927230
  error estimate for blocks of size 2^( 4) =       0.000271760289
  error estimate for blocks of size 2^( 5) =       0.000275083170
  error estimate for blocks of size 2^( 6) =       0.000277032267
  error estimate for blocks of size 2^( 7) =       0.000277601945
  error estimate for blocks of size 2^( 8) =       0.000277887647
  error estimate for blocks of size 2^( 9) =       0.000278317666

      target function =                  N/A
              le_mean =     -22.669933612037
             les_mean =     514.436517661005
             stat err =       0.000277709881
             autocorr =       1.243785004237
              std dev =       0.704309697479
             le_variance =       0.496052149963


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.669933612037        initial  <--
     1.3878e+11     1.3878e+12             1.8227e-15       -22.669933612037
     5.5511e+11     5.5511e+12             4.7317e-16       -22.669933612037
     2.2204e+12     2.2204e+13             1.1450e-16       -22.669933612037

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 178.1015
  </log>
  <optVariables href="FORM.s069.opt.xml">
ci_001                -7.050617e-01 3 1  ON 0
ci_002                -7.059926e-01 3 1  ON 1
ci_003                -3.765135e-02 3 1  ON 2
ci_004                -3.890325e-02 3 1  ON 3
ci_005                 1.612441e-02 3 1  ON 4
ci_006                 1.600090e-02 3 1  ON 5
ci_007                 1.228713e-02 3 1  ON 6
ci_008                 1.246533e-02 3 1  ON 7
ci_009                -1.173869e-02 3 1  ON 8
ci_010                -1.182876e-02 3 1  ON 9
ci_011                -8.176403e-03 3 1  ON 10
ci_012                -8.138278e-03 3 1  ON 11
ci_013                 9.647137e-03 3 1  ON 12
ci_014                 9.360580e-03 3 1  ON 13
ci_015                 1.228715e-02 3 1  ON 14
ci_016                 1.255400e-02 3 1  ON 15
ci_017                 1.088300e-02 3 1  ON 16
ci_018                 1.078149e-02 3 1  ON 17
ci_019                -2.514322e-03 3 1  ON 18
ci_020                -2.423765e-03 3 1  ON 19
ci_021                -8.459776e-03 3 1  ON 20
ci_022                -8.657034e-03 3 1  ON 21
ci_023                 7.805043e-03 3 1  ON 22
ci_024                 8.041852e-03 3 1  ON 23
ci_025                 4.702642e-03 3 1  ON 24
ci_026                 4.273172e-03 3 1  ON 25
ci_027                 6.454089e-03 3 1  ON 26
ci_028                 6.476482e-03 3 1  ON 27
ci_029                -4.877820e-03 3 1  ON 28
ci_030                -4.785596e-03 3 1  ON 29
ci_031                -7.388694e-03 3 1  ON 30
ci_032                -8.123179e-03 3 1  ON 31
ci_033                 4.600637e-03 3 1  ON 32
ci_034                 4.413553e-03 3 1  ON 33
ci_035                 1.126907e-03 3 1  ON 34
ci_036                 1.043146e-03 3 1  ON 35
ci_037                 4.953347e-03 3 1  ON 36
ci_038                 5.099310e-03 3 1  ON 37
ci_039                 5.306386e-03 3 1  ON 38
ci_040                 5.323086e-03 3 1  ON 39
ci_041                 4.970499e-03 3 1  ON 40
ci_042                 5.231233e-03 3 1  ON 41
ci_043                 4.943052e-03 3 1  ON 42
ci_044                 4.944182e-03 3 1  ON 43
ci_045                 3.123967e-03 3 1  ON 44
ci_046                 3.174246e-03 3 1  ON 45
ci_047                -7.790222e-04 3 1  ON 46
ci_048                -5.616836e-04 3 1  ON 47
ci_049                 1.580289e-03 3 1  ON 48
ci_050                 1.792516e-03 3 1  ON 49
ci_051                -1.106651e-03 3 1  ON 50
ci_052                -1.243279e-03 3 1  ON 51
ci_053                -2.610471e-03 3 1  ON 52
ci_054                -2.301978e-03 3 1  ON 53
ci_055                -1.483475e-03 3 1  ON 54
ci_056                -1.376714e-03 3 1  ON 55
ci_057                -1.240708e-03 3 1  ON 56
ci_058                -1.731077e-03 3 1  ON 57
ci_059                 3.171692e-04 3 1  ON 58
ci_060                 1.414703e-04 3 1  ON 59
ci_061                -3.305088e-04 3 1  ON 60
ci_062                -9.499769e-06 3 1  ON 61
ci_063                -5.232922e-04 3 1  ON 62
ci_064                -8.918525e-04 3 1  ON 63
ci_065                -2.408143e-03 3 1  ON 64
ci_066                -2.435285e-03 3 1  ON 65
ci_067                -2.101084e-03 3 1  ON 66
ci_068                -2.473560e-03 3 1  ON 67
ci_069                -2.085964e-04 3 1  ON 68
ci_070                 1.328450e-04 3 1  ON 69
ci_071                -1.874230e-03 3 1  ON 70
ci_072                -1.959430e-03 3 1  ON 71
ci_073                 5.749021e-04 3 1  ON 72
ci_074                 2.857507e-04 3 1  ON 73
ci_075                -2.910323e-04 3 1  ON 74
ci_076                -2.990999e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 2.9965e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s070 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s070 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=70  my_counter=0
  time step      = 5.0000e-02
  blocks         = 250
  steps          = 250
  substeps       = 10
  current        = 0
  target samples = 8.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">250</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">6.2500e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">8.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">6.2500e+04</parameter>
<parameter name="steps" condition="int">250</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2662e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="250">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =8000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 70
    time step          = 0.05
    reference energy   = -22.7347
    reference variance = 0.437485
====================================================
  Execution time = 1.0264e+02
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s070
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 62500 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 6.1097e+04
  VMC Eavg = -2.2670e+01
  VMC Evar = 5.1378e-01
  Total weights = 7.820854351e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.9067e+01
  </log>
</opt>
<opt stage="main" walkers="62500">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.498811753916
                                         uncertainty =       0.001661843171

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.498811753916
                                         uncertainty =       0.001661843171

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000249703683
  error estimate for blocks of size 2^( 2) =       0.000258598207
  error estimate for blocks of size 2^( 3) =       0.000266729969
  error estimate for blocks of size 2^( 4) =       0.000272477959
  error estimate for blocks of size 2^( 5) =       0.000275432610
  error estimate for blocks of size 2^( 6) =       0.000277015541
  error estimate for blocks of size 2^( 7) =       0.000278347870
  error estimate for blocks of size 2^( 8) =       0.000278173890
  error estimate for blocks of size 2^( 9) =       0.000279910207

      target function =                  N/A
              le_mean =     -22.669940719663
             les_mean =     514.439987423085
             stat err =       0.000278361877
             autocorr =       1.242709495732
              std dev =       0.706268670222
             le_variance =       0.498815434537


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266994071966e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.3878e+12, overlap shift 1.3878e+13 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.669940719690       residual = 4.32e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.669940719690       residual = 5.98e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.669940719690       residual = 2.33e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.669940719690       residual = 1.65e-08           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.669940719690       residual = 2.25e-11           smallest_sin_value = 1.00e+00
davidson solver converged in          4 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 1.3878e+12 is 1.583735e-16

solving harmonic davidson linear method for identity shift 5.5511e+12, overlap shift 5.5511e+13 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.669940719690       residual = 4.32e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.669940719690       residual = 5.98e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.669940719690       residual = 4.32e-05           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to small subspace S singular value of 6.28e-01
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 5.5511e+12 is 3.383103e-17

solving harmonic davidson linear method for identity shift 2.2204e+13, overlap shift 2.2204e+14 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.669940719690       residual = 4.32e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.669940719690       residual = 5.98e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.669940719690       residual = 2.33e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.688196592510       residual = 1.73e-03           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.669940719690       residual = 6.11e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.679595698342       residual = 4.95e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.658853511231       residual = 1.31e-03           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.537636355450       residual = 8.09e-02           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -20.586684129293       residual = 1.94e+01           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -19.900384939804       residual = 2.52e+01           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -25.946875234158       residual = 3.40e+01           smallest_sin_value = 1.00e+00
davidson iteration   11 stopping due to too large eigenvalue change
davidson solver did not converge after         11 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 2.2204e+13 is 9.803584e-18

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.162555 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.2172e+02
  </log>
  <optVariables href="FORM.s070.opt.xml">
ci_001                -7.050617e-01 3 1  ON 0
ci_002                -7.059926e-01 3 1  ON 1
ci_003                -3.765135e-02 3 1  ON 2
ci_004                -3.890325e-02 3 1  ON 3
ci_005                 1.612441e-02 3 1  ON 4
ci_006                 1.600090e-02 3 1  ON 5
ci_007                 1.228713e-02 3 1  ON 6
ci_008                 1.246533e-02 3 1  ON 7
ci_009                -1.173869e-02 3 1  ON 8
ci_010                -1.182876e-02 3 1  ON 9
ci_011                -8.176403e-03 3 1  ON 10
ci_012                -8.138278e-03 3 1  ON 11
ci_013                 9.647137e-03 3 1  ON 12
ci_014                 9.360580e-03 3 1  ON 13
ci_015                 1.228715e-02 3 1  ON 14
ci_016                 1.255400e-02 3 1  ON 15
ci_017                 1.088300e-02 3 1  ON 16
ci_018                 1.078149e-02 3 1  ON 17
ci_019                -2.514322e-03 3 1  ON 18
ci_020                -2.423765e-03 3 1  ON 19
ci_021                -8.459776e-03 3 1  ON 20
ci_022                -8.657034e-03 3 1  ON 21
ci_023                 7.805043e-03 3 1  ON 22
ci_024                 8.041852e-03 3 1  ON 23
ci_025                 4.702642e-03 3 1  ON 24
ci_026                 4.273172e-03 3 1  ON 25
ci_027                 6.454089e-03 3 1  ON 26
ci_028                 6.476482e-03 3 1  ON 27
ci_029                -4.877820e-03 3 1  ON 28
ci_030                -4.785596e-03 3 1  ON 29
ci_031                -7.388694e-03 3 1  ON 30
ci_032                -8.123179e-03 3 1  ON 31
ci_033                 4.600637e-03 3 1  ON 32
ci_034                 4.413553e-03 3 1  ON 33
ci_035                 1.126907e-03 3 1  ON 34
ci_036                 1.043146e-03 3 1  ON 35
ci_037                 4.953347e-03 3 1  ON 36
ci_038                 5.099310e-03 3 1  ON 37
ci_039                 5.306386e-03 3 1  ON 38
ci_040                 5.323086e-03 3 1  ON 39
ci_041                 4.970499e-03 3 1  ON 40
ci_042                 5.231233e-03 3 1  ON 41
ci_043                 4.943052e-03 3 1  ON 42
ci_044                 4.944182e-03 3 1  ON 43
ci_045                 3.123967e-03 3 1  ON 44
ci_046                 3.174246e-03 3 1  ON 45
ci_047                -7.790222e-04 3 1  ON 46
ci_048                -5.616836e-04 3 1  ON 47
ci_049                 1.580289e-03 3 1  ON 48
ci_050                 1.792516e-03 3 1  ON 49
ci_051                -1.106651e-03 3 1  ON 50
ci_052                -1.243279e-03 3 1  ON 51
ci_053                -2.610471e-03 3 1  ON 52
ci_054                -2.301978e-03 3 1  ON 53
ci_055                -1.483475e-03 3 1  ON 54
ci_056                -1.376714e-03 3 1  ON 55
ci_057                -1.240708e-03 3 1  ON 56
ci_058                -1.731077e-03 3 1  ON 57
ci_059                 3.171692e-04 3 1  ON 58
ci_060                 1.414703e-04 3 1  ON 59
ci_061                -3.305088e-04 3 1  ON 60
ci_062                -9.499769e-06 3 1  ON 61
ci_063                -5.232922e-04 3 1  ON 62
ci_064                -8.918525e-04 3 1  ON 63
ci_065                -2.408143e-03 3 1  ON 64
ci_066                -2.435285e-03 3 1  ON 65
ci_067                -2.101084e-03 3 1  ON 66
ci_068                -2.473560e-03 3 1  ON 67
ci_069                -2.085964e-04 3 1  ON 68
ci_070                 1.328450e-04 3 1  ON 69
ci_071                -1.874230e-03 3 1  ON 70
ci_072                -1.959430e-03 3 1  ON 71
ci_073                 5.749021e-04 3 1  ON 72
ci_074                 2.857507e-04 3 1  ON 73
ci_075                -2.910323e-04 3 1  ON 74
ci_076                -2.990999e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="250">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =8000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 70
    time step          = 0.05
    reference energy   = -22.6477
    reference variance = 0.421062
====================================================
  Execution time = 1.0204e+02
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s070
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 62500 
  VMC Eavg = -2.2670e+01
  VMC Evar = 5.0853e-01
  Total weights = 7.8206e+06
  Execution time = 1.4647e+01
  </log>
</opt>
<opt stage="main" walkers="62500">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.496701142971
                                         uncertainty =       0.001402377953

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.496701142971
                                         uncertainty =       0.001402377953

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000249174774
  error estimate for blocks of size 2^( 2) =       0.000258005763
  error estimate for blocks of size 2^( 3) =       0.000266064097
  error estimate for blocks of size 2^( 4) =       0.000271736801
  error estimate for blocks of size 2^( 5) =       0.000274851180
  error estimate for blocks of size 2^( 6) =       0.000276627742
  error estimate for blocks of size 2^( 7) =       0.000277799004
  error estimate for blocks of size 2^( 8) =       0.000278676819
  error estimate for blocks of size 2^( 9) =       0.000279280307

      target function =                  N/A
              le_mean =     -22.669797210523
             les_mean =     514.428235043435
             stat err =       0.000278095968
             autocorr =       1.245607569853
              std dev =       0.704772689586
             le_variance =       0.496704543986

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.496701142971
                                         uncertainty =       0.001402377953

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.496701142971
                                         uncertainty =       0.001402377953

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000249174774
  error estimate for blocks of size 2^( 2) =       0.000258005763
  error estimate for blocks of size 2^( 3) =       0.000266064097
  error estimate for blocks of size 2^( 4) =       0.000271736801
  error estimate for blocks of size 2^( 5) =       0.000274851180
  error estimate for blocks of size 2^( 6) =       0.000276627742
  error estimate for blocks of size 2^( 7) =       0.000277799004
  error estimate for blocks of size 2^( 8) =       0.000278676819
  error estimate for blocks of size 2^( 9) =       0.000279280307

      target function =                  N/A
              le_mean =     -22.669797210523
             les_mean =     514.428235043435
             stat err =       0.000278095968
             autocorr =       1.245607569851
              std dev =       0.704772689586
             le_variance =       0.496704543986

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.496701142971
                                         uncertainty =       0.001402377953

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.496701142971
                                         uncertainty =       0.001402377953

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000249174774
  error estimate for blocks of size 2^( 2) =       0.000258005763
  error estimate for blocks of size 2^( 3) =       0.000266064097
  error estimate for blocks of size 2^( 4) =       0.000271736801
  error estimate for blocks of size 2^( 5) =       0.000274851180
  error estimate for blocks of size 2^( 6) =       0.000276627742
  error estimate for blocks of size 2^( 7) =       0.000277799004
  error estimate for blocks of size 2^( 8) =       0.000278676819
  error estimate for blocks of size 2^( 9) =       0.000279280307

      target function =                  N/A
              le_mean =     -22.669797210523
             les_mean =     514.428235043435
             stat err =       0.000278095968
             autocorr =       1.245607569854
              std dev =       0.704772689586
             le_variance =       0.496704543986

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.496701142971
                                         uncertainty =       0.001402377953

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.496701142971
                                         uncertainty =       0.001402377953

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000249174774
  error estimate for blocks of size 2^( 2) =       0.000258005763
  error estimate for blocks of size 2^( 3) =       0.000266064097
  error estimate for blocks of size 2^( 4) =       0.000271736801
  error estimate for blocks of size 2^( 5) =       0.000274851180
  error estimate for blocks of size 2^( 6) =       0.000276627742
  error estimate for blocks of size 2^( 7) =       0.000277799004
  error estimate for blocks of size 2^( 8) =       0.000278676819
  error estimate for blocks of size 2^( 9) =       0.000279280307

      target function =                  N/A
              le_mean =     -22.669797210523
             les_mean =     514.428235043435
             stat err =       0.000278095968
             autocorr =       1.245607569847
              std dev =       0.704772689586
             le_variance =       0.496704543986


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.669797210523        initial  <--
     1.3878e+12     1.3878e+13             1.5837e-16       -22.669797210523
     5.5511e+12     5.5511e+13             3.3831e-17       -22.669797210523
     2.2204e+13     2.2204e+14             9.8036e-18       -22.669797210523

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 178.3448
  </log>
  <optVariables href="FORM.s070.opt.xml">
ci_001                -7.050617e-01 3 1  ON 0
ci_002                -7.059926e-01 3 1  ON 1
ci_003                -3.765135e-02 3 1  ON 2
ci_004                -3.890325e-02 3 1  ON 3
ci_005                 1.612441e-02 3 1  ON 4
ci_006                 1.600090e-02 3 1  ON 5
ci_007                 1.228713e-02 3 1  ON 6
ci_008                 1.246533e-02 3 1  ON 7
ci_009                -1.173869e-02 3 1  ON 8
ci_010                -1.182876e-02 3 1  ON 9
ci_011                -8.176403e-03 3 1  ON 10
ci_012                -8.138278e-03 3 1  ON 11
ci_013                 9.647137e-03 3 1  ON 12
ci_014                 9.360580e-03 3 1  ON 13
ci_015                 1.228715e-02 3 1  ON 14
ci_016                 1.255400e-02 3 1  ON 15
ci_017                 1.088300e-02 3 1  ON 16
ci_018                 1.078149e-02 3 1  ON 17
ci_019                -2.514322e-03 3 1  ON 18
ci_020                -2.423765e-03 3 1  ON 19
ci_021                -8.459776e-03 3 1  ON 20
ci_022                -8.657034e-03 3 1  ON 21
ci_023                 7.805043e-03 3 1  ON 22
ci_024                 8.041852e-03 3 1  ON 23
ci_025                 4.702642e-03 3 1  ON 24
ci_026                 4.273172e-03 3 1  ON 25
ci_027                 6.454089e-03 3 1  ON 26
ci_028                 6.476482e-03 3 1  ON 27
ci_029                -4.877820e-03 3 1  ON 28
ci_030                -4.785596e-03 3 1  ON 29
ci_031                -7.388694e-03 3 1  ON 30
ci_032                -8.123179e-03 3 1  ON 31
ci_033                 4.600637e-03 3 1  ON 32
ci_034                 4.413553e-03 3 1  ON 33
ci_035                 1.126907e-03 3 1  ON 34
ci_036                 1.043146e-03 3 1  ON 35
ci_037                 4.953347e-03 3 1  ON 36
ci_038                 5.099310e-03 3 1  ON 37
ci_039                 5.306386e-03 3 1  ON 38
ci_040                 5.323086e-03 3 1  ON 39
ci_041                 4.970499e-03 3 1  ON 40
ci_042                 5.231233e-03 3 1  ON 41
ci_043                 4.943052e-03 3 1  ON 42
ci_044                 4.944182e-03 3 1  ON 43
ci_045                 3.123967e-03 3 1  ON 44
ci_046                 3.174246e-03 3 1  ON 45
ci_047                -7.790222e-04 3 1  ON 46
ci_048                -5.616836e-04 3 1  ON 47
ci_049                 1.580289e-03 3 1  ON 48
ci_050                 1.792516e-03 3 1  ON 49
ci_051                -1.106651e-03 3 1  ON 50
ci_052                -1.243279e-03 3 1  ON 51
ci_053                -2.610471e-03 3 1  ON 52
ci_054                -2.301978e-03 3 1  ON 53
ci_055                -1.483475e-03 3 1  ON 54
ci_056                -1.376714e-03 3 1  ON 55
ci_057                -1.240708e-03 3 1  ON 56
ci_058                -1.731077e-03 3 1  ON 57
ci_059                 3.171692e-04 3 1  ON 58
ci_060                 1.414703e-04 3 1  ON 59
ci_061                -3.305088e-04 3 1  ON 60
ci_062                -9.499769e-06 3 1  ON 61
ci_063                -5.232922e-04 3 1  ON 62
ci_064                -8.918525e-04 3 1  ON 63
ci_065                -2.408143e-03 3 1  ON 64
ci_066                -2.435285e-03 3 1  ON 65
ci_067                -2.101084e-03 3 1  ON 66
ci_068                -2.473560e-03 3 1  ON 67
ci_069                -2.085964e-04 3 1  ON 68
ci_070                 1.328450e-04 3 1  ON 69
ci_071                -1.874230e-03 3 1  ON 70
ci_072                -1.959430e-03 3 1  ON 71
ci_073                 5.749021e-04 3 1  ON 72
ci_074                 2.857507e-04 3 1  ON 73
ci_075                -2.910323e-04 3 1  ON 74
ci_076                -2.990999e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 3.0007e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s071 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s071 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=71  my_counter=0
  time step      = 5.0000e-02
  blocks         = 250
  steps          = 250
  substeps       = 10
  current        = 0
  target samples = 8.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">250</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">6.2500e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">8.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">6.2500e+04</parameter>
<parameter name="steps" condition="int">250</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2663e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="250">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =8000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 71
    time step          = 0.05
    reference energy   = -22.7237
    reference variance = 0.492816
====================================================
  Execution time = 1.0222e+02
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s071
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 62500 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 6.1121e+04
  VMC Eavg = -2.2670e+01
  VMC Evar = 5.0919e-01
  Total weights = 7.820229095e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.9031e+01
  </log>
</opt>
<opt stage="main" walkers="62500">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.496962645252
                                         uncertainty =       0.001534104311

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.496962645252
                                         uncertainty =       0.001534104311

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000249239927
  error estimate for blocks of size 2^( 2) =       0.000258160177
  error estimate for blocks of size 2^( 3) =       0.000266196385
  error estimate for blocks of size 2^( 4) =       0.000272064785
  error estimate for blocks of size 2^( 5) =       0.000275611345
  error estimate for blocks of size 2^( 6) =       0.000277370374
  error estimate for blocks of size 2^( 7) =       0.000277933051
  error estimate for blocks of size 2^( 8) =       0.000279396985
  error estimate for blocks of size 2^( 9) =       0.000280400617

      target function =                  N/A
              le_mean =     -22.669860180719
             les_mean =     514.431748852790
             stat err =       0.000278775257
             autocorr =       1.251045823630
              std dev =       0.704956970466
             le_variance =       0.496964330209


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266986018072e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.3878e+13, overlap shift 1.3878e+14 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.669860180742       residual = 3.21e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.669860180742       residual = 3.21e-05           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to small subspace S singular value of 6.29e-01
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 1.3878e+13 is 0.000000e+00

solving harmonic davidson linear method for identity shift 5.5511e+13, overlap shift 5.5511e+14 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.669860180742       residual = 3.21e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.669860180742       residual = 3.21e-05           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to small subspace S singular value of 6.29e-01
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 5.5511e+13 is 0.000000e+00

solving harmonic davidson linear method for identity shift 2.2204e+14, overlap shift 2.2204e+15 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.669860180742       residual = 3.21e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.669860180742       residual = 3.21e-05           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to small subspace S singular value of 6.29e-01
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 2.2204e+14 is 0.000000e+00

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.163627 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.2127e+02
  </log>
  <optVariables href="FORM.s071.opt.xml">
ci_001                -7.050617e-01 3 1  ON 0
ci_002                -7.059926e-01 3 1  ON 1
ci_003                -3.765135e-02 3 1  ON 2
ci_004                -3.890325e-02 3 1  ON 3
ci_005                 1.612441e-02 3 1  ON 4
ci_006                 1.600090e-02 3 1  ON 5
ci_007                 1.228713e-02 3 1  ON 6
ci_008                 1.246533e-02 3 1  ON 7
ci_009                -1.173869e-02 3 1  ON 8
ci_010                -1.182876e-02 3 1  ON 9
ci_011                -8.176403e-03 3 1  ON 10
ci_012                -8.138278e-03 3 1  ON 11
ci_013                 9.647137e-03 3 1  ON 12
ci_014                 9.360580e-03 3 1  ON 13
ci_015                 1.228715e-02 3 1  ON 14
ci_016                 1.255400e-02 3 1  ON 15
ci_017                 1.088300e-02 3 1  ON 16
ci_018                 1.078149e-02 3 1  ON 17
ci_019                -2.514322e-03 3 1  ON 18
ci_020                -2.423765e-03 3 1  ON 19
ci_021                -8.459776e-03 3 1  ON 20
ci_022                -8.657034e-03 3 1  ON 21
ci_023                 7.805043e-03 3 1  ON 22
ci_024                 8.041852e-03 3 1  ON 23
ci_025                 4.702642e-03 3 1  ON 24
ci_026                 4.273172e-03 3 1  ON 25
ci_027                 6.454089e-03 3 1  ON 26
ci_028                 6.476482e-03 3 1  ON 27
ci_029                -4.877820e-03 3 1  ON 28
ci_030                -4.785596e-03 3 1  ON 29
ci_031                -7.388694e-03 3 1  ON 30
ci_032                -8.123179e-03 3 1  ON 31
ci_033                 4.600637e-03 3 1  ON 32
ci_034                 4.413553e-03 3 1  ON 33
ci_035                 1.126907e-03 3 1  ON 34
ci_036                 1.043146e-03 3 1  ON 35
ci_037                 4.953347e-03 3 1  ON 36
ci_038                 5.099310e-03 3 1  ON 37
ci_039                 5.306386e-03 3 1  ON 38
ci_040                 5.323086e-03 3 1  ON 39
ci_041                 4.970499e-03 3 1  ON 40
ci_042                 5.231233e-03 3 1  ON 41
ci_043                 4.943052e-03 3 1  ON 42
ci_044                 4.944182e-03 3 1  ON 43
ci_045                 3.123967e-03 3 1  ON 44
ci_046                 3.174246e-03 3 1  ON 45
ci_047                -7.790222e-04 3 1  ON 46
ci_048                -5.616836e-04 3 1  ON 47
ci_049                 1.580289e-03 3 1  ON 48
ci_050                 1.792516e-03 3 1  ON 49
ci_051                -1.106651e-03 3 1  ON 50
ci_052                -1.243279e-03 3 1  ON 51
ci_053                -2.610471e-03 3 1  ON 52
ci_054                -2.301978e-03 3 1  ON 53
ci_055                -1.483475e-03 3 1  ON 54
ci_056                -1.376714e-03 3 1  ON 55
ci_057                -1.240708e-03 3 1  ON 56
ci_058                -1.731077e-03 3 1  ON 57
ci_059                 3.171692e-04 3 1  ON 58
ci_060                 1.414703e-04 3 1  ON 59
ci_061                -3.305088e-04 3 1  ON 60
ci_062                -9.499769e-06 3 1  ON 61
ci_063                -5.232922e-04 3 1  ON 62
ci_064                -8.918525e-04 3 1  ON 63
ci_065                -2.408143e-03 3 1  ON 64
ci_066                -2.435285e-03 3 1  ON 65
ci_067                -2.101084e-03 3 1  ON 66
ci_068                -2.473560e-03 3 1  ON 67
ci_069                -2.085964e-04 3 1  ON 68
ci_070                 1.328450e-04 3 1  ON 69
ci_071                -1.874230e-03 3 1  ON 70
ci_072                -1.959430e-03 3 1  ON 71
ci_073                 5.749021e-04 3 1  ON 72
ci_074                 2.857507e-04 3 1  ON 73
ci_075                -2.910323e-04 3 1  ON 74
ci_076                -2.990999e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="250">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =8000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 71
    time step          = 0.05
    reference energy   = -22.692
    reference variance = 0.505544
====================================================
  Execution time = 1.0200e+02
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s071
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 62500 
  VMC Eavg = -2.2670e+01
  VMC Evar = 5.0824e-01
  Total weights = 7.8209e+06
  Execution time = 1.4641e+01
  </log>
</opt>
<opt stage="main" walkers="62500">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.495757581773
                                         uncertainty =       0.001326584190

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.495757581773
                                         uncertainty =       0.001326584190

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000248937008
  error estimate for blocks of size 2^( 2) =       0.000257969142
  error estimate for blocks of size 2^( 3) =       0.000266106792
  error estimate for blocks of size 2^( 4) =       0.000272101648
  error estimate for blocks of size 2^( 5) =       0.000275399559
  error estimate for blocks of size 2^( 6) =       0.000277489092
  error estimate for blocks of size 2^( 7) =       0.000278196579
  error estimate for blocks of size 2^( 8) =       0.000279244305
  error estimate for blocks of size 2^( 9) =       0.000279415268

      target function =                  N/A
              le_mean =     -22.669656369042
             les_mean =     514.421561202389
             stat err =       0.000278586311
             autocorr =       1.252392952294
              std dev =       0.704100185293
             le_variance =       0.495757070930

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.495757581773
                                         uncertainty =       0.001326584190

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.495757581773
                                         uncertainty =       0.001326584190

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000248937008
  error estimate for blocks of size 2^( 2) =       0.000257969142
  error estimate for blocks of size 2^( 3) =       0.000266106792
  error estimate for blocks of size 2^( 4) =       0.000272101648
  error estimate for blocks of size 2^( 5) =       0.000275399559
  error estimate for blocks of size 2^( 6) =       0.000277489092
  error estimate for blocks of size 2^( 7) =       0.000278196579
  error estimate for blocks of size 2^( 8) =       0.000279244305
  error estimate for blocks of size 2^( 9) =       0.000279415268

      target function =                  N/A
              le_mean =     -22.669656369042
             les_mean =     514.421561202389
             stat err =       0.000278586311
             autocorr =       1.252392952294
              std dev =       0.704100185293
             le_variance =       0.495757070930

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.495757581773
                                         uncertainty =       0.001326584190

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.495757581773
                                         uncertainty =       0.001326584190

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000248937008
  error estimate for blocks of size 2^( 2) =       0.000257969142
  error estimate for blocks of size 2^( 3) =       0.000266106792
  error estimate for blocks of size 2^( 4) =       0.000272101648
  error estimate for blocks of size 2^( 5) =       0.000275399559
  error estimate for blocks of size 2^( 6) =       0.000277489092
  error estimate for blocks of size 2^( 7) =       0.000278196579
  error estimate for blocks of size 2^( 8) =       0.000279244305
  error estimate for blocks of size 2^( 9) =       0.000279415268

      target function =                  N/A
              le_mean =     -22.669656369042
             les_mean =     514.421561202389
             stat err =       0.000278586311
             autocorr =       1.252392952294
              std dev =       0.704100185293
             le_variance =       0.495757070930

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.495757581773
                                         uncertainty =       0.001326584190

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.495757581773
                                         uncertainty =       0.001326584190

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000248937008
  error estimate for blocks of size 2^( 2) =       0.000257969142
  error estimate for blocks of size 2^( 3) =       0.000266106792
  error estimate for blocks of size 2^( 4) =       0.000272101648
  error estimate for blocks of size 2^( 5) =       0.000275399559
  error estimate for blocks of size 2^( 6) =       0.000277489092
  error estimate for blocks of size 2^( 7) =       0.000278196579
  error estimate for blocks of size 2^( 8) =       0.000279244305
  error estimate for blocks of size 2^( 9) =       0.000279415268

      target function =                  N/A
              le_mean =     -22.669656369042
             les_mean =     514.421561202389
             stat err =       0.000278586311
             autocorr =       1.252392952294
              std dev =       0.704100185293
             le_variance =       0.495757070930


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.669656369042        initial  <--
     1.3878e+13     1.3878e+14             0.0000e+00       -22.669656369042
     5.5511e+13     5.5511e+14             0.0000e+00       -22.669656369042
     2.2204e+14     2.2204e+15             0.0000e+00       -22.669656369042

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 178.8808
  </log>
  <optVariables href="FORM.s071.opt.xml">
ci_001                -7.050617e-01 3 1  ON 0
ci_002                -7.059926e-01 3 1  ON 1
ci_003                -3.765135e-02 3 1  ON 2
ci_004                -3.890325e-02 3 1  ON 3
ci_005                 1.612441e-02 3 1  ON 4
ci_006                 1.600090e-02 3 1  ON 5
ci_007                 1.228713e-02 3 1  ON 6
ci_008                 1.246533e-02 3 1  ON 7
ci_009                -1.173869e-02 3 1  ON 8
ci_010                -1.182876e-02 3 1  ON 9
ci_011                -8.176403e-03 3 1  ON 10
ci_012                -8.138278e-03 3 1  ON 11
ci_013                 9.647137e-03 3 1  ON 12
ci_014                 9.360580e-03 3 1  ON 13
ci_015                 1.228715e-02 3 1  ON 14
ci_016                 1.255400e-02 3 1  ON 15
ci_017                 1.088300e-02 3 1  ON 16
ci_018                 1.078149e-02 3 1  ON 17
ci_019                -2.514322e-03 3 1  ON 18
ci_020                -2.423765e-03 3 1  ON 19
ci_021                -8.459776e-03 3 1  ON 20
ci_022                -8.657034e-03 3 1  ON 21
ci_023                 7.805043e-03 3 1  ON 22
ci_024                 8.041852e-03 3 1  ON 23
ci_025                 4.702642e-03 3 1  ON 24
ci_026                 4.273172e-03 3 1  ON 25
ci_027                 6.454089e-03 3 1  ON 26
ci_028                 6.476482e-03 3 1  ON 27
ci_029                -4.877820e-03 3 1  ON 28
ci_030                -4.785596e-03 3 1  ON 29
ci_031                -7.388694e-03 3 1  ON 30
ci_032                -8.123179e-03 3 1  ON 31
ci_033                 4.600637e-03 3 1  ON 32
ci_034                 4.413553e-03 3 1  ON 33
ci_035                 1.126907e-03 3 1  ON 34
ci_036                 1.043146e-03 3 1  ON 35
ci_037                 4.953347e-03 3 1  ON 36
ci_038                 5.099310e-03 3 1  ON 37
ci_039                 5.306386e-03 3 1  ON 38
ci_040                 5.323086e-03 3 1  ON 39
ci_041                 4.970499e-03 3 1  ON 40
ci_042                 5.231233e-03 3 1  ON 41
ci_043                 4.943052e-03 3 1  ON 42
ci_044                 4.944182e-03 3 1  ON 43
ci_045                 3.123967e-03 3 1  ON 44
ci_046                 3.174246e-03 3 1  ON 45
ci_047                -7.790222e-04 3 1  ON 46
ci_048                -5.616836e-04 3 1  ON 47
ci_049                 1.580289e-03 3 1  ON 48
ci_050                 1.792516e-03 3 1  ON 49
ci_051                -1.106651e-03 3 1  ON 50
ci_052                -1.243279e-03 3 1  ON 51
ci_053                -2.610471e-03 3 1  ON 52
ci_054                -2.301978e-03 3 1  ON 53
ci_055                -1.483475e-03 3 1  ON 54
ci_056                -1.376714e-03 3 1  ON 55
ci_057                -1.240708e-03 3 1  ON 56
ci_058                -1.731077e-03 3 1  ON 57
ci_059                 3.171692e-04 3 1  ON 58
ci_060                 1.414703e-04 3 1  ON 59
ci_061                -3.305088e-04 3 1  ON 60
ci_062                -9.499769e-06 3 1  ON 61
ci_063                -5.232922e-04 3 1  ON 62
ci_064                -8.918525e-04 3 1  ON 63
ci_065                -2.408143e-03 3 1  ON 64
ci_066                -2.435285e-03 3 1  ON 65
ci_067                -2.101084e-03 3 1  ON 66
ci_068                -2.473560e-03 3 1  ON 67
ci_069                -2.085964e-04 3 1  ON 68
ci_070                 1.328450e-04 3 1  ON 69
ci_071                -1.874230e-03 3 1  ON 70
ci_072                -1.959430e-03 3 1  ON 71
ci_073                 5.749021e-04 3 1  ON 72
ci_074                 2.857507e-04 3 1  ON 73
ci_075                -2.910323e-04 3 1  ON 74
ci_076                -2.990999e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 3.0015e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s072 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s072 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=72  my_counter=0
  time step      = 5.0000e-02
  blocks         = 250
  steps          = 250
  substeps       = 10
  current        = 0
  target samples = 8.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">250</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">6.2500e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">8.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">6.2500e+04</parameter>
<parameter name="steps" condition="int">250</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2663e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="250">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =8000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 72
    time step          = 0.05
    reference energy   = -22.7395
    reference variance = 0.934421
====================================================
  Execution time = 1.0269e+02
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s072
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 62500 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 6.1052e+04
  VMC Eavg = -2.2670e+01
  VMC Evar = 5.0698e-01
  Total weights = 7.819995757e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.9301e+01
  </log>
</opt>
<opt stage="main" walkers="62500">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.495046428398
                                         uncertainty =       0.001415401519

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.495046428398
                                         uncertainty =       0.001415401519

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000248759393
  error estimate for blocks of size 2^( 2) =       0.000257725186
  error estimate for blocks of size 2^( 3) =       0.000265581105
  error estimate for blocks of size 2^( 4) =       0.000271225668
  error estimate for blocks of size 2^( 5) =       0.000274638375
  error estimate for blocks of size 2^( 6) =       0.000276139091
  error estimate for blocks of size 2^( 7) =       0.000276618451
  error estimate for blocks of size 2^( 8) =       0.000277064306
  error estimate for blocks of size 2^( 9) =       0.000277752854

      target function =                  N/A
              le_mean =     -22.669853035758
             les_mean =     514.429216499171
             stat err =       0.000276893675
             autocorr =       1.238987979833
              std dev =       0.703597815939
             le_variance =       0.495049886594


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266985303576e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.3878e+14, overlap shift 1.3878e+15 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.669853035780       residual = 4.47e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.669853035780       residual = 4.47e-05           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to small subspace S singular value of 7.54e-01
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 1.3878e+14 is 0.000000e+00

solving harmonic davidson linear method for identity shift 5.5511e+14, overlap shift 5.5511e+15 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.669853035780       residual = 4.47e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.669853035780       residual = 4.47e-05           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to small subspace S singular value of 7.54e-01
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 5.5511e+14 is 0.000000e+00

solving harmonic davidson linear method for identity shift 2.2204e+15, overlap shift 2.2204e+16 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.669853035780       residual = 4.47e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.669853035780       residual = 4.47e-05           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to small subspace S singular value of 7.31e-01
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 2.2204e+15 is 0.000000e+00

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.164706 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.2200e+02
  </log>
  <optVariables href="FORM.s072.opt.xml">
ci_001                -7.050617e-01 3 1  ON 0
ci_002                -7.059926e-01 3 1  ON 1
ci_003                -3.765135e-02 3 1  ON 2
ci_004                -3.890325e-02 3 1  ON 3
ci_005                 1.612441e-02 3 1  ON 4
ci_006                 1.600090e-02 3 1  ON 5
ci_007                 1.228713e-02 3 1  ON 6
ci_008                 1.246533e-02 3 1  ON 7
ci_009                -1.173869e-02 3 1  ON 8
ci_010                -1.182876e-02 3 1  ON 9
ci_011                -8.176403e-03 3 1  ON 10
ci_012                -8.138278e-03 3 1  ON 11
ci_013                 9.647137e-03 3 1  ON 12
ci_014                 9.360580e-03 3 1  ON 13
ci_015                 1.228715e-02 3 1  ON 14
ci_016                 1.255400e-02 3 1  ON 15
ci_017                 1.088300e-02 3 1  ON 16
ci_018                 1.078149e-02 3 1  ON 17
ci_019                -2.514322e-03 3 1  ON 18
ci_020                -2.423765e-03 3 1  ON 19
ci_021                -8.459776e-03 3 1  ON 20
ci_022                -8.657034e-03 3 1  ON 21
ci_023                 7.805043e-03 3 1  ON 22
ci_024                 8.041852e-03 3 1  ON 23
ci_025                 4.702642e-03 3 1  ON 24
ci_026                 4.273172e-03 3 1  ON 25
ci_027                 6.454089e-03 3 1  ON 26
ci_028                 6.476482e-03 3 1  ON 27
ci_029                -4.877820e-03 3 1  ON 28
ci_030                -4.785596e-03 3 1  ON 29
ci_031                -7.388694e-03 3 1  ON 30
ci_032                -8.123179e-03 3 1  ON 31
ci_033                 4.600637e-03 3 1  ON 32
ci_034                 4.413553e-03 3 1  ON 33
ci_035                 1.126907e-03 3 1  ON 34
ci_036                 1.043146e-03 3 1  ON 35
ci_037                 4.953347e-03 3 1  ON 36
ci_038                 5.099310e-03 3 1  ON 37
ci_039                 5.306386e-03 3 1  ON 38
ci_040                 5.323086e-03 3 1  ON 39
ci_041                 4.970499e-03 3 1  ON 40
ci_042                 5.231233e-03 3 1  ON 41
ci_043                 4.943052e-03 3 1  ON 42
ci_044                 4.944182e-03 3 1  ON 43
ci_045                 3.123967e-03 3 1  ON 44
ci_046                 3.174246e-03 3 1  ON 45
ci_047                -7.790222e-04 3 1  ON 46
ci_048                -5.616836e-04 3 1  ON 47
ci_049                 1.580289e-03 3 1  ON 48
ci_050                 1.792516e-03 3 1  ON 49
ci_051                -1.106651e-03 3 1  ON 50
ci_052                -1.243279e-03 3 1  ON 51
ci_053                -2.610471e-03 3 1  ON 52
ci_054                -2.301978e-03 3 1  ON 53
ci_055                -1.483475e-03 3 1  ON 54
ci_056                -1.376714e-03 3 1  ON 55
ci_057                -1.240708e-03 3 1  ON 56
ci_058                -1.731077e-03 3 1  ON 57
ci_059                 3.171692e-04 3 1  ON 58
ci_060                 1.414703e-04 3 1  ON 59
ci_061                -3.305088e-04 3 1  ON 60
ci_062                -9.499769e-06 3 1  ON 61
ci_063                -5.232922e-04 3 1  ON 62
ci_064                -8.918525e-04 3 1  ON 63
ci_065                -2.408143e-03 3 1  ON 64
ci_066                -2.435285e-03 3 1  ON 65
ci_067                -2.101084e-03 3 1  ON 66
ci_068                -2.473560e-03 3 1  ON 67
ci_069                -2.085964e-04 3 1  ON 68
ci_070                 1.328450e-04 3 1  ON 69
ci_071                -1.874230e-03 3 1  ON 70
ci_072                -1.959430e-03 3 1  ON 71
ci_073                 5.749021e-04 3 1  ON 72
ci_074                 2.857507e-04 3 1  ON 73
ci_075                -2.910323e-04 3 1  ON 74
ci_076                -2.990999e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="250">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =8000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 72
    time step          = 0.05
    reference energy   = -22.6565
    reference variance = 0.39475
====================================================
  Execution time = 1.0202e+02
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s072
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 62500 
  VMC Eavg = -2.2670e+01
  VMC Evar = 5.1178e-01
  Total weights = 7.8202e+06
  Execution time = 1.4639e+01
  </log>
</opt>
<opt stage="main" walkers="62500">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.498111057825
                                         uncertainty =       0.001695162484

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.498111057825
                                         uncertainty =       0.001695162484

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000249527743
  error estimate for blocks of size 2^( 2) =       0.000258498522
  error estimate for blocks of size 2^( 3) =       0.000266484605
  error estimate for blocks of size 2^( 4) =       0.000272254239
  error estimate for blocks of size 2^( 5) =       0.000275598774
  error estimate for blocks of size 2^( 6) =       0.000277505645
  error estimate for blocks of size 2^( 7) =       0.000279145485
  error estimate for blocks of size 2^( 8) =       0.000279232223
  error estimate for blocks of size 2^( 9) =       0.000280578621

      target function =                  N/A
              le_mean =     -22.669969916348
             les_mean =     514.439319724876
             stat err =       0.000279115494
             autocorr =       1.251210016296
              std dev =       0.705771037106
             le_variance =       0.498112756817

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.498111057825
                                         uncertainty =       0.001695162484

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.498111057825
                                         uncertainty =       0.001695162484

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000249527743
  error estimate for blocks of size 2^( 2) =       0.000258498522
  error estimate for blocks of size 2^( 3) =       0.000266484605
  error estimate for blocks of size 2^( 4) =       0.000272254239
  error estimate for blocks of size 2^( 5) =       0.000275598774
  error estimate for blocks of size 2^( 6) =       0.000277505645
  error estimate for blocks of size 2^( 7) =       0.000279145485
  error estimate for blocks of size 2^( 8) =       0.000279232223
  error estimate for blocks of size 2^( 9) =       0.000280578621

      target function =                  N/A
              le_mean =     -22.669969916348
             les_mean =     514.439319724876
             stat err =       0.000279115494
             autocorr =       1.251210016296
              std dev =       0.705771037106
             le_variance =       0.498112756817

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.498111057825
                                         uncertainty =       0.001695162484

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.498111057825
                                         uncertainty =       0.001695162484

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000249527743
  error estimate for blocks of size 2^( 2) =       0.000258498522
  error estimate for blocks of size 2^( 3) =       0.000266484605
  error estimate for blocks of size 2^( 4) =       0.000272254239
  error estimate for blocks of size 2^( 5) =       0.000275598774
  error estimate for blocks of size 2^( 6) =       0.000277505645
  error estimate for blocks of size 2^( 7) =       0.000279145485
  error estimate for blocks of size 2^( 8) =       0.000279232223
  error estimate for blocks of size 2^( 9) =       0.000280578621

      target function =                  N/A
              le_mean =     -22.669969916348
             les_mean =     514.439319724876
             stat err =       0.000279115494
             autocorr =       1.251210016296
              std dev =       0.705771037106
             le_variance =       0.498112756817

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.498111057825
                                         uncertainty =       0.001695162484

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.498111057825
                                         uncertainty =       0.001695162484

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000249527743
  error estimate for blocks of size 2^( 2) =       0.000258498522
  error estimate for blocks of size 2^( 3) =       0.000266484605
  error estimate for blocks of size 2^( 4) =       0.000272254239
  error estimate for blocks of size 2^( 5) =       0.000275598774
  error estimate for blocks of size 2^( 6) =       0.000277505645
  error estimate for blocks of size 2^( 7) =       0.000279145485
  error estimate for blocks of size 2^( 8) =       0.000279232223
  error estimate for blocks of size 2^( 9) =       0.000280578621

      target function =                  N/A
              le_mean =     -22.669969916348
             les_mean =     514.439319724876
             stat err =       0.000279115494
             autocorr =       1.251210016296
              std dev =       0.705771037106
             le_variance =       0.498112756817


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.669969916348        initial  <--
     1.3878e+14     1.3878e+15             0.0000e+00       -22.669969916348
     5.5511e+14     5.5511e+15             0.0000e+00       -22.669969916348
     2.2204e+15     2.2204e+16             0.0000e+00       -22.669969916348

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 178.1217
  </log>
  <optVariables href="FORM.s072.opt.xml">
ci_001                -7.050617e-01 3 1  ON 0
ci_002                -7.059926e-01 3 1  ON 1
ci_003                -3.765135e-02 3 1  ON 2
ci_004                -3.890325e-02 3 1  ON 3
ci_005                 1.612441e-02 3 1  ON 4
ci_006                 1.600090e-02 3 1  ON 5
ci_007                 1.228713e-02 3 1  ON 6
ci_008                 1.246533e-02 3 1  ON 7
ci_009                -1.173869e-02 3 1  ON 8
ci_010                -1.182876e-02 3 1  ON 9
ci_011                -8.176403e-03 3 1  ON 10
ci_012                -8.138278e-03 3 1  ON 11
ci_013                 9.647137e-03 3 1  ON 12
ci_014                 9.360580e-03 3 1  ON 13
ci_015                 1.228715e-02 3 1  ON 14
ci_016                 1.255400e-02 3 1  ON 15
ci_017                 1.088300e-02 3 1  ON 16
ci_018                 1.078149e-02 3 1  ON 17
ci_019                -2.514322e-03 3 1  ON 18
ci_020                -2.423765e-03 3 1  ON 19
ci_021                -8.459776e-03 3 1  ON 20
ci_022                -8.657034e-03 3 1  ON 21
ci_023                 7.805043e-03 3 1  ON 22
ci_024                 8.041852e-03 3 1  ON 23
ci_025                 4.702642e-03 3 1  ON 24
ci_026                 4.273172e-03 3 1  ON 25
ci_027                 6.454089e-03 3 1  ON 26
ci_028                 6.476482e-03 3 1  ON 27
ci_029                -4.877820e-03 3 1  ON 28
ci_030                -4.785596e-03 3 1  ON 29
ci_031                -7.388694e-03 3 1  ON 30
ci_032                -8.123179e-03 3 1  ON 31
ci_033                 4.600637e-03 3 1  ON 32
ci_034                 4.413553e-03 3 1  ON 33
ci_035                 1.126907e-03 3 1  ON 34
ci_036                 1.043146e-03 3 1  ON 35
ci_037                 4.953347e-03 3 1  ON 36
ci_038                 5.099310e-03 3 1  ON 37
ci_039                 5.306386e-03 3 1  ON 38
ci_040                 5.323086e-03 3 1  ON 39
ci_041                 4.970499e-03 3 1  ON 40
ci_042                 5.231233e-03 3 1  ON 41
ci_043                 4.943052e-03 3 1  ON 42
ci_044                 4.944182e-03 3 1  ON 43
ci_045                 3.123967e-03 3 1  ON 44
ci_046                 3.174246e-03 3 1  ON 45
ci_047                -7.790222e-04 3 1  ON 46
ci_048                -5.616836e-04 3 1  ON 47
ci_049                 1.580289e-03 3 1  ON 48
ci_050                 1.792516e-03 3 1  ON 49
ci_051                -1.106651e-03 3 1  ON 50
ci_052                -1.243279e-03 3 1  ON 51
ci_053                -2.610471e-03 3 1  ON 52
ci_054                -2.301978e-03 3 1  ON 53
ci_055                -1.483475e-03 3 1  ON 54
ci_056                -1.376714e-03 3 1  ON 55
ci_057                -1.240708e-03 3 1  ON 56
ci_058                -1.731077e-03 3 1  ON 57
ci_059                 3.171692e-04 3 1  ON 58
ci_060                 1.414703e-04 3 1  ON 59
ci_061                -3.305088e-04 3 1  ON 60
ci_062                -9.499769e-06 3 1  ON 61
ci_063                -5.232922e-04 3 1  ON 62
ci_064                -8.918525e-04 3 1  ON 63
ci_065                -2.408143e-03 3 1  ON 64
ci_066                -2.435285e-03 3 1  ON 65
ci_067                -2.101084e-03 3 1  ON 66
ci_068                -2.473560e-03 3 1  ON 67
ci_069                -2.085964e-04 3 1  ON 68
ci_070                 1.328450e-04 3 1  ON 69
ci_071                -1.874230e-03 3 1  ON 70
ci_072                -1.959430e-03 3 1  ON 71
ci_073                 5.749021e-04 3 1  ON 72
ci_074                 2.857507e-04 3 1  ON 73
ci_075                -2.910323e-04 3 1  ON 74
ci_076                -2.990999e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 3.0013e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s073 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s073 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=73  my_counter=0
  time step      = 5.0000e-02
  blocks         = 250
  steps          = 250
  substeps       = 10
  current        = 0
  target samples = 8.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">250</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">6.2500e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">8.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">6.2500e+04</parameter>
<parameter name="steps" condition="int">250</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2664e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="250">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =8000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 73
    time step          = 0.05
    reference energy   = -22.6857
    reference variance = 0.508392
====================================================
  Execution time = 1.0235e+02
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s073
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 62500 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 6.1071e+04
  VMC Eavg = -2.2670e+01
  VMC Evar = 5.0993e-01
  Total weights = 7.820568870e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.9526e+01
  </log>
</opt>
<opt stage="main" walkers="62500">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.495455475513
                                         uncertainty =       0.001220516081

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.495455475513
                                         uncertainty =       0.001220516081

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000248861643
  error estimate for blocks of size 2^( 2) =       0.000257871036
  error estimate for blocks of size 2^( 3) =       0.000265968335
  error estimate for blocks of size 2^( 4) =       0.000271635727
  error estimate for blocks of size 2^( 5) =       0.000275037291
  error estimate for blocks of size 2^( 6) =       0.000276687408
  error estimate for blocks of size 2^( 7) =       0.000277765042
  error estimate for blocks of size 2^( 8) =       0.000277441005
  error estimate for blocks of size 2^( 9) =       0.000276348400

      target function =                  N/A
              le_mean =     -22.669796520350
             les_mean =     514.429601666944
             stat err =       0.000277060464
             autocorr =       1.239461915956
              std dev =       0.703887020123
             le_variance =       0.495456937098


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266979652035e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.3878e+15, overlap shift 1.3878e+16 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.669796520372       residual = 3.92e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.669796520372       residual = 3.92e-05           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to small subspace S singular value of 7.58e-01
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 1.3878e+15 is 0.000000e+00

solving harmonic davidson linear method for identity shift 5.5511e+15, overlap shift 5.5511e+16 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.669796520372       residual = 3.92e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.669796520372       residual = 3.92e-05           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to small subspace S singular value of 7.58e-01
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 5.5511e+15 is 0.000000e+00

solving harmonic davidson linear method for identity shift 2.2204e+16, overlap shift 2.2204e+17 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.669796520372       residual = 3.92e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.669796520372       residual = 3.92e-05           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to small subspace S singular value of 6.64e-01
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 2.2204e+16 is 0.000000e+00

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.165797 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.2189e+02
  </log>
  <optVariables href="FORM.s073.opt.xml">
ci_001                -7.050617e-01 3 1  ON 0
ci_002                -7.059926e-01 3 1  ON 1
ci_003                -3.765135e-02 3 1  ON 2
ci_004                -3.890325e-02 3 1  ON 3
ci_005                 1.612441e-02 3 1  ON 4
ci_006                 1.600090e-02 3 1  ON 5
ci_007                 1.228713e-02 3 1  ON 6
ci_008                 1.246533e-02 3 1  ON 7
ci_009                -1.173869e-02 3 1  ON 8
ci_010                -1.182876e-02 3 1  ON 9
ci_011                -8.176403e-03 3 1  ON 10
ci_012                -8.138278e-03 3 1  ON 11
ci_013                 9.647137e-03 3 1  ON 12
ci_014                 9.360580e-03 3 1  ON 13
ci_015                 1.228715e-02 3 1  ON 14
ci_016                 1.255400e-02 3 1  ON 15
ci_017                 1.088300e-02 3 1  ON 16
ci_018                 1.078149e-02 3 1  ON 17
ci_019                -2.514322e-03 3 1  ON 18
ci_020                -2.423765e-03 3 1  ON 19
ci_021                -8.459776e-03 3 1  ON 20
ci_022                -8.657034e-03 3 1  ON 21
ci_023                 7.805043e-03 3 1  ON 22
ci_024                 8.041852e-03 3 1  ON 23
ci_025                 4.702642e-03 3 1  ON 24
ci_026                 4.273172e-03 3 1  ON 25
ci_027                 6.454089e-03 3 1  ON 26
ci_028                 6.476482e-03 3 1  ON 27
ci_029                -4.877820e-03 3 1  ON 28
ci_030                -4.785596e-03 3 1  ON 29
ci_031                -7.388694e-03 3 1  ON 30
ci_032                -8.123179e-03 3 1  ON 31
ci_033                 4.600637e-03 3 1  ON 32
ci_034                 4.413553e-03 3 1  ON 33
ci_035                 1.126907e-03 3 1  ON 34
ci_036                 1.043146e-03 3 1  ON 35
ci_037                 4.953347e-03 3 1  ON 36
ci_038                 5.099310e-03 3 1  ON 37
ci_039                 5.306386e-03 3 1  ON 38
ci_040                 5.323086e-03 3 1  ON 39
ci_041                 4.970499e-03 3 1  ON 40
ci_042                 5.231233e-03 3 1  ON 41
ci_043                 4.943052e-03 3 1  ON 42
ci_044                 4.944182e-03 3 1  ON 43
ci_045                 3.123967e-03 3 1  ON 44
ci_046                 3.174246e-03 3 1  ON 45
ci_047                -7.790222e-04 3 1  ON 46
ci_048                -5.616836e-04 3 1  ON 47
ci_049                 1.580289e-03 3 1  ON 48
ci_050                 1.792516e-03 3 1  ON 49
ci_051                -1.106651e-03 3 1  ON 50
ci_052                -1.243279e-03 3 1  ON 51
ci_053                -2.610471e-03 3 1  ON 52
ci_054                -2.301978e-03 3 1  ON 53
ci_055                -1.483475e-03 3 1  ON 54
ci_056                -1.376714e-03 3 1  ON 55
ci_057                -1.240708e-03 3 1  ON 56
ci_058                -1.731077e-03 3 1  ON 57
ci_059                 3.171692e-04 3 1  ON 58
ci_060                 1.414703e-04 3 1  ON 59
ci_061                -3.305088e-04 3 1  ON 60
ci_062                -9.499769e-06 3 1  ON 61
ci_063                -5.232922e-04 3 1  ON 62
ci_064                -8.918525e-04 3 1  ON 63
ci_065                -2.408143e-03 3 1  ON 64
ci_066                -2.435285e-03 3 1  ON 65
ci_067                -2.101084e-03 3 1  ON 66
ci_068                -2.473560e-03 3 1  ON 67
ci_069                -2.085964e-04 3 1  ON 68
ci_070                 1.328450e-04 3 1  ON 69
ci_071                -1.874230e-03 3 1  ON 70
ci_072                -1.959430e-03 3 1  ON 71
ci_073                 5.749021e-04 3 1  ON 72
ci_074                 2.857507e-04 3 1  ON 73
ci_075                -2.910323e-04 3 1  ON 74
ci_076                -2.990999e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="250">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =8000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 73
    time step          = 0.05
    reference energy   = -22.5849
    reference variance = 0.432613
====================================================
  Execution time = 1.0239e+02
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s073
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 62500 
  VMC Eavg = -2.2670e+01
  VMC Evar = 5.1275e-01
  Total weights = 7.8217e+06
  Execution time = 1.4663e+01
  </log>
</opt>
<opt stage="main" walkers="62500">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.498550138105
                                         uncertainty =       0.001986746993

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.498550138105
                                         uncertainty =       0.001986746993

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000249637616
  error estimate for blocks of size 2^( 2) =       0.000258553699
  error estimate for blocks of size 2^( 3) =       0.000266503948
  error estimate for blocks of size 2^( 4) =       0.000272239084
  error estimate for blocks of size 2^( 5) =       0.000275918429
  error estimate for blocks of size 2^( 6) =       0.000277499277
  error estimate for blocks of size 2^( 7) =       0.000277678476
  error estimate for blocks of size 2^( 8) =       0.000276945535
  error estimate for blocks of size 2^( 9) =       0.000276327759

      target function =                  N/A
              le_mean =     -22.670158706052
             les_mean =     514.448849851792
             stat err =       0.000277112762
             autocorr =       1.232233463243
              std dev =       0.706081805713
             le_variance =       0.498551516359

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.498550138105
                                         uncertainty =       0.001986746993

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.498550138105
                                         uncertainty =       0.001986746993

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000249637616
  error estimate for blocks of size 2^( 2) =       0.000258553699
  error estimate for blocks of size 2^( 3) =       0.000266503948
  error estimate for blocks of size 2^( 4) =       0.000272239084
  error estimate for blocks of size 2^( 5) =       0.000275918429
  error estimate for blocks of size 2^( 6) =       0.000277499277
  error estimate for blocks of size 2^( 7) =       0.000277678476
  error estimate for blocks of size 2^( 8) =       0.000276945535
  error estimate for blocks of size 2^( 9) =       0.000276327759

      target function =                  N/A
              le_mean =     -22.670158706052
             les_mean =     514.448849851792
             stat err =       0.000277112762
             autocorr =       1.232233463243
              std dev =       0.706081805713
             le_variance =       0.498551516359

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.498550138105
                                         uncertainty =       0.001986746993

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.498550138105
                                         uncertainty =       0.001986746993

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000249637616
  error estimate for blocks of size 2^( 2) =       0.000258553699
  error estimate for blocks of size 2^( 3) =       0.000266503948
  error estimate for blocks of size 2^( 4) =       0.000272239084
  error estimate for blocks of size 2^( 5) =       0.000275918429
  error estimate for blocks of size 2^( 6) =       0.000277499277
  error estimate for blocks of size 2^( 7) =       0.000277678476
  error estimate for blocks of size 2^( 8) =       0.000276945535
  error estimate for blocks of size 2^( 9) =       0.000276327759

      target function =                  N/A
              le_mean =     -22.670158706052
             les_mean =     514.448849851792
             stat err =       0.000277112762
             autocorr =       1.232233463243
              std dev =       0.706081805713
             le_variance =       0.498551516359

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.498550138105
                                         uncertainty =       0.001986746993

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.498550138105
                                         uncertainty =       0.001986746993

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000249637616
  error estimate for blocks of size 2^( 2) =       0.000258553699
  error estimate for blocks of size 2^( 3) =       0.000266503948
  error estimate for blocks of size 2^( 4) =       0.000272239084
  error estimate for blocks of size 2^( 5) =       0.000275918429
  error estimate for blocks of size 2^( 6) =       0.000277499277
  error estimate for blocks of size 2^( 7) =       0.000277678476
  error estimate for blocks of size 2^( 8) =       0.000276945535
  error estimate for blocks of size 2^( 9) =       0.000276327759

      target function =                  N/A
              le_mean =     -22.670158706052
             les_mean =     514.448849851792
             stat err =       0.000277112762
             autocorr =       1.232233463243
              std dev =       0.706081805713
             le_variance =       0.498551516359


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.670158706052        initial  <--
     1.3878e+15     1.3878e+16             0.0000e+00       -22.670158706052
     5.5511e+15     5.5511e+16             0.0000e+00       -22.670158706052
     2.2204e+16     2.2204e+17             0.0000e+00       -22.670158706052

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 177.2305
  </log>
  <optVariables href="FORM.s073.opt.xml">
ci_001                -7.050617e-01 3 1  ON 0
ci_002                -7.059926e-01 3 1  ON 1
ci_003                -3.765135e-02 3 1  ON 2
ci_004                -3.890325e-02 3 1  ON 3
ci_005                 1.612441e-02 3 1  ON 4
ci_006                 1.600090e-02 3 1  ON 5
ci_007                 1.228713e-02 3 1  ON 6
ci_008                 1.246533e-02 3 1  ON 7
ci_009                -1.173869e-02 3 1  ON 8
ci_010                -1.182876e-02 3 1  ON 9
ci_011                -8.176403e-03 3 1  ON 10
ci_012                -8.138278e-03 3 1  ON 11
ci_013                 9.647137e-03 3 1  ON 12
ci_014                 9.360580e-03 3 1  ON 13
ci_015                 1.228715e-02 3 1  ON 14
ci_016                 1.255400e-02 3 1  ON 15
ci_017                 1.088300e-02 3 1  ON 16
ci_018                 1.078149e-02 3 1  ON 17
ci_019                -2.514322e-03 3 1  ON 18
ci_020                -2.423765e-03 3 1  ON 19
ci_021                -8.459776e-03 3 1  ON 20
ci_022                -8.657034e-03 3 1  ON 21
ci_023                 7.805043e-03 3 1  ON 22
ci_024                 8.041852e-03 3 1  ON 23
ci_025                 4.702642e-03 3 1  ON 24
ci_026                 4.273172e-03 3 1  ON 25
ci_027                 6.454089e-03 3 1  ON 26
ci_028                 6.476482e-03 3 1  ON 27
ci_029                -4.877820e-03 3 1  ON 28
ci_030                -4.785596e-03 3 1  ON 29
ci_031                -7.388694e-03 3 1  ON 30
ci_032                -8.123179e-03 3 1  ON 31
ci_033                 4.600637e-03 3 1  ON 32
ci_034                 4.413553e-03 3 1  ON 33
ci_035                 1.126907e-03 3 1  ON 34
ci_036                 1.043146e-03 3 1  ON 35
ci_037                 4.953347e-03 3 1  ON 36
ci_038                 5.099310e-03 3 1  ON 37
ci_039                 5.306386e-03 3 1  ON 38
ci_040                 5.323086e-03 3 1  ON 39
ci_041                 4.970499e-03 3 1  ON 40
ci_042                 5.231233e-03 3 1  ON 41
ci_043                 4.943052e-03 3 1  ON 42
ci_044                 4.944182e-03 3 1  ON 43
ci_045                 3.123967e-03 3 1  ON 44
ci_046                 3.174246e-03 3 1  ON 45
ci_047                -7.790222e-04 3 1  ON 46
ci_048                -5.616836e-04 3 1  ON 47
ci_049                 1.580289e-03 3 1  ON 48
ci_050                 1.792516e-03 3 1  ON 49
ci_051                -1.106651e-03 3 1  ON 50
ci_052                -1.243279e-03 3 1  ON 51
ci_053                -2.610471e-03 3 1  ON 52
ci_054                -2.301978e-03 3 1  ON 53
ci_055                -1.483475e-03 3 1  ON 54
ci_056                -1.376714e-03 3 1  ON 55
ci_057                -1.240708e-03 3 1  ON 56
ci_058                -1.731077e-03 3 1  ON 57
ci_059                 3.171692e-04 3 1  ON 58
ci_060                 1.414703e-04 3 1  ON 59
ci_061                -3.305088e-04 3 1  ON 60
ci_062                -9.499769e-06 3 1  ON 61
ci_063                -5.232922e-04 3 1  ON 62
ci_064                -8.918525e-04 3 1  ON 63
ci_065                -2.408143e-03 3 1  ON 64
ci_066                -2.435285e-03 3 1  ON 65
ci_067                -2.101084e-03 3 1  ON 66
ci_068                -2.473560e-03 3 1  ON 67
ci_069                -2.085964e-04 3 1  ON 68
ci_070                 1.328450e-04 3 1  ON 69
ci_071                -1.874230e-03 3 1  ON 70
ci_072                -1.959430e-03 3 1  ON 71
ci_073                 5.749021e-04 3 1  ON 72
ci_074                 2.857507e-04 3 1  ON 73
ci_075                -2.910323e-04 3 1  ON 74
ci_076                -2.990999e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 2.9913e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s074 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s074 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=74  my_counter=0
  time step      = 5.0000e-02
  blocks         = 250
  steps          = 250
  substeps       = 10
  current        = 0
  target samples = 8.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">250</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">6.2500e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">8.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">6.2500e+04</parameter>
<parameter name="steps" condition="int">250</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2663e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="250">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =8000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 74
    time step          = 0.05
    reference energy   = -22.6631
    reference variance = 0.288567
====================================================
  Execution time = 1.0264e+02
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s074
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 62500 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 6.1124e+04
  VMC Eavg = -2.2669e+01
  VMC Evar = 5.1287e-01
  Total weights = 7.820887200e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.9333e+01
  </log>
</opt>
<opt stage="main" walkers="62500">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.497770047585
                                         uncertainty =       0.001979844464

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.497770047585
                                         uncertainty =       0.001979844464

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000249441995
  error estimate for blocks of size 2^( 2) =       0.000258339168
  error estimate for blocks of size 2^( 3) =       0.000266315692
  error estimate for blocks of size 2^( 4) =       0.000271958767
  error estimate for blocks of size 2^( 5) =       0.000275046195
  error estimate for blocks of size 2^( 6) =       0.000276600363
  error estimate for blocks of size 2^( 7) =       0.000277096984
  error estimate for blocks of size 2^( 8) =       0.000278439058
  error estimate for blocks of size 2^( 9) =       0.000278871432

      target function =                  N/A
              le_mean =     -22.669243795239
             les_mean =     514.407480859627
             stat err =       0.000277751959
             autocorr =       1.239867049859
              std dev =       0.705528505438
             le_variance =       0.497770471986


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266924379524e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.3878e+16, overlap shift 1.3878e+17 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.669243795260       residual = 3.85e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.669243795260       residual = 8.53e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.669243795260       residual = 3.62e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.669243795260       residual = 1.19e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 1.3878e+16 is 1.824347e-20

solving harmonic davidson linear method for identity shift 5.5511e+16, overlap shift 5.5511e+17 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.669243795260       residual = 3.85e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.669243795260       residual = 8.53e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.669243795260       residual = 3.62e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.669243795260       residual = 5.48e+02           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.669243795319       residual = 7.99e-01           smallest_sin_value = 1.00e+00
davidson iteration    5 stopping due to too large eigenvalue change
davidson solver did not converge after          5 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 5.5511e+16 is 4.601961e-21

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 2.2204e+17, overlap shift 2.2204e+18 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.669243795260       residual = 3.85e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.669243795260       residual = 8.53e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.669243795260       residual = 3.62e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.669243795260       residual = 1.19e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 2.2204e+17 is 1.140217e-21

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.167387 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.2199e+02
  </log>
  <optVariables href="FORM.s074.opt.xml">
ci_001                -7.050617e-01 3 1  ON 0
ci_002                -7.059926e-01 3 1  ON 1
ci_003                -3.765135e-02 3 1  ON 2
ci_004                -3.890325e-02 3 1  ON 3
ci_005                 1.612441e-02 3 1  ON 4
ci_006                 1.600090e-02 3 1  ON 5
ci_007                 1.228713e-02 3 1  ON 6
ci_008                 1.246533e-02 3 1  ON 7
ci_009                -1.173869e-02 3 1  ON 8
ci_010                -1.182876e-02 3 1  ON 9
ci_011                -8.176403e-03 3 1  ON 10
ci_012                -8.138278e-03 3 1  ON 11
ci_013                 9.647137e-03 3 1  ON 12
ci_014                 9.360580e-03 3 1  ON 13
ci_015                 1.228715e-02 3 1  ON 14
ci_016                 1.255400e-02 3 1  ON 15
ci_017                 1.088300e-02 3 1  ON 16
ci_018                 1.078149e-02 3 1  ON 17
ci_019                -2.514322e-03 3 1  ON 18
ci_020                -2.423765e-03 3 1  ON 19
ci_021                -8.459776e-03 3 1  ON 20
ci_022                -8.657034e-03 3 1  ON 21
ci_023                 7.805043e-03 3 1  ON 22
ci_024                 8.041852e-03 3 1  ON 23
ci_025                 4.702642e-03 3 1  ON 24
ci_026                 4.273172e-03 3 1  ON 25
ci_027                 6.454089e-03 3 1  ON 26
ci_028                 6.476482e-03 3 1  ON 27
ci_029                -4.877820e-03 3 1  ON 28
ci_030                -4.785596e-03 3 1  ON 29
ci_031                -7.388694e-03 3 1  ON 30
ci_032                -8.123179e-03 3 1  ON 31
ci_033                 4.600637e-03 3 1  ON 32
ci_034                 4.413553e-03 3 1  ON 33
ci_035                 1.126907e-03 3 1  ON 34
ci_036                 1.043146e-03 3 1  ON 35
ci_037                 4.953347e-03 3 1  ON 36
ci_038                 5.099310e-03 3 1  ON 37
ci_039                 5.306386e-03 3 1  ON 38
ci_040                 5.323086e-03 3 1  ON 39
ci_041                 4.970499e-03 3 1  ON 40
ci_042                 5.231233e-03 3 1  ON 41
ci_043                 4.943052e-03 3 1  ON 42
ci_044                 4.944182e-03 3 1  ON 43
ci_045                 3.123967e-03 3 1  ON 44
ci_046                 3.174246e-03 3 1  ON 45
ci_047                -7.790222e-04 3 1  ON 46
ci_048                -5.616836e-04 3 1  ON 47
ci_049                 1.580289e-03 3 1  ON 48
ci_050                 1.792516e-03 3 1  ON 49
ci_051                -1.106651e-03 3 1  ON 50
ci_052                -1.243279e-03 3 1  ON 51
ci_053                -2.610471e-03 3 1  ON 52
ci_054                -2.301978e-03 3 1  ON 53
ci_055                -1.483475e-03 3 1  ON 54
ci_056                -1.376714e-03 3 1  ON 55
ci_057                -1.240708e-03 3 1  ON 56
ci_058                -1.731077e-03 3 1  ON 57
ci_059                 3.171692e-04 3 1  ON 58
ci_060                 1.414703e-04 3 1  ON 59
ci_061                -3.305088e-04 3 1  ON 60
ci_062                -9.499769e-06 3 1  ON 61
ci_063                -5.232922e-04 3 1  ON 62
ci_064                -8.918525e-04 3 1  ON 63
ci_065                -2.408143e-03 3 1  ON 64
ci_066                -2.435285e-03 3 1  ON 65
ci_067                -2.101084e-03 3 1  ON 66
ci_068                -2.473560e-03 3 1  ON 67
ci_069                -2.085964e-04 3 1  ON 68
ci_070                 1.328450e-04 3 1  ON 69
ci_071                -1.874230e-03 3 1  ON 70
ci_072                -1.959430e-03 3 1  ON 71
ci_073                 5.749021e-04 3 1  ON 72
ci_074                 2.857507e-04 3 1  ON 73
ci_075                -2.910323e-04 3 1  ON 74
ci_076                -2.990999e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="250">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =8000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 74
    time step          = 0.05
    reference energy   = -22.6246
    reference variance = 1.07986
====================================================
  Execution time = 1.0236e+02
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s074
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 62500 
  VMC Eavg = -2.2669e+01
  VMC Evar = 5.1531e-01
  Total weights = 7.8206e+06
  Execution time = 1.4660e+01
  </log>
</opt>
<opt stage="main" walkers="62500">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.497989962864
                                         uncertainty =       0.002838602161

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.497989962864
                                         uncertainty =       0.002838602161

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000249497302
  error estimate for blocks of size 2^( 2) =       0.000258337721
  error estimate for blocks of size 2^( 3) =       0.000266232948
  error estimate for blocks of size 2^( 4) =       0.000271958083
  error estimate for blocks of size 2^( 5) =       0.000275145419
  error estimate for blocks of size 2^( 6) =       0.000276898503
  error estimate for blocks of size 2^( 7) =       0.000278224181
  error estimate for blocks of size 2^( 8) =       0.000279354934
  error estimate for blocks of size 2^( 9) =       0.000279768460

      target function =                  N/A
              le_mean =     -22.669455372970
             les_mean =     514.419518972614
             stat err =       0.000278561520
             autocorr =       1.246552396411
              std dev =       0.705684937319
             le_variance =       0.497991230759

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.497989962864
                                         uncertainty =       0.002838602161

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.497989962864
                                         uncertainty =       0.002838602161

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000249497302
  error estimate for blocks of size 2^( 2) =       0.000258337721
  error estimate for blocks of size 2^( 3) =       0.000266232948
  error estimate for blocks of size 2^( 4) =       0.000271958083
  error estimate for blocks of size 2^( 5) =       0.000275145419
  error estimate for blocks of size 2^( 6) =       0.000276898503
  error estimate for blocks of size 2^( 7) =       0.000278224181
  error estimate for blocks of size 2^( 8) =       0.000279354934
  error estimate for blocks of size 2^( 9) =       0.000279768460

      target function =                  N/A
              le_mean =     -22.669455372970
             les_mean =     514.419518972614
             stat err =       0.000278561520
             autocorr =       1.246552396411
              std dev =       0.705684937319
             le_variance =       0.497991230759

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.497989962864
                                         uncertainty =       0.002838602161

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.497989962864
                                         uncertainty =       0.002838602161

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000249497302
  error estimate for blocks of size 2^( 2) =       0.000258337721
  error estimate for blocks of size 2^( 3) =       0.000266232948
  error estimate for blocks of size 2^( 4) =       0.000271958083
  error estimate for blocks of size 2^( 5) =       0.000275145419
  error estimate for blocks of size 2^( 6) =       0.000276898503
  error estimate for blocks of size 2^( 7) =       0.000278224181
  error estimate for blocks of size 2^( 8) =       0.000279354934
  error estimate for blocks of size 2^( 9) =       0.000279768460

      target function =                  N/A
              le_mean =     -22.669455372970
             les_mean =     514.419518972614
             stat err =       0.000278561520
             autocorr =       1.246552396411
              std dev =       0.705684937319
             le_variance =       0.497991230759

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.497989962864
                                         uncertainty =       0.002838602161

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.497989962864
                                         uncertainty =       0.002838602161

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000249497302
  error estimate for blocks of size 2^( 2) =       0.000258337721
  error estimate for blocks of size 2^( 3) =       0.000266232948
  error estimate for blocks of size 2^( 4) =       0.000271958083
  error estimate for blocks of size 2^( 5) =       0.000275145419
  error estimate for blocks of size 2^( 6) =       0.000276898503
  error estimate for blocks of size 2^( 7) =       0.000278224181
  error estimate for blocks of size 2^( 8) =       0.000279354934
  error estimate for blocks of size 2^( 9) =       0.000279768460

      target function =                  N/A
              le_mean =     -22.669455372970
             les_mean =     514.419518972614
             stat err =       0.000278561520
             autocorr =       1.246552396411
              std dev =       0.705684937319
             le_variance =       0.497991230759


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.669455372970        initial  <--
     1.3878e+16     1.3878e+17             1.8243e-20       -22.669455372970
     5.5511e+16     5.5511e+17             4.6020e-21       -22.669455372970
     2.2204e+17     2.2204e+18             1.1402e-21       -22.669455372970

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 178.4006
  </log>
  <optVariables href="FORM.s074.opt.xml">
ci_001                -7.050617e-01 3 1  ON 0
ci_002                -7.059926e-01 3 1  ON 1
ci_003                -3.765135e-02 3 1  ON 2
ci_004                -3.890325e-02 3 1  ON 3
ci_005                 1.612441e-02 3 1  ON 4
ci_006                 1.600090e-02 3 1  ON 5
ci_007                 1.228713e-02 3 1  ON 6
ci_008                 1.246533e-02 3 1  ON 7
ci_009                -1.173869e-02 3 1  ON 8
ci_010                -1.182876e-02 3 1  ON 9
ci_011                -8.176403e-03 3 1  ON 10
ci_012                -8.138278e-03 3 1  ON 11
ci_013                 9.647137e-03 3 1  ON 12
ci_014                 9.360580e-03 3 1  ON 13
ci_015                 1.228715e-02 3 1  ON 14
ci_016                 1.255400e-02 3 1  ON 15
ci_017                 1.088300e-02 3 1  ON 16
ci_018                 1.078149e-02 3 1  ON 17
ci_019                -2.514322e-03 3 1  ON 18
ci_020                -2.423765e-03 3 1  ON 19
ci_021                -8.459776e-03 3 1  ON 20
ci_022                -8.657034e-03 3 1  ON 21
ci_023                 7.805043e-03 3 1  ON 22
ci_024                 8.041852e-03 3 1  ON 23
ci_025                 4.702642e-03 3 1  ON 24
ci_026                 4.273172e-03 3 1  ON 25
ci_027                 6.454089e-03 3 1  ON 26
ci_028                 6.476482e-03 3 1  ON 27
ci_029                -4.877820e-03 3 1  ON 28
ci_030                -4.785596e-03 3 1  ON 29
ci_031                -7.388694e-03 3 1  ON 30
ci_032                -8.123179e-03 3 1  ON 31
ci_033                 4.600637e-03 3 1  ON 32
ci_034                 4.413553e-03 3 1  ON 33
ci_035                 1.126907e-03 3 1  ON 34
ci_036                 1.043146e-03 3 1  ON 35
ci_037                 4.953347e-03 3 1  ON 36
ci_038                 5.099310e-03 3 1  ON 37
ci_039                 5.306386e-03 3 1  ON 38
ci_040                 5.323086e-03 3 1  ON 39
ci_041                 4.970499e-03 3 1  ON 40
ci_042                 5.231233e-03 3 1  ON 41
ci_043                 4.943052e-03 3 1  ON 42
ci_044                 4.944182e-03 3 1  ON 43
ci_045                 3.123967e-03 3 1  ON 44
ci_046                 3.174246e-03 3 1  ON 45
ci_047                -7.790222e-04 3 1  ON 46
ci_048                -5.616836e-04 3 1  ON 47
ci_049                 1.580289e-03 3 1  ON 48
ci_050                 1.792516e-03 3 1  ON 49
ci_051                -1.106651e-03 3 1  ON 50
ci_052                -1.243279e-03 3 1  ON 51
ci_053                -2.610471e-03 3 1  ON 52
ci_054                -2.301978e-03 3 1  ON 53
ci_055                -1.483475e-03 3 1  ON 54
ci_056                -1.376714e-03 3 1  ON 55
ci_057                -1.240708e-03 3 1  ON 56
ci_058                -1.731077e-03 3 1  ON 57
ci_059                 3.171692e-04 3 1  ON 58
ci_060                 1.414703e-04 3 1  ON 59
ci_061                -3.305088e-04 3 1  ON 60
ci_062                -9.499769e-06 3 1  ON 61
ci_063                -5.232922e-04 3 1  ON 62
ci_064                -8.918525e-04 3 1  ON 63
ci_065                -2.408143e-03 3 1  ON 64
ci_066                -2.435285e-03 3 1  ON 65
ci_067                -2.101084e-03 3 1  ON 66
ci_068                -2.473560e-03 3 1  ON 67
ci_069                -2.085964e-04 3 1  ON 68
ci_070                 1.328450e-04 3 1  ON 69
ci_071                -1.874230e-03 3 1  ON 70
ci_072                -1.959430e-03 3 1  ON 71
ci_073                 5.749021e-04 3 1  ON 72
ci_074                 2.857507e-04 3 1  ON 73
ci_075                -2.910323e-04 3 1  ON 74
ci_076                -2.990999e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 3.0040e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s075 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s075 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=75  my_counter=0
  time step      = 5.0000e-02
  blocks         = 250
  steps          = 250
  substeps       = 10
  current        = 0
  target samples = 8.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">250</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">6.2500e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">8.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">6.2500e+04</parameter>
<parameter name="steps" condition="int">250</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2663e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="250">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =8000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 75
    time step          = 0.05
    reference energy   = -22.582
    reference variance = 0.310683
====================================================
  Execution time = 1.0241e+02
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s075
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 62500 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 6.1134e+04
  VMC Eavg = -2.2670e+01
  VMC Evar = 5.1008e-01
  Total weights = 7.820595239e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.9061e+01
  </log>
</opt>
<opt stage="main" walkers="62500">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.496941890952
                                         uncertainty =       0.001599111613

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.496941890952
                                         uncertainty =       0.001599111613

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000249235498
  error estimate for blocks of size 2^( 2) =       0.000258208559
  error estimate for blocks of size 2^( 3) =       0.000266211718
  error estimate for blocks of size 2^( 4) =       0.000271912593
  error estimate for blocks of size 2^( 5) =       0.000275482156
  error estimate for blocks of size 2^( 6) =       0.000277344388
  error estimate for blocks of size 2^( 7) =       0.000278431070
  error estimate for blocks of size 2^( 8) =       0.000278385758
  error estimate for blocks of size 2^( 9) =       0.000277355005

      target function =                  N/A
              le_mean =     -22.669739149664
             les_mean =     514.427156722239
             stat err =       0.000277879055
             autocorr =       1.243059251057
              std dev =       0.704944444245
             le_variance =       0.496946669472


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266973914966e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.3878e+17, overlap shift 1.3878e+18 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.669739149687       residual = 3.86e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.669739149687       residual = 3.86e-05           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to small subspace S singular value of 6.84e-01
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 1.3878e+17 is 0.000000e+00

solving harmonic davidson linear method for identity shift 5.5511e+17, overlap shift 5.5511e+18 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.669739149687       residual = 3.86e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.669739149687       residual = 3.86e-05           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 5.5511e+17 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 2.2204e+18, overlap shift 2.2204e+19 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.669739149687       residual = 3.86e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.669739149687       residual = 3.86e-05           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 2.2204e+18 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.168593 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.2149e+02
  </log>
  <optVariables href="FORM.s075.opt.xml">
ci_001                -7.050617e-01 3 1  ON 0
ci_002                -7.059926e-01 3 1  ON 1
ci_003                -3.765135e-02 3 1  ON 2
ci_004                -3.890325e-02 3 1  ON 3
ci_005                 1.612441e-02 3 1  ON 4
ci_006                 1.600090e-02 3 1  ON 5
ci_007                 1.228713e-02 3 1  ON 6
ci_008                 1.246533e-02 3 1  ON 7
ci_009                -1.173869e-02 3 1  ON 8
ci_010                -1.182876e-02 3 1  ON 9
ci_011                -8.176403e-03 3 1  ON 10
ci_012                -8.138278e-03 3 1  ON 11
ci_013                 9.647137e-03 3 1  ON 12
ci_014                 9.360580e-03 3 1  ON 13
ci_015                 1.228715e-02 3 1  ON 14
ci_016                 1.255400e-02 3 1  ON 15
ci_017                 1.088300e-02 3 1  ON 16
ci_018                 1.078149e-02 3 1  ON 17
ci_019                -2.514322e-03 3 1  ON 18
ci_020                -2.423765e-03 3 1  ON 19
ci_021                -8.459776e-03 3 1  ON 20
ci_022                -8.657034e-03 3 1  ON 21
ci_023                 7.805043e-03 3 1  ON 22
ci_024                 8.041852e-03 3 1  ON 23
ci_025                 4.702642e-03 3 1  ON 24
ci_026                 4.273172e-03 3 1  ON 25
ci_027                 6.454089e-03 3 1  ON 26
ci_028                 6.476482e-03 3 1  ON 27
ci_029                -4.877820e-03 3 1  ON 28
ci_030                -4.785596e-03 3 1  ON 29
ci_031                -7.388694e-03 3 1  ON 30
ci_032                -8.123179e-03 3 1  ON 31
ci_033                 4.600637e-03 3 1  ON 32
ci_034                 4.413553e-03 3 1  ON 33
ci_035                 1.126907e-03 3 1  ON 34
ci_036                 1.043146e-03 3 1  ON 35
ci_037                 4.953347e-03 3 1  ON 36
ci_038                 5.099310e-03 3 1  ON 37
ci_039                 5.306386e-03 3 1  ON 38
ci_040                 5.323086e-03 3 1  ON 39
ci_041                 4.970499e-03 3 1  ON 40
ci_042                 5.231233e-03 3 1  ON 41
ci_043                 4.943052e-03 3 1  ON 42
ci_044                 4.944182e-03 3 1  ON 43
ci_045                 3.123967e-03 3 1  ON 44
ci_046                 3.174246e-03 3 1  ON 45
ci_047                -7.790222e-04 3 1  ON 46
ci_048                -5.616836e-04 3 1  ON 47
ci_049                 1.580289e-03 3 1  ON 48
ci_050                 1.792516e-03 3 1  ON 49
ci_051                -1.106651e-03 3 1  ON 50
ci_052                -1.243279e-03 3 1  ON 51
ci_053                -2.610471e-03 3 1  ON 52
ci_054                -2.301978e-03 3 1  ON 53
ci_055                -1.483475e-03 3 1  ON 54
ci_056                -1.376714e-03 3 1  ON 55
ci_057                -1.240708e-03 3 1  ON 56
ci_058                -1.731077e-03 3 1  ON 57
ci_059                 3.171692e-04 3 1  ON 58
ci_060                 1.414703e-04 3 1  ON 59
ci_061                -3.305088e-04 3 1  ON 60
ci_062                -9.499769e-06 3 1  ON 61
ci_063                -5.232922e-04 3 1  ON 62
ci_064                -8.918525e-04 3 1  ON 63
ci_065                -2.408143e-03 3 1  ON 64
ci_066                -2.435285e-03 3 1  ON 65
ci_067                -2.101084e-03 3 1  ON 66
ci_068                -2.473560e-03 3 1  ON 67
ci_069                -2.085964e-04 3 1  ON 68
ci_070                 1.328450e-04 3 1  ON 69
ci_071                -1.874230e-03 3 1  ON 70
ci_072                -1.959430e-03 3 1  ON 71
ci_073                 5.749021e-04 3 1  ON 72
ci_074                 2.857507e-04 3 1  ON 73
ci_075                -2.910323e-04 3 1  ON 74
ci_076                -2.990999e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="250">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =8000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 75
    time step          = 0.05
    reference energy   = -22.7334
    reference variance = 0.390345
====================================================
  Execution time = 1.0208e+02
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s075
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 62500 
  VMC Eavg = -2.2670e+01
  VMC Evar = 5.1180e-01
  Total weights = 7.8203e+06
  Execution time = 1.4671e+01
  </log>
</opt>
<opt stage="main" walkers="62500">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.498138685295
                                         uncertainty =       0.002085802585

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.498138685295
                                         uncertainty =       0.002085802585

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000249534837
  error estimate for blocks of size 2^( 2) =       0.000258555763
  error estimate for blocks of size 2^( 3) =       0.000266498456
  error estimate for blocks of size 2^( 4) =       0.000272236359
  error estimate for blocks of size 2^( 5) =       0.000275449238
  error estimate for blocks of size 2^( 6) =       0.000277473401
  error estimate for blocks of size 2^( 7) =       0.000278223201
  error estimate for blocks of size 2^( 8) =       0.000278653772
  error estimate for blocks of size 2^( 9) =       0.000279513933

      target function =                  N/A
              le_mean =     -22.669701254621
             les_mean =     514.427155870357
             stat err =       0.000278466077
             autocorr =       1.245323613568
              std dev =       0.705791100135
             le_variance =       0.498141077030

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.498138685295
                                         uncertainty =       0.002085802585

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.498138685295
                                         uncertainty =       0.002085802585

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000249534837
  error estimate for blocks of size 2^( 2) =       0.000258555763
  error estimate for blocks of size 2^( 3) =       0.000266498456
  error estimate for blocks of size 2^( 4) =       0.000272236359
  error estimate for blocks of size 2^( 5) =       0.000275449238
  error estimate for blocks of size 2^( 6) =       0.000277473401
  error estimate for blocks of size 2^( 7) =       0.000278223201
  error estimate for blocks of size 2^( 8) =       0.000278653772
  error estimate for blocks of size 2^( 9) =       0.000279513933

      target function =                  N/A
              le_mean =     -22.669701254621
             les_mean =     514.427155870357
             stat err =       0.000278466077
             autocorr =       1.245323613568
              std dev =       0.705791100135
             le_variance =       0.498141077030

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.498138685295
                                         uncertainty =       0.002085802585

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.498138685295
                                         uncertainty =       0.002085802585

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000249534837
  error estimate for blocks of size 2^( 2) =       0.000258555763
  error estimate for blocks of size 2^( 3) =       0.000266498456
  error estimate for blocks of size 2^( 4) =       0.000272236359
  error estimate for blocks of size 2^( 5) =       0.000275449238
  error estimate for blocks of size 2^( 6) =       0.000277473401
  error estimate for blocks of size 2^( 7) =       0.000278223201
  error estimate for blocks of size 2^( 8) =       0.000278653772
  error estimate for blocks of size 2^( 9) =       0.000279513933

      target function =                  N/A
              le_mean =     -22.669701254621
             les_mean =     514.427155870357
             stat err =       0.000278466077
             autocorr =       1.245323613568
              std dev =       0.705791100135
             le_variance =       0.498141077030

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.498138685295
                                         uncertainty =       0.002085802585

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.498138685295
                                         uncertainty =       0.002085802585

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000249534837
  error estimate for blocks of size 2^( 2) =       0.000258555763
  error estimate for blocks of size 2^( 3) =       0.000266498456
  error estimate for blocks of size 2^( 4) =       0.000272236359
  error estimate for blocks of size 2^( 5) =       0.000275449238
  error estimate for blocks of size 2^( 6) =       0.000277473401
  error estimate for blocks of size 2^( 7) =       0.000278223201
  error estimate for blocks of size 2^( 8) =       0.000278653772
  error estimate for blocks of size 2^( 9) =       0.000279513933

      target function =                  N/A
              le_mean =     -22.669701254621
             les_mean =     514.427155870357
             stat err =       0.000278466077
             autocorr =       1.245323613568
              std dev =       0.705791100135
             le_variance =       0.498141077030


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.669701254621        initial  <--
     1.3878e+17     1.3878e+18             0.0000e+00       -22.669701254621
     5.5511e+17     5.5511e+18             0.0000e+00       -22.669701254621
     2.2204e+18     2.2204e+19             0.0000e+00       -22.669701254621

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 178.2303
  </log>
  <optVariables href="FORM.s075.opt.xml">
ci_001                -7.050617e-01 3 1  ON 0
ci_002                -7.059926e-01 3 1  ON 1
ci_003                -3.765135e-02 3 1  ON 2
ci_004                -3.890325e-02 3 1  ON 3
ci_005                 1.612441e-02 3 1  ON 4
ci_006                 1.600090e-02 3 1  ON 5
ci_007                 1.228713e-02 3 1  ON 6
ci_008                 1.246533e-02 3 1  ON 7
ci_009                -1.173869e-02 3 1  ON 8
ci_010                -1.182876e-02 3 1  ON 9
ci_011                -8.176403e-03 3 1  ON 10
ci_012                -8.138278e-03 3 1  ON 11
ci_013                 9.647137e-03 3 1  ON 12
ci_014                 9.360580e-03 3 1  ON 13
ci_015                 1.228715e-02 3 1  ON 14
ci_016                 1.255400e-02 3 1  ON 15
ci_017                 1.088300e-02 3 1  ON 16
ci_018                 1.078149e-02 3 1  ON 17
ci_019                -2.514322e-03 3 1  ON 18
ci_020                -2.423765e-03 3 1  ON 19
ci_021                -8.459776e-03 3 1  ON 20
ci_022                -8.657034e-03 3 1  ON 21
ci_023                 7.805043e-03 3 1  ON 22
ci_024                 8.041852e-03 3 1  ON 23
ci_025                 4.702642e-03 3 1  ON 24
ci_026                 4.273172e-03 3 1  ON 25
ci_027                 6.454089e-03 3 1  ON 26
ci_028                 6.476482e-03 3 1  ON 27
ci_029                -4.877820e-03 3 1  ON 28
ci_030                -4.785596e-03 3 1  ON 29
ci_031                -7.388694e-03 3 1  ON 30
ci_032                -8.123179e-03 3 1  ON 31
ci_033                 4.600637e-03 3 1  ON 32
ci_034                 4.413553e-03 3 1  ON 33
ci_035                 1.126907e-03 3 1  ON 34
ci_036                 1.043146e-03 3 1  ON 35
ci_037                 4.953347e-03 3 1  ON 36
ci_038                 5.099310e-03 3 1  ON 37
ci_039                 5.306386e-03 3 1  ON 38
ci_040                 5.323086e-03 3 1  ON 39
ci_041                 4.970499e-03 3 1  ON 40
ci_042                 5.231233e-03 3 1  ON 41
ci_043                 4.943052e-03 3 1  ON 42
ci_044                 4.944182e-03 3 1  ON 43
ci_045                 3.123967e-03 3 1  ON 44
ci_046                 3.174246e-03 3 1  ON 45
ci_047                -7.790222e-04 3 1  ON 46
ci_048                -5.616836e-04 3 1  ON 47
ci_049                 1.580289e-03 3 1  ON 48
ci_050                 1.792516e-03 3 1  ON 49
ci_051                -1.106651e-03 3 1  ON 50
ci_052                -1.243279e-03 3 1  ON 51
ci_053                -2.610471e-03 3 1  ON 52
ci_054                -2.301978e-03 3 1  ON 53
ci_055                -1.483475e-03 3 1  ON 54
ci_056                -1.376714e-03 3 1  ON 55
ci_057                -1.240708e-03 3 1  ON 56
ci_058                -1.731077e-03 3 1  ON 57
ci_059                 3.171692e-04 3 1  ON 58
ci_060                 1.414703e-04 3 1  ON 59
ci_061                -3.305088e-04 3 1  ON 60
ci_062                -9.499769e-06 3 1  ON 61
ci_063                -5.232922e-04 3 1  ON 62
ci_064                -8.918525e-04 3 1  ON 63
ci_065                -2.408143e-03 3 1  ON 64
ci_066                -2.435285e-03 3 1  ON 65
ci_067                -2.101084e-03 3 1  ON 66
ci_068                -2.473560e-03 3 1  ON 67
ci_069                -2.085964e-04 3 1  ON 68
ci_070                 1.328450e-04 3 1  ON 69
ci_071                -1.874230e-03 3 1  ON 70
ci_072                -1.959430e-03 3 1  ON 71
ci_073                 5.749021e-04 3 1  ON 72
ci_074                 2.857507e-04 3 1  ON 73
ci_075                -2.910323e-04 3 1  ON 74
ci_076                -2.990999e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 2.9972e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s076 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s076 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=76  my_counter=0
  time step      = 5.0000e-02
  blocks         = 250
  steps          = 250
  substeps       = 10
  current        = 0
  target samples = 8.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">250</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">6.2500e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">8.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">6.2500e+04</parameter>
<parameter name="steps" condition="int">250</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2663e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="250">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =8000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 76
    time step          = 0.05
    reference energy   = -22.6948
    reference variance = 0.543372
====================================================
  Execution time = 1.0272e+02
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s076
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 62500 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 6.1072e+04
  VMC Eavg = -2.2669e+01
  VMC Evar = 5.0953e-01
  Total weights = 7.820154127e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.9047e+01
  </log>
</opt>
<opt stage="main" walkers="62500">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.496826016648
                                         uncertainty =       0.001606405833

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.496826016648
                                         uncertainty =       0.001606405833

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000249205068
  error estimate for blocks of size 2^( 2) =       0.000258052312
  error estimate for blocks of size 2^( 3) =       0.000265983797
  error estimate for blocks of size 2^( 4) =       0.000271605184
  error estimate for blocks of size 2^( 5) =       0.000275142682
  error estimate for blocks of size 2^( 6) =       0.000277002684
  error estimate for blocks of size 2^( 7) =       0.000278186611
  error estimate for blocks of size 2^( 8) =       0.000278478827
  error estimate for blocks of size 2^( 9) =       0.000277747409

      target function =                  N/A
              le_mean =     -22.669283687641
             les_mean =     514.405954361602
             stat err =       0.000277853883
             autocorr =       1.243137591194
              std dev =       0.704858374777
             le_variance =       0.496825328493


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266928368764e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.3878e+18, overlap shift 1.3878e+19 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.669283687662       residual = 3.56e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.669283687662       residual = 3.56e-05           smallest_sin_value = 1.00e+00
davidson iteration    2: stopping due to imaginary component in cost function
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 1.3878e+18 is 0.000000e+00

solving harmonic davidson linear method for identity shift 5.5511e+18, overlap shift 5.5511e+19 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.669283687662       residual = 3.56e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.669283687662       residual = 3.56e-05           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to small subspace S singular value of 6.25e-01
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 5.5511e+18 is 0.000000e+00

solving harmonic davidson linear method for identity shift 2.2204e+19, overlap shift 2.2204e+20 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.669283687662       residual = 3.56e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.669283687662       residual = 3.56e-05           smallest_sin_value = 1.00e+00
davidson iteration    2: stopping due to imaginary component in cost function
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 2.2204e+19 is 0.000000e+00

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.169691 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.2178e+02
  </log>
  <optVariables href="FORM.s076.opt.xml">
ci_001                -7.050617e-01 3 1  ON 0
ci_002                -7.059926e-01 3 1  ON 1
ci_003                -3.765135e-02 3 1  ON 2
ci_004                -3.890325e-02 3 1  ON 3
ci_005                 1.612441e-02 3 1  ON 4
ci_006                 1.600090e-02 3 1  ON 5
ci_007                 1.228713e-02 3 1  ON 6
ci_008                 1.246533e-02 3 1  ON 7
ci_009                -1.173869e-02 3 1  ON 8
ci_010                -1.182876e-02 3 1  ON 9
ci_011                -8.176403e-03 3 1  ON 10
ci_012                -8.138278e-03 3 1  ON 11
ci_013                 9.647137e-03 3 1  ON 12
ci_014                 9.360580e-03 3 1  ON 13
ci_015                 1.228715e-02 3 1  ON 14
ci_016                 1.255400e-02 3 1  ON 15
ci_017                 1.088300e-02 3 1  ON 16
ci_018                 1.078149e-02 3 1  ON 17
ci_019                -2.514322e-03 3 1  ON 18
ci_020                -2.423765e-03 3 1  ON 19
ci_021                -8.459776e-03 3 1  ON 20
ci_022                -8.657034e-03 3 1  ON 21
ci_023                 7.805043e-03 3 1  ON 22
ci_024                 8.041852e-03 3 1  ON 23
ci_025                 4.702642e-03 3 1  ON 24
ci_026                 4.273172e-03 3 1  ON 25
ci_027                 6.454089e-03 3 1  ON 26
ci_028                 6.476482e-03 3 1  ON 27
ci_029                -4.877820e-03 3 1  ON 28
ci_030                -4.785596e-03 3 1  ON 29
ci_031                -7.388694e-03 3 1  ON 30
ci_032                -8.123179e-03 3 1  ON 31
ci_033                 4.600637e-03 3 1  ON 32
ci_034                 4.413553e-03 3 1  ON 33
ci_035                 1.126907e-03 3 1  ON 34
ci_036                 1.043146e-03 3 1  ON 35
ci_037                 4.953347e-03 3 1  ON 36
ci_038                 5.099310e-03 3 1  ON 37
ci_039                 5.306386e-03 3 1  ON 38
ci_040                 5.323086e-03 3 1  ON 39
ci_041                 4.970499e-03 3 1  ON 40
ci_042                 5.231233e-03 3 1  ON 41
ci_043                 4.943052e-03 3 1  ON 42
ci_044                 4.944182e-03 3 1  ON 43
ci_045                 3.123967e-03 3 1  ON 44
ci_046                 3.174246e-03 3 1  ON 45
ci_047                -7.790222e-04 3 1  ON 46
ci_048                -5.616836e-04 3 1  ON 47
ci_049                 1.580289e-03 3 1  ON 48
ci_050                 1.792516e-03 3 1  ON 49
ci_051                -1.106651e-03 3 1  ON 50
ci_052                -1.243279e-03 3 1  ON 51
ci_053                -2.610471e-03 3 1  ON 52
ci_054                -2.301978e-03 3 1  ON 53
ci_055                -1.483475e-03 3 1  ON 54
ci_056                -1.376714e-03 3 1  ON 55
ci_057                -1.240708e-03 3 1  ON 56
ci_058                -1.731077e-03 3 1  ON 57
ci_059                 3.171692e-04 3 1  ON 58
ci_060                 1.414703e-04 3 1  ON 59
ci_061                -3.305088e-04 3 1  ON 60
ci_062                -9.499769e-06 3 1  ON 61
ci_063                -5.232922e-04 3 1  ON 62
ci_064                -8.918525e-04 3 1  ON 63
ci_065                -2.408143e-03 3 1  ON 64
ci_066                -2.435285e-03 3 1  ON 65
ci_067                -2.101084e-03 3 1  ON 66
ci_068                -2.473560e-03 3 1  ON 67
ci_069                -2.085964e-04 3 1  ON 68
ci_070                 1.328450e-04 3 1  ON 69
ci_071                -1.874230e-03 3 1  ON 70
ci_072                -1.959430e-03 3 1  ON 71
ci_073                 5.749021e-04 3 1  ON 72
ci_074                 2.857507e-04 3 1  ON 73
ci_075                -2.910323e-04 3 1  ON 74
ci_076                -2.990999e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="250">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =8000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 76
    time step          = 0.05
    reference energy   = -22.7051
    reference variance = 0.283083
====================================================
  Execution time = 1.0227e+02
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s076
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 62500 
  VMC Eavg = -2.2670e+01
  VMC Evar = 5.0686e-01
  Total weights = 7.8207e+06
  Execution time = 1.4641e+01
  </log>
</opt>
<opt stage="main" walkers="62500">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.495184210441
                                         uncertainty =       0.001487852654

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.495184210441
                                         uncertainty =       0.001487852654

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000248793348
  error estimate for blocks of size 2^( 2) =       0.000257847788
  error estimate for blocks of size 2^( 3) =       0.000265864161
  error estimate for blocks of size 2^( 4) =       0.000271619869
  error estimate for blocks of size 2^( 5) =       0.000275019566
  error estimate for blocks of size 2^( 6) =       0.000276558787
  error estimate for blocks of size 2^( 7) =       0.000277596957
  error estimate for blocks of size 2^( 8) =       0.000277540204
  error estimate for blocks of size 2^( 9) =       0.000278945859

      target function =                  N/A
              le_mean =     -22.669880544375
             les_mean =     514.430345324837
             stat err =       0.000277660452
             autocorr =       1.245519471924
              std dev =       0.703693855162
             le_variance =       0.495185041793

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.495184210441
                                         uncertainty =       0.001487852654

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.495184210441
                                         uncertainty =       0.001487852654

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000248793348
  error estimate for blocks of size 2^( 2) =       0.000257847788
  error estimate for blocks of size 2^( 3) =       0.000265864161
  error estimate for blocks of size 2^( 4) =       0.000271619869
  error estimate for blocks of size 2^( 5) =       0.000275019566
  error estimate for blocks of size 2^( 6) =       0.000276558787
  error estimate for blocks of size 2^( 7) =       0.000277596957
  error estimate for blocks of size 2^( 8) =       0.000277540204
  error estimate for blocks of size 2^( 9) =       0.000278945859

      target function =                  N/A
              le_mean =     -22.669880544375
             les_mean =     514.430345324837
             stat err =       0.000277660452
             autocorr =       1.245519471924
              std dev =       0.703693855162
             le_variance =       0.495185041793

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.495184210441
                                         uncertainty =       0.001487852654

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.495184210441
                                         uncertainty =       0.001487852654

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000248793348
  error estimate for blocks of size 2^( 2) =       0.000257847788
  error estimate for blocks of size 2^( 3) =       0.000265864161
  error estimate for blocks of size 2^( 4) =       0.000271619869
  error estimate for blocks of size 2^( 5) =       0.000275019566
  error estimate for blocks of size 2^( 6) =       0.000276558787
  error estimate for blocks of size 2^( 7) =       0.000277596957
  error estimate for blocks of size 2^( 8) =       0.000277540204
  error estimate for blocks of size 2^( 9) =       0.000278945859

      target function =                  N/A
              le_mean =     -22.669880544375
             les_mean =     514.430345324837
             stat err =       0.000277660452
             autocorr =       1.245519471924
              std dev =       0.703693855162
             le_variance =       0.495185041793

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.495184210441
                                         uncertainty =       0.001487852654

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.495184210441
                                         uncertainty =       0.001487852654

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000248793348
  error estimate for blocks of size 2^( 2) =       0.000257847788
  error estimate for blocks of size 2^( 3) =       0.000265864161
  error estimate for blocks of size 2^( 4) =       0.000271619869
  error estimate for blocks of size 2^( 5) =       0.000275019566
  error estimate for blocks of size 2^( 6) =       0.000276558787
  error estimate for blocks of size 2^( 7) =       0.000277596957
  error estimate for blocks of size 2^( 8) =       0.000277540204
  error estimate for blocks of size 2^( 9) =       0.000278945859

      target function =                  N/A
              le_mean =     -22.669880544375
             les_mean =     514.430345324837
             stat err =       0.000277660452
             autocorr =       1.245519471924
              std dev =       0.703693855162
             le_variance =       0.495185041793


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.669880544375        initial  <--
     1.3878e+18     1.3878e+19             0.0000e+00       -22.669880544375
     5.5511e+18     5.5511e+19             0.0000e+00       -22.669880544375
     2.2204e+19     2.2204e+20             0.0000e+00       -22.669880544375

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 178.5084
  </log>
  <optVariables href="FORM.s076.opt.xml">
ci_001                -7.050617e-01 3 1  ON 0
ci_002                -7.059926e-01 3 1  ON 1
ci_003                -3.765135e-02 3 1  ON 2
ci_004                -3.890325e-02 3 1  ON 3
ci_005                 1.612441e-02 3 1  ON 4
ci_006                 1.600090e-02 3 1  ON 5
ci_007                 1.228713e-02 3 1  ON 6
ci_008                 1.246533e-02 3 1  ON 7
ci_009                -1.173869e-02 3 1  ON 8
ci_010                -1.182876e-02 3 1  ON 9
ci_011                -8.176403e-03 3 1  ON 10
ci_012                -8.138278e-03 3 1  ON 11
ci_013                 9.647137e-03 3 1  ON 12
ci_014                 9.360580e-03 3 1  ON 13
ci_015                 1.228715e-02 3 1  ON 14
ci_016                 1.255400e-02 3 1  ON 15
ci_017                 1.088300e-02 3 1  ON 16
ci_018                 1.078149e-02 3 1  ON 17
ci_019                -2.514322e-03 3 1  ON 18
ci_020                -2.423765e-03 3 1  ON 19
ci_021                -8.459776e-03 3 1  ON 20
ci_022                -8.657034e-03 3 1  ON 21
ci_023                 7.805043e-03 3 1  ON 22
ci_024                 8.041852e-03 3 1  ON 23
ci_025                 4.702642e-03 3 1  ON 24
ci_026                 4.273172e-03 3 1  ON 25
ci_027                 6.454089e-03 3 1  ON 26
ci_028                 6.476482e-03 3 1  ON 27
ci_029                -4.877820e-03 3 1  ON 28
ci_030                -4.785596e-03 3 1  ON 29
ci_031                -7.388694e-03 3 1  ON 30
ci_032                -8.123179e-03 3 1  ON 31
ci_033                 4.600637e-03 3 1  ON 32
ci_034                 4.413553e-03 3 1  ON 33
ci_035                 1.126907e-03 3 1  ON 34
ci_036                 1.043146e-03 3 1  ON 35
ci_037                 4.953347e-03 3 1  ON 36
ci_038                 5.099310e-03 3 1  ON 37
ci_039                 5.306386e-03 3 1  ON 38
ci_040                 5.323086e-03 3 1  ON 39
ci_041                 4.970499e-03 3 1  ON 40
ci_042                 5.231233e-03 3 1  ON 41
ci_043                 4.943052e-03 3 1  ON 42
ci_044                 4.944182e-03 3 1  ON 43
ci_045                 3.123967e-03 3 1  ON 44
ci_046                 3.174246e-03 3 1  ON 45
ci_047                -7.790222e-04 3 1  ON 46
ci_048                -5.616836e-04 3 1  ON 47
ci_049                 1.580289e-03 3 1  ON 48
ci_050                 1.792516e-03 3 1  ON 49
ci_051                -1.106651e-03 3 1  ON 50
ci_052                -1.243279e-03 3 1  ON 51
ci_053                -2.610471e-03 3 1  ON 52
ci_054                -2.301978e-03 3 1  ON 53
ci_055                -1.483475e-03 3 1  ON 54
ci_056                -1.376714e-03 3 1  ON 55
ci_057                -1.240708e-03 3 1  ON 56
ci_058                -1.731077e-03 3 1  ON 57
ci_059                 3.171692e-04 3 1  ON 58
ci_060                 1.414703e-04 3 1  ON 59
ci_061                -3.305088e-04 3 1  ON 60
ci_062                -9.499769e-06 3 1  ON 61
ci_063                -5.232922e-04 3 1  ON 62
ci_064                -8.918525e-04 3 1  ON 63
ci_065                -2.408143e-03 3 1  ON 64
ci_066                -2.435285e-03 3 1  ON 65
ci_067                -2.101084e-03 3 1  ON 66
ci_068                -2.473560e-03 3 1  ON 67
ci_069                -2.085964e-04 3 1  ON 68
ci_070                 1.328450e-04 3 1  ON 69
ci_071                -1.874230e-03 3 1  ON 70
ci_072                -1.959430e-03 3 1  ON 71
ci_073                 5.749021e-04 3 1  ON 72
ci_074                 2.857507e-04 3 1  ON 73
ci_075                -2.910323e-04 3 1  ON 74
ci_076                -2.990999e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 3.0030e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s077 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s077 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=77  my_counter=0
  time step      = 5.0000e-02
  blocks         = 250
  steps          = 250
  substeps       = 10
  current        = 0
  target samples = 8.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">250</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">6.2500e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">8.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">6.2500e+04</parameter>
<parameter name="steps" condition="int">250</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2664e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="250">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =8000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 77
    time step          = 0.05
    reference energy   = -22.7433
    reference variance = 0.887986
====================================================
  Execution time = 1.0267e+02
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s077
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 62500 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 6.1130e+04
  VMC Eavg = -2.2669e+01
  VMC Evar = 5.0846e-01
  Total weights = 7.820352585e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.9125e+01
  </log>
</opt>
<opt stage="main" walkers="62500">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.496291739252
                                         uncertainty =       0.001481097778

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.496291739252
                                         uncertainty =       0.001481097778

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000249071591
  error estimate for blocks of size 2^( 2) =       0.000258048251
  error estimate for blocks of size 2^( 3) =       0.000266135539
  error estimate for blocks of size 2^( 4) =       0.000272044794
  error estimate for blocks of size 2^( 5) =       0.000275222123
  error estimate for blocks of size 2^( 6) =       0.000277515757
  error estimate for blocks of size 2^( 7) =       0.000278553306
  error estimate for blocks of size 2^( 8) =       0.000278811522
  error estimate for blocks of size 2^( 9) =       0.000279249193

      target function =                  N/A
              le_mean =     -22.669481552782
             les_mean =     514.413853256381
             stat err =       0.000278532445
             autocorr =       1.250556132422
              std dev =       0.704480845259
             le_variance =       0.496293261337


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266948155278e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.3878e+19, overlap shift 1.3878e+20 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.669481552804       residual = 4.66e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.669481552804       residual = 4.83e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.669481552804       residual = 4.66e-05           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 1.3878e+19 is 2.228425e-23

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 5.5511e+19, overlap shift 5.5511e+20 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.669481552804       residual = 4.66e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.669481552804       residual = 4.83e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.669481552804       residual = 4.66e-05           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 5.5511e+19 is 5.571063e-24

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 2.2204e+20, overlap shift 2.2204e+21 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.669481552804       residual = 4.66e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.669481552804       residual = 4.83e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.669481552804       residual = 4.66e-05           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 2.2204e+20 is 1.392766e-24

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.171931 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.2181e+02
  </log>
  <optVariables href="FORM.s077.opt.xml">
ci_001                -7.050617e-01 3 1  ON 0
ci_002                -7.059926e-01 3 1  ON 1
ci_003                -3.765135e-02 3 1  ON 2
ci_004                -3.890325e-02 3 1  ON 3
ci_005                 1.612441e-02 3 1  ON 4
ci_006                 1.600090e-02 3 1  ON 5
ci_007                 1.228713e-02 3 1  ON 6
ci_008                 1.246533e-02 3 1  ON 7
ci_009                -1.173869e-02 3 1  ON 8
ci_010                -1.182876e-02 3 1  ON 9
ci_011                -8.176403e-03 3 1  ON 10
ci_012                -8.138278e-03 3 1  ON 11
ci_013                 9.647137e-03 3 1  ON 12
ci_014                 9.360580e-03 3 1  ON 13
ci_015                 1.228715e-02 3 1  ON 14
ci_016                 1.255400e-02 3 1  ON 15
ci_017                 1.088300e-02 3 1  ON 16
ci_018                 1.078149e-02 3 1  ON 17
ci_019                -2.514322e-03 3 1  ON 18
ci_020                -2.423765e-03 3 1  ON 19
ci_021                -8.459776e-03 3 1  ON 20
ci_022                -8.657034e-03 3 1  ON 21
ci_023                 7.805043e-03 3 1  ON 22
ci_024                 8.041852e-03 3 1  ON 23
ci_025                 4.702642e-03 3 1  ON 24
ci_026                 4.273172e-03 3 1  ON 25
ci_027                 6.454089e-03 3 1  ON 26
ci_028                 6.476482e-03 3 1  ON 27
ci_029                -4.877820e-03 3 1  ON 28
ci_030                -4.785596e-03 3 1  ON 29
ci_031                -7.388694e-03 3 1  ON 30
ci_032                -8.123179e-03 3 1  ON 31
ci_033                 4.600637e-03 3 1  ON 32
ci_034                 4.413553e-03 3 1  ON 33
ci_035                 1.126907e-03 3 1  ON 34
ci_036                 1.043146e-03 3 1  ON 35
ci_037                 4.953347e-03 3 1  ON 36
ci_038                 5.099310e-03 3 1  ON 37
ci_039                 5.306386e-03 3 1  ON 38
ci_040                 5.323086e-03 3 1  ON 39
ci_041                 4.970499e-03 3 1  ON 40
ci_042                 5.231233e-03 3 1  ON 41
ci_043                 4.943052e-03 3 1  ON 42
ci_044                 4.944182e-03 3 1  ON 43
ci_045                 3.123967e-03 3 1  ON 44
ci_046                 3.174246e-03 3 1  ON 45
ci_047                -7.790222e-04 3 1  ON 46
ci_048                -5.616836e-04 3 1  ON 47
ci_049                 1.580289e-03 3 1  ON 48
ci_050                 1.792516e-03 3 1  ON 49
ci_051                -1.106651e-03 3 1  ON 50
ci_052                -1.243279e-03 3 1  ON 51
ci_053                -2.610471e-03 3 1  ON 52
ci_054                -2.301978e-03 3 1  ON 53
ci_055                -1.483475e-03 3 1  ON 54
ci_056                -1.376714e-03 3 1  ON 55
ci_057                -1.240708e-03 3 1  ON 56
ci_058                -1.731077e-03 3 1  ON 57
ci_059                 3.171692e-04 3 1  ON 58
ci_060                 1.414703e-04 3 1  ON 59
ci_061                -3.305088e-04 3 1  ON 60
ci_062                -9.499769e-06 3 1  ON 61
ci_063                -5.232922e-04 3 1  ON 62
ci_064                -8.918525e-04 3 1  ON 63
ci_065                -2.408143e-03 3 1  ON 64
ci_066                -2.435285e-03 3 1  ON 65
ci_067                -2.101084e-03 3 1  ON 66
ci_068                -2.473560e-03 3 1  ON 67
ci_069                -2.085964e-04 3 1  ON 68
ci_070                 1.328450e-04 3 1  ON 69
ci_071                -1.874230e-03 3 1  ON 70
ci_072                -1.959430e-03 3 1  ON 71
ci_073                 5.749021e-04 3 1  ON 72
ci_074                 2.857507e-04 3 1  ON 73
ci_075                -2.910323e-04 3 1  ON 74
ci_076                -2.990999e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="250">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =8000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 77
    time step          = 0.05
    reference energy   = -22.7489
    reference variance = 0.386717
====================================================
  Execution time = 1.0211e+02
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s077
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 62500 
  VMC Eavg = -2.2670e+01
  VMC Evar = 5.0893e-01
  Total weights = 7.8202e+06
  Execution time = 1.4652e+01
  </log>
</opt>
<opt stage="main" walkers="62500">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.496874949937
                                         uncertainty =       0.001428199284

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.496874949937
                                         uncertainty =       0.001428199284

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000249218119
  error estimate for blocks of size 2^( 2) =       0.000258253086
  error estimate for blocks of size 2^( 3) =       0.000266314480
  error estimate for blocks of size 2^( 4) =       0.000272074332
  error estimate for blocks of size 2^( 5) =       0.000275180814
  error estimate for blocks of size 2^( 6) =       0.000276784884
  error estimate for blocks of size 2^( 7) =       0.000276892206
  error estimate for blocks of size 2^( 8) =       0.000277394039
  error estimate for blocks of size 2^( 9) =       0.000277944063

      target function =                  N/A
              le_mean =     -22.669725339808
             les_mean =     514.425376114030
             stat err =       0.000277253798
             autocorr =       1.237644112994
              std dev =       0.704895288030
             le_variance =       0.496877367087

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.496874949937
                                         uncertainty =       0.001428199284

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.496874949937
                                         uncertainty =       0.001428199284

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000249218119
  error estimate for blocks of size 2^( 2) =       0.000258253086
  error estimate for blocks of size 2^( 3) =       0.000266314480
  error estimate for blocks of size 2^( 4) =       0.000272074332
  error estimate for blocks of size 2^( 5) =       0.000275180814
  error estimate for blocks of size 2^( 6) =       0.000276784884
  error estimate for blocks of size 2^( 7) =       0.000276892206
  error estimate for blocks of size 2^( 8) =       0.000277394039
  error estimate for blocks of size 2^( 9) =       0.000277944063

      target function =                  N/A
              le_mean =     -22.669725339808
             les_mean =     514.425376114030
             stat err =       0.000277253798
             autocorr =       1.237644112994
              std dev =       0.704895288030
             le_variance =       0.496877367087

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.496874949937
                                         uncertainty =       0.001428199284

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.496874949937
                                         uncertainty =       0.001428199284

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000249218119
  error estimate for blocks of size 2^( 2) =       0.000258253086
  error estimate for blocks of size 2^( 3) =       0.000266314480
  error estimate for blocks of size 2^( 4) =       0.000272074332
  error estimate for blocks of size 2^( 5) =       0.000275180814
  error estimate for blocks of size 2^( 6) =       0.000276784884
  error estimate for blocks of size 2^( 7) =       0.000276892206
  error estimate for blocks of size 2^( 8) =       0.000277394039
  error estimate for blocks of size 2^( 9) =       0.000277944063

      target function =                  N/A
              le_mean =     -22.669725339808
             les_mean =     514.425376114030
             stat err =       0.000277253798
             autocorr =       1.237644112994
              std dev =       0.704895288030
             le_variance =       0.496877367087

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.496874949937
                                         uncertainty =       0.001428199284

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.496874949937
                                         uncertainty =       0.001428199284

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000249218119
  error estimate for blocks of size 2^( 2) =       0.000258253086
  error estimate for blocks of size 2^( 3) =       0.000266314480
  error estimate for blocks of size 2^( 4) =       0.000272074332
  error estimate for blocks of size 2^( 5) =       0.000275180814
  error estimate for blocks of size 2^( 6) =       0.000276784884
  error estimate for blocks of size 2^( 7) =       0.000276892206
  error estimate for blocks of size 2^( 8) =       0.000277394039
  error estimate for blocks of size 2^( 9) =       0.000277944063

      target function =                  N/A
              le_mean =     -22.669725339808
             les_mean =     514.425376114030
             stat err =       0.000277253798
             autocorr =       1.237644112994
              std dev =       0.704895288030
             le_variance =       0.496877367087


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.669725339808        initial  <--
     1.3878e+19     1.3878e+20             2.2284e-23       -22.669725339808
     5.5511e+19     5.5511e+20             5.5711e-24       -22.669725339808
     2.2204e+20     2.2204e+21             1.3928e-24       -22.669725339808

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 178.9560
  </log>
  <optVariables href="FORM.s077.opt.xml">
ci_001                -7.050617e-01 3 1  ON 0
ci_002                -7.059926e-01 3 1  ON 1
ci_003                -3.765135e-02 3 1  ON 2
ci_004                -3.890325e-02 3 1  ON 3
ci_005                 1.612441e-02 3 1  ON 4
ci_006                 1.600090e-02 3 1  ON 5
ci_007                 1.228713e-02 3 1  ON 6
ci_008                 1.246533e-02 3 1  ON 7
ci_009                -1.173869e-02 3 1  ON 8
ci_010                -1.182876e-02 3 1  ON 9
ci_011                -8.176403e-03 3 1  ON 10
ci_012                -8.138278e-03 3 1  ON 11
ci_013                 9.647137e-03 3 1  ON 12
ci_014                 9.360580e-03 3 1  ON 13
ci_015                 1.228715e-02 3 1  ON 14
ci_016                 1.255400e-02 3 1  ON 15
ci_017                 1.088300e-02 3 1  ON 16
ci_018                 1.078149e-02 3 1  ON 17
ci_019                -2.514322e-03 3 1  ON 18
ci_020                -2.423765e-03 3 1  ON 19
ci_021                -8.459776e-03 3 1  ON 20
ci_022                -8.657034e-03 3 1  ON 21
ci_023                 7.805043e-03 3 1  ON 22
ci_024                 8.041852e-03 3 1  ON 23
ci_025                 4.702642e-03 3 1  ON 24
ci_026                 4.273172e-03 3 1  ON 25
ci_027                 6.454089e-03 3 1  ON 26
ci_028                 6.476482e-03 3 1  ON 27
ci_029                -4.877820e-03 3 1  ON 28
ci_030                -4.785596e-03 3 1  ON 29
ci_031                -7.388694e-03 3 1  ON 30
ci_032                -8.123179e-03 3 1  ON 31
ci_033                 4.600637e-03 3 1  ON 32
ci_034                 4.413553e-03 3 1  ON 33
ci_035                 1.126907e-03 3 1  ON 34
ci_036                 1.043146e-03 3 1  ON 35
ci_037                 4.953347e-03 3 1  ON 36
ci_038                 5.099310e-03 3 1  ON 37
ci_039                 5.306386e-03 3 1  ON 38
ci_040                 5.323086e-03 3 1  ON 39
ci_041                 4.970499e-03 3 1  ON 40
ci_042                 5.231233e-03 3 1  ON 41
ci_043                 4.943052e-03 3 1  ON 42
ci_044                 4.944182e-03 3 1  ON 43
ci_045                 3.123967e-03 3 1  ON 44
ci_046                 3.174246e-03 3 1  ON 45
ci_047                -7.790222e-04 3 1  ON 46
ci_048                -5.616836e-04 3 1  ON 47
ci_049                 1.580289e-03 3 1  ON 48
ci_050                 1.792516e-03 3 1  ON 49
ci_051                -1.106651e-03 3 1  ON 50
ci_052                -1.243279e-03 3 1  ON 51
ci_053                -2.610471e-03 3 1  ON 52
ci_054                -2.301978e-03 3 1  ON 53
ci_055                -1.483475e-03 3 1  ON 54
ci_056                -1.376714e-03 3 1  ON 55
ci_057                -1.240708e-03 3 1  ON 56
ci_058                -1.731077e-03 3 1  ON 57
ci_059                 3.171692e-04 3 1  ON 58
ci_060                 1.414703e-04 3 1  ON 59
ci_061                -3.305088e-04 3 1  ON 60
ci_062                -9.499769e-06 3 1  ON 61
ci_063                -5.232922e-04 3 1  ON 62
ci_064                -8.918525e-04 3 1  ON 63
ci_065                -2.408143e-03 3 1  ON 64
ci_066                -2.435285e-03 3 1  ON 65
ci_067                -2.101084e-03 3 1  ON 66
ci_068                -2.473560e-03 3 1  ON 67
ci_069                -2.085964e-04 3 1  ON 68
ci_070                 1.328450e-04 3 1  ON 69
ci_071                -1.874230e-03 3 1  ON 70
ci_072                -1.959430e-03 3 1  ON 71
ci_073                 5.749021e-04 3 1  ON 72
ci_074                 2.857507e-04 3 1  ON 73
ci_075                -2.910323e-04 3 1  ON 74
ci_076                -2.990999e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 3.0078e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s078 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s078 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=78  my_counter=0
  time step      = 5.0000e-02
  blocks         = 250
  steps          = 250
  substeps       = 10
  current        = 0
  target samples = 8.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">250</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">6.2500e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">8.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">6.2500e+04</parameter>
<parameter name="steps" condition="int">250</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2665e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="250">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =8000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 78
    time step          = 0.05
    reference energy   = -22.7075
    reference variance = 0.363081
====================================================
  Execution time = 1.0262e+02
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s078
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 62500 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 6.1028e+04
  VMC Eavg = -2.2669e+01
  VMC Evar = 5.1572e-01
  Total weights = 7.820602825e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.8993e+01
  </log>
</opt>
<opt stage="main" walkers="62500">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.502314662907
                                         uncertainty =       0.007110119281

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.502314662907
                                         uncertainty =       0.007110119281

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000250579857
  error estimate for blocks of size 2^( 2) =       0.000259447060
  error estimate for blocks of size 2^( 3) =       0.000267431996
  error estimate for blocks of size 2^( 4) =       0.000273081423
  error estimate for blocks of size 2^( 5) =       0.000276326530
  error estimate for blocks of size 2^( 6) =       0.000278916523
  error estimate for blocks of size 2^( 7) =       0.000280046145
  error estimate for blocks of size 2^( 8) =       0.000280425914
  error estimate for blocks of size 2^( 9) =       0.000282487334

      target function =                  N/A
              le_mean =     -22.669459944728
             les_mean =     514.420136343213
             stat err =       0.000280468979
             autocorr =       1.252787332882
              std dev =       0.708746863105
             le_variance =       0.502322115961


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266945994473e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.3878e+20, overlap shift 1.3878e+21 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.669459944751       residual = 8.94e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.669459944751       residual = 8.94e-05           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 1.3878e+20 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 5.5511e+20, overlap shift 5.5511e+21 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.669459944751       residual = 8.94e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.669459944751       residual = 8.94e-05           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 5.5511e+20 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 2.2204e+21, overlap shift 2.2204e+22 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.669459944751       residual = 8.94e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.669459944751       residual = 8.94e-05           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 2.2204e+21 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.173068 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.2163e+02
  </log>
  <optVariables href="FORM.s078.opt.xml">
ci_001                -7.050617e-01 3 1  ON 0
ci_002                -7.059926e-01 3 1  ON 1
ci_003                -3.765135e-02 3 1  ON 2
ci_004                -3.890325e-02 3 1  ON 3
ci_005                 1.612441e-02 3 1  ON 4
ci_006                 1.600090e-02 3 1  ON 5
ci_007                 1.228713e-02 3 1  ON 6
ci_008                 1.246533e-02 3 1  ON 7
ci_009                -1.173869e-02 3 1  ON 8
ci_010                -1.182876e-02 3 1  ON 9
ci_011                -8.176403e-03 3 1  ON 10
ci_012                -8.138278e-03 3 1  ON 11
ci_013                 9.647137e-03 3 1  ON 12
ci_014                 9.360580e-03 3 1  ON 13
ci_015                 1.228715e-02 3 1  ON 14
ci_016                 1.255400e-02 3 1  ON 15
ci_017                 1.088300e-02 3 1  ON 16
ci_018                 1.078149e-02 3 1  ON 17
ci_019                -2.514322e-03 3 1  ON 18
ci_020                -2.423765e-03 3 1  ON 19
ci_021                -8.459776e-03 3 1  ON 20
ci_022                -8.657034e-03 3 1  ON 21
ci_023                 7.805043e-03 3 1  ON 22
ci_024                 8.041852e-03 3 1  ON 23
ci_025                 4.702642e-03 3 1  ON 24
ci_026                 4.273172e-03 3 1  ON 25
ci_027                 6.454089e-03 3 1  ON 26
ci_028                 6.476482e-03 3 1  ON 27
ci_029                -4.877820e-03 3 1  ON 28
ci_030                -4.785596e-03 3 1  ON 29
ci_031                -7.388694e-03 3 1  ON 30
ci_032                -8.123179e-03 3 1  ON 31
ci_033                 4.600637e-03 3 1  ON 32
ci_034                 4.413553e-03 3 1  ON 33
ci_035                 1.126907e-03 3 1  ON 34
ci_036                 1.043146e-03 3 1  ON 35
ci_037                 4.953347e-03 3 1  ON 36
ci_038                 5.099310e-03 3 1  ON 37
ci_039                 5.306386e-03 3 1  ON 38
ci_040                 5.323086e-03 3 1  ON 39
ci_041                 4.970499e-03 3 1  ON 40
ci_042                 5.231233e-03 3 1  ON 41
ci_043                 4.943052e-03 3 1  ON 42
ci_044                 4.944182e-03 3 1  ON 43
ci_045                 3.123967e-03 3 1  ON 44
ci_046                 3.174246e-03 3 1  ON 45
ci_047                -7.790222e-04 3 1  ON 46
ci_048                -5.616836e-04 3 1  ON 47
ci_049                 1.580289e-03 3 1  ON 48
ci_050                 1.792516e-03 3 1  ON 49
ci_051                -1.106651e-03 3 1  ON 50
ci_052                -1.243279e-03 3 1  ON 51
ci_053                -2.610471e-03 3 1  ON 52
ci_054                -2.301978e-03 3 1  ON 53
ci_055                -1.483475e-03 3 1  ON 54
ci_056                -1.376714e-03 3 1  ON 55
ci_057                -1.240708e-03 3 1  ON 56
ci_058                -1.731077e-03 3 1  ON 57
ci_059                 3.171692e-04 3 1  ON 58
ci_060                 1.414703e-04 3 1  ON 59
ci_061                -3.305088e-04 3 1  ON 60
ci_062                -9.499769e-06 3 1  ON 61
ci_063                -5.232922e-04 3 1  ON 62
ci_064                -8.918525e-04 3 1  ON 63
ci_065                -2.408143e-03 3 1  ON 64
ci_066                -2.435285e-03 3 1  ON 65
ci_067                -2.101084e-03 3 1  ON 66
ci_068                -2.473560e-03 3 1  ON 67
ci_069                -2.085964e-04 3 1  ON 68
ci_070                 1.328450e-04 3 1  ON 69
ci_071                -1.874230e-03 3 1  ON 70
ci_072                -1.959430e-03 3 1  ON 71
ci_073                 5.749021e-04 3 1  ON 72
ci_074                 2.857507e-04 3 1  ON 73
ci_075                -2.910323e-04 3 1  ON 74
ci_076                -2.990999e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="250">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =8000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 78
    time step          = 0.05
    reference energy   = -22.6886
    reference variance = 0.369836
====================================================
  Execution time = 1.0197e+02
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s078
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 62500 
  VMC Eavg = -2.2669e+01
  VMC Evar = 5.0642e-01
  Total weights = 7.8205e+06
  Execution time = 1.4665e+01
  </log>
</opt>
<opt stage="main" walkers="62500">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.493834624754
                                         uncertainty =       0.001313737371

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.493834624754
                                         uncertainty =       0.001313737371

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000248453170
  error estimate for blocks of size 2^( 2) =       0.000257463203
  error estimate for blocks of size 2^( 3) =       0.000265529250
  error estimate for blocks of size 2^( 4) =       0.000271261185
  error estimate for blocks of size 2^( 5) =       0.000274508745
  error estimate for blocks of size 2^( 6) =       0.000276044625
  error estimate for blocks of size 2^( 7) =       0.000276772937
  error estimate for blocks of size 2^( 8) =       0.000277478899
  error estimate for blocks of size 2^( 9) =       0.000278263382

      target function =                  N/A
              le_mean =     -22.669170500030
             les_mean =     514.397712531753
             stat err =       0.000277139961
             autocorr =       1.244254489430
              std dev =       0.702731686051
             le_variance =       0.493831822581

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.493834624754
                                         uncertainty =       0.001313737371

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.493834624754
                                         uncertainty =       0.001313737371

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000248453170
  error estimate for blocks of size 2^( 2) =       0.000257463203
  error estimate for blocks of size 2^( 3) =       0.000265529250
  error estimate for blocks of size 2^( 4) =       0.000271261185
  error estimate for blocks of size 2^( 5) =       0.000274508745
  error estimate for blocks of size 2^( 6) =       0.000276044625
  error estimate for blocks of size 2^( 7) =       0.000276772937
  error estimate for blocks of size 2^( 8) =       0.000277478899
  error estimate for blocks of size 2^( 9) =       0.000278263382

      target function =                  N/A
              le_mean =     -22.669170500030
             les_mean =     514.397712531753
             stat err =       0.000277139961
             autocorr =       1.244254489430
              std dev =       0.702731686051
             le_variance =       0.493831822581

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.493834624754
                                         uncertainty =       0.001313737371

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.493834624754
                                         uncertainty =       0.001313737371

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000248453170
  error estimate for blocks of size 2^( 2) =       0.000257463203
  error estimate for blocks of size 2^( 3) =       0.000265529250
  error estimate for blocks of size 2^( 4) =       0.000271261185
  error estimate for blocks of size 2^( 5) =       0.000274508745
  error estimate for blocks of size 2^( 6) =       0.000276044625
  error estimate for blocks of size 2^( 7) =       0.000276772937
  error estimate for blocks of size 2^( 8) =       0.000277478899
  error estimate for blocks of size 2^( 9) =       0.000278263382

      target function =                  N/A
              le_mean =     -22.669170500030
             les_mean =     514.397712531753
             stat err =       0.000277139961
             autocorr =       1.244254489430
              std dev =       0.702731686051
             le_variance =       0.493831822581

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.493834624754
                                         uncertainty =       0.001313737371

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.493834624754
                                         uncertainty =       0.001313737371

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000248453170
  error estimate for blocks of size 2^( 2) =       0.000257463203
  error estimate for blocks of size 2^( 3) =       0.000265529250
  error estimate for blocks of size 2^( 4) =       0.000271261185
  error estimate for blocks of size 2^( 5) =       0.000274508745
  error estimate for blocks of size 2^( 6) =       0.000276044625
  error estimate for blocks of size 2^( 7) =       0.000276772937
  error estimate for blocks of size 2^( 8) =       0.000277478899
  error estimate for blocks of size 2^( 9) =       0.000278263382

      target function =                  N/A
              le_mean =     -22.669170500030
             les_mean =     514.397712531753
             stat err =       0.000277139961
             autocorr =       1.244254489430
              std dev =       0.702731686051
             le_variance =       0.493831822581


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.669170500030        initial  <--
     1.3878e+20     1.3878e+21             0.0000e+00       -22.669170500030
     5.5511e+20     5.5511e+21             0.0000e+00       -22.669170500030
     2.2204e+21     2.2204e+22             0.0000e+00       -22.669170500030

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 178.1211
  </log>
  <optVariables href="FORM.s078.opt.xml">
ci_001                -7.050617e-01 3 1  ON 0
ci_002                -7.059926e-01 3 1  ON 1
ci_003                -3.765135e-02 3 1  ON 2
ci_004                -3.890325e-02 3 1  ON 3
ci_005                 1.612441e-02 3 1  ON 4
ci_006                 1.600090e-02 3 1  ON 5
ci_007                 1.228713e-02 3 1  ON 6
ci_008                 1.246533e-02 3 1  ON 7
ci_009                -1.173869e-02 3 1  ON 8
ci_010                -1.182876e-02 3 1  ON 9
ci_011                -8.176403e-03 3 1  ON 10
ci_012                -8.138278e-03 3 1  ON 11
ci_013                 9.647137e-03 3 1  ON 12
ci_014                 9.360580e-03 3 1  ON 13
ci_015                 1.228715e-02 3 1  ON 14
ci_016                 1.255400e-02 3 1  ON 15
ci_017                 1.088300e-02 3 1  ON 16
ci_018                 1.078149e-02 3 1  ON 17
ci_019                -2.514322e-03 3 1  ON 18
ci_020                -2.423765e-03 3 1  ON 19
ci_021                -8.459776e-03 3 1  ON 20
ci_022                -8.657034e-03 3 1  ON 21
ci_023                 7.805043e-03 3 1  ON 22
ci_024                 8.041852e-03 3 1  ON 23
ci_025                 4.702642e-03 3 1  ON 24
ci_026                 4.273172e-03 3 1  ON 25
ci_027                 6.454089e-03 3 1  ON 26
ci_028                 6.476482e-03 3 1  ON 27
ci_029                -4.877820e-03 3 1  ON 28
ci_030                -4.785596e-03 3 1  ON 29
ci_031                -7.388694e-03 3 1  ON 30
ci_032                -8.123179e-03 3 1  ON 31
ci_033                 4.600637e-03 3 1  ON 32
ci_034                 4.413553e-03 3 1  ON 33
ci_035                 1.126907e-03 3 1  ON 34
ci_036                 1.043146e-03 3 1  ON 35
ci_037                 4.953347e-03 3 1  ON 36
ci_038                 5.099310e-03 3 1  ON 37
ci_039                 5.306386e-03 3 1  ON 38
ci_040                 5.323086e-03 3 1  ON 39
ci_041                 4.970499e-03 3 1  ON 40
ci_042                 5.231233e-03 3 1  ON 41
ci_043                 4.943052e-03 3 1  ON 42
ci_044                 4.944182e-03 3 1  ON 43
ci_045                 3.123967e-03 3 1  ON 44
ci_046                 3.174246e-03 3 1  ON 45
ci_047                -7.790222e-04 3 1  ON 46
ci_048                -5.616836e-04 3 1  ON 47
ci_049                 1.580289e-03 3 1  ON 48
ci_050                 1.792516e-03 3 1  ON 49
ci_051                -1.106651e-03 3 1  ON 50
ci_052                -1.243279e-03 3 1  ON 51
ci_053                -2.610471e-03 3 1  ON 52
ci_054                -2.301978e-03 3 1  ON 53
ci_055                -1.483475e-03 3 1  ON 54
ci_056                -1.376714e-03 3 1  ON 55
ci_057                -1.240708e-03 3 1  ON 56
ci_058                -1.731077e-03 3 1  ON 57
ci_059                 3.171692e-04 3 1  ON 58
ci_060                 1.414703e-04 3 1  ON 59
ci_061                -3.305088e-04 3 1  ON 60
ci_062                -9.499769e-06 3 1  ON 61
ci_063                -5.232922e-04 3 1  ON 62
ci_064                -8.918525e-04 3 1  ON 63
ci_065                -2.408143e-03 3 1  ON 64
ci_066                -2.435285e-03 3 1  ON 65
ci_067                -2.101084e-03 3 1  ON 66
ci_068                -2.473560e-03 3 1  ON 67
ci_069                -2.085964e-04 3 1  ON 68
ci_070                 1.328450e-04 3 1  ON 69
ci_071                -1.874230e-03 3 1  ON 70
ci_072                -1.959430e-03 3 1  ON 71
ci_073                 5.749021e-04 3 1  ON 72
ci_074                 2.857507e-04 3 1  ON 73
ci_075                -2.910323e-04 3 1  ON 74
ci_076                -2.990999e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 2.9976e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s079 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s079 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=79  my_counter=0
  time step      = 5.0000e-02
  blocks         = 250
  steps          = 250
  substeps       = 10
  current        = 0
  target samples = 8.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">250</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">6.2500e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">8.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">6.2500e+04</parameter>
<parameter name="steps" condition="int">250</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2665e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="250">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =8000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 79
    time step          = 0.05
    reference energy   = -22.6379
    reference variance = 0.316497
====================================================
  Execution time = 1.0254e+02
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s079
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 62500 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 6.1076e+04
  VMC Eavg = -2.2670e+01
  VMC Evar = 5.0990e-01
  Total weights = 7.820727801e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.9264e+01
  </log>
</opt>
<opt stage="main" walkers="62500">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.496972493856
                                         uncertainty =       0.001370007494

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.496972493856
                                         uncertainty =       0.001370007494

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000249241997
  error estimate for blocks of size 2^( 2) =       0.000258112758
  error estimate for blocks of size 2^( 3) =       0.000266261379
  error estimate for blocks of size 2^( 4) =       0.000271928261
  error estimate for blocks of size 2^( 5) =       0.000275348495
  error estimate for blocks of size 2^( 6) =       0.000277281701
  error estimate for blocks of size 2^( 7) =       0.000278803214
  error estimate for blocks of size 2^( 8) =       0.000280089844
  error estimate for blocks of size 2^( 9) =       0.000280197514

      target function =                  N/A
              le_mean =     -22.670181395620
             les_mean =     514.447024091871
             stat err =       0.000279093068
             autocorr =       1.253879076689
              std dev =       0.704962825672
             le_variance =       0.496972585580


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.267018139562e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.3878e+21, overlap shift 1.3878e+22 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.670181395640       residual = 3.83e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.670181395640       residual = 4.41e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.670181395640       residual = 3.83e-05           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 1.3878e+21 is 1.442878e-25

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 5.5511e+21, overlap shift 5.5511e+22 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.670181395640       residual = 3.83e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.670181395640       residual = 4.41e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.670181395640       residual = 3.83e-05           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 5.5511e+21 is 3.607194e-26

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 2.2204e+22, overlap shift 2.2204e+23 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.670181395640       residual = 3.83e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.670181395640       residual = 4.41e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.670181395640       residual = 3.83e-05           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 2.2204e+22 is 9.017986e-27

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.174470 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.2181e+02
  </log>
  <optVariables href="FORM.s079.opt.xml">
ci_001                -7.050617e-01 3 1  ON 0
ci_002                -7.059926e-01 3 1  ON 1
ci_003                -3.765135e-02 3 1  ON 2
ci_004                -3.890325e-02 3 1  ON 3
ci_005                 1.612441e-02 3 1  ON 4
ci_006                 1.600090e-02 3 1  ON 5
ci_007                 1.228713e-02 3 1  ON 6
ci_008                 1.246533e-02 3 1  ON 7
ci_009                -1.173869e-02 3 1  ON 8
ci_010                -1.182876e-02 3 1  ON 9
ci_011                -8.176403e-03 3 1  ON 10
ci_012                -8.138278e-03 3 1  ON 11
ci_013                 9.647137e-03 3 1  ON 12
ci_014                 9.360580e-03 3 1  ON 13
ci_015                 1.228715e-02 3 1  ON 14
ci_016                 1.255400e-02 3 1  ON 15
ci_017                 1.088300e-02 3 1  ON 16
ci_018                 1.078149e-02 3 1  ON 17
ci_019                -2.514322e-03 3 1  ON 18
ci_020                -2.423765e-03 3 1  ON 19
ci_021                -8.459776e-03 3 1  ON 20
ci_022                -8.657034e-03 3 1  ON 21
ci_023                 7.805043e-03 3 1  ON 22
ci_024                 8.041852e-03 3 1  ON 23
ci_025                 4.702642e-03 3 1  ON 24
ci_026                 4.273172e-03 3 1  ON 25
ci_027                 6.454089e-03 3 1  ON 26
ci_028                 6.476482e-03 3 1  ON 27
ci_029                -4.877820e-03 3 1  ON 28
ci_030                -4.785596e-03 3 1  ON 29
ci_031                -7.388694e-03 3 1  ON 30
ci_032                -8.123179e-03 3 1  ON 31
ci_033                 4.600637e-03 3 1  ON 32
ci_034                 4.413553e-03 3 1  ON 33
ci_035                 1.126907e-03 3 1  ON 34
ci_036                 1.043146e-03 3 1  ON 35
ci_037                 4.953347e-03 3 1  ON 36
ci_038                 5.099310e-03 3 1  ON 37
ci_039                 5.306386e-03 3 1  ON 38
ci_040                 5.323086e-03 3 1  ON 39
ci_041                 4.970499e-03 3 1  ON 40
ci_042                 5.231233e-03 3 1  ON 41
ci_043                 4.943052e-03 3 1  ON 42
ci_044                 4.944182e-03 3 1  ON 43
ci_045                 3.123967e-03 3 1  ON 44
ci_046                 3.174246e-03 3 1  ON 45
ci_047                -7.790222e-04 3 1  ON 46
ci_048                -5.616836e-04 3 1  ON 47
ci_049                 1.580289e-03 3 1  ON 48
ci_050                 1.792516e-03 3 1  ON 49
ci_051                -1.106651e-03 3 1  ON 50
ci_052                -1.243279e-03 3 1  ON 51
ci_053                -2.610471e-03 3 1  ON 52
ci_054                -2.301978e-03 3 1  ON 53
ci_055                -1.483475e-03 3 1  ON 54
ci_056                -1.376714e-03 3 1  ON 55
ci_057                -1.240708e-03 3 1  ON 56
ci_058                -1.731077e-03 3 1  ON 57
ci_059                 3.171692e-04 3 1  ON 58
ci_060                 1.414703e-04 3 1  ON 59
ci_061                -3.305088e-04 3 1  ON 60
ci_062                -9.499769e-06 3 1  ON 61
ci_063                -5.232922e-04 3 1  ON 62
ci_064                -8.918525e-04 3 1  ON 63
ci_065                -2.408143e-03 3 1  ON 64
ci_066                -2.435285e-03 3 1  ON 65
ci_067                -2.101084e-03 3 1  ON 66
ci_068                -2.473560e-03 3 1  ON 67
ci_069                -2.085964e-04 3 1  ON 68
ci_070                 1.328450e-04 3 1  ON 69
ci_071                -1.874230e-03 3 1  ON 70
ci_072                -1.959430e-03 3 1  ON 71
ci_073                 5.749021e-04 3 1  ON 72
ci_074                 2.857507e-04 3 1  ON 73
ci_075                -2.910323e-04 3 1  ON 74
ci_076                -2.990999e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="250">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =8000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 79
    time step          = 0.05
    reference energy   = -22.6946
    reference variance = 0.473819
====================================================
  Execution time = 1.0199e+02
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s079
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 62500 
  VMC Eavg = -2.2670e+01
  VMC Evar = 5.0583e-01
  Total weights = 7.8210e+06
  Execution time = 1.4814e+01
  </log>
</opt>
<opt stage="main" walkers="62500">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.494895067423
                                         uncertainty =       0.001322823426

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.494895067423
                                         uncertainty =       0.001322823426

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000248719695
  error estimate for blocks of size 2^( 2) =       0.000257765728
  error estimate for blocks of size 2^( 3) =       0.000265800357
  error estimate for blocks of size 2^( 4) =       0.000271535809
  error estimate for blocks of size 2^( 5) =       0.000274861940
  error estimate for blocks of size 2^( 6) =       0.000277019747
  error estimate for blocks of size 2^( 7) =       0.000277707150
  error estimate for blocks of size 2^( 8) =       0.000277986045
  error estimate for blocks of size 2^( 9) =       0.000278674634

      target function =                  N/A
              le_mean =     -22.669786135263
             les_mean =     514.425030351233
             stat err =       0.000277846894
             autocorr =       1.247931482915
              std dev =       0.703485530531
             le_variance =       0.494891891666

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.494895067423
                                         uncertainty =       0.001322823426

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.494895067423
                                         uncertainty =       0.001322823426

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000248719695
  error estimate for blocks of size 2^( 2) =       0.000257765728
  error estimate for blocks of size 2^( 3) =       0.000265800357
  error estimate for blocks of size 2^( 4) =       0.000271535809
  error estimate for blocks of size 2^( 5) =       0.000274861940
  error estimate for blocks of size 2^( 6) =       0.000277019747
  error estimate for blocks of size 2^( 7) =       0.000277707150
  error estimate for blocks of size 2^( 8) =       0.000277986045
  error estimate for blocks of size 2^( 9) =       0.000278674634

      target function =                  N/A
              le_mean =     -22.669786135263
             les_mean =     514.425030351233
             stat err =       0.000277846894
             autocorr =       1.247931482915
              std dev =       0.703485530531
             le_variance =       0.494891891666

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.494895067423
                                         uncertainty =       0.001322823426

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.494895067423
                                         uncertainty =       0.001322823426

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000248719695
  error estimate for blocks of size 2^( 2) =       0.000257765728
  error estimate for blocks of size 2^( 3) =       0.000265800357
  error estimate for blocks of size 2^( 4) =       0.000271535809
  error estimate for blocks of size 2^( 5) =       0.000274861940
  error estimate for blocks of size 2^( 6) =       0.000277019747
  error estimate for blocks of size 2^( 7) =       0.000277707150
  error estimate for blocks of size 2^( 8) =       0.000277986045
  error estimate for blocks of size 2^( 9) =       0.000278674634

      target function =                  N/A
              le_mean =     -22.669786135263
             les_mean =     514.425030351233
             stat err =       0.000277846894
             autocorr =       1.247931482915
              std dev =       0.703485530531
             le_variance =       0.494891891666

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.494895067423
                                         uncertainty =       0.001322823426

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.494895067423
                                         uncertainty =       0.001322823426

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000248719695
  error estimate for blocks of size 2^( 2) =       0.000257765728
  error estimate for blocks of size 2^( 3) =       0.000265800357
  error estimate for blocks of size 2^( 4) =       0.000271535809
  error estimate for blocks of size 2^( 5) =       0.000274861940
  error estimate for blocks of size 2^( 6) =       0.000277019747
  error estimate for blocks of size 2^( 7) =       0.000277707150
  error estimate for blocks of size 2^( 8) =       0.000277986045
  error estimate for blocks of size 2^( 9) =       0.000278674634

      target function =                  N/A
              le_mean =     -22.669786135263
             les_mean =     514.425030351233
             stat err =       0.000277846894
             autocorr =       1.247931482915
              std dev =       0.703485530531
             le_variance =       0.494891891666


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.669786135263        initial  <--
     1.3878e+21     1.3878e+22             1.4429e-25       -22.669786135263
     5.5511e+21     5.5511e+22             3.6072e-26       -22.669786135263
     2.2204e+22     2.2204e+23             9.0180e-27       -22.669786135263

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 178.5859
  </log>
  <optVariables href="FORM.s079.opt.xml">
ci_001                -7.050617e-01 3 1  ON 0
ci_002                -7.059926e-01 3 1  ON 1
ci_003                -3.765135e-02 3 1  ON 2
ci_004                -3.890325e-02 3 1  ON 3
ci_005                 1.612441e-02 3 1  ON 4
ci_006                 1.600090e-02 3 1  ON 5
ci_007                 1.228713e-02 3 1  ON 6
ci_008                 1.246533e-02 3 1  ON 7
ci_009                -1.173869e-02 3 1  ON 8
ci_010                -1.182876e-02 3 1  ON 9
ci_011                -8.176403e-03 3 1  ON 10
ci_012                -8.138278e-03 3 1  ON 11
ci_013                 9.647137e-03 3 1  ON 12
ci_014                 9.360580e-03 3 1  ON 13
ci_015                 1.228715e-02 3 1  ON 14
ci_016                 1.255400e-02 3 1  ON 15
ci_017                 1.088300e-02 3 1  ON 16
ci_018                 1.078149e-02 3 1  ON 17
ci_019                -2.514322e-03 3 1  ON 18
ci_020                -2.423765e-03 3 1  ON 19
ci_021                -8.459776e-03 3 1  ON 20
ci_022                -8.657034e-03 3 1  ON 21
ci_023                 7.805043e-03 3 1  ON 22
ci_024                 8.041852e-03 3 1  ON 23
ci_025                 4.702642e-03 3 1  ON 24
ci_026                 4.273172e-03 3 1  ON 25
ci_027                 6.454089e-03 3 1  ON 26
ci_028                 6.476482e-03 3 1  ON 27
ci_029                -4.877820e-03 3 1  ON 28
ci_030                -4.785596e-03 3 1  ON 29
ci_031                -7.388694e-03 3 1  ON 30
ci_032                -8.123179e-03 3 1  ON 31
ci_033                 4.600637e-03 3 1  ON 32
ci_034                 4.413553e-03 3 1  ON 33
ci_035                 1.126907e-03 3 1  ON 34
ci_036                 1.043146e-03 3 1  ON 35
ci_037                 4.953347e-03 3 1  ON 36
ci_038                 5.099310e-03 3 1  ON 37
ci_039                 5.306386e-03 3 1  ON 38
ci_040                 5.323086e-03 3 1  ON 39
ci_041                 4.970499e-03 3 1  ON 40
ci_042                 5.231233e-03 3 1  ON 41
ci_043                 4.943052e-03 3 1  ON 42
ci_044                 4.944182e-03 3 1  ON 43
ci_045                 3.123967e-03 3 1  ON 44
ci_046                 3.174246e-03 3 1  ON 45
ci_047                -7.790222e-04 3 1  ON 46
ci_048                -5.616836e-04 3 1  ON 47
ci_049                 1.580289e-03 3 1  ON 48
ci_050                 1.792516e-03 3 1  ON 49
ci_051                -1.106651e-03 3 1  ON 50
ci_052                -1.243279e-03 3 1  ON 51
ci_053                -2.610471e-03 3 1  ON 52
ci_054                -2.301978e-03 3 1  ON 53
ci_055                -1.483475e-03 3 1  ON 54
ci_056                -1.376714e-03 3 1  ON 55
ci_057                -1.240708e-03 3 1  ON 56
ci_058                -1.731077e-03 3 1  ON 57
ci_059                 3.171692e-04 3 1  ON 58
ci_060                 1.414703e-04 3 1  ON 59
ci_061                -3.305088e-04 3 1  ON 60
ci_062                -9.499769e-06 3 1  ON 61
ci_063                -5.232922e-04 3 1  ON 62
ci_064                -8.918525e-04 3 1  ON 63
ci_065                -2.408143e-03 3 1  ON 64
ci_066                -2.435285e-03 3 1  ON 65
ci_067                -2.101084e-03 3 1  ON 66
ci_068                -2.473560e-03 3 1  ON 67
ci_069                -2.085964e-04 3 1  ON 68
ci_070                 1.328450e-04 3 1  ON 69
ci_071                -1.874230e-03 3 1  ON 70
ci_072                -1.959430e-03 3 1  ON 71
ci_073                 5.749021e-04 3 1  ON 72
ci_074                 2.857507e-04 3 1  ON 73
ci_075                -2.910323e-04 3 1  ON 74
ci_076                -2.990999e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 3.0042e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s080 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s080 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=80  my_counter=0
  time step      = 5.0000e-02
  blocks         = 250
  steps          = 250
  substeps       = 10
  current        = 0
  target samples = 8.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">250</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">6.2500e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">8.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">6.2500e+04</parameter>
<parameter name="steps" condition="int">250</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2665e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="250">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =8000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 80
    time step          = 0.05
    reference energy   = -22.6627
    reference variance = 0.346643
====================================================
  Execution time = 1.0250e+02
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s080
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 62500 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 6.1103e+04
  VMC Eavg = -2.2670e+01
  VMC Evar = 5.1368e-01
  Total weights = 7.820867933e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.9240e+01
  </log>
</opt>
<opt stage="main" walkers="62500">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.499676973958
                                         uncertainty =       0.001679356845

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.499676973958
                                         uncertainty =       0.001679356845

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000249919203
  error estimate for blocks of size 2^( 2) =       0.000258873475
  error estimate for blocks of size 2^( 3) =       0.000266994514
  error estimate for blocks of size 2^( 4) =       0.000272428736
  error estimate for blocks of size 2^( 5) =       0.000275806966
  error estimate for blocks of size 2^( 6) =       0.000277402520
  error estimate for blocks of size 2^( 7) =       0.000278364894
  error estimate for blocks of size 2^( 8) =       0.000278753072
  error estimate for blocks of size 2^( 9) =       0.000279564639

      target function =                  N/A
              le_mean =     -22.669712098649
             les_mean =     514.429530314106
             stat err =       0.000278521281
             autocorr =       1.241988325007
              std dev =       0.706878253079
             le_variance =       0.499676864676


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266971209865e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.3878e+22, overlap shift 1.3878e+23 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.669712098673       residual = 6.84e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.669712098673       residual = 6.84e-05           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 1.3878e+22 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 5.5511e+22, overlap shift 5.5511e+23 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.669712098673       residual = 6.84e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.669712098673       residual = 6.84e-05           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 5.5511e+22 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 2.2204e+23, overlap shift 2.2204e+24 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.669712098673       residual = 6.84e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.669712098673       residual = 6.84e-05           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 2.2204e+23 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.175593 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.2176e+02
  </log>
  <optVariables href="FORM.s080.opt.xml">
ci_001                -7.050617e-01 3 1  ON 0
ci_002                -7.059926e-01 3 1  ON 1
ci_003                -3.765135e-02 3 1  ON 2
ci_004                -3.890325e-02 3 1  ON 3
ci_005                 1.612441e-02 3 1  ON 4
ci_006                 1.600090e-02 3 1  ON 5
ci_007                 1.228713e-02 3 1  ON 6
ci_008                 1.246533e-02 3 1  ON 7
ci_009                -1.173869e-02 3 1  ON 8
ci_010                -1.182876e-02 3 1  ON 9
ci_011                -8.176403e-03 3 1  ON 10
ci_012                -8.138278e-03 3 1  ON 11
ci_013                 9.647137e-03 3 1  ON 12
ci_014                 9.360580e-03 3 1  ON 13
ci_015                 1.228715e-02 3 1  ON 14
ci_016                 1.255400e-02 3 1  ON 15
ci_017                 1.088300e-02 3 1  ON 16
ci_018                 1.078149e-02 3 1  ON 17
ci_019                -2.514322e-03 3 1  ON 18
ci_020                -2.423765e-03 3 1  ON 19
ci_021                -8.459776e-03 3 1  ON 20
ci_022                -8.657034e-03 3 1  ON 21
ci_023                 7.805043e-03 3 1  ON 22
ci_024                 8.041852e-03 3 1  ON 23
ci_025                 4.702642e-03 3 1  ON 24
ci_026                 4.273172e-03 3 1  ON 25
ci_027                 6.454089e-03 3 1  ON 26
ci_028                 6.476482e-03 3 1  ON 27
ci_029                -4.877820e-03 3 1  ON 28
ci_030                -4.785596e-03 3 1  ON 29
ci_031                -7.388694e-03 3 1  ON 30
ci_032                -8.123179e-03 3 1  ON 31
ci_033                 4.600637e-03 3 1  ON 32
ci_034                 4.413553e-03 3 1  ON 33
ci_035                 1.126907e-03 3 1  ON 34
ci_036                 1.043146e-03 3 1  ON 35
ci_037                 4.953347e-03 3 1  ON 36
ci_038                 5.099310e-03 3 1  ON 37
ci_039                 5.306386e-03 3 1  ON 38
ci_040                 5.323086e-03 3 1  ON 39
ci_041                 4.970499e-03 3 1  ON 40
ci_042                 5.231233e-03 3 1  ON 41
ci_043                 4.943052e-03 3 1  ON 42
ci_044                 4.944182e-03 3 1  ON 43
ci_045                 3.123967e-03 3 1  ON 44
ci_046                 3.174246e-03 3 1  ON 45
ci_047                -7.790222e-04 3 1  ON 46
ci_048                -5.616836e-04 3 1  ON 47
ci_049                 1.580289e-03 3 1  ON 48
ci_050                 1.792516e-03 3 1  ON 49
ci_051                -1.106651e-03 3 1  ON 50
ci_052                -1.243279e-03 3 1  ON 51
ci_053                -2.610471e-03 3 1  ON 52
ci_054                -2.301978e-03 3 1  ON 53
ci_055                -1.483475e-03 3 1  ON 54
ci_056                -1.376714e-03 3 1  ON 55
ci_057                -1.240708e-03 3 1  ON 56
ci_058                -1.731077e-03 3 1  ON 57
ci_059                 3.171692e-04 3 1  ON 58
ci_060                 1.414703e-04 3 1  ON 59
ci_061                -3.305088e-04 3 1  ON 60
ci_062                -9.499769e-06 3 1  ON 61
ci_063                -5.232922e-04 3 1  ON 62
ci_064                -8.918525e-04 3 1  ON 63
ci_065                -2.408143e-03 3 1  ON 64
ci_066                -2.435285e-03 3 1  ON 65
ci_067                -2.101084e-03 3 1  ON 66
ci_068                -2.473560e-03 3 1  ON 67
ci_069                -2.085964e-04 3 1  ON 68
ci_070                 1.328450e-04 3 1  ON 69
ci_071                -1.874230e-03 3 1  ON 70
ci_072                -1.959430e-03 3 1  ON 71
ci_073                 5.749021e-04 3 1  ON 72
ci_074                 2.857507e-04 3 1  ON 73
ci_075                -2.910323e-04 3 1  ON 74
ci_076                -2.990999e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="250">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =8000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 80
    time step          = 0.05
    reference energy   = -22.5577
    reference variance = 0.433819
====================================================
  Execution time = 1.0200e+02
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s080
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 62500 
  VMC Eavg = -2.2670e+01
  VMC Evar = 5.0562e-01
  Total weights = 7.8203e+06
  Execution time = 1.4776e+01
  </log>
</opt>
<opt stage="main" walkers="62500">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.493603840681
                                         uncertainty =       0.001362916501

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.493603840681
                                         uncertainty =       0.001362916501

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000248396387
  error estimate for blocks of size 2^( 2) =       0.000257461481
  error estimate for blocks of size 2^( 3) =       0.000265590533
  error estimate for blocks of size 2^( 4) =       0.000271289972
  error estimate for blocks of size 2^( 5) =       0.000274588091
  error estimate for blocks of size 2^( 6) =       0.000276193347
  error estimate for blocks of size 2^( 7) =       0.000277250098
  error estimate for blocks of size 2^( 8) =       0.000277431352
  error estimate for blocks of size 2^( 9) =       0.000277585101

      target function =                  N/A
              le_mean =     -22.669801216269
             les_mean =     514.425503777637
             stat err =       0.000277114975
             autocorr =       1.244598975256
              std dev =       0.702571079402
             le_variance =       0.493606121612

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.493603840681
                                         uncertainty =       0.001362916501

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.493603840681
                                         uncertainty =       0.001362916501

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000248396387
  error estimate for blocks of size 2^( 2) =       0.000257461481
  error estimate for blocks of size 2^( 3) =       0.000265590533
  error estimate for blocks of size 2^( 4) =       0.000271289972
  error estimate for blocks of size 2^( 5) =       0.000274588091
  error estimate for blocks of size 2^( 6) =       0.000276193347
  error estimate for blocks of size 2^( 7) =       0.000277250098
  error estimate for blocks of size 2^( 8) =       0.000277431352
  error estimate for blocks of size 2^( 9) =       0.000277585101

      target function =                  N/A
              le_mean =     -22.669801216269
             les_mean =     514.425503777637
             stat err =       0.000277114975
             autocorr =       1.244598975245
              std dev =       0.702571079402
             le_variance =       0.493606121612

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.493603840681
                                         uncertainty =       0.001362916501

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.493603840681
                                         uncertainty =       0.001362916501

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000248396387
  error estimate for blocks of size 2^( 2) =       0.000257461481
  error estimate for blocks of size 2^( 3) =       0.000265590533
  error estimate for blocks of size 2^( 4) =       0.000271289972
  error estimate for blocks of size 2^( 5) =       0.000274588091
  error estimate for blocks of size 2^( 6) =       0.000276193347
  error estimate for blocks of size 2^( 7) =       0.000277250098
  error estimate for blocks of size 2^( 8) =       0.000277431352
  error estimate for blocks of size 2^( 9) =       0.000277585101

      target function =                  N/A
              le_mean =     -22.669801216269
             les_mean =     514.425503777637
             stat err =       0.000277114975
             autocorr =       1.244598975245
              std dev =       0.702571079402
             le_variance =       0.493606121612

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.493603840681
                                         uncertainty =       0.001362916501

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.493603840681
                                         uncertainty =       0.001362916501

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000248396387
  error estimate for blocks of size 2^( 2) =       0.000257461481
  error estimate for blocks of size 2^( 3) =       0.000265590533
  error estimate for blocks of size 2^( 4) =       0.000271289972
  error estimate for blocks of size 2^( 5) =       0.000274588091
  error estimate for blocks of size 2^( 6) =       0.000276193347
  error estimate for blocks of size 2^( 7) =       0.000277250098
  error estimate for blocks of size 2^( 8) =       0.000277431352
  error estimate for blocks of size 2^( 9) =       0.000277585101

      target function =                  N/A
              le_mean =     -22.669801216269
             les_mean =     514.425503777637
             stat err =       0.000277114975
             autocorr =       1.244598975245
              std dev =       0.702571079402
             le_variance =       0.493606121612


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.669801216269        initial  <--
     1.3878e+22     1.3878e+23             0.0000e+00       -22.669801216269
     5.5511e+22     5.5511e+23             0.0000e+00       -22.669801216269
     2.2204e+23     2.2204e+24             0.0000e+00       -22.669801216269

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 178.2848
  </log>
  <optVariables href="FORM.s080.opt.xml">
ci_001                -7.050617e-01 3 1  ON 0
ci_002                -7.059926e-01 3 1  ON 1
ci_003                -3.765135e-02 3 1  ON 2
ci_004                -3.890325e-02 3 1  ON 3
ci_005                 1.612441e-02 3 1  ON 4
ci_006                 1.600090e-02 3 1  ON 5
ci_007                 1.228713e-02 3 1  ON 6
ci_008                 1.246533e-02 3 1  ON 7
ci_009                -1.173869e-02 3 1  ON 8
ci_010                -1.182876e-02 3 1  ON 9
ci_011                -8.176403e-03 3 1  ON 10
ci_012                -8.138278e-03 3 1  ON 11
ci_013                 9.647137e-03 3 1  ON 12
ci_014                 9.360580e-03 3 1  ON 13
ci_015                 1.228715e-02 3 1  ON 14
ci_016                 1.255400e-02 3 1  ON 15
ci_017                 1.088300e-02 3 1  ON 16
ci_018                 1.078149e-02 3 1  ON 17
ci_019                -2.514322e-03 3 1  ON 18
ci_020                -2.423765e-03 3 1  ON 19
ci_021                -8.459776e-03 3 1  ON 20
ci_022                -8.657034e-03 3 1  ON 21
ci_023                 7.805043e-03 3 1  ON 22
ci_024                 8.041852e-03 3 1  ON 23
ci_025                 4.702642e-03 3 1  ON 24
ci_026                 4.273172e-03 3 1  ON 25
ci_027                 6.454089e-03 3 1  ON 26
ci_028                 6.476482e-03 3 1  ON 27
ci_029                -4.877820e-03 3 1  ON 28
ci_030                -4.785596e-03 3 1  ON 29
ci_031                -7.388694e-03 3 1  ON 30
ci_032                -8.123179e-03 3 1  ON 31
ci_033                 4.600637e-03 3 1  ON 32
ci_034                 4.413553e-03 3 1  ON 33
ci_035                 1.126907e-03 3 1  ON 34
ci_036                 1.043146e-03 3 1  ON 35
ci_037                 4.953347e-03 3 1  ON 36
ci_038                 5.099310e-03 3 1  ON 37
ci_039                 5.306386e-03 3 1  ON 38
ci_040                 5.323086e-03 3 1  ON 39
ci_041                 4.970499e-03 3 1  ON 40
ci_042                 5.231233e-03 3 1  ON 41
ci_043                 4.943052e-03 3 1  ON 42
ci_044                 4.944182e-03 3 1  ON 43
ci_045                 3.123967e-03 3 1  ON 44
ci_046                 3.174246e-03 3 1  ON 45
ci_047                -7.790222e-04 3 1  ON 46
ci_048                -5.616836e-04 3 1  ON 47
ci_049                 1.580289e-03 3 1  ON 48
ci_050                 1.792516e-03 3 1  ON 49
ci_051                -1.106651e-03 3 1  ON 50
ci_052                -1.243279e-03 3 1  ON 51
ci_053                -2.610471e-03 3 1  ON 52
ci_054                -2.301978e-03 3 1  ON 53
ci_055                -1.483475e-03 3 1  ON 54
ci_056                -1.376714e-03 3 1  ON 55
ci_057                -1.240708e-03 3 1  ON 56
ci_058                -1.731077e-03 3 1  ON 57
ci_059                 3.171692e-04 3 1  ON 58
ci_060                 1.414703e-04 3 1  ON 59
ci_061                -3.305088e-04 3 1  ON 60
ci_062                -9.499769e-06 3 1  ON 61
ci_063                -5.232922e-04 3 1  ON 62
ci_064                -8.918525e-04 3 1  ON 63
ci_065                -2.408143e-03 3 1  ON 64
ci_066                -2.435285e-03 3 1  ON 65
ci_067                -2.101084e-03 3 1  ON 66
ci_068                -2.473560e-03 3 1  ON 67
ci_069                -2.085964e-04 3 1  ON 68
ci_070                 1.328450e-04 3 1  ON 69
ci_071                -1.874230e-03 3 1  ON 70
ci_072                -1.959430e-03 3 1  ON 71
ci_073                 5.749021e-04 3 1  ON 72
ci_074                 2.857507e-04 3 1  ON 73
ci_075                -2.910323e-04 3 1  ON 74
ci_076                -2.990999e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 3.0005e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s081 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s081 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=81  my_counter=0
  time step      = 5.0000e-02
  blocks         = 250
  steps          = 250
  substeps       = 10
  current        = 0
  target samples = 8.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">250</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">6.2500e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">8.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">6.2500e+04</parameter>
<parameter name="steps" condition="int">250</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2664e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="250">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =8000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 81
    time step          = 0.05
    reference energy   = -22.6805
    reference variance = 0.598927
====================================================
  Execution time = 1.0241e+02
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s081
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 62500 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 6.1093e+04
  VMC Eavg = -2.2669e+01
  VMC Evar = 5.1195e-01
  Total weights = 7.820237507e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.9285e+01
  </log>
</opt>
<opt stage="main" walkers="62500">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.499153057670
                                         uncertainty =       0.001862330932

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.499153057670
                                         uncertainty =       0.001862330932

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000249789137
  error estimate for blocks of size 2^( 2) =       0.000258811126
  error estimate for blocks of size 2^( 3) =       0.000266857223
  error estimate for blocks of size 2^( 4) =       0.000272438120
  error estimate for blocks of size 2^( 5) =       0.000276137189
  error estimate for blocks of size 2^( 6) =       0.000278138497
  error estimate for blocks of size 2^( 7) =       0.000279769645
  error estimate for blocks of size 2^( 8) =       0.000280075082
  error estimate for blocks of size 2^( 9) =       0.000280772882

      target function =                  N/A
              le_mean =     -22.669398434078
             les_mean =     514.413576651954
             stat err =       0.000279689026
             autocorr =       1.253729254837
              std dev =       0.706510369594
             le_variance =       0.499156902344


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266939843408e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.3878e+23, overlap shift 1.3878e+24 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.669398434101       residual = 2.84e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.669398434101       residual = 3.09e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.669398434101       residual = 5.99e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 1.3878e+23 is 1.478811e-27

solving harmonic davidson linear method for identity shift 5.5511e+23, overlap shift 5.5511e+24 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.669398434101       residual = 2.84e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.669398434101       residual = 3.09e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.669398434101       residual = 5.99e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 5.5511e+23 is 3.697028e-28

solving harmonic davidson linear method for identity shift 2.2204e+24, overlap shift 2.2204e+25 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.669398434101       residual = 2.84e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.669398434101       residual = 3.09e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.669398434101       residual = 5.99e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 2.2204e+24 is 9.242570e-29

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.176698 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.2170e+02
  </log>
  <optVariables href="FORM.s081.opt.xml">
ci_001                -7.050617e-01 3 1  ON 0
ci_002                -7.059926e-01 3 1  ON 1
ci_003                -3.765135e-02 3 1  ON 2
ci_004                -3.890325e-02 3 1  ON 3
ci_005                 1.612441e-02 3 1  ON 4
ci_006                 1.600090e-02 3 1  ON 5
ci_007                 1.228713e-02 3 1  ON 6
ci_008                 1.246533e-02 3 1  ON 7
ci_009                -1.173869e-02 3 1  ON 8
ci_010                -1.182876e-02 3 1  ON 9
ci_011                -8.176403e-03 3 1  ON 10
ci_012                -8.138278e-03 3 1  ON 11
ci_013                 9.647137e-03 3 1  ON 12
ci_014                 9.360580e-03 3 1  ON 13
ci_015                 1.228715e-02 3 1  ON 14
ci_016                 1.255400e-02 3 1  ON 15
ci_017                 1.088300e-02 3 1  ON 16
ci_018                 1.078149e-02 3 1  ON 17
ci_019                -2.514322e-03 3 1  ON 18
ci_020                -2.423765e-03 3 1  ON 19
ci_021                -8.459776e-03 3 1  ON 20
ci_022                -8.657034e-03 3 1  ON 21
ci_023                 7.805043e-03 3 1  ON 22
ci_024                 8.041852e-03 3 1  ON 23
ci_025                 4.702642e-03 3 1  ON 24
ci_026                 4.273172e-03 3 1  ON 25
ci_027                 6.454089e-03 3 1  ON 26
ci_028                 6.476482e-03 3 1  ON 27
ci_029                -4.877820e-03 3 1  ON 28
ci_030                -4.785596e-03 3 1  ON 29
ci_031                -7.388694e-03 3 1  ON 30
ci_032                -8.123179e-03 3 1  ON 31
ci_033                 4.600637e-03 3 1  ON 32
ci_034                 4.413553e-03 3 1  ON 33
ci_035                 1.126907e-03 3 1  ON 34
ci_036                 1.043146e-03 3 1  ON 35
ci_037                 4.953347e-03 3 1  ON 36
ci_038                 5.099310e-03 3 1  ON 37
ci_039                 5.306386e-03 3 1  ON 38
ci_040                 5.323086e-03 3 1  ON 39
ci_041                 4.970499e-03 3 1  ON 40
ci_042                 5.231233e-03 3 1  ON 41
ci_043                 4.943052e-03 3 1  ON 42
ci_044                 4.944182e-03 3 1  ON 43
ci_045                 3.123967e-03 3 1  ON 44
ci_046                 3.174246e-03 3 1  ON 45
ci_047                -7.790222e-04 3 1  ON 46
ci_048                -5.616836e-04 3 1  ON 47
ci_049                 1.580289e-03 3 1  ON 48
ci_050                 1.792516e-03 3 1  ON 49
ci_051                -1.106651e-03 3 1  ON 50
ci_052                -1.243279e-03 3 1  ON 51
ci_053                -2.610471e-03 3 1  ON 52
ci_054                -2.301978e-03 3 1  ON 53
ci_055                -1.483475e-03 3 1  ON 54
ci_056                -1.376714e-03 3 1  ON 55
ci_057                -1.240708e-03 3 1  ON 56
ci_058                -1.731077e-03 3 1  ON 57
ci_059                 3.171692e-04 3 1  ON 58
ci_060                 1.414703e-04 3 1  ON 59
ci_061                -3.305088e-04 3 1  ON 60
ci_062                -9.499769e-06 3 1  ON 61
ci_063                -5.232922e-04 3 1  ON 62
ci_064                -8.918525e-04 3 1  ON 63
ci_065                -2.408143e-03 3 1  ON 64
ci_066                -2.435285e-03 3 1  ON 65
ci_067                -2.101084e-03 3 1  ON 66
ci_068                -2.473560e-03 3 1  ON 67
ci_069                -2.085964e-04 3 1  ON 68
ci_070                 1.328450e-04 3 1  ON 69
ci_071                -1.874230e-03 3 1  ON 70
ci_072                -1.959430e-03 3 1  ON 71
ci_073                 5.749021e-04 3 1  ON 72
ci_074                 2.857507e-04 3 1  ON 73
ci_075                -2.910323e-04 3 1  ON 74
ci_076                -2.990999e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="250">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =8000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 81
    time step          = 0.05
    reference energy   = -22.5206
    reference variance = 0.426701
====================================================
  Execution time = 1.0207e+02
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s081
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 62500 
  VMC Eavg = -2.2670e+01
  VMC Evar = 5.1268e-01
  Total weights = 7.8205e+06
  Execution time = 1.4846e+01
  </log>
</opt>
<opt stage="main" walkers="62500">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.497529708498
                                         uncertainty =       0.001925810417

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.497529708498
                                         uncertainty =       0.001925810417

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000249379995
  error estimate for blocks of size 2^( 2) =       0.000258257583
  error estimate for blocks of size 2^( 3) =       0.000266224371
  error estimate for blocks of size 2^( 4) =       0.000272017493
  error estimate for blocks of size 2^( 5) =       0.000275555089
  error estimate for blocks of size 2^( 6) =       0.000276866726
  error estimate for blocks of size 2^( 7) =       0.000278406801
  error estimate for blocks of size 2^( 8) =       0.000278051242
  error estimate for blocks of size 2^( 9) =       0.000277896046

      target function =                  N/A
              le_mean =     -22.669628983736
             les_mean =     514.424760857972
             stat err =       0.000277805204
             autocorr =       1.240959272384
              std dev =       0.705353142848
             le_variance =       0.497523056126

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.497529708498
                                         uncertainty =       0.001925810417

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.497529708498
                                         uncertainty =       0.001925810417

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000249379995
  error estimate for blocks of size 2^( 2) =       0.000258257583
  error estimate for blocks of size 2^( 3) =       0.000266224371
  error estimate for blocks of size 2^( 4) =       0.000272017493
  error estimate for blocks of size 2^( 5) =       0.000275555089
  error estimate for blocks of size 2^( 6) =       0.000276866726
  error estimate for blocks of size 2^( 7) =       0.000278406801
  error estimate for blocks of size 2^( 8) =       0.000278051242
  error estimate for blocks of size 2^( 9) =       0.000277896046

      target function =                  N/A
              le_mean =     -22.669628983736
             les_mean =     514.424760857972
             stat err =       0.000277805204
             autocorr =       1.240959272384
              std dev =       0.705353142848
             le_variance =       0.497523056126

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.497529708498
                                         uncertainty =       0.001925810417

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.497529708498
                                         uncertainty =       0.001925810417

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000249379995
  error estimate for blocks of size 2^( 2) =       0.000258257583
  error estimate for blocks of size 2^( 3) =       0.000266224371
  error estimate for blocks of size 2^( 4) =       0.000272017493
  error estimate for blocks of size 2^( 5) =       0.000275555089
  error estimate for blocks of size 2^( 6) =       0.000276866726
  error estimate for blocks of size 2^( 7) =       0.000278406801
  error estimate for blocks of size 2^( 8) =       0.000278051242
  error estimate for blocks of size 2^( 9) =       0.000277896046

      target function =                  N/A
              le_mean =     -22.669628983736
             les_mean =     514.424760857972
             stat err =       0.000277805204
             autocorr =       1.240959272384
              std dev =       0.705353142848
             le_variance =       0.497523056126

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.497529708498
                                         uncertainty =       0.001925810417

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.497529708498
                                         uncertainty =       0.001925810417

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000249379995
  error estimate for blocks of size 2^( 2) =       0.000258257583
  error estimate for blocks of size 2^( 3) =       0.000266224371
  error estimate for blocks of size 2^( 4) =       0.000272017493
  error estimate for blocks of size 2^( 5) =       0.000275555089
  error estimate for blocks of size 2^( 6) =       0.000276866726
  error estimate for blocks of size 2^( 7) =       0.000278406801
  error estimate for blocks of size 2^( 8) =       0.000278051242
  error estimate for blocks of size 2^( 9) =       0.000277896046

      target function =                  N/A
              le_mean =     -22.669628983736
             les_mean =     514.424760857972
             stat err =       0.000277805204
             autocorr =       1.240959272384
              std dev =       0.705353142848
             le_variance =       0.497523056126


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.669628983736        initial  <--
     1.3878e+23     1.3878e+24             1.4788e-27       -22.669628983736
     5.5511e+23     5.5511e+24             3.6970e-28       -22.669628983736
     2.2204e+24     2.2204e+25             9.2426e-29       -22.669628983736

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 177.7025
  </log>
  <optVariables href="FORM.s081.opt.xml">
ci_001                -7.050617e-01 3 1  ON 0
ci_002                -7.059926e-01 3 1  ON 1
ci_003                -3.765135e-02 3 1  ON 2
ci_004                -3.890325e-02 3 1  ON 3
ci_005                 1.612441e-02 3 1  ON 4
ci_006                 1.600090e-02 3 1  ON 5
ci_007                 1.228713e-02 3 1  ON 6
ci_008                 1.246533e-02 3 1  ON 7
ci_009                -1.173869e-02 3 1  ON 8
ci_010                -1.182876e-02 3 1  ON 9
ci_011                -8.176403e-03 3 1  ON 10
ci_012                -8.138278e-03 3 1  ON 11
ci_013                 9.647137e-03 3 1  ON 12
ci_014                 9.360580e-03 3 1  ON 13
ci_015                 1.228715e-02 3 1  ON 14
ci_016                 1.255400e-02 3 1  ON 15
ci_017                 1.088300e-02 3 1  ON 16
ci_018                 1.078149e-02 3 1  ON 17
ci_019                -2.514322e-03 3 1  ON 18
ci_020                -2.423765e-03 3 1  ON 19
ci_021                -8.459776e-03 3 1  ON 20
ci_022                -8.657034e-03 3 1  ON 21
ci_023                 7.805043e-03 3 1  ON 22
ci_024                 8.041852e-03 3 1  ON 23
ci_025                 4.702642e-03 3 1  ON 24
ci_026                 4.273172e-03 3 1  ON 25
ci_027                 6.454089e-03 3 1  ON 26
ci_028                 6.476482e-03 3 1  ON 27
ci_029                -4.877820e-03 3 1  ON 28
ci_030                -4.785596e-03 3 1  ON 29
ci_031                -7.388694e-03 3 1  ON 30
ci_032                -8.123179e-03 3 1  ON 31
ci_033                 4.600637e-03 3 1  ON 32
ci_034                 4.413553e-03 3 1  ON 33
ci_035                 1.126907e-03 3 1  ON 34
ci_036                 1.043146e-03 3 1  ON 35
ci_037                 4.953347e-03 3 1  ON 36
ci_038                 5.099310e-03 3 1  ON 37
ci_039                 5.306386e-03 3 1  ON 38
ci_040                 5.323086e-03 3 1  ON 39
ci_041                 4.970499e-03 3 1  ON 40
ci_042                 5.231233e-03 3 1  ON 41
ci_043                 4.943052e-03 3 1  ON 42
ci_044                 4.944182e-03 3 1  ON 43
ci_045                 3.123967e-03 3 1  ON 44
ci_046                 3.174246e-03 3 1  ON 45
ci_047                -7.790222e-04 3 1  ON 46
ci_048                -5.616836e-04 3 1  ON 47
ci_049                 1.580289e-03 3 1  ON 48
ci_050                 1.792516e-03 3 1  ON 49
ci_051                -1.106651e-03 3 1  ON 50
ci_052                -1.243279e-03 3 1  ON 51
ci_053                -2.610471e-03 3 1  ON 52
ci_054                -2.301978e-03 3 1  ON 53
ci_055                -1.483475e-03 3 1  ON 54
ci_056                -1.376714e-03 3 1  ON 55
ci_057                -1.240708e-03 3 1  ON 56
ci_058                -1.731077e-03 3 1  ON 57
ci_059                 3.171692e-04 3 1  ON 58
ci_060                 1.414703e-04 3 1  ON 59
ci_061                -3.305088e-04 3 1  ON 60
ci_062                -9.499769e-06 3 1  ON 61
ci_063                -5.232922e-04 3 1  ON 62
ci_064                -8.918525e-04 3 1  ON 63
ci_065                -2.408143e-03 3 1  ON 64
ci_066                -2.435285e-03 3 1  ON 65
ci_067                -2.101084e-03 3 1  ON 66
ci_068                -2.473560e-03 3 1  ON 67
ci_069                -2.085964e-04 3 1  ON 68
ci_070                 1.328450e-04 3 1  ON 69
ci_071                -1.874230e-03 3 1  ON 70
ci_072                -1.959430e-03 3 1  ON 71
ci_073                 5.749021e-04 3 1  ON 72
ci_074                 2.857507e-04 3 1  ON 73
ci_075                -2.910323e-04 3 1  ON 74
ci_076                -2.990999e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 2.9941e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s082 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s082 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=82  my_counter=0
  time step      = 5.0000e-02
  blocks         = 250
  steps          = 250
  substeps       = 10
  current        = 0
  target samples = 8.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">250</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">6.2500e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">8.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">6.2500e+04</parameter>
<parameter name="steps" condition="int">250</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2664e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="250">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =8000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 82
    time step          = 0.05
    reference energy   = -22.6674
    reference variance = 0.312775
====================================================
  Execution time = 1.0110e+02
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s082
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 62500 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 6.1109e+04
  VMC Eavg = -2.2670e+01
  VMC Evar = 5.1002e-01
  Total weights = 7.820203706e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.9211e+01
  </log>
</opt>
<opt stage="main" walkers="62500">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.495906910070
                                         uncertainty =       0.001479650333

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.495906910070
                                         uncertainty =       0.001479650333

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000248974818
  error estimate for blocks of size 2^( 2) =       0.000257949308
  error estimate for blocks of size 2^( 3) =       0.000265972521
  error estimate for blocks of size 2^( 4) =       0.000271912299
  error estimate for blocks of size 2^( 5) =       0.000275343971
  error estimate for blocks of size 2^( 6) =       0.000277120021
  error estimate for blocks of size 2^( 7) =       0.000278235349
  error estimate for blocks of size 2^( 8) =       0.000279011016
  error estimate for blocks of size 2^( 9) =       0.000280299645

      target function =                  N/A
              le_mean =     -22.670118020533
             les_mean =     514.444271470894
             stat err =       0.000278666508
             autocorr =       1.252733536664
              std dev =       0.704207128328
             le_variance =       0.495907679588


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.267011802053e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.3878e+24, overlap shift 1.3878e+25 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.670118020559       residual = 4.36e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.670118020559       residual = 6.22e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.670118020559       residual = 1.58e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.670118020559       residual = 1.42e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.670118331909       residual = 7.26e+03           smallest_sin_value = 1.00e+00
davidson iteration    5 stopping due to too large eigenvalue change
davidson solver did not converge after          5 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 1.3878e+24 is 1.826245e-28

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 5.5511e+24, overlap shift 5.5511e+25 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.670118020559       residual = 4.36e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.670118020559       residual = 6.22e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.670118020559       residual = 1.58e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.670118020558       residual = 1.42e-06           smallest_sin_value = 1.00e+00
davidson iteration    4 stopping due to too large eigenvalue change
davidson solver did not converge after          4 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 5.5511e+24 is 4.565612e-29

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 2.2204e+25, overlap shift 2.2204e+26 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.670118020559       residual = 4.36e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.670118020559       residual = 6.22e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.670118020559       residual = 4.36e-05           smallest_sin_value = 1.00e+00
davidson iteration    3: stopping due to imaginary component in cost function
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 2.2204e+25 is 1.136276e-29

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.178389 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.2032e+02
  </log>
  <optVariables href="FORM.s082.opt.xml">
ci_001                -7.050617e-01 3 1  ON 0
ci_002                -7.059926e-01 3 1  ON 1
ci_003                -3.765135e-02 3 1  ON 2
ci_004                -3.890325e-02 3 1  ON 3
ci_005                 1.612441e-02 3 1  ON 4
ci_006                 1.600090e-02 3 1  ON 5
ci_007                 1.228713e-02 3 1  ON 6
ci_008                 1.246533e-02 3 1  ON 7
ci_009                -1.173869e-02 3 1  ON 8
ci_010                -1.182876e-02 3 1  ON 9
ci_011                -8.176403e-03 3 1  ON 10
ci_012                -8.138278e-03 3 1  ON 11
ci_013                 9.647137e-03 3 1  ON 12
ci_014                 9.360580e-03 3 1  ON 13
ci_015                 1.228715e-02 3 1  ON 14
ci_016                 1.255400e-02 3 1  ON 15
ci_017                 1.088300e-02 3 1  ON 16
ci_018                 1.078149e-02 3 1  ON 17
ci_019                -2.514322e-03 3 1  ON 18
ci_020                -2.423765e-03 3 1  ON 19
ci_021                -8.459776e-03 3 1  ON 20
ci_022                -8.657034e-03 3 1  ON 21
ci_023                 7.805043e-03 3 1  ON 22
ci_024                 8.041852e-03 3 1  ON 23
ci_025                 4.702642e-03 3 1  ON 24
ci_026                 4.273172e-03 3 1  ON 25
ci_027                 6.454089e-03 3 1  ON 26
ci_028                 6.476482e-03 3 1  ON 27
ci_029                -4.877820e-03 3 1  ON 28
ci_030                -4.785596e-03 3 1  ON 29
ci_031                -7.388694e-03 3 1  ON 30
ci_032                -8.123179e-03 3 1  ON 31
ci_033                 4.600637e-03 3 1  ON 32
ci_034                 4.413553e-03 3 1  ON 33
ci_035                 1.126907e-03 3 1  ON 34
ci_036                 1.043146e-03 3 1  ON 35
ci_037                 4.953347e-03 3 1  ON 36
ci_038                 5.099310e-03 3 1  ON 37
ci_039                 5.306386e-03 3 1  ON 38
ci_040                 5.323086e-03 3 1  ON 39
ci_041                 4.970499e-03 3 1  ON 40
ci_042                 5.231233e-03 3 1  ON 41
ci_043                 4.943052e-03 3 1  ON 42
ci_044                 4.944182e-03 3 1  ON 43
ci_045                 3.123967e-03 3 1  ON 44
ci_046                 3.174246e-03 3 1  ON 45
ci_047                -7.790222e-04 3 1  ON 46
ci_048                -5.616836e-04 3 1  ON 47
ci_049                 1.580289e-03 3 1  ON 48
ci_050                 1.792516e-03 3 1  ON 49
ci_051                -1.106651e-03 3 1  ON 50
ci_052                -1.243279e-03 3 1  ON 51
ci_053                -2.610471e-03 3 1  ON 52
ci_054                -2.301978e-03 3 1  ON 53
ci_055                -1.483475e-03 3 1  ON 54
ci_056                -1.376714e-03 3 1  ON 55
ci_057                -1.240708e-03 3 1  ON 56
ci_058                -1.731077e-03 3 1  ON 57
ci_059                 3.171692e-04 3 1  ON 58
ci_060                 1.414703e-04 3 1  ON 59
ci_061                -3.305088e-04 3 1  ON 60
ci_062                -9.499769e-06 3 1  ON 61
ci_063                -5.232922e-04 3 1  ON 62
ci_064                -8.918525e-04 3 1  ON 63
ci_065                -2.408143e-03 3 1  ON 64
ci_066                -2.435285e-03 3 1  ON 65
ci_067                -2.101084e-03 3 1  ON 66
ci_068                -2.473560e-03 3 1  ON 67
ci_069                -2.085964e-04 3 1  ON 68
ci_070                 1.328450e-04 3 1  ON 69
ci_071                -1.874230e-03 3 1  ON 70
ci_072                -1.959430e-03 3 1  ON 71
ci_073                 5.749021e-04 3 1  ON 72
ci_074                 2.857507e-04 3 1  ON 73
ci_075                -2.910323e-04 3 1  ON 74
ci_076                -2.990999e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="250">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =8000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 82
    time step          = 0.05
    reference energy   = -22.6644
    reference variance = 0.504093
====================================================
  Execution time = 1.0058e+02
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s082
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 62500 
  VMC Eavg = -2.2670e+01
  VMC Evar = 5.0955e-01
  Total weights = 7.8202e+06
  Execution time = 1.4807e+01
  </log>
</opt>
<opt stage="main" walkers="62500">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.495133970558
                                         uncertainty =       0.001589830100

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.495133970558
                                         uncertainty =       0.001589830100

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000248780941
  error estimate for blocks of size 2^( 2) =       0.000257722560
  error estimate for blocks of size 2^( 3) =       0.000265800461
  error estimate for blocks of size 2^( 4) =       0.000271621386
  error estimate for blocks of size 2^( 5) =       0.000274399289
  error estimate for blocks of size 2^( 6) =       0.000275984397
  error estimate for blocks of size 2^( 7) =       0.000277229755
  error estimate for blocks of size 2^( 8) =       0.000278549931
  error estimate for blocks of size 2^( 9) =       0.000279721465

      target function =                  N/A
              le_mean =     -22.669635153302
             les_mean =     514.421904010511
             stat err =       0.000277871387
             autocorr =       1.247537026971
              std dev =       0.703658763040
             le_variance =       0.495135654802

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.495133970558
                                         uncertainty =       0.001589830100

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.495133970558
                                         uncertainty =       0.001589830100

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000248780941
  error estimate for blocks of size 2^( 2) =       0.000257722560
  error estimate for blocks of size 2^( 3) =       0.000265800461
  error estimate for blocks of size 2^( 4) =       0.000271621386
  error estimate for blocks of size 2^( 5) =       0.000274399289
  error estimate for blocks of size 2^( 6) =       0.000275984397
  error estimate for blocks of size 2^( 7) =       0.000277229755
  error estimate for blocks of size 2^( 8) =       0.000278549931
  error estimate for blocks of size 2^( 9) =       0.000279721465

      target function =                  N/A
              le_mean =     -22.669635153302
             les_mean =     514.421904010511
             stat err =       0.000277871387
             autocorr =       1.247537026971
              std dev =       0.703658763040
             le_variance =       0.495135654802

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.495133970558
                                         uncertainty =       0.001589830100

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.495133970558
                                         uncertainty =       0.001589830100

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000248780941
  error estimate for blocks of size 2^( 2) =       0.000257722560
  error estimate for blocks of size 2^( 3) =       0.000265800461
  error estimate for blocks of size 2^( 4) =       0.000271621386
  error estimate for blocks of size 2^( 5) =       0.000274399289
  error estimate for blocks of size 2^( 6) =       0.000275984397
  error estimate for blocks of size 2^( 7) =       0.000277229755
  error estimate for blocks of size 2^( 8) =       0.000278549931
  error estimate for blocks of size 2^( 9) =       0.000279721465

      target function =                  N/A
              le_mean =     -22.669635153302
             les_mean =     514.421904010511
             stat err =       0.000277871387
             autocorr =       1.247537026971
              std dev =       0.703658763040
             le_variance =       0.495135654802

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.495133970558
                                         uncertainty =       0.001589830100

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.495133970558
                                         uncertainty =       0.001589830100

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000248780941
  error estimate for blocks of size 2^( 2) =       0.000257722560
  error estimate for blocks of size 2^( 3) =       0.000265800461
  error estimate for blocks of size 2^( 4) =       0.000271621386
  error estimate for blocks of size 2^( 5) =       0.000274399289
  error estimate for blocks of size 2^( 6) =       0.000275984397
  error estimate for blocks of size 2^( 7) =       0.000277229755
  error estimate for blocks of size 2^( 8) =       0.000278549931
  error estimate for blocks of size 2^( 9) =       0.000279721465

      target function =                  N/A
              le_mean =     -22.669635153302
             les_mean =     514.421904010511
             stat err =       0.000277871387
             autocorr =       1.247537026971
              std dev =       0.703658763040
             le_variance =       0.495135654802


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.669635153302        initial  <--
     1.3878e+24     1.3878e+25             1.8262e-28       -22.669635153302
     5.5511e+24     5.5511e+25             4.5656e-29       -22.669635153302
     2.2204e+25     2.2204e+26             1.1363e-29       -22.669635153302

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 174.4936
  </log>
  <optVariables href="FORM.s082.opt.xml">
ci_001                -7.050617e-01 3 1  ON 0
ci_002                -7.059926e-01 3 1  ON 1
ci_003                -3.765135e-02 3 1  ON 2
ci_004                -3.890325e-02 3 1  ON 3
ci_005                 1.612441e-02 3 1  ON 4
ci_006                 1.600090e-02 3 1  ON 5
ci_007                 1.228713e-02 3 1  ON 6
ci_008                 1.246533e-02 3 1  ON 7
ci_009                -1.173869e-02 3 1  ON 8
ci_010                -1.182876e-02 3 1  ON 9
ci_011                -8.176403e-03 3 1  ON 10
ci_012                -8.138278e-03 3 1  ON 11
ci_013                 9.647137e-03 3 1  ON 12
ci_014                 9.360580e-03 3 1  ON 13
ci_015                 1.228715e-02 3 1  ON 14
ci_016                 1.255400e-02 3 1  ON 15
ci_017                 1.088300e-02 3 1  ON 16
ci_018                 1.078149e-02 3 1  ON 17
ci_019                -2.514322e-03 3 1  ON 18
ci_020                -2.423765e-03 3 1  ON 19
ci_021                -8.459776e-03 3 1  ON 20
ci_022                -8.657034e-03 3 1  ON 21
ci_023                 7.805043e-03 3 1  ON 22
ci_024                 8.041852e-03 3 1  ON 23
ci_025                 4.702642e-03 3 1  ON 24
ci_026                 4.273172e-03 3 1  ON 25
ci_027                 6.454089e-03 3 1  ON 26
ci_028                 6.476482e-03 3 1  ON 27
ci_029                -4.877820e-03 3 1  ON 28
ci_030                -4.785596e-03 3 1  ON 29
ci_031                -7.388694e-03 3 1  ON 30
ci_032                -8.123179e-03 3 1  ON 31
ci_033                 4.600637e-03 3 1  ON 32
ci_034                 4.413553e-03 3 1  ON 33
ci_035                 1.126907e-03 3 1  ON 34
ci_036                 1.043146e-03 3 1  ON 35
ci_037                 4.953347e-03 3 1  ON 36
ci_038                 5.099310e-03 3 1  ON 37
ci_039                 5.306386e-03 3 1  ON 38
ci_040                 5.323086e-03 3 1  ON 39
ci_041                 4.970499e-03 3 1  ON 40
ci_042                 5.231233e-03 3 1  ON 41
ci_043                 4.943052e-03 3 1  ON 42
ci_044                 4.944182e-03 3 1  ON 43
ci_045                 3.123967e-03 3 1  ON 44
ci_046                 3.174246e-03 3 1  ON 45
ci_047                -7.790222e-04 3 1  ON 46
ci_048                -5.616836e-04 3 1  ON 47
ci_049                 1.580289e-03 3 1  ON 48
ci_050                 1.792516e-03 3 1  ON 49
ci_051                -1.106651e-03 3 1  ON 50
ci_052                -1.243279e-03 3 1  ON 51
ci_053                -2.610471e-03 3 1  ON 52
ci_054                -2.301978e-03 3 1  ON 53
ci_055                -1.483475e-03 3 1  ON 54
ci_056                -1.376714e-03 3 1  ON 55
ci_057                -1.240708e-03 3 1  ON 56
ci_058                -1.731077e-03 3 1  ON 57
ci_059                 3.171692e-04 3 1  ON 58
ci_060                 1.414703e-04 3 1  ON 59
ci_061                -3.305088e-04 3 1  ON 60
ci_062                -9.499769e-06 3 1  ON 61
ci_063                -5.232922e-04 3 1  ON 62
ci_064                -8.918525e-04 3 1  ON 63
ci_065                -2.408143e-03 3 1  ON 64
ci_066                -2.435285e-03 3 1  ON 65
ci_067                -2.101084e-03 3 1  ON 66
ci_068                -2.473560e-03 3 1  ON 67
ci_069                -2.085964e-04 3 1  ON 68
ci_070                 1.328450e-04 3 1  ON 69
ci_071                -1.874230e-03 3 1  ON 70
ci_072                -1.959430e-03 3 1  ON 71
ci_073                 5.749021e-04 3 1  ON 72
ci_074                 2.857507e-04 3 1  ON 73
ci_075                -2.910323e-04 3 1  ON 74
ci_076                -2.990999e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 2.9482e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s083 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s083 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=83  my_counter=0
  time step      = 5.0000e-02
  blocks         = 250
  steps          = 250
  substeps       = 10
  current        = 0
  target samples = 8.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">250</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">6.2500e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">8.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">6.2500e+04</parameter>
<parameter name="steps" condition="int">250</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2664e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="250">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =8000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 83
    time step          = 0.05
    reference energy   = -22.7238
    reference variance = 0.552317
====================================================
  Execution time = 1.0149e+02
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s083
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 62500 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 6.1197e+04
  VMC Eavg = -2.2670e+01
  VMC Evar = 5.1016e-01
  Total weights = 7.820943440e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.9289e+01
  </log>
</opt>
<opt stage="main" walkers="62500">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.496923505289
                                         uncertainty =       0.001559522245

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.496923505289
                                         uncertainty =       0.001559522245

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000249229847
  error estimate for blocks of size 2^( 2) =       0.000258195549
  error estimate for blocks of size 2^( 3) =       0.000266279355
  error estimate for blocks of size 2^( 4) =       0.000272081456
  error estimate for blocks of size 2^( 5) =       0.000275617647
  error estimate for blocks of size 2^( 6) =       0.000276889660
  error estimate for blocks of size 2^( 7) =       0.000277485988
  error estimate for blocks of size 2^( 8) =       0.000278124596
  error estimate for blocks of size 2^( 9) =       0.000278913559

      target function =                  N/A
              le_mean =     -22.669954563324
             les_mean =     514.437000308953
             stat err =       0.000277853451
             autocorr =       1.242886554467
              std dev =       0.704928458151
             le_variance =       0.496924131111


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266995456332e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.3878e+25, overlap shift 1.3878e+26 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.669954563351       residual = 4.12e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.669954563351       residual = 7.32e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.669954563351       residual = 3.33e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.669954563351       residual = 1.28e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.669954563346       residual = 2.87e-03           smallest_sin_value = 1.00e+00
davidson iteration    5 stopping due to too large eigenvalue change
davidson solver did not converge after          5 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 1.3878e+25 is 1.571651e-29

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 5.5511e+25, overlap shift 5.5511e+26 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.669954563351       residual = 4.12e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.669954563351       residual = 7.32e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.669954563351       residual = 3.33e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.669954563351       residual = 4.12e-05           smallest_sin_value = 1.00e+00
davidson iteration    4 stopping due to too large eigenvalue change
davidson solver did not converge after          4 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 5.5511e+25 is 3.929128e-30

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 2.2204e+26, overlap shift 2.2204e+27 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.669954563351       residual = 4.12e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.669954563351       residual = 7.32e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.669954563351       residual = 3.33e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.669954563349       residual = 5.92e-06           smallest_sin_value = 1.00e+00
davidson iteration    4 stopping due to too large eigenvalue change
davidson solver did not converge after          4 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 2.2204e+26 is 9.822820e-31

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.180193 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.2079e+02
  </log>
  <optVariables href="FORM.s083.opt.xml">
ci_001                -7.050617e-01 3 1  ON 0
ci_002                -7.059926e-01 3 1  ON 1
ci_003                -3.765135e-02 3 1  ON 2
ci_004                -3.890325e-02 3 1  ON 3
ci_005                 1.612441e-02 3 1  ON 4
ci_006                 1.600090e-02 3 1  ON 5
ci_007                 1.228713e-02 3 1  ON 6
ci_008                 1.246533e-02 3 1  ON 7
ci_009                -1.173869e-02 3 1  ON 8
ci_010                -1.182876e-02 3 1  ON 9
ci_011                -8.176403e-03 3 1  ON 10
ci_012                -8.138278e-03 3 1  ON 11
ci_013                 9.647137e-03 3 1  ON 12
ci_014                 9.360580e-03 3 1  ON 13
ci_015                 1.228715e-02 3 1  ON 14
ci_016                 1.255400e-02 3 1  ON 15
ci_017                 1.088300e-02 3 1  ON 16
ci_018                 1.078149e-02 3 1  ON 17
ci_019                -2.514322e-03 3 1  ON 18
ci_020                -2.423765e-03 3 1  ON 19
ci_021                -8.459776e-03 3 1  ON 20
ci_022                -8.657034e-03 3 1  ON 21
ci_023                 7.805043e-03 3 1  ON 22
ci_024                 8.041852e-03 3 1  ON 23
ci_025                 4.702642e-03 3 1  ON 24
ci_026                 4.273172e-03 3 1  ON 25
ci_027                 6.454089e-03 3 1  ON 26
ci_028                 6.476482e-03 3 1  ON 27
ci_029                -4.877820e-03 3 1  ON 28
ci_030                -4.785596e-03 3 1  ON 29
ci_031                -7.388694e-03 3 1  ON 30
ci_032                -8.123179e-03 3 1  ON 31
ci_033                 4.600637e-03 3 1  ON 32
ci_034                 4.413553e-03 3 1  ON 33
ci_035                 1.126907e-03 3 1  ON 34
ci_036                 1.043146e-03 3 1  ON 35
ci_037                 4.953347e-03 3 1  ON 36
ci_038                 5.099310e-03 3 1  ON 37
ci_039                 5.306386e-03 3 1  ON 38
ci_040                 5.323086e-03 3 1  ON 39
ci_041                 4.970499e-03 3 1  ON 40
ci_042                 5.231233e-03 3 1  ON 41
ci_043                 4.943052e-03 3 1  ON 42
ci_044                 4.944182e-03 3 1  ON 43
ci_045                 3.123967e-03 3 1  ON 44
ci_046                 3.174246e-03 3 1  ON 45
ci_047                -7.790222e-04 3 1  ON 46
ci_048                -5.616836e-04 3 1  ON 47
ci_049                 1.580289e-03 3 1  ON 48
ci_050                 1.792516e-03 3 1  ON 49
ci_051                -1.106651e-03 3 1  ON 50
ci_052                -1.243279e-03 3 1  ON 51
ci_053                -2.610471e-03 3 1  ON 52
ci_054                -2.301978e-03 3 1  ON 53
ci_055                -1.483475e-03 3 1  ON 54
ci_056                -1.376714e-03 3 1  ON 55
ci_057                -1.240708e-03 3 1  ON 56
ci_058                -1.731077e-03 3 1  ON 57
ci_059                 3.171692e-04 3 1  ON 58
ci_060                 1.414703e-04 3 1  ON 59
ci_061                -3.305088e-04 3 1  ON 60
ci_062                -9.499769e-06 3 1  ON 61
ci_063                -5.232922e-04 3 1  ON 62
ci_064                -8.918525e-04 3 1  ON 63
ci_065                -2.408143e-03 3 1  ON 64
ci_066                -2.435285e-03 3 1  ON 65
ci_067                -2.101084e-03 3 1  ON 66
ci_068                -2.473560e-03 3 1  ON 67
ci_069                -2.085964e-04 3 1  ON 68
ci_070                 1.328450e-04 3 1  ON 69
ci_071                -1.874230e-03 3 1  ON 70
ci_072                -1.959430e-03 3 1  ON 71
ci_073                 5.749021e-04 3 1  ON 72
ci_074                 2.857507e-04 3 1  ON 73
ci_075                -2.910323e-04 3 1  ON 74
ci_076                -2.990999e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="250">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =8000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 83
    time step          = 0.05
    reference energy   = -22.6062
    reference variance = 0.372944
====================================================
  Execution time = 1.0010e+02
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s083
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 62500 
  VMC Eavg = -2.2670e+01
  VMC Evar = 5.1150e-01
  Total weights = 7.8199e+06
  Execution time = 1.4640e+01
  </log>
</opt>
<opt stage="main" walkers="62500">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.498384374951
                                         uncertainty =       0.001566488600

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.498384374951
                                         uncertainty =       0.001566488600

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000249595446
  error estimate for blocks of size 2^( 2) =       0.000258662978
  error estimate for blocks of size 2^( 3) =       0.000266630623
  error estimate for blocks of size 2^( 4) =       0.000272331943
  error estimate for blocks of size 2^( 5) =       0.000275597365
  error estimate for blocks of size 2^( 6) =       0.000277391322
  error estimate for blocks of size 2^( 7) =       0.000278552040
  error estimate for blocks of size 2^( 8) =       0.000277858831
  error estimate for blocks of size 2^( 9) =       0.000277865027

      target function =                  N/A
              le_mean =     -22.670218234547
             les_mean =     514.450295807771
             stat err =       0.000277916805
             autocorr =       1.239813331812
              std dev =       0.705962529955
             le_variance =       0.498383093700

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.498384374951
                                         uncertainty =       0.001566488600

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.498384374951
                                         uncertainty =       0.001566488600

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000249595446
  error estimate for blocks of size 2^( 2) =       0.000258662978
  error estimate for blocks of size 2^( 3) =       0.000266630623
  error estimate for blocks of size 2^( 4) =       0.000272331943
  error estimate for blocks of size 2^( 5) =       0.000275597365
  error estimate for blocks of size 2^( 6) =       0.000277391322
  error estimate for blocks of size 2^( 7) =       0.000278552040
  error estimate for blocks of size 2^( 8) =       0.000277858831
  error estimate for blocks of size 2^( 9) =       0.000277865027

      target function =                  N/A
              le_mean =     -22.670218234547
             les_mean =     514.450295807771
             stat err =       0.000277916805
             autocorr =       1.239813331812
              std dev =       0.705962529955
             le_variance =       0.498383093700

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.498384374951
                                         uncertainty =       0.001566488600

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.498384374951
                                         uncertainty =       0.001566488600

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000249595446
  error estimate for blocks of size 2^( 2) =       0.000258662978
  error estimate for blocks of size 2^( 3) =       0.000266630623
  error estimate for blocks of size 2^( 4) =       0.000272331943
  error estimate for blocks of size 2^( 5) =       0.000275597365
  error estimate for blocks of size 2^( 6) =       0.000277391322
  error estimate for blocks of size 2^( 7) =       0.000278552040
  error estimate for blocks of size 2^( 8) =       0.000277858831
  error estimate for blocks of size 2^( 9) =       0.000277865027

      target function =                  N/A
              le_mean =     -22.670218234547
             les_mean =     514.450295807771
             stat err =       0.000277916805
             autocorr =       1.239813331812
              std dev =       0.705962529955
             le_variance =       0.498383093700

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.498384374951
                                         uncertainty =       0.001566488600

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.498384374951
                                         uncertainty =       0.001566488600

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000249595446
  error estimate for blocks of size 2^( 2) =       0.000258662978
  error estimate for blocks of size 2^( 3) =       0.000266630623
  error estimate for blocks of size 2^( 4) =       0.000272331943
  error estimate for blocks of size 2^( 5) =       0.000275597365
  error estimate for blocks of size 2^( 6) =       0.000277391322
  error estimate for blocks of size 2^( 7) =       0.000278552040
  error estimate for blocks of size 2^( 8) =       0.000277858831
  error estimate for blocks of size 2^( 9) =       0.000277865027

      target function =                  N/A
              le_mean =     -22.670218234547
             les_mean =     514.450295807771
             stat err =       0.000277916805
             autocorr =       1.239813331812
              std dev =       0.705962529955
             le_variance =       0.498383093700


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.670218234547        initial  <--
     1.3878e+25     1.3878e+26             1.5717e-29       -22.670218234547
     5.5511e+25     5.5511e+26             3.9291e-30       -22.670218234547
     2.2204e+26     2.2204e+27             9.8228e-31       -22.670218234547

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 173.9928
  </log>
  <optVariables href="FORM.s083.opt.xml">
ci_001                -7.050617e-01 3 1  ON 0
ci_002                -7.059926e-01 3 1  ON 1
ci_003                -3.765135e-02 3 1  ON 2
ci_004                -3.890325e-02 3 1  ON 3
ci_005                 1.612441e-02 3 1  ON 4
ci_006                 1.600090e-02 3 1  ON 5
ci_007                 1.228713e-02 3 1  ON 6
ci_008                 1.246533e-02 3 1  ON 7
ci_009                -1.173869e-02 3 1  ON 8
ci_010                -1.182876e-02 3 1  ON 9
ci_011                -8.176403e-03 3 1  ON 10
ci_012                -8.138278e-03 3 1  ON 11
ci_013                 9.647137e-03 3 1  ON 12
ci_014                 9.360580e-03 3 1  ON 13
ci_015                 1.228715e-02 3 1  ON 14
ci_016                 1.255400e-02 3 1  ON 15
ci_017                 1.088300e-02 3 1  ON 16
ci_018                 1.078149e-02 3 1  ON 17
ci_019                -2.514322e-03 3 1  ON 18
ci_020                -2.423765e-03 3 1  ON 19
ci_021                -8.459776e-03 3 1  ON 20
ci_022                -8.657034e-03 3 1  ON 21
ci_023                 7.805043e-03 3 1  ON 22
ci_024                 8.041852e-03 3 1  ON 23
ci_025                 4.702642e-03 3 1  ON 24
ci_026                 4.273172e-03 3 1  ON 25
ci_027                 6.454089e-03 3 1  ON 26
ci_028                 6.476482e-03 3 1  ON 27
ci_029                -4.877820e-03 3 1  ON 28
ci_030                -4.785596e-03 3 1  ON 29
ci_031                -7.388694e-03 3 1  ON 30
ci_032                -8.123179e-03 3 1  ON 31
ci_033                 4.600637e-03 3 1  ON 32
ci_034                 4.413553e-03 3 1  ON 33
ci_035                 1.126907e-03 3 1  ON 34
ci_036                 1.043146e-03 3 1  ON 35
ci_037                 4.953347e-03 3 1  ON 36
ci_038                 5.099310e-03 3 1  ON 37
ci_039                 5.306386e-03 3 1  ON 38
ci_040                 5.323086e-03 3 1  ON 39
ci_041                 4.970499e-03 3 1  ON 40
ci_042                 5.231233e-03 3 1  ON 41
ci_043                 4.943052e-03 3 1  ON 42
ci_044                 4.944182e-03 3 1  ON 43
ci_045                 3.123967e-03 3 1  ON 44
ci_046                 3.174246e-03 3 1  ON 45
ci_047                -7.790222e-04 3 1  ON 46
ci_048                -5.616836e-04 3 1  ON 47
ci_049                 1.580289e-03 3 1  ON 48
ci_050                 1.792516e-03 3 1  ON 49
ci_051                -1.106651e-03 3 1  ON 50
ci_052                -1.243279e-03 3 1  ON 51
ci_053                -2.610471e-03 3 1  ON 52
ci_054                -2.301978e-03 3 1  ON 53
ci_055                -1.483475e-03 3 1  ON 54
ci_056                -1.376714e-03 3 1  ON 55
ci_057                -1.240708e-03 3 1  ON 56
ci_058                -1.731077e-03 3 1  ON 57
ci_059                 3.171692e-04 3 1  ON 58
ci_060                 1.414703e-04 3 1  ON 59
ci_061                -3.305088e-04 3 1  ON 60
ci_062                -9.499769e-06 3 1  ON 61
ci_063                -5.232922e-04 3 1  ON 62
ci_064                -8.918525e-04 3 1  ON 63
ci_065                -2.408143e-03 3 1  ON 64
ci_066                -2.435285e-03 3 1  ON 65
ci_067                -2.101084e-03 3 1  ON 66
ci_068                -2.473560e-03 3 1  ON 67
ci_069                -2.085964e-04 3 1  ON 68
ci_070                 1.328450e-04 3 1  ON 69
ci_071                -1.874230e-03 3 1  ON 70
ci_072                -1.959430e-03 3 1  ON 71
ci_073                 5.749021e-04 3 1  ON 72
ci_074                 2.857507e-04 3 1  ON 73
ci_075                -2.910323e-04 3 1  ON 74
ci_076                -2.990999e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 2.9481e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s084 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s084 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=84  my_counter=0
  time step      = 5.0000e-02
  blocks         = 250
  steps          = 250
  substeps       = 10
  current        = 0
  target samples = 8.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">250</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">6.2500e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">8.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">6.2500e+04</parameter>
<parameter name="steps" condition="int">250</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2664e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="250">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =8000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 84
    time step          = 0.05
    reference energy   = -22.6286
    reference variance = 0.44242
====================================================
  Execution time = 1.0049e+02
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s084
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 62500 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 6.1104e+04
  VMC Eavg = -2.2670e+01
  VMC Evar = 5.0554e-01
  Total weights = 7.820230237e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.8985e+01
  </log>
</opt>
<opt stage="main" walkers="62500">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.493248798365
                                         uncertainty =       0.001346304863

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.493248798365
                                         uncertainty =       0.001346304863

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000248306598
  error estimate for blocks of size 2^( 2) =       0.000257251162
  error estimate for blocks of size 2^( 3) =       0.000265173765
  error estimate for blocks of size 2^( 4) =       0.000271019720
  error estimate for blocks of size 2^( 5) =       0.000274647440
  error estimate for blocks of size 2^( 6) =       0.000276622077
  error estimate for blocks of size 2^( 7) =       0.000277063617
  error estimate for blocks of size 2^( 8) =       0.000278774222
  error estimate for blocks of size 2^( 9) =       0.000278764427

      target function =                  N/A
              le_mean =     -22.669706507523
             les_mean =     514.421136746367
             stat err =       0.000277806086
             autocorr =       1.251719420806
              std dev =       0.702317117824
             le_variance =       0.493249333989


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266970650752e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.3878e+26, overlap shift 1.3878e+27 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.669706507544       residual = 2.84e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.669706507544       residual = 2.84e-05           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 1.3878e+26 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 5.5511e+26, overlap shift 5.5511e+27 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.669706507544       residual = 2.84e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.669706507544       residual = 2.84e-05           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 5.5511e+26 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 2.2204e+27, overlap shift 2.2204e+28 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.669706507544       residual = 2.84e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.669706507544       residual = 2.84e-05           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 2.2204e+27 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.181450 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.1949e+02
  </log>
  <optVariables href="FORM.s084.opt.xml">
ci_001                -7.050617e-01 3 1  ON 0
ci_002                -7.059926e-01 3 1  ON 1
ci_003                -3.765135e-02 3 1  ON 2
ci_004                -3.890325e-02 3 1  ON 3
ci_005                 1.612441e-02 3 1  ON 4
ci_006                 1.600090e-02 3 1  ON 5
ci_007                 1.228713e-02 3 1  ON 6
ci_008                 1.246533e-02 3 1  ON 7
ci_009                -1.173869e-02 3 1  ON 8
ci_010                -1.182876e-02 3 1  ON 9
ci_011                -8.176403e-03 3 1  ON 10
ci_012                -8.138278e-03 3 1  ON 11
ci_013                 9.647137e-03 3 1  ON 12
ci_014                 9.360580e-03 3 1  ON 13
ci_015                 1.228715e-02 3 1  ON 14
ci_016                 1.255400e-02 3 1  ON 15
ci_017                 1.088300e-02 3 1  ON 16
ci_018                 1.078149e-02 3 1  ON 17
ci_019                -2.514322e-03 3 1  ON 18
ci_020                -2.423765e-03 3 1  ON 19
ci_021                -8.459776e-03 3 1  ON 20
ci_022                -8.657034e-03 3 1  ON 21
ci_023                 7.805043e-03 3 1  ON 22
ci_024                 8.041852e-03 3 1  ON 23
ci_025                 4.702642e-03 3 1  ON 24
ci_026                 4.273172e-03 3 1  ON 25
ci_027                 6.454089e-03 3 1  ON 26
ci_028                 6.476482e-03 3 1  ON 27
ci_029                -4.877820e-03 3 1  ON 28
ci_030                -4.785596e-03 3 1  ON 29
ci_031                -7.388694e-03 3 1  ON 30
ci_032                -8.123179e-03 3 1  ON 31
ci_033                 4.600637e-03 3 1  ON 32
ci_034                 4.413553e-03 3 1  ON 33
ci_035                 1.126907e-03 3 1  ON 34
ci_036                 1.043146e-03 3 1  ON 35
ci_037                 4.953347e-03 3 1  ON 36
ci_038                 5.099310e-03 3 1  ON 37
ci_039                 5.306386e-03 3 1  ON 38
ci_040                 5.323086e-03 3 1  ON 39
ci_041                 4.970499e-03 3 1  ON 40
ci_042                 5.231233e-03 3 1  ON 41
ci_043                 4.943052e-03 3 1  ON 42
ci_044                 4.944182e-03 3 1  ON 43
ci_045                 3.123967e-03 3 1  ON 44
ci_046                 3.174246e-03 3 1  ON 45
ci_047                -7.790222e-04 3 1  ON 46
ci_048                -5.616836e-04 3 1  ON 47
ci_049                 1.580289e-03 3 1  ON 48
ci_050                 1.792516e-03 3 1  ON 49
ci_051                -1.106651e-03 3 1  ON 50
ci_052                -1.243279e-03 3 1  ON 51
ci_053                -2.610471e-03 3 1  ON 52
ci_054                -2.301978e-03 3 1  ON 53
ci_055                -1.483475e-03 3 1  ON 54
ci_056                -1.376714e-03 3 1  ON 55
ci_057                -1.240708e-03 3 1  ON 56
ci_058                -1.731077e-03 3 1  ON 57
ci_059                 3.171692e-04 3 1  ON 58
ci_060                 1.414703e-04 3 1  ON 59
ci_061                -3.305088e-04 3 1  ON 60
ci_062                -9.499769e-06 3 1  ON 61
ci_063                -5.232922e-04 3 1  ON 62
ci_064                -8.918525e-04 3 1  ON 63
ci_065                -2.408143e-03 3 1  ON 64
ci_066                -2.435285e-03 3 1  ON 65
ci_067                -2.101084e-03 3 1  ON 66
ci_068                -2.473560e-03 3 1  ON 67
ci_069                -2.085964e-04 3 1  ON 68
ci_070                 1.328450e-04 3 1  ON 69
ci_071                -1.874230e-03 3 1  ON 70
ci_072                -1.959430e-03 3 1  ON 71
ci_073                 5.749021e-04 3 1  ON 72
ci_074                 2.857507e-04 3 1  ON 73
ci_075                -2.910323e-04 3 1  ON 74
ci_076                -2.990999e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="250">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =8000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 84
    time step          = 0.05
    reference energy   = -22.6779
    reference variance = 0.324721
====================================================
  Execution time = 9.9791e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s084
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 62500 
  VMC Eavg = -2.2670e+01
  VMC Evar = 5.0590e-01
  Total weights = 7.8210e+06
  Execution time = 1.4656e+01
  </log>
</opt>
<opt stage="main" walkers="62500">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.493543470333
                                         uncertainty =       0.001209226861

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.493543470333
                                         uncertainty =       0.001209226861

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000248381376
  error estimate for blocks of size 2^( 2) =       0.000257431342
  error estimate for blocks of size 2^( 3) =       0.000265440073
  error estimate for blocks of size 2^( 4) =       0.000271466285
  error estimate for blocks of size 2^( 5) =       0.000274864437
  error estimate for blocks of size 2^( 6) =       0.000276652928
  error estimate for blocks of size 2^( 7) =       0.000278015358
  error estimate for blocks of size 2^( 8) =       0.000278456070
  error estimate for blocks of size 2^( 9) =       0.000277176624

      target function =                  N/A
              le_mean =     -22.669515265538
             les_mean =     514.412819663464
             stat err =       0.000277575245
             autocorr =       1.248887756294
              std dev =       0.702528620055
             le_variance =       0.493546461997

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.493543470333
                                         uncertainty =       0.001209226861

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.493543470333
                                         uncertainty =       0.001209226861

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000248381376
  error estimate for blocks of size 2^( 2) =       0.000257431342
  error estimate for blocks of size 2^( 3) =       0.000265440073
  error estimate for blocks of size 2^( 4) =       0.000271466285
  error estimate for blocks of size 2^( 5) =       0.000274864437
  error estimate for blocks of size 2^( 6) =       0.000276652928
  error estimate for blocks of size 2^( 7) =       0.000278015358
  error estimate for blocks of size 2^( 8) =       0.000278456070
  error estimate for blocks of size 2^( 9) =       0.000277176624

      target function =                  N/A
              le_mean =     -22.669515265538
             les_mean =     514.412819663464
             stat err =       0.000277575245
             autocorr =       1.248887756294
              std dev =       0.702528620055
             le_variance =       0.493546461997

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.493543470333
                                         uncertainty =       0.001209226861

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.493543470333
                                         uncertainty =       0.001209226861

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000248381376
  error estimate for blocks of size 2^( 2) =       0.000257431342
  error estimate for blocks of size 2^( 3) =       0.000265440073
  error estimate for blocks of size 2^( 4) =       0.000271466285
  error estimate for blocks of size 2^( 5) =       0.000274864437
  error estimate for blocks of size 2^( 6) =       0.000276652928
  error estimate for blocks of size 2^( 7) =       0.000278015358
  error estimate for blocks of size 2^( 8) =       0.000278456070
  error estimate for blocks of size 2^( 9) =       0.000277176624

      target function =                  N/A
              le_mean =     -22.669515265538
             les_mean =     514.412819663464
             stat err =       0.000277575245
             autocorr =       1.248887756294
              std dev =       0.702528620055
             le_variance =       0.493546461997

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.493543470333
                                         uncertainty =       0.001209226861

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.493543470333
                                         uncertainty =       0.001209226861

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000248381376
  error estimate for blocks of size 2^( 2) =       0.000257431342
  error estimate for blocks of size 2^( 3) =       0.000265440073
  error estimate for blocks of size 2^( 4) =       0.000271466285
  error estimate for blocks of size 2^( 5) =       0.000274864437
  error estimate for blocks of size 2^( 6) =       0.000276652928
  error estimate for blocks of size 2^( 7) =       0.000278015358
  error estimate for blocks of size 2^( 8) =       0.000278456070
  error estimate for blocks of size 2^( 9) =       0.000277176624

      target function =                  N/A
              le_mean =     -22.669515265538
             les_mean =     514.412819663464
             stat err =       0.000277575245
             autocorr =       1.248887756294
              std dev =       0.702528620055
             le_variance =       0.493546461997


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.669515265538        initial  <--
     1.3878e+26     1.3878e+27             0.0000e+00       -22.669515265538
     5.5511e+26     5.5511e+27             0.0000e+00       -22.669515265538
     2.2204e+27     2.2204e+28             0.0000e+00       -22.669515265538

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 176.1473
  </log>
  <optVariables href="FORM.s084.opt.xml">
ci_001                -7.050617e-01 3 1  ON 0
ci_002                -7.059926e-01 3 1  ON 1
ci_003                -3.765135e-02 3 1  ON 2
ci_004                -3.890325e-02 3 1  ON 3
ci_005                 1.612441e-02 3 1  ON 4
ci_006                 1.600090e-02 3 1  ON 5
ci_007                 1.228713e-02 3 1  ON 6
ci_008                 1.246533e-02 3 1  ON 7
ci_009                -1.173869e-02 3 1  ON 8
ci_010                -1.182876e-02 3 1  ON 9
ci_011                -8.176403e-03 3 1  ON 10
ci_012                -8.138278e-03 3 1  ON 11
ci_013                 9.647137e-03 3 1  ON 12
ci_014                 9.360580e-03 3 1  ON 13
ci_015                 1.228715e-02 3 1  ON 14
ci_016                 1.255400e-02 3 1  ON 15
ci_017                 1.088300e-02 3 1  ON 16
ci_018                 1.078149e-02 3 1  ON 17
ci_019                -2.514322e-03 3 1  ON 18
ci_020                -2.423765e-03 3 1  ON 19
ci_021                -8.459776e-03 3 1  ON 20
ci_022                -8.657034e-03 3 1  ON 21
ci_023                 7.805043e-03 3 1  ON 22
ci_024                 8.041852e-03 3 1  ON 23
ci_025                 4.702642e-03 3 1  ON 24
ci_026                 4.273172e-03 3 1  ON 25
ci_027                 6.454089e-03 3 1  ON 26
ci_028                 6.476482e-03 3 1  ON 27
ci_029                -4.877820e-03 3 1  ON 28
ci_030                -4.785596e-03 3 1  ON 29
ci_031                -7.388694e-03 3 1  ON 30
ci_032                -8.123179e-03 3 1  ON 31
ci_033                 4.600637e-03 3 1  ON 32
ci_034                 4.413553e-03 3 1  ON 33
ci_035                 1.126907e-03 3 1  ON 34
ci_036                 1.043146e-03 3 1  ON 35
ci_037                 4.953347e-03 3 1  ON 36
ci_038                 5.099310e-03 3 1  ON 37
ci_039                 5.306386e-03 3 1  ON 38
ci_040                 5.323086e-03 3 1  ON 39
ci_041                 4.970499e-03 3 1  ON 40
ci_042                 5.231233e-03 3 1  ON 41
ci_043                 4.943052e-03 3 1  ON 42
ci_044                 4.944182e-03 3 1  ON 43
ci_045                 3.123967e-03 3 1  ON 44
ci_046                 3.174246e-03 3 1  ON 45
ci_047                -7.790222e-04 3 1  ON 46
ci_048                -5.616836e-04 3 1  ON 47
ci_049                 1.580289e-03 3 1  ON 48
ci_050                 1.792516e-03 3 1  ON 49
ci_051                -1.106651e-03 3 1  ON 50
ci_052                -1.243279e-03 3 1  ON 51
ci_053                -2.610471e-03 3 1  ON 52
ci_054                -2.301978e-03 3 1  ON 53
ci_055                -1.483475e-03 3 1  ON 54
ci_056                -1.376714e-03 3 1  ON 55
ci_057                -1.240708e-03 3 1  ON 56
ci_058                -1.731077e-03 3 1  ON 57
ci_059                 3.171692e-04 3 1  ON 58
ci_060                 1.414703e-04 3 1  ON 59
ci_061                -3.305088e-04 3 1  ON 60
ci_062                -9.499769e-06 3 1  ON 61
ci_063                -5.232922e-04 3 1  ON 62
ci_064                -8.918525e-04 3 1  ON 63
ci_065                -2.408143e-03 3 1  ON 64
ci_066                -2.435285e-03 3 1  ON 65
ci_067                -2.101084e-03 3 1  ON 66
ci_068                -2.473560e-03 3 1  ON 67
ci_069                -2.085964e-04 3 1  ON 68
ci_070                 1.328450e-04 3 1  ON 69
ci_071                -1.874230e-03 3 1  ON 70
ci_072                -1.959430e-03 3 1  ON 71
ci_073                 5.749021e-04 3 1  ON 72
ci_074                 2.857507e-04 3 1  ON 73
ci_075                -2.910323e-04 3 1  ON 74
ci_076                -2.990999e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 2.9565e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s085 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s085 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=85  my_counter=0
  time step      = 5.0000e-02
  blocks         = 250
  steps          = 250
  substeps       = 10
  current        = 0
  target samples = 8.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">250</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">6.2500e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">8.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">6.2500e+04</parameter>
<parameter name="steps" condition="int">250</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2664e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="250">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =8000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 85
    time step          = 0.05
    reference energy   = -22.7142
    reference variance = 0.717736
====================================================
  Execution time = 1.0057e+02
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s085
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 62500 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 6.1099e+04
  VMC Eavg = -2.2670e+01
  VMC Evar = 5.0688e-01
  Total weights = 7.820483583e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.9078e+01
  </log>
</opt>
<opt stage="main" walkers="62500">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.495432305498
                                         uncertainty =       0.001389858227

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.495432305498
                                         uncertainty =       0.001389858227

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000248856218
  error estimate for blocks of size 2^( 2) =       0.000257785865
  error estimate for blocks of size 2^( 3) =       0.000265862900
  error estimate for blocks of size 2^( 4) =       0.000271730421
  error estimate for blocks of size 2^( 5) =       0.000275111799
  error estimate for blocks of size 2^( 6) =       0.000277057398
  error estimate for blocks of size 2^( 7) =       0.000278057175
  error estimate for blocks of size 2^( 8) =       0.000277500012
  error estimate for blocks of size 2^( 9) =       0.000278655014

      target function =                  N/A
              le_mean =     -22.669645620314
             les_mean =     514.419715207176
             stat err =       0.000277817400
             autocorr =       1.246297977587
              std dev =       0.703871677578
             le_variance =       0.495435338497


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266964562031e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.3878e+27, overlap shift 1.3878e+28 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.669645620339       residual = 2.24e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.669645620339       residual = 2.24e-05           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 1.3878e+27 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 5.5511e+27, overlap shift 5.5511e+28 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.669645620339       residual = 2.24e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.669645620339       residual = 2.24e-05           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 5.5511e+27 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 2.2204e+28, overlap shift 2.2204e+29 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.669645620339       residual = 2.24e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.669645620339       residual = 2.24e-05           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 2.2204e+28 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.185741 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.1967e+02
  </log>
  <optVariables href="FORM.s085.opt.xml">
ci_001                -7.050617e-01 3 1  ON 0
ci_002                -7.059926e-01 3 1  ON 1
ci_003                -3.765135e-02 3 1  ON 2
ci_004                -3.890325e-02 3 1  ON 3
ci_005                 1.612441e-02 3 1  ON 4
ci_006                 1.600090e-02 3 1  ON 5
ci_007                 1.228713e-02 3 1  ON 6
ci_008                 1.246533e-02 3 1  ON 7
ci_009                -1.173869e-02 3 1  ON 8
ci_010                -1.182876e-02 3 1  ON 9
ci_011                -8.176403e-03 3 1  ON 10
ci_012                -8.138278e-03 3 1  ON 11
ci_013                 9.647137e-03 3 1  ON 12
ci_014                 9.360580e-03 3 1  ON 13
ci_015                 1.228715e-02 3 1  ON 14
ci_016                 1.255400e-02 3 1  ON 15
ci_017                 1.088300e-02 3 1  ON 16
ci_018                 1.078149e-02 3 1  ON 17
ci_019                -2.514322e-03 3 1  ON 18
ci_020                -2.423765e-03 3 1  ON 19
ci_021                -8.459776e-03 3 1  ON 20
ci_022                -8.657034e-03 3 1  ON 21
ci_023                 7.805043e-03 3 1  ON 22
ci_024                 8.041852e-03 3 1  ON 23
ci_025                 4.702642e-03 3 1  ON 24
ci_026                 4.273172e-03 3 1  ON 25
ci_027                 6.454089e-03 3 1  ON 26
ci_028                 6.476482e-03 3 1  ON 27
ci_029                -4.877820e-03 3 1  ON 28
ci_030                -4.785596e-03 3 1  ON 29
ci_031                -7.388694e-03 3 1  ON 30
ci_032                -8.123179e-03 3 1  ON 31
ci_033                 4.600637e-03 3 1  ON 32
ci_034                 4.413553e-03 3 1  ON 33
ci_035                 1.126907e-03 3 1  ON 34
ci_036                 1.043146e-03 3 1  ON 35
ci_037                 4.953347e-03 3 1  ON 36
ci_038                 5.099310e-03 3 1  ON 37
ci_039                 5.306386e-03 3 1  ON 38
ci_040                 5.323086e-03 3 1  ON 39
ci_041                 4.970499e-03 3 1  ON 40
ci_042                 5.231233e-03 3 1  ON 41
ci_043                 4.943052e-03 3 1  ON 42
ci_044                 4.944182e-03 3 1  ON 43
ci_045                 3.123967e-03 3 1  ON 44
ci_046                 3.174246e-03 3 1  ON 45
ci_047                -7.790222e-04 3 1  ON 46
ci_048                -5.616836e-04 3 1  ON 47
ci_049                 1.580289e-03 3 1  ON 48
ci_050                 1.792516e-03 3 1  ON 49
ci_051                -1.106651e-03 3 1  ON 50
ci_052                -1.243279e-03 3 1  ON 51
ci_053                -2.610471e-03 3 1  ON 52
ci_054                -2.301978e-03 3 1  ON 53
ci_055                -1.483475e-03 3 1  ON 54
ci_056                -1.376714e-03 3 1  ON 55
ci_057                -1.240708e-03 3 1  ON 56
ci_058                -1.731077e-03 3 1  ON 57
ci_059                 3.171692e-04 3 1  ON 58
ci_060                 1.414703e-04 3 1  ON 59
ci_061                -3.305088e-04 3 1  ON 60
ci_062                -9.499769e-06 3 1  ON 61
ci_063                -5.232922e-04 3 1  ON 62
ci_064                -8.918525e-04 3 1  ON 63
ci_065                -2.408143e-03 3 1  ON 64
ci_066                -2.435285e-03 3 1  ON 65
ci_067                -2.101084e-03 3 1  ON 66
ci_068                -2.473560e-03 3 1  ON 67
ci_069                -2.085964e-04 3 1  ON 68
ci_070                 1.328450e-04 3 1  ON 69
ci_071                -1.874230e-03 3 1  ON 70
ci_072                -1.959430e-03 3 1  ON 71
ci_073                 5.749021e-04 3 1  ON 72
ci_074                 2.857507e-04 3 1  ON 73
ci_075                -2.910323e-04 3 1  ON 74
ci_076                -2.990999e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="250">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =8000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 85
    time step          = 0.05
    reference energy   = -22.6225
    reference variance = 0.446202
====================================================
  Execution time = 9.9997e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s085
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 62500 
  VMC Eavg = -2.2670e+01
  VMC Evar = 5.1245e-01
  Total weights = 7.8207e+06
  Execution time = 1.4659e+01
  </log>
</opt>
<opt stage="main" walkers="62500">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.496380773838
                                         uncertainty =       0.001715502698

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.496380773838
                                         uncertainty =       0.001715502698

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000249093509
  error estimate for blocks of size 2^( 2) =       0.000257998536
  error estimate for blocks of size 2^( 3) =       0.000265973677
  error estimate for blocks of size 2^( 4) =       0.000271666584
  error estimate for blocks of size 2^( 5) =       0.000274736190
  error estimate for blocks of size 2^( 6) =       0.000276303031
  error estimate for blocks of size 2^( 7) =       0.000277131972
  error estimate for blocks of size 2^( 8) =       0.000277174790
  error estimate for blocks of size 2^( 9) =       0.000276711012

      target function =                  N/A
              le_mean =     -22.669739170033
             les_mean =     514.429521760461
             stat err =       0.000276830201
             autocorr =       1.235099981941
              std dev =       0.704542838035
             le_variance =       0.496380610626

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.496380773838
                                         uncertainty =       0.001715502698

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.496380773838
                                         uncertainty =       0.001715502698

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000249093509
  error estimate for blocks of size 2^( 2) =       0.000257998536
  error estimate for blocks of size 2^( 3) =       0.000265973677
  error estimate for blocks of size 2^( 4) =       0.000271666584
  error estimate for blocks of size 2^( 5) =       0.000274736190
  error estimate for blocks of size 2^( 6) =       0.000276303031
  error estimate for blocks of size 2^( 7) =       0.000277131972
  error estimate for blocks of size 2^( 8) =       0.000277174790
  error estimate for blocks of size 2^( 9) =       0.000276711012

      target function =                  N/A
              le_mean =     -22.669739170033
             les_mean =     514.429521760461
             stat err =       0.000276830201
             autocorr =       1.235099981941
              std dev =       0.704542838035
             le_variance =       0.496380610626

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.496380773838
                                         uncertainty =       0.001715502698

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.496380773838
                                         uncertainty =       0.001715502698

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000249093509
  error estimate for blocks of size 2^( 2) =       0.000257998536
  error estimate for blocks of size 2^( 3) =       0.000265973677
  error estimate for blocks of size 2^( 4) =       0.000271666584
  error estimate for blocks of size 2^( 5) =       0.000274736190
  error estimate for blocks of size 2^( 6) =       0.000276303031
  error estimate for blocks of size 2^( 7) =       0.000277131972
  error estimate for blocks of size 2^( 8) =       0.000277174790
  error estimate for blocks of size 2^( 9) =       0.000276711012

      target function =                  N/A
              le_mean =     -22.669739170033
             les_mean =     514.429521760461
             stat err =       0.000276830201
             autocorr =       1.235099981941
              std dev =       0.704542838035
             le_variance =       0.496380610626

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.496380773838
                                         uncertainty =       0.001715502698

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.496380773838
                                         uncertainty =       0.001715502698

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000249093509
  error estimate for blocks of size 2^( 2) =       0.000257998536
  error estimate for blocks of size 2^( 3) =       0.000265973677
  error estimate for blocks of size 2^( 4) =       0.000271666584
  error estimate for blocks of size 2^( 5) =       0.000274736190
  error estimate for blocks of size 2^( 6) =       0.000276303031
  error estimate for blocks of size 2^( 7) =       0.000277131972
  error estimate for blocks of size 2^( 8) =       0.000277174790
  error estimate for blocks of size 2^( 9) =       0.000276711012

      target function =                  N/A
              le_mean =     -22.669739170033
             les_mean =     514.429521760461
             stat err =       0.000276830201
             autocorr =       1.235099981941
              std dev =       0.704542838035
             le_variance =       0.496380610626


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.669739170033        initial  <--
     1.3878e+27     1.3878e+28             0.0000e+00       -22.669739170033
     5.5511e+27     5.5511e+28             0.0000e+00       -22.669739170033
     2.2204e+28     2.2204e+29             0.0000e+00       -22.669739170033

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 173.3220
  </log>
  <optVariables href="FORM.s085.opt.xml">
ci_001                -7.050617e-01 3 1  ON 0
ci_002                -7.059926e-01 3 1  ON 1
ci_003                -3.765135e-02 3 1  ON 2
ci_004                -3.890325e-02 3 1  ON 3
ci_005                 1.612441e-02 3 1  ON 4
ci_006                 1.600090e-02 3 1  ON 5
ci_007                 1.228713e-02 3 1  ON 6
ci_008                 1.246533e-02 3 1  ON 7
ci_009                -1.173869e-02 3 1  ON 8
ci_010                -1.182876e-02 3 1  ON 9
ci_011                -8.176403e-03 3 1  ON 10
ci_012                -8.138278e-03 3 1  ON 11
ci_013                 9.647137e-03 3 1  ON 12
ci_014                 9.360580e-03 3 1  ON 13
ci_015                 1.228715e-02 3 1  ON 14
ci_016                 1.255400e-02 3 1  ON 15
ci_017                 1.088300e-02 3 1  ON 16
ci_018                 1.078149e-02 3 1  ON 17
ci_019                -2.514322e-03 3 1  ON 18
ci_020                -2.423765e-03 3 1  ON 19
ci_021                -8.459776e-03 3 1  ON 20
ci_022                -8.657034e-03 3 1  ON 21
ci_023                 7.805043e-03 3 1  ON 22
ci_024                 8.041852e-03 3 1  ON 23
ci_025                 4.702642e-03 3 1  ON 24
ci_026                 4.273172e-03 3 1  ON 25
ci_027                 6.454089e-03 3 1  ON 26
ci_028                 6.476482e-03 3 1  ON 27
ci_029                -4.877820e-03 3 1  ON 28
ci_030                -4.785596e-03 3 1  ON 29
ci_031                -7.388694e-03 3 1  ON 30
ci_032                -8.123179e-03 3 1  ON 31
ci_033                 4.600637e-03 3 1  ON 32
ci_034                 4.413553e-03 3 1  ON 33
ci_035                 1.126907e-03 3 1  ON 34
ci_036                 1.043146e-03 3 1  ON 35
ci_037                 4.953347e-03 3 1  ON 36
ci_038                 5.099310e-03 3 1  ON 37
ci_039                 5.306386e-03 3 1  ON 38
ci_040                 5.323086e-03 3 1  ON 39
ci_041                 4.970499e-03 3 1  ON 40
ci_042                 5.231233e-03 3 1  ON 41
ci_043                 4.943052e-03 3 1  ON 42
ci_044                 4.944182e-03 3 1  ON 43
ci_045                 3.123967e-03 3 1  ON 44
ci_046                 3.174246e-03 3 1  ON 45
ci_047                -7.790222e-04 3 1  ON 46
ci_048                -5.616836e-04 3 1  ON 47
ci_049                 1.580289e-03 3 1  ON 48
ci_050                 1.792516e-03 3 1  ON 49
ci_051                -1.106651e-03 3 1  ON 50
ci_052                -1.243279e-03 3 1  ON 51
ci_053                -2.610471e-03 3 1  ON 52
ci_054                -2.301978e-03 3 1  ON 53
ci_055                -1.483475e-03 3 1  ON 54
ci_056                -1.376714e-03 3 1  ON 55
ci_057                -1.240708e-03 3 1  ON 56
ci_058                -1.731077e-03 3 1  ON 57
ci_059                 3.171692e-04 3 1  ON 58
ci_060                 1.414703e-04 3 1  ON 59
ci_061                -3.305088e-04 3 1  ON 60
ci_062                -9.499769e-06 3 1  ON 61
ci_063                -5.232922e-04 3 1  ON 62
ci_064                -8.918525e-04 3 1  ON 63
ci_065                -2.408143e-03 3 1  ON 64
ci_066                -2.435285e-03 3 1  ON 65
ci_067                -2.101084e-03 3 1  ON 66
ci_068                -2.473560e-03 3 1  ON 67
ci_069                -2.085964e-04 3 1  ON 68
ci_070                 1.328450e-04 3 1  ON 69
ci_071                -1.874230e-03 3 1  ON 70
ci_072                -1.959430e-03 3 1  ON 71
ci_073                 5.749021e-04 3 1  ON 72
ci_074                 2.857507e-04 3 1  ON 73
ci_075                -2.910323e-04 3 1  ON 74
ci_076                -2.990999e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 2.9301e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s086 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s086 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=86  my_counter=0
  time step      = 5.0000e-02
  blocks         = 250
  steps          = 250
  substeps       = 10
  current        = 0
  target samples = 8.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">250</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">6.2500e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">8.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">6.2500e+04</parameter>
<parameter name="steps" condition="int">250</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2664e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="250">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =8000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 86
    time step          = 0.05
    reference energy   = -22.5813
    reference variance = 0.557594
====================================================
  Execution time = 1.0231e+02
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s086
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 62500 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 6.1096e+04
  VMC Eavg = -2.2670e+01
  VMC Evar = 5.1069e-01
  Total weights = 7.820506083e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.9053e+01
  </log>
</opt>
<opt stage="main" walkers="62500">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.497282183623
                                         uncertainty =       0.001506145788

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.497282183623
                                         uncertainty =       0.001506145788

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000249320636
  error estimate for blocks of size 2^( 2) =       0.000258293392
  error estimate for blocks of size 2^( 3) =       0.000266351160
  error estimate for blocks of size 2^( 4) =       0.000272156028
  error estimate for blocks of size 2^( 5) =       0.000275742053
  error estimate for blocks of size 2^( 6) =       0.000277192819
  error estimate for blocks of size 2^( 7) =       0.000277785057
  error estimate for blocks of size 2^( 8) =       0.000278957793
  error estimate for blocks of size 2^( 9) =       0.000278086861

      target function =                  N/A
              le_mean =     -22.670084526327
             les_mean =     514.443426656991
             stat err =       0.000278005633
             autocorr =       1.243342379207
              std dev =       0.705185250565
             le_variance =       0.497286237614


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.267008452633e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.3878e+28, overlap shift 1.3878e+29 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.670084526351       residual = 3.96e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.670084526351       residual = 3.96e-05           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 1.3878e+28 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 5.5511e+28, overlap shift 5.5511e+29 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.670084526351       residual = 3.96e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.670084526351       residual = 3.96e-05           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 5.5511e+28 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 2.2204e+29, overlap shift 2.2204e+30 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.670084526351       residual = 3.96e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.670084526351       residual = 3.96e-05           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 2.2204e+29 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.190076 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.2139e+02
  </log>
  <optVariables href="FORM.s086.opt.xml">
ci_001                -7.050617e-01 3 1  ON 0
ci_002                -7.059926e-01 3 1  ON 1
ci_003                -3.765135e-02 3 1  ON 2
ci_004                -3.890325e-02 3 1  ON 3
ci_005                 1.612441e-02 3 1  ON 4
ci_006                 1.600090e-02 3 1  ON 5
ci_007                 1.228713e-02 3 1  ON 6
ci_008                 1.246533e-02 3 1  ON 7
ci_009                -1.173869e-02 3 1  ON 8
ci_010                -1.182876e-02 3 1  ON 9
ci_011                -8.176403e-03 3 1  ON 10
ci_012                -8.138278e-03 3 1  ON 11
ci_013                 9.647137e-03 3 1  ON 12
ci_014                 9.360580e-03 3 1  ON 13
ci_015                 1.228715e-02 3 1  ON 14
ci_016                 1.255400e-02 3 1  ON 15
ci_017                 1.088300e-02 3 1  ON 16
ci_018                 1.078149e-02 3 1  ON 17
ci_019                -2.514322e-03 3 1  ON 18
ci_020                -2.423765e-03 3 1  ON 19
ci_021                -8.459776e-03 3 1  ON 20
ci_022                -8.657034e-03 3 1  ON 21
ci_023                 7.805043e-03 3 1  ON 22
ci_024                 8.041852e-03 3 1  ON 23
ci_025                 4.702642e-03 3 1  ON 24
ci_026                 4.273172e-03 3 1  ON 25
ci_027                 6.454089e-03 3 1  ON 26
ci_028                 6.476482e-03 3 1  ON 27
ci_029                -4.877820e-03 3 1  ON 28
ci_030                -4.785596e-03 3 1  ON 29
ci_031                -7.388694e-03 3 1  ON 30
ci_032                -8.123179e-03 3 1  ON 31
ci_033                 4.600637e-03 3 1  ON 32
ci_034                 4.413553e-03 3 1  ON 33
ci_035                 1.126907e-03 3 1  ON 34
ci_036                 1.043146e-03 3 1  ON 35
ci_037                 4.953347e-03 3 1  ON 36
ci_038                 5.099310e-03 3 1  ON 37
ci_039                 5.306386e-03 3 1  ON 38
ci_040                 5.323086e-03 3 1  ON 39
ci_041                 4.970499e-03 3 1  ON 40
ci_042                 5.231233e-03 3 1  ON 41
ci_043                 4.943052e-03 3 1  ON 42
ci_044                 4.944182e-03 3 1  ON 43
ci_045                 3.123967e-03 3 1  ON 44
ci_046                 3.174246e-03 3 1  ON 45
ci_047                -7.790222e-04 3 1  ON 46
ci_048                -5.616836e-04 3 1  ON 47
ci_049                 1.580289e-03 3 1  ON 48
ci_050                 1.792516e-03 3 1  ON 49
ci_051                -1.106651e-03 3 1  ON 50
ci_052                -1.243279e-03 3 1  ON 51
ci_053                -2.610471e-03 3 1  ON 52
ci_054                -2.301978e-03 3 1  ON 53
ci_055                -1.483475e-03 3 1  ON 54
ci_056                -1.376714e-03 3 1  ON 55
ci_057                -1.240708e-03 3 1  ON 56
ci_058                -1.731077e-03 3 1  ON 57
ci_059                 3.171692e-04 3 1  ON 58
ci_060                 1.414703e-04 3 1  ON 59
ci_061                -3.305088e-04 3 1  ON 60
ci_062                -9.499769e-06 3 1  ON 61
ci_063                -5.232922e-04 3 1  ON 62
ci_064                -8.918525e-04 3 1  ON 63
ci_065                -2.408143e-03 3 1  ON 64
ci_066                -2.435285e-03 3 1  ON 65
ci_067                -2.101084e-03 3 1  ON 66
ci_068                -2.473560e-03 3 1  ON 67
ci_069                -2.085964e-04 3 1  ON 68
ci_070                 1.328450e-04 3 1  ON 69
ci_071                -1.874230e-03 3 1  ON 70
ci_072                -1.959430e-03 3 1  ON 71
ci_073                 5.749021e-04 3 1  ON 72
ci_074                 2.857507e-04 3 1  ON 73
ci_075                -2.910323e-04 3 1  ON 74
ci_076                -2.990999e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="250">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =8000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 86
    time step          = 0.05
    reference energy   = -22.7672
    reference variance = 0.26339
====================================================
  Execution time = 9.9799e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s086
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 62500 
  VMC Eavg = -2.2669e+01
  VMC Evar = 5.0822e-01
  Total weights = 7.8208e+06
  Execution time = 1.4669e+01
  </log>
</opt>
<opt stage="main" walkers="62500">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.495029215278
                                         uncertainty =       0.001584321015

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.495029215278
                                         uncertainty =       0.001584321015

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000248755642
  error estimate for blocks of size 2^( 2) =       0.000257631830
  error estimate for blocks of size 2^( 3) =       0.000265448518
  error estimate for blocks of size 2^( 4) =       0.000271354632
  error estimate for blocks of size 2^( 5) =       0.000274558065
  error estimate for blocks of size 2^( 6) =       0.000275977317
  error estimate for blocks of size 2^( 7) =       0.000276562774
  error estimate for blocks of size 2^( 8) =       0.000276386654
  error estimate for blocks of size 2^( 9) =       0.000277934129

      target function =                  N/A
              le_mean =     -22.669192231689
             les_mean =     514.400494725353
             stat err =       0.000276715218
             autocorr =       1.237428765133
              std dev =       0.703587206538
             le_variance =       0.495034957204

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.495029215278
                                         uncertainty =       0.001584321015

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.495029215278
                                         uncertainty =       0.001584321015

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000248755642
  error estimate for blocks of size 2^( 2) =       0.000257631830
  error estimate for blocks of size 2^( 3) =       0.000265448518
  error estimate for blocks of size 2^( 4) =       0.000271354632
  error estimate for blocks of size 2^( 5) =       0.000274558065
  error estimate for blocks of size 2^( 6) =       0.000275977317
  error estimate for blocks of size 2^( 7) =       0.000276562774
  error estimate for blocks of size 2^( 8) =       0.000276386654
  error estimate for blocks of size 2^( 9) =       0.000277934129

      target function =                  N/A
              le_mean =     -22.669192231689
             les_mean =     514.400494725353
             stat err =       0.000276715218
             autocorr =       1.237428765133
              std dev =       0.703587206538
             le_variance =       0.495034957204

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.495029215278
                                         uncertainty =       0.001584321015

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.495029215278
                                         uncertainty =       0.001584321015

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000248755642
  error estimate for blocks of size 2^( 2) =       0.000257631830
  error estimate for blocks of size 2^( 3) =       0.000265448518
  error estimate for blocks of size 2^( 4) =       0.000271354632
  error estimate for blocks of size 2^( 5) =       0.000274558065
  error estimate for blocks of size 2^( 6) =       0.000275977317
  error estimate for blocks of size 2^( 7) =       0.000276562774
  error estimate for blocks of size 2^( 8) =       0.000276386654
  error estimate for blocks of size 2^( 9) =       0.000277934129

      target function =                  N/A
              le_mean =     -22.669192231689
             les_mean =     514.400494725353
             stat err =       0.000276715218
             autocorr =       1.237428765133
              std dev =       0.703587206538
             le_variance =       0.495034957204

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.495029215278
                                         uncertainty =       0.001584321015

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.495029215278
                                         uncertainty =       0.001584321015

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000248755642
  error estimate for blocks of size 2^( 2) =       0.000257631830
  error estimate for blocks of size 2^( 3) =       0.000265448518
  error estimate for blocks of size 2^( 4) =       0.000271354632
  error estimate for blocks of size 2^( 5) =       0.000274558065
  error estimate for blocks of size 2^( 6) =       0.000275977317
  error estimate for blocks of size 2^( 7) =       0.000276562774
  error estimate for blocks of size 2^( 8) =       0.000276386654
  error estimate for blocks of size 2^( 9) =       0.000277934129

      target function =                  N/A
              le_mean =     -22.669192231689
             les_mean =     514.400494725353
             stat err =       0.000276715218
             autocorr =       1.237428765133
              std dev =       0.703587206538
             le_variance =       0.495034957204


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.669192231689        initial  <--
     1.3878e+28     1.3878e+29             0.0000e+00       -22.669192231689
     5.5511e+28     5.5511e+29             0.0000e+00       -22.669192231689
     2.2204e+29     2.2204e+30             0.0000e+00       -22.669192231689

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 173.1274
  </log>
  <optVariables href="FORM.s086.opt.xml">
ci_001                -7.050617e-01 3 1  ON 0
ci_002                -7.059926e-01 3 1  ON 1
ci_003                -3.765135e-02 3 1  ON 2
ci_004                -3.890325e-02 3 1  ON 3
ci_005                 1.612441e-02 3 1  ON 4
ci_006                 1.600090e-02 3 1  ON 5
ci_007                 1.228713e-02 3 1  ON 6
ci_008                 1.246533e-02 3 1  ON 7
ci_009                -1.173869e-02 3 1  ON 8
ci_010                -1.182876e-02 3 1  ON 9
ci_011                -8.176403e-03 3 1  ON 10
ci_012                -8.138278e-03 3 1  ON 11
ci_013                 9.647137e-03 3 1  ON 12
ci_014                 9.360580e-03 3 1  ON 13
ci_015                 1.228715e-02 3 1  ON 14
ci_016                 1.255400e-02 3 1  ON 15
ci_017                 1.088300e-02 3 1  ON 16
ci_018                 1.078149e-02 3 1  ON 17
ci_019                -2.514322e-03 3 1  ON 18
ci_020                -2.423765e-03 3 1  ON 19
ci_021                -8.459776e-03 3 1  ON 20
ci_022                -8.657034e-03 3 1  ON 21
ci_023                 7.805043e-03 3 1  ON 22
ci_024                 8.041852e-03 3 1  ON 23
ci_025                 4.702642e-03 3 1  ON 24
ci_026                 4.273172e-03 3 1  ON 25
ci_027                 6.454089e-03 3 1  ON 26
ci_028                 6.476482e-03 3 1  ON 27
ci_029                -4.877820e-03 3 1  ON 28
ci_030                -4.785596e-03 3 1  ON 29
ci_031                -7.388694e-03 3 1  ON 30
ci_032                -8.123179e-03 3 1  ON 31
ci_033                 4.600637e-03 3 1  ON 32
ci_034                 4.413553e-03 3 1  ON 33
ci_035                 1.126907e-03 3 1  ON 34
ci_036                 1.043146e-03 3 1  ON 35
ci_037                 4.953347e-03 3 1  ON 36
ci_038                 5.099310e-03 3 1  ON 37
ci_039                 5.306386e-03 3 1  ON 38
ci_040                 5.323086e-03 3 1  ON 39
ci_041                 4.970499e-03 3 1  ON 40
ci_042                 5.231233e-03 3 1  ON 41
ci_043                 4.943052e-03 3 1  ON 42
ci_044                 4.944182e-03 3 1  ON 43
ci_045                 3.123967e-03 3 1  ON 44
ci_046                 3.174246e-03 3 1  ON 45
ci_047                -7.790222e-04 3 1  ON 46
ci_048                -5.616836e-04 3 1  ON 47
ci_049                 1.580289e-03 3 1  ON 48
ci_050                 1.792516e-03 3 1  ON 49
ci_051                -1.106651e-03 3 1  ON 50
ci_052                -1.243279e-03 3 1  ON 51
ci_053                -2.610471e-03 3 1  ON 52
ci_054                -2.301978e-03 3 1  ON 53
ci_055                -1.483475e-03 3 1  ON 54
ci_056                -1.376714e-03 3 1  ON 55
ci_057                -1.240708e-03 3 1  ON 56
ci_058                -1.731077e-03 3 1  ON 57
ci_059                 3.171692e-04 3 1  ON 58
ci_060                 1.414703e-04 3 1  ON 59
ci_061                -3.305088e-04 3 1  ON 60
ci_062                -9.499769e-06 3 1  ON 61
ci_063                -5.232922e-04 3 1  ON 62
ci_064                -8.918525e-04 3 1  ON 63
ci_065                -2.408143e-03 3 1  ON 64
ci_066                -2.435285e-03 3 1  ON 65
ci_067                -2.101084e-03 3 1  ON 66
ci_068                -2.473560e-03 3 1  ON 67
ci_069                -2.085964e-04 3 1  ON 68
ci_070                 1.328450e-04 3 1  ON 69
ci_071                -1.874230e-03 3 1  ON 70
ci_072                -1.959430e-03 3 1  ON 71
ci_073                 5.749021e-04 3 1  ON 72
ci_074                 2.857507e-04 3 1  ON 73
ci_075                -2.910323e-04 3 1  ON 74
ci_076                -2.990999e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 2.9453e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s087 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s087 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=87  my_counter=0
  time step      = 5.0000e-02
  blocks         = 250
  steps          = 250
  substeps       = 10
  current        = 0
  target samples = 8.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">250</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">6.2500e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">8.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">6.2500e+04</parameter>
<parameter name="steps" condition="int">250</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2664e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="250">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =8000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 87
    time step          = 0.05
    reference energy   = -22.5772
    reference variance = 0.312129
====================================================
  Execution time = 1.0225e+02
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s087
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 62500 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 6.1058e+04
  VMC Eavg = -2.2670e+01
  VMC Evar = 5.1146e-01
  Total weights = 7.820869107e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.8856e+01
  </log>
</opt>
<opt stage="main" walkers="62500">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.497723499949
                                         uncertainty =       0.002216859038

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.497723499949
                                         uncertainty =       0.002216859038

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000249430798
  error estimate for blocks of size 2^( 2) =       0.000258381527
  error estimate for blocks of size 2^( 3) =       0.000266411985
  error estimate for blocks of size 2^( 4) =       0.000272151464
  error estimate for blocks of size 2^( 5) =       0.000275402844
  error estimate for blocks of size 2^( 6) =       0.000277064178
  error estimate for blocks of size 2^( 7) =       0.000277790508
  error estimate for blocks of size 2^( 8) =       0.000278528417
  error estimate for blocks of size 2^( 9) =       0.000277931700

      target function =                  N/A
              le_mean =     -22.669624889156
             les_mean =     514.423354485695
             stat err =       0.000277828701
             autocorr =       1.240663665931
              std dev =       0.705496834435
             le_variance =       0.497725783397


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266962488916e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.3878e+29, overlap shift 1.3878e+30 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.669624889177       residual = 4.91e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.669624889177       residual = 4.91e-05           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 1.3878e+29 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 5.5511e+29, overlap shift 5.5511e+30 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.669624889177       residual = 4.91e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.669624889177       residual = 4.91e-05           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 5.5511e+29 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 2.2204e+30, overlap shift 2.2204e+31 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.669624889177       residual = 4.91e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.669624889177       residual = 4.91e-05           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 2.2204e+30 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.191231 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.2112e+02
  </log>
  <optVariables href="FORM.s087.opt.xml">
ci_001                -7.050617e-01 3 1  ON 0
ci_002                -7.059926e-01 3 1  ON 1
ci_003                -3.765135e-02 3 1  ON 2
ci_004                -3.890325e-02 3 1  ON 3
ci_005                 1.612441e-02 3 1  ON 4
ci_006                 1.600090e-02 3 1  ON 5
ci_007                 1.228713e-02 3 1  ON 6
ci_008                 1.246533e-02 3 1  ON 7
ci_009                -1.173869e-02 3 1  ON 8
ci_010                -1.182876e-02 3 1  ON 9
ci_011                -8.176403e-03 3 1  ON 10
ci_012                -8.138278e-03 3 1  ON 11
ci_013                 9.647137e-03 3 1  ON 12
ci_014                 9.360580e-03 3 1  ON 13
ci_015                 1.228715e-02 3 1  ON 14
ci_016                 1.255400e-02 3 1  ON 15
ci_017                 1.088300e-02 3 1  ON 16
ci_018                 1.078149e-02 3 1  ON 17
ci_019                -2.514322e-03 3 1  ON 18
ci_020                -2.423765e-03 3 1  ON 19
ci_021                -8.459776e-03 3 1  ON 20
ci_022                -8.657034e-03 3 1  ON 21
ci_023                 7.805043e-03 3 1  ON 22
ci_024                 8.041852e-03 3 1  ON 23
ci_025                 4.702642e-03 3 1  ON 24
ci_026                 4.273172e-03 3 1  ON 25
ci_027                 6.454089e-03 3 1  ON 26
ci_028                 6.476482e-03 3 1  ON 27
ci_029                -4.877820e-03 3 1  ON 28
ci_030                -4.785596e-03 3 1  ON 29
ci_031                -7.388694e-03 3 1  ON 30
ci_032                -8.123179e-03 3 1  ON 31
ci_033                 4.600637e-03 3 1  ON 32
ci_034                 4.413553e-03 3 1  ON 33
ci_035                 1.126907e-03 3 1  ON 34
ci_036                 1.043146e-03 3 1  ON 35
ci_037                 4.953347e-03 3 1  ON 36
ci_038                 5.099310e-03 3 1  ON 37
ci_039                 5.306386e-03 3 1  ON 38
ci_040                 5.323086e-03 3 1  ON 39
ci_041                 4.970499e-03 3 1  ON 40
ci_042                 5.231233e-03 3 1  ON 41
ci_043                 4.943052e-03 3 1  ON 42
ci_044                 4.944182e-03 3 1  ON 43
ci_045                 3.123967e-03 3 1  ON 44
ci_046                 3.174246e-03 3 1  ON 45
ci_047                -7.790222e-04 3 1  ON 46
ci_048                -5.616836e-04 3 1  ON 47
ci_049                 1.580289e-03 3 1  ON 48
ci_050                 1.792516e-03 3 1  ON 49
ci_051                -1.106651e-03 3 1  ON 50
ci_052                -1.243279e-03 3 1  ON 51
ci_053                -2.610471e-03 3 1  ON 52
ci_054                -2.301978e-03 3 1  ON 53
ci_055                -1.483475e-03 3 1  ON 54
ci_056                -1.376714e-03 3 1  ON 55
ci_057                -1.240708e-03 3 1  ON 56
ci_058                -1.731077e-03 3 1  ON 57
ci_059                 3.171692e-04 3 1  ON 58
ci_060                 1.414703e-04 3 1  ON 59
ci_061                -3.305088e-04 3 1  ON 60
ci_062                -9.499769e-06 3 1  ON 61
ci_063                -5.232922e-04 3 1  ON 62
ci_064                -8.918525e-04 3 1  ON 63
ci_065                -2.408143e-03 3 1  ON 64
ci_066                -2.435285e-03 3 1  ON 65
ci_067                -2.101084e-03 3 1  ON 66
ci_068                -2.473560e-03 3 1  ON 67
ci_069                -2.085964e-04 3 1  ON 68
ci_070                 1.328450e-04 3 1  ON 69
ci_071                -1.874230e-03 3 1  ON 70
ci_072                -1.959430e-03 3 1  ON 71
ci_073                 5.749021e-04 3 1  ON 72
ci_074                 2.857507e-04 3 1  ON 73
ci_075                -2.910323e-04 3 1  ON 74
ci_076                -2.990999e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="250">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =8000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 87
    time step          = 0.05
    reference energy   = -22.686
    reference variance = 0.370374
====================================================
  Execution time = 9.9863e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s087
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 62500 
  VMC Eavg = -2.2670e+01
  VMC Evar = 5.1188e-01
  Total weights = 7.8201e+06
  Execution time = 1.4635e+01
  </log>
</opt>
<opt stage="main" walkers="62500">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.497132025402
                                         uncertainty =       0.001785461586

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.497132025402
                                         uncertainty =       0.001785461586

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000249282452
  error estimate for blocks of size 2^( 2) =       0.000258177670
  error estimate for blocks of size 2^( 3) =       0.000266092117
  error estimate for blocks of size 2^( 4) =       0.000271889905
  error estimate for blocks of size 2^( 5) =       0.000275087836
  error estimate for blocks of size 2^( 6) =       0.000276370209
  error estimate for blocks of size 2^( 7) =       0.000277028685
  error estimate for blocks of size 2^( 8) =       0.000277526213
  error estimate for blocks of size 2^( 9) =       0.000277060107

      target function =                  N/A
              le_mean =     -22.669583486150
             les_mean =     514.421892992866
             stat err =       0.000276996304
             autocorr =       1.234708769642
              std dev =       0.705077248075
             le_variance =       0.497133925753

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.497132025402
                                         uncertainty =       0.001785461586

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.497132025402
                                         uncertainty =       0.001785461586

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000249282452
  error estimate for blocks of size 2^( 2) =       0.000258177670
  error estimate for blocks of size 2^( 3) =       0.000266092117
  error estimate for blocks of size 2^( 4) =       0.000271889905
  error estimate for blocks of size 2^( 5) =       0.000275087836
  error estimate for blocks of size 2^( 6) =       0.000276370209
  error estimate for blocks of size 2^( 7) =       0.000277028685
  error estimate for blocks of size 2^( 8) =       0.000277526213
  error estimate for blocks of size 2^( 9) =       0.000277060107

      target function =                  N/A
              le_mean =     -22.669583486150
             les_mean =     514.421892992866
             stat err =       0.000276996304
             autocorr =       1.234708769642
              std dev =       0.705077248075
             le_variance =       0.497133925753

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.497132025402
                                         uncertainty =       0.001785461586

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.497132025402
                                         uncertainty =       0.001785461586

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000249282452
  error estimate for blocks of size 2^( 2) =       0.000258177670
  error estimate for blocks of size 2^( 3) =       0.000266092117
  error estimate for blocks of size 2^( 4) =       0.000271889905
  error estimate for blocks of size 2^( 5) =       0.000275087836
  error estimate for blocks of size 2^( 6) =       0.000276370209
  error estimate for blocks of size 2^( 7) =       0.000277028685
  error estimate for blocks of size 2^( 8) =       0.000277526213
  error estimate for blocks of size 2^( 9) =       0.000277060107

      target function =                  N/A
              le_mean =     -22.669583486150
             les_mean =     514.421892992866
             stat err =       0.000276996304
             autocorr =       1.234708769642
              std dev =       0.705077248075
             le_variance =       0.497133925753

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.497132025402
                                         uncertainty =       0.001785461586

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.497132025402
                                         uncertainty =       0.001785461586

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000249282452
  error estimate for blocks of size 2^( 2) =       0.000258177670
  error estimate for blocks of size 2^( 3) =       0.000266092117
  error estimate for blocks of size 2^( 4) =       0.000271889905
  error estimate for blocks of size 2^( 5) =       0.000275087836
  error estimate for blocks of size 2^( 6) =       0.000276370209
  error estimate for blocks of size 2^( 7) =       0.000277028685
  error estimate for blocks of size 2^( 8) =       0.000277526213
  error estimate for blocks of size 2^( 9) =       0.000277060107

      target function =                  N/A
              le_mean =     -22.669583486150
             les_mean =     514.421892992866
             stat err =       0.000276996304
             autocorr =       1.234708769642
              std dev =       0.705077248075
             le_variance =       0.497133925753


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.669583486150        initial  <--
     1.3878e+29     1.3878e+30             0.0000e+00       -22.669583486150
     5.5511e+29     5.5511e+30             0.0000e+00       -22.669583486150
     2.2204e+30     2.2204e+31             0.0000e+00       -22.669583486150

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 173.0847
  </log>
  <optVariables href="FORM.s087.opt.xml">
ci_001                -7.050617e-01 3 1  ON 0
ci_002                -7.059926e-01 3 1  ON 1
ci_003                -3.765135e-02 3 1  ON 2
ci_004                -3.890325e-02 3 1  ON 3
ci_005                 1.612441e-02 3 1  ON 4
ci_006                 1.600090e-02 3 1  ON 5
ci_007                 1.228713e-02 3 1  ON 6
ci_008                 1.246533e-02 3 1  ON 7
ci_009                -1.173869e-02 3 1  ON 8
ci_010                -1.182876e-02 3 1  ON 9
ci_011                -8.176403e-03 3 1  ON 10
ci_012                -8.138278e-03 3 1  ON 11
ci_013                 9.647137e-03 3 1  ON 12
ci_014                 9.360580e-03 3 1  ON 13
ci_015                 1.228715e-02 3 1  ON 14
ci_016                 1.255400e-02 3 1  ON 15
ci_017                 1.088300e-02 3 1  ON 16
ci_018                 1.078149e-02 3 1  ON 17
ci_019                -2.514322e-03 3 1  ON 18
ci_020                -2.423765e-03 3 1  ON 19
ci_021                -8.459776e-03 3 1  ON 20
ci_022                -8.657034e-03 3 1  ON 21
ci_023                 7.805043e-03 3 1  ON 22
ci_024                 8.041852e-03 3 1  ON 23
ci_025                 4.702642e-03 3 1  ON 24
ci_026                 4.273172e-03 3 1  ON 25
ci_027                 6.454089e-03 3 1  ON 26
ci_028                 6.476482e-03 3 1  ON 27
ci_029                -4.877820e-03 3 1  ON 28
ci_030                -4.785596e-03 3 1  ON 29
ci_031                -7.388694e-03 3 1  ON 30
ci_032                -8.123179e-03 3 1  ON 31
ci_033                 4.600637e-03 3 1  ON 32
ci_034                 4.413553e-03 3 1  ON 33
ci_035                 1.126907e-03 3 1  ON 34
ci_036                 1.043146e-03 3 1  ON 35
ci_037                 4.953347e-03 3 1  ON 36
ci_038                 5.099310e-03 3 1  ON 37
ci_039                 5.306386e-03 3 1  ON 38
ci_040                 5.323086e-03 3 1  ON 39
ci_041                 4.970499e-03 3 1  ON 40
ci_042                 5.231233e-03 3 1  ON 41
ci_043                 4.943052e-03 3 1  ON 42
ci_044                 4.944182e-03 3 1  ON 43
ci_045                 3.123967e-03 3 1  ON 44
ci_046                 3.174246e-03 3 1  ON 45
ci_047                -7.790222e-04 3 1  ON 46
ci_048                -5.616836e-04 3 1  ON 47
ci_049                 1.580289e-03 3 1  ON 48
ci_050                 1.792516e-03 3 1  ON 49
ci_051                -1.106651e-03 3 1  ON 50
ci_052                -1.243279e-03 3 1  ON 51
ci_053                -2.610471e-03 3 1  ON 52
ci_054                -2.301978e-03 3 1  ON 53
ci_055                -1.483475e-03 3 1  ON 54
ci_056                -1.376714e-03 3 1  ON 55
ci_057                -1.240708e-03 3 1  ON 56
ci_058                -1.731077e-03 3 1  ON 57
ci_059                 3.171692e-04 3 1  ON 58
ci_060                 1.414703e-04 3 1  ON 59
ci_061                -3.305088e-04 3 1  ON 60
ci_062                -9.499769e-06 3 1  ON 61
ci_063                -5.232922e-04 3 1  ON 62
ci_064                -8.918525e-04 3 1  ON 63
ci_065                -2.408143e-03 3 1  ON 64
ci_066                -2.435285e-03 3 1  ON 65
ci_067                -2.101084e-03 3 1  ON 66
ci_068                -2.473560e-03 3 1  ON 67
ci_069                -2.085964e-04 3 1  ON 68
ci_070                 1.328450e-04 3 1  ON 69
ci_071                -1.874230e-03 3 1  ON 70
ci_072                -1.959430e-03 3 1  ON 71
ci_073                 5.749021e-04 3 1  ON 72
ci_074                 2.857507e-04 3 1  ON 73
ci_075                -2.910323e-04 3 1  ON 74
ci_076                -2.990999e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 2.9422e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s088 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s088 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=88  my_counter=0
  time step      = 5.0000e-02
  blocks         = 250
  steps          = 250
  substeps       = 10
  current        = 0
  target samples = 8.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">250</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">6.2500e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">8.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">6.2500e+04</parameter>
<parameter name="steps" condition="int">250</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2663e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="250">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =8000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 88
    time step          = 0.05
    reference energy   = -22.6301
    reference variance = 0.389799
====================================================
  Execution time = 1.0205e+02
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s088
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 62500 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 6.1031e+04
  VMC Eavg = -2.2669e+01
  VMC Evar = 5.0684e-01
  Total weights = 7.819890957e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.8945e+01
  </log>
</opt>
<opt stage="main" walkers="62500">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.494865115127
                                         uncertainty =       0.001370982012

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.494865115127
                                         uncertainty =       0.001370982012

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000248712848
  error estimate for blocks of size 2^( 2) =       0.000257752186
  error estimate for blocks of size 2^( 3) =       0.000265985847
  error estimate for blocks of size 2^( 4) =       0.000271450994
  error estimate for blocks of size 2^( 5) =       0.000274995314
  error estimate for blocks of size 2^( 6) =       0.000277165922
  error estimate for blocks of size 2^( 7) =       0.000277284478
  error estimate for blocks of size 2^( 8) =       0.000277718207
  error estimate for blocks of size 2^( 9) =       0.000277701998

      target function =                  N/A
              le_mean =     -22.669420067703
             les_mean =     514.409447203018
             stat err =       0.000277467651
             autocorr =       1.244595642640
              std dev =       0.703466164518
             le_variance =       0.494864644622


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266942006770e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.3878e+30, overlap shift 1.3878e+31 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.669420067723       residual = 3.14e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.669420067723       residual = 3.14e-05           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 1.3878e+30 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 5.5511e+30, overlap shift 5.5511e+31 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.669420067723       residual = 3.14e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.669420067723       residual = 3.14e-05           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 5.5511e+30 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 2.2204e+31, overlap shift 2.2204e+32 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.669420067723       residual = 3.14e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.669420067723       residual = 3.14e-05           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 2.2204e+31 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.192734 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.2101e+02
  </log>
  <optVariables href="FORM.s088.opt.xml">
ci_001                -7.050617e-01 3 1  ON 0
ci_002                -7.059926e-01 3 1  ON 1
ci_003                -3.765135e-02 3 1  ON 2
ci_004                -3.890325e-02 3 1  ON 3
ci_005                 1.612441e-02 3 1  ON 4
ci_006                 1.600090e-02 3 1  ON 5
ci_007                 1.228713e-02 3 1  ON 6
ci_008                 1.246533e-02 3 1  ON 7
ci_009                -1.173869e-02 3 1  ON 8
ci_010                -1.182876e-02 3 1  ON 9
ci_011                -8.176403e-03 3 1  ON 10
ci_012                -8.138278e-03 3 1  ON 11
ci_013                 9.647137e-03 3 1  ON 12
ci_014                 9.360580e-03 3 1  ON 13
ci_015                 1.228715e-02 3 1  ON 14
ci_016                 1.255400e-02 3 1  ON 15
ci_017                 1.088300e-02 3 1  ON 16
ci_018                 1.078149e-02 3 1  ON 17
ci_019                -2.514322e-03 3 1  ON 18
ci_020                -2.423765e-03 3 1  ON 19
ci_021                -8.459776e-03 3 1  ON 20
ci_022                -8.657034e-03 3 1  ON 21
ci_023                 7.805043e-03 3 1  ON 22
ci_024                 8.041852e-03 3 1  ON 23
ci_025                 4.702642e-03 3 1  ON 24
ci_026                 4.273172e-03 3 1  ON 25
ci_027                 6.454089e-03 3 1  ON 26
ci_028                 6.476482e-03 3 1  ON 27
ci_029                -4.877820e-03 3 1  ON 28
ci_030                -4.785596e-03 3 1  ON 29
ci_031                -7.388694e-03 3 1  ON 30
ci_032                -8.123179e-03 3 1  ON 31
ci_033                 4.600637e-03 3 1  ON 32
ci_034                 4.413553e-03 3 1  ON 33
ci_035                 1.126907e-03 3 1  ON 34
ci_036                 1.043146e-03 3 1  ON 35
ci_037                 4.953347e-03 3 1  ON 36
ci_038                 5.099310e-03 3 1  ON 37
ci_039                 5.306386e-03 3 1  ON 38
ci_040                 5.323086e-03 3 1  ON 39
ci_041                 4.970499e-03 3 1  ON 40
ci_042                 5.231233e-03 3 1  ON 41
ci_043                 4.943052e-03 3 1  ON 42
ci_044                 4.944182e-03 3 1  ON 43
ci_045                 3.123967e-03 3 1  ON 44
ci_046                 3.174246e-03 3 1  ON 45
ci_047                -7.790222e-04 3 1  ON 46
ci_048                -5.616836e-04 3 1  ON 47
ci_049                 1.580289e-03 3 1  ON 48
ci_050                 1.792516e-03 3 1  ON 49
ci_051                -1.106651e-03 3 1  ON 50
ci_052                -1.243279e-03 3 1  ON 51
ci_053                -2.610471e-03 3 1  ON 52
ci_054                -2.301978e-03 3 1  ON 53
ci_055                -1.483475e-03 3 1  ON 54
ci_056                -1.376714e-03 3 1  ON 55
ci_057                -1.240708e-03 3 1  ON 56
ci_058                -1.731077e-03 3 1  ON 57
ci_059                 3.171692e-04 3 1  ON 58
ci_060                 1.414703e-04 3 1  ON 59
ci_061                -3.305088e-04 3 1  ON 60
ci_062                -9.499769e-06 3 1  ON 61
ci_063                -5.232922e-04 3 1  ON 62
ci_064                -8.918525e-04 3 1  ON 63
ci_065                -2.408143e-03 3 1  ON 64
ci_066                -2.435285e-03 3 1  ON 65
ci_067                -2.101084e-03 3 1  ON 66
ci_068                -2.473560e-03 3 1  ON 67
ci_069                -2.085964e-04 3 1  ON 68
ci_070                 1.328450e-04 3 1  ON 69
ci_071                -1.874230e-03 3 1  ON 70
ci_072                -1.959430e-03 3 1  ON 71
ci_073                 5.749021e-04 3 1  ON 72
ci_074                 2.857507e-04 3 1  ON 73
ci_075                -2.910323e-04 3 1  ON 74
ci_076                -2.990999e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="250">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =8000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 88
    time step          = 0.05
    reference energy   = -22.7022
    reference variance = 0.501271
====================================================
  Execution time = 9.9764e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s088
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 62500 
  VMC Eavg = -2.2670e+01
  VMC Evar = 5.1154e-01
  Total weights = 7.8205e+06
  Execution time = 1.4636e+01
  </log>
</opt>
<opt stage="main" walkers="62500">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.496230359044
                                         uncertainty =       0.001292787292

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.496230359044
                                         uncertainty =       0.001292787292

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000249055403
  error estimate for blocks of size 2^( 2) =       0.000258086828
  error estimate for blocks of size 2^( 3) =       0.000266048110
  error estimate for blocks of size 2^( 4) =       0.000271708817
  error estimate for blocks of size 2^( 5) =       0.000275252390
  error estimate for blocks of size 2^( 6) =       0.000276428151
  error estimate for blocks of size 2^( 7) =       0.000277559220
  error estimate for blocks of size 2^( 8) =       0.000278930444
  error estimate for blocks of size 2^( 9) =       0.000279239092

      target function =                  N/A
              le_mean =     -22.669693137940
             les_mean =     514.426527957532
             stat err =       0.000278039227
             autocorr =       1.246293150352
              std dev =       0.704435058283
             le_variance =       0.496228751338

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.496230359044
                                         uncertainty =       0.001292787292

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.496230359044
                                         uncertainty =       0.001292787292

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000249055403
  error estimate for blocks of size 2^( 2) =       0.000258086828
  error estimate for blocks of size 2^( 3) =       0.000266048110
  error estimate for blocks of size 2^( 4) =       0.000271708817
  error estimate for blocks of size 2^( 5) =       0.000275252390
  error estimate for blocks of size 2^( 6) =       0.000276428151
  error estimate for blocks of size 2^( 7) =       0.000277559220
  error estimate for blocks of size 2^( 8) =       0.000278930444
  error estimate for blocks of size 2^( 9) =       0.000279239092

      target function =                  N/A
              le_mean =     -22.669693137940
             les_mean =     514.426527957532
             stat err =       0.000278039227
             autocorr =       1.246293150352
              std dev =       0.704435058283
             le_variance =       0.496228751338

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.496230359044
                                         uncertainty =       0.001292787292

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.496230359044
                                         uncertainty =       0.001292787292

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000249055403
  error estimate for blocks of size 2^( 2) =       0.000258086828
  error estimate for blocks of size 2^( 3) =       0.000266048110
  error estimate for blocks of size 2^( 4) =       0.000271708817
  error estimate for blocks of size 2^( 5) =       0.000275252390
  error estimate for blocks of size 2^( 6) =       0.000276428151
  error estimate for blocks of size 2^( 7) =       0.000277559220
  error estimate for blocks of size 2^( 8) =       0.000278930444
  error estimate for blocks of size 2^( 9) =       0.000279239092

      target function =                  N/A
              le_mean =     -22.669693137940
             les_mean =     514.426527957532
             stat err =       0.000278039227
             autocorr =       1.246293150352
              std dev =       0.704435058283
             le_variance =       0.496228751338

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.496230359044
                                         uncertainty =       0.001292787292

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.496230359044
                                         uncertainty =       0.001292787292

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000249055403
  error estimate for blocks of size 2^( 2) =       0.000258086828
  error estimate for blocks of size 2^( 3) =       0.000266048110
  error estimate for blocks of size 2^( 4) =       0.000271708817
  error estimate for blocks of size 2^( 5) =       0.000275252390
  error estimate for blocks of size 2^( 6) =       0.000276428151
  error estimate for blocks of size 2^( 7) =       0.000277559220
  error estimate for blocks of size 2^( 8) =       0.000278930444
  error estimate for blocks of size 2^( 9) =       0.000279239092

      target function =                  N/A
              le_mean =     -22.669693137940
             les_mean =     514.426527957532
             stat err =       0.000278039227
             autocorr =       1.246293150352
              std dev =       0.704435058283
             le_variance =       0.496228751338


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.669693137940        initial  <--
     1.3878e+30     1.3878e+31             0.0000e+00       -22.669693137940
     5.5511e+30     5.5511e+31             0.0000e+00       -22.669693137940
     2.2204e+31     2.2204e+32             0.0000e+00       -22.669693137940

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 172.9599
  </log>
  <optVariables href="FORM.s088.opt.xml">
ci_001                -7.050617e-01 3 1  ON 0
ci_002                -7.059926e-01 3 1  ON 1
ci_003                -3.765135e-02 3 1  ON 2
ci_004                -3.890325e-02 3 1  ON 3
ci_005                 1.612441e-02 3 1  ON 4
ci_006                 1.600090e-02 3 1  ON 5
ci_007                 1.228713e-02 3 1  ON 6
ci_008                 1.246533e-02 3 1  ON 7
ci_009                -1.173869e-02 3 1  ON 8
ci_010                -1.182876e-02 3 1  ON 9
ci_011                -8.176403e-03 3 1  ON 10
ci_012                -8.138278e-03 3 1  ON 11
ci_013                 9.647137e-03 3 1  ON 12
ci_014                 9.360580e-03 3 1  ON 13
ci_015                 1.228715e-02 3 1  ON 14
ci_016                 1.255400e-02 3 1  ON 15
ci_017                 1.088300e-02 3 1  ON 16
ci_018                 1.078149e-02 3 1  ON 17
ci_019                -2.514322e-03 3 1  ON 18
ci_020                -2.423765e-03 3 1  ON 19
ci_021                -8.459776e-03 3 1  ON 20
ci_022                -8.657034e-03 3 1  ON 21
ci_023                 7.805043e-03 3 1  ON 22
ci_024                 8.041852e-03 3 1  ON 23
ci_025                 4.702642e-03 3 1  ON 24
ci_026                 4.273172e-03 3 1  ON 25
ci_027                 6.454089e-03 3 1  ON 26
ci_028                 6.476482e-03 3 1  ON 27
ci_029                -4.877820e-03 3 1  ON 28
ci_030                -4.785596e-03 3 1  ON 29
ci_031                -7.388694e-03 3 1  ON 30
ci_032                -8.123179e-03 3 1  ON 31
ci_033                 4.600637e-03 3 1  ON 32
ci_034                 4.413553e-03 3 1  ON 33
ci_035                 1.126907e-03 3 1  ON 34
ci_036                 1.043146e-03 3 1  ON 35
ci_037                 4.953347e-03 3 1  ON 36
ci_038                 5.099310e-03 3 1  ON 37
ci_039                 5.306386e-03 3 1  ON 38
ci_040                 5.323086e-03 3 1  ON 39
ci_041                 4.970499e-03 3 1  ON 40
ci_042                 5.231233e-03 3 1  ON 41
ci_043                 4.943052e-03 3 1  ON 42
ci_044                 4.944182e-03 3 1  ON 43
ci_045                 3.123967e-03 3 1  ON 44
ci_046                 3.174246e-03 3 1  ON 45
ci_047                -7.790222e-04 3 1  ON 46
ci_048                -5.616836e-04 3 1  ON 47
ci_049                 1.580289e-03 3 1  ON 48
ci_050                 1.792516e-03 3 1  ON 49
ci_051                -1.106651e-03 3 1  ON 50
ci_052                -1.243279e-03 3 1  ON 51
ci_053                -2.610471e-03 3 1  ON 52
ci_054                -2.301978e-03 3 1  ON 53
ci_055                -1.483475e-03 3 1  ON 54
ci_056                -1.376714e-03 3 1  ON 55
ci_057                -1.240708e-03 3 1  ON 56
ci_058                -1.731077e-03 3 1  ON 57
ci_059                 3.171692e-04 3 1  ON 58
ci_060                 1.414703e-04 3 1  ON 59
ci_061                -3.305088e-04 3 1  ON 60
ci_062                -9.499769e-06 3 1  ON 61
ci_063                -5.232922e-04 3 1  ON 62
ci_064                -8.918525e-04 3 1  ON 63
ci_065                -2.408143e-03 3 1  ON 64
ci_066                -2.435285e-03 3 1  ON 65
ci_067                -2.101084e-03 3 1  ON 66
ci_068                -2.473560e-03 3 1  ON 67
ci_069                -2.085964e-04 3 1  ON 68
ci_070                 1.328450e-04 3 1  ON 69
ci_071                -1.874230e-03 3 1  ON 70
ci_072                -1.959430e-03 3 1  ON 71
ci_073                 5.749021e-04 3 1  ON 72
ci_074                 2.857507e-04 3 1  ON 73
ci_075                -2.910323e-04 3 1  ON 74
ci_076                -2.990999e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 2.9398e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s089 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s089 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=89  my_counter=0
  time step      = 5.0000e-02
  blocks         = 250
  steps          = 250
  substeps       = 10
  current        = 0
  target samples = 8.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">250</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">6.2500e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">8.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">6.2500e+04</parameter>
<parameter name="steps" condition="int">250</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2663e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="250">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =8000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 89
    time step          = 0.05
    reference energy   = -22.5541
    reference variance = 0.576659
====================================================
  Execution time = 1.0220e+02
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s089
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 62500 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 6.1127e+04
  VMC Eavg = -2.2670e+01
  VMC Evar = 5.1103e-01
  Total weights = 7.820667089e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.8889e+01
  </log>
</opt>
<opt stage="main" walkers="62500">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.496255798254
                                         uncertainty =       0.001609804419

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.496255798254
                                         uncertainty =       0.001609804419

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000249062017
  error estimate for blocks of size 2^( 2) =       0.000258118221
  error estimate for blocks of size 2^( 3) =       0.000266199464
  error estimate for blocks of size 2^( 4) =       0.000271641228
  error estimate for blocks of size 2^( 5) =       0.000275036789
  error estimate for blocks of size 2^( 6) =       0.000276470561
  error estimate for blocks of size 2^( 7) =       0.000277054843
  error estimate for blocks of size 2^( 8) =       0.000276685042
  error estimate for blocks of size 2^( 9) =       0.000276486954

      target function =                  N/A
              le_mean =     -22.669991313268
             les_mean =     514.439535852486
             stat err =       0.000276674350
             autocorr =       1.234021694317
              std dev =       0.704453764588
             le_variance =       0.496255106442


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266999131327e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.3878e+31, overlap shift 1.3878e+32 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.669991313295       residual = 5.56e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.669991313295       residual = 7.14e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.669991313480       residual = 5.56e-05           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 1.3878e+31 is 1.465756e-35

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 5.5511e+31, overlap shift 5.5511e+32 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.669991313295       residual = 5.56e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.669991313295       residual = 7.14e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.669991312549       residual = 5.56e-05           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 5.5511e+31 is 3.664390e-36

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 2.2204e+32, overlap shift 2.2204e+33 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.669991313295       residual = 5.56e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.669991313295       residual = 7.14e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.669991313295       residual = 1.83e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.669991314411       residual = 5.83e-05           smallest_sin_value = 1.00e+00
davidson iteration    4 stopping due to too large eigenvalue change
davidson solver did not converge after          4 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 2.2204e+32 is 9.514216e-37

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.194974 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.2110e+02
  </log>
  <optVariables href="FORM.s089.opt.xml">
ci_001                -7.050617e-01 3 1  ON 0
ci_002                -7.059926e-01 3 1  ON 1
ci_003                -3.765135e-02 3 1  ON 2
ci_004                -3.890325e-02 3 1  ON 3
ci_005                 1.612441e-02 3 1  ON 4
ci_006                 1.600090e-02 3 1  ON 5
ci_007                 1.228713e-02 3 1  ON 6
ci_008                 1.246533e-02 3 1  ON 7
ci_009                -1.173869e-02 3 1  ON 8
ci_010                -1.182876e-02 3 1  ON 9
ci_011                -8.176403e-03 3 1  ON 10
ci_012                -8.138278e-03 3 1  ON 11
ci_013                 9.647137e-03 3 1  ON 12
ci_014                 9.360580e-03 3 1  ON 13
ci_015                 1.228715e-02 3 1  ON 14
ci_016                 1.255400e-02 3 1  ON 15
ci_017                 1.088300e-02 3 1  ON 16
ci_018                 1.078149e-02 3 1  ON 17
ci_019                -2.514322e-03 3 1  ON 18
ci_020                -2.423765e-03 3 1  ON 19
ci_021                -8.459776e-03 3 1  ON 20
ci_022                -8.657034e-03 3 1  ON 21
ci_023                 7.805043e-03 3 1  ON 22
ci_024                 8.041852e-03 3 1  ON 23
ci_025                 4.702642e-03 3 1  ON 24
ci_026                 4.273172e-03 3 1  ON 25
ci_027                 6.454089e-03 3 1  ON 26
ci_028                 6.476482e-03 3 1  ON 27
ci_029                -4.877820e-03 3 1  ON 28
ci_030                -4.785596e-03 3 1  ON 29
ci_031                -7.388694e-03 3 1  ON 30
ci_032                -8.123179e-03 3 1  ON 31
ci_033                 4.600637e-03 3 1  ON 32
ci_034                 4.413553e-03 3 1  ON 33
ci_035                 1.126907e-03 3 1  ON 34
ci_036                 1.043146e-03 3 1  ON 35
ci_037                 4.953347e-03 3 1  ON 36
ci_038                 5.099310e-03 3 1  ON 37
ci_039                 5.306386e-03 3 1  ON 38
ci_040                 5.323086e-03 3 1  ON 39
ci_041                 4.970499e-03 3 1  ON 40
ci_042                 5.231233e-03 3 1  ON 41
ci_043                 4.943052e-03 3 1  ON 42
ci_044                 4.944182e-03 3 1  ON 43
ci_045                 3.123967e-03 3 1  ON 44
ci_046                 3.174246e-03 3 1  ON 45
ci_047                -7.790222e-04 3 1  ON 46
ci_048                -5.616836e-04 3 1  ON 47
ci_049                 1.580289e-03 3 1  ON 48
ci_050                 1.792516e-03 3 1  ON 49
ci_051                -1.106651e-03 3 1  ON 50
ci_052                -1.243279e-03 3 1  ON 51
ci_053                -2.610471e-03 3 1  ON 52
ci_054                -2.301978e-03 3 1  ON 53
ci_055                -1.483475e-03 3 1  ON 54
ci_056                -1.376714e-03 3 1  ON 55
ci_057                -1.240708e-03 3 1  ON 56
ci_058                -1.731077e-03 3 1  ON 57
ci_059                 3.171692e-04 3 1  ON 58
ci_060                 1.414703e-04 3 1  ON 59
ci_061                -3.305088e-04 3 1  ON 60
ci_062                -9.499769e-06 3 1  ON 61
ci_063                -5.232922e-04 3 1  ON 62
ci_064                -8.918525e-04 3 1  ON 63
ci_065                -2.408143e-03 3 1  ON 64
ci_066                -2.435285e-03 3 1  ON 65
ci_067                -2.101084e-03 3 1  ON 66
ci_068                -2.473560e-03 3 1  ON 67
ci_069                -2.085964e-04 3 1  ON 68
ci_070                 1.328450e-04 3 1  ON 69
ci_071                -1.874230e-03 3 1  ON 70
ci_072                -1.959430e-03 3 1  ON 71
ci_073                 5.749021e-04 3 1  ON 72
ci_074                 2.857507e-04 3 1  ON 73
ci_075                -2.910323e-04 3 1  ON 74
ci_076                -2.990999e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="250">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =8000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 89
    time step          = 0.05
    reference energy   = -22.5898
    reference variance = 0.457017
====================================================
  Execution time = 1.0020e+02
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s089
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 62500 
  VMC Eavg = -2.2670e+01
  VMC Evar = 5.1088e-01
  Total weights = 7.8209e+06
  Execution time = 1.4631e+01
  </log>
</opt>
<opt stage="main" walkers="62500">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.497325703053
                                         uncertainty =       0.001515847739

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.497325703053
                                         uncertainty =       0.001515847739

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000249330160
  error estimate for blocks of size 2^( 2) =       0.000258309280
  error estimate for blocks of size 2^( 3) =       0.000266367453
  error estimate for blocks of size 2^( 4) =       0.000272141622
  error estimate for blocks of size 2^( 5) =       0.000275375241
  error estimate for blocks of size 2^( 6) =       0.000276935407
  error estimate for blocks of size 2^( 7) =       0.000277962277
  error estimate for blocks of size 2^( 8) =       0.000278648183
  error estimate for blocks of size 2^( 9) =       0.000278700431

      target function =                  N/A
              le_mean =     -22.669869208246
             les_mean =     514.433854819384
             stat err =       0.000278061574
             autocorr =       1.243747791015
              std dev =       0.705212188525
             le_variance =       0.497324230845

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.497325703053
                                         uncertainty =       0.001515847739

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.497325703053
                                         uncertainty =       0.001515847739

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000249330160
  error estimate for blocks of size 2^( 2) =       0.000258309280
  error estimate for blocks of size 2^( 3) =       0.000266367453
  error estimate for blocks of size 2^( 4) =       0.000272141622
  error estimate for blocks of size 2^( 5) =       0.000275375241
  error estimate for blocks of size 2^( 6) =       0.000276935407
  error estimate for blocks of size 2^( 7) =       0.000277962277
  error estimate for blocks of size 2^( 8) =       0.000278648183
  error estimate for blocks of size 2^( 9) =       0.000278700431

      target function =                  N/A
              le_mean =     -22.669869208246
             les_mean =     514.433854819384
             stat err =       0.000278061574
             autocorr =       1.243747791015
              std dev =       0.705212188525
             le_variance =       0.497324230845

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.497325703053
                                         uncertainty =       0.001515847739

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.497325703053
                                         uncertainty =       0.001515847739

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000249330160
  error estimate for blocks of size 2^( 2) =       0.000258309280
  error estimate for blocks of size 2^( 3) =       0.000266367453
  error estimate for blocks of size 2^( 4) =       0.000272141622
  error estimate for blocks of size 2^( 5) =       0.000275375241
  error estimate for blocks of size 2^( 6) =       0.000276935407
  error estimate for blocks of size 2^( 7) =       0.000277962277
  error estimate for blocks of size 2^( 8) =       0.000278648183
  error estimate for blocks of size 2^( 9) =       0.000278700431

      target function =                  N/A
              le_mean =     -22.669869208246
             les_mean =     514.433854819384
             stat err =       0.000278061574
             autocorr =       1.243747791015
              std dev =       0.705212188525
             le_variance =       0.497324230845

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.497325703053
                                         uncertainty =       0.001515847739

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.497325703053
                                         uncertainty =       0.001515847739

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000249330160
  error estimate for blocks of size 2^( 2) =       0.000258309280
  error estimate for blocks of size 2^( 3) =       0.000266367453
  error estimate for blocks of size 2^( 4) =       0.000272141622
  error estimate for blocks of size 2^( 5) =       0.000275375241
  error estimate for blocks of size 2^( 6) =       0.000276935407
  error estimate for blocks of size 2^( 7) =       0.000277962277
  error estimate for blocks of size 2^( 8) =       0.000278648183
  error estimate for blocks of size 2^( 9) =       0.000278700431

      target function =                  N/A
              le_mean =     -22.669869208246
             les_mean =     514.433854819384
             stat err =       0.000278061574
             autocorr =       1.243747791015
              std dev =       0.705212188525
             le_variance =       0.497324230845


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.669869208246        initial  <--
     1.3878e+31     1.3878e+32             1.4658e-35       -22.669869208246
     5.5511e+31     5.5511e+32             3.6644e-36       -22.669869208246
     2.2204e+32     2.2204e+33             9.5142e-37       -22.669869208246

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 173.3884
  </log>
  <optVariables href="FORM.s089.opt.xml">
ci_001                -7.050617e-01 3 1  ON 0
ci_002                -7.059926e-01 3 1  ON 1
ci_003                -3.765135e-02 3 1  ON 2
ci_004                -3.890325e-02 3 1  ON 3
ci_005                 1.612441e-02 3 1  ON 4
ci_006                 1.600090e-02 3 1  ON 5
ci_007                 1.228713e-02 3 1  ON 6
ci_008                 1.246533e-02 3 1  ON 7
ci_009                -1.173869e-02 3 1  ON 8
ci_010                -1.182876e-02 3 1  ON 9
ci_011                -8.176403e-03 3 1  ON 10
ci_012                -8.138278e-03 3 1  ON 11
ci_013                 9.647137e-03 3 1  ON 12
ci_014                 9.360580e-03 3 1  ON 13
ci_015                 1.228715e-02 3 1  ON 14
ci_016                 1.255400e-02 3 1  ON 15
ci_017                 1.088300e-02 3 1  ON 16
ci_018                 1.078149e-02 3 1  ON 17
ci_019                -2.514322e-03 3 1  ON 18
ci_020                -2.423765e-03 3 1  ON 19
ci_021                -8.459776e-03 3 1  ON 20
ci_022                -8.657034e-03 3 1  ON 21
ci_023                 7.805043e-03 3 1  ON 22
ci_024                 8.041852e-03 3 1  ON 23
ci_025                 4.702642e-03 3 1  ON 24
ci_026                 4.273172e-03 3 1  ON 25
ci_027                 6.454089e-03 3 1  ON 26
ci_028                 6.476482e-03 3 1  ON 27
ci_029                -4.877820e-03 3 1  ON 28
ci_030                -4.785596e-03 3 1  ON 29
ci_031                -7.388694e-03 3 1  ON 30
ci_032                -8.123179e-03 3 1  ON 31
ci_033                 4.600637e-03 3 1  ON 32
ci_034                 4.413553e-03 3 1  ON 33
ci_035                 1.126907e-03 3 1  ON 34
ci_036                 1.043146e-03 3 1  ON 35
ci_037                 4.953347e-03 3 1  ON 36
ci_038                 5.099310e-03 3 1  ON 37
ci_039                 5.306386e-03 3 1  ON 38
ci_040                 5.323086e-03 3 1  ON 39
ci_041                 4.970499e-03 3 1  ON 40
ci_042                 5.231233e-03 3 1  ON 41
ci_043                 4.943052e-03 3 1  ON 42
ci_044                 4.944182e-03 3 1  ON 43
ci_045                 3.123967e-03 3 1  ON 44
ci_046                 3.174246e-03 3 1  ON 45
ci_047                -7.790222e-04 3 1  ON 46
ci_048                -5.616836e-04 3 1  ON 47
ci_049                 1.580289e-03 3 1  ON 48
ci_050                 1.792516e-03 3 1  ON 49
ci_051                -1.106651e-03 3 1  ON 50
ci_052                -1.243279e-03 3 1  ON 51
ci_053                -2.610471e-03 3 1  ON 52
ci_054                -2.301978e-03 3 1  ON 53
ci_055                -1.483475e-03 3 1  ON 54
ci_056                -1.376714e-03 3 1  ON 55
ci_057                -1.240708e-03 3 1  ON 56
ci_058                -1.731077e-03 3 1  ON 57
ci_059                 3.171692e-04 3 1  ON 58
ci_060                 1.414703e-04 3 1  ON 59
ci_061                -3.305088e-04 3 1  ON 60
ci_062                -9.499769e-06 3 1  ON 61
ci_063                -5.232922e-04 3 1  ON 62
ci_064                -8.918525e-04 3 1  ON 63
ci_065                -2.408143e-03 3 1  ON 64
ci_066                -2.435285e-03 3 1  ON 65
ci_067                -2.101084e-03 3 1  ON 66
ci_068                -2.473560e-03 3 1  ON 67
ci_069                -2.085964e-04 3 1  ON 68
ci_070                 1.328450e-04 3 1  ON 69
ci_071                -1.874230e-03 3 1  ON 70
ci_072                -1.959430e-03 3 1  ON 71
ci_073                 5.749021e-04 3 1  ON 72
ci_074                 2.857507e-04 3 1  ON 73
ci_075                -2.910323e-04 3 1  ON 74
ci_076                -2.990999e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 2.9450e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s090 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s090 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=90  my_counter=0
  time step      = 5.0000e-02
  blocks         = 250
  steps          = 250
  substeps       = 10
  current        = 0
  target samples = 8.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">250</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">6.2500e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">8.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">6.2500e+04</parameter>
<parameter name="steps" condition="int">250</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2662e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="250">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =8000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 90
    time step          = 0.05
    reference energy   = -22.6742
    reference variance = 0.31461
====================================================
  Execution time = 1.0202e+02
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s090
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 62500 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 6.1068e+04
  VMC Eavg = -2.2670e+01
  VMC Evar = 5.0908e-01
  Total weights = 7.820941992e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.8978e+01
  </log>
</opt>
<opt stage="main" walkers="62500">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.497468192902
                                         uncertainty =       0.001475337912

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.497468192902
                                         uncertainty =       0.001475337912

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000249365953
  error estimate for blocks of size 2^( 2) =       0.000258332316
  error estimate for blocks of size 2^( 3) =       0.000266365461
  error estimate for blocks of size 2^( 4) =       0.000272004798
  error estimate for blocks of size 2^( 5) =       0.000275381895
  error estimate for blocks of size 2^( 6) =       0.000277140672
  error estimate for blocks of size 2^( 7) =       0.000278093696
  error estimate for blocks of size 2^( 8) =       0.000279513031
  error estimate for blocks of size 2^( 9) =       0.000280434767

      target function =                  N/A
              le_mean =     -22.669819589853
             les_mean =     514.429796621806
             stat err =       0.000278795542
             autocorr =       1.249963514220
              std dev =       0.705313424158
             le_variance =       0.497467026298


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266981958985e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.3878e+32, overlap shift 1.3878e+33 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.669819589874       residual = 4.44e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.669819589874       residual = 4.44e-05           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 1.3878e+32 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 5.5511e+32, overlap shift 5.5511e+33 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.669819589874       residual = 4.44e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.669819589874       residual = 4.44e-05           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 5.5511e+32 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 2.2204e+33, overlap shift 2.2204e+34 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.669819589874       residual = 4.44e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.669819589874       residual = 4.44e-05           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 2.2204e+33 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.196112 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.2102e+02
  </log>
  <optVariables href="FORM.s090.opt.xml">
ci_001                -7.050617e-01 3 1  ON 0
ci_002                -7.059926e-01 3 1  ON 1
ci_003                -3.765135e-02 3 1  ON 2
ci_004                -3.890325e-02 3 1  ON 3
ci_005                 1.612441e-02 3 1  ON 4
ci_006                 1.600090e-02 3 1  ON 5
ci_007                 1.228713e-02 3 1  ON 6
ci_008                 1.246533e-02 3 1  ON 7
ci_009                -1.173869e-02 3 1  ON 8
ci_010                -1.182876e-02 3 1  ON 9
ci_011                -8.176403e-03 3 1  ON 10
ci_012                -8.138278e-03 3 1  ON 11
ci_013                 9.647137e-03 3 1  ON 12
ci_014                 9.360580e-03 3 1  ON 13
ci_015                 1.228715e-02 3 1  ON 14
ci_016                 1.255400e-02 3 1  ON 15
ci_017                 1.088300e-02 3 1  ON 16
ci_018                 1.078149e-02 3 1  ON 17
ci_019                -2.514322e-03 3 1  ON 18
ci_020                -2.423765e-03 3 1  ON 19
ci_021                -8.459776e-03 3 1  ON 20
ci_022                -8.657034e-03 3 1  ON 21
ci_023                 7.805043e-03 3 1  ON 22
ci_024                 8.041852e-03 3 1  ON 23
ci_025                 4.702642e-03 3 1  ON 24
ci_026                 4.273172e-03 3 1  ON 25
ci_027                 6.454089e-03 3 1  ON 26
ci_028                 6.476482e-03 3 1  ON 27
ci_029                -4.877820e-03 3 1  ON 28
ci_030                -4.785596e-03 3 1  ON 29
ci_031                -7.388694e-03 3 1  ON 30
ci_032                -8.123179e-03 3 1  ON 31
ci_033                 4.600637e-03 3 1  ON 32
ci_034                 4.413553e-03 3 1  ON 33
ci_035                 1.126907e-03 3 1  ON 34
ci_036                 1.043146e-03 3 1  ON 35
ci_037                 4.953347e-03 3 1  ON 36
ci_038                 5.099310e-03 3 1  ON 37
ci_039                 5.306386e-03 3 1  ON 38
ci_040                 5.323086e-03 3 1  ON 39
ci_041                 4.970499e-03 3 1  ON 40
ci_042                 5.231233e-03 3 1  ON 41
ci_043                 4.943052e-03 3 1  ON 42
ci_044                 4.944182e-03 3 1  ON 43
ci_045                 3.123967e-03 3 1  ON 44
ci_046                 3.174246e-03 3 1  ON 45
ci_047                -7.790222e-04 3 1  ON 46
ci_048                -5.616836e-04 3 1  ON 47
ci_049                 1.580289e-03 3 1  ON 48
ci_050                 1.792516e-03 3 1  ON 49
ci_051                -1.106651e-03 3 1  ON 50
ci_052                -1.243279e-03 3 1  ON 51
ci_053                -2.610471e-03 3 1  ON 52
ci_054                -2.301978e-03 3 1  ON 53
ci_055                -1.483475e-03 3 1  ON 54
ci_056                -1.376714e-03 3 1  ON 55
ci_057                -1.240708e-03 3 1  ON 56
ci_058                -1.731077e-03 3 1  ON 57
ci_059                 3.171692e-04 3 1  ON 58
ci_060                 1.414703e-04 3 1  ON 59
ci_061                -3.305088e-04 3 1  ON 60
ci_062                -9.499769e-06 3 1  ON 61
ci_063                -5.232922e-04 3 1  ON 62
ci_064                -8.918525e-04 3 1  ON 63
ci_065                -2.408143e-03 3 1  ON 64
ci_066                -2.435285e-03 3 1  ON 65
ci_067                -2.101084e-03 3 1  ON 66
ci_068                -2.473560e-03 3 1  ON 67
ci_069                -2.085964e-04 3 1  ON 68
ci_070                 1.328450e-04 3 1  ON 69
ci_071                -1.874230e-03 3 1  ON 70
ci_072                -1.959430e-03 3 1  ON 71
ci_073                 5.749021e-04 3 1  ON 72
ci_074                 2.857507e-04 3 1  ON 73
ci_075                -2.910323e-04 3 1  ON 74
ci_076                -2.990999e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="250">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =8000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 90
    time step          = 0.05
    reference energy   = -22.6782
    reference variance = 0.30871
====================================================
  Execution time = 1.0035e+02
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s090
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 62500 
  VMC Eavg = -2.2670e+01
  VMC Evar = 5.0949e-01
  Total weights = 7.8217e+06
  Execution time = 1.4646e+01
  </log>
</opt>
<opt stage="main" walkers="62500">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.496116240898
                                         uncertainty =       0.001433421044

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.496116240898
                                         uncertainty =       0.001433421044

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000249027367
  error estimate for blocks of size 2^( 2) =       0.000258019218
  error estimate for blocks of size 2^( 3) =       0.000266163281
  error estimate for blocks of size 2^( 4) =       0.000271991546
  error estimate for blocks of size 2^( 5) =       0.000275131175
  error estimate for blocks of size 2^( 6) =       0.000276430198
  error estimate for blocks of size 2^( 7) =       0.000277170933
  error estimate for blocks of size 2^( 8) =       0.000277451749
  error estimate for blocks of size 2^( 9) =       0.000278516120

      target function =                  N/A
              le_mean =     -22.670022350324
             les_mean =     514.439407669786
             stat err =       0.000277392250
             autocorr =       1.240779169832
              std dev =       0.704355759589
             le_variance =       0.496117036067

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.496116240898
                                         uncertainty =       0.001433421044

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.496116240898
                                         uncertainty =       0.001433421044

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000249027367
  error estimate for blocks of size 2^( 2) =       0.000258019218
  error estimate for blocks of size 2^( 3) =       0.000266163281
  error estimate for blocks of size 2^( 4) =       0.000271991546
  error estimate for blocks of size 2^( 5) =       0.000275131175
  error estimate for blocks of size 2^( 6) =       0.000276430198
  error estimate for blocks of size 2^( 7) =       0.000277170933
  error estimate for blocks of size 2^( 8) =       0.000277451749
  error estimate for blocks of size 2^( 9) =       0.000278516120

      target function =                  N/A
              le_mean =     -22.670022350324
             les_mean =     514.439407669786
             stat err =       0.000277392250
             autocorr =       1.240779169832
              std dev =       0.704355759589
             le_variance =       0.496117036067

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.496116240898
                                         uncertainty =       0.001433421044

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.496116240898
                                         uncertainty =       0.001433421044

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000249027367
  error estimate for blocks of size 2^( 2) =       0.000258019218
  error estimate for blocks of size 2^( 3) =       0.000266163281
  error estimate for blocks of size 2^( 4) =       0.000271991546
  error estimate for blocks of size 2^( 5) =       0.000275131175
  error estimate for blocks of size 2^( 6) =       0.000276430198
  error estimate for blocks of size 2^( 7) =       0.000277170933
  error estimate for blocks of size 2^( 8) =       0.000277451749
  error estimate for blocks of size 2^( 9) =       0.000278516120

      target function =                  N/A
              le_mean =     -22.670022350324
             les_mean =     514.439407669786
             stat err =       0.000277392250
             autocorr =       1.240779169832
              std dev =       0.704355759589
             le_variance =       0.496117036067

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.496116240898
                                         uncertainty =       0.001433421044

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.496116240898
                                         uncertainty =       0.001433421044

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000249027367
  error estimate for blocks of size 2^( 2) =       0.000258019218
  error estimate for blocks of size 2^( 3) =       0.000266163281
  error estimate for blocks of size 2^( 4) =       0.000271991546
  error estimate for blocks of size 2^( 5) =       0.000275131175
  error estimate for blocks of size 2^( 6) =       0.000276430198
  error estimate for blocks of size 2^( 7) =       0.000277170933
  error estimate for blocks of size 2^( 8) =       0.000277451749
  error estimate for blocks of size 2^( 9) =       0.000278516120

      target function =                  N/A
              le_mean =     -22.670022350324
             les_mean =     514.439407669786
             stat err =       0.000277392250
             autocorr =       1.240779169832
              std dev =       0.704355759589
             le_variance =       0.496117036067


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.670022350324        initial  <--
     1.3878e+32     1.3878e+33             0.0000e+00       -22.670022350324
     5.5511e+32     5.5511e+33             0.0000e+00       -22.670022350324
     2.2204e+33     2.2204e+34             0.0000e+00       -22.670022350324

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 173.5950
  </log>
  <optVariables href="FORM.s090.opt.xml">
ci_001                -7.050617e-01 3 1  ON 0
ci_002                -7.059926e-01 3 1  ON 1
ci_003                -3.765135e-02 3 1  ON 2
ci_004                -3.890325e-02 3 1  ON 3
ci_005                 1.612441e-02 3 1  ON 4
ci_006                 1.600090e-02 3 1  ON 5
ci_007                 1.228713e-02 3 1  ON 6
ci_008                 1.246533e-02 3 1  ON 7
ci_009                -1.173869e-02 3 1  ON 8
ci_010                -1.182876e-02 3 1  ON 9
ci_011                -8.176403e-03 3 1  ON 10
ci_012                -8.138278e-03 3 1  ON 11
ci_013                 9.647137e-03 3 1  ON 12
ci_014                 9.360580e-03 3 1  ON 13
ci_015                 1.228715e-02 3 1  ON 14
ci_016                 1.255400e-02 3 1  ON 15
ci_017                 1.088300e-02 3 1  ON 16
ci_018                 1.078149e-02 3 1  ON 17
ci_019                -2.514322e-03 3 1  ON 18
ci_020                -2.423765e-03 3 1  ON 19
ci_021                -8.459776e-03 3 1  ON 20
ci_022                -8.657034e-03 3 1  ON 21
ci_023                 7.805043e-03 3 1  ON 22
ci_024                 8.041852e-03 3 1  ON 23
ci_025                 4.702642e-03 3 1  ON 24
ci_026                 4.273172e-03 3 1  ON 25
ci_027                 6.454089e-03 3 1  ON 26
ci_028                 6.476482e-03 3 1  ON 27
ci_029                -4.877820e-03 3 1  ON 28
ci_030                -4.785596e-03 3 1  ON 29
ci_031                -7.388694e-03 3 1  ON 30
ci_032                -8.123179e-03 3 1  ON 31
ci_033                 4.600637e-03 3 1  ON 32
ci_034                 4.413553e-03 3 1  ON 33
ci_035                 1.126907e-03 3 1  ON 34
ci_036                 1.043146e-03 3 1  ON 35
ci_037                 4.953347e-03 3 1  ON 36
ci_038                 5.099310e-03 3 1  ON 37
ci_039                 5.306386e-03 3 1  ON 38
ci_040                 5.323086e-03 3 1  ON 39
ci_041                 4.970499e-03 3 1  ON 40
ci_042                 5.231233e-03 3 1  ON 41
ci_043                 4.943052e-03 3 1  ON 42
ci_044                 4.944182e-03 3 1  ON 43
ci_045                 3.123967e-03 3 1  ON 44
ci_046                 3.174246e-03 3 1  ON 45
ci_047                -7.790222e-04 3 1  ON 46
ci_048                -5.616836e-04 3 1  ON 47
ci_049                 1.580289e-03 3 1  ON 48
ci_050                 1.792516e-03 3 1  ON 49
ci_051                -1.106651e-03 3 1  ON 50
ci_052                -1.243279e-03 3 1  ON 51
ci_053                -2.610471e-03 3 1  ON 52
ci_054                -2.301978e-03 3 1  ON 53
ci_055                -1.483475e-03 3 1  ON 54
ci_056                -1.376714e-03 3 1  ON 55
ci_057                -1.240708e-03 3 1  ON 56
ci_058                -1.731077e-03 3 1  ON 57
ci_059                 3.171692e-04 3 1  ON 58
ci_060                 1.414703e-04 3 1  ON 59
ci_061                -3.305088e-04 3 1  ON 60
ci_062                -9.499769e-06 3 1  ON 61
ci_063                -5.232922e-04 3 1  ON 62
ci_064                -8.918525e-04 3 1  ON 63
ci_065                -2.408143e-03 3 1  ON 64
ci_066                -2.435285e-03 3 1  ON 65
ci_067                -2.101084e-03 3 1  ON 66
ci_068                -2.473560e-03 3 1  ON 67
ci_069                -2.085964e-04 3 1  ON 68
ci_070                 1.328450e-04 3 1  ON 69
ci_071                -1.874230e-03 3 1  ON 70
ci_072                -1.959430e-03 3 1  ON 71
ci_073                 5.749021e-04 3 1  ON 72
ci_074                 2.857507e-04 3 1  ON 73
ci_075                -2.910323e-04 3 1  ON 74
ci_076                -2.990999e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 2.9463e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s091 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s091 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=91  my_counter=0
  time step      = 5.0000e-02
  blocks         = 250
  steps          = 250
  substeps       = 10
  current        = 0
  target samples = 8.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">250</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">6.2500e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">8.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">6.2500e+04</parameter>
<parameter name="steps" condition="int">250</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2662e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="250">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =8000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 91
    time step          = 0.05
    reference energy   = -22.641
    reference variance = 0.411197
====================================================
  Execution time = 1.0161e+02
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s091
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 62500 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 6.1105e+04
  VMC Eavg = -2.2669e+01
  VMC Evar = 5.1037e-01
  Total weights = 7.820589418e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.9065e+01
  </log>
</opt>
<opt stage="main" walkers="62500">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.497669617067
                                         uncertainty =       0.001640208146

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.497669617067
                                         uncertainty =       0.001640208146

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000249417744
  error estimate for blocks of size 2^( 2) =       0.000258345765
  error estimate for blocks of size 2^( 3) =       0.000266362773
  error estimate for blocks of size 2^( 4) =       0.000272221605
  error estimate for blocks of size 2^( 5) =       0.000275603212
  error estimate for blocks of size 2^( 6) =       0.000277392855
  error estimate for blocks of size 2^( 7) =       0.000278557145
  error estimate for blocks of size 2^( 8) =       0.000279684253
  error estimate for blocks of size 2^( 9) =       0.000279019962

      target function =                  N/A
              le_mean =     -22.669222312562
             les_mean =     514.404007326321
             stat err =       0.000278663554
             autocorr =       1.248261715216
              std dev =       0.705459911310
             le_variance =       0.497673686465


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266922231256e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.3878e+33, overlap shift 1.3878e+34 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.669222312588       residual = 2.70e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.669222312588       residual = 2.70e-05           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 1.3878e+33 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 5.5511e+33, overlap shift 5.5511e+34 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.669222312588       residual = 2.70e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.669222312588       residual = 2.70e-05           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 5.5511e+33 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 2.2204e+34, overlap shift 2.2204e+35 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.669222312588       residual = 2.70e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.669222312588       residual = 2.70e-05           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 2.2204e+34 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.197250 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.2069e+02
  </log>
  <optVariables href="FORM.s091.opt.xml">
ci_001                -7.050617e-01 3 1  ON 0
ci_002                -7.059926e-01 3 1  ON 1
ci_003                -3.765135e-02 3 1  ON 2
ci_004                -3.890325e-02 3 1  ON 3
ci_005                 1.612441e-02 3 1  ON 4
ci_006                 1.600090e-02 3 1  ON 5
ci_007                 1.228713e-02 3 1  ON 6
ci_008                 1.246533e-02 3 1  ON 7
ci_009                -1.173869e-02 3 1  ON 8
ci_010                -1.182876e-02 3 1  ON 9
ci_011                -8.176403e-03 3 1  ON 10
ci_012                -8.138278e-03 3 1  ON 11
ci_013                 9.647137e-03 3 1  ON 12
ci_014                 9.360580e-03 3 1  ON 13
ci_015                 1.228715e-02 3 1  ON 14
ci_016                 1.255400e-02 3 1  ON 15
ci_017                 1.088300e-02 3 1  ON 16
ci_018                 1.078149e-02 3 1  ON 17
ci_019                -2.514322e-03 3 1  ON 18
ci_020                -2.423765e-03 3 1  ON 19
ci_021                -8.459776e-03 3 1  ON 20
ci_022                -8.657034e-03 3 1  ON 21
ci_023                 7.805043e-03 3 1  ON 22
ci_024                 8.041852e-03 3 1  ON 23
ci_025                 4.702642e-03 3 1  ON 24
ci_026                 4.273172e-03 3 1  ON 25
ci_027                 6.454089e-03 3 1  ON 26
ci_028                 6.476482e-03 3 1  ON 27
ci_029                -4.877820e-03 3 1  ON 28
ci_030                -4.785596e-03 3 1  ON 29
ci_031                -7.388694e-03 3 1  ON 30
ci_032                -8.123179e-03 3 1  ON 31
ci_033                 4.600637e-03 3 1  ON 32
ci_034                 4.413553e-03 3 1  ON 33
ci_035                 1.126907e-03 3 1  ON 34
ci_036                 1.043146e-03 3 1  ON 35
ci_037                 4.953347e-03 3 1  ON 36
ci_038                 5.099310e-03 3 1  ON 37
ci_039                 5.306386e-03 3 1  ON 38
ci_040                 5.323086e-03 3 1  ON 39
ci_041                 4.970499e-03 3 1  ON 40
ci_042                 5.231233e-03 3 1  ON 41
ci_043                 4.943052e-03 3 1  ON 42
ci_044                 4.944182e-03 3 1  ON 43
ci_045                 3.123967e-03 3 1  ON 44
ci_046                 3.174246e-03 3 1  ON 45
ci_047                -7.790222e-04 3 1  ON 46
ci_048                -5.616836e-04 3 1  ON 47
ci_049                 1.580289e-03 3 1  ON 48
ci_050                 1.792516e-03 3 1  ON 49
ci_051                -1.106651e-03 3 1  ON 50
ci_052                -1.243279e-03 3 1  ON 51
ci_053                -2.610471e-03 3 1  ON 52
ci_054                -2.301978e-03 3 1  ON 53
ci_055                -1.483475e-03 3 1  ON 54
ci_056                -1.376714e-03 3 1  ON 55
ci_057                -1.240708e-03 3 1  ON 56
ci_058                -1.731077e-03 3 1  ON 57
ci_059                 3.171692e-04 3 1  ON 58
ci_060                 1.414703e-04 3 1  ON 59
ci_061                -3.305088e-04 3 1  ON 60
ci_062                -9.499769e-06 3 1  ON 61
ci_063                -5.232922e-04 3 1  ON 62
ci_064                -8.918525e-04 3 1  ON 63
ci_065                -2.408143e-03 3 1  ON 64
ci_066                -2.435285e-03 3 1  ON 65
ci_067                -2.101084e-03 3 1  ON 66
ci_068                -2.473560e-03 3 1  ON 67
ci_069                -2.085964e-04 3 1  ON 68
ci_070                 1.328450e-04 3 1  ON 69
ci_071                -1.874230e-03 3 1  ON 70
ci_072                -1.959430e-03 3 1  ON 71
ci_073                 5.749021e-04 3 1  ON 72
ci_074                 2.857507e-04 3 1  ON 73
ci_075                -2.910323e-04 3 1  ON 74
ci_076                -2.990999e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="250">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =8000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 91
    time step          = 0.05
    reference energy   = -22.6474
    reference variance = 0.606683
====================================================
  Execution time = 9.9911e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s091
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 62500 
  VMC Eavg = -2.2670e+01
  VMC Evar = 5.0978e-01
  Total weights = 7.8209e+06
  Execution time = 1.4646e+01
  </log>
</opt>
<opt stage="main" walkers="62500">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.497247809808
                                         uncertainty =       0.001426137749

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.497247809808
                                         uncertainty =       0.001426137749

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000249310676
  error estimate for blocks of size 2^( 2) =       0.000258347104
  error estimate for blocks of size 2^( 3) =       0.000266405808
  error estimate for blocks of size 2^( 4) =       0.000272193509
  error estimate for blocks of size 2^( 5) =       0.000275411436
  error estimate for blocks of size 2^( 6) =       0.000277025082
  error estimate for blocks of size 2^( 7) =       0.000277757063
  error estimate for blocks of size 2^( 8) =       0.000277954199
  error estimate for blocks of size 2^( 9) =       0.000279263816

      target function =                  N/A
              le_mean =     -22.669865238718
             les_mean =     514.432572941565
             stat err =       0.000278000040
             autocorr =       1.243391693510
              std dev =       0.705157079901
             le_variance =       0.497246507334

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.497247809808
                                         uncertainty =       0.001426137749

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.497247809808
                                         uncertainty =       0.001426137749

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000249310676
  error estimate for blocks of size 2^( 2) =       0.000258347104
  error estimate for blocks of size 2^( 3) =       0.000266405808
  error estimate for blocks of size 2^( 4) =       0.000272193509
  error estimate for blocks of size 2^( 5) =       0.000275411436
  error estimate for blocks of size 2^( 6) =       0.000277025082
  error estimate for blocks of size 2^( 7) =       0.000277757063
  error estimate for blocks of size 2^( 8) =       0.000277954199
  error estimate for blocks of size 2^( 9) =       0.000279263816

      target function =                  N/A
              le_mean =     -22.669865238718
             les_mean =     514.432572941565
             stat err =       0.000278000040
             autocorr =       1.243391693510
              std dev =       0.705157079901
             le_variance =       0.497246507334

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.497247809808
                                         uncertainty =       0.001426137749

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.497247809808
                                         uncertainty =       0.001426137749

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000249310676
  error estimate for blocks of size 2^( 2) =       0.000258347104
  error estimate for blocks of size 2^( 3) =       0.000266405808
  error estimate for blocks of size 2^( 4) =       0.000272193509
  error estimate for blocks of size 2^( 5) =       0.000275411436
  error estimate for blocks of size 2^( 6) =       0.000277025082
  error estimate for blocks of size 2^( 7) =       0.000277757063
  error estimate for blocks of size 2^( 8) =       0.000277954199
  error estimate for blocks of size 2^( 9) =       0.000279263816

      target function =                  N/A
              le_mean =     -22.669865238718
             les_mean =     514.432572941565
             stat err =       0.000278000040
             autocorr =       1.243391693510
              std dev =       0.705157079901
             le_variance =       0.497246507334

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.497247809808
                                         uncertainty =       0.001426137749

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.497247809808
                                         uncertainty =       0.001426137749

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000249310676
  error estimate for blocks of size 2^( 2) =       0.000258347104
  error estimate for blocks of size 2^( 3) =       0.000266405808
  error estimate for blocks of size 2^( 4) =       0.000272193509
  error estimate for blocks of size 2^( 5) =       0.000275411436
  error estimate for blocks of size 2^( 6) =       0.000277025082
  error estimate for blocks of size 2^( 7) =       0.000277757063
  error estimate for blocks of size 2^( 8) =       0.000277954199
  error estimate for blocks of size 2^( 9) =       0.000279263816

      target function =                  N/A
              le_mean =     -22.669865238718
             les_mean =     514.432572941565
             stat err =       0.000278000040
             autocorr =       1.243391693510
              std dev =       0.705157079901
             le_variance =       0.497246507334


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.669865238718        initial  <--
     1.3878e+33     1.3878e+34             0.0000e+00       -22.669865238718
     5.5511e+33     5.5511e+34             0.0000e+00       -22.669865238718
     2.2204e+34     2.2204e+35             0.0000e+00       -22.669865238718

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 173.1460
  </log>
  <optVariables href="FORM.s091.opt.xml">
ci_001                -7.050617e-01 3 1  ON 0
ci_002                -7.059926e-01 3 1  ON 1
ci_003                -3.765135e-02 3 1  ON 2
ci_004                -3.890325e-02 3 1  ON 3
ci_005                 1.612441e-02 3 1  ON 4
ci_006                 1.600090e-02 3 1  ON 5
ci_007                 1.228713e-02 3 1  ON 6
ci_008                 1.246533e-02 3 1  ON 7
ci_009                -1.173869e-02 3 1  ON 8
ci_010                -1.182876e-02 3 1  ON 9
ci_011                -8.176403e-03 3 1  ON 10
ci_012                -8.138278e-03 3 1  ON 11
ci_013                 9.647137e-03 3 1  ON 12
ci_014                 9.360580e-03 3 1  ON 13
ci_015                 1.228715e-02 3 1  ON 14
ci_016                 1.255400e-02 3 1  ON 15
ci_017                 1.088300e-02 3 1  ON 16
ci_018                 1.078149e-02 3 1  ON 17
ci_019                -2.514322e-03 3 1  ON 18
ci_020                -2.423765e-03 3 1  ON 19
ci_021                -8.459776e-03 3 1  ON 20
ci_022                -8.657034e-03 3 1  ON 21
ci_023                 7.805043e-03 3 1  ON 22
ci_024                 8.041852e-03 3 1  ON 23
ci_025                 4.702642e-03 3 1  ON 24
ci_026                 4.273172e-03 3 1  ON 25
ci_027                 6.454089e-03 3 1  ON 26
ci_028                 6.476482e-03 3 1  ON 27
ci_029                -4.877820e-03 3 1  ON 28
ci_030                -4.785596e-03 3 1  ON 29
ci_031                -7.388694e-03 3 1  ON 30
ci_032                -8.123179e-03 3 1  ON 31
ci_033                 4.600637e-03 3 1  ON 32
ci_034                 4.413553e-03 3 1  ON 33
ci_035                 1.126907e-03 3 1  ON 34
ci_036                 1.043146e-03 3 1  ON 35
ci_037                 4.953347e-03 3 1  ON 36
ci_038                 5.099310e-03 3 1  ON 37
ci_039                 5.306386e-03 3 1  ON 38
ci_040                 5.323086e-03 3 1  ON 39
ci_041                 4.970499e-03 3 1  ON 40
ci_042                 5.231233e-03 3 1  ON 41
ci_043                 4.943052e-03 3 1  ON 42
ci_044                 4.944182e-03 3 1  ON 43
ci_045                 3.123967e-03 3 1  ON 44
ci_046                 3.174246e-03 3 1  ON 45
ci_047                -7.790222e-04 3 1  ON 46
ci_048                -5.616836e-04 3 1  ON 47
ci_049                 1.580289e-03 3 1  ON 48
ci_050                 1.792516e-03 3 1  ON 49
ci_051                -1.106651e-03 3 1  ON 50
ci_052                -1.243279e-03 3 1  ON 51
ci_053                -2.610471e-03 3 1  ON 52
ci_054                -2.301978e-03 3 1  ON 53
ci_055                -1.483475e-03 3 1  ON 54
ci_056                -1.376714e-03 3 1  ON 55
ci_057                -1.240708e-03 3 1  ON 56
ci_058                -1.731077e-03 3 1  ON 57
ci_059                 3.171692e-04 3 1  ON 58
ci_060                 1.414703e-04 3 1  ON 59
ci_061                -3.305088e-04 3 1  ON 60
ci_062                -9.499769e-06 3 1  ON 61
ci_063                -5.232922e-04 3 1  ON 62
ci_064                -8.918525e-04 3 1  ON 63
ci_065                -2.408143e-03 3 1  ON 64
ci_066                -2.435285e-03 3 1  ON 65
ci_067                -2.101084e-03 3 1  ON 66
ci_068                -2.473560e-03 3 1  ON 67
ci_069                -2.085964e-04 3 1  ON 68
ci_070                 1.328450e-04 3 1  ON 69
ci_071                -1.874230e-03 3 1  ON 70
ci_072                -1.959430e-03 3 1  ON 71
ci_073                 5.749021e-04 3 1  ON 72
ci_074                 2.857507e-04 3 1  ON 73
ci_075                -2.910323e-04 3 1  ON 74
ci_076                -2.990999e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 2.9386e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s092 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s092 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=92  my_counter=0
  time step      = 5.0000e-02
  blocks         = 250
  steps          = 250
  substeps       = 10
  current        = 0
  target samples = 8.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">250</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">6.2500e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">8.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">6.2500e+04</parameter>
<parameter name="steps" condition="int">250</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2662e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="250">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =8000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 92
    time step          = 0.05
    reference energy   = -22.7504
    reference variance = 0.358565
====================================================
  Execution time = 1.0199e+02
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s092
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 62500 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 6.1061e+04
  VMC Eavg = -2.2670e+01
  VMC Evar = 5.0915e-01
  Total weights = 7.820276295e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.8913e+01
  </log>
</opt>
<opt stage="main" walkers="62500">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.496723612677
                                         uncertainty =       0.001639992701

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.496723612677
                                         uncertainty =       0.001639992701

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000249179459
  error estimate for blocks of size 2^( 2) =       0.000258086758
  error estimate for blocks of size 2^( 3) =       0.000266212496
  error estimate for blocks of size 2^( 4) =       0.000272073376
  error estimate for blocks of size 2^( 5) =       0.000275332210
  error estimate for blocks of size 2^( 6) =       0.000276639069
  error estimate for blocks of size 2^( 7) =       0.000277292300
  error estimate for blocks of size 2^( 8) =       0.000278782510
  error estimate for blocks of size 2^( 9) =       0.000278708923

      target function =                  N/A
              le_mean =     -22.669971316015
             les_mean =     514.436748196460
             stat err =       0.000277855700
             autocorr =       1.243409396164
              std dev =       0.704785941016
             le_variance =       0.496723222654


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266997131602e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.3878e+34, overlap shift 1.3878e+35 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.669971316041       residual = 9.17e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.669971316041       residual = 9.17e-05           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 1.3878e+34 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 5.5511e+34, overlap shift 5.5511e+35 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.669971316041       residual = 9.17e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.669971316041       residual = 9.17e-05           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 5.5511e+34 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 2.2204e+35, overlap shift 2.2204e+36 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.669971316041       residual = 9.17e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.669971316041       residual = 9.17e-05           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 2.2204e+35 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.198374 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.2091e+02
  </log>
  <optVariables href="FORM.s092.opt.xml">
ci_001                -7.050617e-01 3 1  ON 0
ci_002                -7.059926e-01 3 1  ON 1
ci_003                -3.765135e-02 3 1  ON 2
ci_004                -3.890325e-02 3 1  ON 3
ci_005                 1.612441e-02 3 1  ON 4
ci_006                 1.600090e-02 3 1  ON 5
ci_007                 1.228713e-02 3 1  ON 6
ci_008                 1.246533e-02 3 1  ON 7
ci_009                -1.173869e-02 3 1  ON 8
ci_010                -1.182876e-02 3 1  ON 9
ci_011                -8.176403e-03 3 1  ON 10
ci_012                -8.138278e-03 3 1  ON 11
ci_013                 9.647137e-03 3 1  ON 12
ci_014                 9.360580e-03 3 1  ON 13
ci_015                 1.228715e-02 3 1  ON 14
ci_016                 1.255400e-02 3 1  ON 15
ci_017                 1.088300e-02 3 1  ON 16
ci_018                 1.078149e-02 3 1  ON 17
ci_019                -2.514322e-03 3 1  ON 18
ci_020                -2.423765e-03 3 1  ON 19
ci_021                -8.459776e-03 3 1  ON 20
ci_022                -8.657034e-03 3 1  ON 21
ci_023                 7.805043e-03 3 1  ON 22
ci_024                 8.041852e-03 3 1  ON 23
ci_025                 4.702642e-03 3 1  ON 24
ci_026                 4.273172e-03 3 1  ON 25
ci_027                 6.454089e-03 3 1  ON 26
ci_028                 6.476482e-03 3 1  ON 27
ci_029                -4.877820e-03 3 1  ON 28
ci_030                -4.785596e-03 3 1  ON 29
ci_031                -7.388694e-03 3 1  ON 30
ci_032                -8.123179e-03 3 1  ON 31
ci_033                 4.600637e-03 3 1  ON 32
ci_034                 4.413553e-03 3 1  ON 33
ci_035                 1.126907e-03 3 1  ON 34
ci_036                 1.043146e-03 3 1  ON 35
ci_037                 4.953347e-03 3 1  ON 36
ci_038                 5.099310e-03 3 1  ON 37
ci_039                 5.306386e-03 3 1  ON 38
ci_040                 5.323086e-03 3 1  ON 39
ci_041                 4.970499e-03 3 1  ON 40
ci_042                 5.231233e-03 3 1  ON 41
ci_043                 4.943052e-03 3 1  ON 42
ci_044                 4.944182e-03 3 1  ON 43
ci_045                 3.123967e-03 3 1  ON 44
ci_046                 3.174246e-03 3 1  ON 45
ci_047                -7.790222e-04 3 1  ON 46
ci_048                -5.616836e-04 3 1  ON 47
ci_049                 1.580289e-03 3 1  ON 48
ci_050                 1.792516e-03 3 1  ON 49
ci_051                -1.106651e-03 3 1  ON 50
ci_052                -1.243279e-03 3 1  ON 51
ci_053                -2.610471e-03 3 1  ON 52
ci_054                -2.301978e-03 3 1  ON 53
ci_055                -1.483475e-03 3 1  ON 54
ci_056                -1.376714e-03 3 1  ON 55
ci_057                -1.240708e-03 3 1  ON 56
ci_058                -1.731077e-03 3 1  ON 57
ci_059                 3.171692e-04 3 1  ON 58
ci_060                 1.414703e-04 3 1  ON 59
ci_061                -3.305088e-04 3 1  ON 60
ci_062                -9.499769e-06 3 1  ON 61
ci_063                -5.232922e-04 3 1  ON 62
ci_064                -8.918525e-04 3 1  ON 63
ci_065                -2.408143e-03 3 1  ON 64
ci_066                -2.435285e-03 3 1  ON 65
ci_067                -2.101084e-03 3 1  ON 66
ci_068                -2.473560e-03 3 1  ON 67
ci_069                -2.085964e-04 3 1  ON 68
ci_070                 1.328450e-04 3 1  ON 69
ci_071                -1.874230e-03 3 1  ON 70
ci_072                -1.959430e-03 3 1  ON 71
ci_073                 5.749021e-04 3 1  ON 72
ci_074                 2.857507e-04 3 1  ON 73
ci_075                -2.910323e-04 3 1  ON 74
ci_076                -2.990999e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="250">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =8000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 92
    time step          = 0.05
    reference energy   = -22.6604
    reference variance = 0.369237
====================================================
  Execution time = 1.0037e+02
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s092
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 62500 
  VMC Eavg = -2.2670e+01
  VMC Evar = 5.1039e-01
  Total weights = 7.8212e+06
  Execution time = 1.4659e+01
  </log>
</opt>
<opt stage="main" walkers="62500">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.497939241885
                                         uncertainty =       0.001719650241

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.497939241885
                                         uncertainty =       0.001719650241

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000249483919
  error estimate for blocks of size 2^( 2) =       0.000258434744
  error estimate for blocks of size 2^( 3) =       0.000266477194
  error estimate for blocks of size 2^( 4) =       0.000272298097
  error estimate for blocks of size 2^( 5) =       0.000275575121
  error estimate for blocks of size 2^( 6) =       0.000276824004
  error estimate for blocks of size 2^( 7) =       0.000276696772
  error estimate for blocks of size 2^( 8) =       0.000276839231
  error estimate for blocks of size 2^( 9) =       0.000277602725

      target function =                  N/A
              le_mean =     -22.669606890368
             les_mean =     514.421471409170
             stat err =       0.000276990683
             autocorr =       1.232665399639
              std dev =       0.705647084977
             le_variance =       0.497937808536

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.497939241885
                                         uncertainty =       0.001719650241

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.497939241885
                                         uncertainty =       0.001719650241

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000249483919
  error estimate for blocks of size 2^( 2) =       0.000258434744
  error estimate for blocks of size 2^( 3) =       0.000266477194
  error estimate for blocks of size 2^( 4) =       0.000272298097
  error estimate for blocks of size 2^( 5) =       0.000275575121
  error estimate for blocks of size 2^( 6) =       0.000276824004
  error estimate for blocks of size 2^( 7) =       0.000276696772
  error estimate for blocks of size 2^( 8) =       0.000276839231
  error estimate for blocks of size 2^( 9) =       0.000277602725

      target function =                  N/A
              le_mean =     -22.669606890368
             les_mean =     514.421471409170
             stat err =       0.000276990683
             autocorr =       1.232665399639
              std dev =       0.705647084977
             le_variance =       0.497937808536

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.497939241885
                                         uncertainty =       0.001719650241

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.497939241885
                                         uncertainty =       0.001719650241

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000249483919
  error estimate for blocks of size 2^( 2) =       0.000258434744
  error estimate for blocks of size 2^( 3) =       0.000266477194
  error estimate for blocks of size 2^( 4) =       0.000272298097
  error estimate for blocks of size 2^( 5) =       0.000275575121
  error estimate for blocks of size 2^( 6) =       0.000276824004
  error estimate for blocks of size 2^( 7) =       0.000276696772
  error estimate for blocks of size 2^( 8) =       0.000276839231
  error estimate for blocks of size 2^( 9) =       0.000277602725

      target function =                  N/A
              le_mean =     -22.669606890368
             les_mean =     514.421471409170
             stat err =       0.000276990683
             autocorr =       1.232665399639
              std dev =       0.705647084977
             le_variance =       0.497937808536

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.497939241885
                                         uncertainty =       0.001719650241

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.497939241885
                                         uncertainty =       0.001719650241

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000249483919
  error estimate for blocks of size 2^( 2) =       0.000258434744
  error estimate for blocks of size 2^( 3) =       0.000266477194
  error estimate for blocks of size 2^( 4) =       0.000272298097
  error estimate for blocks of size 2^( 5) =       0.000275575121
  error estimate for blocks of size 2^( 6) =       0.000276824004
  error estimate for blocks of size 2^( 7) =       0.000276696772
  error estimate for blocks of size 2^( 8) =       0.000276839231
  error estimate for blocks of size 2^( 9) =       0.000277602725

      target function =                  N/A
              le_mean =     -22.669606890368
             les_mean =     514.421471409170
             stat err =       0.000276990683
             autocorr =       1.232665399639
              std dev =       0.705647084977
             le_variance =       0.497937808536


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.669606890368        initial  <--
     1.3878e+34     1.3878e+35             0.0000e+00       -22.669606890368
     5.5511e+34     5.5511e+35             0.0000e+00       -22.669606890368
     2.2204e+35     2.2204e+36             0.0000e+00       -22.669606890368

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 173.5908
  </log>
  <optVariables href="FORM.s092.opt.xml">
ci_001                -7.050617e-01 3 1  ON 0
ci_002                -7.059926e-01 3 1  ON 1
ci_003                -3.765135e-02 3 1  ON 2
ci_004                -3.890325e-02 3 1  ON 3
ci_005                 1.612441e-02 3 1  ON 4
ci_006                 1.600090e-02 3 1  ON 5
ci_007                 1.228713e-02 3 1  ON 6
ci_008                 1.246533e-02 3 1  ON 7
ci_009                -1.173869e-02 3 1  ON 8
ci_010                -1.182876e-02 3 1  ON 9
ci_011                -8.176403e-03 3 1  ON 10
ci_012                -8.138278e-03 3 1  ON 11
ci_013                 9.647137e-03 3 1  ON 12
ci_014                 9.360580e-03 3 1  ON 13
ci_015                 1.228715e-02 3 1  ON 14
ci_016                 1.255400e-02 3 1  ON 15
ci_017                 1.088300e-02 3 1  ON 16
ci_018                 1.078149e-02 3 1  ON 17
ci_019                -2.514322e-03 3 1  ON 18
ci_020                -2.423765e-03 3 1  ON 19
ci_021                -8.459776e-03 3 1  ON 20
ci_022                -8.657034e-03 3 1  ON 21
ci_023                 7.805043e-03 3 1  ON 22
ci_024                 8.041852e-03 3 1  ON 23
ci_025                 4.702642e-03 3 1  ON 24
ci_026                 4.273172e-03 3 1  ON 25
ci_027                 6.454089e-03 3 1  ON 26
ci_028                 6.476482e-03 3 1  ON 27
ci_029                -4.877820e-03 3 1  ON 28
ci_030                -4.785596e-03 3 1  ON 29
ci_031                -7.388694e-03 3 1  ON 30
ci_032                -8.123179e-03 3 1  ON 31
ci_033                 4.600637e-03 3 1  ON 32
ci_034                 4.413553e-03 3 1  ON 33
ci_035                 1.126907e-03 3 1  ON 34
ci_036                 1.043146e-03 3 1  ON 35
ci_037                 4.953347e-03 3 1  ON 36
ci_038                 5.099310e-03 3 1  ON 37
ci_039                 5.306386e-03 3 1  ON 38
ci_040                 5.323086e-03 3 1  ON 39
ci_041                 4.970499e-03 3 1  ON 40
ci_042                 5.231233e-03 3 1  ON 41
ci_043                 4.943052e-03 3 1  ON 42
ci_044                 4.944182e-03 3 1  ON 43
ci_045                 3.123967e-03 3 1  ON 44
ci_046                 3.174246e-03 3 1  ON 45
ci_047                -7.790222e-04 3 1  ON 46
ci_048                -5.616836e-04 3 1  ON 47
ci_049                 1.580289e-03 3 1  ON 48
ci_050                 1.792516e-03 3 1  ON 49
ci_051                -1.106651e-03 3 1  ON 50
ci_052                -1.243279e-03 3 1  ON 51
ci_053                -2.610471e-03 3 1  ON 52
ci_054                -2.301978e-03 3 1  ON 53
ci_055                -1.483475e-03 3 1  ON 54
ci_056                -1.376714e-03 3 1  ON 55
ci_057                -1.240708e-03 3 1  ON 56
ci_058                -1.731077e-03 3 1  ON 57
ci_059                 3.171692e-04 3 1  ON 58
ci_060                 1.414703e-04 3 1  ON 59
ci_061                -3.305088e-04 3 1  ON 60
ci_062                -9.499769e-06 3 1  ON 61
ci_063                -5.232922e-04 3 1  ON 62
ci_064                -8.918525e-04 3 1  ON 63
ci_065                -2.408143e-03 3 1  ON 64
ci_066                -2.435285e-03 3 1  ON 65
ci_067                -2.101084e-03 3 1  ON 66
ci_068                -2.473560e-03 3 1  ON 67
ci_069                -2.085964e-04 3 1  ON 68
ci_070                 1.328450e-04 3 1  ON 69
ci_071                -1.874230e-03 3 1  ON 70
ci_072                -1.959430e-03 3 1  ON 71
ci_073                 5.749021e-04 3 1  ON 72
ci_074                 2.857507e-04 3 1  ON 73
ci_075                -2.910323e-04 3 1  ON 74
ci_076                -2.990999e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 2.9451e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s093 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s093 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=93  my_counter=0
  time step      = 5.0000e-02
  blocks         = 250
  steps          = 250
  substeps       = 10
  current        = 0
  target samples = 8.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">250</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">6.2500e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">8.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">6.2500e+04</parameter>
<parameter name="steps" condition="int">250</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2663e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="250">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =8000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 93
    time step          = 0.05
    reference energy   = -22.6612
    reference variance = 0.358066
====================================================
  Execution time = 1.0227e+02
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s093
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 62500 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 6.1166e+04
  VMC Eavg = -2.2670e+01
  VMC Evar = 5.1322e-01
  Total weights = 7.820894185e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.9027e+01
  </log>
</opt>
<opt stage="main" walkers="62500">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.497910606843
                                         uncertainty =       0.001585095865

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.497910606843
                                         uncertainty =       0.001585095865

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000249477331
  error estimate for blocks of size 2^( 2) =       0.000258472966
  error estimate for blocks of size 2^( 3) =       0.000266589569
  error estimate for blocks of size 2^( 4) =       0.000272203209
  error estimate for blocks of size 2^( 5) =       0.000275365561
  error estimate for blocks of size 2^( 6) =       0.000276903454
  error estimate for blocks of size 2^( 7) =       0.000278459574
  error estimate for blocks of size 2^( 8) =       0.000279518755
  error estimate for blocks of size 2^( 9) =       0.000281958010

      target function =                  N/A
              le_mean =     -22.669907054045
             les_mean =     514.437910059904
             stat err =       0.000279209948
             autocorr =       1.252563050705
              std dev =       0.705628451166
             le_variance =       0.497911511094


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266990705404e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.3878e+35, overlap shift 1.3878e+36 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.669907054071       residual = 5.53e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.669907054071       residual = 9.97e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.669907093048       residual = 5.53e-05           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 1.3878e+35 is 1.813603e-39

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 5.5511e+35, overlap shift 5.5511e+36 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.669907054071       residual = 5.53e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.669907054071       residual = 9.97e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.669907093048       residual = 5.53e-05           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 5.5511e+35 is 4.534008e-40

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 2.2204e+36, overlap shift 2.2204e+37 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.669907054071       residual = 5.53e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.669907054071       residual = 9.97e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.669907093048       residual = 5.53e-05           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 2.2204e+36 is 1.133502e-40

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.199803 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.2132e+02
  </log>
  <optVariables href="FORM.s093.opt.xml">
ci_001                -7.050617e-01 3 1  ON 0
ci_002                -7.059926e-01 3 1  ON 1
ci_003                -3.765135e-02 3 1  ON 2
ci_004                -3.890325e-02 3 1  ON 3
ci_005                 1.612441e-02 3 1  ON 4
ci_006                 1.600090e-02 3 1  ON 5
ci_007                 1.228713e-02 3 1  ON 6
ci_008                 1.246533e-02 3 1  ON 7
ci_009                -1.173869e-02 3 1  ON 8
ci_010                -1.182876e-02 3 1  ON 9
ci_011                -8.176403e-03 3 1  ON 10
ci_012                -8.138278e-03 3 1  ON 11
ci_013                 9.647137e-03 3 1  ON 12
ci_014                 9.360580e-03 3 1  ON 13
ci_015                 1.228715e-02 3 1  ON 14
ci_016                 1.255400e-02 3 1  ON 15
ci_017                 1.088300e-02 3 1  ON 16
ci_018                 1.078149e-02 3 1  ON 17
ci_019                -2.514322e-03 3 1  ON 18
ci_020                -2.423765e-03 3 1  ON 19
ci_021                -8.459776e-03 3 1  ON 20
ci_022                -8.657034e-03 3 1  ON 21
ci_023                 7.805043e-03 3 1  ON 22
ci_024                 8.041852e-03 3 1  ON 23
ci_025                 4.702642e-03 3 1  ON 24
ci_026                 4.273172e-03 3 1  ON 25
ci_027                 6.454089e-03 3 1  ON 26
ci_028                 6.476482e-03 3 1  ON 27
ci_029                -4.877820e-03 3 1  ON 28
ci_030                -4.785596e-03 3 1  ON 29
ci_031                -7.388694e-03 3 1  ON 30
ci_032                -8.123179e-03 3 1  ON 31
ci_033                 4.600637e-03 3 1  ON 32
ci_034                 4.413553e-03 3 1  ON 33
ci_035                 1.126907e-03 3 1  ON 34
ci_036                 1.043146e-03 3 1  ON 35
ci_037                 4.953347e-03 3 1  ON 36
ci_038                 5.099310e-03 3 1  ON 37
ci_039                 5.306386e-03 3 1  ON 38
ci_040                 5.323086e-03 3 1  ON 39
ci_041                 4.970499e-03 3 1  ON 40
ci_042                 5.231233e-03 3 1  ON 41
ci_043                 4.943052e-03 3 1  ON 42
ci_044                 4.944182e-03 3 1  ON 43
ci_045                 3.123967e-03 3 1  ON 44
ci_046                 3.174246e-03 3 1  ON 45
ci_047                -7.790222e-04 3 1  ON 46
ci_048                -5.616836e-04 3 1  ON 47
ci_049                 1.580289e-03 3 1  ON 48
ci_050                 1.792516e-03 3 1  ON 49
ci_051                -1.106651e-03 3 1  ON 50
ci_052                -1.243279e-03 3 1  ON 51
ci_053                -2.610471e-03 3 1  ON 52
ci_054                -2.301978e-03 3 1  ON 53
ci_055                -1.483475e-03 3 1  ON 54
ci_056                -1.376714e-03 3 1  ON 55
ci_057                -1.240708e-03 3 1  ON 56
ci_058                -1.731077e-03 3 1  ON 57
ci_059                 3.171692e-04 3 1  ON 58
ci_060                 1.414703e-04 3 1  ON 59
ci_061                -3.305088e-04 3 1  ON 60
ci_062                -9.499769e-06 3 1  ON 61
ci_063                -5.232922e-04 3 1  ON 62
ci_064                -8.918525e-04 3 1  ON 63
ci_065                -2.408143e-03 3 1  ON 64
ci_066                -2.435285e-03 3 1  ON 65
ci_067                -2.101084e-03 3 1  ON 66
ci_068                -2.473560e-03 3 1  ON 67
ci_069                -2.085964e-04 3 1  ON 68
ci_070                 1.328450e-04 3 1  ON 69
ci_071                -1.874230e-03 3 1  ON 70
ci_072                -1.959430e-03 3 1  ON 71
ci_073                 5.749021e-04 3 1  ON 72
ci_074                 2.857507e-04 3 1  ON 73
ci_075                -2.910323e-04 3 1  ON 74
ci_076                -2.990999e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="250">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =8000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 93
    time step          = 0.05
    reference energy   = -22.6315
    reference variance = 0.418302
====================================================
  Execution time = 1.0022e+02
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s093
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 62500 
  VMC Eavg = -2.2670e+01
  VMC Evar = 5.1087e-01
  Total weights = 7.8207e+06
  Execution time = 1.4633e+01
  </log>
</opt>
<opt stage="main" walkers="62500">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.497172577763
                                         uncertainty =       0.001731218692

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.497172577763
                                         uncertainty =       0.001731218692

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000249291801
  error estimate for blocks of size 2^( 2) =       0.000258147939
  error estimate for blocks of size 2^( 3) =       0.000266258685
  error estimate for blocks of size 2^( 4) =       0.000271888981
  error estimate for blocks of size 2^( 5) =       0.000275010041
  error estimate for blocks of size 2^( 6) =       0.000277002597
  error estimate for blocks of size 2^( 7) =       0.000277602959
  error estimate for blocks of size 2^( 8) =       0.000277717414
  error estimate for blocks of size 2^( 9) =       0.000278093460

      target function =                  N/A
              le_mean =     -22.669980363411
             les_mean =     514.438879744400
             stat err =       0.000277604108
             autocorr =       1.240040258950
              std dev =       0.705103692302
             le_variance =       0.497171216898

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.497172577763
                                         uncertainty =       0.001731218692

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.497172577763
                                         uncertainty =       0.001731218692

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000249291801
  error estimate for blocks of size 2^( 2) =       0.000258147939
  error estimate for blocks of size 2^( 3) =       0.000266258685
  error estimate for blocks of size 2^( 4) =       0.000271888981
  error estimate for blocks of size 2^( 5) =       0.000275010041
  error estimate for blocks of size 2^( 6) =       0.000277002597
  error estimate for blocks of size 2^( 7) =       0.000277602959
  error estimate for blocks of size 2^( 8) =       0.000277717414
  error estimate for blocks of size 2^( 9) =       0.000278093460

      target function =                  N/A
              le_mean =     -22.669980363411
             les_mean =     514.438879744400
             stat err =       0.000277604108
             autocorr =       1.240040258950
              std dev =       0.705103692302
             le_variance =       0.497171216898

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.497172577763
                                         uncertainty =       0.001731218692

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.497172577763
                                         uncertainty =       0.001731218692

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000249291801
  error estimate for blocks of size 2^( 2) =       0.000258147939
  error estimate for blocks of size 2^( 3) =       0.000266258685
  error estimate for blocks of size 2^( 4) =       0.000271888981
  error estimate for blocks of size 2^( 5) =       0.000275010041
  error estimate for blocks of size 2^( 6) =       0.000277002597
  error estimate for blocks of size 2^( 7) =       0.000277602959
  error estimate for blocks of size 2^( 8) =       0.000277717414
  error estimate for blocks of size 2^( 9) =       0.000278093460

      target function =                  N/A
              le_mean =     -22.669980363411
             les_mean =     514.438879744400
             stat err =       0.000277604108
             autocorr =       1.240040258950
              std dev =       0.705103692302
             le_variance =       0.497171216898

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.497172577763
                                         uncertainty =       0.001731218692

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.497172577763
                                         uncertainty =       0.001731218692

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000249291801
  error estimate for blocks of size 2^( 2) =       0.000258147939
  error estimate for blocks of size 2^( 3) =       0.000266258685
  error estimate for blocks of size 2^( 4) =       0.000271888981
  error estimate for blocks of size 2^( 5) =       0.000275010041
  error estimate for blocks of size 2^( 6) =       0.000277002597
  error estimate for blocks of size 2^( 7) =       0.000277602959
  error estimate for blocks of size 2^( 8) =       0.000277717414
  error estimate for blocks of size 2^( 9) =       0.000278093460

      target function =                  N/A
              le_mean =     -22.669980363411
             les_mean =     514.438879744400
             stat err =       0.000277604108
             autocorr =       1.240040258950
              std dev =       0.705103692302
             le_variance =       0.497171216898


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.669980363411        initial  <--
     1.3878e+35     1.3878e+36             1.8136e-39       -22.669980363411
     5.5511e+35     5.5511e+36             4.5340e-40       -22.669980363411
     2.2204e+36     2.2204e+37             1.1335e-40       -22.669980363411

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 173.4036
  </log>
  <optVariables href="FORM.s093.opt.xml">
ci_001                -7.050617e-01 3 1  ON 0
ci_002                -7.059926e-01 3 1  ON 1
ci_003                -3.765135e-02 3 1  ON 2
ci_004                -3.890325e-02 3 1  ON 3
ci_005                 1.612441e-02 3 1  ON 4
ci_006                 1.600090e-02 3 1  ON 5
ci_007                 1.228713e-02 3 1  ON 6
ci_008                 1.246533e-02 3 1  ON 7
ci_009                -1.173869e-02 3 1  ON 8
ci_010                -1.182876e-02 3 1  ON 9
ci_011                -8.176403e-03 3 1  ON 10
ci_012                -8.138278e-03 3 1  ON 11
ci_013                 9.647137e-03 3 1  ON 12
ci_014                 9.360580e-03 3 1  ON 13
ci_015                 1.228715e-02 3 1  ON 14
ci_016                 1.255400e-02 3 1  ON 15
ci_017                 1.088300e-02 3 1  ON 16
ci_018                 1.078149e-02 3 1  ON 17
ci_019                -2.514322e-03 3 1  ON 18
ci_020                -2.423765e-03 3 1  ON 19
ci_021                -8.459776e-03 3 1  ON 20
ci_022                -8.657034e-03 3 1  ON 21
ci_023                 7.805043e-03 3 1  ON 22
ci_024                 8.041852e-03 3 1  ON 23
ci_025                 4.702642e-03 3 1  ON 24
ci_026                 4.273172e-03 3 1  ON 25
ci_027                 6.454089e-03 3 1  ON 26
ci_028                 6.476482e-03 3 1  ON 27
ci_029                -4.877820e-03 3 1  ON 28
ci_030                -4.785596e-03 3 1  ON 29
ci_031                -7.388694e-03 3 1  ON 30
ci_032                -8.123179e-03 3 1  ON 31
ci_033                 4.600637e-03 3 1  ON 32
ci_034                 4.413553e-03 3 1  ON 33
ci_035                 1.126907e-03 3 1  ON 34
ci_036                 1.043146e-03 3 1  ON 35
ci_037                 4.953347e-03 3 1  ON 36
ci_038                 5.099310e-03 3 1  ON 37
ci_039                 5.306386e-03 3 1  ON 38
ci_040                 5.323086e-03 3 1  ON 39
ci_041                 4.970499e-03 3 1  ON 40
ci_042                 5.231233e-03 3 1  ON 41
ci_043                 4.943052e-03 3 1  ON 42
ci_044                 4.944182e-03 3 1  ON 43
ci_045                 3.123967e-03 3 1  ON 44
ci_046                 3.174246e-03 3 1  ON 45
ci_047                -7.790222e-04 3 1  ON 46
ci_048                -5.616836e-04 3 1  ON 47
ci_049                 1.580289e-03 3 1  ON 48
ci_050                 1.792516e-03 3 1  ON 49
ci_051                -1.106651e-03 3 1  ON 50
ci_052                -1.243279e-03 3 1  ON 51
ci_053                -2.610471e-03 3 1  ON 52
ci_054                -2.301978e-03 3 1  ON 53
ci_055                -1.483475e-03 3 1  ON 54
ci_056                -1.376714e-03 3 1  ON 55
ci_057                -1.240708e-03 3 1  ON 56
ci_058                -1.731077e-03 3 1  ON 57
ci_059                 3.171692e-04 3 1  ON 58
ci_060                 1.414703e-04 3 1  ON 59
ci_061                -3.305088e-04 3 1  ON 60
ci_062                -9.499769e-06 3 1  ON 61
ci_063                -5.232922e-04 3 1  ON 62
ci_064                -8.918525e-04 3 1  ON 63
ci_065                -2.408143e-03 3 1  ON 64
ci_066                -2.435285e-03 3 1  ON 65
ci_067                -2.101084e-03 3 1  ON 66
ci_068                -2.473560e-03 3 1  ON 67
ci_069                -2.085964e-04 3 1  ON 68
ci_070                 1.328450e-04 3 1  ON 69
ci_071                -1.874230e-03 3 1  ON 70
ci_072                -1.959430e-03 3 1  ON 71
ci_073                 5.749021e-04 3 1  ON 72
ci_074                 2.857507e-04 3 1  ON 73
ci_075                -2.910323e-04 3 1  ON 74
ci_076                -2.990999e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 2.9472e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s094 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s094 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=94  my_counter=0
  time step      = 5.0000e-02
  blocks         = 250
  steps          = 250
  substeps       = 10
  current        = 0
  target samples = 8.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">250</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">6.2500e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">8.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">6.2500e+04</parameter>
<parameter name="steps" condition="int">250</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2663e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="250">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =8000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 94
    time step          = 0.05
    reference energy   = -22.7006
    reference variance = 0.276728
====================================================
  Execution time = 1.0223e+02
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s094
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 62500 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 6.1093e+04
  VMC Eavg = -2.2669e+01
  VMC Evar = 5.0773e-01
  Total weights = 7.821354097e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.9134e+01
  </log>
</opt>
<opt stage="main" walkers="62500">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.494477447899
                                         uncertainty =       0.001356230847

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.494477447899
                                         uncertainty =       0.001356230847

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000248615838
  error estimate for blocks of size 2^( 2) =       0.000257680736
  error estimate for blocks of size 2^( 3) =       0.000265774800
  error estimate for blocks of size 2^( 4) =       0.000271438080
  error estimate for blocks of size 2^( 5) =       0.000274673427
  error estimate for blocks of size 2^( 6) =       0.000276160200
  error estimate for blocks of size 2^( 7) =       0.000277160042
  error estimate for blocks of size 2^( 8) =       0.000276451386
  error estimate for blocks of size 2^( 9) =       0.000277303917

      target function =                  N/A
              le_mean =     -22.669469042974
             les_mean =     514.412559392470
             stat err =       0.000276768886
             autocorr =       1.239301425374
              std dev =       0.703191779480
             le_variance =       0.494478678728


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266946904297e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.3878e+36, overlap shift 1.3878e+37 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.669469042994       residual = 4.15e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.669469042994       residual = 3.57e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.669468879700       residual = 4.15e-05           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 1.3878e+36 is 1.165675e-40

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 5.5511e+36, overlap shift 5.5511e+37 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.669469042994       residual = 4.15e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.669469042994       residual = 3.57e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.669469042994       residual = 4.15e-05           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 5.5511e+36 is 2.914187e-41

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 2.2204e+37, overlap shift 2.2204e+38 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.669469042994       residual = 4.15e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.669469042994       residual = 3.57e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.669469833374       residual = 4.15e-05           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 2.2204e+37 is 7.285467e-42

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.201206 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.2138e+02
  </log>
  <optVariables href="FORM.s094.opt.xml">
ci_001                -7.050617e-01 3 1  ON 0
ci_002                -7.059926e-01 3 1  ON 1
ci_003                -3.765135e-02 3 1  ON 2
ci_004                -3.890325e-02 3 1  ON 3
ci_005                 1.612441e-02 3 1  ON 4
ci_006                 1.600090e-02 3 1  ON 5
ci_007                 1.228713e-02 3 1  ON 6
ci_008                 1.246533e-02 3 1  ON 7
ci_009                -1.173869e-02 3 1  ON 8
ci_010                -1.182876e-02 3 1  ON 9
ci_011                -8.176403e-03 3 1  ON 10
ci_012                -8.138278e-03 3 1  ON 11
ci_013                 9.647137e-03 3 1  ON 12
ci_014                 9.360580e-03 3 1  ON 13
ci_015                 1.228715e-02 3 1  ON 14
ci_016                 1.255400e-02 3 1  ON 15
ci_017                 1.088300e-02 3 1  ON 16
ci_018                 1.078149e-02 3 1  ON 17
ci_019                -2.514322e-03 3 1  ON 18
ci_020                -2.423765e-03 3 1  ON 19
ci_021                -8.459776e-03 3 1  ON 20
ci_022                -8.657034e-03 3 1  ON 21
ci_023                 7.805043e-03 3 1  ON 22
ci_024                 8.041852e-03 3 1  ON 23
ci_025                 4.702642e-03 3 1  ON 24
ci_026                 4.273172e-03 3 1  ON 25
ci_027                 6.454089e-03 3 1  ON 26
ci_028                 6.476482e-03 3 1  ON 27
ci_029                -4.877820e-03 3 1  ON 28
ci_030                -4.785596e-03 3 1  ON 29
ci_031                -7.388694e-03 3 1  ON 30
ci_032                -8.123179e-03 3 1  ON 31
ci_033                 4.600637e-03 3 1  ON 32
ci_034                 4.413553e-03 3 1  ON 33
ci_035                 1.126907e-03 3 1  ON 34
ci_036                 1.043146e-03 3 1  ON 35
ci_037                 4.953347e-03 3 1  ON 36
ci_038                 5.099310e-03 3 1  ON 37
ci_039                 5.306386e-03 3 1  ON 38
ci_040                 5.323086e-03 3 1  ON 39
ci_041                 4.970499e-03 3 1  ON 40
ci_042                 5.231233e-03 3 1  ON 41
ci_043                 4.943052e-03 3 1  ON 42
ci_044                 4.944182e-03 3 1  ON 43
ci_045                 3.123967e-03 3 1  ON 44
ci_046                 3.174246e-03 3 1  ON 45
ci_047                -7.790222e-04 3 1  ON 46
ci_048                -5.616836e-04 3 1  ON 47
ci_049                 1.580289e-03 3 1  ON 48
ci_050                 1.792516e-03 3 1  ON 49
ci_051                -1.106651e-03 3 1  ON 50
ci_052                -1.243279e-03 3 1  ON 51
ci_053                -2.610471e-03 3 1  ON 52
ci_054                -2.301978e-03 3 1  ON 53
ci_055                -1.483475e-03 3 1  ON 54
ci_056                -1.376714e-03 3 1  ON 55
ci_057                -1.240708e-03 3 1  ON 56
ci_058                -1.731077e-03 3 1  ON 57
ci_059                 3.171692e-04 3 1  ON 58
ci_060                 1.414703e-04 3 1  ON 59
ci_061                -3.305088e-04 3 1  ON 60
ci_062                -9.499769e-06 3 1  ON 61
ci_063                -5.232922e-04 3 1  ON 62
ci_064                -8.918525e-04 3 1  ON 63
ci_065                -2.408143e-03 3 1  ON 64
ci_066                -2.435285e-03 3 1  ON 65
ci_067                -2.101084e-03 3 1  ON 66
ci_068                -2.473560e-03 3 1  ON 67
ci_069                -2.085964e-04 3 1  ON 68
ci_070                 1.328450e-04 3 1  ON 69
ci_071                -1.874230e-03 3 1  ON 70
ci_072                -1.959430e-03 3 1  ON 71
ci_073                 5.749021e-04 3 1  ON 72
ci_074                 2.857507e-04 3 1  ON 73
ci_075                -2.910323e-04 3 1  ON 74
ci_076                -2.990999e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="250">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =8000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 94
    time step          = 0.05
    reference energy   = -22.6307
    reference variance = 0.293709
====================================================
  Execution time = 1.0131e+02
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s094
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 62500 
  VMC Eavg = -2.2670e+01
  VMC Evar = 5.1378e-01
  Total weights = 7.8204e+06
  Execution time = 1.4694e+01
  </log>
</opt>
<opt stage="main" walkers="62500">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.497909208692
                                         uncertainty =       0.001422431571

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.497909208692
                                         uncertainty =       0.001422431571

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000249476360
  error estimate for blocks of size 2^( 2) =       0.000258436284
  error estimate for blocks of size 2^( 3) =       0.000266514223
  error estimate for blocks of size 2^( 4) =       0.000272150701
  error estimate for blocks of size 2^( 5) =       0.000275830127
  error estimate for blocks of size 2^( 6) =       0.000277312629
  error estimate for blocks of size 2^( 7) =       0.000278365285
  error estimate for blocks of size 2^( 8) =       0.000278562444
  error estimate for blocks of size 2^( 9) =       0.000279791490

      target function =                  N/A
              le_mean =     -22.669631527969
             les_mean =     514.425971794027
             stat err =       0.000278507962
             autocorr =       1.246282314053
              std dev =       0.705625704320
             le_variance =       0.497907634596

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.497909208692
                                         uncertainty =       0.001422431571

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.497909208692
                                         uncertainty =       0.001422431571

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000249476360
  error estimate for blocks of size 2^( 2) =       0.000258436284
  error estimate for blocks of size 2^( 3) =       0.000266514223
  error estimate for blocks of size 2^( 4) =       0.000272150701
  error estimate for blocks of size 2^( 5) =       0.000275830127
  error estimate for blocks of size 2^( 6) =       0.000277312629
  error estimate for blocks of size 2^( 7) =       0.000278365285
  error estimate for blocks of size 2^( 8) =       0.000278562444
  error estimate for blocks of size 2^( 9) =       0.000279791490

      target function =                  N/A
              le_mean =     -22.669631527969
             les_mean =     514.425971794027
             stat err =       0.000278507962
             autocorr =       1.246282314053
              std dev =       0.705625704320
             le_variance =       0.497907634596

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.497909208692
                                         uncertainty =       0.001422431571

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.497909208692
                                         uncertainty =       0.001422431571

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000249476360
  error estimate for blocks of size 2^( 2) =       0.000258436284
  error estimate for blocks of size 2^( 3) =       0.000266514223
  error estimate for blocks of size 2^( 4) =       0.000272150701
  error estimate for blocks of size 2^( 5) =       0.000275830127
  error estimate for blocks of size 2^( 6) =       0.000277312629
  error estimate for blocks of size 2^( 7) =       0.000278365285
  error estimate for blocks of size 2^( 8) =       0.000278562444
  error estimate for blocks of size 2^( 9) =       0.000279791490

      target function =                  N/A
              le_mean =     -22.669631527969
             les_mean =     514.425971794027
             stat err =       0.000278507962
             autocorr =       1.246282314053
              std dev =       0.705625704320
             le_variance =       0.497907634596

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.497909208692
                                         uncertainty =       0.001422431571

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.497909208692
                                         uncertainty =       0.001422431571

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000249476360
  error estimate for blocks of size 2^( 2) =       0.000258436284
  error estimate for blocks of size 2^( 3) =       0.000266514223
  error estimate for blocks of size 2^( 4) =       0.000272150701
  error estimate for blocks of size 2^( 5) =       0.000275830127
  error estimate for blocks of size 2^( 6) =       0.000277312629
  error estimate for blocks of size 2^( 7) =       0.000278365285
  error estimate for blocks of size 2^( 8) =       0.000278562444
  error estimate for blocks of size 2^( 9) =       0.000279791490

      target function =                  N/A
              le_mean =     -22.669631527969
             les_mean =     514.425971794027
             stat err =       0.000278507962
             autocorr =       1.246282314053
              std dev =       0.705625704320
             le_variance =       0.497907634596


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.669631527969        initial  <--
     1.3878e+36     1.3878e+37             1.1657e-40       -22.669631527969
     5.5511e+36     5.5511e+37             2.9142e-41       -22.669631527969
     2.2204e+37     2.2204e+38             7.2855e-42       -22.669631527969

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 174.7145
  </log>
  <optVariables href="FORM.s094.opt.xml">
ci_001                -7.050617e-01 3 1  ON 0
ci_002                -7.059926e-01 3 1  ON 1
ci_003                -3.765135e-02 3 1  ON 2
ci_004                -3.890325e-02 3 1  ON 3
ci_005                 1.612441e-02 3 1  ON 4
ci_006                 1.600090e-02 3 1  ON 5
ci_007                 1.228713e-02 3 1  ON 6
ci_008                 1.246533e-02 3 1  ON 7
ci_009                -1.173869e-02 3 1  ON 8
ci_010                -1.182876e-02 3 1  ON 9
ci_011                -8.176403e-03 3 1  ON 10
ci_012                -8.138278e-03 3 1  ON 11
ci_013                 9.647137e-03 3 1  ON 12
ci_014                 9.360580e-03 3 1  ON 13
ci_015                 1.228715e-02 3 1  ON 14
ci_016                 1.255400e-02 3 1  ON 15
ci_017                 1.088300e-02 3 1  ON 16
ci_018                 1.078149e-02 3 1  ON 17
ci_019                -2.514322e-03 3 1  ON 18
ci_020                -2.423765e-03 3 1  ON 19
ci_021                -8.459776e-03 3 1  ON 20
ci_022                -8.657034e-03 3 1  ON 21
ci_023                 7.805043e-03 3 1  ON 22
ci_024                 8.041852e-03 3 1  ON 23
ci_025                 4.702642e-03 3 1  ON 24
ci_026                 4.273172e-03 3 1  ON 25
ci_027                 6.454089e-03 3 1  ON 26
ci_028                 6.476482e-03 3 1  ON 27
ci_029                -4.877820e-03 3 1  ON 28
ci_030                -4.785596e-03 3 1  ON 29
ci_031                -7.388694e-03 3 1  ON 30
ci_032                -8.123179e-03 3 1  ON 31
ci_033                 4.600637e-03 3 1  ON 32
ci_034                 4.413553e-03 3 1  ON 33
ci_035                 1.126907e-03 3 1  ON 34
ci_036                 1.043146e-03 3 1  ON 35
ci_037                 4.953347e-03 3 1  ON 36
ci_038                 5.099310e-03 3 1  ON 37
ci_039                 5.306386e-03 3 1  ON 38
ci_040                 5.323086e-03 3 1  ON 39
ci_041                 4.970499e-03 3 1  ON 40
ci_042                 5.231233e-03 3 1  ON 41
ci_043                 4.943052e-03 3 1  ON 42
ci_044                 4.944182e-03 3 1  ON 43
ci_045                 3.123967e-03 3 1  ON 44
ci_046                 3.174246e-03 3 1  ON 45
ci_047                -7.790222e-04 3 1  ON 46
ci_048                -5.616836e-04 3 1  ON 47
ci_049                 1.580289e-03 3 1  ON 48
ci_050                 1.792516e-03 3 1  ON 49
ci_051                -1.106651e-03 3 1  ON 50
ci_052                -1.243279e-03 3 1  ON 51
ci_053                -2.610471e-03 3 1  ON 52
ci_054                -2.301978e-03 3 1  ON 53
ci_055                -1.483475e-03 3 1  ON 54
ci_056                -1.376714e-03 3 1  ON 55
ci_057                -1.240708e-03 3 1  ON 56
ci_058                -1.731077e-03 3 1  ON 57
ci_059                 3.171692e-04 3 1  ON 58
ci_060                 1.414703e-04 3 1  ON 59
ci_061                -3.305088e-04 3 1  ON 60
ci_062                -9.499769e-06 3 1  ON 61
ci_063                -5.232922e-04 3 1  ON 62
ci_064                -8.918525e-04 3 1  ON 63
ci_065                -2.408143e-03 3 1  ON 64
ci_066                -2.435285e-03 3 1  ON 65
ci_067                -2.101084e-03 3 1  ON 66
ci_068                -2.473560e-03 3 1  ON 67
ci_069                -2.085964e-04 3 1  ON 68
ci_070                 1.328450e-04 3 1  ON 69
ci_071                -1.874230e-03 3 1  ON 70
ci_072                -1.959430e-03 3 1  ON 71
ci_073                 5.749021e-04 3 1  ON 72
ci_074                 2.857507e-04 3 1  ON 73
ci_075                -2.910323e-04 3 1  ON 74
ci_076                -2.990999e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 2.9610e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s095 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s095 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=95  my_counter=0
  time step      = 5.0000e-02
  blocks         = 250
  steps          = 250
  substeps       = 10
  current        = 0
  target samples = 8.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">250</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">6.2500e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">8.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">6.2500e+04</parameter>
<parameter name="steps" condition="int">250</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2663e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="250">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =8000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 95
    time step          = 0.05
    reference energy   = -22.6635
    reference variance = 0.540357
====================================================
  Execution time = 1.0351e+02
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s095
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 62500 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 6.1140e+04
  VMC Eavg = -2.2669e+01
  VMC Evar = 5.0969e-01
  Total weights = 7.820120773e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.8886e+01
  </log>
</opt>
<opt stage="main" walkers="62500">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.496988106180
                                         uncertainty =       0.001488921291

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.496988106180
                                         uncertainty =       0.001488921291

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000249245122
  error estimate for blocks of size 2^( 2) =       0.000258290641
  error estimate for blocks of size 2^( 3) =       0.000266292676
  error estimate for blocks of size 2^( 4) =       0.000272240156
  error estimate for blocks of size 2^( 5) =       0.000275501208
  error estimate for blocks of size 2^( 6) =       0.000277236161
  error estimate for blocks of size 2^( 7) =       0.000278456403
  error estimate for blocks of size 2^( 8) =       0.000280146113
  error estimate for blocks of size 2^( 9) =       0.000279885706

      target function =                  N/A
              le_mean =     -22.669315769289
             les_mean =     514.407565001275
             stat err =       0.000278931096
             autocorr =       1.252392713427
              std dev =       0.704971662645
             le_variance =       0.496985045133


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266931576929e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.3878e+37, overlap shift 1.3878e+38 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.669315769311       residual = 3.92e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.669315769311       residual = 7.32e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.669315338135       residual = 3.92e-05           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 1.3878e+37 is 1.236374e-41

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 5.5511e+37, overlap shift 5.5511e+38 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.669315769311       residual = 3.92e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.669315769311       residual = 7.32e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.669315769311       residual = 3.41e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.669315814972       residual = 4.85e-06           smallest_sin_value = 1.00e+00
davidson iteration    4 stopping due to too large eigenvalue change
davidson solver did not converge after          4 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 5.5511e+37 is 3.172263e-42

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 2.2204e+38, overlap shift 2.2204e+39 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.669315769311       residual = 3.92e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.669315769311       residual = 7.32e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.669315769311       residual = 3.41e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.669315338135       residual = 4.85e-06           smallest_sin_value = 1.00e+00
davidson iteration    4 stopping due to too large eigenvalue change
davidson solver did not converge after          4 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 2.2204e+38 is 7.930659e-43

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.202830 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.2241e+02
  </log>
  <optVariables href="FORM.s095.opt.xml">
ci_001                -7.050617e-01 3 1  ON 0
ci_002                -7.059926e-01 3 1  ON 1
ci_003                -3.765135e-02 3 1  ON 2
ci_004                -3.890325e-02 3 1  ON 3
ci_005                 1.612441e-02 3 1  ON 4
ci_006                 1.600090e-02 3 1  ON 5
ci_007                 1.228713e-02 3 1  ON 6
ci_008                 1.246533e-02 3 1  ON 7
ci_009                -1.173869e-02 3 1  ON 8
ci_010                -1.182876e-02 3 1  ON 9
ci_011                -8.176403e-03 3 1  ON 10
ci_012                -8.138278e-03 3 1  ON 11
ci_013                 9.647137e-03 3 1  ON 12
ci_014                 9.360580e-03 3 1  ON 13
ci_015                 1.228715e-02 3 1  ON 14
ci_016                 1.255400e-02 3 1  ON 15
ci_017                 1.088300e-02 3 1  ON 16
ci_018                 1.078149e-02 3 1  ON 17
ci_019                -2.514322e-03 3 1  ON 18
ci_020                -2.423765e-03 3 1  ON 19
ci_021                -8.459776e-03 3 1  ON 20
ci_022                -8.657034e-03 3 1  ON 21
ci_023                 7.805043e-03 3 1  ON 22
ci_024                 8.041852e-03 3 1  ON 23
ci_025                 4.702642e-03 3 1  ON 24
ci_026                 4.273172e-03 3 1  ON 25
ci_027                 6.454089e-03 3 1  ON 26
ci_028                 6.476482e-03 3 1  ON 27
ci_029                -4.877820e-03 3 1  ON 28
ci_030                -4.785596e-03 3 1  ON 29
ci_031                -7.388694e-03 3 1  ON 30
ci_032                -8.123179e-03 3 1  ON 31
ci_033                 4.600637e-03 3 1  ON 32
ci_034                 4.413553e-03 3 1  ON 33
ci_035                 1.126907e-03 3 1  ON 34
ci_036                 1.043146e-03 3 1  ON 35
ci_037                 4.953347e-03 3 1  ON 36
ci_038                 5.099310e-03 3 1  ON 37
ci_039                 5.306386e-03 3 1  ON 38
ci_040                 5.323086e-03 3 1  ON 39
ci_041                 4.970499e-03 3 1  ON 40
ci_042                 5.231233e-03 3 1  ON 41
ci_043                 4.943052e-03 3 1  ON 42
ci_044                 4.944182e-03 3 1  ON 43
ci_045                 3.123967e-03 3 1  ON 44
ci_046                 3.174246e-03 3 1  ON 45
ci_047                -7.790222e-04 3 1  ON 46
ci_048                -5.616836e-04 3 1  ON 47
ci_049                 1.580289e-03 3 1  ON 48
ci_050                 1.792516e-03 3 1  ON 49
ci_051                -1.106651e-03 3 1  ON 50
ci_052                -1.243279e-03 3 1  ON 51
ci_053                -2.610471e-03 3 1  ON 52
ci_054                -2.301978e-03 3 1  ON 53
ci_055                -1.483475e-03 3 1  ON 54
ci_056                -1.376714e-03 3 1  ON 55
ci_057                -1.240708e-03 3 1  ON 56
ci_058                -1.731077e-03 3 1  ON 57
ci_059                 3.171692e-04 3 1  ON 58
ci_060                 1.414703e-04 3 1  ON 59
ci_061                -3.305088e-04 3 1  ON 60
ci_062                -9.499769e-06 3 1  ON 61
ci_063                -5.232922e-04 3 1  ON 62
ci_064                -8.918525e-04 3 1  ON 63
ci_065                -2.408143e-03 3 1  ON 64
ci_066                -2.435285e-03 3 1  ON 65
ci_067                -2.101084e-03 3 1  ON 66
ci_068                -2.473560e-03 3 1  ON 67
ci_069                -2.085964e-04 3 1  ON 68
ci_070                 1.328450e-04 3 1  ON 69
ci_071                -1.874230e-03 3 1  ON 70
ci_072                -1.959430e-03 3 1  ON 71
ci_073                 5.749021e-04 3 1  ON 72
ci_074                 2.857507e-04 3 1  ON 73
ci_075                -2.910323e-04 3 1  ON 74
ci_076                -2.990999e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="250">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =8000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 95
    time step          = 0.05
    reference energy   = -22.7087
    reference variance = 0.305188
====================================================
  Execution time = 1.0118e+02
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s095
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 62500 
  VMC Eavg = -2.2670e+01
  VMC Evar = 5.1352e-01
  Total weights = 7.8206e+06
  Execution time = 1.4660e+01
  </log>
</opt>
<opt stage="main" walkers="62500">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.499241188486
                                         uncertainty =       0.001578941877

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.499241188486
                                         uncertainty =       0.001578941877

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000249810398
  error estimate for blocks of size 2^( 2) =       0.000258858161
  error estimate for blocks of size 2^( 3) =       0.000266939769
  error estimate for blocks of size 2^( 4) =       0.000272877292
  error estimate for blocks of size 2^( 5) =       0.000276258840
  error estimate for blocks of size 2^( 6) =       0.000278357665
  error estimate for blocks of size 2^( 7) =       0.000280184354
  error estimate for blocks of size 2^( 8) =       0.000281008994
  error estimate for blocks of size 2^( 9) =       0.000281066101

      target function =                  N/A
              le_mean =     -22.669803036281
             les_mean =     514.433492738066
             stat err =       0.000280154279
             autocorr =       1.257689680288
              std dev =       0.706570505198
             le_variance =       0.499241878816

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.499241188486
                                         uncertainty =       0.001578941877

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.499241188486
                                         uncertainty =       0.001578941877

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000249810398
  error estimate for blocks of size 2^( 2) =       0.000258858161
  error estimate for blocks of size 2^( 3) =       0.000266939769
  error estimate for blocks of size 2^( 4) =       0.000272877292
  error estimate for blocks of size 2^( 5) =       0.000276258840
  error estimate for blocks of size 2^( 6) =       0.000278357665
  error estimate for blocks of size 2^( 7) =       0.000280184354
  error estimate for blocks of size 2^( 8) =       0.000281008994
  error estimate for blocks of size 2^( 9) =       0.000281066101

      target function =                  N/A
              le_mean =     -22.669803036281
             les_mean =     514.433492738066
             stat err =       0.000280154279
             autocorr =       1.257689680288
              std dev =       0.706570505198
             le_variance =       0.499241878816

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.499241188486
                                         uncertainty =       0.001578941877

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.499241188486
                                         uncertainty =       0.001578941877

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000249810398
  error estimate for blocks of size 2^( 2) =       0.000258858161
  error estimate for blocks of size 2^( 3) =       0.000266939769
  error estimate for blocks of size 2^( 4) =       0.000272877292
  error estimate for blocks of size 2^( 5) =       0.000276258840
  error estimate for blocks of size 2^( 6) =       0.000278357665
  error estimate for blocks of size 2^( 7) =       0.000280184354
  error estimate for blocks of size 2^( 8) =       0.000281008994
  error estimate for blocks of size 2^( 9) =       0.000281066101

      target function =                  N/A
              le_mean =     -22.669803036281
             les_mean =     514.433492738066
             stat err =       0.000280154279
             autocorr =       1.257689680288
              std dev =       0.706570505198
             le_variance =       0.499241878816

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.499241188486
                                         uncertainty =       0.001578941877

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.499241188486
                                         uncertainty =       0.001578941877

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000249810398
  error estimate for blocks of size 2^( 2) =       0.000258858161
  error estimate for blocks of size 2^( 3) =       0.000266939769
  error estimate for blocks of size 2^( 4) =       0.000272877292
  error estimate for blocks of size 2^( 5) =       0.000276258840
  error estimate for blocks of size 2^( 6) =       0.000278357665
  error estimate for blocks of size 2^( 7) =       0.000280184354
  error estimate for blocks of size 2^( 8) =       0.000281008994
  error estimate for blocks of size 2^( 9) =       0.000281066101

      target function =                  N/A
              le_mean =     -22.669803036281
             les_mean =     514.433492738066
             stat err =       0.000280154279
             autocorr =       1.257689680288
              std dev =       0.706570505198
             le_variance =       0.499241878816


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.669803036281        initial  <--
     1.3878e+37     1.3878e+38             1.2364e-41       -22.669803036281
     5.5511e+37     5.5511e+38             3.1723e-42       -22.669803036281
     2.2204e+38     2.2204e+39             7.9307e-43       -22.669803036281

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 174.5311
  </log>
  <optVariables href="FORM.s095.opt.xml">
ci_001                -7.050617e-01 3 1  ON 0
ci_002                -7.059926e-01 3 1  ON 1
ci_003                -3.765135e-02 3 1  ON 2
ci_004                -3.890325e-02 3 1  ON 3
ci_005                 1.612441e-02 3 1  ON 4
ci_006                 1.600090e-02 3 1  ON 5
ci_007                 1.228713e-02 3 1  ON 6
ci_008                 1.246533e-02 3 1  ON 7
ci_009                -1.173869e-02 3 1  ON 8
ci_010                -1.182876e-02 3 1  ON 9
ci_011                -8.176403e-03 3 1  ON 10
ci_012                -8.138278e-03 3 1  ON 11
ci_013                 9.647137e-03 3 1  ON 12
ci_014                 9.360580e-03 3 1  ON 13
ci_015                 1.228715e-02 3 1  ON 14
ci_016                 1.255400e-02 3 1  ON 15
ci_017                 1.088300e-02 3 1  ON 16
ci_018                 1.078149e-02 3 1  ON 17
ci_019                -2.514322e-03 3 1  ON 18
ci_020                -2.423765e-03 3 1  ON 19
ci_021                -8.459776e-03 3 1  ON 20
ci_022                -8.657034e-03 3 1  ON 21
ci_023                 7.805043e-03 3 1  ON 22
ci_024                 8.041852e-03 3 1  ON 23
ci_025                 4.702642e-03 3 1  ON 24
ci_026                 4.273172e-03 3 1  ON 25
ci_027                 6.454089e-03 3 1  ON 26
ci_028                 6.476482e-03 3 1  ON 27
ci_029                -4.877820e-03 3 1  ON 28
ci_030                -4.785596e-03 3 1  ON 29
ci_031                -7.388694e-03 3 1  ON 30
ci_032                -8.123179e-03 3 1  ON 31
ci_033                 4.600637e-03 3 1  ON 32
ci_034                 4.413553e-03 3 1  ON 33
ci_035                 1.126907e-03 3 1  ON 34
ci_036                 1.043146e-03 3 1  ON 35
ci_037                 4.953347e-03 3 1  ON 36
ci_038                 5.099310e-03 3 1  ON 37
ci_039                 5.306386e-03 3 1  ON 38
ci_040                 5.323086e-03 3 1  ON 39
ci_041                 4.970499e-03 3 1  ON 40
ci_042                 5.231233e-03 3 1  ON 41
ci_043                 4.943052e-03 3 1  ON 42
ci_044                 4.944182e-03 3 1  ON 43
ci_045                 3.123967e-03 3 1  ON 44
ci_046                 3.174246e-03 3 1  ON 45
ci_047                -7.790222e-04 3 1  ON 46
ci_048                -5.616836e-04 3 1  ON 47
ci_049                 1.580289e-03 3 1  ON 48
ci_050                 1.792516e-03 3 1  ON 49
ci_051                -1.106651e-03 3 1  ON 50
ci_052                -1.243279e-03 3 1  ON 51
ci_053                -2.610471e-03 3 1  ON 52
ci_054                -2.301978e-03 3 1  ON 53
ci_055                -1.483475e-03 3 1  ON 54
ci_056                -1.376714e-03 3 1  ON 55
ci_057                -1.240708e-03 3 1  ON 56
ci_058                -1.731077e-03 3 1  ON 57
ci_059                 3.171692e-04 3 1  ON 58
ci_060                 1.414703e-04 3 1  ON 59
ci_061                -3.305088e-04 3 1  ON 60
ci_062                -9.499769e-06 3 1  ON 61
ci_063                -5.232922e-04 3 1  ON 62
ci_064                -8.918525e-04 3 1  ON 63
ci_065                -2.408143e-03 3 1  ON 64
ci_066                -2.435285e-03 3 1  ON 65
ci_067                -2.101084e-03 3 1  ON 66
ci_068                -2.473560e-03 3 1  ON 67
ci_069                -2.085964e-04 3 1  ON 68
ci_070                 1.328450e-04 3 1  ON 69
ci_071                -1.874230e-03 3 1  ON 70
ci_072                -1.959430e-03 3 1  ON 71
ci_073                 5.749021e-04 3 1  ON 72
ci_074                 2.857507e-04 3 1  ON 73
ci_075                -2.910323e-04 3 1  ON 74
ci_076                -2.990999e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 2.9700e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s096 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s096 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=96  my_counter=0
  time step      = 5.0000e-02
  blocks         = 250
  steps          = 250
  substeps       = 10
  current        = 0
  target samples = 8.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">250</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">6.2500e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">8.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">6.2500e+04</parameter>
<parameter name="steps" condition="int">250</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2663e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="250">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =8000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 96
    time step          = 0.05
    reference energy   = -22.6531
    reference variance = 0.233604
====================================================
  Execution time = 1.0317e+02
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s096
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 62500 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 6.1155e+04
  VMC Eavg = -2.2670e+01
  VMC Evar = 5.1184e-01
  Total weights = 7.820794697e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.9027e+01
  </log>
</opt>
<opt stage="main" walkers="62500">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.498723543255
                                         uncertainty =       0.001850983963

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.498723543255
                                         uncertainty =       0.001850983963

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000249679389
  error estimate for blocks of size 2^( 2) =       0.000258495808
  error estimate for blocks of size 2^( 3) =       0.000266493467
  error estimate for blocks of size 2^( 4) =       0.000272332192
  error estimate for blocks of size 2^( 5) =       0.000275456520
  error estimate for blocks of size 2^( 6) =       0.000277570594
  error estimate for blocks of size 2^( 7) =       0.000278479875
  error estimate for blocks of size 2^( 8) =       0.000279251400
  error estimate for blocks of size 2^( 9) =       0.000279989957

      target function =                  N/A
              le_mean =     -22.670313161889
             les_mean =     514.454936651446
             stat err =       0.000278822956
             autocorr =       1.247072409921
              std dev =       0.706199955219
             le_variance =       0.498718376752


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.267031316189e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.3878e+38, overlap shift 1.3878e+39 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.670313161913       residual = 6.47e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.670313161913       residual = 9.19e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.670313161913       residual = 2.69e-08           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 1.3878e+38 is 3.214564e-42

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 5.5511e+38, overlap shift 5.5511e+39 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.670313161913       residual = 6.47e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.670313161913       residual = 9.19e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.670313161913       residual = 2.69e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.670313161913       residual = 9.96e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 5.5511e+38 is 8.052751e-43

solving harmonic davidson linear method for identity shift 2.2204e+39, overlap shift 2.2204e+40 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.670313161913       residual = 6.47e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.670313161913       residual = 9.19e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.670313161913       residual = 2.69e-08           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 2.2204e+39 is 2.009103e-43

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.204207 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.2221e+02
  </log>
  <optVariables href="FORM.s096.opt.xml">
ci_001                -7.050617e-01 3 1  ON 0
ci_002                -7.059926e-01 3 1  ON 1
ci_003                -3.765135e-02 3 1  ON 2
ci_004                -3.890325e-02 3 1  ON 3
ci_005                 1.612441e-02 3 1  ON 4
ci_006                 1.600090e-02 3 1  ON 5
ci_007                 1.228713e-02 3 1  ON 6
ci_008                 1.246533e-02 3 1  ON 7
ci_009                -1.173869e-02 3 1  ON 8
ci_010                -1.182876e-02 3 1  ON 9
ci_011                -8.176403e-03 3 1  ON 10
ci_012                -8.138278e-03 3 1  ON 11
ci_013                 9.647137e-03 3 1  ON 12
ci_014                 9.360580e-03 3 1  ON 13
ci_015                 1.228715e-02 3 1  ON 14
ci_016                 1.255400e-02 3 1  ON 15
ci_017                 1.088300e-02 3 1  ON 16
ci_018                 1.078149e-02 3 1  ON 17
ci_019                -2.514322e-03 3 1  ON 18
ci_020                -2.423765e-03 3 1  ON 19
ci_021                -8.459776e-03 3 1  ON 20
ci_022                -8.657034e-03 3 1  ON 21
ci_023                 7.805043e-03 3 1  ON 22
ci_024                 8.041852e-03 3 1  ON 23
ci_025                 4.702642e-03 3 1  ON 24
ci_026                 4.273172e-03 3 1  ON 25
ci_027                 6.454089e-03 3 1  ON 26
ci_028                 6.476482e-03 3 1  ON 27
ci_029                -4.877820e-03 3 1  ON 28
ci_030                -4.785596e-03 3 1  ON 29
ci_031                -7.388694e-03 3 1  ON 30
ci_032                -8.123179e-03 3 1  ON 31
ci_033                 4.600637e-03 3 1  ON 32
ci_034                 4.413553e-03 3 1  ON 33
ci_035                 1.126907e-03 3 1  ON 34
ci_036                 1.043146e-03 3 1  ON 35
ci_037                 4.953347e-03 3 1  ON 36
ci_038                 5.099310e-03 3 1  ON 37
ci_039                 5.306386e-03 3 1  ON 38
ci_040                 5.323086e-03 3 1  ON 39
ci_041                 4.970499e-03 3 1  ON 40
ci_042                 5.231233e-03 3 1  ON 41
ci_043                 4.943052e-03 3 1  ON 42
ci_044                 4.944182e-03 3 1  ON 43
ci_045                 3.123967e-03 3 1  ON 44
ci_046                 3.174246e-03 3 1  ON 45
ci_047                -7.790222e-04 3 1  ON 46
ci_048                -5.616836e-04 3 1  ON 47
ci_049                 1.580289e-03 3 1  ON 48
ci_050                 1.792516e-03 3 1  ON 49
ci_051                -1.106651e-03 3 1  ON 50
ci_052                -1.243279e-03 3 1  ON 51
ci_053                -2.610471e-03 3 1  ON 52
ci_054                -2.301978e-03 3 1  ON 53
ci_055                -1.483475e-03 3 1  ON 54
ci_056                -1.376714e-03 3 1  ON 55
ci_057                -1.240708e-03 3 1  ON 56
ci_058                -1.731077e-03 3 1  ON 57
ci_059                 3.171692e-04 3 1  ON 58
ci_060                 1.414703e-04 3 1  ON 59
ci_061                -3.305088e-04 3 1  ON 60
ci_062                -9.499769e-06 3 1  ON 61
ci_063                -5.232922e-04 3 1  ON 62
ci_064                -8.918525e-04 3 1  ON 63
ci_065                -2.408143e-03 3 1  ON 64
ci_066                -2.435285e-03 3 1  ON 65
ci_067                -2.101084e-03 3 1  ON 66
ci_068                -2.473560e-03 3 1  ON 67
ci_069                -2.085964e-04 3 1  ON 68
ci_070                 1.328450e-04 3 1  ON 69
ci_071                -1.874230e-03 3 1  ON 70
ci_072                -1.959430e-03 3 1  ON 71
ci_073                 5.749021e-04 3 1  ON 72
ci_074                 2.857507e-04 3 1  ON 73
ci_075                -2.910323e-04 3 1  ON 74
ci_076                -2.990999e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="250">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =8000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 96
    time step          = 0.05
    reference energy   = -22.7203
    reference variance = 0.513794
====================================================
  Execution time = 1.0154e+02
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s096
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 62500 
  VMC Eavg = -2.2670e+01
  VMC Evar = 5.1003e-01
  Total weights = 7.8206e+06
  Execution time = 1.4720e+01
  </log>
</opt>
<opt stage="main" walkers="62500">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.496553577066
                                         uncertainty =       0.001461525507

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.496553577066
                                         uncertainty =       0.001461525507

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000249137067
  error estimate for blocks of size 2^( 2) =       0.000258060072
  error estimate for blocks of size 2^( 3) =       0.000266108411
  error estimate for blocks of size 2^( 4) =       0.000271924559
  error estimate for blocks of size 2^( 5) =       0.000275222156
  error estimate for blocks of size 2^( 6) =       0.000277072741
  error estimate for blocks of size 2^( 7) =       0.000278203343
  error estimate for blocks of size 2^( 8) =       0.000278427674
  error estimate for blocks of size 2^( 9) =       0.000278413194

      target function =                  N/A
              le_mean =     -22.669506341881
             les_mean =     514.416546081794
             stat err =       0.000278029238
             autocorr =       1.245386762268
              std dev =       0.704666037064
             le_variance =       0.496554223792

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.496553577066
                                         uncertainty =       0.001461525507

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.496553577066
                                         uncertainty =       0.001461525507

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000249137067
  error estimate for blocks of size 2^( 2) =       0.000258060072
  error estimate for blocks of size 2^( 3) =       0.000266108411
  error estimate for blocks of size 2^( 4) =       0.000271924559
  error estimate for blocks of size 2^( 5) =       0.000275222156
  error estimate for blocks of size 2^( 6) =       0.000277072741
  error estimate for blocks of size 2^( 7) =       0.000278203343
  error estimate for blocks of size 2^( 8) =       0.000278427674
  error estimate for blocks of size 2^( 9) =       0.000278413194

      target function =                  N/A
              le_mean =     -22.669506341881
             les_mean =     514.416546081794
             stat err =       0.000278029238
             autocorr =       1.245386762268
              std dev =       0.704666037064
             le_variance =       0.496554223792

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.496553577066
                                         uncertainty =       0.001461525507

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.496553577066
                                         uncertainty =       0.001461525507

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000249137067
  error estimate for blocks of size 2^( 2) =       0.000258060072
  error estimate for blocks of size 2^( 3) =       0.000266108411
  error estimate for blocks of size 2^( 4) =       0.000271924559
  error estimate for blocks of size 2^( 5) =       0.000275222156
  error estimate for blocks of size 2^( 6) =       0.000277072741
  error estimate for blocks of size 2^( 7) =       0.000278203343
  error estimate for blocks of size 2^( 8) =       0.000278427674
  error estimate for blocks of size 2^( 9) =       0.000278413194

      target function =                  N/A
              le_mean =     -22.669506341881
             les_mean =     514.416546081794
             stat err =       0.000278029238
             autocorr =       1.245386762268
              std dev =       0.704666037064
             le_variance =       0.496554223792

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.496553577066
                                         uncertainty =       0.001461525507

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.496553577066
                                         uncertainty =       0.001461525507

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000249137067
  error estimate for blocks of size 2^( 2) =       0.000258060072
  error estimate for blocks of size 2^( 3) =       0.000266108411
  error estimate for blocks of size 2^( 4) =       0.000271924559
  error estimate for blocks of size 2^( 5) =       0.000275222156
  error estimate for blocks of size 2^( 6) =       0.000277072741
  error estimate for blocks of size 2^( 7) =       0.000278203343
  error estimate for blocks of size 2^( 8) =       0.000278427674
  error estimate for blocks of size 2^( 9) =       0.000278413194

      target function =                  N/A
              le_mean =     -22.669506341881
             les_mean =     514.416546081794
             stat err =       0.000278029238
             autocorr =       1.245386762268
              std dev =       0.704666037064
             le_variance =       0.496554223792


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.669506341881        initial  <--
     1.3878e+38     1.3878e+39             3.2146e-42       -22.669506341881
     5.5511e+38     5.5511e+39             8.0528e-43       -22.669506341881
     2.2204e+39     2.2204e+40             2.0091e-43       -22.669506341881

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 175.3390
  </log>
  <optVariables href="FORM.s096.opt.xml">
ci_001                -7.050617e-01 3 1  ON 0
ci_002                -7.059926e-01 3 1  ON 1
ci_003                -3.765135e-02 3 1  ON 2
ci_004                -3.890325e-02 3 1  ON 3
ci_005                 1.612441e-02 3 1  ON 4
ci_006                 1.600090e-02 3 1  ON 5
ci_007                 1.228713e-02 3 1  ON 6
ci_008                 1.246533e-02 3 1  ON 7
ci_009                -1.173869e-02 3 1  ON 8
ci_010                -1.182876e-02 3 1  ON 9
ci_011                -8.176403e-03 3 1  ON 10
ci_012                -8.138278e-03 3 1  ON 11
ci_013                 9.647137e-03 3 1  ON 12
ci_014                 9.360580e-03 3 1  ON 13
ci_015                 1.228715e-02 3 1  ON 14
ci_016                 1.255400e-02 3 1  ON 15
ci_017                 1.088300e-02 3 1  ON 16
ci_018                 1.078149e-02 3 1  ON 17
ci_019                -2.514322e-03 3 1  ON 18
ci_020                -2.423765e-03 3 1  ON 19
ci_021                -8.459776e-03 3 1  ON 20
ci_022                -8.657034e-03 3 1  ON 21
ci_023                 7.805043e-03 3 1  ON 22
ci_024                 8.041852e-03 3 1  ON 23
ci_025                 4.702642e-03 3 1  ON 24
ci_026                 4.273172e-03 3 1  ON 25
ci_027                 6.454089e-03 3 1  ON 26
ci_028                 6.476482e-03 3 1  ON 27
ci_029                -4.877820e-03 3 1  ON 28
ci_030                -4.785596e-03 3 1  ON 29
ci_031                -7.388694e-03 3 1  ON 30
ci_032                -8.123179e-03 3 1  ON 31
ci_033                 4.600637e-03 3 1  ON 32
ci_034                 4.413553e-03 3 1  ON 33
ci_035                 1.126907e-03 3 1  ON 34
ci_036                 1.043146e-03 3 1  ON 35
ci_037                 4.953347e-03 3 1  ON 36
ci_038                 5.099310e-03 3 1  ON 37
ci_039                 5.306386e-03 3 1  ON 38
ci_040                 5.323086e-03 3 1  ON 39
ci_041                 4.970499e-03 3 1  ON 40
ci_042                 5.231233e-03 3 1  ON 41
ci_043                 4.943052e-03 3 1  ON 42
ci_044                 4.944182e-03 3 1  ON 43
ci_045                 3.123967e-03 3 1  ON 44
ci_046                 3.174246e-03 3 1  ON 45
ci_047                -7.790222e-04 3 1  ON 46
ci_048                -5.616836e-04 3 1  ON 47
ci_049                 1.580289e-03 3 1  ON 48
ci_050                 1.792516e-03 3 1  ON 49
ci_051                -1.106651e-03 3 1  ON 50
ci_052                -1.243279e-03 3 1  ON 51
ci_053                -2.610471e-03 3 1  ON 52
ci_054                -2.301978e-03 3 1  ON 53
ci_055                -1.483475e-03 3 1  ON 54
ci_056                -1.376714e-03 3 1  ON 55
ci_057                -1.240708e-03 3 1  ON 56
ci_058                -1.731077e-03 3 1  ON 57
ci_059                 3.171692e-04 3 1  ON 58
ci_060                 1.414703e-04 3 1  ON 59
ci_061                -3.305088e-04 3 1  ON 60
ci_062                -9.499769e-06 3 1  ON 61
ci_063                -5.232922e-04 3 1  ON 62
ci_064                -8.918525e-04 3 1  ON 63
ci_065                -2.408143e-03 3 1  ON 64
ci_066                -2.435285e-03 3 1  ON 65
ci_067                -2.101084e-03 3 1  ON 66
ci_068                -2.473560e-03 3 1  ON 67
ci_069                -2.085964e-04 3 1  ON 68
ci_070                 1.328450e-04 3 1  ON 69
ci_071                -1.874230e-03 3 1  ON 70
ci_072                -1.959430e-03 3 1  ON 71
ci_073                 5.749021e-04 3 1  ON 72
ci_074                 2.857507e-04 3 1  ON 73
ci_075                -2.910323e-04 3 1  ON 74
ci_076                -2.990999e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 2.9757e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s097 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s097 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=97  my_counter=0
  time step      = 5.0000e-02
  blocks         = 250
  steps          = 250
  substeps       = 10
  current        = 0
  target samples = 8.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">250</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">6.2500e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">8.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">6.2500e+04</parameter>
<parameter name="steps" condition="int">250</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2663e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="250">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =8000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 97
    time step          = 0.05
    reference energy   = -22.6054
    reference variance = 0.64405
====================================================
  Execution time = 1.0352e+02
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s097
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 62500 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 6.1139e+04
  VMC Eavg = -2.2669e+01
  VMC Evar = 5.0796e-01
  Total weights = 7.820148420e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.9319e+01
  </log>
</opt>
<opt stage="main" walkers="62500">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.495881875895
                                         uncertainty =       0.001325274669

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.495881875895
                                         uncertainty =       0.001325274669

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000248968929
  error estimate for blocks of size 2^( 2) =       0.000257942229
  error estimate for blocks of size 2^( 3) =       0.000266003932
  error estimate for blocks of size 2^( 4) =       0.000271722956
  error estimate for blocks of size 2^( 5) =       0.000274958165
  error estimate for blocks of size 2^( 6) =       0.000276878979
  error estimate for blocks of size 2^( 7) =       0.000277892923
  error estimate for blocks of size 2^( 8) =       0.000278753881
  error estimate for blocks of size 2^( 9) =       0.000279813307

      target function =                  N/A
              le_mean =     -22.669418592727
             les_mean =     514.410499591792
             stat err =       0.000278334773
             autocorr =       1.249811823903
              std dev =       0.704190473272
             le_variance =       0.495884222647


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266941859273e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.3878e+39, overlap shift 1.3878e+40 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.669418592749       residual = 4.15e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.669418592749       residual = 5.04e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.669418334961       residual = 4.15e-05           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 1.3878e+39 is 1.494209e-43

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 5.5511e+39, overlap shift 5.5511e+40 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.669418592749       residual = 4.15e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.669418592749       residual = 5.04e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.669418334961       residual = 4.15e-05           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 5.5511e+39 is 3.735524e-44

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 2.2204e+40, overlap shift 2.2204e+41 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.669418592749       residual = 4.15e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.669418592749       residual = 5.04e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.669433593750       residual = 4.15e-05           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 2.2204e+40 is 9.338809e-45

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.205602 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.2285e+02
  </log>
  <optVariables href="FORM.s097.opt.xml">
ci_001                -7.050617e-01 3 1  ON 0
ci_002                -7.059926e-01 3 1  ON 1
ci_003                -3.765135e-02 3 1  ON 2
ci_004                -3.890325e-02 3 1  ON 3
ci_005                 1.612441e-02 3 1  ON 4
ci_006                 1.600090e-02 3 1  ON 5
ci_007                 1.228713e-02 3 1  ON 6
ci_008                 1.246533e-02 3 1  ON 7
ci_009                -1.173869e-02 3 1  ON 8
ci_010                -1.182876e-02 3 1  ON 9
ci_011                -8.176403e-03 3 1  ON 10
ci_012                -8.138278e-03 3 1  ON 11
ci_013                 9.647137e-03 3 1  ON 12
ci_014                 9.360580e-03 3 1  ON 13
ci_015                 1.228715e-02 3 1  ON 14
ci_016                 1.255400e-02 3 1  ON 15
ci_017                 1.088300e-02 3 1  ON 16
ci_018                 1.078149e-02 3 1  ON 17
ci_019                -2.514322e-03 3 1  ON 18
ci_020                -2.423765e-03 3 1  ON 19
ci_021                -8.459776e-03 3 1  ON 20
ci_022                -8.657034e-03 3 1  ON 21
ci_023                 7.805043e-03 3 1  ON 22
ci_024                 8.041852e-03 3 1  ON 23
ci_025                 4.702642e-03 3 1  ON 24
ci_026                 4.273172e-03 3 1  ON 25
ci_027                 6.454089e-03 3 1  ON 26
ci_028                 6.476482e-03 3 1  ON 27
ci_029                -4.877820e-03 3 1  ON 28
ci_030                -4.785596e-03 3 1  ON 29
ci_031                -7.388694e-03 3 1  ON 30
ci_032                -8.123179e-03 3 1  ON 31
ci_033                 4.600637e-03 3 1  ON 32
ci_034                 4.413553e-03 3 1  ON 33
ci_035                 1.126907e-03 3 1  ON 34
ci_036                 1.043146e-03 3 1  ON 35
ci_037                 4.953347e-03 3 1  ON 36
ci_038                 5.099310e-03 3 1  ON 37
ci_039                 5.306386e-03 3 1  ON 38
ci_040                 5.323086e-03 3 1  ON 39
ci_041                 4.970499e-03 3 1  ON 40
ci_042                 5.231233e-03 3 1  ON 41
ci_043                 4.943052e-03 3 1  ON 42
ci_044                 4.944182e-03 3 1  ON 43
ci_045                 3.123967e-03 3 1  ON 44
ci_046                 3.174246e-03 3 1  ON 45
ci_047                -7.790222e-04 3 1  ON 46
ci_048                -5.616836e-04 3 1  ON 47
ci_049                 1.580289e-03 3 1  ON 48
ci_050                 1.792516e-03 3 1  ON 49
ci_051                -1.106651e-03 3 1  ON 50
ci_052                -1.243279e-03 3 1  ON 51
ci_053                -2.610471e-03 3 1  ON 52
ci_054                -2.301978e-03 3 1  ON 53
ci_055                -1.483475e-03 3 1  ON 54
ci_056                -1.376714e-03 3 1  ON 55
ci_057                -1.240708e-03 3 1  ON 56
ci_058                -1.731077e-03 3 1  ON 57
ci_059                 3.171692e-04 3 1  ON 58
ci_060                 1.414703e-04 3 1  ON 59
ci_061                -3.305088e-04 3 1  ON 60
ci_062                -9.499769e-06 3 1  ON 61
ci_063                -5.232922e-04 3 1  ON 62
ci_064                -8.918525e-04 3 1  ON 63
ci_065                -2.408143e-03 3 1  ON 64
ci_066                -2.435285e-03 3 1  ON 65
ci_067                -2.101084e-03 3 1  ON 66
ci_068                -2.473560e-03 3 1  ON 67
ci_069                -2.085964e-04 3 1  ON 68
ci_070                 1.328450e-04 3 1  ON 69
ci_071                -1.874230e-03 3 1  ON 70
ci_072                -1.959430e-03 3 1  ON 71
ci_073                 5.749021e-04 3 1  ON 72
ci_074                 2.857507e-04 3 1  ON 73
ci_075                -2.910323e-04 3 1  ON 74
ci_076                -2.990999e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="250">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =8000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 97
    time step          = 0.05
    reference energy   = -22.6945
    reference variance = 0.399779
====================================================
  Execution time = 1.0148e+02
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s097
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 62500 
  VMC Eavg = -2.2669e+01
  VMC Evar = 5.1225e-01
  Total weights = 7.8206e+06
  Execution time = 1.4734e+01
  </log>
</opt>
<opt stage="main" walkers="62500">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.498627820632
                                         uncertainty =       0.002209563460

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.498627820632
                                         uncertainty =       0.002209563460

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000249656289
  error estimate for blocks of size 2^( 2) =       0.000258631592
  error estimate for blocks of size 2^( 3) =       0.000266640666
  error estimate for blocks of size 2^( 4) =       0.000272433586
  error estimate for blocks of size 2^( 5) =       0.000276042788
  error estimate for blocks of size 2^( 6) =       0.000277971352
  error estimate for blocks of size 2^( 7) =       0.000279089311
  error estimate for blocks of size 2^( 8) =       0.000280163372
  error estimate for blocks of size 2^( 9) =       0.000281144328

      target function =                  N/A
              le_mean =     -22.668948563766
             les_mean =     514.393477747304
             stat err =       0.000279592091
             autocorr =       1.254194067120
              std dev =       0.706134619549
             le_variance =       0.498626100925

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.498627820632
                                         uncertainty =       0.002209563460

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.498627820632
                                         uncertainty =       0.002209563460

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000249656289
  error estimate for blocks of size 2^( 2) =       0.000258631592
  error estimate for blocks of size 2^( 3) =       0.000266640666
  error estimate for blocks of size 2^( 4) =       0.000272433586
  error estimate for blocks of size 2^( 5) =       0.000276042788
  error estimate for blocks of size 2^( 6) =       0.000277971352
  error estimate for blocks of size 2^( 7) =       0.000279089311
  error estimate for blocks of size 2^( 8) =       0.000280163372
  error estimate for blocks of size 2^( 9) =       0.000281144328

      target function =                  N/A
              le_mean =     -22.668948563766
             les_mean =     514.393477747304
             stat err =       0.000279592091
             autocorr =       1.254194067120
              std dev =       0.706134619549
             le_variance =       0.498626100925

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.498627820632
                                         uncertainty =       0.002209563460

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.498627820632
                                         uncertainty =       0.002209563460

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000249656289
  error estimate for blocks of size 2^( 2) =       0.000258631592
  error estimate for blocks of size 2^( 3) =       0.000266640666
  error estimate for blocks of size 2^( 4) =       0.000272433586
  error estimate for blocks of size 2^( 5) =       0.000276042788
  error estimate for blocks of size 2^( 6) =       0.000277971352
  error estimate for blocks of size 2^( 7) =       0.000279089311
  error estimate for blocks of size 2^( 8) =       0.000280163372
  error estimate for blocks of size 2^( 9) =       0.000281144328

      target function =                  N/A
              le_mean =     -22.668948563766
             les_mean =     514.393477747304
             stat err =       0.000279592091
             autocorr =       1.254194067120
              std dev =       0.706134619549
             le_variance =       0.498626100925

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.498627820632
                                         uncertainty =       0.002209563460

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.498627820632
                                         uncertainty =       0.002209563460

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000249656289
  error estimate for blocks of size 2^( 2) =       0.000258631592
  error estimate for blocks of size 2^( 3) =       0.000266640666
  error estimate for blocks of size 2^( 4) =       0.000272433586
  error estimate for blocks of size 2^( 5) =       0.000276042788
  error estimate for blocks of size 2^( 6) =       0.000277971352
  error estimate for blocks of size 2^( 7) =       0.000279089311
  error estimate for blocks of size 2^( 8) =       0.000280163372
  error estimate for blocks of size 2^( 9) =       0.000281144328

      target function =                  N/A
              le_mean =     -22.668948563766
             les_mean =     514.393477747304
             stat err =       0.000279592091
             autocorr =       1.254194067120
              std dev =       0.706134619549
             le_variance =       0.498626100925


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.668948563766        initial  <--
     1.3878e+39     1.3878e+40             1.4942e-43       -22.668948563766
     5.5511e+39     5.5511e+40             3.7355e-44       -22.668948563766
     2.2204e+40     2.2204e+41             9.3388e-45       -22.668948563766

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 175.2845
  </log>
  <optVariables href="FORM.s097.opt.xml">
ci_001                -7.050617e-01 3 1  ON 0
ci_002                -7.059926e-01 3 1  ON 1
ci_003                -3.765135e-02 3 1  ON 2
ci_004                -3.890325e-02 3 1  ON 3
ci_005                 1.612441e-02 3 1  ON 4
ci_006                 1.600090e-02 3 1  ON 5
ci_007                 1.228713e-02 3 1  ON 6
ci_008                 1.246533e-02 3 1  ON 7
ci_009                -1.173869e-02 3 1  ON 8
ci_010                -1.182876e-02 3 1  ON 9
ci_011                -8.176403e-03 3 1  ON 10
ci_012                -8.138278e-03 3 1  ON 11
ci_013                 9.647137e-03 3 1  ON 12
ci_014                 9.360580e-03 3 1  ON 13
ci_015                 1.228715e-02 3 1  ON 14
ci_016                 1.255400e-02 3 1  ON 15
ci_017                 1.088300e-02 3 1  ON 16
ci_018                 1.078149e-02 3 1  ON 17
ci_019                -2.514322e-03 3 1  ON 18
ci_020                -2.423765e-03 3 1  ON 19
ci_021                -8.459776e-03 3 1  ON 20
ci_022                -8.657034e-03 3 1  ON 21
ci_023                 7.805043e-03 3 1  ON 22
ci_024                 8.041852e-03 3 1  ON 23
ci_025                 4.702642e-03 3 1  ON 24
ci_026                 4.273172e-03 3 1  ON 25
ci_027                 6.454089e-03 3 1  ON 26
ci_028                 6.476482e-03 3 1  ON 27
ci_029                -4.877820e-03 3 1  ON 28
ci_030                -4.785596e-03 3 1  ON 29
ci_031                -7.388694e-03 3 1  ON 30
ci_032                -8.123179e-03 3 1  ON 31
ci_033                 4.600637e-03 3 1  ON 32
ci_034                 4.413553e-03 3 1  ON 33
ci_035                 1.126907e-03 3 1  ON 34
ci_036                 1.043146e-03 3 1  ON 35
ci_037                 4.953347e-03 3 1  ON 36
ci_038                 5.099310e-03 3 1  ON 37
ci_039                 5.306386e-03 3 1  ON 38
ci_040                 5.323086e-03 3 1  ON 39
ci_041                 4.970499e-03 3 1  ON 40
ci_042                 5.231233e-03 3 1  ON 41
ci_043                 4.943052e-03 3 1  ON 42
ci_044                 4.944182e-03 3 1  ON 43
ci_045                 3.123967e-03 3 1  ON 44
ci_046                 3.174246e-03 3 1  ON 45
ci_047                -7.790222e-04 3 1  ON 46
ci_048                -5.616836e-04 3 1  ON 47
ci_049                 1.580289e-03 3 1  ON 48
ci_050                 1.792516e-03 3 1  ON 49
ci_051                -1.106651e-03 3 1  ON 50
ci_052                -1.243279e-03 3 1  ON 51
ci_053                -2.610471e-03 3 1  ON 52
ci_054                -2.301978e-03 3 1  ON 53
ci_055                -1.483475e-03 3 1  ON 54
ci_056                -1.376714e-03 3 1  ON 55
ci_057                -1.240708e-03 3 1  ON 56
ci_058                -1.731077e-03 3 1  ON 57
ci_059                 3.171692e-04 3 1  ON 58
ci_060                 1.414703e-04 3 1  ON 59
ci_061                -3.305088e-04 3 1  ON 60
ci_062                -9.499769e-06 3 1  ON 61
ci_063                -5.232922e-04 3 1  ON 62
ci_064                -8.918525e-04 3 1  ON 63
ci_065                -2.408143e-03 3 1  ON 64
ci_066                -2.435285e-03 3 1  ON 65
ci_067                -2.101084e-03 3 1  ON 66
ci_068                -2.473560e-03 3 1  ON 67
ci_069                -2.085964e-04 3 1  ON 68
ci_070                 1.328450e-04 3 1  ON 69
ci_071                -1.874230e-03 3 1  ON 70
ci_072                -1.959430e-03 3 1  ON 71
ci_073                 5.749021e-04 3 1  ON 72
ci_074                 2.857507e-04 3 1  ON 73
ci_075                -2.910323e-04 3 1  ON 74
ci_076                -2.990999e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 2.9814e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s098 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s098 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=98  my_counter=0
  time step      = 5.0000e-02
  blocks         = 250
  steps          = 250
  substeps       = 10
  current        = 0
  target samples = 8.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">250</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">6.2500e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">8.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">6.2500e+04</parameter>
<parameter name="steps" condition="int">250</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2663e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="250">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =8000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 98
    time step          = 0.05
    reference energy   = -22.6303
    reference variance = 0.436474
====================================================
  Execution time = 1.0293e+02
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s098
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 62500 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 6.1057e+04
  VMC Eavg = -2.2670e+01
  VMC Evar = 5.1304e-01
  Total weights = 7.819993732e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.9081e+01
  </log>
</opt>
<opt stage="main" walkers="62500">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.499011882336
                                         uncertainty =       0.001594028218

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.499011882336
                                         uncertainty =       0.001594028218

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000249752678
  error estimate for blocks of size 2^( 2) =       0.000258781873
  error estimate for blocks of size 2^( 3) =       0.000266853178
  error estimate for blocks of size 2^( 4) =       0.000272533387
  error estimate for blocks of size 2^( 5) =       0.000275576278
  error estimate for blocks of size 2^( 6) =       0.000276978536
  error estimate for blocks of size 2^( 7) =       0.000278331920
  error estimate for blocks of size 2^( 8) =       0.000278046528
  error estimate for blocks of size 2^( 9) =       0.000277561373

      target function =                  N/A
              le_mean =     -22.669631624710
             les_mean =     514.425234571906
             stat err =       0.000277729589
             autocorr =       1.236585065338
              std dev =       0.706407248041
             le_variance =       0.499011200085


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266963162471e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.3878e+40, overlap shift 1.3878e+41 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.669631624736       residual = 5.34e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.669631624736       residual = 5.34e-05           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 1.3878e+40 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 5.5511e+40, overlap shift 5.5511e+41 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.669631624736       residual = 5.34e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.669631624736       residual = 5.34e-05           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 5.5511e+40 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 2.2204e+41, overlap shift 2.2204e+42 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.669631624736       residual = 5.34e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.669631624736       residual = 5.34e-05           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 2.2204e+41 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.206726 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.2202e+02
  </log>
  <optVariables href="FORM.s098.opt.xml">
ci_001                -7.050617e-01 3 1  ON 0
ci_002                -7.059926e-01 3 1  ON 1
ci_003                -3.765135e-02 3 1  ON 2
ci_004                -3.890325e-02 3 1  ON 3
ci_005                 1.612441e-02 3 1  ON 4
ci_006                 1.600090e-02 3 1  ON 5
ci_007                 1.228713e-02 3 1  ON 6
ci_008                 1.246533e-02 3 1  ON 7
ci_009                -1.173869e-02 3 1  ON 8
ci_010                -1.182876e-02 3 1  ON 9
ci_011                -8.176403e-03 3 1  ON 10
ci_012                -8.138278e-03 3 1  ON 11
ci_013                 9.647137e-03 3 1  ON 12
ci_014                 9.360580e-03 3 1  ON 13
ci_015                 1.228715e-02 3 1  ON 14
ci_016                 1.255400e-02 3 1  ON 15
ci_017                 1.088300e-02 3 1  ON 16
ci_018                 1.078149e-02 3 1  ON 17
ci_019                -2.514322e-03 3 1  ON 18
ci_020                -2.423765e-03 3 1  ON 19
ci_021                -8.459776e-03 3 1  ON 20
ci_022                -8.657034e-03 3 1  ON 21
ci_023                 7.805043e-03 3 1  ON 22
ci_024                 8.041852e-03 3 1  ON 23
ci_025                 4.702642e-03 3 1  ON 24
ci_026                 4.273172e-03 3 1  ON 25
ci_027                 6.454089e-03 3 1  ON 26
ci_028                 6.476482e-03 3 1  ON 27
ci_029                -4.877820e-03 3 1  ON 28
ci_030                -4.785596e-03 3 1  ON 29
ci_031                -7.388694e-03 3 1  ON 30
ci_032                -8.123179e-03 3 1  ON 31
ci_033                 4.600637e-03 3 1  ON 32
ci_034                 4.413553e-03 3 1  ON 33
ci_035                 1.126907e-03 3 1  ON 34
ci_036                 1.043146e-03 3 1  ON 35
ci_037                 4.953347e-03 3 1  ON 36
ci_038                 5.099310e-03 3 1  ON 37
ci_039                 5.306386e-03 3 1  ON 38
ci_040                 5.323086e-03 3 1  ON 39
ci_041                 4.970499e-03 3 1  ON 40
ci_042                 5.231233e-03 3 1  ON 41
ci_043                 4.943052e-03 3 1  ON 42
ci_044                 4.944182e-03 3 1  ON 43
ci_045                 3.123967e-03 3 1  ON 44
ci_046                 3.174246e-03 3 1  ON 45
ci_047                -7.790222e-04 3 1  ON 46
ci_048                -5.616836e-04 3 1  ON 47
ci_049                 1.580289e-03 3 1  ON 48
ci_050                 1.792516e-03 3 1  ON 49
ci_051                -1.106651e-03 3 1  ON 50
ci_052                -1.243279e-03 3 1  ON 51
ci_053                -2.610471e-03 3 1  ON 52
ci_054                -2.301978e-03 3 1  ON 53
ci_055                -1.483475e-03 3 1  ON 54
ci_056                -1.376714e-03 3 1  ON 55
ci_057                -1.240708e-03 3 1  ON 56
ci_058                -1.731077e-03 3 1  ON 57
ci_059                 3.171692e-04 3 1  ON 58
ci_060                 1.414703e-04 3 1  ON 59
ci_061                -3.305088e-04 3 1  ON 60
ci_062                -9.499769e-06 3 1  ON 61
ci_063                -5.232922e-04 3 1  ON 62
ci_064                -8.918525e-04 3 1  ON 63
ci_065                -2.408143e-03 3 1  ON 64
ci_066                -2.435285e-03 3 1  ON 65
ci_067                -2.101084e-03 3 1  ON 66
ci_068                -2.473560e-03 3 1  ON 67
ci_069                -2.085964e-04 3 1  ON 68
ci_070                 1.328450e-04 3 1  ON 69
ci_071                -1.874230e-03 3 1  ON 70
ci_072                -1.959430e-03 3 1  ON 71
ci_073                 5.749021e-04 3 1  ON 72
ci_074                 2.857507e-04 3 1  ON 73
ci_075                -2.910323e-04 3 1  ON 74
ci_076                -2.990999e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="250">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =8000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 98
    time step          = 0.05
    reference energy   = -22.7057
    reference variance = 0.434718
====================================================
  Execution time = 1.0058e+02
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s098
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 62500 
  VMC Eavg = -2.2670e+01
  VMC Evar = 5.0961e-01
  Total weights = 7.8207e+06
  Execution time = 1.4691e+01
  </log>
</opt>
<opt stage="main" walkers="62500">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.495867052557
                                         uncertainty =       0.001237671899

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.495867052557
                                         uncertainty =       0.001237671899

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000248964907
  error estimate for blocks of size 2^( 2) =       0.000257998711
  error estimate for blocks of size 2^( 3) =       0.000266045938
  error estimate for blocks of size 2^( 4) =       0.000272031523
  error estimate for blocks of size 2^( 5) =       0.000275619145
  error estimate for blocks of size 2^( 6) =       0.000277805476
  error estimate for blocks of size 2^( 7) =       0.000279316783
  error estimate for blocks of size 2^( 8) =       0.000280033284
  error estimate for blocks of size 2^( 9) =       0.000281039282

      target function =                  N/A
              le_mean =     -22.669768947760
             les_mean =     514.428037930701
             stat err =       0.000279548706
             autocorr =       1.260778232258
              std dev =       0.704179096635
             le_variance =       0.495868200137

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.495867052557
                                         uncertainty =       0.001237671899

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.495867052557
                                         uncertainty =       0.001237671899

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000248964907
  error estimate for blocks of size 2^( 2) =       0.000257998711
  error estimate for blocks of size 2^( 3) =       0.000266045938
  error estimate for blocks of size 2^( 4) =       0.000272031523
  error estimate for blocks of size 2^( 5) =       0.000275619145
  error estimate for blocks of size 2^( 6) =       0.000277805476
  error estimate for blocks of size 2^( 7) =       0.000279316783
  error estimate for blocks of size 2^( 8) =       0.000280033284
  error estimate for blocks of size 2^( 9) =       0.000281039282

      target function =                  N/A
              le_mean =     -22.669768947760
             les_mean =     514.428037930701
             stat err =       0.000279548706
             autocorr =       1.260778232258
              std dev =       0.704179096635
             le_variance =       0.495868200137

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.495867052557
                                         uncertainty =       0.001237671899

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.495867052557
                                         uncertainty =       0.001237671899

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000248964907
  error estimate for blocks of size 2^( 2) =       0.000257998711
  error estimate for blocks of size 2^( 3) =       0.000266045938
  error estimate for blocks of size 2^( 4) =       0.000272031523
  error estimate for blocks of size 2^( 5) =       0.000275619145
  error estimate for blocks of size 2^( 6) =       0.000277805476
  error estimate for blocks of size 2^( 7) =       0.000279316783
  error estimate for blocks of size 2^( 8) =       0.000280033284
  error estimate for blocks of size 2^( 9) =       0.000281039282

      target function =                  N/A
              le_mean =     -22.669768947760
             les_mean =     514.428037930701
             stat err =       0.000279548706
             autocorr =       1.260778232258
              std dev =       0.704179096635
             le_variance =       0.495868200137

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.495867052557
                                         uncertainty =       0.001237671899

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.495867052557
                                         uncertainty =       0.001237671899

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000248964907
  error estimate for blocks of size 2^( 2) =       0.000257998711
  error estimate for blocks of size 2^( 3) =       0.000266045938
  error estimate for blocks of size 2^( 4) =       0.000272031523
  error estimate for blocks of size 2^( 5) =       0.000275619145
  error estimate for blocks of size 2^( 6) =       0.000277805476
  error estimate for blocks of size 2^( 7) =       0.000279316783
  error estimate for blocks of size 2^( 8) =       0.000280033284
  error estimate for blocks of size 2^( 9) =       0.000281039282

      target function =                  N/A
              le_mean =     -22.669768947760
             les_mean =     514.428037930701
             stat err =       0.000279548706
             autocorr =       1.260778232258
              std dev =       0.704179096635
             le_variance =       0.495868200137


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.669768947760        initial  <--
     1.3878e+40     1.3878e+41             0.0000e+00       -22.669768947760
     5.5511e+40     5.5511e+41             0.0000e+00       -22.669768947760
     2.2204e+41     2.2204e+42             0.0000e+00       -22.669768947760

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 174.0623
  </log>
  <optVariables href="FORM.s098.opt.xml">
ci_001                -7.050617e-01 3 1  ON 0
ci_002                -7.059926e-01 3 1  ON 1
ci_003                -3.765135e-02 3 1  ON 2
ci_004                -3.890325e-02 3 1  ON 3
ci_005                 1.612441e-02 3 1  ON 4
ci_006                 1.600090e-02 3 1  ON 5
ci_007                 1.228713e-02 3 1  ON 6
ci_008                 1.246533e-02 3 1  ON 7
ci_009                -1.173869e-02 3 1  ON 8
ci_010                -1.182876e-02 3 1  ON 9
ci_011                -8.176403e-03 3 1  ON 10
ci_012                -8.138278e-03 3 1  ON 11
ci_013                 9.647137e-03 3 1  ON 12
ci_014                 9.360580e-03 3 1  ON 13
ci_015                 1.228715e-02 3 1  ON 14
ci_016                 1.255400e-02 3 1  ON 15
ci_017                 1.088300e-02 3 1  ON 16
ci_018                 1.078149e-02 3 1  ON 17
ci_019                -2.514322e-03 3 1  ON 18
ci_020                -2.423765e-03 3 1  ON 19
ci_021                -8.459776e-03 3 1  ON 20
ci_022                -8.657034e-03 3 1  ON 21
ci_023                 7.805043e-03 3 1  ON 22
ci_024                 8.041852e-03 3 1  ON 23
ci_025                 4.702642e-03 3 1  ON 24
ci_026                 4.273172e-03 3 1  ON 25
ci_027                 6.454089e-03 3 1  ON 26
ci_028                 6.476482e-03 3 1  ON 27
ci_029                -4.877820e-03 3 1  ON 28
ci_030                -4.785596e-03 3 1  ON 29
ci_031                -7.388694e-03 3 1  ON 30
ci_032                -8.123179e-03 3 1  ON 31
ci_033                 4.600637e-03 3 1  ON 32
ci_034                 4.413553e-03 3 1  ON 33
ci_035                 1.126907e-03 3 1  ON 34
ci_036                 1.043146e-03 3 1  ON 35
ci_037                 4.953347e-03 3 1  ON 36
ci_038                 5.099310e-03 3 1  ON 37
ci_039                 5.306386e-03 3 1  ON 38
ci_040                 5.323086e-03 3 1  ON 39
ci_041                 4.970499e-03 3 1  ON 40
ci_042                 5.231233e-03 3 1  ON 41
ci_043                 4.943052e-03 3 1  ON 42
ci_044                 4.944182e-03 3 1  ON 43
ci_045                 3.123967e-03 3 1  ON 44
ci_046                 3.174246e-03 3 1  ON 45
ci_047                -7.790222e-04 3 1  ON 46
ci_048                -5.616836e-04 3 1  ON 47
ci_049                 1.580289e-03 3 1  ON 48
ci_050                 1.792516e-03 3 1  ON 49
ci_051                -1.106651e-03 3 1  ON 50
ci_052                -1.243279e-03 3 1  ON 51
ci_053                -2.610471e-03 3 1  ON 52
ci_054                -2.301978e-03 3 1  ON 53
ci_055                -1.483475e-03 3 1  ON 54
ci_056                -1.376714e-03 3 1  ON 55
ci_057                -1.240708e-03 3 1  ON 56
ci_058                -1.731077e-03 3 1  ON 57
ci_059                 3.171692e-04 3 1  ON 58
ci_060                 1.414703e-04 3 1  ON 59
ci_061                -3.305088e-04 3 1  ON 60
ci_062                -9.499769e-06 3 1  ON 61
ci_063                -5.232922e-04 3 1  ON 62
ci_064                -8.918525e-04 3 1  ON 63
ci_065                -2.408143e-03 3 1  ON 64
ci_066                -2.435285e-03 3 1  ON 65
ci_067                -2.101084e-03 3 1  ON 66
ci_068                -2.473560e-03 3 1  ON 67
ci_069                -2.085964e-04 3 1  ON 68
ci_070                 1.328450e-04 3 1  ON 69
ci_071                -1.874230e-03 3 1  ON 70
ci_072                -1.959430e-03 3 1  ON 71
ci_073                 5.749021e-04 3 1  ON 72
ci_074                 2.857507e-04 3 1  ON 73
ci_075                -2.910323e-04 3 1  ON 74
ci_076                -2.990999e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 2.9609e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s099 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s099 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=99  my_counter=0
  time step      = 5.0000e-02
  blocks         = 250
  steps          = 250
  substeps       = 10
  current        = 0
  target samples = 8.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">250</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">6.2500e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">8.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">6.2500e+04</parameter>
<parameter name="steps" condition="int">250</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2663e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="250">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =8000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 99
    time step          = 0.05
    reference energy   = -22.5338
    reference variance = 0.440639
====================================================
  Execution time = 1.0282e+02
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s099
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 62500 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 6.1082e+04
  VMC Eavg = -2.2670e+01
  VMC Evar = 5.0990e-01
  Total weights = 7.820827864e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.8875e+01
  </log>
</opt>
<opt stage="main" walkers="62500">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.497986500526
                                         uncertainty =       0.001555080796

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.497986500526
                                         uncertainty =       0.001555080796

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000249496553
  error estimate for blocks of size 2^( 2) =       0.000258473803
  error estimate for blocks of size 2^( 3) =       0.000266497953
  error estimate for blocks of size 2^( 4) =       0.000272120104
  error estimate for blocks of size 2^( 5) =       0.000275520358
  error estimate for blocks of size 2^( 6) =       0.000277200737
  error estimate for blocks of size 2^( 7) =       0.000277897674
  error estimate for blocks of size 2^( 8) =       0.000278419073
  error estimate for blocks of size 2^( 9) =       0.000279094884

      target function =                  N/A
              le_mean =     -22.669927394067
             les_mean =     514.435504357511
             stat err =       0.000278153092
             autocorr =       1.242907147963
              std dev =       0.705682816814
             le_variance =       0.497988237946


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266992739407e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.3878e+41, overlap shift 1.3878e+42 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.669927394093       residual = 3.24e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.669927394093       residual = 3.24e-05           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 1.3878e+41 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 5.5511e+41, overlap shift 5.5511e+42 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.669927394093       residual = 3.24e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.669927394093       residual = 3.24e-05           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 5.5511e+41 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 2.2204e+42, overlap shift 2.2204e+43 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.669927394093       residual = 3.24e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.669927394093       residual = 3.24e-05           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 2.2204e+42 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.207888 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.2170e+02
  </log>
  <optVariables href="FORM.s099.opt.xml">
ci_001                -7.050617e-01 3 1  ON 0
ci_002                -7.059926e-01 3 1  ON 1
ci_003                -3.765135e-02 3 1  ON 2
ci_004                -3.890325e-02 3 1  ON 3
ci_005                 1.612441e-02 3 1  ON 4
ci_006                 1.600090e-02 3 1  ON 5
ci_007                 1.228713e-02 3 1  ON 6
ci_008                 1.246533e-02 3 1  ON 7
ci_009                -1.173869e-02 3 1  ON 8
ci_010                -1.182876e-02 3 1  ON 9
ci_011                -8.176403e-03 3 1  ON 10
ci_012                -8.138278e-03 3 1  ON 11
ci_013                 9.647137e-03 3 1  ON 12
ci_014                 9.360580e-03 3 1  ON 13
ci_015                 1.228715e-02 3 1  ON 14
ci_016                 1.255400e-02 3 1  ON 15
ci_017                 1.088300e-02 3 1  ON 16
ci_018                 1.078149e-02 3 1  ON 17
ci_019                -2.514322e-03 3 1  ON 18
ci_020                -2.423765e-03 3 1  ON 19
ci_021                -8.459776e-03 3 1  ON 20
ci_022                -8.657034e-03 3 1  ON 21
ci_023                 7.805043e-03 3 1  ON 22
ci_024                 8.041852e-03 3 1  ON 23
ci_025                 4.702642e-03 3 1  ON 24
ci_026                 4.273172e-03 3 1  ON 25
ci_027                 6.454089e-03 3 1  ON 26
ci_028                 6.476482e-03 3 1  ON 27
ci_029                -4.877820e-03 3 1  ON 28
ci_030                -4.785596e-03 3 1  ON 29
ci_031                -7.388694e-03 3 1  ON 30
ci_032                -8.123179e-03 3 1  ON 31
ci_033                 4.600637e-03 3 1  ON 32
ci_034                 4.413553e-03 3 1  ON 33
ci_035                 1.126907e-03 3 1  ON 34
ci_036                 1.043146e-03 3 1  ON 35
ci_037                 4.953347e-03 3 1  ON 36
ci_038                 5.099310e-03 3 1  ON 37
ci_039                 5.306386e-03 3 1  ON 38
ci_040                 5.323086e-03 3 1  ON 39
ci_041                 4.970499e-03 3 1  ON 40
ci_042                 5.231233e-03 3 1  ON 41
ci_043                 4.943052e-03 3 1  ON 42
ci_044                 4.944182e-03 3 1  ON 43
ci_045                 3.123967e-03 3 1  ON 44
ci_046                 3.174246e-03 3 1  ON 45
ci_047                -7.790222e-04 3 1  ON 46
ci_048                -5.616836e-04 3 1  ON 47
ci_049                 1.580289e-03 3 1  ON 48
ci_050                 1.792516e-03 3 1  ON 49
ci_051                -1.106651e-03 3 1  ON 50
ci_052                -1.243279e-03 3 1  ON 51
ci_053                -2.610471e-03 3 1  ON 52
ci_054                -2.301978e-03 3 1  ON 53
ci_055                -1.483475e-03 3 1  ON 54
ci_056                -1.376714e-03 3 1  ON 55
ci_057                -1.240708e-03 3 1  ON 56
ci_058                -1.731077e-03 3 1  ON 57
ci_059                 3.171692e-04 3 1  ON 58
ci_060                 1.414703e-04 3 1  ON 59
ci_061                -3.305088e-04 3 1  ON 60
ci_062                -9.499769e-06 3 1  ON 61
ci_063                -5.232922e-04 3 1  ON 62
ci_064                -8.918525e-04 3 1  ON 63
ci_065                -2.408143e-03 3 1  ON 64
ci_066                -2.435285e-03 3 1  ON 65
ci_067                -2.101084e-03 3 1  ON 66
ci_068                -2.473560e-03 3 1  ON 67
ci_069                -2.085964e-04 3 1  ON 68
ci_070                 1.328450e-04 3 1  ON 69
ci_071                -1.874230e-03 3 1  ON 70
ci_072                -1.959430e-03 3 1  ON 71
ci_073                 5.749021e-04 3 1  ON 72
ci_074                 2.857507e-04 3 1  ON 73
ci_075                -2.910323e-04 3 1  ON 74
ci_076                -2.990999e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="250">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =8000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 99
    time step          = 0.05
    reference energy   = -22.7006
    reference variance = 0.328
====================================================
  Execution time = 1.0033e+02
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s099
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 62500 
  VMC Eavg = -2.2670e+01
  VMC Evar = 5.1009e-01
  Total weights = 7.8204e+06
  Execution time = 1.4667e+01
  </log>
</opt>
<opt stage="main" walkers="62500">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.496886911963
                                         uncertainty =       0.001470569551

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.496886911963
                                         uncertainty =       0.001470569551

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000249220526
  error estimate for blocks of size 2^( 2) =       0.000258146980
  error estimate for blocks of size 2^( 3) =       0.000266152344
  error estimate for blocks of size 2^( 4) =       0.000271922926
  error estimate for blocks of size 2^( 5) =       0.000275188230
  error estimate for blocks of size 2^( 6) =       0.000276990408
  error estimate for blocks of size 2^( 7) =       0.000278567100
  error estimate for blocks of size 2^( 8) =       0.000278608259
  error estimate for blocks of size 2^( 9) =       0.000278548355

      target function =                  N/A
              le_mean =     -22.669772219076
             les_mean =     514.428662538427
             stat err =       0.000278178530
             autocorr =       1.245889714486
              std dev =       0.704902095784
             le_variance =       0.496886964641

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.496886911963
                                         uncertainty =       0.001470569551

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.496886911963
                                         uncertainty =       0.001470569551

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000249220526
  error estimate for blocks of size 2^( 2) =       0.000258146980
  error estimate for blocks of size 2^( 3) =       0.000266152344
  error estimate for blocks of size 2^( 4) =       0.000271922926
  error estimate for blocks of size 2^( 5) =       0.000275188230
  error estimate for blocks of size 2^( 6) =       0.000276990408
  error estimate for blocks of size 2^( 7) =       0.000278567100
  error estimate for blocks of size 2^( 8) =       0.000278608259
  error estimate for blocks of size 2^( 9) =       0.000278548355

      target function =                  N/A
              le_mean =     -22.669772219076
             les_mean =     514.428662538427
             stat err =       0.000278178530
             autocorr =       1.245889714486
              std dev =       0.704902095784
             le_variance =       0.496886964641

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.496886911963
                                         uncertainty =       0.001470569551

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.496886911963
                                         uncertainty =       0.001470569551

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000249220526
  error estimate for blocks of size 2^( 2) =       0.000258146980
  error estimate for blocks of size 2^( 3) =       0.000266152344
  error estimate for blocks of size 2^( 4) =       0.000271922926
  error estimate for blocks of size 2^( 5) =       0.000275188230
  error estimate for blocks of size 2^( 6) =       0.000276990408
  error estimate for blocks of size 2^( 7) =       0.000278567100
  error estimate for blocks of size 2^( 8) =       0.000278608259
  error estimate for blocks of size 2^( 9) =       0.000278548355

      target function =                  N/A
              le_mean =     -22.669772219076
             les_mean =     514.428662538427
             stat err =       0.000278178530
             autocorr =       1.245889714486
              std dev =       0.704902095784
             le_variance =       0.496886964641

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.496886911963
                                         uncertainty =       0.001470569551

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.496886911963
                                         uncertainty =       0.001470569551

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000249220526
  error estimate for blocks of size 2^( 2) =       0.000258146980
  error estimate for blocks of size 2^( 3) =       0.000266152344
  error estimate for blocks of size 2^( 4) =       0.000271922926
  error estimate for blocks of size 2^( 5) =       0.000275188230
  error estimate for blocks of size 2^( 6) =       0.000276990408
  error estimate for blocks of size 2^( 7) =       0.000278567100
  error estimate for blocks of size 2^( 8) =       0.000278608259
  error estimate for blocks of size 2^( 9) =       0.000278548355

      target function =                  N/A
              le_mean =     -22.669772219076
             les_mean =     514.428662538427
             stat err =       0.000278178530
             autocorr =       1.245889714486
              std dev =       0.704902095784
             le_variance =       0.496886964641


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.669772219076        initial  <--
     1.3878e+41     1.3878e+42             0.0000e+00       -22.669772219076
     5.5511e+41     5.5511e+42             0.0000e+00       -22.669772219076
     2.2204e+42     2.2204e+43             0.0000e+00       -22.669772219076

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 173.6206
  </log>
  <optVariables href="FORM.s099.opt.xml">
ci_001                -7.050617e-01 3 1  ON 0
ci_002                -7.059926e-01 3 1  ON 1
ci_003                -3.765135e-02 3 1  ON 2
ci_004                -3.890325e-02 3 1  ON 3
ci_005                 1.612441e-02 3 1  ON 4
ci_006                 1.600090e-02 3 1  ON 5
ci_007                 1.228713e-02 3 1  ON 6
ci_008                 1.246533e-02 3 1  ON 7
ci_009                -1.173869e-02 3 1  ON 8
ci_010                -1.182876e-02 3 1  ON 9
ci_011                -8.176403e-03 3 1  ON 10
ci_012                -8.138278e-03 3 1  ON 11
ci_013                 9.647137e-03 3 1  ON 12
ci_014                 9.360580e-03 3 1  ON 13
ci_015                 1.228715e-02 3 1  ON 14
ci_016                 1.255400e-02 3 1  ON 15
ci_017                 1.088300e-02 3 1  ON 16
ci_018                 1.078149e-02 3 1  ON 17
ci_019                -2.514322e-03 3 1  ON 18
ci_020                -2.423765e-03 3 1  ON 19
ci_021                -8.459776e-03 3 1  ON 20
ci_022                -8.657034e-03 3 1  ON 21
ci_023                 7.805043e-03 3 1  ON 22
ci_024                 8.041852e-03 3 1  ON 23
ci_025                 4.702642e-03 3 1  ON 24
ci_026                 4.273172e-03 3 1  ON 25
ci_027                 6.454089e-03 3 1  ON 26
ci_028                 6.476482e-03 3 1  ON 27
ci_029                -4.877820e-03 3 1  ON 28
ci_030                -4.785596e-03 3 1  ON 29
ci_031                -7.388694e-03 3 1  ON 30
ci_032                -8.123179e-03 3 1  ON 31
ci_033                 4.600637e-03 3 1  ON 32
ci_034                 4.413553e-03 3 1  ON 33
ci_035                 1.126907e-03 3 1  ON 34
ci_036                 1.043146e-03 3 1  ON 35
ci_037                 4.953347e-03 3 1  ON 36
ci_038                 5.099310e-03 3 1  ON 37
ci_039                 5.306386e-03 3 1  ON 38
ci_040                 5.323086e-03 3 1  ON 39
ci_041                 4.970499e-03 3 1  ON 40
ci_042                 5.231233e-03 3 1  ON 41
ci_043                 4.943052e-03 3 1  ON 42
ci_044                 4.944182e-03 3 1  ON 43
ci_045                 3.123967e-03 3 1  ON 44
ci_046                 3.174246e-03 3 1  ON 45
ci_047                -7.790222e-04 3 1  ON 46
ci_048                -5.616836e-04 3 1  ON 47
ci_049                 1.580289e-03 3 1  ON 48
ci_050                 1.792516e-03 3 1  ON 49
ci_051                -1.106651e-03 3 1  ON 50
ci_052                -1.243279e-03 3 1  ON 51
ci_053                -2.610471e-03 3 1  ON 52
ci_054                -2.301978e-03 3 1  ON 53
ci_055                -1.483475e-03 3 1  ON 54
ci_056                -1.376714e-03 3 1  ON 55
ci_057                -1.240708e-03 3 1  ON 56
ci_058                -1.731077e-03 3 1  ON 57
ci_059                 3.171692e-04 3 1  ON 58
ci_060                 1.414703e-04 3 1  ON 59
ci_061                -3.305088e-04 3 1  ON 60
ci_062                -9.499769e-06 3 1  ON 61
ci_063                -5.232922e-04 3 1  ON 62
ci_064                -8.918525e-04 3 1  ON 63
ci_065                -2.408143e-03 3 1  ON 64
ci_066                -2.435285e-03 3 1  ON 65
ci_067                -2.101084e-03 3 1  ON 66
ci_068                -2.473560e-03 3 1  ON 67
ci_069                -2.085964e-04 3 1  ON 68
ci_070                 1.328450e-04 3 1  ON 69
ci_071                -1.874230e-03 3 1  ON 70
ci_072                -1.959430e-03 3 1  ON 71
ci_073                 5.749021e-04 3 1  ON 72
ci_074                 2.857507e-04 3 1  ON 73
ci_075                -2.910323e-04 3 1  ON 74
ci_076                -2.990999e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 2.9534e+02 secs
  Total Execution time = 2.9654e+04 secs

=========================================================
  A new xml input file : FORM.s099.cont.xml
