Rank =    0  Free Memory = 87626 MB
Rank =    1  Free Memory = 87625 MB
Rank =    2  Free Memory = 87625 MB
Rank =    3  Free Memory = 87625 MB
Rank =    4  Free Memory = 87625 MB
Rank =    5  Free Memory = 87625 MB
Rank =    6  Free Memory = 87625 MB
Rank =    7  Free Memory = 87625 MB
Rank =    8  Free Memory = 87625 MB
Rank =    9  Free Memory = 87625 MB
Rank =   10  Free Memory = 87624 MB
Rank =   11  Free Memory = 87624 MB
Rank =   12  Free Memory = 87624 MB
Rank =   13  Free Memory = 87624 MB
Rank =   14  Free Memory = 87623 MB
Rank =   15  Free Memory = 87611 MB
Rank =   16  Free Memory = 87606 MB
Rank =   17  Free Memory = 87606 MB
Rank =   18  Free Memory = 87606 MB
Rank =   19  Free Memory = 87606 MB
Rank =   20  Free Memory = 87606 MB
Rank =   21  Free Memory = 87606 MB
Rank =   22  Free Memory = 87606 MB
Rank =   23  Free Memory = 87606 MB
Rank =   24  Free Memory = 87606 MB
Rank =   25  Free Memory = 87606 MB
Rank =   26  Free Memory = 87606 MB
Rank =   27  Free Memory = 87606 MB
Rank =   28  Free Memory = 87606 MB
Rank =   29  Free Memory = 87606 MB
Rank =   30  Free Memory = 87606 MB
Rank =   31  Free Memory = 87606 MB
Rank =   32  Free Memory = 85379 MB
Rank =   33  Free Memory = 85379 MB
Rank =   34  Free Memory = 85379 MB
Rank =   35  Free Memory = 85379 MB
Rank =   36  Free Memory = 85379 MB
Rank =   37  Free Memory = 85379 MB
Rank =   38  Free Memory = 85379 MB
Rank =   39  Free Memory = 85379 MB
Rank =   40  Free Memory = 85379 MB
Rank =   41  Free Memory = 85379 MB
Rank =   42  Free Memory = 85379 MB
Rank =   43  Free Memory = 85379 MB
Rank =   44  Free Memory = 85379 MB
Rank =   45  Free Memory = 85379 MB
Rank =   46  Free Memory = 85379 MB
Rank =   47  Free Memory = 85379 MB
Rank =   48  Free Memory = 85379 MB
Rank =   49  Free Memory = 85379 MB
Rank =   50  Free Memory = 85379 MB
Rank =   51  Free Memory = 85379 MB
Rank =   52  Free Memory = 85379 MB
Rank =   53  Free Memory = 85379 MB
Rank =   54  Free Memory = 85379 MB
Rank =   55  Free Memory = 85379 MB
Rank =   56  Free Memory = 85379 MB
Rank =   57  Free Memory = 85379 MB
Rank =   58  Free Memory = 85379 MB
Rank =   59  Free Memory = 85379 MB
Rank =   60  Free Memory = 85379 MB
Rank =   61  Free Memory = 85379 MB
Rank =   62  Free Memory = 85379 MB
Rank =   63  Free Memory = 85379 MB
Rank =   64  Free Memory = 89553 MB
Rank =   65  Free Memory = 89553 MB
Rank =   66  Free Memory = 89553 MB
Rank =   67  Free Memory = 89553 MB
Rank =   68  Free Memory = 89553 MB
Rank =   69  Free Memory = 89553 MB
Rank =   70  Free Memory = 89553 MB
Rank =   71  Free Memory = 89553 MB
Rank =   72  Free Memory = 89553 MB
Rank =   73  Free Memory = 89553 MB
Rank =   74  Free Memory = 89553 MB
Rank =   75  Free Memory = 89553 MB
Rank =   76  Free Memory = 89553 MB
Rank =   77  Free Memory = 89553 MB
Rank =   78  Free Memory = 89553 MB
Rank =   79  Free Memory = 89553 MB
Rank =   80  Free Memory = 89553 MB
Rank =   81  Free Memory = 89553 MB
Rank =   82  Free Memory = 89552 MB
Rank =   83  Free Memory = 89552 MB
Rank =   84  Free Memory = 89552 MB
Rank =   85  Free Memory = 89552 MB
Rank =   86  Free Memory = 89552 MB
Rank =   87  Free Memory = 89552 MB
Rank =   88  Free Memory = 89552 MB
Rank =   89  Free Memory = 89552 MB
Rank =   90  Free Memory = 89552 MB
Rank =   91  Free Memory = 89552 MB
Rank =   92  Free Memory = 89552 MB
Rank =   93  Free Memory = 89552 MB
Rank =   94  Free Memory = 89552 MB
Rank =   95  Free Memory = 89552 MB
Rank =   96  Free Memory = 89246 MB
Rank =   97  Free Memory = 89246 MB
Rank =   98  Free Memory = 89246 MB
Rank =   99  Free Memory = 89246 MB
Rank =  100  Free Memory = 89246 MB
Rank =  101  Free Memory = 89246 MB
Rank =  102  Free Memory = 89246 MB
Rank =  103  Free Memory = 89246 MB
Rank =  104  Free Memory = 89246 MB
Rank =  105  Free Memory = 89246 MB
Rank =  106  Free Memory = 89246 MB
Rank =  107  Free Memory = 89246 MB
Rank =  108  Free Memory = 89246 MB
Rank =  109  Free Memory = 89246 MB
Rank =  110  Free Memory = 89246 MB
Rank =  111  Free Memory = 89246 MB
Rank =  112  Free Memory = 89246 MB
Rank =  113  Free Memory = 89245 MB
Rank =  114  Free Memory = 89245 MB
Rank =  115  Free Memory = 89245 MB
Rank =  116  Free Memory = 89245 MB
Rank =  117  Free Memory = 89245 MB
Rank =  118  Free Memory = 89245 MB
Rank =  119  Free Memory = 89245 MB
Rank =  120  Free Memory = 89245 MB
Rank =  121  Free Memory = 89245 MB
Rank =  122  Free Memory = 89245 MB
Rank =  123  Free Memory = 89245 MB
Rank =  124  Free Memory = 89245 MB
Rank =  125  Free Memory = 89245 MB
Rank =  126  Free Memory = 89245 MB
Rank =  127  Free Memory = 89245 MB
  Input file(s): opt_form_n2pistar_lmtt_run002e.xml 

=====================================================
                    QMCPACK 3.7.9

       (c) Copyright 2003-  QMCPACK developers

                    Please cite:
 J. Kim et al. J. Phys. Cond. Mat. 30 195901 (2018)
      https://doi.org/10.1088/1361-648X/aab9c3

  Git branch: gvp
  Last git commit: 39b7557df04c29964085ccccce933740e3918067-dirty
  Last git commit date: Wed Mar 22 11:37:25 2023 -0700
  Last git commit subject: deleting more debugging statements
=====================================================
  Global options 

  Total number of MPI ranks = 128
  Number of MPI groups      = 1
  MPI group ID              = 0
  Number of ranks in group  = 128
  MPI ranks per node        = 32
  OMP 1st level threads     = 1
  OMP nested threading disabled or only 1 thread on the 2nd level

  Precision used in this calculation, see definitions in the manual:
  Base precision      = double
  Full precision      = double

  Structure-of-arrays (SoA) optimization enabled

  Input XML = opt_form_n2pistar_lmtt_run002e.xml

  Project = FORM
  date    = 2023-03-24 18:32:37 PDT
  host    = n0023.savio3

 Random Number
 -------------
  Offset for the random number seeds based on time: 821

  Range of prime numbers to use as seeds over processors and threads = 6323-7507


 Particle Set 
 ------------
  Name: e
  All the species have the same mass 1
  Particle set size: 12

 Particle Set 
 ------------
  Name: ion0
  All the species have the same mass 1
  Particle set size: 4

 Wavefunction setup: 
 ------------------- 
  Name: psi0

   Jastrow
   -------
    Name: J2   Type: Two-Body   Function: Bspline

    Radial function for species: u - u
     Number of parameters: 10
     Cusp: -0.25
     Cutoff radius: 10

     Name                        Value Type Recompute Use Index
     ---- ---------------------------- ---- --------- --- -----
     uu_0                 2.987528e-01    1         1 OFF
     uu_1                 1.228843e-01    1         1 OFF
     uu_2                 9.162466e-03    1         1 OFF
     uu_3                -5.850007e-02    1         1 OFF
     uu_4                -9.930241e-02    1         1 OFF
     uu_5                -1.256302e-01    1         1 OFF
     uu_6                -1.416527e-01    1         1 OFF
     uu_7                -1.468120e-01    1         1 OFF
     uu_8                -1.383972e-01    1         1 OFF
     uu_9                -1.162185e-01    1         1 OFF

    Radial function for species: u - d
     Number of parameters: 10
     Cusp: -5.000000e-01
     Cutoff radius: 1.000000e+01

     Name                        Value Type Recompute Use Index
     ---- ---------------------------- ---- --------- --- -----
     ud_0                 4.160748e-01    1         1 OFF
     ud_1                 1.333333e-01    1         1 OFF
     ud_2                -1.335968e-02    1         1 OFF
     ud_3                -9.162004e-02    1         1 OFF
     ud_4                -1.347674e-01    1         1 OFF
     ud_5                -1.603184e-01    1         1 OFF
     ud_6                -1.736469e-01    1         1 OFF
     ud_7                -1.761067e-01    1         1 OFF
     ud_8                -1.645538e-01    1         1 OFF
     ud_9                -1.361222e-01    1         1 OFF


   Jastrow
   -------
    Name: J1   Type: One-Body   Function: Bspline

    Radial function for element: C
     Number of parameters: 10
     Cusp: 0.000000e+00
     Cutoff radius: 1.000000e+01

     Name                        Value Type Recompute Use Index
     ---- ---------------------------- ---- --------- --- -----
     eC_0                -5.884834e-01    1         1 OFF
     eC_1                -4.358060e-01    1         1 OFF
     eC_2                -1.835537e-01    1         1 OFF
     eC_3                -2.787247e-02    1         1 OFF
     eC_4                 5.620602e-02    1         1 OFF
     eC_5                 1.628868e-01    1         1 OFF
     eC_6                 2.602808e-01    1         1 OFF
     eC_7                 3.717430e-01    1         1 OFF
     eC_8                 2.906908e-01    1         1 OFF
     eC_9                 8.634084e-02    1         1 OFF

    Radial function for element: O
     Number of parameters: 10
     Cusp: 0.000000e+00
     Cutoff radius: 1.000000e+01

     Name                        Value Type Recompute Use Index
     ---- ---------------------------- ---- --------- --- -----
     eO_0                -1.190778e+00    1         1 OFF
     eO_1                -8.128782e-01    1         1 OFF
     eO_2                -3.472197e-01    1         1 OFF
     eO_3                -4.170047e-03    1         1 OFF
     eO_4                 2.228530e-01    1         1 OFF
     eO_5                 3.903355e-01    1         1 OFF
     eO_6                 4.363431e-01    1         1 OFF
     eO_7                 4.382007e-01    1         1 OFF
     eO_8                 4.020381e-01    1         1 OFF
     eO_9                 3.184044e-01    1         1 OFF

    Radial function for element: H1
     Number of parameters: 10
     Cusp: 0.000000e+00
     Cutoff radius: 1.000000e+01

      Name                        Value Type Recompute Use Index
     ----- ---------------------------- ---- --------- --- -----
     eH1_0                -2.109567e-01    1         1 OFF
     eH1_1                -1.179768e-01    1         1 OFF
     eH1_2                -8.084403e-02    1         1 OFF
     eH1_3                -6.080353e-02    1         1 OFF
     eH1_4                 1.051562e-02    1         1 OFF
     eH1_5                 5.515815e-02    1         1 OFF
     eH1_6                 8.996440e-02    1         1 OFF
     eH1_7                 6.226309e-02    1         1 OFF
     eH1_8                 1.501311e-02    1         1 OFF
     eH1_9                 5.970218e-02    1         1 OFF

    Radial function for element: H2
     Number of parameters: 10
     Cusp: 0.000000e+00
     Cutoff radius: 1.000000e+01

      Name                        Value Type Recompute Use Index
     ----- ---------------------------- ---- --------- --- -----
     eH2_0                -2.080899e-01    1         1 OFF
     eH2_1                -1.154340e-01    1         1 OFF
     eH2_2                -7.758266e-02    1         1 OFF
     eH2_3                -5.770820e-02    1         1 OFF
     eH2_4                 1.328223e-02    1         1 OFF
     eH2_5                 5.887921e-02    1         1 OFF
     eH2_6                 9.407126e-02    1         1 OFF
     eH2_7                 6.834309e-02    1         1 OFF
     eH2_8                 2.271186e-02    1         1 OFF
     eH2_9                 6.402535e-02    1         1 OFF

  Created SPOSet builder named 'LCAOBSet' of type molecularorbital
  LCAO: SoaAtomicBasisSet<MultiQuintic,0>
  AO BasisSet for C
   Angular momentum expanded in cartesian functions x^lx y^ly z^lz according to Gamess
Using log grid with default values: ri = 1.000000e-06 rf = 1.000000e+02 npts = 1001
   R(n,l,m,s) 0 0 0 0
   R(n,l,m,s) 1 0 0 0
   R(n,l,m,s) 2 1 0 0
   R(n,l,m,s) 3 1 0 0
   R(n,l,m,s) 4 2 0 0
Expanding Ylm (angular function) according to Gamess using cartesian gaussians
Adding 1 cartesian gaussian orbitals for l= 0
Adding 1 cartesian gaussian orbitals for l= 0
Adding 3 cartesian gaussian orbitals for l= 1
Adding 3 cartesian gaussian orbitals for l= 1
Adding 6 cartesian gaussian orbitals for l= 2
  Setting cutoff radius 1.270574e+01

   Maximum Angular Momentum  = 2
   Number of Radial functors = 5
   Basis size                = 14

  AO BasisSet for O
   Angular momentum expanded in cartesian functions x^lx y^ly z^lz according to Gamess
Using log grid with default values: ri = 1.000000e-06 rf = 1.000000e+02 npts = 1001
   R(n,l,m,s) 0 0 0 0
   R(n,l,m,s) 1 0 0 0
   R(n,l,m,s) 2 1 0 0
   R(n,l,m,s) 3 1 0 0
   R(n,l,m,s) 4 2 0 0
Expanding Ylm (angular function) according to Gamess using cartesian gaussians
Adding 1 cartesian gaussian orbitals for l= 0
Adding 1 cartesian gaussian orbitals for l= 0
Adding 3 cartesian gaussian orbitals for l= 1
Adding 3 cartesian gaussian orbitals for l= 1
Adding 6 cartesian gaussian orbitals for l= 2
  Setting cutoff radius 1.018591e+01

   Maximum Angular Momentum  = 2
   Number of Radial functors = 5
   Basis size                = 14

  AO BasisSet for H1
   Angular momentum expanded in cartesian functions x^lx y^ly z^lz according to Gamess
Using log grid with default values: ri = 1.000000e-06 rf = 1.000000e+02 npts = 1001
   R(n,l,m,s) 0 0 0 0
   R(n,l,m,s) 1 0 0 0
   R(n,l,m,s) 2 1 0 0
Expanding Ylm (angular function) according to Gamess using cartesian gaussians
Adding 1 cartesian gaussian orbitals for l= 0
Adding 1 cartesian gaussian orbitals for l= 0
Adding 3 cartesian gaussian orbitals for l= 1
  Setting cutoff radius 1.270574e+01

   Maximum Angular Momentum  = 1
   Number of Radial functors = 3
   Basis size                = 5

  AO BasisSet for H2
   Angular momentum expanded in cartesian functions x^lx y^ly z^lz according to Gamess
Using log grid with default values: ri = 1.000000e-06 rf = 1.000000e+02 npts = 1001
   R(n,l,m,s) 0 0 0 0
   R(n,l,m,s) 1 0 0 0
   R(n,l,m,s) 2 1 0 0
Expanding Ylm (angular function) according to Gamess using cartesian gaussians
Adding 1 cartesian gaussian orbitals for l= 0
Adding 1 cartesian gaussian orbitals for l= 0
Adding 3 cartesian gaussian orbitals for l= 1
  Setting cutoff radius 1.270574e+01

   Maximum Angular Momentum  = 1
   Number of Radial functors = 3
   Basis size                = 5

Creating SPOSet in SlaterDetBuilder::put(xmlNodePtr cur).
spo_name = spo-up
  Building SPOSet 'spo-up' with '' basis set.
Creating SPOSet in SlaterDetBuilder::put(xmlNodePtr cur).
spo_name = spo-dn
  Building SPOSet 'spo-dn' with '' basis set.
Using Bryan's algorithm for MultiSlaterDeterminant expansion. 
Creating base determinant (up) for MSD expansion. 
Creating base determinant (down) for MSD expansion. 
Found determinant list. 
Reading CI expansion.
Found 77 terms in the MSD expansion.
Norm of ci vector (sum of ci^2): 1.001334e+00
Norm of qchem ci vector (sum of qchem_ci^2): 0.000000e+00
Found 24 unique up determinants.
Found 24 unique down determinants.
Number of terms in pairs array: 12
Number of terms in pairs array: 12
CI coefficients are optimizable. 
  FermionWF = MultiSlaterDeterminantFast
  QMCHamiltonian::addOperator Kinetic to H, physical Hamiltonian 
  QMCHamiltonian::addOperator ElecElec to H, physical Hamiltonian 
QMCHamiltonian::addOperatorType added type coulomb named ElecElec

  ECPotential builder for pseudopotential 

  Adding pseudopotential for C
   Linear grid  ri=0.000000e+00 rf=1.000000e+01 npts = 10001
    ECPComponentBuilder::buildSemiLocalAndLocal 
    Assuming Hartree unit
   Number of angular momentum channels 2
   Maximum angular momentum channel 1
   Creating a Linear Grid Rmax=1.405000e+00
  Using global grid with delta = 1.000000e-03
   Making L=1 a local potential with a radial cutoff of 9.999000e+00
    Non-local pseudopotential parameters
    Maximum angular mementum = 0
    Number of non-local channels = 1
       l(0)=0
    Cutoff radius = 1.405000e+00
    Spherical grids and weights: 
         1.0000000000e+00  0.0000000000e+00  0.0000000000e+00    8.3333333333e-02
        -1.0000000000e+00  1.2246467991e-16  0.0000000000e+00    8.3333333333e-02
         4.4721359550e-01  8.9442719100e-01  0.0000000000e+00    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -8.9442719100e-01  1.0953573965e-16    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
    Maximum cutoff radius 1.4050000000e+00

  Adding pseudopotential for O
   Linear grid  ri=0.0000000000e+00 rf=1.0000000000e+01 npts = 10001
    ECPComponentBuilder::buildSemiLocalAndLocal 
    Assuming Hartree unit
   Number of angular momentum channels 2
   Maximum angular momentum channel 1
   Creating a Linear Grid Rmax=1.0750000000e+00
  Using global grid with delta = 1.0000000000e-03
   Making L=1 a local potential with a radial cutoff of 9.9990000000e+00
    Non-local pseudopotential parameters
    Maximum angular mementum = 0
    Number of non-local channels = 1
       l(0)=0
    Cutoff radius = 1.0750000000e+00
    Spherical grids and weights: 
         1.0000000000e+00  0.0000000000e+00  0.0000000000e+00    8.3333333333e-02
        -1.0000000000e+00  1.2246467991e-16  0.0000000000e+00    8.3333333333e-02
         4.4721359550e-01  8.9442719100e-01  0.0000000000e+00    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -8.9442719100e-01  1.0953573965e-16    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
    Maximum cutoff radius 1.0750000000e+00

  Adding pseudopotential for H1
   Linear grid  ri=0.0000000000e+00 rf=1.0000000000e+01 npts = 10001
    ECPComponentBuilder::buildSemiLocalAndLocal 
    Assuming Hartree unit
   Number of angular momentum channels 2
   Maximum angular momentum channel 1
   Creating a Linear Grid Rmax=1.0000000000e-10
  Using global grid with delta = 1.0000000000e-03
   Making L=1 a local potential with a radial cutoff of 9.9990000000e+00
    Non-local pseudopotential parameters
    Maximum angular mementum = 0
    Number of non-local channels = 1
       l(0)=0
    Cutoff radius = 1.0000000000e-03
    Spherical grids and weights: 
         1.0000000000e+00  0.0000000000e+00  0.0000000000e+00    8.3333333333e-02
        -1.0000000000e+00  1.2246467991e-16  0.0000000000e+00    8.3333333333e-02
         4.4721359550e-01  8.9442719100e-01  0.0000000000e+00    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -8.9442719100e-01  1.0953573965e-16    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
    Maximum cutoff radius 1.0000000000e-03

  Adding pseudopotential for H2
   Linear grid  ri=0.0000000000e+00 rf=1.0000000000e+01 npts = 10001
    ECPComponentBuilder::buildSemiLocalAndLocal 
    Assuming Hartree unit
   Number of angular momentum channels 2
   Maximum angular momentum channel 1
   Creating a Linear Grid Rmax=1.0000000000e-10
  Using global grid with delta = 1.0000000000e-03
   Making L=1 a local potential with a radial cutoff of 9.9990000000e+00
    Non-local pseudopotential parameters
    Maximum angular mementum = 0
    Number of non-local channels = 1
       l(0)=0
    Cutoff radius = 1.0000000000e-03
    Spherical grids and weights: 
         1.0000000000e+00  0.0000000000e+00  0.0000000000e+00    8.3333333333e-02
        -1.0000000000e+00  1.2246467991e-16  0.0000000000e+00    8.3333333333e-02
         4.4721359550e-01  8.9442719100e-01  0.0000000000e+00    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -8.9442719100e-01  1.0953573965e-16    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
    Maximum cutoff radius 1.0000000000e-03
  QMCHamiltonian::addOperator LocalECP to H, physical Hamiltonian 

  Using NonLocalECP potential 
    Maximum grid on a sphere for NonLocalECPotential: 12
  QMCHamiltonian::addOperator NonLocalECP to H, physical Hamiltonian 
QMCHamiltonian::addOperatorType added type pseudo named NonLocalECP
  QMCHamiltonian::addOperator IonIon to H, physical Hamiltonian 
QMCHamiltonian::addOperatorType added type coulomb named IonIon

  QMCHamiltonian::add2WalkerProperty added
    5 to P::PropertyList 
    0 to P::Collectables 
    starting Index of the observables in P::PropertyList = 10
ParticleSetPool::randomize 
  Initialization Execution time = 3.3187e-01 secs
=========================================================
 Summary of QMC systems 
=========================================================
ParticleSetPool has: 

  ParticleSet 'e' contains 12 particles :  u(6) d(6)

    u -1.8061669018e+00  2.7837752017e-01 -8.9374600273e-01
    u  6.2204767277e-01 -3.1767951129e-01 -1.6068917470e+00
    u  2.7844543642e-02 -4.6711695757e-01  1.3769739340e+00
    u  5.3613352983e-01 -1.0346031641e-01  1.1931174682e+00
    u  6.6915801034e-01  1.1573235719e+00  1.2719505344e+00
    u  1.8470266426e-02  1.4117662795e+00 -1.6695285925e+00
    d -9.6293909260e-01  1.0337145637e+00 -8.9962839053e-01
    d  1.0744417758e+00  1.1605479134e+00 -1.8930392030e+00
    d  1.2380477230e+00  4.9285421082e-01  8.7082227944e-01
    d  8.1730014770e-01 -3.7289888410e-01  2.8378529985e+00
    (... and 2 more particle positions ...)

  Distance table for similar particles (A-A):
    source/target: e
    Using structure-of-arrays (SoA) data layout
    Distance computations use open boundary conditions in 3D.

  Distance table for dissimilar particles (A-B):
    source: ion0  target: e
    Using structure-of-arrays (SoA) data layout
    Distance computations use open boundary conditions in 3D.


  ParticleSet 'ion0' contains 4 particles :  C(1) O(1) H1(1) H2(1)

    C  0.0000000000e+00  0.0000000000e+00 -1.1394765782e+00
    O  0.0000000000e+00  0.0000000000e+00  1.1440287480e+00
    H1  0.0000000000e+00  1.7662761033e+00 -2.2339863698e+00
    H2  0.0000000000e+00 -1.7662761033e+00 -2.2339863698e+00

  Distance table for similar particles (A-A):
    source/target: ion0
    Using structure-of-arrays (SoA) data layout
    Distance computations use open boundary conditions in 3D.


  Hamiltonian h0
  Kinetic         Kinetic energy
  ElecElec        CoulombAA source/target e

  LocalECP        LocalECPotential: ion0
  NonLocalECP     NonLocalECPotential: ion0
  IonIon          CoulombAA source/target ion0


Loop execution max-interations = 60
Inside LM engine constructor, num_params is: 0 and _total_num_params is: 0

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s000 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15
  Adding 1 walkers to 0 existing sets
  Total number of walkers: 1.2800000000e+02
  Total weight: 1.2800000000e+02

=========================================================
  Start VMC
  File Root FORM.s000 append = no 
=========================================================
Resetting walkers
  Using the current 1 walkers.
  Total number of walkers: 1.2800000000e+02
  Total weight: 1.2800000000e+02
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=0  my_counter=0
  time step      = 5.0000000000e-02
  blocks         = 250
  steps          = 250
  substeps       = 10
  current        = 0
  target samples = 8.0000000000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">250</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">6.2500000000e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000000000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000000000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000000000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000000000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000000000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000000000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">8.0000000000e+06</parameter>
<parameter name="samplesperthread" condition="real">6.2500000000e+04</parameter>
<parameter name="steps" condition="int">250</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000000000e-02</parameter>
<parameter name="time_step" condition="au">5.0000000000e-02</parameter>
<parameter name="timestep" condition="au">5.0000000000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
  Set drift_modifier UNR parameter a = 1.0000000000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000000000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: 0 and ratio_threshold_: 0.0000000000e+00
Allocating full size _hmat_temp and _smat_temp
Inside LM engine's get_param, num_params is: 76
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="250">
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =8000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 0
    time step          = 0.05
    reference energy   = -22.7531
    reference variance = 0.501511
====================================================
  Execution time = 1.0009e+02
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s000
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 62500 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 6.1086e+04
  VMC Eavg = -2.2670e+01
  VMC Evar = 5.1353e-01
  Total weights = 7.820675480e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.0210e+01
  </log>
</opt>
<opt stage="main" walkers="62500">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.500342991173
                                         uncertainty =       0.001523980201

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.500342991173
                                         uncertainty =       0.001523980201

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000250085974
  error estimate for blocks of size 2^( 2) =       0.000258992582
  error estimate for blocks of size 2^( 3) =       0.000267048602
  error estimate for blocks of size 2^( 4) =       0.000272848034
  error estimate for blocks of size 2^( 5) =       0.000276221932
  error estimate for blocks of size 2^( 6) =       0.000277613892
  error estimate for blocks of size 2^( 7) =       0.000278570887
  error estimate for blocks of size 2^( 8) =       0.000278941749
  error estimate for blocks of size 2^( 9) =       0.000278341135

      target function =                  N/A
              le_mean =     -22.669814017615
             les_mean =     514.433999388570
             stat err =       0.000278366916
             autocorr =       1.238957943840
              std dev =       0.707349953141
             le_variance =       0.500343956208


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy-2.266981401762e+01 
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.5000e-01, overlap shift 2.5000e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.669814017642       residual = 5.78e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.669814760431       residual = 1.06e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.669814975917       residual = 2.90e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.669815020397       residual = 1.12e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 2.5000e-01 is 5.349289e-04

solving harmonic davidson linear method for identity shift 1.0000e+00, overlap shift 1.0000e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.669814017642       residual = 5.78e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.669814284204       residual = 5.14e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.669814311984       residual = 1.19e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.669814330861       residual = 3.08e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 1.0000e+00 is 2.028885e-04

solving harmonic davidson linear method for identity shift 4.0000e+00, overlap shift 4.0000e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.669814017642       residual = 5.78e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.669814092423       residual = 5.02e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.669814094027       residual = 1.20e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.669814101527       residual = 3.24e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 4.0000e+00 is 5.970599e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.237161 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.2056e+02
  </log>
  <optVariables href="FORM.s000.opt.xml">
ci_001 -7.050773e-01                3 1 ON  0
ci_002 -7.059810e-01                3 1 ON  1
ci_003 -3.762411e-02                3 1 ON  2
ci_004 -3.883802e-02                3 1 ON  3
ci_005 1.600155e-02                 3 1 ON  4
ci_006 1.602471e-02                 3 1 ON  5
ci_007 1.226229e-02                 3 1 ON  6
ci_008 1.243301e-02                 3 1 ON  7
ci_009 -1.163473e-02                3 1 ON  8
ci_010 -1.180933e-02                3 1 ON  9
ci_011 -8.107575e-03                3 1 ON  10
ci_012 -8.049790e-03                3 1 ON  11
ci_013 9.640679e-03                 3 1 ON  12
ci_014 9.410061e-03                 3 1 ON  13
ci_015 1.233668e-02                 3 1 ON  14
ci_016 1.254145e-02                 3 1 ON  15
ci_017 1.106147e-02                 3 1 ON  16
ci_018 1.078531e-02                 3 1 ON  17
ci_019 -2.622862e-03                3 1 ON  18
ci_020 -2.497711e-03                3 1 ON  19
ci_021 -8.461101e-03                3 1 ON  20
ci_022 -8.795729e-03                3 1 ON  21
ci_023 7.825487e-03                 3 1 ON  22
ci_024 7.917622e-03                 3 1 ON  23
ci_025 4.625378e-03                 3 1 ON  24
ci_026 4.196860e-03                 3 1 ON  25
ci_027 6.553982e-03                 3 1 ON  26
ci_028 6.474648e-03                 3 1 ON  27
ci_029 -4.765809e-03                3 1 ON  28
ci_030 -4.642064e-03                3 1 ON  29
ci_031 -7.545589e-03                3 1 ON  30
ci_032 -8.141406e-03                3 1 ON  31
ci_033 4.579285e-03                 3 1 ON  32
ci_034 4.428324e-03                 3 1 ON  33
ci_035 1.076743e-03                 3 1 ON  34
ci_036 9.758678e-04                 3 1 ON  35
ci_037 4.996638e-03                 3 1 ON  36
ci_038 5.239306e-03                 3 1 ON  37
ci_039 5.408498e-03                 3 1 ON  38
ci_040 5.311956e-03                 3 1 ON  39
ci_041 4.972977e-03                 3 1 ON  40
ci_042 5.263522e-03                 3 1 ON  41
ci_043 4.923540e-03                 3 1 ON  42
ci_044 4.965438e-03                 3 1 ON  43
ci_045 3.290597e-03                 3 1 ON  44
ci_046 3.133034e-03                 3 1 ON  45
ci_047 -7.457350e-04                3 1 ON  46
ci_048 -5.224364e-04                3 1 ON  47
ci_049 1.593557e-03                 3 1 ON  48
ci_050 1.749847e-03                 3 1 ON  49
ci_051 -1.176911e-03                3 1 ON  50
ci_052 -1.135330e-03                3 1 ON  51
ci_053 -2.623878e-03                3 1 ON  52
ci_054 -2.387567e-03                3 1 ON  53
ci_055 -1.490894e-03                3 1 ON  54
ci_056 -1.314402e-03                3 1 ON  55
ci_057 -1.203604e-03                3 1 ON  56
ci_058 -1.914734e-03                3 1 ON  57
ci_059 2.604073e-04                 3 1 ON  58
ci_060 3.443588e-04                 3 1 ON  59
ci_061 -3.614965e-04                3 1 ON  60
ci_062 -8.224214e-05                3 1 ON  61
ci_063 -4.592360e-04                3 1 ON  62
ci_064 -8.731533e-04                3 1 ON  63
ci_065 -2.430178e-03                3 1 ON  64
ci_066 -2.400799e-03                3 1 ON  65
ci_067 -2.127521e-03                3 1 ON  66
ci_068 -2.428538e-03                3 1 ON  67
ci_069 -2.837584e-04                3 1 ON  68
ci_070 9.235784e-05                 3 1 ON  69
ci_071 -1.962986e-03                3 1 ON  70
ci_072 -1.990150e-03                3 1 ON  71
ci_073 5.003192e-04                 3 1 ON  72
ci_074 3.019115e-04                 3 1 ON  73
ci_075 -2.991393e-04                3 1 ON  74
ci_076 -3.093553e-04                3 1 ON  75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="250">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =8000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 0
    time step          = 0.05
    reference energy   = -22.8221
    reference variance = 0.593569
====================================================
  Execution time = 9.9659e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s000
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 62500 
  VMC Eavg = -2.2670e+01
  VMC Evar = 5.1130e-01
  Total weights = 7.8206e+06
  Execution time = 1.4540e+01
  </log>
</opt>
<opt stage="main" walkers="62500">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.498862285170
                                         uncertainty =       0.001441776900

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.498862285170
                                         uncertainty =       0.001441776900

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000249716295
  error estimate for blocks of size 2^( 2) =       0.000258566655
  error estimate for blocks of size 2^( 3) =       0.000266527043
  error estimate for blocks of size 2^( 4) =       0.000272311714
  error estimate for blocks of size 2^( 5) =       0.000275618933
  error estimate for blocks of size 2^( 6) =       0.000277340192
  error estimate for blocks of size 2^( 7) =       0.000278563626
  error estimate for blocks of size 2^( 8) =       0.000279077358
  error estimate for blocks of size 2^( 9) =       0.000279357323

      target function =                  N/A
              le_mean =     -22.669889275112
             les_mean =     514.436292946980
             stat err =       0.000278584625
             autocorr =       1.244573426624
              std dev =       0.706304340940
             le_variance =       0.498865822030

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.498954243006
                                         uncertainty =       0.001452914569

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.498954243006
                                         uncertainty =       0.001452914569

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000249739305
  error estimate for blocks of size 2^( 2) =       0.000258590050
  error estimate for blocks of size 2^( 3) =       0.000266550557
  error estimate for blocks of size 2^( 4) =       0.000272336111
  error estimate for blocks of size 2^( 5) =       0.000275641118
  error estimate for blocks of size 2^( 6) =       0.000277358653
  error estimate for blocks of size 2^( 7) =       0.000278581725
  error estimate for blocks of size 2^( 8) =       0.000279090045
  error estimate for blocks of size 2^( 9) =       0.000279369113

      target function =                  N/A
              le_mean =     -22.669893131705
             les_mean =     514.440385064730
             stat err =       0.000278599884
             autocorr =       1.244480404469
              std dev =       0.706369425611
             le_variance =       0.498957765438

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.498916203180
                                         uncertainty =       0.001449330723

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.498916203180
                                         uncertainty =       0.001449330723

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000249729787
  error estimate for blocks of size 2^( 2) =       0.000258580374
  error estimate for blocks of size 2^( 3) =       0.000266540795
  error estimate for blocks of size 2^( 4) =       0.000272325946
  error estimate for blocks of size 2^( 5) =       0.000275631410
  error estimate for blocks of size 2^( 6) =       0.000277350393
  error estimate for blocks of size 2^( 7) =       0.000278573694
  error estimate for blocks of size 2^( 8) =       0.000279084229
  error estimate for blocks of size 2^( 9) =       0.000279363751

      target function =                  N/A
              le_mean =     -22.669890458620
             les_mean =     514.436380722398
             stat err =       0.000278593017
             autocorr =       1.244513922098
              std dev =       0.706342502954
             le_variance =       0.498919731479

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.498866890256
                                         uncertainty =       0.001442763323

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.498866890256
                                         uncertainty =       0.001442763323

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000249717447
  error estimate for blocks of size 2^( 2) =       0.000258567915
  error estimate for blocks of size 2^( 3) =       0.000266528291
  error estimate for blocks of size 2^( 4) =       0.000272313363
  error estimate for blocks of size 2^( 5) =       0.000275620133
  error estimate for blocks of size 2^( 6) =       0.000277341129
  error estimate for blocks of size 2^( 7) =       0.000278564202
  error estimate for blocks of size 2^( 8) =       0.000279077607
  error estimate for blocks of size 2^( 9) =       0.000279356276

      target function =                  N/A
              le_mean =     -22.669889393376
             les_mean =     514.440515372450
             stat err =       0.000278584804
             autocorr =       1.244563537079
              std dev =       0.706307600241
             le_variance =       0.498870426158


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.669889275112        initial
     2.5000e-01     2.5000e+00             5.3493e-04       -22.669893131705  <--
     1.0000e+00     1.0000e+01             2.0289e-04       -22.669890458620
     4.0000e+00     4.0000e+01             5.9706e-05       -22.669889393376

*****************************************************************************
Applying the update for shift_i =   2.5000e-01     and shift_s =   2.5000e+00
*****************************************************************************

  Execution time = 1.7286e+02
  </log>
  <optVariables href="FORM.s000.opt.xml">
ci_001                -7.051172e-01 3 1  ON 0
ci_002                -7.059517e-01 3 1  ON 1
ci_003                -3.755941e-02 3 1  ON 2
ci_004                -3.867551e-02 3 1  ON 3
ci_005                 1.580940e-02 3 1  ON 4
ci_006                 1.606256e-02 3 1  ON 5
ci_007                 1.223329e-02 3 1  ON 6
ci_008                 1.235933e-02 3 1  ON 7
ci_009                -1.143600e-02 3 1  ON 8
ci_010                -1.175450e-02 3 1  ON 9
ci_011                -7.974790e-03 3 1  ON 10
ci_012                -7.857140e-03 3 1  ON 11
ci_013                 9.643349e-03 3 1  ON 12
ci_014                 9.518508e-03 3 1  ON 13
ci_015                 1.243797e-02 3 1  ON 14
ci_016                 1.249513e-02 3 1  ON 15
ci_017                 1.141793e-02 3 1  ON 16
ci_018                 1.078928e-02 3 1  ON 17
ci_019                -2.835521e-03 3 1  ON 18
ci_020                -2.635664e-03 3 1  ON 19
ci_021                -8.438905e-03 3 1  ON 20
ci_022                -9.078522e-03 3 1  ON 21
ci_023                 7.858480e-03 3 1  ON 22
ci_024                 7.707111e-03 3 1  ON 23
ci_025                 4.483050e-03 3 1  ON 24
ci_026                 4.053072e-03 3 1  ON 25
ci_027                 6.697515e-03 3 1  ON 26
ci_028                 6.469322e-03 3 1  ON 27
ci_029                -4.539549e-03 3 1  ON 28
ci_030                -4.375188e-03 3 1  ON 29
ci_031                -7.855300e-03 3 1  ON 30
ci_032                -8.159061e-03 3 1  ON 31
ci_033                 4.518862e-03 3 1  ON 32
ci_034                 4.458829e-03 3 1  ON 33
ci_035                 1.002369e-03 3 1  ON 34
ci_036                 8.811263e-04 3 1  ON 35
ci_037                 5.074848e-03 3 1  ON 36
ci_038                 5.501337e-03 3 1  ON 37
ci_039                 5.558239e-03 3 1  ON 38
ci_040                 5.295362e-03 3 1  ON 39
ci_041                 4.976097e-03 3 1  ON 40
ci_042                 5.315338e-03 3 1  ON 41
ci_043                 4.876023e-03 3 1  ON 42
ci_044                 4.997273e-03 3 1  ON 43
ci_045                 3.607189e-03 3 1  ON 44
ci_046                 3.057076e-03 3 1  ON 45
ci_047                -6.966175e-04 3 1  ON 46
ci_048                -4.679272e-04 3 1  ON 47
ci_049                 1.622638e-03 3 1  ON 48
ci_050                 1.675014e-03 3 1  ON 49
ci_051                -1.299953e-03 3 1  ON 50
ci_052                -9.310685e-04 3 1  ON 51
ci_053                -2.647379e-03 3 1  ON 52
ci_054                -2.555678e-03 3 1  ON 53
ci_055                -1.494144e-03 3 1  ON 54
ci_056                -1.191576e-03 3 1  ON 55
ci_057                -1.137918e-03 3 1  ON 56
ci_058                -2.231557e-03 3 1  ON 57
ci_059                 1.785185e-04 3 1  ON 58
ci_060                 6.485573e-04 3 1  ON 59
ci_061                -4.332153e-04 3 1  ON 60
ci_062                -2.126749e-04 3 1  ON 61
ci_063                -3.372580e-04 3 1  ON 62
ci_064                -8.329886e-04 3 1  ON 63
ci_065                -2.472395e-03 3 1  ON 64
ci_066                -2.343436e-03 3 1  ON 65
ci_067                -2.174999e-03 3 1  ON 66
ci_068                -2.339048e-03 3 1  ON 67
ci_069                -4.184758e-04 3 1  ON 68
ci_070                 2.074438e-05 3 1  ON 69
ci_071                -2.115984e-03 3 1  ON 70
ci_072                -2.052105e-03 3 1  ON 71
ci_073                 3.937797e-04 3 1  ON 72
ci_074                 3.135479e-04 3 1  ON 73
ci_075                -3.136701e-04 3 1  ON 74
ci_076                -3.317278e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 2.9343e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s001 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s001 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=1  my_counter=0
  time step      = 5.0000e-02
  blocks         = 250
  steps          = 250
  substeps       = 10
  current        = 0
  target samples = 8.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">250</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">6.2500e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">8.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">6.2500e+04</parameter>
<parameter name="steps" condition="int">250</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2788e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="250">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =8000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 1
    time step          = 0.05
    reference energy   = -22.6922
    reference variance = 0.329985
====================================================
  Execution time = 9.9881e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s001
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 62500 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 6.1093e+04
  VMC Eavg = -2.2670e+01
  VMC Evar = 5.1009e-01
  Total weights = 7.820363235e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.9338e+01
  </log>
</opt>
<opt stage="main" walkers="62500">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.497358370108
                                         uncertainty =       0.001331540664

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.497358370108
                                         uncertainty =       0.001331540664

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000249338080
  error estimate for blocks of size 2^( 2) =       0.000258285755
  error estimate for blocks of size 2^( 3) =       0.000266254087
  error estimate for blocks of size 2^( 4) =       0.000271818469
  error estimate for blocks of size 2^( 5) =       0.000275090921
  error estimate for blocks of size 2^( 6) =       0.000276972782
  error estimate for blocks of size 2^( 7) =       0.000277707471
  error estimate for blocks of size 2^( 8) =       0.000279237588
  error estimate for blocks of size 2^( 9) =       0.000279028902

      target function =                  N/A
              le_mean =     -22.669830318215
             les_mean =     514.431296151872
             stat err =       0.000278236686
             autocorr =       1.245235700975
              std dev =       0.705234587293
             le_variance =       0.497355823115


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266983031822e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.2500e-02, overlap shift 6.2500e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.669830318237       residual = 4.87e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.669839638005       residual = 1.90e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.669840097746       residual = 1.49e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.669840172932       residual = 1.23e-08           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.669840221333       residual = 1.29e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          4 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 6.2500e-02 is 9.932656e-04

solving harmonic davidson linear method for identity shift 2.5000e-01, overlap shift 2.5000e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.669830318237       residual = 4.87e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.669835428133       residual = 7.46e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.669835434838       residual = 2.69e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.669835420115       residual = 1.14e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 2.5000e-01 is 5.009565e-04

solving harmonic davidson linear method for identity shift 1.0000e+00, overlap shift 1.0000e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.669830318237       residual = 4.87e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.669832138739       residual = 3.60e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.669832082163       residual = 7.71e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 1.0000e+00 is 1.690742e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.238743 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.1924e+02
  </log>
  <optVariables href="FORM.s001.opt.xml">
ci_001                -7.051390e-01 3 1  ON 0
ci_002                -7.059386e-01 3 1  ON 1
ci_003                -3.757272e-02 3 1  ON 2
ci_004                -3.847262e-02 3 1  ON 3
ci_005                 1.578745e-02 3 1  ON 4
ci_006                 1.605728e-02 3 1  ON 5
ci_007                 1.230962e-02 3 1  ON 6
ci_008                 1.209670e-02 3 1  ON 7
ci_009                -1.173812e-02 3 1  ON 8
ci_010                -1.171527e-02 3 1  ON 9
ci_011                -7.790300e-03 3 1  ON 10
ci_012                -8.281669e-03 3 1  ON 11
ci_013                 9.522552e-03 3 1  ON 12
ci_014                 9.683480e-03 3 1  ON 13
ci_015                 1.249884e-02 3 1  ON 14
ci_016                 1.273655e-02 3 1  ON 15
ci_017                 1.156402e-02 3 1  ON 16
ci_018                 1.028832e-02 3 1  ON 17
ci_019                -3.331037e-03 3 1  ON 18
ci_020                -3.026987e-03 3 1  ON 19
ci_021                -8.801887e-03 3 1  ON 20
ci_022                -9.258230e-03 3 1  ON 21
ci_023                 7.429947e-03 3 1  ON 22
ci_024                 7.857534e-03 3 1  ON 23
ci_025                 4.313179e-03 3 1  ON 24
ci_026                 3.959145e-03 3 1  ON 25
ci_027                 6.640147e-03 3 1  ON 26
ci_028                 6.581605e-03 3 1  ON 27
ci_029                -4.745530e-03 3 1  ON 28
ci_030                -4.344345e-03 3 1  ON 29
ci_031                -7.930427e-03 3 1  ON 30
ci_032                -7.853704e-03 3 1  ON 31
ci_033                 4.215375e-03 3 1  ON 32
ci_034                 4.646407e-03 3 1  ON 33
ci_035                 1.074570e-03 3 1  ON 34
ci_036                 1.047247e-03 3 1  ON 35
ci_037                 5.165040e-03 3 1  ON 36
ci_038                 5.159215e-03 3 1  ON 37
ci_039                 5.381603e-03 3 1  ON 38
ci_040                 5.170162e-03 3 1  ON 39
ci_041                 5.270328e-03 3 1  ON 40
ci_042                 5.282653e-03 3 1  ON 41
ci_043                 4.632006e-03 3 1  ON 42
ci_044                 4.958615e-03 3 1  ON 43
ci_045                 3.286641e-03 3 1  ON 44
ci_046                 2.962513e-03 3 1  ON 45
ci_047                -6.288317e-04 3 1  ON 46
ci_048                -6.247662e-04 3 1  ON 47
ci_049                 1.317685e-03 3 1  ON 48
ci_050                 1.955804e-03 3 1  ON 49
ci_051                -1.431794e-03 3 1  ON 50
ci_052                -1.012607e-03 3 1  ON 51
ci_053                -2.691674e-03 3 1  ON 52
ci_054                -2.791568e-03 3 1  ON 53
ci_055                -1.535696e-03 3 1  ON 54
ci_056                -1.304566e-03 3 1  ON 55
ci_057                -1.210639e-03 3 1  ON 56
ci_058                -2.045401e-03 3 1  ON 57
ci_059                 4.238023e-04 3 1  ON 58
ci_060                 5.203207e-04 3 1  ON 59
ci_061                -2.606191e-04 3 1  ON 60
ci_062                -2.921015e-04 3 1  ON 61
ci_063                -2.865648e-04 3 1  ON 62
ci_064                -7.777063e-04 3 1  ON 63
ci_065                -2.685883e-03 3 1  ON 64
ci_066                -2.235292e-03 3 1  ON 65
ci_067                -2.404115e-03 3 1  ON 66
ci_068                -2.230292e-03 3 1  ON 67
ci_069                -4.108131e-04 3 1  ON 68
ci_070                -1.000267e-04 3 1  ON 69
ci_071                -2.116402e-03 3 1  ON 70
ci_072                -1.860624e-03 3 1  ON 71
ci_073                 2.909127e-04 3 1  ON 72
ci_074                 3.530054e-04 3 1  ON 73
ci_075                -1.866000e-04 3 1  ON 74
ci_076                -9.948627e-06 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="250">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =8000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 1
    time step          = 0.05
    reference energy   = -22.6881
    reference variance = 0.25869
====================================================
  Execution time = 9.9879e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s001
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 62500 
  VMC Eavg = -2.2670e+01
  VMC Evar = 5.1253e-01
  Total weights = 7.8211e+06
  Execution time = 1.4534e+01
  </log>
</opt>
<opt stage="main" walkers="62500">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.500229120573
                                         uncertainty =       0.001906060187

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.500229120573
                                         uncertainty =       0.001906060187

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000250057630
  error estimate for blocks of size 2^( 2) =       0.000258929106
  error estimate for blocks of size 2^( 3) =       0.000266907826
  error estimate for blocks of size 2^( 4) =       0.000272574859
  error estimate for blocks of size 2^( 5) =       0.000276141742
  error estimate for blocks of size 2^( 6) =       0.000277792527
  error estimate for blocks of size 2^( 7) =       0.000278145200
  error estimate for blocks of size 2^( 8) =       0.000278876878
  error estimate for blocks of size 2^( 9) =       0.000278860629

      target function =                  N/A
              le_mean =     -22.669959869802
             les_mean =     514.594413938108
             stat err =       0.000278418809
             autocorr =       1.239700906129
              std dev =       0.707269784629
             le_variance =       0.500230548249

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.500179951697
                                         uncertainty =       0.001960321848

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.500179951697
                                         uncertainty =       0.001960321848

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000250045307
  error estimate for blocks of size 2^( 2) =       0.000258920469
  error estimate for blocks of size 2^( 3) =       0.000266900101
  error estimate for blocks of size 2^( 4) =       0.000272566294
  error estimate for blocks of size 2^( 5) =       0.000276138883
  error estimate for blocks of size 2^( 6) =       0.000277786937
  error estimate for blocks of size 2^( 7) =       0.000278149338
  error estimate for blocks of size 2^( 8) =       0.000278866808
  error estimate for blocks of size 2^( 9) =       0.000278870961

      target function =                  N/A
              le_mean =     -22.669961037178
             les_mean =     514.441069383284
             stat err =       0.000278418511
             autocorr =       1.239820460449
              std dev =       0.707234927374
             le_variance =       0.500181242498

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.500231946938
                                         uncertainty =       0.001962384716

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.500231946938
                                         uncertainty =       0.001962384716

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000250058293
  error estimate for blocks of size 2^( 2) =       0.000258935152
  error estimate for blocks of size 2^( 3) =       0.000266913404
  error estimate for blocks of size 2^( 4) =       0.000272579103
  error estimate for blocks of size 2^( 5) =       0.000276152286
  error estimate for blocks of size 2^( 6) =       0.000277800132
  error estimate for blocks of size 2^( 7) =       0.000278162436
  error estimate for blocks of size 2^( 8) =       0.000278880240
  error estimate for blocks of size 2^( 9) =       0.000278886435

      target function =                  N/A
              le_mean =     -22.669961911045
             les_mean =     514.459304264269
             stat err =       0.000278432311
             autocorr =       1.239814584215
              std dev =       0.707271657444
             le_variance =       0.500233197424

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.500123665945
                                         uncertainty =       0.001913740722

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.500123665945
                                         uncertainty =       0.001913740722

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000250031271
  error estimate for blocks of size 2^( 2) =       0.000258904134
  error estimate for blocks of size 2^( 3) =       0.000266883667
  error estimate for blocks of size 2^( 4) =       0.000272547217
  error estimate for blocks of size 2^( 5) =       0.000276116556
  error estimate for blocks of size 2^( 6) =       0.000277765281
  error estimate for blocks of size 2^( 7) =       0.000278122962
  error estimate for blocks of size 2^( 8) =       0.000278844804
  error estimate for blocks of size 2^( 9) =       0.000278832885

      target function =                  N/A
              le_mean =     -22.669953751532
             les_mean =     514.440655987837
             stat err =       0.000278391483
             autocorr =       1.239718932123
              std dev =       0.707195227905
             le_variance =       0.500125090371


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.669959869802        initial
     6.2500e-02     6.2500e-01             9.9327e-04       -22.669961037178
     2.5000e-01     2.5000e+00             5.0096e-04       -22.669961911045  <--
     1.0000e+00     1.0000e+01             1.6907e-04       -22.669953751532

*****************************************************************************
Applying the update for shift_i =   2.5000e-01     and shift_s =   2.5000e+00
*****************************************************************************

  Execution time = 1.7500e+02
  </log>
  <optVariables href="FORM.s001.opt.xml">
ci_001                -7.051390e-01 3 1  ON 0
ci_002                -7.059386e-01 3 1  ON 1
ci_003                -3.757272e-02 3 1  ON 2
ci_004                -3.847262e-02 3 1  ON 3
ci_005                 1.578745e-02 3 1  ON 4
ci_006                 1.605728e-02 3 1  ON 5
ci_007                 1.230962e-02 3 1  ON 6
ci_008                 1.209670e-02 3 1  ON 7
ci_009                -1.173812e-02 3 1  ON 8
ci_010                -1.171527e-02 3 1  ON 9
ci_011                -7.790300e-03 3 1  ON 10
ci_012                -8.281669e-03 3 1  ON 11
ci_013                 9.522552e-03 3 1  ON 12
ci_014                 9.683480e-03 3 1  ON 13
ci_015                 1.249884e-02 3 1  ON 14
ci_016                 1.273655e-02 3 1  ON 15
ci_017                 1.156402e-02 3 1  ON 16
ci_018                 1.028832e-02 3 1  ON 17
ci_019                -3.331037e-03 3 1  ON 18
ci_020                -3.026987e-03 3 1  ON 19
ci_021                -8.801887e-03 3 1  ON 20
ci_022                -9.258230e-03 3 1  ON 21
ci_023                 7.429947e-03 3 1  ON 22
ci_024                 7.857534e-03 3 1  ON 23
ci_025                 4.313179e-03 3 1  ON 24
ci_026                 3.959145e-03 3 1  ON 25
ci_027                 6.640147e-03 3 1  ON 26
ci_028                 6.581605e-03 3 1  ON 27
ci_029                -4.745530e-03 3 1  ON 28
ci_030                -4.344345e-03 3 1  ON 29
ci_031                -7.930427e-03 3 1  ON 30
ci_032                -7.853704e-03 3 1  ON 31
ci_033                 4.215375e-03 3 1  ON 32
ci_034                 4.646407e-03 3 1  ON 33
ci_035                 1.074570e-03 3 1  ON 34
ci_036                 1.047247e-03 3 1  ON 35
ci_037                 5.165040e-03 3 1  ON 36
ci_038                 5.159215e-03 3 1  ON 37
ci_039                 5.381603e-03 3 1  ON 38
ci_040                 5.170162e-03 3 1  ON 39
ci_041                 5.270328e-03 3 1  ON 40
ci_042                 5.282653e-03 3 1  ON 41
ci_043                 4.632006e-03 3 1  ON 42
ci_044                 4.958615e-03 3 1  ON 43
ci_045                 3.286641e-03 3 1  ON 44
ci_046                 2.962513e-03 3 1  ON 45
ci_047                -6.288317e-04 3 1  ON 46
ci_048                -6.247662e-04 3 1  ON 47
ci_049                 1.317685e-03 3 1  ON 48
ci_050                 1.955804e-03 3 1  ON 49
ci_051                -1.431794e-03 3 1  ON 50
ci_052                -1.012607e-03 3 1  ON 51
ci_053                -2.691674e-03 3 1  ON 52
ci_054                -2.791568e-03 3 1  ON 53
ci_055                -1.535696e-03 3 1  ON 54
ci_056                -1.304566e-03 3 1  ON 55
ci_057                -1.210639e-03 3 1  ON 56
ci_058                -2.045401e-03 3 1  ON 57
ci_059                 4.238023e-04 3 1  ON 58
ci_060                 5.203207e-04 3 1  ON 59
ci_061                -2.606191e-04 3 1  ON 60
ci_062                -2.921015e-04 3 1  ON 61
ci_063                -2.865648e-04 3 1  ON 62
ci_064                -7.777063e-04 3 1  ON 63
ci_065                -2.685883e-03 3 1  ON 64
ci_066                -2.235292e-03 3 1  ON 65
ci_067                -2.404115e-03 3 1  ON 66
ci_068                -2.230292e-03 3 1  ON 67
ci_069                -4.108131e-04 3 1  ON 68
ci_070                -1.000267e-04 3 1  ON 69
ci_071                -2.116402e-03 3 1  ON 70
ci_072                -1.860624e-03 3 1  ON 71
ci_073                 2.909127e-04 3 1  ON 72
ci_074                 3.530054e-04 3 1  ON 73
ci_075                -1.866000e-04 3 1  ON 74
ci_076                -9.948627e-06 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 2.9424e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s002 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s002 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=2  my_counter=0
  time step      = 5.0000e-02
  blocks         = 250
  steps          = 250
  substeps       = 10
  current        = 0
  target samples = 8.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">250</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">6.2500e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">8.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">6.2500e+04</parameter>
<parameter name="steps" condition="int">250</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2739e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="250">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =8000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 2
    time step          = 0.05
    reference energy   = -22.6803
    reference variance = 0.504883
====================================================
  Execution time = 9.9657e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s002
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 62500 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 6.1073e+04
  VMC Eavg = -2.2670e+01
  VMC Evar = 5.1274e-01
  Total weights = 7.821684671e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.8970e+01
  </log>
</opt>
<opt stage="main" walkers="62500">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.499169546013
                                         uncertainty =       0.001489198637

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.499169546013
                                         uncertainty =       0.001489198637

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000249791780
  error estimate for blocks of size 2^( 2) =       0.000258754618
  error estimate for blocks of size 2^( 3) =       0.000266721389
  error estimate for blocks of size 2^( 4) =       0.000272391267
  error estimate for blocks of size 2^( 5) =       0.000275612876
  error estimate for blocks of size 2^( 6) =       0.000277215214
  error estimate for blocks of size 2^( 7) =       0.000278197042
  error estimate for blocks of size 2^( 8) =       0.000278734602
  error estimate for blocks of size 2^( 9) =       0.000278775328

      target function =                  N/A
              le_mean =     -22.669518624984
             les_mean =     514.419814047894
             stat err =       0.000278230547
             autocorr =       1.240661576418
              std dev =       0.706517846608
             le_variance =       0.499167467576


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266951862498e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.2500e-02, overlap shift 6.2500e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.669518625011       residual = 4.21e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.669522514777       residual = 2.48e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.669524129430       residual = 3.20e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.669524012979       residual = 4.18e-08           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.669523977048       residual = 6.18e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          4 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 6.2500e-02 is 1.059688e-03

solving harmonic davidson linear method for identity shift 2.5000e-01, overlap shift 2.5000e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.669518625011       residual = 4.21e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.669520791777       residual = 8.45e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.669521327913       residual = 3.64e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.669521321863       residual = 1.45e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 2.5000e-01 is 4.551432e-04

solving harmonic davidson linear method for identity shift 1.0000e+00, overlap shift 1.0000e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.669518625011       residual = 4.21e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.669519406720       residual = 3.73e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.669519525829       residual = 6.82e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 1.0000e+00 is 1.589058e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.251133 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.2216e+02
  </log>
  <optVariables href="FORM.s002.opt.xml">
ci_001                -7.050478e-01 3 1  ON 0
ci_002                -7.060271e-01 3 1  ON 1
ci_003                -3.795235e-02 3 1  ON 2
ci_004                -3.825440e-02 3 1  ON 3
ci_005                 1.561775e-02 3 1  ON 4
ci_006                 1.578771e-02 3 1  ON 5
ci_007                 1.236128e-02 3 1  ON 6
ci_008                 1.228671e-02 3 1  ON 7
ci_009                -1.184149e-02 3 1  ON 8
ci_010                -1.170887e-02 3 1  ON 9
ci_011                -7.841960e-03 3 1  ON 10
ci_012                -8.274783e-03 3 1  ON 11
ci_013                 9.522695e-03 3 1  ON 12
ci_014                 9.606880e-03 3 1  ON 13
ci_015                 1.226700e-02 3 1  ON 14
ci_016                 1.276834e-02 3 1  ON 15
ci_017                 1.119572e-02 3 1  ON 16
ci_018                 1.029441e-02 3 1  ON 17
ci_019                -3.464399e-03 3 1  ON 18
ci_020                -3.267203e-03 3 1  ON 19
ci_021                -8.869084e-03 3 1  ON 20
ci_022                -9.556100e-03 3 1  ON 21
ci_023                 7.610686e-03 3 1  ON 22
ci_024                 7.847440e-03 3 1  ON 23
ci_025                 3.970026e-03 3 1  ON 24
ci_026                 4.007245e-03 3 1  ON 25
ci_027                 6.731436e-03 3 1  ON 26
ci_028                 6.922538e-03 3 1  ON 27
ci_029                -4.885598e-03 3 1  ON 28
ci_030                -4.799488e-03 3 1  ON 29
ci_031                -8.098145e-03 3 1  ON 30
ci_032                -7.672683e-03 3 1  ON 31
ci_033                 4.359496e-03 3 1  ON 32
ci_034                 4.661032e-03 3 1  ON 33
ci_035                 1.453664e-03 3 1  ON 34
ci_036                 1.146153e-03 3 1  ON 35
ci_037                 4.884369e-03 3 1  ON 36
ci_038                 5.048256e-03 3 1  ON 37
ci_039                 5.367675e-03 3 1  ON 38
ci_040                 5.359495e-03 3 1  ON 39
ci_041                 5.242830e-03 3 1  ON 40
ci_042                 5.026273e-03 3 1  ON 41
ci_043                 4.527912e-03 3 1  ON 42
ci_044                 5.040908e-03 3 1  ON 43
ci_045                 3.425343e-03 3 1  ON 44
ci_046                 2.915100e-03 3 1  ON 45
ci_047                -6.473377e-04 3 1  ON 46
ci_048                -6.240651e-04 3 1  ON 47
ci_049                 1.460135e-03 3 1  ON 48
ci_050                 1.788690e-03 3 1  ON 49
ci_051                -1.514887e-03 3 1  ON 50
ci_052                -1.040803e-03 3 1  ON 51
ci_053                -2.881825e-03 3 1  ON 52
ci_054                -2.630423e-03 3 1  ON 53
ci_055                -1.378203e-03 3 1  ON 54
ci_056                -1.453443e-03 3 1  ON 55
ci_057                -1.356771e-03 3 1  ON 56
ci_058                -1.866008e-03 3 1  ON 57
ci_059                 3.214383e-04 3 1  ON 58
ci_060                 3.698704e-04 3 1  ON 59
ci_061                -1.246171e-04 3 1  ON 60
ci_062                -5.759953e-05 3 1  ON 61
ci_063                -4.490258e-04 3 1  ON 62
ci_064                -6.282050e-04 3 1  ON 63
ci_065                -2.268616e-03 3 1  ON 64
ci_066                -2.262732e-03 3 1  ON 65
ci_067                -2.082553e-03 3 1  ON 66
ci_068                -1.945531e-03 3 1  ON 67
ci_069                -2.532894e-04 3 1  ON 68
ci_070                -1.037315e-05 3 1  ON 69
ci_071                -2.284959e-03 3 1  ON 70
ci_072                -1.809479e-03 3 1  ON 71
ci_073                 3.247327e-04 3 1  ON 72
ci_074                 1.736595e-04 3 1  ON 73
ci_075                -4.168867e-04 3 1  ON 74
ci_076                -4.460303e-05 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="250">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =8000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 2
    time step          = 0.05
    reference energy   = -22.7508
    reference variance = 0.423454
====================================================
  Execution time = 1.0025e+02
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s002
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 62500 
  VMC Eavg = -2.2670e+01
  VMC Evar = 5.1219e-01
  Total weights = 7.8212e+06
  Execution time = 1.4570e+01
  </log>
</opt>
<opt stage="main" walkers="62500">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.499873330731
                                         uncertainty =       0.002317757834

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.499873330731
                                         uncertainty =       0.002317757834

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000249968217
  error estimate for blocks of size 2^( 2) =       0.000258880614
  error estimate for blocks of size 2^( 3) =       0.000266657403
  error estimate for blocks of size 2^( 4) =       0.000272488960
  error estimate for blocks of size 2^( 5) =       0.000275730123
  error estimate for blocks of size 2^( 6) =       0.000277117341
  error estimate for blocks of size 2^( 7) =       0.000278745151
  error estimate for blocks of size 2^( 8) =       0.000279049924
  error estimate for blocks of size 2^( 9) =       0.000279683633

      target function =                  N/A
              le_mean =     -22.669850837708
             les_mean =     514.437762379297
             stat err =       0.000278649012
             autocorr =       1.242640289439
              std dev =       0.707016885951
             le_variance =       0.499872877020

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.499952969811
                                         uncertainty =       0.002368214053

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.499952969811
                                         uncertainty =       0.002368214053

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000249988104
  error estimate for blocks of size 2^( 2) =       0.000258902530
  error estimate for blocks of size 2^( 3) =       0.000266681972
  error estimate for blocks of size 2^( 4) =       0.000272515315
  error estimate for blocks of size 2^( 5) =       0.000275758247
  error estimate for blocks of size 2^( 6) =       0.000277144345
  error estimate for blocks of size 2^( 7) =       0.000278772381
  error estimate for blocks of size 2^( 8) =       0.000279087154
  error estimate for blocks of size 2^( 9) =       0.000279736083

      target function =                  N/A
              le_mean =     -22.669851098777
             les_mean =     514.437560252290
             stat err =       0.000278684991
             autocorr =       1.242763454453
              std dev =       0.707073133814
             le_variance =       0.499952416562

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.500004841586
                                         uncertainty =       0.002381650069

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.500004841586
                                         uncertainty =       0.002381650069

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000250001063
  error estimate for blocks of size 2^( 2) =       0.000258915060
  error estimate for blocks of size 2^( 3) =       0.000266694169
  error estimate for blocks of size 2^( 4) =       0.000272527361
  error estimate for blocks of size 2^( 5) =       0.000275770496
  error estimate for blocks of size 2^( 6) =       0.000277156460
  error estimate for blocks of size 2^( 7) =       0.000278786440
  error estimate for blocks of size 2^( 8) =       0.000279105948
  error estimate for blocks of size 2^( 9) =       0.000279756835

      target function =                  N/A
              le_mean =     -22.669853358396
             les_mean =     514.451253557243
             stat err =       0.000278701421
             autocorr =       1.242781140605
              std dev =       0.707109788042
             le_variance =       0.500004252345

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.499873298328
                                         uncertainty =       0.002328347671

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.499873298328
                                         uncertainty =       0.002328347671

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000249968203
  error estimate for blocks of size 2^( 2) =       0.000258880877
  error estimate for blocks of size 2^( 3) =       0.000266658293
  error estimate for blocks of size 2^( 4) =       0.000272490284
  error estimate for blocks of size 2^( 5) =       0.000275732562
  error estimate for blocks of size 2^( 6) =       0.000277119693
  error estimate for blocks of size 2^( 7) =       0.000278746811
  error estimate for blocks of size 2^( 8) =       0.000279050988
  error estimate for blocks of size 2^( 9) =       0.000279685863

      target function =                  N/A
              le_mean =     -22.669849546363
             les_mean =     514.440247118453
             stat err =       0.000278650839
             autocorr =       1.242656719622
              std dev =       0.707016846108
             le_variance =       0.499872820681


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.669850837708        initial
     6.2500e-02     6.2500e-01             1.0597e-03       -22.669851098777
     2.5000e-01     2.5000e+00             4.5514e-04       -22.669853358396  <--
     1.0000e+00     1.0000e+01             1.5891e-04       -22.669849546363

*****************************************************************************
Applying the update for shift_i =   2.5000e-01     and shift_s =   2.5000e+00
*****************************************************************************

  Execution time = 1.7690e+02
  </log>
  <optVariables href="FORM.s002.opt.xml">
ci_001                -7.050478e-01 3 1  ON 0
ci_002                -7.060271e-01 3 1  ON 1
ci_003                -3.795235e-02 3 1  ON 2
ci_004                -3.825440e-02 3 1  ON 3
ci_005                 1.561775e-02 3 1  ON 4
ci_006                 1.578771e-02 3 1  ON 5
ci_007                 1.236128e-02 3 1  ON 6
ci_008                 1.228671e-02 3 1  ON 7
ci_009                -1.184149e-02 3 1  ON 8
ci_010                -1.170887e-02 3 1  ON 9
ci_011                -7.841960e-03 3 1  ON 10
ci_012                -8.274783e-03 3 1  ON 11
ci_013                 9.522695e-03 3 1  ON 12
ci_014                 9.606880e-03 3 1  ON 13
ci_015                 1.226700e-02 3 1  ON 14
ci_016                 1.276834e-02 3 1  ON 15
ci_017                 1.119572e-02 3 1  ON 16
ci_018                 1.029441e-02 3 1  ON 17
ci_019                -3.464399e-03 3 1  ON 18
ci_020                -3.267203e-03 3 1  ON 19
ci_021                -8.869084e-03 3 1  ON 20
ci_022                -9.556100e-03 3 1  ON 21
ci_023                 7.610686e-03 3 1  ON 22
ci_024                 7.847440e-03 3 1  ON 23
ci_025                 3.970026e-03 3 1  ON 24
ci_026                 4.007245e-03 3 1  ON 25
ci_027                 6.731436e-03 3 1  ON 26
ci_028                 6.922538e-03 3 1  ON 27
ci_029                -4.885598e-03 3 1  ON 28
ci_030                -4.799488e-03 3 1  ON 29
ci_031                -8.098145e-03 3 1  ON 30
ci_032                -7.672683e-03 3 1  ON 31
ci_033                 4.359496e-03 3 1  ON 32
ci_034                 4.661032e-03 3 1  ON 33
ci_035                 1.453664e-03 3 1  ON 34
ci_036                 1.146153e-03 3 1  ON 35
ci_037                 4.884369e-03 3 1  ON 36
ci_038                 5.048256e-03 3 1  ON 37
ci_039                 5.367675e-03 3 1  ON 38
ci_040                 5.359495e-03 3 1  ON 39
ci_041                 5.242830e-03 3 1  ON 40
ci_042                 5.026273e-03 3 1  ON 41
ci_043                 4.527912e-03 3 1  ON 42
ci_044                 5.040908e-03 3 1  ON 43
ci_045                 3.425343e-03 3 1  ON 44
ci_046                 2.915100e-03 3 1  ON 45
ci_047                -6.473377e-04 3 1  ON 46
ci_048                -6.240651e-04 3 1  ON 47
ci_049                 1.460135e-03 3 1  ON 48
ci_050                 1.788690e-03 3 1  ON 49
ci_051                -1.514887e-03 3 1  ON 50
ci_052                -1.040803e-03 3 1  ON 51
ci_053                -2.881825e-03 3 1  ON 52
ci_054                -2.630423e-03 3 1  ON 53
ci_055                -1.378203e-03 3 1  ON 54
ci_056                -1.453443e-03 3 1  ON 55
ci_057                -1.356771e-03 3 1  ON 56
ci_058                -1.866008e-03 3 1  ON 57
ci_059                 3.214383e-04 3 1  ON 58
ci_060                 3.698704e-04 3 1  ON 59
ci_061                -1.246171e-04 3 1  ON 60
ci_062                -5.759953e-05 3 1  ON 61
ci_063                -4.490258e-04 3 1  ON 62
ci_064                -6.282050e-04 3 1  ON 63
ci_065                -2.268616e-03 3 1  ON 64
ci_066                -2.262732e-03 3 1  ON 65
ci_067                -2.082553e-03 3 1  ON 66
ci_068                -1.945531e-03 3 1  ON 67
ci_069                -2.532894e-04 3 1  ON 68
ci_070                -1.037315e-05 3 1  ON 69
ci_071                -2.284959e-03 3 1  ON 70
ci_072                -1.809479e-03 3 1  ON 71
ci_073                 3.247327e-04 3 1  ON 72
ci_074                 1.736595e-04 3 1  ON 73
ci_075                -4.168867e-04 3 1  ON 74
ci_076                -4.460303e-05 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 2.9907e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s003 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s003 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=3  my_counter=0
  time step      = 5.0000e-02
  blocks         = 250
  steps          = 250
  substeps       = 10
  current        = 0
  target samples = 8.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">250</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">6.2500e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">8.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">6.2500e+04</parameter>
<parameter name="steps" condition="int">250</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2731e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="250">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =8000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 3
    time step          = 0.05
    reference energy   = -22.6889
    reference variance = 0.603965
====================================================
  Execution time = 9.9919e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s003
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 62500 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 6.1080e+04
  VMC Eavg = -2.2670e+01
  VMC Evar = 5.1535e-01
  Total weights = 7.821157275e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.8960e+01
  </log>
</opt>
<opt stage="main" walkers="62500">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.500477830927
                                         uncertainty =       0.002186759623

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.500477830927
                                         uncertainty =       0.002186759623

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000250118489
  error estimate for blocks of size 2^( 2) =       0.000259207161
  error estimate for blocks of size 2^( 3) =       0.000267284865
  error estimate for blocks of size 2^( 4) =       0.000273203480
  error estimate for blocks of size 2^( 5) =       0.000276319641
  error estimate for blocks of size 2^( 6) =       0.000278276799
  error estimate for blocks of size 2^( 7) =       0.000279384567
  error estimate for blocks of size 2^( 8) =       0.000279956291
  error estimate for blocks of size 2^( 9) =       0.000280017939

      target function =                  N/A
              le_mean =     -22.669799543093
             les_mean =     514.435160313048
             stat err =       0.000279408899
             autocorr =       1.247926119496
              std dev =       0.707441918852
             le_variance =       0.500474068548


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266979954309e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.2500e-02, overlap shift 6.2500e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.669799543117       residual = 5.09e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.669801177113       residual = 2.48e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.669802494555       residual = 2.12e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.669802450441       residual = 2.17e-08           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.669802340356       residual = 2.10e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          4 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 6.2500e-02 is 1.262515e-03

solving harmonic davidson linear method for identity shift 2.5000e-01, overlap shift 2.5000e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.669799543117       residual = 5.09e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.669800428849       residual = 9.48e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.669800848611       residual = 4.42e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.669800795841       residual = 1.74e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 2.5000e-01 is 6.609440e-04

solving harmonic davidson linear method for identity shift 1.0000e+00, overlap shift 1.0000e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.669799543117       residual = 5.09e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.669799855904       residual = 5.72e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.669799916929       residual = 1.64e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.669799903479       residual = 5.80e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 1.0000e+00 is 2.291304e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.252644 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.1890e+02
  </log>
  <optVariables href="FORM.s003.opt.xml">
ci_001                -7.050037e-01 3 1  ON 0
ci_002                -7.060775e-01 3 1  ON 1
ci_003                -3.816171e-02 3 1  ON 2
ci_004                -3.798803e-02 3 1  ON 3
ci_005                 1.567599e-02 3 1  ON 4
ci_006                 1.588451e-02 3 1  ON 5
ci_007                 1.237891e-02 3 1  ON 6
ci_008                 1.203472e-02 3 1  ON 7
ci_009                -1.175651e-02 3 1  ON 8
ci_010                -1.165175e-02 3 1  ON 9
ci_011                -8.018482e-03 3 1  ON 10
ci_012                -8.456119e-03 3 1  ON 11
ci_013                 9.775196e-03 3 1  ON 12
ci_014                 9.495926e-03 3 1  ON 13
ci_015                 1.209486e-02 3 1  ON 14
ci_016                 1.270635e-02 3 1  ON 15
ci_017                 1.113272e-02 3 1  ON 16
ci_018                 1.071585e-02 3 1  ON 17
ci_019                -3.657018e-03 3 1  ON 18
ci_020                -3.410159e-03 3 1  ON 19
ci_021                -8.690381e-03 3 1  ON 20
ci_022                -9.298949e-03 3 1  ON 21
ci_023                 7.524124e-03 3 1  ON 22
ci_024                 7.675867e-03 3 1  ON 23
ci_025                 4.427386e-03 3 1  ON 24
ci_026                 3.923610e-03 3 1  ON 25
ci_027                 6.736716e-03 3 1  ON 26
ci_028                 7.174004e-03 3 1  ON 27
ci_029                -5.091077e-03 3 1  ON 28
ci_030                -4.619088e-03 3 1  ON 29
ci_031                -7.980426e-03 3 1  ON 30
ci_032                -7.722513e-03 3 1  ON 31
ci_033                 4.588154e-03 3 1  ON 32
ci_034                 4.727309e-03 3 1  ON 33
ci_035                 1.261950e-03 3 1  ON 34
ci_036                 9.060390e-04 3 1  ON 35
ci_037                 5.545313e-03 3 1  ON 36
ci_038                 4.537641e-03 3 1  ON 37
ci_039                 5.414925e-03 3 1  ON 38
ci_040                 5.181790e-03 3 1  ON 39
ci_041                 4.911184e-03 3 1  ON 40
ci_042                 5.098604e-03 3 1  ON 41
ci_043                 4.579653e-03 3 1  ON 42
ci_044                 4.781269e-03 3 1  ON 43
ci_045                 3.235379e-03 3 1  ON 44
ci_046                 3.033599e-03 3 1  ON 45
ci_047                -6.198398e-04 3 1  ON 46
ci_048                -6.582965e-04 3 1  ON 47
ci_049                 1.556608e-03 3 1  ON 48
ci_050                 1.690079e-03 3 1  ON 49
ci_051                -1.436433e-03 3 1  ON 50
ci_052                -6.203209e-04 3 1  ON 51
ci_053                -3.022427e-03 3 1  ON 52
ci_054                -2.437069e-03 3 1  ON 53
ci_055                -1.160808e-03 3 1  ON 54
ci_056                -1.374994e-03 3 1  ON 55
ci_057                -1.520475e-03 3 1  ON 56
ci_058                -1.543428e-03 3 1  ON 57
ci_059                 2.856584e-04 3 1  ON 58
ci_060                 4.120957e-04 3 1  ON 59
ci_061                -1.478463e-04 3 1  ON 60
ci_062                -2.061627e-04 3 1  ON 61
ci_063                -1.917003e-04 3 1  ON 62
ci_064                -7.890005e-04 3 1  ON 63
ci_065                -2.725974e-03 3 1  ON 64
ci_066                -1.959208e-03 3 1  ON 65
ci_067                -2.143386e-03 3 1  ON 66
ci_068                -2.202950e-03 3 1  ON 67
ci_069                -1.124825e-04 3 1  ON 68
ci_070                -4.574051e-05 3 1  ON 69
ci_071                -2.369711e-03 3 1  ON 70
ci_072                -1.424024e-03 3 1  ON 71
ci_073                 1.970634e-04 3 1  ON 72
ci_074                 2.563725e-04 3 1  ON 73
ci_075                -7.381707e-04 3 1  ON 74
ci_076                -4.300438e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="250">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =8000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 3
    time step          = 0.05
    reference energy   = -22.6818
    reference variance = 0.455883
====================================================
  Execution time = 1.0113e+02
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s003
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 62500 
  VMC Eavg = -2.2670e+01
  VMC Evar = 5.1740e-01
  Total weights = 7.8206e+06
  Execution time = 1.4525e+01
  </log>
</opt>
<opt stage="main" walkers="62500">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.502605280325
                                         uncertainty =       0.003410804662

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.502605280325
                                         uncertainty =       0.003410804662

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000250650016
  error estimate for blocks of size 2^( 2) =       0.000259411534
  error estimate for blocks of size 2^( 3) =       0.000267283269
  error estimate for blocks of size 2^( 4) =       0.000273075964
  error estimate for blocks of size 2^( 5) =       0.000276483614
  error estimate for blocks of size 2^( 6) =       0.000278643503
  error estimate for blocks of size 2^( 7) =       0.000279484331
  error estimate for blocks of size 2^( 8) =       0.000279569600
  error estimate for blocks of size 2^( 9) =       0.000279967488

      target function =                  N/A
              le_mean =     -22.669907730820
             les_mean =     520.701444227164
             stat err =       0.000279416231
             autocorr =       1.242704252160
              std dev =       0.708945305251
             le_variance =       0.502603445837

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.502604021149
                                         uncertainty =       0.003371363373

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.502604021149
                                         uncertainty =       0.003371363373

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000250649757
  error estimate for blocks of size 2^( 2) =       0.000259412045
  error estimate for blocks of size 2^( 3) =       0.000267291776
  error estimate for blocks of size 2^( 4) =       0.000273082881
  error estimate for blocks of size 2^( 5) =       0.000276498111
  error estimate for blocks of size 2^( 6) =       0.000278664050
  error estimate for blocks of size 2^( 7) =       0.000279488137
  error estimate for blocks of size 2^( 8) =       0.000279604598
  error estimate for blocks of size 2^( 9) =       0.000280029783

      target function =                  N/A
              le_mean =     -22.669895538119
             les_mean =     514.897747198991
             stat err =       0.000279446642
             autocorr =       1.242977351572
              std dev =       0.708944570123
             le_variance =       0.502602403506

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.502408239126
                                         uncertainty =       0.003362689968

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.502408239126
                                         uncertainty =       0.003362689968

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000250600861
  error estimate for blocks of size 2^( 2) =       0.000259362629
  error estimate for blocks of size 2^( 3) =       0.000267237927
  error estimate for blocks of size 2^( 4) =       0.000273030271
  error estimate for blocks of size 2^( 5) =       0.000276436754
  error estimate for blocks of size 2^( 6) =       0.000278592805
  error estimate for blocks of size 2^( 7) =       0.000279433553
  error estimate for blocks of size 2^( 8) =       0.000279538615
  error estimate for blocks of size 2^( 9) =       0.000279954415

      target function =                  N/A
              le_mean =     -22.669899040484
             les_mean =     514.471500694559
             stat err =       0.000279379847
             autocorr =       1.242868077314
              std dev =       0.708806271939
             le_variance =       0.502406331140

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.502490183124
                                         uncertainty =       0.003398314193

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.502490183124
                                         uncertainty =       0.003398314193

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000250621300
  error estimate for blocks of size 2^( 2) =       0.000259385182
  error estimate for blocks of size 2^( 3) =       0.000267259097
  error estimate for blocks of size 2^( 4) =       0.000273052138
  error estimate for blocks of size 2^( 5) =       0.000276458747
  error estimate for blocks of size 2^( 6) =       0.000278617147
  error estimate for blocks of size 2^( 7) =       0.000279457245
  error estimate for blocks of size 2^( 8) =       0.000279551510
  error estimate for blocks of size 2^( 9) =       0.000279944188

      target function =                  N/A
              le_mean =     -22.669900245838
             les_mean =     514.444078331793
             stat err =       0.000279392523
             autocorr =       1.242778126188
              std dev =       0.708864083195
             le_variance =       0.502488288444


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.669907730820        initial  <--
     6.2500e-02     6.2500e-01             1.2625e-03       -22.669895538119
     2.5000e-01     2.5000e+00             6.6094e-04       -22.669899040484
     1.0000e+00     1.0000e+01             2.2913e-04       -22.669900245838

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 173.9885
  </log>
  <optVariables href="FORM.s003.opt.xml">
ci_001                -7.050478e-01 3 1  ON 0
ci_002                -7.060271e-01 3 1  ON 1
ci_003                -3.795235e-02 3 1  ON 2
ci_004                -3.825440e-02 3 1  ON 3
ci_005                 1.561775e-02 3 1  ON 4
ci_006                 1.578771e-02 3 1  ON 5
ci_007                 1.236128e-02 3 1  ON 6
ci_008                 1.228671e-02 3 1  ON 7
ci_009                -1.184149e-02 3 1  ON 8
ci_010                -1.170887e-02 3 1  ON 9
ci_011                -7.841960e-03 3 1  ON 10
ci_012                -8.274783e-03 3 1  ON 11
ci_013                 9.522695e-03 3 1  ON 12
ci_014                 9.606880e-03 3 1  ON 13
ci_015                 1.226700e-02 3 1  ON 14
ci_016                 1.276834e-02 3 1  ON 15
ci_017                 1.119572e-02 3 1  ON 16
ci_018                 1.029441e-02 3 1  ON 17
ci_019                -3.464399e-03 3 1  ON 18
ci_020                -3.267203e-03 3 1  ON 19
ci_021                -8.869084e-03 3 1  ON 20
ci_022                -9.556100e-03 3 1  ON 21
ci_023                 7.610686e-03 3 1  ON 22
ci_024                 7.847440e-03 3 1  ON 23
ci_025                 3.970026e-03 3 1  ON 24
ci_026                 4.007245e-03 3 1  ON 25
ci_027                 6.731436e-03 3 1  ON 26
ci_028                 6.922538e-03 3 1  ON 27
ci_029                -4.885598e-03 3 1  ON 28
ci_030                -4.799488e-03 3 1  ON 29
ci_031                -8.098145e-03 3 1  ON 30
ci_032                -7.672683e-03 3 1  ON 31
ci_033                 4.359496e-03 3 1  ON 32
ci_034                 4.661032e-03 3 1  ON 33
ci_035                 1.453664e-03 3 1  ON 34
ci_036                 1.146153e-03 3 1  ON 35
ci_037                 4.884369e-03 3 1  ON 36
ci_038                 5.048256e-03 3 1  ON 37
ci_039                 5.367675e-03 3 1  ON 38
ci_040                 5.359495e-03 3 1  ON 39
ci_041                 5.242830e-03 3 1  ON 40
ci_042                 5.026273e-03 3 1  ON 41
ci_043                 4.527912e-03 3 1  ON 42
ci_044                 5.040908e-03 3 1  ON 43
ci_045                 3.425343e-03 3 1  ON 44
ci_046                 2.915100e-03 3 1  ON 45
ci_047                -6.473377e-04 3 1  ON 46
ci_048                -6.240651e-04 3 1  ON 47
ci_049                 1.460135e-03 3 1  ON 48
ci_050                 1.788690e-03 3 1  ON 49
ci_051                -1.514887e-03 3 1  ON 50
ci_052                -1.040803e-03 3 1  ON 51
ci_053                -2.881825e-03 3 1  ON 52
ci_054                -2.630423e-03 3 1  ON 53
ci_055                -1.378203e-03 3 1  ON 54
ci_056                -1.453443e-03 3 1  ON 55
ci_057                -1.356771e-03 3 1  ON 56
ci_058                -1.866008e-03 3 1  ON 57
ci_059                 3.214383e-04 3 1  ON 58
ci_060                 3.698704e-04 3 1  ON 59
ci_061                -1.246171e-04 3 1  ON 60
ci_062                -5.759953e-05 3 1  ON 61
ci_063                -4.490258e-04 3 1  ON 62
ci_064                -6.282050e-04 3 1  ON 63
ci_065                -2.268616e-03 3 1  ON 64
ci_066                -2.262732e-03 3 1  ON 65
ci_067                -2.082553e-03 3 1  ON 66
ci_068                -1.945531e-03 3 1  ON 67
ci_069                -2.532894e-04 3 1  ON 68
ci_070                -1.037315e-05 3 1  ON 69
ci_071                -2.284959e-03 3 1  ON 70
ci_072                -1.809479e-03 3 1  ON 71
ci_073                 3.247327e-04 3 1  ON 72
ci_074                 1.736595e-04 3 1  ON 73
ci_075                -4.168867e-04 3 1  ON 74
ci_076                -4.460303e-05 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 2.9289e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s004 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s004 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=4  my_counter=0
  time step      = 5.0000e-02
  blocks         = 250
  steps          = 250
  substeps       = 10
  current        = 0
  target samples = 8.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">250</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">6.2500e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">8.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">6.2500e+04</parameter>
<parameter name="steps" condition="int">250</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2720e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="250">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =8000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 4
    time step          = 0.05
    reference energy   = -22.7203
    reference variance = 0.374015
====================================================
  Execution time = 1.0136e+02
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s004
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 62500 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 6.1092e+04
  VMC Eavg = -2.2670e+01
  VMC Evar = 5.1294e-01
  Total weights = 7.821071905e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.8982e+01
  </log>
</opt>
<opt stage="main" walkers="62500">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.500167456091
                                         uncertainty =       0.001380370789

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.500167456091
                                         uncertainty =       0.001380370789

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000250042010
  error estimate for blocks of size 2^( 2) =       0.000258997920
  error estimate for blocks of size 2^( 3) =       0.000267011758
  error estimate for blocks of size 2^( 4) =       0.000272582973
  error estimate for blocks of size 2^( 5) =       0.000275980419
  error estimate for blocks of size 2^( 6) =       0.000277267910
  error estimate for blocks of size 2^( 7) =       0.000277690756
  error estimate for blocks of size 2^( 8) =       0.000277974898
  error estimate for blocks of size 2^( 9) =       0.000277971776

      target function =                  N/A
              le_mean =     -22.669953973467
             les_mean =     514.439755340525
             stat err =       0.000277726335
             autocorr =       1.233696015566
              std dev =       0.707225604698
             le_variance =       0.500168055940


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266995397347e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.2500e-01, overlap shift 6.2500e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.669953973492       residual = 4.51e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.669955921034       residual = 3.76e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.669955862757       residual = 1.16e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.669955871436       residual = 5.94e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 6.2500e-01 is 2.657087e-04

solving harmonic davidson linear method for identity shift 2.5000e+00, overlap shift 2.5000e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.669953973492       residual = 4.51e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.669954552192       residual = 3.36e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.669954549956       residual = 1.16e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.669954550401       residual = 4.66e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 2.5000e+00 is 7.561015e-05

solving harmonic davidson linear method for identity shift 1.0000e+01, overlap shift 1.0000e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.669953973492       residual = 4.51e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.669954125325       residual = 3.76e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.669954126188       residual = 1.36e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.669954126380       residual = 5.49e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 1.0000e+01 is 1.958672e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.254075 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.2036e+02
  </log>
  <optVariables href="FORM.s004.opt.xml">
ci_001                -7.050583e-01 3 1  ON 0
ci_002                -7.060190e-01 3 1  ON 1
ci_003                -3.793549e-02 3 1  ON 2
ci_004                -3.822254e-02 3 1  ON 3
ci_005                 1.563534e-02 3 1  ON 4
ci_006                 1.575924e-02 3 1  ON 5
ci_007                 1.233651e-02 3 1  ON 6
ci_008                 1.229413e-02 3 1  ON 7
ci_009                -1.184254e-02 3 1  ON 8
ci_010                -1.172778e-02 3 1  ON 9
ci_011                -7.879074e-03 3 1  ON 10
ci_012                -8.265976e-03 3 1  ON 11
ci_013                 9.496144e-03 3 1  ON 12
ci_014                 9.575378e-03 3 1  ON 13
ci_015                 1.225402e-02 3 1  ON 14
ci_016                 1.280440e-02 3 1  ON 15
ci_017                 1.116877e-02 3 1  ON 16
ci_018                 1.032170e-02 3 1  ON 17
ci_019                -3.485099e-03 3 1  ON 18
ci_020                -3.279679e-03 3 1  ON 19
ci_021                -8.849120e-03 3 1  ON 20
ci_022                -9.514706e-03 3 1  ON 21
ci_023                 7.665021e-03 3 1  ON 22
ci_024                 7.902974e-03 3 1  ON 23
ci_025                 3.947878e-03 3 1  ON 24
ci_026                 4.082856e-03 3 1  ON 25
ci_027                 6.683676e-03 3 1  ON 26
ci_028                 6.873040e-03 3 1  ON 27
ci_029                -4.898726e-03 3 1  ON 28
ci_030                -4.817868e-03 3 1  ON 29
ci_031                -8.104918e-03 3 1  ON 30
ci_032                -7.685149e-03 3 1  ON 31
ci_033                 4.378545e-03 3 1  ON 32
ci_034                 4.619670e-03 3 1  ON 33
ci_035                 1.427056e-03 3 1  ON 34
ci_036                 1.134395e-03 3 1  ON 35
ci_037                 4.901290e-03 3 1  ON 36
ci_038                 5.058028e-03 3 1  ON 37
ci_039                 5.417542e-03 3 1  ON 38
ci_040                 5.355056e-03 3 1  ON 39
ci_041                 5.254178e-03 3 1  ON 40
ci_042                 5.052358e-03 3 1  ON 41
ci_043                 4.546006e-03 3 1  ON 42
ci_044                 5.007658e-03 3 1  ON 43
ci_045                 3.370728e-03 3 1  ON 44
ci_046                 2.915886e-03 3 1  ON 45
ci_047                -5.852069e-04 3 1  ON 46
ci_048                -6.473139e-04 3 1  ON 47
ci_049                 1.405597e-03 3 1  ON 48
ci_050                 1.748825e-03 3 1  ON 49
ci_051                -1.522863e-03 3 1  ON 50
ci_052                -1.007031e-03 3 1  ON 51
ci_053                -2.891629e-03 3 1  ON 52
ci_054                -2.654287e-03 3 1  ON 53
ci_055                -1.434864e-03 3 1  ON 54
ci_056                -1.481967e-03 3 1  ON 55
ci_057                -1.331861e-03 3 1  ON 56
ci_058                -1.834549e-03 3 1  ON 57
ci_059                 2.844390e-04 3 1  ON 58
ci_060                 3.437158e-04 3 1  ON 59
ci_061                -1.408297e-04 3 1  ON 60
ci_062                -7.381873e-05 3 1  ON 61
ci_063                -4.728289e-04 3 1  ON 62
ci_064                -6.501169e-04 3 1  ON 63
ci_065                -2.239264e-03 3 1  ON 64
ci_066                -2.313469e-03 3 1  ON 65
ci_067                -2.101471e-03 3 1  ON 66
ci_068                -1.955681e-03 3 1  ON 67
ci_069                -2.270531e-04 3 1  ON 68
ci_070                -2.110568e-05 3 1  ON 69
ci_071                -2.255627e-03 3 1  ON 70
ci_072                -1.829693e-03 3 1  ON 71
ci_073                 3.092745e-04 3 1  ON 72
ci_074                 1.765741e-04 3 1  ON 73
ci_075                -4.410636e-04 3 1  ON 74
ci_076                -6.940134e-05 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="250">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =8000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 4
    time step          = 0.05
    reference energy   = -22.5492
    reference variance = 0.387473
====================================================
  Execution time = 1.0129e+02
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s004
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 62500 
  VMC Eavg = -2.2669e+01
  VMC Evar = 5.1144e-01
  Total weights = 7.8210e+06
  Execution time = 1.4548e+01
  </log>
</opt>
<opt stage="main" walkers="62500">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.497655011327
                                         uncertainty =       0.001369308673

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.497655011327
                                         uncertainty =       0.001369308673

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000249412608
  error estimate for blocks of size 2^( 2) =       0.000258241762
  error estimate for blocks of size 2^( 3) =       0.000266210694
  error estimate for blocks of size 2^( 4) =       0.000271672092
  error estimate for blocks of size 2^( 5) =       0.000275296899
  error estimate for blocks of size 2^( 6) =       0.000277241744
  error estimate for blocks of size 2^( 7) =       0.000277815449
  error estimate for blocks of size 2^( 8) =       0.000277740047
  error estimate for blocks of size 2^( 9) =       0.000278855188

      target function =                  N/A
              le_mean =     -22.669458824270
             les_mean =     514.415660207310
             stat err =       0.000277913107
             autocorr =       1.241598713225
              std dev =       0.705445384341
             le_variance =       0.497653190288

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.497797811123
                                         uncertainty =       0.001388017995

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.497797811123
                                         uncertainty =       0.001388017995

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000249448299
  error estimate for blocks of size 2^( 2) =       0.000258276773
  error estimate for blocks of size 2^( 3) =       0.000266241735
  error estimate for blocks of size 2^( 4) =       0.000271700930
  error estimate for blocks of size 2^( 5) =       0.000275326783
  error estimate for blocks of size 2^( 6) =       0.000277269986
  error estimate for blocks of size 2^( 7) =       0.000277843504
  error estimate for blocks of size 2^( 8) =       0.000277776277
  error estimate for blocks of size 2^( 9) =       0.000278878582

      target function =                  N/A
              le_mean =     -22.669457277087
             les_mean =     514.420744735162
             stat err =       0.000277942087
             autocorr =       1.241502317880
              std dev =       0.705546335449
             le_variance =       0.497795631466

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.497681617869
                                         uncertainty =       0.001371879925

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.497681617869
                                         uncertainty =       0.001371879925

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000249419267
  error estimate for blocks of size 2^( 2) =       0.000258248087
  error estimate for blocks of size 2^( 3) =       0.000266216144
  error estimate for blocks of size 2^( 4) =       0.000271676790
  error estimate for blocks of size 2^( 5) =       0.000275301483
  error estimate for blocks of size 2^( 6) =       0.000277245916
  error estimate for blocks of size 2^( 7) =       0.000277820235
  error estimate for blocks of size 2^( 8) =       0.000277745886
  error estimate for blocks of size 2^( 9) =       0.000278858840

      target function =                  N/A
              le_mean =     -22.669458565083
             les_mean =     514.416707494813
             stat err =       0.000277917719
             autocorr =       1.241573623981
              std dev =       0.705464218825
             le_variance =       0.497679764042

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.497656904050
                                         uncertainty =       0.001369511432

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.497656904050
                                         uncertainty =       0.001369511432

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000249413082
  error estimate for blocks of size 2^( 2) =       0.000258242185
  error estimate for blocks of size 2^( 3) =       0.000266211050
  error estimate for blocks of size 2^( 4) =       0.000271672384
  error estimate for blocks of size 2^( 5) =       0.000275297164
  error estimate for blocks of size 2^( 6) =       0.000277241935
  error estimate for blocks of size 2^( 7) =       0.000277815764
  error estimate for blocks of size 2^( 8) =       0.000277740267
  error estimate for blocks of size 2^( 9) =       0.000278855317

      target function =                  N/A
              le_mean =     -22.669458762436
             les_mean =     514.415725509508
             stat err =       0.000277913321
             autocorr =       1.241595902347
              std dev =       0.705446725457
             le_variance =       0.497655082458


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.669458824270        initial  <--
     6.2500e-01     6.2500e+00             2.6571e-04       -22.669457277087
     2.5000e+00     2.5000e+01             7.5610e-05       -22.669458565083
     1.0000e+01     1.0000e+02             1.9587e-05       -22.669458762436

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 174.2018
  </log>
  <optVariables href="FORM.s004.opt.xml">
ci_001                -7.050478e-01 3 1  ON 0
ci_002                -7.060271e-01 3 1  ON 1
ci_003                -3.795235e-02 3 1  ON 2
ci_004                -3.825440e-02 3 1  ON 3
ci_005                 1.561775e-02 3 1  ON 4
ci_006                 1.578771e-02 3 1  ON 5
ci_007                 1.236128e-02 3 1  ON 6
ci_008                 1.228671e-02 3 1  ON 7
ci_009                -1.184149e-02 3 1  ON 8
ci_010                -1.170887e-02 3 1  ON 9
ci_011                -7.841960e-03 3 1  ON 10
ci_012                -8.274783e-03 3 1  ON 11
ci_013                 9.522695e-03 3 1  ON 12
ci_014                 9.606880e-03 3 1  ON 13
ci_015                 1.226700e-02 3 1  ON 14
ci_016                 1.276834e-02 3 1  ON 15
ci_017                 1.119572e-02 3 1  ON 16
ci_018                 1.029441e-02 3 1  ON 17
ci_019                -3.464399e-03 3 1  ON 18
ci_020                -3.267203e-03 3 1  ON 19
ci_021                -8.869084e-03 3 1  ON 20
ci_022                -9.556100e-03 3 1  ON 21
ci_023                 7.610686e-03 3 1  ON 22
ci_024                 7.847440e-03 3 1  ON 23
ci_025                 3.970026e-03 3 1  ON 24
ci_026                 4.007245e-03 3 1  ON 25
ci_027                 6.731436e-03 3 1  ON 26
ci_028                 6.922538e-03 3 1  ON 27
ci_029                -4.885598e-03 3 1  ON 28
ci_030                -4.799488e-03 3 1  ON 29
ci_031                -8.098145e-03 3 1  ON 30
ci_032                -7.672683e-03 3 1  ON 31
ci_033                 4.359496e-03 3 1  ON 32
ci_034                 4.661032e-03 3 1  ON 33
ci_035                 1.453664e-03 3 1  ON 34
ci_036                 1.146153e-03 3 1  ON 35
ci_037                 4.884369e-03 3 1  ON 36
ci_038                 5.048256e-03 3 1  ON 37
ci_039                 5.367675e-03 3 1  ON 38
ci_040                 5.359495e-03 3 1  ON 39
ci_041                 5.242830e-03 3 1  ON 40
ci_042                 5.026273e-03 3 1  ON 41
ci_043                 4.527912e-03 3 1  ON 42
ci_044                 5.040908e-03 3 1  ON 43
ci_045                 3.425343e-03 3 1  ON 44
ci_046                 2.915100e-03 3 1  ON 45
ci_047                -6.473377e-04 3 1  ON 46
ci_048                -6.240651e-04 3 1  ON 47
ci_049                 1.460135e-03 3 1  ON 48
ci_050                 1.788690e-03 3 1  ON 49
ci_051                -1.514887e-03 3 1  ON 50
ci_052                -1.040803e-03 3 1  ON 51
ci_053                -2.881825e-03 3 1  ON 52
ci_054                -2.630423e-03 3 1  ON 53
ci_055                -1.378203e-03 3 1  ON 54
ci_056                -1.453443e-03 3 1  ON 55
ci_057                -1.356771e-03 3 1  ON 56
ci_058                -1.866008e-03 3 1  ON 57
ci_059                 3.214383e-04 3 1  ON 58
ci_060                 3.698704e-04 3 1  ON 59
ci_061                -1.246171e-04 3 1  ON 60
ci_062                -5.759953e-05 3 1  ON 61
ci_063                -4.490258e-04 3 1  ON 62
ci_064                -6.282050e-04 3 1  ON 63
ci_065                -2.268616e-03 3 1  ON 64
ci_066                -2.262732e-03 3 1  ON 65
ci_067                -2.082553e-03 3 1  ON 66
ci_068                -1.945531e-03 3 1  ON 67
ci_069                -2.532894e-04 3 1  ON 68
ci_070                -1.037315e-05 3 1  ON 69
ci_071                -2.284959e-03 3 1  ON 70
ci_072                -1.809479e-03 3 1  ON 71
ci_073                 3.247327e-04 3 1  ON 72
ci_074                 1.736595e-04 3 1  ON 73
ci_075                -4.168867e-04 3 1  ON 74
ci_076                -4.460303e-05 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 2.9457e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s005 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s005 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=5  my_counter=0
  time step      = 5.0000e-02
  blocks         = 250
  steps          = 250
  substeps       = 10
  current        = 0
  target samples = 8.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">250</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">6.2500e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">8.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">6.2500e+04</parameter>
<parameter name="steps" condition="int">250</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2703e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="250">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =8000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 5
    time step          = 0.05
    reference energy   = -22.6636
    reference variance = 0.384518
====================================================
  Execution time = 1.0139e+02
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s005
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 62500 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 6.1070e+04
  VMC Eavg = -2.2670e+01
  VMC Evar = 5.1760e-01
  Total weights = 7.820491762e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.8987e+01
  </log>
</opt>
<opt stage="main" walkers="62500">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.496959097098
                                         uncertainty =       0.001520200893

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.496959097098
                                         uncertainty =       0.001520200893

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000249239413
  error estimate for blocks of size 2^( 2) =       0.000258098440
  error estimate for blocks of size 2^( 3) =       0.000266013218
  error estimate for blocks of size 2^( 4) =       0.000271706453
  error estimate for blocks of size 2^( 5) =       0.000275210974
  error estimate for blocks of size 2^( 6) =       0.000276600459
  error estimate for blocks of size 2^( 7) =       0.000277769824
  error estimate for blocks of size 2^( 8) =       0.000278083537
  error estimate for blocks of size 2^( 9) =       0.000279963050

      target function =                  N/A
              le_mean =     -22.669723441995
             les_mean =     514.433961358165
             stat err =       0.000278104218
             autocorr =       1.245035433483
              std dev =       0.704955515808
             le_variance =       0.496962279268


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266972344199e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.2500e+00, overlap shift 6.2500e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.669723442018       residual = 4.24e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.669723579084       residual = 3.83e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.669723579075       residual = 1.01e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.669723579111       residual = 3.83e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 6.2500e+00 is 4.113085e-05

solving harmonic davidson linear method for identity shift 2.5000e+01, overlap shift 2.5000e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.669723442018       residual = 4.24e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.669723476986       residual = 4.03e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.669723477294       residual = 1.11e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.669723477317       residual = 4.18e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 2.5000e+01 is 1.046491e-05

solving harmonic davidson linear method for identity shift 1.0000e+02, overlap shift 1.0000e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.669723442018       residual = 4.24e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.669723450805       residual = 4.09e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.669723450902       residual = 1.14e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.669723450909       residual = 4.28e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 1.0000e+02 is 2.627870e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.255477 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.2040e+02
  </log>
  <optVariables href="FORM.s005.opt.xml">
ci_001                -7.050479e-01 3 1  ON 0
ci_002                -7.060270e-01 3 1  ON 1
ci_003                -3.795020e-02 3 1  ON 2
ci_004                -3.825190e-02 3 1  ON 3
ci_005                 1.562409e-02 3 1  ON 4
ci_006                 1.578689e-02 3 1  ON 5
ci_007                 1.235942e-02 3 1  ON 6
ci_008                 1.228635e-02 3 1  ON 7
ci_009                -1.184543e-02 3 1  ON 8
ci_010                -1.170840e-02 3 1  ON 9
ci_011                -7.845495e-03 3 1  ON 10
ci_012                -8.271045e-03 3 1  ON 11
ci_013                 9.526002e-03 3 1  ON 12
ci_014                 9.607233e-03 3 1  ON 13
ci_015                 1.227135e-02 3 1  ON 14
ci_016                 1.276397e-02 3 1  ON 15
ci_017                 1.119051e-02 3 1  ON 16
ci_018                 1.029890e-02 3 1  ON 17
ci_019                -3.467070e-03 3 1  ON 18
ci_020                -3.268782e-03 3 1  ON 19
ci_021                -8.873136e-03 3 1  ON 20
ci_022                -9.556120e-03 3 1  ON 21
ci_023                 7.610512e-03 3 1  ON 22
ci_024                 7.850451e-03 3 1  ON 23
ci_025                 3.969907e-03 3 1  ON 24
ci_026                 4.006844e-03 3 1  ON 25
ci_027                 6.728116e-03 3 1  ON 26
ci_028                 6.922509e-03 3 1  ON 27
ci_029                -4.888834e-03 3 1  ON 28
ci_030                -4.795398e-03 3 1  ON 29
ci_031                -8.099235e-03 3 1  ON 30
ci_032                -7.675222e-03 3 1  ON 31
ci_033                 4.360197e-03 3 1  ON 32
ci_034                 4.654313e-03 3 1  ON 33
ci_035                 1.453099e-03 3 1  ON 34
ci_036                 1.149345e-03 3 1  ON 35
ci_037                 4.884944e-03 3 1  ON 36
ci_038                 5.042400e-03 3 1  ON 37
ci_039                 5.368136e-03 3 1  ON 38
ci_040                 5.357739e-03 3 1  ON 39
ci_041                 5.239375e-03 3 1  ON 40
ci_042                 5.028741e-03 3 1  ON 41
ci_043                 4.526826e-03 3 1  ON 42
ci_044                 5.039789e-03 3 1  ON 43
ci_045                 3.425258e-03 3 1  ON 44
ci_046                 2.917063e-03 3 1  ON 45
ci_047                -6.405049e-04 3 1  ON 46
ci_048                -6.222694e-04 3 1  ON 47
ci_049                 1.463123e-03 3 1  ON 48
ci_050                 1.785281e-03 3 1  ON 49
ci_051                -1.514153e-03 3 1  ON 50
ci_052                -1.039886e-03 3 1  ON 51
ci_053                -2.885328e-03 3 1  ON 52
ci_054                -2.632799e-03 3 1  ON 53
ci_055                -1.379100e-03 3 1  ON 54
ci_056                -1.452418e-03 3 1  ON 55
ci_057                -1.362232e-03 3 1  ON 56
ci_058                -1.862258e-03 3 1  ON 57
ci_059                 3.180315e-04 3 1  ON 58
ci_060                 3.683392e-04 3 1  ON 59
ci_061                -1.254027e-04 3 1  ON 60
ci_062                -5.723558e-05 3 1  ON 61
ci_063                -4.492908e-04 3 1  ON 62
ci_064                -6.386699e-04 3 1  ON 63
ci_065                -2.270575e-03 3 1  ON 64
ci_066                -2.262068e-03 3 1  ON 65
ci_067                -2.085538e-03 3 1  ON 66
ci_068                -1.948295e-03 3 1  ON 67
ci_069                -2.577682e-04 3 1  ON 68
ci_070                -1.000099e-05 3 1  ON 69
ci_071                -2.288086e-03 3 1  ON 70
ci_072                -1.813790e-03 3 1  ON 71
ci_073                 3.243598e-04 3 1  ON 72
ci_074                 1.792059e-04 3 1  ON 73
ci_075                -4.167328e-04 3 1  ON 74
ci_076                -4.360734e-05 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="250">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =8000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 5
    time step          = 0.05
    reference energy   = -22.6118
    reference variance = 0.455155
====================================================
  Execution time = 1.0134e+02
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s005
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 62500 
  VMC Eavg = -2.2670e+01
  VMC Evar = 5.1418e-01
  Total weights = 7.8203e+06
  Execution time = 1.4519e+01
  </log>
</opt>
<opt stage="main" walkers="62500">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.500311233145
                                         uncertainty =       0.001962737161

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.500311233145
                                         uncertainty =       0.001962737161

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000250078136
  error estimate for blocks of size 2^( 2) =       0.000258918400
  error estimate for blocks of size 2^( 3) =       0.000266983980
  error estimate for blocks of size 2^( 4) =       0.000272805649
  error estimate for blocks of size 2^( 5) =       0.000275801153
  error estimate for blocks of size 2^( 6) =       0.000277454019
  error estimate for blocks of size 2^( 7) =       0.000278758916
  error estimate for blocks of size 2^( 8) =       0.000279515386
  error estimate for blocks of size 2^( 9) =       0.000280774655

      target function =                  N/A
              le_mean =     -22.669762511733
             les_mean =     514.432339168318
             stat err =       0.000279125744
             autocorr =       1.245800035180
              std dev =       0.707327784525
             le_variance =       0.500312594761

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.500307589007
                                         uncertainty =       0.001961448674

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.500307589007
                                         uncertainty =       0.001961448674

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000250077227
  error estimate for blocks of size 2^( 2) =       0.000258917359
  error estimate for blocks of size 2^( 3) =       0.000266982724
  error estimate for blocks of size 2^( 4) =       0.000272804353
  error estimate for blocks of size 2^( 5) =       0.000275799773
  error estimate for blocks of size 2^( 6) =       0.000277452297
  error estimate for blocks of size 2^( 7) =       0.000278757221
  error estimate for blocks of size 2^( 8) =       0.000279514042
  error estimate for blocks of size 2^( 9) =       0.000280773002

      target function =                  N/A
              le_mean =     -22.669762751816
             les_mean =     514.432373191096
             stat err =       0.000279124141
             autocorr =       1.245794787135
              std dev =       0.707325210852
             le_variance =       0.500308953907

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.500309311467
                                         uncertainty =       0.001962082382

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.500309311467
                                         uncertainty =       0.001962082382

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000250077657
  error estimate for blocks of size 2^( 2) =       0.000258917853
  error estimate for blocks of size 2^( 3) =       0.000266983322
  error estimate for blocks of size 2^( 4) =       0.000272804971
  error estimate for blocks of size 2^( 5) =       0.000275800432
  error estimate for blocks of size 2^( 6) =       0.000277453120
  error estimate for blocks of size 2^( 7) =       0.000278758032
  error estimate for blocks of size 2^( 8) =       0.000279514685
  error estimate for blocks of size 2^( 9) =       0.000280773797

      target function =                  N/A
              le_mean =     -22.669762628490
             les_mean =     514.432328531207
             stat err =       0.000279124908
             autocorr =       1.245797356079
              std dev =       0.707326427309
             le_variance =       0.500310674770

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.500310983303
                                         uncertainty =       0.001962654757

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.500310983303
                                         uncertainty =       0.001962654757

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000250078074
  error estimate for blocks of size 2^( 2) =       0.000258918329
  error estimate for blocks of size 2^( 3) =       0.000266983895
  error estimate for blocks of size 2^( 4) =       0.000272805562
  error estimate for blocks of size 2^( 5) =       0.000275801060
  error estimate for blocks of size 2^( 6) =       0.000277453905
  error estimate for blocks of size 2^( 7) =       0.000278758804
  error estimate for blocks of size 2^( 8) =       0.000279515297
  error estimate for blocks of size 2^( 9) =       0.000280774544

      target function =                  N/A
              le_mean =     -22.669762526235
             les_mean =     514.432331951845
             stat err =       0.000279125637
             autocorr =       1.245799703585
              std dev =       0.707327608066
             le_variance =       0.500312345133


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.669762511733        initial
     6.2500e+00     6.2500e+01             4.1131e-05       -22.669762751816  <--
     2.5000e+01     2.5000e+02             1.0465e-05       -22.669762628490
     1.0000e+02     1.0000e+03             2.6279e-06       -22.669762526235

*****************************************************************************
Applying the update for shift_i =   6.2500e+00     and shift_s =   6.2500e+01
*****************************************************************************

  Execution time = 1.7412e+02
  </log>
  <optVariables href="FORM.s005.opt.xml">
ci_001                -7.050484e-01 3 1  ON 0
ci_002                -7.060266e-01 3 1  ON 1
ci_003                -3.794380e-02 3 1  ON 2
ci_004                -3.824447e-02 3 1  ON 3
ci_005                 1.564238e-02 3 1  ON 4
ci_006                 1.578449e-02 3 1  ON 5
ci_007                 1.235390e-02 3 1  ON 6
ci_008                 1.228532e-02 3 1  ON 7
ci_009                -1.185693e-02 3 1  ON 8
ci_010                -1.170696e-02 3 1  ON 9
ci_011                -7.855790e-03 3 1  ON 10
ci_012                -8.260047e-03 3 1  ON 11
ci_013                 9.535697e-03 3 1  ON 12
ci_014                 9.608151e-03 3 1  ON 13
ci_015                 1.228412e-02 3 1  ON 14
ci_016                 1.275112e-02 3 1  ON 15
ci_017                 1.117521e-02 3 1  ON 16
ci_018                 1.031203e-02 3 1  ON 17
ci_019                -3.474867e-03 3 1  ON 18
ci_020                -3.273418e-03 3 1  ON 19
ci_021                -8.884995e-03 3 1  ON 20
ci_022                -9.556139e-03 3 1  ON 21
ci_023                 7.609998e-03 3 1  ON 22
ci_024                 7.859206e-03 3 1  ON 23
ci_025                 3.969580e-03 3 1  ON 24
ci_026                 4.005663e-03 3 1  ON 25
ci_027                 6.718540e-03 3 1  ON 26
ci_028                 6.922424e-03 3 1  ON 27
ci_029                -4.898305e-03 3 1  ON 28
ci_030                -4.783418e-03 3 1  ON 29
ci_031                -8.102383e-03 3 1  ON 30
ci_032                -7.682690e-03 3 1  ON 31
ci_033                 4.362268e-03 3 1  ON 32
ci_034                 4.634614e-03 3 1  ON 33
ci_035                 1.451508e-03 3 1  ON 34
ci_036                 1.158503e-03 3 1  ON 35
ci_037                 4.886665e-03 3 1  ON 36
ci_038                 5.025293e-03 3 1  ON 37
ci_039                 5.369478e-03 3 1  ON 38
ci_040                 5.352674e-03 3 1  ON 39
ci_041                 5.229357e-03 3 1  ON 40
ci_042                 5.035929e-03 3 1  ON 41
ci_043                 4.523665e-03 3 1  ON 42
ci_044                 5.036528e-03 3 1  ON 43
ci_045                 3.425030e-03 3 1  ON 44
ci_046                 2.922854e-03 3 1  ON 45
ci_047                -6.209117e-04 3 1  ON 46
ci_048                -6.171202e-04 3 1  ON 47
ci_049                 1.471868e-03 3 1  ON 48
ci_050                 1.775312e-03 3 1  ON 49
ci_051                -1.511948e-03 3 1  ON 50
ci_052                -1.037167e-03 3 1  ON 51
ci_053                -2.895528e-03 3 1  ON 52
ci_054                -2.639770e-03 3 1  ON 53
ci_055                -1.381693e-03 3 1  ON 54
ci_056                -1.449388e-03 3 1  ON 55
ci_057                -1.378159e-03 3 1  ON 56
ci_058                -1.851336e-03 3 1  ON 57
ci_059                 3.082371e-04 3 1  ON 58
ci_060                 3.638866e-04 3 1  ON 59
ci_061                -1.277181e-04 3 1  ON 60
ci_062                -5.616628e-05 3 1  ON 61
ci_063                -4.500596e-04 3 1  ON 62
ci_064                -6.693358e-04 3 1  ON 63
ci_065                -2.276257e-03 3 1  ON 64
ci_066                -2.260167e-03 3 1  ON 65
ci_067                -2.094263e-03 3 1  ON 66
ci_068                -1.956416e-03 3 1  ON 67
ci_069                -2.708141e-04 3 1  ON 68
ci_070                -8.914710e-06 3 1  ON 69
ci_071                -2.297221e-03 3 1  ON 70
ci_072                -1.826400e-03 3 1  ON 71
ci_073                 3.233255e-04 3 1  ON 72
ci_074                 1.951962e-04 3 1  ON 73
ci_075                -4.162557e-04 3 1  ON 74
ci_076                -4.070876e-05 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 2.9453e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s006 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s006 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=6  my_counter=0
  time step      = 5.0000e-02
  blocks         = 250
  steps          = 250
  substeps       = 10
  current        = 0
  target samples = 8.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">250</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">6.2500e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">8.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">6.2500e+04</parameter>
<parameter name="steps" condition="int">250</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2692e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="250">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =8000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 6
    time step          = 0.05
    reference energy   = -22.5394
    reference variance = 0.3832
====================================================
  Execution time = 1.0151e+02
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s006
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 62500 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 6.1079e+04
  VMC Eavg = -2.2669e+01
  VMC Evar = 5.1068e-01
  Total weights = 7.820513822e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.8851e+01
  </log>
</opt>
<opt stage="main" walkers="62500">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.498370759529
                                         uncertainty =       0.001520030726

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.498370759529
                                         uncertainty =       0.001520030726

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000249592482
  error estimate for blocks of size 2^( 2) =       0.000258565470
  error estimate for blocks of size 2^( 3) =       0.000266395294
  error estimate for blocks of size 2^( 4) =       0.000272090785
  error estimate for blocks of size 2^( 5) =       0.000275635187
  error estimate for blocks of size 2^( 6) =       0.000277796292
  error estimate for blocks of size 2^( 7) =       0.000279144579
  error estimate for blocks of size 2^( 8) =       0.000279394365
  error estimate for blocks of size 2^( 9) =       0.000281056597

      target function =                  N/A
              le_mean =     -22.669457293615
             les_mean =     514.414969447244
             stat err =       0.000279347958
             autocorr =       1.252644980664
              std dev =       0.705954146138
             le_variance =       0.498371256450


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266945729362e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5625e+00, overlap shift 1.5625e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.669457293640       residual = 3.24e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.669458104877       residual = 4.08e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.669458095773       residual = 1.58e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.669458104324       residual = 5.03e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 1.5625e+00 is 1.025449e-04

solving harmonic davidson linear method for identity shift 6.2500e+00, overlap shift 6.2500e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.669457293640       residual = 3.24e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.669457513539       residual = 4.31e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.669457510977       residual = 1.68e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.669457513381       residual = 6.30e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 6.2500e+00 is 2.873234e-05

solving harmonic davidson linear method for identity shift 2.5000e+01, overlap shift 2.5000e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.669457293640       residual = 3.24e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.669457349798       residual = 4.44e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.669457349153       residual = 1.76e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.669457349772       residual = 6.78e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 2.5000e+01 is 7.407299e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.256869 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.2038e+02
  </log>
  <optVariables href="FORM.s006.opt.xml">
ci_001                -7.050454e-01 3 1  ON 0
ci_002                -7.060305e-01 3 1  ON 1
ci_003                -3.795016e-02 3 1  ON 2
ci_004                -3.823830e-02 3 1  ON 3
ci_005                 1.564847e-02 3 1  ON 4
ci_006                 1.578061e-02 3 1  ON 5
ci_007                 1.234434e-02 3 1  ON 6
ci_008                 1.227654e-02 3 1  ON 7
ci_009                -1.184816e-02 3 1  ON 8
ci_010                -1.171172e-02 3 1  ON 9
ci_011                -7.858498e-03 3 1  ON 10
ci_012                -8.255981e-03 3 1  ON 11
ci_013                 9.515669e-03 3 1  ON 12
ci_014                 9.598409e-03 3 1  ON 13
ci_015                 1.228422e-02 3 1  ON 14
ci_016                 1.274164e-02 3 1  ON 15
ci_017                 1.117782e-02 3 1  ON 16
ci_018                 1.030899e-02 3 1  ON 17
ci_019                -3.482263e-03 3 1  ON 18
ci_020                -3.290924e-03 3 1  ON 19
ci_021                -8.879336e-03 3 1  ON 20
ci_022                -9.545093e-03 3 1  ON 21
ci_023                 7.612303e-03 3 1  ON 22
ci_024                 7.870765e-03 3 1  ON 23
ci_025                 3.976450e-03 3 1  ON 24
ci_026                 4.011852e-03 3 1  ON 25
ci_027                 6.714624e-03 3 1  ON 26
ci_028                 6.893692e-03 3 1  ON 27
ci_029                -4.895387e-03 3 1  ON 28
ci_030                -4.778716e-03 3 1  ON 29
ci_031                -8.098693e-03 3 1  ON 30
ci_032                -7.677470e-03 3 1  ON 31
ci_033                 4.376071e-03 3 1  ON 32
ci_034                 4.635377e-03 3 1  ON 33
ci_035                 1.430766e-03 3 1  ON 34
ci_036                 1.153135e-03 3 1  ON 35
ci_037                 4.893953e-03 3 1  ON 36
ci_038                 5.014912e-03 3 1  ON 37
ci_039                 5.381814e-03 3 1  ON 38
ci_040                 5.379117e-03 3 1  ON 39
ci_041                 5.226273e-03 3 1  ON 40
ci_042                 5.049343e-03 3 1  ON 41
ci_043                 4.536886e-03 3 1  ON 42
ci_044                 5.057958e-03 3 1  ON 43
ci_045                 3.430318e-03 3 1  ON 44
ci_046                 2.906850e-03 3 1  ON 45
ci_047                -6.272350e-04 3 1  ON 46
ci_048                -6.271234e-04 3 1  ON 47
ci_049                 1.470126e-03 3 1  ON 48
ci_050                 1.768204e-03 3 1  ON 49
ci_051                -1.495928e-03 3 1  ON 50
ci_052                -1.036769e-03 3 1  ON 51
ci_053                -2.882180e-03 3 1  ON 52
ci_054                -2.626469e-03 3 1  ON 53
ci_055                -1.376256e-03 3 1  ON 54
ci_056                -1.450749e-03 3 1  ON 55
ci_057                -1.368181e-03 3 1  ON 56
ci_058                -1.848472e-03 3 1  ON 57
ci_059                 3.200172e-04 3 1  ON 58
ci_060                 3.580974e-04 3 1  ON 59
ci_061                -1.093164e-04 3 1  ON 60
ci_062                -3.489976e-05 3 1  ON 61
ci_063                -4.308340e-04 3 1  ON 62
ci_064                -6.769644e-04 3 1  ON 63
ci_065                -2.266929e-03 3 1  ON 64
ci_066                -2.250008e-03 3 1  ON 65
ci_067                -2.087326e-03 3 1  ON 66
ci_068                -1.973137e-03 3 1  ON 67
ci_069                -2.710841e-04 3 1  ON 68
ci_070                -3.052515e-07 3 1  ON 69
ci_071                -2.284734e-03 3 1  ON 70
ci_072                -1.841350e-03 3 1  ON 71
ci_073                 3.140276e-04 3 1  ON 72
ci_074                 1.931420e-04 3 1  ON 73
ci_075                -4.238043e-04 3 1  ON 74
ci_076                -3.999625e-05 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="250">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =8000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 6
    time step          = 0.05
    reference energy   = -22.7772
    reference variance = 0.628625
====================================================
  Execution time = 1.0146e+02
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s006
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 62500 
  VMC Eavg = -2.2670e+01
  VMC Evar = 5.1132e-01
  Total weights = 7.8215e+06
  Execution time = 1.4517e+01
  </log>
</opt>
<opt stage="main" walkers="62500">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.498929354146
                                         uncertainty =       0.001620936572

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.498929354146
                                         uncertainty =       0.001620936572

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000249731883
  error estimate for blocks of size 2^( 2) =       0.000258663579
  error estimate for blocks of size 2^( 3) =       0.000266680625
  error estimate for blocks of size 2^( 4) =       0.000272493244
  error estimate for blocks of size 2^( 5) =       0.000275698709
  error estimate for blocks of size 2^( 6) =       0.000277106645
  error estimate for blocks of size 2^( 7) =       0.000277645660
  error estimate for blocks of size 2^( 8) =       0.000278435417
  error estimate for blocks of size 2^( 9) =       0.000278705436

      target function =                  N/A
              le_mean =     -22.670107922133
             les_mean =     514.448310967828
             stat err =       0.000277973289
             autocorr =       1.238962461637
              std dev =       0.706348432008
             le_variance =       0.498928107400

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.498914808338
                                         uncertainty =       0.001621182821

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.498914808338
                                         uncertainty =       0.001621182821

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000249728240
  error estimate for blocks of size 2^( 2) =       0.000258659819
  error estimate for blocks of size 2^( 3) =       0.000266677052
  error estimate for blocks of size 2^( 4) =       0.000272489741
  error estimate for blocks of size 2^( 5) =       0.000275695115
  error estimate for blocks of size 2^( 6) =       0.000277102190
  error estimate for blocks of size 2^( 7) =       0.000277641579
  error estimate for blocks of size 2^( 8) =       0.000278431685
  error estimate for blocks of size 2^( 9) =       0.000278701726

      target function =                  N/A
              le_mean =     -22.670108175930
             les_mean =     514.446529862040
             stat err =       0.000277969295
             autocorr =       1.238963003725
              std dev =       0.706338128330
             le_variance =       0.498913551533

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.498921097811
                                         uncertainty =       0.001621067810

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.498921097811
                                         uncertainty =       0.001621067810

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000249729815
  error estimate for blocks of size 2^( 2) =       0.000258661455
  error estimate for blocks of size 2^( 3) =       0.000266678609
  error estimate for blocks of size 2^( 4) =       0.000272491309
  error estimate for blocks of size 2^( 5) =       0.000275696736
  error estimate for blocks of size 2^( 6) =       0.000277104191
  error estimate for blocks of size 2^( 7) =       0.000277643420
  error estimate for blocks of size 2^( 8) =       0.000278433408
  error estimate for blocks of size 2^( 9) =       0.000278703536

      target function =                  N/A
              le_mean =     -22.670108007327
             les_mean =     514.445195124153
             stat err =       0.000277971139
             autocorr =       1.238963806199
              std dev =       0.706342583697
             le_variance =       0.498919845543

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.498928231394
                                         uncertainty =       0.001620952115

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.498928231394
                                         uncertainty =       0.001620952115

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000249731602
  error estimate for blocks of size 2^( 2) =       0.000258663300
  error estimate for blocks of size 2^( 3) =       0.000266680364
  error estimate for blocks of size 2^( 4) =       0.000272493037
  error estimate for blocks of size 2^( 5) =       0.000275698550
  error estimate for blocks of size 2^( 6) =       0.000277106351
  error estimate for blocks of size 2^( 7) =       0.000277645397
  error estimate for blocks of size 2^( 8) =       0.000278435269
  error estimate for blocks of size 2^( 9) =       0.000278705410

      target function =                  N/A
              le_mean =     -22.670107869034
             les_mean =     514.445237556984
             stat err =       0.000277973107
             autocorr =       1.238963627081
              std dev =       0.706347636766
             le_variance =       0.498926983965


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.670107922133        initial
     1.5625e+00     1.5625e+01             1.0254e-04       -22.670108175930  <--
     6.2500e+00     6.2500e+01             2.8732e-05       -22.670108007327
     2.5000e+01     2.5000e+02             7.4073e-06       -22.670107869034

*****************************************************************************
Applying the update for shift_i =   1.5625e+00     and shift_s =   1.5625e+01
*****************************************************************************

  Execution time = 1.7422e+02
  </log>
  <optVariables href="FORM.s006.opt.xml">
ci_001                -7.050363e-01 3 1  ON 0
ci_002                -7.060421e-01 3 1  ON 1
ci_003                -3.796830e-02 3 1  ON 2
ci_004                -3.822012e-02 3 1  ON 3
ci_005                 1.566446e-02 3 1  ON 4
ci_006                 1.577050e-02 3 1  ON 5
ci_007                 1.231744e-02 3 1  ON 6
ci_008                 1.225305e-02 3 1  ON 7
ci_009                -1.182398e-02 3 1  ON 8
ci_010                -1.172492e-02 3 1  ON 9
ci_011                -7.866870e-03 3 1  ON 10
ci_012                -8.246217e-03 3 1  ON 11
ci_013                 9.460687e-03 3 1  ON 12
ci_014                 9.571037e-03 3 1  ON 13
ci_015                 1.228481e-02 3 1  ON 14
ci_016                 1.271522e-02 3 1  ON 15
ci_017                 1.118533e-02 3 1  ON 16
ci_018                 1.030076e-02 3 1  ON 17
ci_019                -3.503509e-03 3 1  ON 18
ci_020                -3.340460e-03 3 1  ON 19
ci_021                -8.863916e-03 3 1  ON 20
ci_022                -9.514712e-03 3 1  ON 21
ci_023                 7.618503e-03 3 1  ON 22
ci_024                 7.901900e-03 3 1  ON 23
ci_025                 3.995962e-03 3 1  ON 24
ci_026                 4.029835e-03 3 1  ON 25
ci_027                 6.704518e-03 3 1  ON 26
ci_028                 6.819879e-03 3 1  ON 27
ci_029                -4.887536e-03 3 1  ON 28
ci_030                -4.766458e-03 3 1  ON 29
ci_031                -8.088633e-03 3 1  ON 30
ci_032                -7.663087e-03 3 1  ON 31
ci_033                 4.413781e-03 3 1  ON 32
ci_034                 4.638117e-03 3 1  ON 33
ci_035                 1.377917e-03 3 1  ON 34
ci_036                 1.139124e-03 3 1  ON 35
ci_037                 4.913129e-03 3 1  ON 36
ci_038                 4.986289e-03 3 1  ON 37
ci_039                 5.413570e-03 3 1  ON 38
ci_040                 5.447382e-03 3 1  ON 39
ci_041                 5.217956e-03 3 1  ON 40
ci_042                 5.084764e-03 3 1  ON 41
ci_043                 4.572593e-03 3 1  ON 42
ci_044                 5.115866e-03 3 1  ON 43
ci_045                 3.444312e-03 3 1  ON 44
ci_046                 2.863311e-03 3 1  ON 45
ci_047                -6.433601e-04 3 1  ON 46
ci_048                -6.526964e-04 3 1  ON 47
ci_049                 1.465320e-03 3 1  ON 48
ci_050                 1.748628e-03 3 1  ON 49
ci_051                -1.452186e-03 3 1  ON 50
ci_052                -1.034747e-03 3 1  ON 51
ci_053                -2.845508e-03 3 1  ON 52
ci_054                -2.590272e-03 3 1  ON 53
ci_055                -1.362034e-03 3 1  ON 54
ci_056                -1.454698e-03 3 1  ON 55
ci_057                -1.341144e-03 3 1  ON 56
ci_058                -1.840879e-03 3 1  ON 57
ci_059                 3.506707e-04 3 1  ON 58
ci_060                 3.430262e-04 3 1  ON 59
ci_061                -5.916832e-05 3 1  ON 60
ci_062                 2.273839e-05 3 1  ON 61
ci_063                -3.788969e-04 3 1  ON 62
ci_064                -6.984721e-04 3 1  ON 63
ci_065                -2.241537e-03 3 1  ON 64
ci_066                -2.222710e-03 3 1  ON 65
ci_067                -2.068634e-03 3 1  ON 66
ci_068                -2.018978e-03 3 1  ON 67
ci_069                -2.719402e-04 3 1  ON 68
ci_070                 2.271834e-05 3 1  ON 69
ci_071                -2.251182e-03 3 1  ON 70
ci_072                -1.881773e-03 3 1  ON 71
ci_073                 2.896588e-04 3 1  ON 72
ci_074                 1.882433e-04 3 1  ON 73
ci_075                -4.442452e-04 3 1  ON 74
ci_076                -3.847526e-05 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 2.9463e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s007 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s007 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=7  my_counter=0
  time step      = 5.0000e-02
  blocks         = 250
  steps          = 250
  substeps       = 10
  current        = 0
  target samples = 8.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">250</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">6.2500e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">8.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">6.2500e+04</parameter>
<parameter name="steps" condition="int">250</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2687e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="250">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =8000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 7
    time step          = 0.05
    reference energy   = -22.716
    reference variance = 0.367904
====================================================
  Execution time = 1.0168e+02
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s007
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 62500 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 6.1090e+04
  VMC Eavg = -2.2670e+01
  VMC Evar = 5.1152e-01
  Total weights = 7.821199360e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.8937e+01
  </log>
</opt>
<opt stage="main" walkers="62500">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.496547418627
                                         uncertainty =       0.001303698109

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.496547418627
                                         uncertainty =       0.001303698109

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000249135925
  error estimate for blocks of size 2^( 2) =       0.000258007678
  error estimate for blocks of size 2^( 3) =       0.000266038059
  error estimate for blocks of size 2^( 4) =       0.000271783310
  error estimate for blocks of size 2^( 5) =       0.000275278787
  error estimate for blocks of size 2^( 6) =       0.000276778030
  error estimate for blocks of size 2^( 7) =       0.000278386884
  error estimate for blocks of size 2^( 8) =       0.000279023352
  error estimate for blocks of size 2^( 9) =       0.000277947905

      target function =                  N/A
              le_mean =     -22.670112288035
             les_mean =     514.445509614720
             stat err =       0.000278034043
             autocorr =       1.245441222108
              std dev =       0.704662807834
             le_variance =       0.496549672744


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.267011228804e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.9062e-01, overlap shift 3.9062e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.670112288064       residual = 2.80e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.670113208927       residual = 4.15e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.670112923037       residual = 1.62e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.670112920465       residual = 6.13e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 3.9062e-01 is 2.670870e-04

solving harmonic davidson linear method for identity shift 1.5625e+00, overlap shift 1.5625e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.670112288064       residual = 2.80e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.670112584877       residual = 3.11e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.670112525272       residual = 1.14e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.670112534159       residual = 3.27e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 1.5625e+00 is 7.928503e-05

solving harmonic davidson linear method for identity shift 6.2500e+00, overlap shift 6.2500e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.670112288064       residual = 2.80e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.670112368052       residual = 3.49e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.670112356108       residual = 1.41e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.670112358698       residual = 4.27e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 6.2500e+00 is 2.116986e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.258288 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.2063e+02
  </log>
  <optVariables href="FORM.s007.opt.xml">
ci_001                -7.050631e-01 3 1  ON 0
ci_002                -7.060214e-01 3 1  ON 1
ci_003                -3.798418e-02 3 1  ON 2
ci_004                -3.817012e-02 3 1  ON 3
ci_005                 1.565375e-02 3 1  ON 4
ci_006                 1.577159e-02 3 1  ON 5
ci_007                 1.231991e-02 3 1  ON 6
ci_008                 1.219624e-02 3 1  ON 7
ci_009                -1.178058e-02 3 1  ON 8
ci_010                -1.177082e-02 3 1  ON 9
ci_011                -7.871950e-03 3 1  ON 10
ci_012                -8.231522e-03 3 1  ON 11
ci_013                 9.434790e-03 3 1  ON 12
ci_014                 9.596582e-03 3 1  ON 13
ci_015                 1.228715e-02 3 1  ON 14
ci_016                 1.273977e-02 3 1  ON 15
ci_017                 1.120514e-02 3 1  ON 16
ci_018                 1.030819e-02 3 1  ON 17
ci_019                -3.526192e-03 3 1  ON 18
ci_020                -3.326786e-03 3 1  ON 19
ci_021                -8.824034e-03 3 1  ON 20
ci_022                -9.454391e-03 3 1  ON 21
ci_023                 7.696484e-03 3 1  ON 22
ci_024                 7.888351e-03 3 1  ON 23
ci_025                 3.968976e-03 3 1  ON 24
ci_026                 4.058815e-03 3 1  ON 25
ci_027                 6.646972e-03 3 1  ON 26
ci_028                 6.781280e-03 3 1  ON 27
ci_029                -4.841892e-03 3 1  ON 28
ci_030                -4.706487e-03 3 1  ON 29
ci_031                -8.167918e-03 3 1  ON 30
ci_032                -7.598794e-03 3 1  ON 31
ci_033                 4.389248e-03 3 1  ON 32
ci_034                 4.648937e-03 3 1  ON 33
ci_035                 1.319199e-03 3 1  ON 34
ci_036                 1.118624e-03 3 1  ON 35
ci_037                 4.958943e-03 3 1  ON 36
ci_038                 4.955641e-03 3 1  ON 37
ci_039                 5.392357e-03 3 1  ON 38
ci_040                 5.402064e-03 3 1  ON 39
ci_041                 5.180988e-03 3 1  ON 40
ci_042                 5.082806e-03 3 1  ON 41
ci_043                 4.574559e-03 3 1  ON 42
ci_044                 5.052014e-03 3 1  ON 43
ci_045                 3.402417e-03 3 1  ON 44
ci_046                 2.843951e-03 3 1  ON 45
ci_047                -5.823614e-04 3 1  ON 46
ci_048                -6.720309e-04 3 1  ON 47
ci_049                 1.475442e-03 3 1  ON 48
ci_050                 1.797602e-03 3 1  ON 49
ci_051                -1.468706e-03 3 1  ON 50
ci_052                -1.081562e-03 3 1  ON 51
ci_053                -2.792145e-03 3 1  ON 52
ci_054                -2.634452e-03 3 1  ON 53
ci_055                -1.362256e-03 3 1  ON 54
ci_056                -1.424520e-03 3 1  ON 55
ci_057                -1.332868e-03 3 1  ON 56
ci_058                -1.827716e-03 3 1  ON 57
ci_059                 3.584713e-04 3 1  ON 58
ci_060                 3.159838e-04 3 1  ON 59
ci_061                -2.435279e-06 3 1  ON 60
ci_062                -3.736407e-05 3 1  ON 61
ci_063                -3.554585e-04 3 1  ON 62
ci_064                -7.507308e-04 3 1  ON 63
ci_065                -2.266614e-03 3 1  ON 64
ci_066                -2.195379e-03 3 1  ON 65
ci_067                -2.048295e-03 3 1  ON 66
ci_068                -1.995978e-03 3 1  ON 67
ci_069                -2.393099e-04 3 1  ON 68
ci_070                 2.893300e-05 3 1  ON 69
ci_071                -2.241915e-03 3 1  ON 70
ci_072                -1.826510e-03 3 1  ON 71
ci_073                 3.253853e-04 3 1  ON 72
ci_074                 1.922381e-04 3 1  ON 73
ci_075                -4.141711e-04 3 1  ON 74
ci_076                -8.031766e-05 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="250">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =8000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 7
    time step          = 0.05
    reference energy   = -22.7164
    reference variance = 1.22685
====================================================
  Execution time = 1.0162e+02
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s007
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 62500 
  VMC Eavg = -2.2670e+01
  VMC Evar = 5.0970e-01
  Total weights = 7.8207e+06
  Execution time = 1.4541e+01
  </log>
</opt>
<opt stage="main" walkers="62500">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.497488398568
                                         uncertainty =       0.001218784955

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.497488398568
                                         uncertainty =       0.001218784955

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000249371042
  error estimate for blocks of size 2^( 2) =       0.000258395851
  error estimate for blocks of size 2^( 3) =       0.000266298274
  error estimate for blocks of size 2^( 4) =       0.000271930817
  error estimate for blocks of size 2^( 5) =       0.000274989451
  error estimate for blocks of size 2^( 6) =       0.000276452891
  error estimate for blocks of size 2^( 7) =       0.000277818100
  error estimate for blocks of size 2^( 8) =       0.000278281095
  error estimate for blocks of size 2^( 9) =       0.000278614444

      target function =                  N/A
              le_mean =     -22.669551055638
             les_mean =     514.418524334480
             stat err =       0.000277791632
             autocorr =       1.240927134366
              std dev =       0.705327818221
             le_variance =       0.497487331156

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.497496532773
                                         uncertainty =       0.001218252777

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.497496532773
                                         uncertainty =       0.001218252777

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000249373085
  error estimate for blocks of size 2^( 2) =       0.000258398629
  error estimate for blocks of size 2^( 3) =       0.000266301982
  error estimate for blocks of size 2^( 4) =       0.000271935305
  error estimate for blocks of size 2^( 5) =       0.000274993229
  error estimate for blocks of size 2^( 6) =       0.000276454997
  error estimate for blocks of size 2^( 7) =       0.000277821916
  error estimate for blocks of size 2^( 8) =       0.000278289394
  error estimate for blocks of size 2^( 9) =       0.000278613263

      target function =                  N/A
              le_mean =     -22.669551066342
             les_mean =     514.420269998793
             stat err =       0.000277794892
             autocorr =       1.240935920237
              std dev =       0.705333597870
             le_variance =       0.497495484284

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.497489391253
                                         uncertainty =       0.001218304897

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.497489391253
                                         uncertainty =       0.001218304897

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000249371294
  error estimate for blocks of size 2^( 2) =       0.000258396645
  error estimate for blocks of size 2^( 3) =       0.000266299681
  error estimate for blocks of size 2^( 4) =       0.000271932867
  error estimate for blocks of size 2^( 5) =       0.000274991086
  error estimate for blocks of size 2^( 6) =       0.000276453785
  error estimate for blocks of size 2^( 7) =       0.000277819891
  error estimate for blocks of size 2^( 8) =       0.000278285864
  error estimate for blocks of size 2^( 9) =       0.000278612499

      target function =                  N/A
              le_mean =     -22.669550506560
             les_mean =     514.422441267363
             stat err =       0.000277793010
             autocorr =       1.240936930871
              std dev =       0.705328531415
             le_variance =       0.497488337228

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.497487807530
                                         uncertainty =       0.001218706192

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.497487807530
                                         uncertainty =       0.001218706192

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000249370894
  error estimate for blocks of size 2^( 2) =       0.000258395786
  error estimate for blocks of size 2^( 3) =       0.000266298296
  error estimate for blocks of size 2^( 4) =       0.000271930917
  error estimate for blocks of size 2^( 5) =       0.000274989488
  error estimate for blocks of size 2^( 6) =       0.000276452765
  error estimate for blocks of size 2^( 7) =       0.000277818116
  error estimate for blocks of size 2^( 8) =       0.000278281519
  error estimate for blocks of size 2^( 9) =       0.000278613966

      target function =                  N/A
              le_mean =     -22.669550919672
             les_mean =     514.418529064056
             stat err =       0.000277791592
             autocorr =       1.240928239207
              std dev =       0.705327400589
             le_variance =       0.497486742021


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.669551055638        initial
     3.9062e-01     3.9062e+00             2.6709e-04       -22.669551066342  <--
     1.5625e+00     1.5625e+01             7.9285e-05       -22.669550506560
     6.2500e+00     6.2500e+01             2.1170e-05       -22.669550919672

*****************************************************************************
Applying the update for shift_i =   3.9062e-01     and shift_s =   3.9062e+00
*****************************************************************************

  Execution time = 1.7449e+02
  </log>
  <optVariables href="FORM.s007.opt.xml">
ci_001                -7.051416e-01 3 1  ON 0
ci_002                -7.059565e-01 3 1  ON 1
ci_003                -3.802459e-02 3 1  ON 2
ci_004                -3.803391e-02 3 1  ON 3
ci_005                 1.563396e-02 3 1  ON 4
ci_006                 1.577517e-02 3 1  ON 5
ci_007                 1.232527e-02 3 1  ON 6
ci_008                 1.207527e-02 3 1  ON 7
ci_009                -1.168189e-02 3 1  ON 8
ci_010                -1.186630e-02 3 1  ON 9
ci_011                -7.889569e-03 3 1  ON 10
ci_012                -8.190831e-03 3 1  ON 11
ci_013                 9.381081e-03 3 1  ON 12
ci_014                 9.647844e-03 3 1  ON 13
ci_015                 1.229319e-02 3 1  ON 14
ci_016                 1.279741e-02 3 1  ON 15
ci_017                 1.124863e-02 3 1  ON 16
ci_018                 1.032703e-02 3 1  ON 17
ci_019                -3.577358e-03 3 1  ON 18
ci_020                -3.302084e-03 3 1  ON 19
ci_021                -8.721481e-03 3 1  ON 20
ci_022                -9.324080e-03 3 1  ON 21
ci_023                 7.855009e-03 3 1  ON 22
ci_024                 7.862457e-03 3 1  ON 23
ci_025                 3.910617e-03 3 1  ON 24
ci_026                 4.124692e-03 3 1  ON 25
ci_027                 6.545921e-03 3 1  ON 26
ci_028                 6.714857e-03 3 1  ON 27
ci_029                -4.735906e-03 3 1  ON 28
ci_030                -4.584866e-03 3 1  ON 29
ci_031                -8.355720e-03 3 1  ON 30
ci_032                -7.460770e-03 3 1  ON 31
ci_033                 4.339542e-03 3 1  ON 32
ci_034                 4.674277e-03 3 1  ON 33
ci_035                 1.217347e-03 3 1  ON 34
ci_036                 1.080796e-03 3 1  ON 35
ci_037                 5.054920e-03 3 1  ON 36
ci_038                 4.891962e-03 3 1  ON 37
ci_039                 5.356205e-03 3 1  ON 38
ci_040                 5.321835e-03 3 1  ON 39
ci_041                 5.108878e-03 3 1  ON 40
ci_042                 5.079467e-03 3 1  ON 41
ci_043                 4.579549e-03 3 1  ON 42
ci_044                 4.917888e-03 3 1  ON 43
ci_045                 3.315847e-03 3 1  ON 44
ci_046                 2.801626e-03 3 1  ON 45
ci_047                -4.764852e-04 3 1  ON 46
ci_048                -7.067600e-04 3 1  ON 47
ci_049                 1.496532e-03 3 1  ON 48
ci_050                 1.900350e-03 3 1  ON 49
ci_051                -1.502619e-03 3 1  ON 50
ci_052                -1.183723e-03 3 1  ON 51
ci_053                -2.676349e-03 3 1  ON 52
ci_054                -2.732181e-03 3 1  ON 53
ci_055                -1.359735e-03 3 1  ON 54
ci_056                -1.361112e-03 3 1  ON 55
ci_057                -1.314928e-03 3 1  ON 56
ci_058                -1.802458e-03 3 1  ON 57
ci_059                 3.699578e-04 3 1  ON 58
ci_060                 2.650172e-04 3 1  ON 59
ci_061                 1.168152e-04 3 1  ON 60
ci_062                -1.647637e-04 3 1  ON 61
ci_063                -3.078540e-04 3 1  ON 62
ci_064                -8.612413e-04 3 1  ON 63
ci_065                -2.323143e-03 3 1  ON 64
ci_066                -2.146018e-03 3 1  ON 65
ci_067                -2.003129e-03 3 1  ON 66
ci_068                -1.949430e-03 3 1  ON 67
ci_069                -1.727658e-04 3 1  ON 68
ci_070                 4.143124e-05 3 1  ON 69
ci_071                -2.220544e-03 3 1  ON 70
ci_072                -1.703746e-03 3 1  ON 71
ci_073                 3.893439e-04 3 1  ON 72
ci_074                 2.011833e-04 3 1  ON 73
ci_075                -3.527779e-04 3 1  ON 74
ci_076                -1.659362e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 2.9513e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s008 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s008 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=8  my_counter=0
  time step      = 5.0000e-02
  blocks         = 250
  steps          = 250
  substeps       = 10
  current        = 0
  target samples = 8.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">250</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">6.2500e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">8.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">6.2500e+04</parameter>
<parameter name="steps" condition="int">250</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2691e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="250">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =8000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 8
    time step          = 0.05
    reference energy   = -22.695
    reference variance = 0.339517
====================================================
  Execution time = 1.0172e+02
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s008
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 62500 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 6.1062e+04
  VMC Eavg = -2.2670e+01
  VMC Evar = 5.1028e-01
  Total weights = 7.820493114e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.9007e+01
  </log>
</opt>
<opt stage="main" walkers="62500">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.499423815830
                                         uncertainty =       0.001352038192

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.499423815830
                                         uncertainty =       0.001352038192

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000249855995
  error estimate for blocks of size 2^( 2) =       0.000258832514
  error estimate for blocks of size 2^( 3) =       0.000266767338
  error estimate for blocks of size 2^( 4) =       0.000272628974
  error estimate for blocks of size 2^( 5) =       0.000275774151
  error estimate for blocks of size 2^( 6) =       0.000277412305
  error estimate for blocks of size 2^( 7) =       0.000278890014
  error estimate for blocks of size 2^( 8) =       0.000279741316
  error estimate for blocks of size 2^( 9) =       0.000280044386

      target function =                  N/A
              le_mean =     -22.670324354804
             les_mean =     514.453885031160
             stat err =       0.000279022005
             autocorr =       1.247088757902
              std dev =       0.706699472639
             le_variance =       0.499424144628


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.267032435480e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.7656e-02, overlap shift 9.7656e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.670324354826       residual = 3.55e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.670325395001       residual = 1.59e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.670325928133       residual = 9.02e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.670326028995       residual = 7.61e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 9.7656e-02 is 7.571475e-04

solving harmonic davidson linear method for identity shift 3.9062e-01, overlap shift 3.9062e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.670324354826       residual = 3.55e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.670324845448       residual = 6.42e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.670325042841       residual = 2.83e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.670325063848       residual = 8.00e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 3.9062e-01 is 3.327241e-04

solving harmonic davidson linear method for identity shift 1.5625e+00, overlap shift 1.5625e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.670324354826       residual = 3.55e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.670324512414       residual = 5.18e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.670324566278       residual = 2.13e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.670324572167       residual = 4.84e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 1.5625e+00 is 1.028102e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.259671 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.2075e+02
  </log>
  <optVariables href="FORM.s008.opt.xml">
ci_001                -7.051020e-01 3 1  ON 0
ci_002                -7.060112e-01 3 1  ON 1
ci_003                -3.788412e-02 3 1  ON 2
ci_004                -3.802035e-02 3 1  ON 3
ci_005                 1.560066e-02 3 1  ON 4
ci_006                 1.582739e-02 3 1  ON 5
ci_007                 1.255988e-02 3 1  ON 6
ci_008                 1.212153e-02 3 1  ON 7
ci_009                -1.161344e-02 3 1  ON 8
ci_010                -1.171059e-02 3 1  ON 9
ci_011                -7.885205e-03 3 1  ON 10
ci_012                -8.066306e-03 3 1  ON 11
ci_013                 9.424610e-03 3 1  ON 12
ci_014                 9.721835e-03 3 1  ON 13
ci_015                 1.223084e-02 3 1  ON 14
ci_016                 1.273999e-02 3 1  ON 15
ci_017                 1.091590e-02 3 1  ON 16
ci_018                 1.044287e-02 3 1  ON 17
ci_019                -3.590817e-03 3 1  ON 18
ci_020                -3.433087e-03 3 1  ON 19
ci_021                -8.921542e-03 3 1  ON 20
ci_022                -9.079024e-03 3 1  ON 21
ci_023                 7.863215e-03 3 1  ON 22
ci_024                 7.780843e-03 3 1  ON 23
ci_025                 3.907244e-03 3 1  ON 24
ci_026                 4.224015e-03 3 1  ON 25
ci_027                 6.629903e-03 3 1  ON 26
ci_028                 6.671530e-03 3 1  ON 27
ci_029                -4.677989e-03 3 1  ON 28
ci_030                -4.867883e-03 3 1  ON 29
ci_031                -8.330761e-03 3 1  ON 30
ci_032                -7.641507e-03 3 1  ON 31
ci_033                 4.379457e-03 3 1  ON 32
ci_034                 4.414347e-03 3 1  ON 33
ci_035                 1.144189e-03 3 1  ON 34
ci_036                 1.166945e-03 3 1  ON 35
ci_037                 4.878319e-03 3 1  ON 36
ci_038                 4.786347e-03 3 1  ON 37
ci_039                 5.322774e-03 3 1  ON 38
ci_040                 5.257762e-03 3 1  ON 39
ci_041                 5.146220e-03 3 1  ON 40
ci_042                 5.126504e-03 3 1  ON 41
ci_043                 4.574062e-03 3 1  ON 42
ci_044                 4.720176e-03 3 1  ON 43
ci_045                 3.184294e-03 3 1  ON 44
ci_046                 2.835772e-03 3 1  ON 45
ci_047                -5.929336e-04 3 1  ON 46
ci_048                -6.985488e-04 3 1  ON 47
ci_049                 1.556139e-03 3 1  ON 48
ci_050                 1.952253e-03 3 1  ON 49
ci_051                -1.487812e-03 3 1  ON 50
ci_052                -1.401811e-03 3 1  ON 51
ci_053                -2.391676e-03 3 1  ON 52
ci_054                -2.508583e-03 3 1  ON 53
ci_055                -1.496539e-03 3 1  ON 54
ci_056                -1.250580e-03 3 1  ON 55
ci_057                -1.291532e-03 3 1  ON 56
ci_058                -1.719816e-03 3 1  ON 57
ci_059                 1.284620e-04 3 1  ON 58
ci_060                 3.050880e-04 3 1  ON 59
ci_061                 1.528853e-04 3 1  ON 60
ci_062                -2.452014e-04 3 1  ON 61
ci_063                -2.837182e-04 3 1  ON 62
ci_064                -7.014066e-04 3 1  ON 63
ci_065                -2.193396e-03 3 1  ON 64
ci_066                -2.146959e-03 3 1  ON 65
ci_067                -2.187835e-03 3 1  ON 66
ci_068                -2.008490e-03 3 1  ON 67
ci_069                 2.267535e-07 3 1  ON 68
ci_070                -4.267269e-05 3 1  ON 69
ci_071                -2.368908e-03 3 1  ON 70
ci_072                -1.948162e-03 3 1  ON 71
ci_073                 3.171461e-04 3 1  ON 72
ci_074                 4.280779e-04 3 1  ON 73
ci_075                -5.218440e-04 3 1  ON 74
ci_076                -2.230009e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="250">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =8000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 8
    time step          = 0.05
    reference energy   = -22.7273
    reference variance = 0.514698
====================================================
  Execution time = 1.0097e+02
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s008
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 62500 
  VMC Eavg = -2.2670e+01
  VMC Evar = 5.1608e-01
  Total weights = 7.8207e+06
  Execution time = 1.4422e+01
  </log>
</opt>
<opt stage="main" walkers="62500">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.500611747556
                                         uncertainty =       0.001580359483

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.500611747556
                                         uncertainty =       0.001580359483

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000250153385
  error estimate for blocks of size 2^( 2) =       0.000259152980
  error estimate for blocks of size 2^( 3) =       0.000267027816
  error estimate for blocks of size 2^( 4) =       0.000272958699
  error estimate for blocks of size 2^( 5) =       0.000276403054
  error estimate for blocks of size 2^( 6) =       0.000278378104
  error estimate for blocks of size 2^( 7) =       0.000279313396
  error estimate for blocks of size 2^( 8) =       0.000279742874
  error estimate for blocks of size 2^( 9) =       0.000279800621

      target function =                  N/A
              le_mean =     -22.669883908956
             les_mean =     514.480809832182
             stat err =       0.000279308749
             autocorr =       1.246683785838
              std dev =       0.707540619469
             le_variance =       0.500613728199

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.500786112441
                                         uncertainty =       0.001703511791

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.500786112441
                                         uncertainty =       0.001703511791

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000250196833
  error estimate for blocks of size 2^( 2) =       0.000259194175
  error estimate for blocks of size 2^( 3) =       0.000267071581
  error estimate for blocks of size 2^( 4) =       0.000273004111
  error estimate for blocks of size 2^( 5) =       0.000276446225
  error estimate for blocks of size 2^( 6) =       0.000278421653
  error estimate for blocks of size 2^( 7) =       0.000279356513
  error estimate for blocks of size 2^( 8) =       0.000279790232
  error estimate for blocks of size 2^( 9) =       0.000279857264

      target function =                  N/A
              le_mean =     -22.669886425242
             les_mean =     514.442553391616
             stat err =       0.000279356415
             autocorr =       1.246676236066
              std dev =       0.707663509810
             le_variance =       0.500787643117

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.500709737022
                                         uncertainty =       0.001661688552

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.500709737022
                                         uncertainty =       0.001661688552

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000250177786
  error estimate for blocks of size 2^( 2) =       0.000259176105
  error estimate for blocks of size 2^( 3) =       0.000267053638
  error estimate for blocks of size 2^( 4) =       0.000272985893
  error estimate for blocks of size 2^( 5) =       0.000276427724
  error estimate for blocks of size 2^( 6) =       0.000278403553
  error estimate for blocks of size 2^( 7) =       0.000279338613
  error estimate for blocks of size 2^( 8) =       0.000279770036
  error estimate for blocks of size 2^( 9) =       0.000279835325

      target function =                  N/A
              le_mean =     -22.669885055932
             les_mean =     514.445473558936
             stat err =       0.000279336882
             autocorr =       1.246691710155
              std dev =       0.707609636389
             le_variance =       0.500711397511

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.500596199116
                                         uncertainty =       0.001588399627

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.500596199116
                                         uncertainty =       0.001588399627

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000250149495
  error estimate for blocks of size 2^( 2) =       0.000259149185
  error estimate for blocks of size 2^( 3) =       0.000267024266
  error estimate for blocks of size 2^( 4) =       0.000272955690
  error estimate for blocks of size 2^( 5) =       0.000276398995
  error estimate for blocks of size 2^( 6) =       0.000278374600
  error estimate for blocks of size 2^( 7) =       0.000279308164
  error estimate for blocks of size 2^( 8) =       0.000279737844
  error estimate for blocks of size 2^( 9) =       0.000279798308

      target function =                  N/A
              le_mean =     -22.669883417889
             les_mean =     514.439990723774
             stat err =       0.000279304729
             autocorr =       1.246686676163
              std dev =       0.707529616139
             le_variance =       0.500598157714


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.669883908956        initial
     9.7656e-02     9.7656e-01             7.5715e-04       -22.669886425242  <--
     3.9062e-01     3.9062e+00             3.3272e-04       -22.669885055932
     1.5625e+00     1.5625e+01             1.0281e-04       -22.669883417889

*****************************************************************************
Applying the update for shift_i =   9.7656e-02     and shift_s =   9.7656e-01
*****************************************************************************

  Execution time = 1.7339e+02
  </log>
  <optVariables href="FORM.s008.opt.xml">
ci_001                -7.050132e-01 3 1  ON 0
ci_002                -7.061222e-01 3 1  ON 1
ci_003                -3.758888e-02 3 1  ON 2
ci_004                -3.801549e-02 3 1  ON 3
ci_005                 1.556500e-02 3 1  ON 4
ci_006                 1.587730e-02 3 1  ON 5
ci_007                 1.285591e-02 3 1  ON 6
ci_008                 1.222634e-02 3 1  ON 7
ci_009                -1.151317e-02 3 1  ON 8
ci_010                -1.155292e-02 3 1  ON 9
ci_011                -7.910910e-03 3 1  ON 10
ci_012                -7.919377e-03 3 1  ON 11
ci_013                 9.470100e-03 3 1  ON 12
ci_014                 9.825361e-03 3 1  ON 13
ci_015                 1.212961e-02 3 1  ON 14
ci_016                 1.270422e-02 3 1  ON 15
ci_017                 1.049148e-02 3 1  ON 16
ci_018                 1.059220e-02 3 1  ON 17
ci_019                -3.584147e-03 3 1  ON 18
ci_020                -3.637516e-03 3 1  ON 19
ci_021                -9.198656e-03 3 1  ON 20
ci_022                -8.710946e-03 3 1  ON 21
ci_023                 7.868387e-03 3 1  ON 22
ci_024                 7.698365e-03 3 1  ON 23
ci_025                 3.896512e-03 3 1  ON 24
ci_026                 4.371465e-03 3 1  ON 25
ci_027                 6.692654e-03 3 1  ON 26
ci_028                 6.642518e-03 3 1  ON 27
ci_029                -4.616259e-03 3 1  ON 28
ci_030                -5.176251e-03 3 1  ON 29
ci_031                -8.282558e-03 3 1  ON 30
ci_032                -7.933494e-03 3 1  ON 31
ci_033                 4.433160e-03 3 1  ON 32
ci_034                 4.100695e-03 3 1  ON 33
ci_035                 1.073808e-03 3 1  ON 34
ci_036                 1.237091e-03 3 1  ON 35
ci_037                 4.677700e-03 3 1  ON 36
ci_038                 4.670575e-03 3 1  ON 37
ci_039                 5.293357e-03 3 1  ON 38
ci_040                 5.208898e-03 3 1  ON 39
ci_041                 5.182671e-03 3 1  ON 40
ci_042                 5.173361e-03 3 1  ON 41
ci_043                 4.576405e-03 3 1  ON 42
ci_044                 4.490142e-03 3 1  ON 43
ci_045                 3.031141e-03 3 1  ON 44
ci_046                 2.911522e-03 3 1  ON 45
ci_047                -6.893349e-04 3 1  ON 46
ci_048                -6.896811e-04 3 1  ON 47
ci_049                 1.628869e-03 3 1  ON 48
ci_050                 2.007592e-03 3 1  ON 49
ci_051                -1.488219e-03 3 1  ON 50
ci_052                -1.639026e-03 3 1  ON 51
ci_053                -2.049241e-03 3 1  ON 52
ci_054                -2.252656e-03 3 1  ON 53
ci_055                -1.643737e-03 3 1  ON 54
ci_056                -1.112364e-03 3 1  ON 55
ci_057                -1.267822e-03 3 1  ON 56
ci_058                -1.632491e-03 3 1  ON 57
ci_059                -7.118643e-05 3 1  ON 58
ci_060                 3.299213e-04 3 1  ON 59
ci_061                 1.887586e-04 3 1  ON 60
ci_062                -3.241885e-04 3 1  ON 61
ci_063                -2.574586e-04 3 1  ON 62
ci_064                -5.127747e-04 3 1  ON 63
ci_065                -2.042206e-03 3 1  ON 64
ci_066                -2.109356e-03 3 1  ON 65
ci_067                -2.398210e-03 3 1  ON 66
ci_068                -2.105417e-03 3 1  ON 67
ci_069                 1.854551e-04 3 1  ON 68
ci_070                -1.381313e-04 3 1  ON 69
ci_071                -2.558002e-03 3 1  ON 70
ci_072                -2.201434e-03 3 1  ON 71
ci_073                 2.710923e-04 3 1  ON 72
ci_074                 6.010716e-04 3 1  ON 73
ci_075                -7.104467e-04 3 1  ON 74
ci_076                -2.640902e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 2.9414e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s009 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s009 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=9  my_counter=0
  time step      = 5.0000e-02
  blocks         = 250
  steps          = 250
  substeps       = 10
  current        = 0
  target samples = 8.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">250</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">6.2500e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">8.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">6.2500e+04</parameter>
<parameter name="steps" condition="int">250</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2693e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="250">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =8000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 9
    time step          = 0.05
    reference energy   = -22.7765
    reference variance = 0.625801
====================================================
  Execution time = 1.0111e+02
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s009
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 62500 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 6.1106e+04
  VMC Eavg = -2.2670e+01
  VMC Evar = 5.0999e-01
  Total weights = 7.820146150e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.8905e+01
  </log>
</opt>
<opt stage="main" walkers="62500">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.498681209280
                                         uncertainty =       0.002035311355

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.498681209280
                                         uncertainty =       0.002035311355

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000249670350
  error estimate for blocks of size 2^( 2) =       0.000258555187
  error estimate for blocks of size 2^( 3) =       0.000266478921
  error estimate for blocks of size 2^( 4) =       0.000272160435
  error estimate for blocks of size 2^( 5) =       0.000275590052
  error estimate for blocks of size 2^( 6) =       0.000277413486
  error estimate for blocks of size 2^( 7) =       0.000278446719
  error estimate for blocks of size 2^( 8) =       0.000278866482
  error estimate for blocks of size 2^( 9) =       0.000279715558

      target function =                  N/A
              le_mean =     -22.670007938465
             les_mean =     514.439250822453
             stat err =       0.000278610561
             autocorr =       1.245263360376
              std dev =       0.706174390099
             le_variance =       0.498682269232


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.267000793847e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.4414e-02, overlap shift 2.4414e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.670007938489       residual = 6.51e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.670017670957       residual = 6.28e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.670017902588       residual = 1.47e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.670018525396       residual = 1.02e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.670018703913       residual = 4.49e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.670018840711       residual = 1.35e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.670018678820       residual = 2.40e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.670018825682       residual = 3.11e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 2.4414e-02 is 3.226957e-03

solving harmonic davidson linear method for identity shift 9.7656e-02, overlap shift 9.7656e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.670007938489       residual = 6.51e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.670014894120       residual = 3.29e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.670015124751       residual = 3.44e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.670015363917       residual = 4.97e-08           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.670015335985       residual = 6.51e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          4 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 9.7656e-02 is 8.996404e-04

solving harmonic davidson linear method for identity shift 3.9062e-01, overlap shift 3.9062e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.670007938489       residual = 6.51e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.670011186856       residual = 1.29e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.670011453776       residual = 5.65e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.670011551551       residual = 2.30e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 3.9062e-01 is 3.703766e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.262237 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.2003e+02
  </log>
  <optVariables href="FORM.s009.opt.xml">
ci_001                -7.057630e-01 3 1  ON 0
ci_002                -7.053182e-01 3 1  ON 1
ci_003                -3.737276e-02 3 1  ON 2
ci_004                -3.882628e-02 3 1  ON 3
ci_005                 1.593975e-02 3 1  ON 4
ci_006                 1.568097e-02 3 1  ON 5
ci_007                 1.263661e-02 3 1  ON 6
ci_008                 1.276590e-02 3 1  ON 7
ci_009                -1.158178e-02 3 1  ON 8
ci_010                -1.182365e-02 3 1  ON 9
ci_011                -8.240001e-03 3 1  ON 10
ci_012                -8.562727e-03 3 1  ON 11
ci_013                 9.817105e-03 3 1  ON 12
ci_014                 9.791747e-03 3 1  ON 13
ci_015                 1.122997e-02 3 1  ON 14
ci_016                 1.290708e-02 3 1  ON 15
ci_017                 1.066631e-02 3 1  ON 16
ci_018                 1.146745e-02 3 1  ON 17
ci_019                -3.660411e-03 3 1  ON 18
ci_020                -4.224042e-03 3 1  ON 19
ci_021                -8.336515e-03 3 1  ON 20
ci_022                -9.324468e-03 3 1  ON 21
ci_023                 7.814705e-03 3 1  ON 22
ci_024                 7.454582e-03 3 1  ON 23
ci_025                 3.653769e-03 3 1  ON 24
ci_026                 4.550205e-03 3 1  ON 25
ci_027                 6.046707e-03 3 1  ON 26
ci_028                 6.453907e-03 3 1  ON 27
ci_029                -4.789626e-03 3 1  ON 28
ci_030                -5.094988e-03 3 1  ON 29
ci_031                -8.392503e-03 3 1  ON 30
ci_032                -7.897376e-03 3 1  ON 31
ci_033                 5.195037e-03 3 1  ON 32
ci_034                 3.758725e-03 3 1  ON 33
ci_035                 1.119319e-03 3 1  ON 34
ci_036                 1.078558e-03 3 1  ON 35
ci_037                 5.038371e-03 3 1  ON 36
ci_038                 4.691431e-03 3 1  ON 37
ci_039                 5.003453e-03 3 1  ON 38
ci_040                 4.986870e-03 3 1  ON 39
ci_041                 4.908763e-03 3 1  ON 40
ci_042                 4.961739e-03 3 1  ON 41
ci_043                 4.692212e-03 3 1  ON 42
ci_044                 5.173136e-03 3 1  ON 43
ci_045                 2.420302e-03 3 1  ON 44
ci_046                 3.397857e-03 3 1  ON 45
ci_047                -3.745093e-04 3 1  ON 46
ci_048                -5.737296e-04 3 1  ON 47
ci_049                 1.329820e-03 3 1  ON 48
ci_050                 2.251869e-03 3 1  ON 49
ci_051                -1.780294e-03 3 1  ON 50
ci_052                -1.128347e-03 3 1  ON 51
ci_053                -2.616968e-03 3 1  ON 52
ci_054                -2.279626e-03 3 1  ON 53
ci_055                -9.791634e-04 3 1  ON 54
ci_056                -1.428395e-03 3 1  ON 55
ci_057                -1.348004e-03 3 1  ON 56
ci_058                -1.103814e-03 3 1  ON 57
ci_059                -2.790910e-04 3 1  ON 58
ci_060                -1.536048e-06 3 1  ON 59
ci_061                 1.566631e-04 3 1  ON 60
ci_062                -2.257734e-04 3 1  ON 61
ci_063                -1.053174e-03 3 1  ON 62
ci_064                -7.578048e-04 3 1  ON 63
ci_065                -1.664694e-03 3 1  ON 64
ci_066                -2.447285e-03 3 1  ON 65
ci_067                -2.653402e-03 3 1  ON 66
ci_068                -2.507647e-03 3 1  ON 67
ci_069                 2.352026e-04 3 1  ON 68
ci_070                -2.608260e-04 3 1  ON 69
ci_071                -2.348507e-03 3 1  ON 70
ci_072                -1.526285e-03 3 1  ON 71
ci_073                -1.851877e-04 3 1  ON 72
ci_074                 4.466411e-04 3 1  ON 73
ci_075                -3.356997e-04 3 1  ON 74
ci_076                -4.190932e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="250">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =8000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 9
    time step          = 0.05
    reference energy   = -22.6811
    reference variance = 0.474229
====================================================
  Execution time = 1.0081e+02
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s009
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 62500 
  VMC Eavg = -2.2669e+01
  VMC Evar = 5.1436e-01
  Total weights = 7.8210e+06
  Execution time = 1.4438e+01
  </log>
</opt>
<opt stage="main" walkers="62500">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.500904608281
                                         uncertainty =       0.003950635598

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.500904608281
                                         uncertainty =       0.003950635598

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000250227131
  error estimate for blocks of size 2^( 2) =       0.000259208676
  error estimate for blocks of size 2^( 3) =       0.000267004079
  error estimate for blocks of size 2^( 4) =       0.000272690160
  error estimate for blocks of size 2^( 5) =       0.000275798498
  error estimate for blocks of size 2^( 6) =       0.000277501871
  error estimate for blocks of size 2^( 7) =       0.000278546288
  error estimate for blocks of size 2^( 8) =       0.000278530338
  error estimate for blocks of size 2^( 9) =       0.000277620321

      target function =                  N/A
              le_mean =     -22.669221059529
             les_mean =     514.443656679129
             stat err =       0.000278049704
             autocorr =       1.234741606180
              std dev =       0.707749204371
             le_variance =       0.500908936287

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.500697692262
                                         uncertainty =       0.003912813260

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.500697692262
                                         uncertainty =       0.003912813260

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000250175429
  error estimate for blocks of size 2^( 2) =       0.000259159399
  error estimate for blocks of size 2^( 3) =       0.000266954515
  error estimate for blocks of size 2^( 4) =       0.000272641326
  error estimate for blocks of size 2^( 5) =       0.000275770916
  error estimate for blocks of size 2^( 6) =       0.000277481487
  error estimate for blocks of size 2^( 7) =       0.000278518379
  error estimate for blocks of size 2^( 8) =       0.000278512935
  error estimate for blocks of size 2^( 9) =       0.000277600830

      target function =                  N/A
              le_mean =     -22.669221772748
             les_mean =     514.429002580340
             stat err =       0.000278028408
             autocorr =       1.235062799929
              std dev =       0.707602968168
             le_variance =       0.500701960560

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.501117196418
                                         uncertainty =       0.004099178455

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.501117196418
                                         uncertainty =       0.004099178455

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000250280295
  error estimate for blocks of size 2^( 2) =       0.000259258745
  error estimate for blocks of size 2^( 3) =       0.000267054212
  error estimate for blocks of size 2^( 4) =       0.000272736325
  error estimate for blocks of size 2^( 5) =       0.000275866877
  error estimate for blocks of size 2^( 6) =       0.000277575198
  error estimate for blocks of size 2^( 7) =       0.000278623555
  error estimate for blocks of size 2^( 8) =       0.000278594602
  error estimate for blocks of size 2^( 9) =       0.000277681009

      target function =                  N/A
              le_mean =     -22.669228367011
             les_mean =     514.450002847174
             stat err =       0.000278118591
             autocorr =       1.234828729271
              std dev =       0.707899574899
             le_variance =       0.501121808142

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.500725202652
                                         uncertainty =       0.003992841233

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.500725202652
                                         uncertainty =       0.003992841233

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000250182317
  error estimate for blocks of size 2^( 2) =       0.000259165305
  error estimate for blocks of size 2^( 3) =       0.000266960701
  error estimate for blocks of size 2^( 4) =       0.000272645689
  error estimate for blocks of size 2^( 5) =       0.000275766170
  error estimate for blocks of size 2^( 6) =       0.000277471653
  error estimate for blocks of size 2^( 7) =       0.000278518152
  error estimate for blocks of size 2^( 8) =       0.000278508213
  error estimate for blocks of size 2^( 9) =       0.000277632579

      target function =                  N/A
              le_mean =     -22.669212060924
             les_mean =     514.413618626789
             stat err =       0.000278032649
             autocorr =       1.235032469763
              std dev =       0.707622450866
             le_variance =       0.500729532970


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.669221059529        initial
     2.4414e-02     2.4414e-01             3.2270e-03       -22.669221772748
     9.7656e-02     9.7656e-01             8.9964e-04       -22.669228367011  <--
     3.9062e-01     3.9062e+00             3.7038e-04       -22.669212060924

*****************************************************************************
Applying the update for shift_i =   9.7656e-02     and shift_s =   9.7656e-01
*****************************************************************************

  Execution time = 1.7331e+02
  </log>
  <optVariables href="FORM.s009.opt.xml">
ci_001                -7.057630e-01 3 1  ON 0
ci_002                -7.053182e-01 3 1  ON 1
ci_003                -3.737276e-02 3 1  ON 2
ci_004                -3.882628e-02 3 1  ON 3
ci_005                 1.593975e-02 3 1  ON 4
ci_006                 1.568097e-02 3 1  ON 5
ci_007                 1.263661e-02 3 1  ON 6
ci_008                 1.276590e-02 3 1  ON 7
ci_009                -1.158178e-02 3 1  ON 8
ci_010                -1.182365e-02 3 1  ON 9
ci_011                -8.240001e-03 3 1  ON 10
ci_012                -8.562727e-03 3 1  ON 11
ci_013                 9.817105e-03 3 1  ON 12
ci_014                 9.791747e-03 3 1  ON 13
ci_015                 1.122997e-02 3 1  ON 14
ci_016                 1.290708e-02 3 1  ON 15
ci_017                 1.066631e-02 3 1  ON 16
ci_018                 1.146745e-02 3 1  ON 17
ci_019                -3.660411e-03 3 1  ON 18
ci_020                -4.224042e-03 3 1  ON 19
ci_021                -8.336515e-03 3 1  ON 20
ci_022                -9.324468e-03 3 1  ON 21
ci_023                 7.814705e-03 3 1  ON 22
ci_024                 7.454582e-03 3 1  ON 23
ci_025                 3.653769e-03 3 1  ON 24
ci_026                 4.550205e-03 3 1  ON 25
ci_027                 6.046707e-03 3 1  ON 26
ci_028                 6.453907e-03 3 1  ON 27
ci_029                -4.789626e-03 3 1  ON 28
ci_030                -5.094988e-03 3 1  ON 29
ci_031                -8.392503e-03 3 1  ON 30
ci_032                -7.897376e-03 3 1  ON 31
ci_033                 5.195037e-03 3 1  ON 32
ci_034                 3.758725e-03 3 1  ON 33
ci_035                 1.119319e-03 3 1  ON 34
ci_036                 1.078558e-03 3 1  ON 35
ci_037                 5.038371e-03 3 1  ON 36
ci_038                 4.691431e-03 3 1  ON 37
ci_039                 5.003453e-03 3 1  ON 38
ci_040                 4.986870e-03 3 1  ON 39
ci_041                 4.908763e-03 3 1  ON 40
ci_042                 4.961739e-03 3 1  ON 41
ci_043                 4.692212e-03 3 1  ON 42
ci_044                 5.173136e-03 3 1  ON 43
ci_045                 2.420302e-03 3 1  ON 44
ci_046                 3.397857e-03 3 1  ON 45
ci_047                -3.745093e-04 3 1  ON 46
ci_048                -5.737296e-04 3 1  ON 47
ci_049                 1.329820e-03 3 1  ON 48
ci_050                 2.251869e-03 3 1  ON 49
ci_051                -1.780294e-03 3 1  ON 50
ci_052                -1.128347e-03 3 1  ON 51
ci_053                -2.616968e-03 3 1  ON 52
ci_054                -2.279626e-03 3 1  ON 53
ci_055                -9.791634e-04 3 1  ON 54
ci_056                -1.428395e-03 3 1  ON 55
ci_057                -1.348004e-03 3 1  ON 56
ci_058                -1.103814e-03 3 1  ON 57
ci_059                -2.790910e-04 3 1  ON 58
ci_060                -1.536048e-06 3 1  ON 59
ci_061                 1.566631e-04 3 1  ON 60
ci_062                -2.257734e-04 3 1  ON 61
ci_063                -1.053174e-03 3 1  ON 62
ci_064                -7.578048e-04 3 1  ON 63
ci_065                -1.664694e-03 3 1  ON 64
ci_066                -2.447285e-03 3 1  ON 65
ci_067                -2.653402e-03 3 1  ON 66
ci_068                -2.507647e-03 3 1  ON 67
ci_069                 2.352026e-04 3 1  ON 68
ci_070                -2.608260e-04 3 1  ON 69
ci_071                -2.348507e-03 3 1  ON 70
ci_072                -1.526285e-03 3 1  ON 71
ci_073                -1.851877e-04 3 1  ON 72
ci_074                 4.466411e-04 3 1  ON 73
ci_075                -3.356997e-04 3 1  ON 74
ci_076                -4.190932e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 2.9335e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s010 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s010 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=10  my_counter=0
  time step      = 5.0000e-02
  blocks         = 250
  steps          = 250
  substeps       = 10
  current        = 0
  target samples = 8.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">250</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">6.2500e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">8.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">6.2500e+04</parameter>
<parameter name="steps" condition="int">250</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2697e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="250">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =8000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 10
    time step          = 0.05
    reference energy   = -22.6337
    reference variance = 0.27306
====================================================
  Execution time = 1.0096e+02
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s010
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 62500 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 6.1117e+04
  VMC Eavg = -2.2670e+01
  VMC Evar = 5.1330e-01
  Total weights = 7.819926690e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.8903e+01
  </log>
</opt>
<opt stage="main" walkers="62500">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.499983893653
                                         uncertainty =       0.001654859574

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.499983893653
                                         uncertainty =       0.001654859574

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000249995732
  error estimate for blocks of size 2^( 2) =       0.000259010348
  error estimate for blocks of size 2^( 3) =       0.000267138270
  error estimate for blocks of size 2^( 4) =       0.000272577507
  error estimate for blocks of size 2^( 5) =       0.000275688787
  error estimate for blocks of size 2^( 6) =       0.000277678641
  error estimate for blocks of size 2^( 7) =       0.000278534579
  error estimate for blocks of size 2^( 8) =       0.000278673346
  error estimate for blocks of size 2^( 9) =       0.000279741941

      target function =                  N/A
              le_mean =     -22.670032397980
             les_mean =     514.443671857313
             stat err =       0.000278657127
             autocorr =       1.242439130562
              std dev =       0.707094709055
             le_variance =       0.499982927573


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.267003239798e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.4414e-02, overlap shift 2.4414e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.670032398007       residual = 6.86e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.670042302421       residual = 4.47e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.670044352920       residual = 4.37e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.670044224761       residual = 6.27e-08           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.670044331402       residual = 4.37e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.670044362647       residual = 2.78e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.670044415164       residual = 2.85e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 2.4414e-02 is 2.402586e-03

solving harmonic davidson linear method for identity shift 9.7656e-02, overlap shift 9.7656e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.670032398007       residual = 6.86e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.670039439199       residual = 2.23e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.670040541709       residual = 1.43e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.670040496129       residual = 1.03e-08           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.670040523750       residual = 1.52e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          4 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 9.7656e-02 is 1.520709e-03

solving harmonic davidson linear method for identity shift 3.9062e-01, overlap shift 3.9062e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.670032398007       residual = 6.86e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.670035663345       residual = 7.62e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.670036031743       residual = 3.00e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.670036031119       residual = 1.13e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 3.9062e-01 is 6.170487e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.264101 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.1988e+02
  </log>
  <optVariables href="FORM.s010.opt.xml">
ci_001                -7.055778e-01 3 1  ON 0
ci_002                -7.055006e-01 3 1  ON 1
ci_003                -3.739904e-02 3 1  ON 2
ci_004                -3.874722e-02 3 1  ON 3
ci_005                 1.593928e-02 3 1  ON 4
ci_006                 1.607581e-02 3 1  ON 5
ci_007                 1.245521e-02 3 1  ON 6
ci_008                 1.269025e-02 3 1  ON 7
ci_009                -1.174661e-02 3 1  ON 8
ci_010                -1.169918e-02 3 1  ON 9
ci_011                -8.553248e-03 3 1  ON 10
ci_012                -7.816871e-03 3 1  ON 11
ci_013                 9.389792e-03 3 1  ON 12
ci_014                 9.849714e-03 3 1  ON 13
ci_015                 1.275068e-02 3 1  ON 14
ci_016                 1.270102e-02 3 1  ON 15
ci_017                 1.057175e-02 3 1  ON 16
ci_018                 1.087384e-02 3 1  ON 17
ci_019                -3.521260e-03 3 1  ON 18
ci_020                -3.898763e-03 3 1  ON 19
ci_021                -8.273177e-03 3 1  ON 20
ci_022                -8.781638e-03 3 1  ON 21
ci_023                 7.778557e-03 3 1  ON 22
ci_024                 7.613321e-03 3 1  ON 23
ci_025                 4.176757e-03 3 1  ON 24
ci_026                 4.003619e-03 3 1  ON 25
ci_027                 6.304780e-03 3 1  ON 26
ci_028                 6.425046e-03 3 1  ON 27
ci_029                -4.952611e-03 3 1  ON 28
ci_030                -5.075761e-03 3 1  ON 29
ci_031                -8.186458e-03 3 1  ON 30
ci_032                -8.012656e-03 3 1  ON 31
ci_033                 4.314056e-03 3 1  ON 32
ci_034                 4.347553e-03 3 1  ON 33
ci_035                 9.352425e-04 3 1  ON 34
ci_036                 1.441624e-03 3 1  ON 35
ci_037                 5.470857e-03 3 1  ON 36
ci_038                 4.943348e-03 3 1  ON 37
ci_039                 5.348669e-03 3 1  ON 38
ci_040                 5.205562e-03 3 1  ON 39
ci_041                 5.219249e-03 3 1  ON 40
ci_042                 5.269100e-03 3 1  ON 41
ci_043                 5.150078e-03 3 1  ON 42
ci_044                 5.040558e-03 3 1  ON 43
ci_045                 2.602545e-03 3 1  ON 44
ci_046                 3.027368e-03 3 1  ON 45
ci_047                -7.388709e-04 3 1  ON 46
ci_048                -7.562069e-04 3 1  ON 47
ci_049                 1.189610e-03 3 1  ON 48
ci_050                 1.184305e-03 3 1  ON 49
ci_051                -1.359618e-03 3 1  ON 50
ci_052                -1.527813e-03 3 1  ON 51
ci_053                -2.820627e-03 3 1  ON 52
ci_054                -2.496775e-03 3 1  ON 53
ci_055                -1.683316e-03 3 1  ON 54
ci_056                -1.207960e-03 3 1  ON 55
ci_057                -1.741098e-03 3 1  ON 56
ci_058                -1.333746e-03 3 1  ON 57
ci_059                -1.883702e-04 3 1  ON 58
ci_060                 1.865302e-05 3 1  ON 59
ci_061                 1.159995e-04 3 1  ON 60
ci_062                -5.036109e-04 3 1  ON 61
ci_063                -7.799743e-04 3 1  ON 62
ci_064                -6.585225e-04 3 1  ON 63
ci_065                -2.037627e-03 3 1  ON 64
ci_066                -2.671983e-03 3 1  ON 65
ci_067                -2.120723e-03 3 1  ON 66
ci_068                -2.795426e-03 3 1  ON 67
ci_069                -1.076590e-04 3 1  ON 68
ci_070                -5.151898e-04 3 1  ON 69
ci_071                -2.073042e-03 3 1  ON 70
ci_072                -2.036324e-03 3 1  ON 71
ci_073                 1.693943e-04 3 1  ON 72
ci_074                 4.477837e-04 3 1  ON 73
ci_075                -8.487843e-04 3 1  ON 74
ci_076                -1.996696e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="250">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =8000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 10
    time step          = 0.05
    reference energy   = -22.7457
    reference variance = 0.631561
====================================================
  Execution time = 1.0057e+02
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s010
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 62500 
  VMC Eavg = -2.2670e+01
  VMC Evar = 5.1700e-01
  Total weights = 7.8199e+06
  Execution time = 1.4437e+01
  </log>
</opt>
<opt stage="main" walkers="62500">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

ERROR CostFunction-> Number of Effective Walkers is too small! 
  Number of effective walkers (samples) / total number of samples = 0.0034565
  User specified threshold minwalkers = 0.3
  If this message appears frequently. You might have to be cautious. 
  Find info about parameter "minwalkers" in the user manual!
Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.502813651316
                                         uncertainty =       0.002499479056

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.502813651316
                                         uncertainty =       0.002499479056

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000250702720
  error estimate for blocks of size 2^( 2) =       0.000259705128
  error estimate for blocks of size 2^( 3) =       0.000267723494
  error estimate for blocks of size 2^( 4) =       0.000273592276
  error estimate for blocks of size 2^( 5) =       0.000277127149
  error estimate for blocks of size 2^( 6) =       0.000278264403
  error estimate for blocks of size 2^( 7) =       0.000280207917
  error estimate for blocks of size 2^( 8) =       0.000280595068
  error estimate for blocks of size 2^( 9) =       0.000281179046

      target function =                  N/A
              le_mean =     -22.670192092383
             les_mean =     514.512141545555
             stat err =       0.000280061609
             autocorr =       1.247926665935
              std dev =       0.709094374353
             le_variance =       0.502814831739

ERROR CostFunction-> Number of Effective Walkers is too small! 
  Number of effective walkers (samples) / total number of samples = 0.0589171
  User specified threshold minwalkers = 0.3
  If this message appears frequently. You might have to be cautious. 
  Find info about parameter "minwalkers" in the user manual!
Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.502542950794
                                         uncertainty =       0.002471243414

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.502542950794
                                         uncertainty =       0.002471243414

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000250635204
  error estimate for blocks of size 2^( 2) =       0.000259633988
  error estimate for blocks of size 2^( 3) =       0.000267651711
  error estimate for blocks of size 2^( 4) =       0.000273519265
  error estimate for blocks of size 2^( 5) =       0.000277059677
  error estimate for blocks of size 2^( 6) =       0.000278194853
  error estimate for blocks of size 2^( 7) =       0.000280118802
  error estimate for blocks of size 2^( 8) =       0.000280505796
  error estimate for blocks of size 2^( 9) =       0.000281103224

      target function =                  N/A
              le_mean =     -22.670185583723
             les_mean =     514.603531457460
             stat err =       0.000279980669
             autocorr =       1.247877488721
              std dev =       0.708903409369
             le_variance =       0.502544043814

ERROR CostFunction-> Number of Effective Walkers is too small! 
  Number of effective walkers (samples) / total number of samples = 0.00342325
  User specified threshold minwalkers = 0.3
  If this message appears frequently. You might have to be cautious. 
  Find info about parameter "minwalkers" in the user manual!
Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.503392235119
                                         uncertainty =       0.002603649725

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.503392235119
                                         uncertainty =       0.002603649725

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000250846729
  error estimate for blocks of size 2^( 2) =       0.000259840614
  error estimate for blocks of size 2^( 3) =       0.000267853046
  error estimate for blocks of size 2^( 4) =       0.000273714153
  error estimate for blocks of size 2^( 5) =       0.000277255789
  error estimate for blocks of size 2^( 6) =       0.000278377978
  error estimate for blocks of size 2^( 7) =       0.000280326718
  error estimate for blocks of size 2^( 8) =       0.000280691789
  error estimate for blocks of size 2^( 9) =       0.000281312292

      target function =                  N/A
              le_mean =     -22.670205202861
             les_mean =     514.806811478682
             stat err =       0.000280177194
             autocorr =       1.247523334434
              std dev =       0.709501693508
             le_variance =       0.503392653090

ERROR CostFunction-> Number of Effective Walkers is too small! 
  Number of effective walkers (samples) / total number of samples = 0.0300948
  User specified threshold minwalkers = 0.3
  If this message appears frequently. You might have to be cautious. 
  Find info about parameter "minwalkers" in the user manual!
Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.502574343535
                                         uncertainty =       0.002493230664

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.502574343535
                                         uncertainty =       0.002493230664

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000250643042
  error estimate for blocks of size 2^( 2) =       0.000259645425
  error estimate for blocks of size 2^( 3) =       0.000267664987
  error estimate for blocks of size 2^( 4) =       0.000273532874
  error estimate for blocks of size 2^( 5) =       0.000277069526
  error estimate for blocks of size 2^( 6) =       0.000278208522
  error estimate for blocks of size 2^( 7) =       0.000280141345
  error estimate for blocks of size 2^( 8) =       0.000280524314
  error estimate for blocks of size 2^( 9) =       0.000281103976

      target function =                  N/A
              le_mean =     -22.670183524592
             les_mean =     514.460354225892
             stat err =       0.000279994539
             autocorr =       1.247923075235
              std dev =       0.708925579442
             le_variance =       0.502575477187


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.670192092383        initial
     2.4414e-02     2.4414e-01             2.4026e-03       -22.670185583723
     9.7656e-02     9.7656e-01             1.5207e-03       -22.670205202861  <--
     3.9062e-01     3.9062e+00             6.1705e-04       -22.670183524592

*****************************************************************************
Applying the update for shift_i =   9.7656e-02     and shift_s =   9.7656e-01
*****************************************************************************

  Execution time = 1.7297e+02
  </log>
  <optVariables href="FORM.s010.opt.xml">
ci_001                -7.055778e-01 3 1  ON 0
ci_002                -7.055006e-01 3 1  ON 1
ci_003                -3.739904e-02 3 1  ON 2
ci_004                -3.874722e-02 3 1  ON 3
ci_005                 1.593928e-02 3 1  ON 4
ci_006                 1.607581e-02 3 1  ON 5
ci_007                 1.245521e-02 3 1  ON 6
ci_008                 1.269025e-02 3 1  ON 7
ci_009                -1.174661e-02 3 1  ON 8
ci_010                -1.169918e-02 3 1  ON 9
ci_011                -8.553248e-03 3 1  ON 10
ci_012                -7.816871e-03 3 1  ON 11
ci_013                 9.389792e-03 3 1  ON 12
ci_014                 9.849714e-03 3 1  ON 13
ci_015                 1.275068e-02 3 1  ON 14
ci_016                 1.270102e-02 3 1  ON 15
ci_017                 1.057175e-02 3 1  ON 16
ci_018                 1.087384e-02 3 1  ON 17
ci_019                -3.521260e-03 3 1  ON 18
ci_020                -3.898763e-03 3 1  ON 19
ci_021                -8.273177e-03 3 1  ON 20
ci_022                -8.781638e-03 3 1  ON 21
ci_023                 7.778557e-03 3 1  ON 22
ci_024                 7.613321e-03 3 1  ON 23
ci_025                 4.176757e-03 3 1  ON 24
ci_026                 4.003619e-03 3 1  ON 25
ci_027                 6.304780e-03 3 1  ON 26
ci_028                 6.425046e-03 3 1  ON 27
ci_029                -4.952611e-03 3 1  ON 28
ci_030                -5.075761e-03 3 1  ON 29
ci_031                -8.186458e-03 3 1  ON 30
ci_032                -8.012656e-03 3 1  ON 31
ci_033                 4.314056e-03 3 1  ON 32
ci_034                 4.347553e-03 3 1  ON 33
ci_035                 9.352425e-04 3 1  ON 34
ci_036                 1.441624e-03 3 1  ON 35
ci_037                 5.470857e-03 3 1  ON 36
ci_038                 4.943348e-03 3 1  ON 37
ci_039                 5.348669e-03 3 1  ON 38
ci_040                 5.205562e-03 3 1  ON 39
ci_041                 5.219249e-03 3 1  ON 40
ci_042                 5.269100e-03 3 1  ON 41
ci_043                 5.150078e-03 3 1  ON 42
ci_044                 5.040558e-03 3 1  ON 43
ci_045                 2.602545e-03 3 1  ON 44
ci_046                 3.027368e-03 3 1  ON 45
ci_047                -7.388709e-04 3 1  ON 46
ci_048                -7.562069e-04 3 1  ON 47
ci_049                 1.189610e-03 3 1  ON 48
ci_050                 1.184305e-03 3 1  ON 49
ci_051                -1.359618e-03 3 1  ON 50
ci_052                -1.527813e-03 3 1  ON 51
ci_053                -2.820627e-03 3 1  ON 52
ci_054                -2.496775e-03 3 1  ON 53
ci_055                -1.683316e-03 3 1  ON 54
ci_056                -1.207960e-03 3 1  ON 55
ci_057                -1.741098e-03 3 1  ON 56
ci_058                -1.333746e-03 3 1  ON 57
ci_059                -1.883702e-04 3 1  ON 58
ci_060                 1.865302e-05 3 1  ON 59
ci_061                 1.159995e-04 3 1  ON 60
ci_062                -5.036109e-04 3 1  ON 61
ci_063                -7.799743e-04 3 1  ON 62
ci_064                -6.585225e-04 3 1  ON 63
ci_065                -2.037627e-03 3 1  ON 64
ci_066                -2.671983e-03 3 1  ON 65
ci_067                -2.120723e-03 3 1  ON 66
ci_068                -2.795426e-03 3 1  ON 67
ci_069                -1.076590e-04 3 1  ON 68
ci_070                -5.151898e-04 3 1  ON 69
ci_071                -2.073042e-03 3 1  ON 70
ci_072                -2.036324e-03 3 1  ON 71
ci_073                 1.693943e-04 3 1  ON 72
ci_074                 4.477837e-04 3 1  ON 73
ci_075                -8.487843e-04 3 1  ON 74
ci_076                -1.996696e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 2.9287e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s011 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s011 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=11  my_counter=0
  time step      = 5.0000e-02
  blocks         = 250
  steps          = 250
  substeps       = 10
  current        = 0
  target samples = 8.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">250</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">6.2500e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">8.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">6.2500e+04</parameter>
<parameter name="steps" condition="int">250</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2696e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="250">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =8000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 11
    time step          = 0.05
    reference energy   = -22.6108
    reference variance = 0.385461
====================================================
  Execution time = 1.0099e+02
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s011
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 62500 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 6.1060e+04
  VMC Eavg = -2.2670e+01
  VMC Evar = 5.1295e-01
  Total weights = 7.820393587e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.8945e+01
  </log>
</opt>
<opt stage="main" walkers="62500">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.499488263069
                                         uncertainty =       0.001407166413

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.499488263069
                                         uncertainty =       0.001407166413

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000249871931
  error estimate for blocks of size 2^( 2) =       0.000258684449
  error estimate for blocks of size 2^( 3) =       0.000266630672
  error estimate for blocks of size 2^( 4) =       0.000272281846
  error estimate for blocks of size 2^( 5) =       0.000275560136
  error estimate for blocks of size 2^( 6) =       0.000277473334
  error estimate for blocks of size 2^( 7) =       0.000278313547
  error estimate for blocks of size 2^( 8) =       0.000279780288
  error estimate for blocks of size 2^( 9) =       0.000279332177

      target function =                  N/A
              le_mean =     -22.669919299850
             les_mean =     514.438186439332
             stat err =       0.000278724837
             autocorr =       1.244275053621
              std dev =       0.706744546587
             le_variance =       0.499487854130


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266991929985e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.4414e-02, overlap shift 2.4414e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.669919299873       residual = 5.79e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.669926905933       residual = 4.42e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.669925686655       residual = 3.73e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.669926487451       residual = 3.54e-08           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.669926521081       residual = 7.11e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          4 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 2.4414e-02 is 1.366725e-03

solving harmonic davidson linear method for identity shift 9.7656e-02, overlap shift 9.7656e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.669919299873       residual = 5.79e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.669924809080       residual = 2.56e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.669924012541       residual = 1.44e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.669924357128       residual = 7.51e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 9.7656e-02 is 9.816510e-04

solving harmonic davidson linear method for identity shift 3.9062e-01, overlap shift 3.9062e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.669919299873       residual = 5.79e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.669921919899       residual = 1.05e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.669921621677       residual = 4.61e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.669921707318       residual = 1.59e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 3.9062e-01 is 4.570967e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.265601 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.1996e+02
  </log>
  <optVariables href="FORM.s011.opt.xml">
ci_001                -7.055893e-01 3 1  ON 0
ci_002                -7.055456e-01 3 1  ON 1
ci_003                -3.749750e-02 3 1  ON 2
ci_004                -3.837968e-02 3 1  ON 3
ci_005                 1.562830e-02 3 1  ON 4
ci_006                 1.579018e-02 3 1  ON 5
ci_007                 1.222311e-02 3 1  ON 6
ci_008                 1.179177e-02 3 1  ON 7
ci_009                -1.188821e-02 3 1  ON 8
ci_010                -1.174118e-02 3 1  ON 9
ci_011                -8.525657e-03 3 1  ON 10
ci_012                -8.144852e-03 3 1  ON 11
ci_013                 9.804746e-03 3 1  ON 12
ci_014                 9.734780e-03 3 1  ON 13
ci_015                 1.214160e-02 3 1  ON 14
ci_016                 1.316362e-02 3 1  ON 15
ci_017                 1.055550e-02 3 1  ON 16
ci_018                 1.052255e-02 3 1  ON 17
ci_019                -3.319700e-03 3 1  ON 18
ci_020                -3.750389e-03 3 1  ON 19
ci_021                -8.627062e-03 3 1  ON 20
ci_022                -9.309464e-03 3 1  ON 21
ci_023                 7.978600e-03 3 1  ON 22
ci_024                 7.707131e-03 3 1  ON 23
ci_025                 4.031317e-03 3 1  ON 24
ci_026                 3.835044e-03 3 1  ON 25
ci_027                 6.401105e-03 3 1  ON 26
ci_028                 6.650086e-03 3 1  ON 27
ci_029                -5.122531e-03 3 1  ON 28
ci_030                -4.949233e-03 3 1  ON 29
ci_031                -7.937093e-03 3 1  ON 30
ci_032                -7.190121e-03 3 1  ON 31
ci_033                 3.752700e-03 3 1  ON 32
ci_034                 4.586899e-03 3 1  ON 33
ci_035                 1.230160e-03 3 1  ON 34
ci_036                 1.366358e-03 3 1  ON 35
ci_037                 5.452280e-03 3 1  ON 36
ci_038                 5.242744e-03 3 1  ON 37
ci_039                 5.290972e-03 3 1  ON 38
ci_040                 5.187196e-03 3 1  ON 39
ci_041                 4.651106e-03 3 1  ON 40
ci_042                 5.042192e-03 3 1  ON 41
ci_043                 5.120371e-03 3 1  ON 42
ci_044                 4.946435e-03 3 1  ON 43
ci_045                 2.506087e-03 3 1  ON 44
ci_046                 2.604869e-03 3 1  ON 45
ci_047                -3.525314e-04 3 1  ON 46
ci_048                -5.537381e-04 3 1  ON 47
ci_049                 1.560103e-03 3 1  ON 48
ci_050                 1.133930e-03 3 1  ON 49
ci_051                -1.903964e-03 3 1  ON 50
ci_052                -9.796391e-04 3 1  ON 51
ci_053                -3.186348e-03 3 1  ON 52
ci_054                -2.907752e-03 3 1  ON 53
ci_055                -1.299713e-03 3 1  ON 54
ci_056                -9.208394e-04 3 1  ON 55
ci_057                -1.685963e-03 3 1  ON 56
ci_058                -1.440367e-03 3 1  ON 57
ci_059                 1.341004e-04 3 1  ON 58
ci_060                 6.995124e-05 3 1  ON 59
ci_061                -5.679927e-04 3 1  ON 60
ci_062                -6.315851e-04 3 1  ON 61
ci_063                -4.259936e-04 3 1  ON 62
ci_064                -8.317625e-04 3 1  ON 63
ci_065                -2.987532e-03 3 1  ON 64
ci_066                -2.440853e-03 3 1  ON 65
ci_067                -1.933913e-03 3 1  ON 66
ci_068                -2.346061e-03 3 1  ON 67
ci_069                -1.339720e-04 3 1  ON 68
ci_070                 7.536609e-05 3 1  ON 69
ci_071                -2.608883e-03 3 1  ON 70
ci_072                -1.054673e-03 3 1  ON 71
ci_073                 1.388271e-04 3 1  ON 72
ci_074                 4.880988e-04 3 1  ON 73
ci_075                -4.309208e-04 3 1  ON 74
ci_076                -1.578330e-05 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="250">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =8000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 11
    time step          = 0.05
    reference energy   = -22.5897
    reference variance = 0.463387
====================================================
  Execution time = 1.0063e+02
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s011
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 62500 
  VMC Eavg = -2.2669e+01
  VMC Evar = 5.1407e-01
  Total weights = 7.8204e+06
  Execution time = 1.4436e+01
  </log>
</opt>
<opt stage="main" walkers="62500">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

ERROR CostFunction-> Number of Effective Walkers is too small! 
  Number of effective walkers (samples) / total number of samples = 0.00153842
  User specified threshold minwalkers = 0.3
  If this message appears frequently. You might have to be cautious. 
  Find info about parameter "minwalkers" in the user manual!
Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.501639394415
                                         uncertainty =       0.002918817264

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.501639394415
                                         uncertainty =       0.002918817264

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000250408382
  error estimate for blocks of size 2^( 2) =       0.000259274635
  error estimate for blocks of size 2^( 3) =       0.000267293535
  error estimate for blocks of size 2^( 4) =       0.000272967302
  error estimate for blocks of size 2^( 5) =       0.000276116348
  error estimate for blocks of size 2^( 6) =       0.000277946047
  error estimate for blocks of size 2^( 7) =       0.000278581050
  error estimate for blocks of size 2^( 8) =       0.000279021145
  error estimate for blocks of size 2^( 9) =       0.000277958984

      target function =                  N/A
              le_mean =     -22.669044643171
             les_mean =     514.642973927556
             stat err =       0.000278376807
             autocorr =       1.235857425328
              std dev =       0.708261861295
             le_variance =       0.501634864165

ERROR CostFunction-> Number of Effective Walkers is too small! 
  Number of effective walkers (samples) / total number of samples = 0.0326724
  User specified threshold minwalkers = 0.3
  If this message appears frequently. You might have to be cautious. 
  Find info about parameter "minwalkers" in the user manual!
Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.500874377379
                                         uncertainty =       0.002853073342

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.500874377379
                                         uncertainty =       0.002853073342

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000250217468
  error estimate for blocks of size 2^( 2) =       0.000259095429
  error estimate for blocks of size 2^( 3) =       0.000267122555
  error estimate for blocks of size 2^( 4) =       0.000272813417
  error estimate for blocks of size 2^( 5) =       0.000275966732
  error estimate for blocks of size 2^( 6) =       0.000277813631
  error estimate for blocks of size 2^( 7) =       0.000278415439
  error estimate for blocks of size 2^( 8) =       0.000278886951
  error estimate for blocks of size 2^( 9) =       0.000277787883

      target function =                  N/A
              le_mean =     -22.669023932443
             les_mean =     514.400980276826
             stat err =       0.000278225976
             autocorr =       1.236403136264
              std dev =       0.707721874638
             le_variance =       0.500870251841

ERROR CostFunction-> Number of Effective Walkers is too small! 
  Number of effective walkers (samples) / total number of samples = 0.00154972
  User specified threshold minwalkers = 0.3
  If this message appears frequently. You might have to be cautious. 
  Find info about parameter "minwalkers" in the user manual!
Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.504987050736
                                         uncertainty =       0.003927496417

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.504987050736
                                         uncertainty =       0.003927496417

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000251243573
  error estimate for blocks of size 2^( 2) =       0.000260080928
  error estimate for blocks of size 2^( 3) =       0.000268088868
  error estimate for blocks of size 2^( 4) =       0.000273770159
  error estimate for blocks of size 2^( 5) =       0.000276918507
  error estimate for blocks of size 2^( 6) =       0.000278720206
  error estimate for blocks of size 2^( 7) =       0.000279350979
  error estimate for blocks of size 2^( 8) =       0.000279879532
  error estimate for blocks of size 2^( 9) =       0.000278733420

      target function =                  N/A
              le_mean =     -22.669064719257
             les_mean =     520.458541794205
             stat err =       0.000279171034
             autocorr =       1.234669697601
              std dev =       0.710624136078
             le_variance =       0.504986662776

ERROR CostFunction-> Number of Effective Walkers is too small! 
  Number of effective walkers (samples) / total number of samples = 0.0142799
  User specified threshold minwalkers = 0.3
  If this message appears frequently. You might have to be cautious. 
  Find info about parameter "minwalkers" in the user manual!
Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.501769588729
                                         uncertainty =       0.002953160169

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.501769588729
                                         uncertainty =       0.002953160169

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000250441209
  error estimate for blocks of size 2^( 2) =       0.000259305739
  error estimate for blocks of size 2^( 3) =       0.000267327487
  error estimate for blocks of size 2^( 4) =       0.000273017957
  error estimate for blocks of size 2^( 5) =       0.000276167355
  error estimate for blocks of size 2^( 6) =       0.000278005712
  error estimate for blocks of size 2^( 7) =       0.000278616845
  error estimate for blocks of size 2^( 8) =       0.000279090551
  error estimate for blocks of size 2^( 9) =       0.000277956213

      target function =                  N/A
              le_mean =     -22.669013436936
             les_mean =     514.847925448547
             stat err =       0.000278417330
             autocorr =       1.235893209147
              std dev =       0.708354708347
             le_variance =       0.501766392838


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.669044643171        initial
     2.4414e-02     2.4414e-01             1.3667e-03       -22.669023932443
     9.7656e-02     9.7656e-01             9.8165e-04       -22.669064719257  <--
     3.9062e-01     3.9062e+00             4.5710e-04       -22.669013436936

*****************************************************************************
Applying the update for shift_i =   9.7656e-02     and shift_s =   9.7656e-01
*****************************************************************************

  Execution time = 1.7310e+02
  </log>
  <optVariables href="FORM.s011.opt.xml">
ci_001                -7.055893e-01 3 1  ON 0
ci_002                -7.055456e-01 3 1  ON 1
ci_003                -3.749750e-02 3 1  ON 2
ci_004                -3.837968e-02 3 1  ON 3
ci_005                 1.562830e-02 3 1  ON 4
ci_006                 1.579018e-02 3 1  ON 5
ci_007                 1.222311e-02 3 1  ON 6
ci_008                 1.179177e-02 3 1  ON 7
ci_009                -1.188821e-02 3 1  ON 8
ci_010                -1.174118e-02 3 1  ON 9
ci_011                -8.525657e-03 3 1  ON 10
ci_012                -8.144852e-03 3 1  ON 11
ci_013                 9.804746e-03 3 1  ON 12
ci_014                 9.734780e-03 3 1  ON 13
ci_015                 1.214160e-02 3 1  ON 14
ci_016                 1.316362e-02 3 1  ON 15
ci_017                 1.055550e-02 3 1  ON 16
ci_018                 1.052255e-02 3 1  ON 17
ci_019                -3.319700e-03 3 1  ON 18
ci_020                -3.750389e-03 3 1  ON 19
ci_021                -8.627062e-03 3 1  ON 20
ci_022                -9.309464e-03 3 1  ON 21
ci_023                 7.978600e-03 3 1  ON 22
ci_024                 7.707131e-03 3 1  ON 23
ci_025                 4.031317e-03 3 1  ON 24
ci_026                 3.835044e-03 3 1  ON 25
ci_027                 6.401105e-03 3 1  ON 26
ci_028                 6.650086e-03 3 1  ON 27
ci_029                -5.122531e-03 3 1  ON 28
ci_030                -4.949233e-03 3 1  ON 29
ci_031                -7.937093e-03 3 1  ON 30
ci_032                -7.190121e-03 3 1  ON 31
ci_033                 3.752700e-03 3 1  ON 32
ci_034                 4.586899e-03 3 1  ON 33
ci_035                 1.230160e-03 3 1  ON 34
ci_036                 1.366358e-03 3 1  ON 35
ci_037                 5.452280e-03 3 1  ON 36
ci_038                 5.242744e-03 3 1  ON 37
ci_039                 5.290972e-03 3 1  ON 38
ci_040                 5.187196e-03 3 1  ON 39
ci_041                 4.651106e-03 3 1  ON 40
ci_042                 5.042192e-03 3 1  ON 41
ci_043                 5.120371e-03 3 1  ON 42
ci_044                 4.946435e-03 3 1  ON 43
ci_045                 2.506087e-03 3 1  ON 44
ci_046                 2.604869e-03 3 1  ON 45
ci_047                -3.525314e-04 3 1  ON 46
ci_048                -5.537381e-04 3 1  ON 47
ci_049                 1.560103e-03 3 1  ON 48
ci_050                 1.133930e-03 3 1  ON 49
ci_051                -1.903964e-03 3 1  ON 50
ci_052                -9.796391e-04 3 1  ON 51
ci_053                -3.186348e-03 3 1  ON 52
ci_054                -2.907752e-03 3 1  ON 53
ci_055                -1.299713e-03 3 1  ON 54
ci_056                -9.208394e-04 3 1  ON 55
ci_057                -1.685963e-03 3 1  ON 56
ci_058                -1.440367e-03 3 1  ON 57
ci_059                 1.341004e-04 3 1  ON 58
ci_060                 6.995124e-05 3 1  ON 59
ci_061                -5.679927e-04 3 1  ON 60
ci_062                -6.315851e-04 3 1  ON 61
ci_063                -4.259936e-04 3 1  ON 62
ci_064                -8.317625e-04 3 1  ON 63
ci_065                -2.987532e-03 3 1  ON 64
ci_066                -2.440853e-03 3 1  ON 65
ci_067                -1.933913e-03 3 1  ON 66
ci_068                -2.346061e-03 3 1  ON 67
ci_069                -1.339720e-04 3 1  ON 68
ci_070                 7.536609e-05 3 1  ON 69
ci_071                -2.608883e-03 3 1  ON 70
ci_072                -1.054673e-03 3 1  ON 71
ci_073                 1.388271e-04 3 1  ON 72
ci_074                 4.880988e-04 3 1  ON 73
ci_075                -4.309208e-04 3 1  ON 74
ci_076                -1.578330e-05 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 2.9306e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s012 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s012 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=12  my_counter=0
  time step      = 5.0000e-02
  blocks         = 250
  steps          = 250
  substeps       = 10
  current        = 0
  target samples = 8.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">250</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">6.2500e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">8.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">6.2500e+04</parameter>
<parameter name="steps" condition="int">250</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2688e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="250">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =8000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 12
    time step          = 0.05
    reference energy   = -22.591
    reference variance = 0.314037
====================================================
  Execution time = 1.0177e+02
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s012
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 62500 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 6.1106e+04
  VMC Eavg = -2.2670e+01
  VMC Evar = 5.1193e-01
  Total weights = 7.820626247e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.8839e+01
  </log>
</opt>
<opt stage="main" walkers="62500">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.498223674902
                                         uncertainty =       0.001255539943

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.498223674902
                                         uncertainty =       0.001255539943

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000249555454
  error estimate for blocks of size 2^( 2) =       0.000258485961
  error estimate for blocks of size 2^( 3) =       0.000266374914
  error estimate for blocks of size 2^( 4) =       0.000271909817
  error estimate for blocks of size 2^( 5) =       0.000275098546
  error estimate for blocks of size 2^( 6) =       0.000277390492
  error estimate for blocks of size 2^( 7) =       0.000277829877
  error estimate for blocks of size 2^( 8) =       0.000278193820
  error estimate for blocks of size 2^( 9) =       0.000278192365

      target function =                  N/A
              le_mean =     -22.669669137833
             les_mean =     514.425824200210
             stat err =       0.000277901638
             autocorr =       1.240075375354
              std dev =       0.705849414504
             le_variance =       0.498223395956


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266966913783e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.4414e-02, overlap shift 2.4414e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.669669137860       residual = 5.27e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.669679890208       residual = 3.15e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.669682159256       residual = 4.74e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.669682282586       residual = 2.58e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.669682473111       residual = 1.84e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.669682488503       residual = 3.36e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.669682468622       residual = 4.86e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 2.4414e-02 is 1.593476e-03

solving harmonic davidson linear method for identity shift 9.7656e-02, overlap shift 9.7656e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.669669137860       residual = 5.27e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.669677028654       residual = 1.83e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.669678192864       residual = 1.31e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.669678184903       residual = 1.71e-08           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.669678190092       residual = 2.85e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          4 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 9.7656e-02 is 9.662151e-04

solving harmonic davidson linear method for identity shift 3.9062e-01, overlap shift 3.9062e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.669669137860       residual = 5.27e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.669672959929       residual = 8.52e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.669673282914       residual = 2.61e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.669673286863       residual = 9.50e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 3.9062e-01 is 4.611459e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.270862 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.2063e+02
  </log>
  <optVariables href="FORM.s012.opt.xml">
ci_001                -7.052538e-01 3 1  ON 0
ci_002                -7.058980e-01 3 1  ON 1
ci_003                -3.747957e-02 3 1  ON 2
ci_004                -3.811731e-02 3 1  ON 3
ci_005                 1.582645e-02 3 1  ON 4
ci_006                 1.572619e-02 3 1  ON 5
ci_007                 1.218277e-02 3 1  ON 6
ci_008                 1.210305e-02 3 1  ON 7
ci_009                -1.163868e-02 3 1  ON 8
ci_010                -1.191164e-02 3 1  ON 9
ci_011                -7.559442e-03 3 1  ON 10
ci_012                -8.214932e-03 3 1  ON 11
ci_013                 9.234411e-03 3 1  ON 12
ci_014                 9.672442e-03 3 1  ON 13
ci_015                 1.230700e-02 3 1  ON 14
ci_016                 1.328213e-02 3 1  ON 15
ci_017                 1.093662e-02 3 1  ON 16
ci_018                 1.050453e-02 3 1  ON 17
ci_019                -3.727398e-03 3 1  ON 18
ci_020                -3.815450e-03 3 1  ON 19
ci_021                -9.112216e-03 3 1  ON 20
ci_022                -9.176553e-03 3 1  ON 21
ci_023                 7.834336e-03 3 1  ON 22
ci_024                 7.706929e-03 3 1  ON 23
ci_025                 3.449187e-03 3 1  ON 24
ci_026                 4.213119e-03 3 1  ON 25
ci_027                 6.492621e-03 3 1  ON 26
ci_028                 6.647124e-03 3 1  ON 27
ci_029                -4.935715e-03 3 1  ON 28
ci_030                -4.816557e-03 3 1  ON 29
ci_031                -8.039611e-03 3 1  ON 30
ci_032                -7.683572e-03 3 1  ON 31
ci_033                 3.740298e-03 3 1  ON 32
ci_034                 4.362496e-03 3 1  ON 33
ci_035                 1.183707e-03 3 1  ON 34
ci_036                 1.708602e-03 3 1  ON 35
ci_037                 5.312694e-03 3 1  ON 36
ci_038                 5.132907e-03 3 1  ON 37
ci_039                 5.473416e-03 3 1  ON 38
ci_040                 6.031454e-03 3 1  ON 39
ci_041                 4.473619e-03 3 1  ON 40
ci_042                 5.056569e-03 3 1  ON 41
ci_043                 5.370373e-03 3 1  ON 42
ci_044                 4.877609e-03 3 1  ON 43
ci_045                 2.456027e-03 3 1  ON 44
ci_046                 2.913871e-03 3 1  ON 45
ci_047                -3.588391e-04 3 1  ON 46
ci_048                -4.503152e-04 3 1  ON 47
ci_049                 1.889832e-03 3 1  ON 48
ci_050                 1.382668e-03 3 1  ON 49
ci_051                -1.048424e-03 3 1  ON 50
ci_052                -9.564049e-04 3 1  ON 51
ci_053                -3.133260e-03 3 1  ON 52
ci_054                -2.192558e-03 3 1  ON 53
ci_055                -1.466131e-03 3 1  ON 54
ci_056                -8.812570e-04 3 1  ON 55
ci_057                -1.311455e-03 3 1  ON 56
ci_058                -1.618795e-03 3 1  ON 57
ci_059                 1.843768e-04 3 1  ON 58
ci_060                -4.434933e-05 3 1  ON 59
ci_061                -2.590617e-04 3 1  ON 60
ci_062                 2.165548e-04 3 1  ON 61
ci_063                -7.741987e-04 3 1  ON 62
ci_064                -8.304716e-04 3 1  ON 63
ci_065                -2.580215e-03 3 1  ON 64
ci_066                -1.806061e-03 3 1  ON 65
ci_067                -1.997496e-03 3 1  ON 66
ci_068                -2.267387e-03 3 1  ON 67
ci_069                -3.423319e-04 3 1  ON 68
ci_070                -3.339908e-05 3 1  ON 69
ci_071                -1.684896e-03 3 1  ON 70
ci_072                -1.164079e-03 3 1  ON 71
ci_073                 6.218199e-04 3 1  ON 72
ci_074                 3.423793e-04 3 1  ON 73
ci_075                -6.299533e-04 3 1  ON 74
ci_076                -3.362439e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="250">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =8000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 12
    time step          = 0.05
    reference energy   = -22.6269
    reference variance = 0.452699
====================================================
  Execution time = 1.0108e+02
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s012
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 62500 
  VMC Eavg = -2.2670e+01
  VMC Evar = 5.1280e-01
  Total weights = 7.8202e+06
  Execution time = 1.4414e+01
  </log>
</opt>
<opt stage="main" walkers="62500">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.499684071212
                                         uncertainty =       0.001739977469

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.499684071212
                                         uncertainty =       0.001739977469

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000249920610
  error estimate for blocks of size 2^( 2) =       0.000258747701
  error estimate for blocks of size 2^( 3) =       0.000266794323
  error estimate for blocks of size 2^( 4) =       0.000272444869
  error estimate for blocks of size 2^( 5) =       0.000276007961
  error estimate for blocks of size 2^( 6) =       0.000277361136
  error estimate for blocks of size 2^( 7) =       0.000278250249
  error estimate for blocks of size 2^( 8) =       0.000279321307
  error estimate for blocks of size 2^( 9) =       0.000280104747

      target function =                  N/A
              le_mean =     -22.669847110394
             les_mean =     514.451780214785
             stat err =       0.000278759360
             autocorr =       1.244098513872
              std dev =       0.706882233499
             le_variance =       0.499682492037

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.499768524193
                                         uncertainty =       0.001735904342

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.499768524193
                                         uncertainty =       0.001735904342

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000249941711
  error estimate for blocks of size 2^( 2) =       0.000258763374
  error estimate for blocks of size 2^( 3) =       0.000266802072
  error estimate for blocks of size 2^( 4) =       0.000272447933
  error estimate for blocks of size 2^( 5) =       0.000276014026
  error estimate for blocks of size 2^( 6) =       0.000277370900
  error estimate for blocks of size 2^( 7) =       0.000278269768
  error estimate for blocks of size 2^( 8) =       0.000279370666
  error estimate for blocks of size 2^( 9) =       0.000280152623

      target function =                  N/A
              le_mean =     -22.669833686408
             les_mean =     514.487298045656
             stat err =       0.000278790989
             autocorr =       1.244170756710
              std dev =       0.706941914484
             le_variance =       0.499766870454

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.499884209316
                                         uncertainty =       0.001729909602

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.499884209316
                                         uncertainty =       0.001729909602

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000249970635
  error estimate for blocks of size 2^( 2) =       0.000258789029
  error estimate for blocks of size 2^( 3) =       0.000266822815
  error estimate for blocks of size 2^( 4) =       0.000272466671
  error estimate for blocks of size 2^( 5) =       0.000276030702
  error estimate for blocks of size 2^( 6) =       0.000277383974
  error estimate for blocks of size 2^( 7) =       0.000278293613
  error estimate for blocks of size 2^( 8) =       0.000279401563
  error estimate for blocks of size 2^( 9) =       0.000280181463

      target function =                  N/A
              le_mean =     -22.669847731529
             les_mean =     514.439952934099
             stat err =       0.000278815153
             autocorr =       1.244098483951
              std dev =       0.707023724221
             le_variance =       0.499882546611

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.499633748250
                                         uncertainty =       0.001736578493

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.499633748250
                                         uncertainty =       0.001736578493

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000249908024
  error estimate for blocks of size 2^( 2) =       0.000258733803
  error estimate for blocks of size 2^( 3) =       0.000266777382
  error estimate for blocks of size 2^( 4) =       0.000272427045
  error estimate for blocks of size 2^( 5) =       0.000275992849
  error estimate for blocks of size 2^( 6) =       0.000277343163
  error estimate for blocks of size 2^( 7) =       0.000278236462
  error estimate for blocks of size 2^( 8) =       0.000279317456
  error estimate for blocks of size 2^( 9) =       0.000280112796

      target function =                  N/A
              le_mean =     -22.669842002084
             les_mean =     514.450487643153
             stat err =       0.000278752469
             autocorr =       1.244162321799
              std dev =       0.706846633880
             le_variance =       0.499632163828


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.669847110394        initial
     2.4414e-02     2.4414e-01             1.5935e-03       -22.669833686408
     9.7656e-02     9.7656e-01             9.6622e-04       -22.669847731529  <--
     3.9062e-01     3.9062e+00             4.6115e-04       -22.669842002084

*****************************************************************************
Applying the update for shift_i =   9.7656e-02     and shift_s =   9.7656e-01
*****************************************************************************

  Execution time = 1.7342e+02
  </log>
  <optVariables href="FORM.s012.opt.xml">
ci_001                -7.052538e-01 3 1  ON 0
ci_002                -7.058980e-01 3 1  ON 1
ci_003                -3.747957e-02 3 1  ON 2
ci_004                -3.811731e-02 3 1  ON 3
ci_005                 1.582645e-02 3 1  ON 4
ci_006                 1.572619e-02 3 1  ON 5
ci_007                 1.218277e-02 3 1  ON 6
ci_008                 1.210305e-02 3 1  ON 7
ci_009                -1.163868e-02 3 1  ON 8
ci_010                -1.191164e-02 3 1  ON 9
ci_011                -7.559442e-03 3 1  ON 10
ci_012                -8.214932e-03 3 1  ON 11
ci_013                 9.234411e-03 3 1  ON 12
ci_014                 9.672442e-03 3 1  ON 13
ci_015                 1.230700e-02 3 1  ON 14
ci_016                 1.328213e-02 3 1  ON 15
ci_017                 1.093662e-02 3 1  ON 16
ci_018                 1.050453e-02 3 1  ON 17
ci_019                -3.727398e-03 3 1  ON 18
ci_020                -3.815450e-03 3 1  ON 19
ci_021                -9.112216e-03 3 1  ON 20
ci_022                -9.176553e-03 3 1  ON 21
ci_023                 7.834336e-03 3 1  ON 22
ci_024                 7.706929e-03 3 1  ON 23
ci_025                 3.449187e-03 3 1  ON 24
ci_026                 4.213119e-03 3 1  ON 25
ci_027                 6.492621e-03 3 1  ON 26
ci_028                 6.647124e-03 3 1  ON 27
ci_029                -4.935715e-03 3 1  ON 28
ci_030                -4.816557e-03 3 1  ON 29
ci_031                -8.039611e-03 3 1  ON 30
ci_032                -7.683572e-03 3 1  ON 31
ci_033                 3.740298e-03 3 1  ON 32
ci_034                 4.362496e-03 3 1  ON 33
ci_035                 1.183707e-03 3 1  ON 34
ci_036                 1.708602e-03 3 1  ON 35
ci_037                 5.312694e-03 3 1  ON 36
ci_038                 5.132907e-03 3 1  ON 37
ci_039                 5.473416e-03 3 1  ON 38
ci_040                 6.031454e-03 3 1  ON 39
ci_041                 4.473619e-03 3 1  ON 40
ci_042                 5.056569e-03 3 1  ON 41
ci_043                 5.370373e-03 3 1  ON 42
ci_044                 4.877609e-03 3 1  ON 43
ci_045                 2.456027e-03 3 1  ON 44
ci_046                 2.913871e-03 3 1  ON 45
ci_047                -3.588391e-04 3 1  ON 46
ci_048                -4.503152e-04 3 1  ON 47
ci_049                 1.889832e-03 3 1  ON 48
ci_050                 1.382668e-03 3 1  ON 49
ci_051                -1.048424e-03 3 1  ON 50
ci_052                -9.564049e-04 3 1  ON 51
ci_053                -3.133260e-03 3 1  ON 52
ci_054                -2.192558e-03 3 1  ON 53
ci_055                -1.466131e-03 3 1  ON 54
ci_056                -8.812570e-04 3 1  ON 55
ci_057                -1.311455e-03 3 1  ON 56
ci_058                -1.618795e-03 3 1  ON 57
ci_059                 1.843768e-04 3 1  ON 58
ci_060                -4.434933e-05 3 1  ON 59
ci_061                -2.590617e-04 3 1  ON 60
ci_062                 2.165548e-04 3 1  ON 61
ci_063                -7.741987e-04 3 1  ON 62
ci_064                -8.304716e-04 3 1  ON 63
ci_065                -2.580215e-03 3 1  ON 64
ci_066                -1.806061e-03 3 1  ON 65
ci_067                -1.997496e-03 3 1  ON 66
ci_068                -2.267387e-03 3 1  ON 67
ci_069                -3.423319e-04 3 1  ON 68
ci_070                -3.339908e-05 3 1  ON 69
ci_071                -1.684896e-03 3 1  ON 70
ci_072                -1.164079e-03 3 1  ON 71
ci_073                 6.218199e-04 3 1  ON 72
ci_074                 3.423793e-04 3 1  ON 73
ci_075                -6.299533e-04 3 1  ON 74
ci_076                -3.362439e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 2.9407e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s013 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s013 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=13  my_counter=0
  time step      = 5.0000e-02
  blocks         = 250
  steps          = 250
  substeps       = 10
  current        = 0
  target samples = 8.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">250</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">6.2500e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">8.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">6.2500e+04</parameter>
<parameter name="steps" condition="int">250</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2682e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="250">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =8000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 13
    time step          = 0.05
    reference energy   = -22.669
    reference variance = 0.695995
====================================================
  Execution time = 1.0135e+02
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s013
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 62500 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 6.1096e+04
  VMC Eavg = -2.2670e+01
  VMC Evar = 5.1458e-01
  Total weights = 7.820484794e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.8682e+01
  </log>
</opt>
<opt stage="main" walkers="62500">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.501303513606
                                         uncertainty =       0.001776742921

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.501303513606
                                         uncertainty =       0.001776742921

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000250326219
  error estimate for blocks of size 2^( 2) =       0.000259362821
  error estimate for blocks of size 2^( 3) =       0.000267344532
  error estimate for blocks of size 2^( 4) =       0.000272976877
  error estimate for blocks of size 2^( 5) =       0.000276653377
  error estimate for blocks of size 2^( 6) =       0.000278847596
  error estimate for blocks of size 2^( 7) =       0.000279703301
  error estimate for blocks of size 2^( 8) =       0.000280213069
  error estimate for blocks of size 2^( 9) =       0.000280369022

      target function =                  N/A
              le_mean =     -22.669753323395
             les_mean =     514.432299563212
             stat err =       0.000279783247
             autocorr =       1.249196424705
              std dev =       0.708029467568
             le_variance =       0.501305726944


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266975332339e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.4414e-02, overlap shift 2.4414e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.669753323416       residual = 4.98e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.669766422564       residual = 2.19e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.669767147943       residual = 2.38e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.669766857241       residual = 1.00e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.669767378284       residual = 8.63e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.669767259752       residual = 1.71e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.669767183330       residual = 1.70e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 2.4414e-02 is 1.042466e-03

solving harmonic davidson linear method for identity shift 9.7656e-02, overlap shift 9.7656e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.669753323416       residual = 4.98e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.669762900913       residual = 1.11e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.669763409887       residual = 6.57e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.669763332792       residual = 9.14e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 9.7656e-02 is 7.770615e-04

solving harmonic davidson linear method for identity shift 3.9062e-01, overlap shift 3.9062e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.669753323416       residual = 4.98e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.669757938218       residual = 4.50e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.669758272097       residual = 9.92e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 3.9062e-01 is 3.967848e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.272623 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.2004e+02
  </log>
  <optVariables href="FORM.s013.opt.xml">
ci_001                -7.050268e-01 3 1  ON 0
ci_002                -7.061056e-01 3 1  ON 1
ci_003                -3.740993e-02 3 1  ON 2
ci_004                -3.819250e-02 3 1  ON 3
ci_005                 1.577621e-02 3 1  ON 4
ci_006                 1.546739e-02 3 1  ON 5
ci_007                 1.237379e-02 3 1  ON 6
ci_008                 1.259717e-02 3 1  ON 7
ci_009                -1.153720e-02 3 1  ON 8
ci_010                -1.172103e-02 3 1  ON 9
ci_011                -8.240136e-03 3 1  ON 10
ci_012                -8.024365e-03 3 1  ON 11
ci_013                 9.315774e-03 3 1  ON 12
ci_014                 9.689628e-03 3 1  ON 13
ci_015                 1.220590e-02 3 1  ON 14
ci_016                 1.391551e-02 3 1  ON 15
ci_017                 1.097789e-02 3 1  ON 16
ci_018                 1.105771e-02 3 1  ON 17
ci_019                -3.754701e-03 3 1  ON 18
ci_020                -3.436739e-03 3 1  ON 19
ci_021                -8.956747e-03 3 1  ON 20
ci_022                -9.423227e-03 3 1  ON 21
ci_023                 7.716647e-03 3 1  ON 22
ci_024                 7.879719e-03 3 1  ON 23
ci_025                 4.052608e-03 3 1  ON 24
ci_026                 4.238017e-03 3 1  ON 25
ci_027                 6.657380e-03 3 1  ON 26
ci_028                 6.482907e-03 3 1  ON 27
ci_029                -4.900757e-03 3 1  ON 28
ci_030                -4.669275e-03 3 1  ON 29
ci_031                -8.155893e-03 3 1  ON 30
ci_032                -7.900024e-03 3 1  ON 31
ci_033                 4.232279e-03 3 1  ON 32
ci_034                 4.242528e-03 3 1  ON 33
ci_035                 1.290488e-03 3 1  ON 34
ci_036                 1.778158e-03 3 1  ON 35
ci_037                 4.821834e-03 3 1  ON 36
ci_038                 4.656520e-03 3 1  ON 37
ci_039                 5.310963e-03 3 1  ON 38
ci_040                 5.380807e-03 3 1  ON 39
ci_041                 5.250681e-03 3 1  ON 40
ci_042                 4.593127e-03 3 1  ON 41
ci_043                 4.725973e-03 3 1  ON 42
ci_044                 5.244892e-03 3 1  ON 43
ci_045                 2.778895e-03 3 1  ON 44
ci_046                 2.952616e-03 3 1  ON 45
ci_047                -5.887729e-04 3 1  ON 46
ci_048                -5.307794e-04 3 1  ON 47
ci_049                 1.643616e-03 3 1  ON 48
ci_050                 1.338065e-03 3 1  ON 49
ci_051                -9.885940e-04 3 1  ON 50
ci_052                -1.623654e-03 3 1  ON 51
ci_053                -2.613128e-03 3 1  ON 52
ci_054                -2.150854e-03 3 1  ON 53
ci_055                -1.190165e-03 3 1  ON 54
ci_056                -1.220587e-03 3 1  ON 55
ci_057                -1.258961e-03 3 1  ON 56
ci_058                -1.482015e-03 3 1  ON 57
ci_059                 5.455705e-04 3 1  ON 58
ci_060                 9.982885e-05 3 1  ON 59
ci_061                -4.985831e-04 3 1  ON 60
ci_062                -5.472444e-05 3 1  ON 61
ci_063                -9.663256e-04 3 1  ON 62
ci_064                -1.176770e-03 3 1  ON 63
ci_065                -2.256401e-03 3 1  ON 64
ci_066                -2.356430e-03 3 1  ON 65
ci_067                -2.539525e-03 3 1  ON 66
ci_068                -2.437260e-03 3 1  ON 67
ci_069                -4.707242e-04 3 1  ON 68
ci_070                -3.114930e-04 3 1  ON 69
ci_071                -1.587339e-03 3 1  ON 70
ci_072                -1.307505e-03 3 1  ON 71
ci_073                -5.298632e-05 3 1  ON 72
ci_074                 4.771131e-04 3 1  ON 73
ci_075                -1.243465e-04 3 1  ON 74
ci_076                -2.406306e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="250">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =8000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 13
    time step          = 0.05
    reference energy   = -22.7288
    reference variance = 0.562653
====================================================
  Execution time = 1.0065e+02
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s013
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 62500 
  VMC Eavg = -2.2670e+01
  VMC Evar = 5.1117e-01
  Total weights = 7.8211e+06
  Execution time = 1.4436e+01
  </log>
</opt>
<opt stage="main" walkers="62500">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.501783794603
                                         uncertainty =       0.004318936310

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.501783794603
                                         uncertainty =       0.004318936310

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000250445330
  error estimate for blocks of size 2^( 2) =       0.000259279398
  error estimate for blocks of size 2^( 3) =       0.000267170975
  error estimate for blocks of size 2^( 4) =       0.000272877848
  error estimate for blocks of size 2^( 5) =       0.000276282787
  error estimate for blocks of size 2^( 6) =       0.000277880679
  error estimate for blocks of size 2^( 7) =       0.000278635119
  error estimate for blocks of size 2^( 8) =       0.000278759044
  error estimate for blocks of size 2^( 9) =       0.000277800211

      target function =                  N/A
              le_mean =     -22.669803636890
             les_mean =     514.729633665272
             stat err =       0.000278268763
             autocorr =       1.234533951037
              std dev =       0.708366365503
             le_variance =       0.501782907776

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.497727913405
                                         uncertainty =       0.001347002263

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.497727913405
                                         uncertainty =       0.001347002263

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000249431907
  error estimate for blocks of size 2^( 2) =       0.000258298537
  error estimate for blocks of size 2^( 3) =       0.000266214854
  error estimate for blocks of size 2^( 4) =       0.000271955440
  error estimate for blocks of size 2^( 5) =       0.000275376273
  error estimate for blocks of size 2^( 6) =       0.000277015896
  error estimate for blocks of size 2^( 7) =       0.000277790611
  error estimate for blocks of size 2^( 8) =       0.000277861080
  error estimate for blocks of size 2^( 9) =       0.000277060097

      target function =                  N/A
              le_mean =     -22.669820997646
             les_mean =     514.435380004854
             stat err =       0.000277431921
             autocorr =       1.237111501889
              std dev =       0.705499971357
             le_variance =       0.497730209585

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.497946856247
                                         uncertainty =       0.001349529646

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.497946856247
                                         uncertainty =       0.001349529646

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000249486737
  error estimate for blocks of size 2^( 2) =       0.000258352350
  error estimate for blocks of size 2^( 3) =       0.000266267622
  error estimate for blocks of size 2^( 4) =       0.000272009163
  error estimate for blocks of size 2^( 5) =       0.000275429719
  error estimate for blocks of size 2^( 6) =       0.000277074120
  error estimate for blocks of size 2^( 7) =       0.000277843678
  error estimate for blocks of size 2^( 8) =       0.000277905168
  error estimate for blocks of size 2^( 9) =       0.000277149495

      target function =                  N/A
              le_mean =     -22.669833673574
             les_mean =     514.464492035879
             stat err =       0.000277493115
             autocorr =       1.237113364177
              std dev =       0.705655054283
             le_variance =       0.497949055635

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.498015406259
                                         uncertainty =       0.001502077796

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.498015406259
                                         uncertainty =       0.001502077796

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000249503836
  error estimate for blocks of size 2^( 2) =       0.000258367653
  error estimate for blocks of size 2^( 3) =       0.000266282368
  error estimate for blocks of size 2^( 4) =       0.000272017590
  error estimate for blocks of size 2^( 5) =       0.000275435670
  error estimate for blocks of size 2^( 6) =       0.000277067311
  error estimate for blocks of size 2^( 7) =       0.000277834725
  error estimate for blocks of size 2^( 8) =       0.000277917012
  error estimate for blocks of size 2^( 9) =       0.000277092301

      target function =                  N/A
              le_mean =     -22.669814464103
             les_mean =     514.484914188460
             stat err =       0.000277477837
             autocorr =       1.236807612392
              std dev =       0.705703416164
             le_variance =       0.498017311585


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.669803636890        initial
     2.4414e-02     2.4414e-01             1.0425e-03       -22.669820997646
     9.7656e-02     9.7656e-01             7.7706e-04       -22.669833673574  <--
     3.9062e-01     3.9062e+00             3.9678e-04       -22.669814464103

*****************************************************************************
Applying the update for shift_i =   9.7656e-02     and shift_s =   9.7656e-01
*****************************************************************************

  Execution time = 1.7318e+02
  </log>
  <optVariables href="FORM.s013.opt.xml">
ci_001                -7.050268e-01 3 1  ON 0
ci_002                -7.061056e-01 3 1  ON 1
ci_003                -3.740993e-02 3 1  ON 2
ci_004                -3.819250e-02 3 1  ON 3
ci_005                 1.577621e-02 3 1  ON 4
ci_006                 1.546739e-02 3 1  ON 5
ci_007                 1.237379e-02 3 1  ON 6
ci_008                 1.259717e-02 3 1  ON 7
ci_009                -1.153720e-02 3 1  ON 8
ci_010                -1.172103e-02 3 1  ON 9
ci_011                -8.240136e-03 3 1  ON 10
ci_012                -8.024365e-03 3 1  ON 11
ci_013                 9.315774e-03 3 1  ON 12
ci_014                 9.689628e-03 3 1  ON 13
ci_015                 1.220590e-02 3 1  ON 14
ci_016                 1.391551e-02 3 1  ON 15
ci_017                 1.097789e-02 3 1  ON 16
ci_018                 1.105771e-02 3 1  ON 17
ci_019                -3.754701e-03 3 1  ON 18
ci_020                -3.436739e-03 3 1  ON 19
ci_021                -8.956747e-03 3 1  ON 20
ci_022                -9.423227e-03 3 1  ON 21
ci_023                 7.716647e-03 3 1  ON 22
ci_024                 7.879719e-03 3 1  ON 23
ci_025                 4.052608e-03 3 1  ON 24
ci_026                 4.238017e-03 3 1  ON 25
ci_027                 6.657380e-03 3 1  ON 26
ci_028                 6.482907e-03 3 1  ON 27
ci_029                -4.900757e-03 3 1  ON 28
ci_030                -4.669275e-03 3 1  ON 29
ci_031                -8.155893e-03 3 1  ON 30
ci_032                -7.900024e-03 3 1  ON 31
ci_033                 4.232279e-03 3 1  ON 32
ci_034                 4.242528e-03 3 1  ON 33
ci_035                 1.290488e-03 3 1  ON 34
ci_036                 1.778158e-03 3 1  ON 35
ci_037                 4.821834e-03 3 1  ON 36
ci_038                 4.656520e-03 3 1  ON 37
ci_039                 5.310963e-03 3 1  ON 38
ci_040                 5.380807e-03 3 1  ON 39
ci_041                 5.250681e-03 3 1  ON 40
ci_042                 4.593127e-03 3 1  ON 41
ci_043                 4.725973e-03 3 1  ON 42
ci_044                 5.244892e-03 3 1  ON 43
ci_045                 2.778895e-03 3 1  ON 44
ci_046                 2.952616e-03 3 1  ON 45
ci_047                -5.887729e-04 3 1  ON 46
ci_048                -5.307794e-04 3 1  ON 47
ci_049                 1.643616e-03 3 1  ON 48
ci_050                 1.338065e-03 3 1  ON 49
ci_051                -9.885940e-04 3 1  ON 50
ci_052                -1.623654e-03 3 1  ON 51
ci_053                -2.613128e-03 3 1  ON 52
ci_054                -2.150854e-03 3 1  ON 53
ci_055                -1.190165e-03 3 1  ON 54
ci_056                -1.220587e-03 3 1  ON 55
ci_057                -1.258961e-03 3 1  ON 56
ci_058                -1.482015e-03 3 1  ON 57
ci_059                 5.455705e-04 3 1  ON 58
ci_060                 9.982885e-05 3 1  ON 59
ci_061                -4.985831e-04 3 1  ON 60
ci_062                -5.472444e-05 3 1  ON 61
ci_063                -9.663256e-04 3 1  ON 62
ci_064                -1.176770e-03 3 1  ON 63
ci_065                -2.256401e-03 3 1  ON 64
ci_066                -2.356430e-03 3 1  ON 65
ci_067                -2.539525e-03 3 1  ON 66
ci_068                -2.437260e-03 3 1  ON 67
ci_069                -4.707242e-04 3 1  ON 68
ci_070                -3.114930e-04 3 1  ON 69
ci_071                -1.587339e-03 3 1  ON 70
ci_072                -1.307505e-03 3 1  ON 71
ci_073                -5.298632e-05 3 1  ON 72
ci_074                 4.771131e-04 3 1  ON 73
ci_075                -1.243465e-04 3 1  ON 74
ci_076                -2.406306e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 2.9326e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s014 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s014 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=14  my_counter=0
  time step      = 5.0000e-02
  blocks         = 250
  steps          = 250
  substeps       = 10
  current        = 0
  target samples = 8.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">250</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">6.2500e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">8.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">6.2500e+04</parameter>
<parameter name="steps" condition="int">250</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2683e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="250">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =8000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 14
    time step          = 0.05
    reference energy   = -22.6325
    reference variance = 0.482525
====================================================
  Execution time = 1.0107e+02
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s014
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 62500 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 6.1040e+04
  VMC Eavg = -2.2670e+01
  VMC Evar = 5.0896e-01
  Total weights = 7.820589954e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.8810e+01
  </log>
</opt>
<opt stage="main" walkers="62500">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.496803992509
                                         uncertainty =       0.001357494036

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.496803992509
                                         uncertainty =       0.001357494036

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000249199230
  error estimate for blocks of size 2^( 2) =       0.000258151985
  error estimate for blocks of size 2^( 3) =       0.000266155514
  error estimate for blocks of size 2^( 4) =       0.000271693574
  error estimate for blocks of size 2^( 5) =       0.000275047281
  error estimate for blocks of size 2^( 6) =       0.000276463609
  error estimate for blocks of size 2^( 7) =       0.000277250906
  error estimate for blocks of size 2^( 8) =       0.000276375724
  error estimate for blocks of size 2^( 9) =       0.000275772785

      target function =                  N/A
              le_mean =     -22.669672008113
             les_mean =     514.422987723940
             stat err =       0.000276465756
             autocorr =       1.230805132651
              std dev =       0.704841862110
             le_variance =       0.496802050583


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266967200811e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.4414e-02, overlap shift 2.4414e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.669672008139       residual = 4.68e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.669686272469       residual = 4.17e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.669686729015       residual = 3.59e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.669686765504       residual = 5.50e-08           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.669686571398       residual = 9.87e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          4 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 2.4414e-02 is 1.023583e-03

solving harmonic davidson linear method for identity shift 9.7656e-02, overlap shift 9.7656e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.669672008139       residual = 4.68e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.669682327388       residual = 2.22e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.669682321754       residual = 1.12e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.669682317951       residual = 7.83e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 9.7656e-02 is 6.684579e-04

solving harmonic davidson linear method for identity shift 3.9062e-01, overlap shift 3.9062e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.669672008139       residual = 4.68e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.669676907410       residual = 6.49e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.669676776552       residual = 2.15e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.669676770831       residual = 6.40e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 3.9062e-01 is 3.541429e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.274134 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.1990e+02
  </log>
  <optVariables href="FORM.s014.opt.xml">
ci_001                -7.049976e-01 3 1  ON 0
ci_002                -7.061740e-01 3 1  ON 1
ci_003                -3.772466e-02 3 1  ON 2
ci_004                -3.774540e-02 3 1  ON 3
ci_005                 1.553680e-02 3 1  ON 4
ci_006                 1.562941e-02 3 1  ON 5
ci_007                 1.229786e-02 3 1  ON 6
ci_008                 1.211603e-02 3 1  ON 7
ci_009                -1.151002e-02 3 1  ON 8
ci_010                -1.136137e-02 3 1  ON 9
ci_011                -7.848496e-03 3 1  ON 10
ci_012                -7.371633e-03 3 1  ON 11
ci_013                 9.516175e-03 3 1  ON 12
ci_014                 9.436009e-03 3 1  ON 13
ci_015                 1.282347e-02 3 1  ON 14
ci_016                 1.324705e-02 3 1  ON 15
ci_017                 1.039948e-02 3 1  ON 16
ci_018                 1.093870e-02 3 1  ON 17
ci_019                -3.746851e-03 3 1  ON 18
ci_020                -3.715954e-03 3 1  ON 19
ci_021                -9.153653e-03 3 1  ON 20
ci_022                -8.994169e-03 3 1  ON 21
ci_023                 7.191996e-03 3 1  ON 22
ci_024                 7.985448e-03 3 1  ON 23
ci_025                 4.491719e-03 3 1  ON 24
ci_026                 4.899824e-03 3 1  ON 25
ci_027                 6.833431e-03 3 1  ON 26
ci_028                 6.652071e-03 3 1  ON 27
ci_029                -5.001788e-03 3 1  ON 28
ci_030                -4.722409e-03 3 1  ON 29
ci_031                -8.057316e-03 3 1  ON 30
ci_032                -7.792737e-03 3 1  ON 31
ci_033                 4.500362e-03 3 1  ON 32
ci_034                 4.543425e-03 3 1  ON 33
ci_035                 1.374201e-03 3 1  ON 34
ci_036                 1.138501e-03 3 1  ON 35
ci_037                 4.864902e-03 3 1  ON 36
ci_038                 5.156266e-03 3 1  ON 37
ci_039                 5.507601e-03 3 1  ON 38
ci_040                 5.305130e-03 3 1  ON 39
ci_041                 5.604947e-03 3 1  ON 40
ci_042                 4.721495e-03 3 1  ON 41
ci_043                 4.848751e-03 3 1  ON 42
ci_044                 4.698992e-03 3 1  ON 43
ci_045                 3.231005e-03 3 1  ON 44
ci_046                 2.656547e-03 3 1  ON 45
ci_047                -5.078500e-04 3 1  ON 46
ci_048                -6.544691e-04 3 1  ON 47
ci_049                 1.983867e-03 3 1  ON 48
ci_050                 1.641794e-03 3 1  ON 49
ci_051                -1.008043e-03 3 1  ON 50
ci_052                -1.349261e-03 3 1  ON 51
ci_053                -3.012461e-03 3 1  ON 52
ci_054                -2.725777e-03 3 1  ON 53
ci_055                -1.169447e-03 3 1  ON 54
ci_056                -1.494348e-03 3 1  ON 55
ci_057                -1.385885e-03 3 1  ON 56
ci_058                -1.191861e-03 3 1  ON 57
ci_059                 5.766801e-04 3 1  ON 58
ci_060                 3.485746e-04 3 1  ON 59
ci_061                -4.285991e-04 3 1  ON 60
ci_062                -8.125571e-05 3 1  ON 61
ci_063                -6.136618e-04 3 1  ON 62
ci_064                -6.406463e-04 3 1  ON 63
ci_065                -2.150081e-03 3 1  ON 64
ci_066                -2.232753e-03 3 1  ON 65
ci_067                -2.683997e-03 3 1  ON 66
ci_068                -2.475840e-03 3 1  ON 67
ci_069                -3.201676e-04 3 1  ON 68
ci_070                -1.493197e-05 3 1  ON 69
ci_071                -1.978008e-03 3 1  ON 70
ci_072                -1.273322e-03 3 1  ON 71
ci_073                 2.403684e-04 3 1  ON 72
ci_074                 5.289288e-04 3 1  ON 73
ci_075                -3.539537e-04 3 1  ON 74
ci_076                -4.938066e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="250">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =8000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 14
    time step          = 0.05
    reference energy   = -22.7337
    reference variance = 0.808911
====================================================
  Execution time = 1.0065e+02
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s014
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 62500 
  VMC Eavg = -2.2669e+01
  VMC Evar = 5.0898e-01
  Total weights = 7.8206e+06
  Execution time = 1.4449e+01
  </log>
</opt>
<opt stage="main" walkers="62500">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.497831959005
                                         uncertainty =       0.001525016942

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.497831959005
                                         uncertainty =       0.001525016942

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000249458629
  error estimate for blocks of size 2^( 2) =       0.000258433308
  error estimate for blocks of size 2^( 3) =       0.000266563373
  error estimate for blocks of size 2^( 4) =       0.000272193866
  error estimate for blocks of size 2^( 5) =       0.000275191202
  error estimate for blocks of size 2^( 6) =       0.000277476666
  error estimate for blocks of size 2^( 7) =       0.000278923615
  error estimate for blocks of size 2^( 8) =       0.000279643088
  error estimate for blocks of size 2^( 9) =       0.000279835030

      target function =                  N/A
              le_mean =     -22.669496407411
             les_mean =     514.438379019405
             stat err =       0.000278969600
             autocorr =       1.250595025734
              std dev =       0.705575552596
             le_variance =       0.497836860421

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.497529202095
                                         uncertainty =       0.001519912688

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.497529202095
                                         uncertainty =       0.001519912688

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000249382772
  error estimate for blocks of size 2^( 2) =       0.000258358118
  error estimate for blocks of size 2^( 3) =       0.000266488607
  error estimate for blocks of size 2^( 4) =       0.000272119102
  error estimate for blocks of size 2^( 5) =       0.000275113060
  error estimate for blocks of size 2^( 6) =       0.000277389119
  error estimate for blocks of size 2^( 7) =       0.000278849356
  error estimate for blocks of size 2^( 8) =       0.000279552391
  error estimate for blocks of size 2^( 9) =       0.000279767416

      target function =                  N/A
              le_mean =     -22.669481424170
             les_mean =     514.420131966741
             stat err =       0.000278889570
             autocorr =       1.250638084221
              std dev =       0.705360997680
             le_variance =       0.497534137048

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.497807554744
                                         uncertainty =       0.001526955217

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.497807554744
                                         uncertainty =       0.001526955217

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000249452522
  error estimate for blocks of size 2^( 2) =       0.000258427400
  error estimate for blocks of size 2^( 3) =       0.000266550738
  error estimate for blocks of size 2^( 4) =       0.000272179917
  error estimate for blocks of size 2^( 5) =       0.000275172247
  error estimate for blocks of size 2^( 6) =       0.000277440861
  error estimate for blocks of size 2^( 7) =       0.000278915555
  error estimate for blocks of size 2^( 8) =       0.000279605623
  error estimate for blocks of size 2^( 9) =       0.000279832746

      target function =                  N/A
              le_mean =     -22.669490631527
             les_mean =     514.779850919828
             stat err =       0.000278948696
             autocorr =       1.250468840622
              std dev =       0.705558278961
             le_variance =       0.497812485011

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.497646941892
                                         uncertainty =       0.001527867647

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.497646941892
                                         uncertainty =       0.001527867647

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000249412273
  error estimate for blocks of size 2^( 2) =       0.000258387164
  error estimate for blocks of size 2^( 3) =       0.000266518714
  error estimate for blocks of size 2^( 4) =       0.000272149806
  error estimate for blocks of size 2^( 5) =       0.000275144219
  error estimate for blocks of size 2^( 6) =       0.000277424879
  error estimate for blocks of size 2^( 7) =       0.000278879223
  error estimate for blocks of size 2^( 8) =       0.000279594296
  error estimate for blocks of size 2^( 9) =       0.000279804924

      target function =                  N/A
              le_mean =     -22.669485222497
             les_mean =     514.418392239504
             stat err =       0.000278925831
             autocorr =       1.250667399050
              std dev =       0.705444438437
             le_variance =       0.497651855721


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.669496407411        initial  <--
     2.4414e-02     2.4414e-01             1.0236e-03       -22.669481424170
     9.7656e-02     9.7656e-01             6.6846e-04       -22.669490631527
     3.9062e-01     3.9062e+00             3.5414e-04       -22.669485222497

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 173.2083
  </log>
  <optVariables href="FORM.s014.opt.xml">
ci_001                -7.050268e-01 3 1  ON 0
ci_002                -7.061056e-01 3 1  ON 1
ci_003                -3.740993e-02 3 1  ON 2
ci_004                -3.819250e-02 3 1  ON 3
ci_005                 1.577621e-02 3 1  ON 4
ci_006                 1.546739e-02 3 1  ON 5
ci_007                 1.237379e-02 3 1  ON 6
ci_008                 1.259717e-02 3 1  ON 7
ci_009                -1.153720e-02 3 1  ON 8
ci_010                -1.172103e-02 3 1  ON 9
ci_011                -8.240136e-03 3 1  ON 10
ci_012                -8.024365e-03 3 1  ON 11
ci_013                 9.315774e-03 3 1  ON 12
ci_014                 9.689628e-03 3 1  ON 13
ci_015                 1.220590e-02 3 1  ON 14
ci_016                 1.391551e-02 3 1  ON 15
ci_017                 1.097789e-02 3 1  ON 16
ci_018                 1.105771e-02 3 1  ON 17
ci_019                -3.754701e-03 3 1  ON 18
ci_020                -3.436739e-03 3 1  ON 19
ci_021                -8.956747e-03 3 1  ON 20
ci_022                -9.423227e-03 3 1  ON 21
ci_023                 7.716647e-03 3 1  ON 22
ci_024                 7.879719e-03 3 1  ON 23
ci_025                 4.052608e-03 3 1  ON 24
ci_026                 4.238017e-03 3 1  ON 25
ci_027                 6.657380e-03 3 1  ON 26
ci_028                 6.482907e-03 3 1  ON 27
ci_029                -4.900757e-03 3 1  ON 28
ci_030                -4.669275e-03 3 1  ON 29
ci_031                -8.155893e-03 3 1  ON 30
ci_032                -7.900024e-03 3 1  ON 31
ci_033                 4.232279e-03 3 1  ON 32
ci_034                 4.242528e-03 3 1  ON 33
ci_035                 1.290488e-03 3 1  ON 34
ci_036                 1.778158e-03 3 1  ON 35
ci_037                 4.821834e-03 3 1  ON 36
ci_038                 4.656520e-03 3 1  ON 37
ci_039                 5.310963e-03 3 1  ON 38
ci_040                 5.380807e-03 3 1  ON 39
ci_041                 5.250681e-03 3 1  ON 40
ci_042                 4.593127e-03 3 1  ON 41
ci_043                 4.725973e-03 3 1  ON 42
ci_044                 5.244892e-03 3 1  ON 43
ci_045                 2.778895e-03 3 1  ON 44
ci_046                 2.952616e-03 3 1  ON 45
ci_047                -5.887729e-04 3 1  ON 46
ci_048                -5.307794e-04 3 1  ON 47
ci_049                 1.643616e-03 3 1  ON 48
ci_050                 1.338065e-03 3 1  ON 49
ci_051                -9.885940e-04 3 1  ON 50
ci_052                -1.623654e-03 3 1  ON 51
ci_053                -2.613128e-03 3 1  ON 52
ci_054                -2.150854e-03 3 1  ON 53
ci_055                -1.190165e-03 3 1  ON 54
ci_056                -1.220587e-03 3 1  ON 55
ci_057                -1.258961e-03 3 1  ON 56
ci_058                -1.482015e-03 3 1  ON 57
ci_059                 5.455705e-04 3 1  ON 58
ci_060                 9.982885e-05 3 1  ON 59
ci_061                -4.985831e-04 3 1  ON 60
ci_062                -5.472444e-05 3 1  ON 61
ci_063                -9.663256e-04 3 1  ON 62
ci_064                -1.176770e-03 3 1  ON 63
ci_065                -2.256401e-03 3 1  ON 64
ci_066                -2.356430e-03 3 1  ON 65
ci_067                -2.539525e-03 3 1  ON 66
ci_068                -2.437260e-03 3 1  ON 67
ci_069                -4.707242e-04 3 1  ON 68
ci_070                -3.114930e-04 3 1  ON 69
ci_071                -1.587339e-03 3 1  ON 70
ci_072                -1.307505e-03 3 1  ON 71
ci_073                -5.298632e-05 3 1  ON 72
ci_074                 4.771131e-04 3 1  ON 73
ci_075                -1.243465e-04 3 1  ON 74
ci_076                -2.406306e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 2.9311e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s015 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s015 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=15  my_counter=0
  time step      = 5.0000e-02
  blocks         = 250
  steps          = 250
  substeps       = 10
  current        = 0
  target samples = 8.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">250</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">6.2500e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">8.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">6.2500e+04</parameter>
<parameter name="steps" condition="int">250</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2683e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="250">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =8000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 15
    time step          = 0.05
    reference energy   = -22.5972
    reference variance = 0.43135
====================================================
  Execution time = 1.0149e+02
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s015
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 62500 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 6.1067e+04
  VMC Eavg = -2.2670e+01
  VMC Evar = 5.1484e-01
  Total weights = 7.820641486e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.8865e+01
  </log>
</opt>
<opt stage="main" walkers="62500">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.499495237328
                                         uncertainty =       0.001468683781

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.499495237328
                                         uncertainty =       0.001468683781

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000249873967
  error estimate for blocks of size 2^( 2) =       0.000258837440
  error estimate for blocks of size 2^( 3) =       0.000266881038
  error estimate for blocks of size 2^( 4) =       0.000272624727
  error estimate for blocks of size 2^( 5) =       0.000276325432
  error estimate for blocks of size 2^( 6) =       0.000277981670
  error estimate for blocks of size 2^( 7) =       0.000279173372
  error estimate for blocks of size 2^( 8) =       0.000279899045
  error estimate for blocks of size 2^( 9) =       0.000281105229

      target function =                  N/A
              le_mean =     -22.669906141570
             les_mean =     514.439484580947
             stat err =       0.000279539829
             autocorr =       1.251541818484
              std dev =       0.706750307310
             le_variance =       0.499495996883


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266990614157e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.4414e-01, overlap shift 2.4414e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.669906141589       residual = 6.65e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.669912935842       residual = 1.40e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.669912668694       residual = 5.82e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.669912746856       residual = 3.03e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 2.4414e-01 is 6.045767e-04

solving harmonic davidson linear method for identity shift 9.7656e-01, overlap shift 9.7656e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.669906141589       residual = 6.65e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.669908619891       residual = 8.78e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.669908494990       residual = 2.35e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.669908512165       residual = 9.30e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 9.7656e-01 is 2.204950e-04

solving harmonic davidson linear method for identity shift 3.9062e+00, overlap shift 3.9062e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.669906141589       residual = 6.65e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.669906841488       residual = 9.98e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.669906807637       residual = 2.45e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.669906810336       residual = 7.85e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 3.9062e+00 is 6.234907e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.275528 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.2038e+02
  </log>
  <optVariables href="FORM.s015.opt.xml">
ci_001                -7.050142e-01 3 1  ON 0
ci_002                -7.061246e-01 3 1  ON 1
ci_003                -3.743207e-02 3 1  ON 2
ci_004                -3.809978e-02 3 1  ON 3
ci_005                 1.582594e-02 3 1  ON 4
ci_006                 1.558409e-02 3 1  ON 5
ci_007                 1.230599e-02 3 1  ON 6
ci_008                 1.249974e-02 3 1  ON 7
ci_009                -1.146211e-02 3 1  ON 8
ci_010                -1.173381e-02 3 1  ON 9
ci_011                -8.121300e-03 3 1  ON 10
ci_012                -8.059818e-03 3 1  ON 11
ci_013                 9.280497e-03 3 1  ON 12
ci_014                 9.692336e-03 3 1  ON 13
ci_015                 1.226769e-02 3 1  ON 14
ci_016                 1.374243e-02 3 1  ON 15
ci_017                 1.113058e-02 3 1  ON 16
ci_018                 1.104344e-02 3 1  ON 17
ci_019                -3.880345e-03 3 1  ON 18
ci_020                -3.583567e-03 3 1  ON 19
ci_021                -9.018582e-03 3 1  ON 20
ci_022                -9.493672e-03 3 1  ON 21
ci_023                 7.661695e-03 3 1  ON 22
ci_024                 7.935500e-03 3 1  ON 23
ci_025                 4.032885e-03 3 1  ON 24
ci_026                 4.213984e-03 3 1  ON 25
ci_027                 6.468231e-03 3 1  ON 26
ci_028                 6.526129e-03 3 1  ON 27
ci_029                -4.898095e-03 3 1  ON 28
ci_030                -4.753968e-03 3 1  ON 29
ci_031                -8.075537e-03 3 1  ON 30
ci_032                -7.887586e-03 3 1  ON 31
ci_033                 4.225711e-03 3 1  ON 32
ci_034                 4.218152e-03 3 1  ON 33
ci_035                 1.198720e-03 3 1  ON 34
ci_036                 1.625776e-03 3 1  ON 35
ci_037                 4.886135e-03 3 1  ON 36
ci_038                 4.737976e-03 3 1  ON 37
ci_039                 5.188160e-03 3 1  ON 38
ci_040                 5.329979e-03 3 1  ON 39
ci_041                 5.123567e-03 3 1  ON 40
ci_042                 4.677293e-03 3 1  ON 41
ci_043                 4.715393e-03 3 1  ON 42
ci_044                 5.161801e-03 3 1  ON 43
ci_045                 2.978545e-03 3 1  ON 44
ci_046                 2.917656e-03 3 1  ON 45
ci_047                -4.745955e-04 3 1  ON 46
ci_048                -5.394599e-04 3 1  ON 47
ci_049                 1.656195e-03 3 1  ON 48
ci_050                 1.394389e-03 3 1  ON 49
ci_051                -1.061025e-03 3 1  ON 50
ci_052                -1.624887e-03 3 1  ON 51
ci_053                -2.549123e-03 3 1  ON 52
ci_054                -2.163389e-03 3 1  ON 53
ci_055                -1.155561e-03 3 1  ON 54
ci_056                -1.147778e-03 3 1  ON 55
ci_057                -1.255938e-03 3 1  ON 56
ci_058                -1.375957e-03 3 1  ON 57
ci_059                 4.718201e-04 3 1  ON 58
ci_060                 1.919323e-04 3 1  ON 59
ci_061                -4.566644e-04 3 1  ON 60
ci_062                -2.733329e-05 3 1  ON 61
ci_063                -8.958234e-04 3 1  ON 62
ci_064                -1.069912e-03 3 1  ON 63
ci_065                -2.252409e-03 3 1  ON 64
ci_066                -2.415168e-03 3 1  ON 65
ci_067                -2.438951e-03 3 1  ON 66
ci_068                -2.455564e-03 3 1  ON 67
ci_069                -4.034204e-04 3 1  ON 68
ci_070                -1.764431e-04 3 1  ON 69
ci_071                -1.807834e-03 3 1  ON 70
ci_072                -1.521303e-03 3 1  ON 71
ci_073                 4.311249e-05 3 1  ON 72
ci_074                 4.910612e-04 3 1  ON 73
ci_075                -1.433806e-04 3 1  ON 74
ci_076                -2.759649e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="250">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =8000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 15
    time step          = 0.05
    reference energy   = -22.5788
    reference variance = 0.235906
====================================================
  Execution time = 1.0102e+02
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s015
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 62500 
  VMC Eavg = -2.2670e+01
  VMC Evar = 5.1127e-01
  Total weights = 7.8207e+06
  Execution time = 1.4444e+01
  </log>
</opt>
<opt stage="main" walkers="62500">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

ERROR CostFunction-> Number of Effective Walkers is too small! 
  Number of effective walkers (samples) / total number of samples = 0.00079009
  User specified threshold minwalkers = 0.3
  If this message appears frequently. You might have to be cautious. 
  Find info about parameter "minwalkers" in the user manual!
Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.498096986403
                                         uncertainty =       0.001507211968

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.498096986403
                                         uncertainty =       0.001507211968

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000249523276
  error estimate for blocks of size 2^( 2) =       0.000258552379
  error estimate for blocks of size 2^( 3) =       0.000266563901
  error estimate for blocks of size 2^( 4) =       0.000272091556
  error estimate for blocks of size 2^( 5) =       0.000275501650
  error estimate for blocks of size 2^( 6) =       0.000277422669
  error estimate for blocks of size 2^( 7) =       0.000277901287
  error estimate for blocks of size 2^( 8) =       0.000278332553
  error estimate for blocks of size 2^( 9) =       0.000276374027

      target function =                  N/A
              le_mean =     -22.669578548002
             les_mean =     514.422125245050
             stat err =       0.000277507634
             autocorr =       1.236880499200
              std dev =       0.705758401479
             le_variance =       0.498094921259

ERROR CostFunction-> Number of Effective Walkers is too small! 
  Number of effective walkers (samples) / total number of samples = 0.000190538
  User specified threshold minwalkers = 0.3
  If this message appears frequently. You might have to be cautious. 
  Find info about parameter "minwalkers" in the user manual!
Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.498278978429
                                         uncertainty =       0.001481955471

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.498278978429
                                         uncertainty =       0.001481955471

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000249569084
  error estimate for blocks of size 2^( 2) =       0.000258597507
  error estimate for blocks of size 2^( 3) =       0.000266604520
  error estimate for blocks of size 2^( 4) =       0.000272128769
  error estimate for blocks of size 2^( 5) =       0.000275540661
  error estimate for blocks of size 2^( 6) =       0.000277454763
  error estimate for blocks of size 2^( 7) =       0.000277941638
  error estimate for blocks of size 2^( 8) =       0.000278353498
  error estimate for blocks of size 2^( 9) =       0.000276386020

      target function =                  N/A
              le_mean =     -22.669583688350
             les_mean =     514.424585688956
             stat err =       0.000277533980
             autocorr =       1.236661258630
              std dev =       0.705887967735
             le_variance =       0.498277822993

ERROR CostFunction-> Number of Effective Walkers is too small! 
  Number of effective walkers (samples) / total number of samples = 0.000794779
  User specified threshold minwalkers = 0.3
  If this message appears frequently. You might have to be cautious. 
  Find info about parameter "minwalkers" in the user manual!
Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.498091410181
                                         uncertainty =       0.001477755172

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.498091410181
                                         uncertainty =       0.001477755172

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000249521959
  error estimate for blocks of size 2^( 2) =       0.000258551910
  error estimate for blocks of size 2^( 3) =       0.000266561752
  error estimate for blocks of size 2^( 4) =       0.000272087841
  error estimate for blocks of size 2^( 5) =       0.000275499971
  error estimate for blocks of size 2^( 6) =       0.000277418444
  error estimate for blocks of size 2^( 7) =       0.000277899330
  error estimate for blocks of size 2^( 8) =       0.000278319375
  error estimate for blocks of size 2^( 9) =       0.000276353513

      target function =                  N/A
              le_mean =     -22.669580002350
             les_mean =     514.423402408881
             stat err =       0.000277497666
             autocorr =       1.236804696544
              std dev =       0.705754676426
             le_variance =       0.498089663297

ERROR CostFunction-> Number of Effective Walkers is too small! 
  Number of effective walkers (samples) / total number of samples = 0.00266672
  User specified threshold minwalkers = 0.3
  If this message appears frequently. You might have to be cautious. 
  Find info about parameter "minwalkers" in the user manual!
Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.498090261000
                                         uncertainty =       0.001502633047

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.498090261000
                                         uncertainty =       0.001502633047

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000249521599
  error estimate for blocks of size 2^( 2) =       0.000258550977
  error estimate for blocks of size 2^( 3) =       0.000266562421
  error estimate for blocks of size 2^( 4) =       0.000272090144
  error estimate for blocks of size 2^( 5) =       0.000275500182
  error estimate for blocks of size 2^( 6) =       0.000277419782
  error estimate for blocks of size 2^( 7) =       0.000277894064
  error estimate for blocks of size 2^( 8) =       0.000278322174
  error estimate for blocks of size 2^( 9) =       0.000276361352

      target function =                  N/A
              le_mean =     -22.669577013249
             les_mean =     514.425038879411
             stat err =       0.000277499343
             autocorr =       1.236823220975
              std dev =       0.705753657939
             le_variance =       0.498088225694


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.669578548002        initial
     2.4414e-01     2.4414e+00             6.0458e-04       -22.669583688350  <--
     9.7656e-01     9.7656e+00             2.2050e-04       -22.669580002350
     3.9062e+00     3.9062e+01             6.2349e-05       -22.669577013249

*****************************************************************************
Applying the update for shift_i =   2.4414e-01     and shift_s =   2.4414e+00
*****************************************************************************

  Execution time = 1.7357e+02
  </log>
  <optVariables href="FORM.s015.opt.xml">
ci_001                -7.049626e-01 3 1  ON 0
ci_002                -7.061908e-01 3 1  ON 1
ci_003                -3.748666e-02 3 1  ON 2
ci_004                -3.785633e-02 3 1  ON 3
ci_005                 1.590028e-02 3 1  ON 4
ci_006                 1.575467e-02 3 1  ON 5
ci_007                 1.219299e-02 3 1  ON 6
ci_008                 1.233234e-02 3 1  ON 7
ci_009                -1.131948e-02 3 1  ON 8
ci_010                -1.177351e-02 3 1  ON 9
ci_011                -7.900610e-03 3 1  ON 10
ci_012                -8.113132e-03 3 1  ON 11
ci_013                 9.225952e-03 3 1  ON 12
ci_014                 9.704572e-03 3 1  ON 13
ci_015                 1.240009e-02 3 1  ON 14
ci_016                 1.336622e-02 3 1  ON 15
ci_017                 1.144669e-02 3 1  ON 16
ci_018                 1.101348e-02 3 1  ON 17
ci_019                -4.124395e-03 3 1  ON 18
ci_020                -3.870343e-03 3 1  ON 19
ci_021                -9.147156e-03 3 1  ON 20
ci_022                -9.629513e-03 3 1  ON 21
ci_023                 7.571631e-03 3 1  ON 22
ci_024                 8.023722e-03 3 1  ON 23
ci_025                 3.995311e-03 3 1  ON 24
ci_026                 4.174925e-03 3 1  ON 25
ci_027                 6.198849e-03 3 1  ON 26
ci_028                 6.585519e-03 3 1  ON 27
ci_029                -4.883201e-03 3 1  ON 28
ci_030                -4.906858e-03 3 1  ON 29
ci_031                -7.911954e-03 3 1  ON 30
ci_032                -7.853761e-03 3 1  ON 31
ci_033                 4.192671e-03 3 1  ON 32
ci_034                 4.177317e-03 3 1  ON 33
ci_035                 1.072342e-03 3 1  ON 34
ci_036                 1.410847e-03 3 1  ON 35
ci_037                 5.000092e-03 3 1  ON 36
ci_038                 4.889331e-03 3 1  ON 37
ci_039                 5.016780e-03 3 1  ON 38
ci_040                 5.253012e-03 3 1  ON 39
ci_041                 4.919194e-03 3 1  ON 40
ci_042                 4.816301e-03 3 1  ON 41
ci_043                 4.692735e-03 3 1  ON 42
ci_044                 5.013438e-03 3 1  ON 43
ci_045                 3.350631e-03 3 1  ON 44
ci_046                 2.858728e-03 3 1  ON 45
ci_047                -3.180595e-04 3 1  ON 46
ci_048                -5.587830e-04 3 1  ON 47
ci_049                 1.677170e-03 3 1  ON 48
ci_050                 1.502619e-03 3 1  ON 49
ci_051                -1.163892e-03 3 1  ON 50
ci_052                -1.593175e-03 3 1  ON 51
ci_053                -2.451800e-03 3 1  ON 52
ci_054                -2.191489e-03 3 1  ON 53
ci_055                -1.095710e-03 3 1  ON 54
ci_056                -1.010838e-03 3 1  ON 55
ci_057                -1.249274e-03 3 1  ON 56
ci_058                -1.189490e-03 3 1  ON 57
ci_059                 3.583554e-04 3 1  ON 58
ci_060                 3.256773e-04 3 1  ON 59
ci_061                -3.919048e-04 3 1  ON 60
ci_062                 2.245563e-05 3 1  ON 61
ci_063                -7.715423e-04 3 1  ON 62
ci_064                -8.695833e-04 3 1  ON 63
ci_065                -2.233619e-03 3 1  ON 64
ci_066                -2.508085e-03 3 1  ON 65
ci_067                -2.252515e-03 3 1  ON 66
ci_068                -2.491286e-03 3 1  ON 67
ci_069                -2.875250e-04 3 1  ON 68
ci_070                 6.992822e-05 3 1  ON 69
ci_071                -2.191916e-03 3 1  ON 70
ci_072                -1.895983e-03 3 1  ON 71
ci_073                 1.871050e-04 3 1  ON 72
ci_074                 5.027368e-04 3 1  ON 73
ci_075                -1.769258e-04 3 1  ON 74
ci_076                -3.397626e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 2.9396e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s016 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s016 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=16  my_counter=0
  time step      = 5.0000e-02
  blocks         = 250
  steps          = 250
  substeps       = 10
  current        = 0
  target samples = 8.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">250</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">6.2500e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">8.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">6.2500e+04</parameter>
<parameter name="steps" condition="int">250</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2677e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="250">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =8000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 16
    time step          = 0.05
    reference energy   = -22.7
    reference variance = 0.421389
====================================================
  Execution time = 1.0130e+02
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s016
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 62500 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 6.1063e+04
  VMC Eavg = -2.2669e+01
  VMC Evar = 5.4048e-01
  Total weights = 7.820511718e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.8802e+01
  </log>
</opt>
<opt stage="main" walkers="62500">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.522763868064
                                         uncertainty =       0.025046888959

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.522763868064
                                         uncertainty =       0.025046888959

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000255617526
  error estimate for blocks of size 2^( 2) =       0.000264274846
  error estimate for blocks of size 2^( 3) =       0.000272014452
  error estimate for blocks of size 2^( 4) =       0.000277588972
  error estimate for blocks of size 2^( 5) =       0.000280627361
  error estimate for blocks of size 2^( 6) =       0.000282416444
  error estimate for blocks of size 2^( 7) =       0.000283693852
  error estimate for blocks of size 2^( 8) =       0.000284345152
  error estimate for blocks of size 2^( 9) =       0.000284480051

      target function =                  N/A
              le_mean =     -22.669319300239
             les_mean =     514.438513039397
             stat err =       0.000283733875
             autocorr =       1.232086285876
              std dev =       0.722995543922
             le_variance =       0.522722556532


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266931930024e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.1035e-02, overlap shift 6.1035e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.669319300261       residual = 8.62e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.669329438075       residual = 2.82e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.669329209446       residual = 2.03e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.669329584444       residual = 2.31e-08           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.669329466534       residual = 2.41e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          4 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 6.1035e-02 is 1.305121e-03

solving harmonic davidson linear method for identity shift 2.4414e-01, overlap shift 2.4414e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.669319300261       residual = 8.62e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.669325006960       residual = 1.15e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.669325053269       residual = 3.03e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.669325165189       residual = 9.54e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 2.4414e-01 is 7.207963e-04

solving harmonic davidson linear method for identity shift 9.7656e-01, overlap shift 9.7656e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.669319300261       residual = 8.62e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.669321376667       residual = 7.49e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.669321476662       residual = 1.41e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.669321492204       residual = 2.24e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 9.7656e-01 is 2.673965e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.280244 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.2013e+02
  </log>
  <optVariables href="FORM.s016.opt.xml">
ci_001                -7.049813e-01 3 1  ON 0
ci_002                -7.061762e-01 3 1  ON 1
ci_003                -3.743768e-02 3 1  ON 2
ci_004                -3.817892e-02 3 1  ON 3
ci_005                 1.592176e-02 3 1  ON 4
ci_006                 1.556705e-02 3 1  ON 5
ci_007                 1.232746e-02 3 1  ON 6
ci_008                 1.244975e-02 3 1  ON 7
ci_009                -1.140366e-02 3 1  ON 8
ci_010                -1.198148e-02 3 1  ON 9
ci_011                -8.036079e-03 3 1  ON 10
ci_012                -7.442877e-03 3 1  ON 11
ci_013                 9.310415e-03 3 1  ON 12
ci_014                 9.500132e-03 3 1  ON 13
ci_015                 1.196044e-02 3 1  ON 14
ci_016                 1.319715e-02 3 1  ON 15
ci_017                 1.114942e-02 3 1  ON 16
ci_018                 1.063597e-02 3 1  ON 17
ci_019                -3.874052e-03 3 1  ON 18
ci_020                -3.819964e-03 3 1  ON 19
ci_021                -9.126575e-03 3 1  ON 20
ci_022                -8.969543e-03 3 1  ON 21
ci_023                 7.818417e-03 3 1  ON 22
ci_024                 8.504232e-03 3 1  ON 23
ci_025                 4.163353e-03 3 1  ON 24
ci_026                 4.332946e-03 3 1  ON 25
ci_027                 6.179848e-03 3 1  ON 26
ci_028                 6.861534e-03 3 1  ON 27
ci_029                -4.713137e-03 3 1  ON 28
ci_030                -5.253353e-03 3 1  ON 29
ci_031                -7.967347e-03 3 1  ON 30
ci_032                -7.766023e-03 3 1  ON 31
ci_033                 4.223603e-03 3 1  ON 32
ci_034                 3.699920e-03 3 1  ON 33
ci_035                 1.016234e-03 3 1  ON 34
ci_036                 1.190933e-03 3 1  ON 35
ci_037                 5.074245e-03 3 1  ON 36
ci_038                 4.802758e-03 3 1  ON 37
ci_039                 4.801222e-03 3 1  ON 38
ci_040                 5.472997e-03 3 1  ON 39
ci_041                 5.010719e-03 3 1  ON 40
ci_042                 4.929979e-03 3 1  ON 41
ci_043                 4.665842e-03 3 1  ON 42
ci_044                 5.210221e-03 3 1  ON 43
ci_045                 3.127575e-03 3 1  ON 44
ci_046                 2.781134e-03 3 1  ON 45
ci_047                -7.935984e-04 3 1  ON 46
ci_048                -5.186729e-04 3 1  ON 47
ci_049                 1.498310e-03 3 1  ON 48
ci_050                 1.959762e-03 3 1  ON 49
ci_051                -1.345345e-03 3 1  ON 50
ci_052                -1.750051e-03 3 1  ON 51
ci_053                -2.518445e-03 3 1  ON 52
ci_054                -2.332069e-03 3 1  ON 53
ci_055                -1.133381e-03 3 1  ON 54
ci_056                -1.085599e-03 3 1  ON 55
ci_057                -1.970070e-03 3 1  ON 56
ci_058                -1.862621e-03 3 1  ON 57
ci_059                 5.330366e-04 3 1  ON 58
ci_060                 5.426016e-04 3 1  ON 59
ci_061                -3.251688e-04 3 1  ON 60
ci_062                 5.598343e-05 3 1  ON 61
ci_063                -7.174374e-04 3 1  ON 62
ci_064                -7.454975e-04 3 1  ON 63
ci_065                -2.146837e-03 3 1  ON 64
ci_066                -2.403256e-03 3 1  ON 65
ci_067                -2.385607e-03 3 1  ON 66
ci_068                -2.663871e-03 3 1  ON 67
ci_069                 1.765848e-04 3 1  ON 68
ci_070                 1.053367e-04 3 1  ON 69
ci_071                -2.178522e-03 3 1  ON 70
ci_072                -1.898588e-03 3 1  ON 71
ci_073                 2.037496e-05 3 1  ON 72
ci_074                 4.913133e-04 3 1  ON 73
ci_075                -1.700472e-04 3 1  ON 74
ci_076                -7.350504e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="250">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =8000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 16
    time step          = 0.05
    reference energy   = -22.7016
    reference variance = 0.265142
====================================================
  Execution time = 1.0143e+02
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s016
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 62500 
  VMC Eavg = -2.2670e+01
  VMC Evar = 5.1043e-01
  Total weights = 7.8205e+06
  Execution time = 1.4407e+01
  </log>
</opt>
<opt stage="main" walkers="62500">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

ERROR CostFunction-> Number of Effective Walkers is too small! 
  Number of effective walkers (samples) / total number of samples = 0.15442
  User specified threshold minwalkers = 0.3
  If this message appears frequently. You might have to be cautious. 
  Find info about parameter "minwalkers" in the user manual!
Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.496362894583
                                         uncertainty =       0.001496386032

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.496362894583
                                         uncertainty =       0.001496386032

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000249089137
  error estimate for blocks of size 2^( 2) =       0.000257961000
  error estimate for blocks of size 2^( 3) =       0.000265953931
  error estimate for blocks of size 2^( 4) =       0.000271729542
  error estimate for blocks of size 2^( 5) =       0.000275097776
  error estimate for blocks of size 2^( 6) =       0.000276977411
  error estimate for blocks of size 2^( 7) =       0.000277582279
  error estimate for blocks of size 2^( 8) =       0.000278062283
  error estimate for blocks of size 2^( 9) =       0.000277577230

      target function =                  N/A
              le_mean =     -22.669550605175
             les_mean =     514.423137600142
             stat err =       0.000277549801
             autocorr =       1.241573006093
              std dev =       0.704530472868
             le_variance =       0.496363187200

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.496876291786
                                         uncertainty =       0.001661618638

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.496876291786
                                         uncertainty =       0.001661618638

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000249218077
  error estimate for blocks of size 2^( 2) =       0.000258083468
  error estimate for blocks of size 2^( 3) =       0.000266071026
  error estimate for blocks of size 2^( 4) =       0.000271853457
  error estimate for blocks of size 2^( 5) =       0.000275226340
  error estimate for blocks of size 2^( 6) =       0.000277101104
  error estimate for blocks of size 2^( 7) =       0.000277719876
  error estimate for blocks of size 2^( 8) =       0.000278203479
  error estimate for blocks of size 2^( 9) =       0.000277706488

      target function =                  N/A
              le_mean =     -22.669558563163
             les_mean =     514.735487568931
             stat err =       0.000277682737
             autocorr =       1.241477004349
              std dev =       0.704895169774
             le_variance =       0.496877200371

ERROR CostFunction-> Number of Effective Walkers is too small! 
  Number of effective walkers (samples) / total number of samples = 0.158717
  User specified threshold minwalkers = 0.3
  If this message appears frequently. You might have to be cautious. 
  Find info about parameter "minwalkers" in the user manual!
Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.496380321933
                                         uncertainty =       0.001490920431

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.496380321933
                                         uncertainty =       0.001490920431

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000249093547
  error estimate for blocks of size 2^( 2) =       0.000257963006
  error estimate for blocks of size 2^( 3) =       0.000265958182
  error estimate for blocks of size 2^( 4) =       0.000271730711
  error estimate for blocks of size 2^( 5) =       0.000275097613
  error estimate for blocks of size 2^( 6) =       0.000276994861
  error estimate for blocks of size 2^( 7) =       0.000277588108
  error estimate for blocks of size 2^( 8) =       0.000278070502
  error estimate for blocks of size 2^( 9) =       0.000277581946

      target function =                  N/A
              le_mean =     -22.669552072452
             les_mean =     514.454613345194
             stat err =       0.000277558854
             autocorr =       1.241610052308
              std dev =       0.704542943775
             le_variance =       0.496380759624

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.496309716770
                                         uncertainty =       0.001493311453

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.496309716770
                                         uncertainty =       0.001493311453

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000249075800
  error estimate for blocks of size 2^( 2) =       0.000257947336
  error estimate for blocks of size 2^( 3) =       0.000265940070
  error estimate for blocks of size 2^( 4) =       0.000271716415
  error estimate for blocks of size 2^( 5) =       0.000275085141
  error estimate for blocks of size 2^( 6) =       0.000276966971
  error estimate for blocks of size 2^( 7) =       0.000277567285
  error estimate for blocks of size 2^( 8) =       0.000278050292
  error estimate for blocks of size 2^( 9) =       0.000277562665

      target function =                  N/A
              le_mean =     -22.669545705599
             les_mean =     514.419880116726
             stat err =       0.000277536803
             autocorr =       1.241589688059
              std dev =       0.704492747870
             le_variance =       0.496310031801


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.669550605175        initial
     6.1035e-02     6.1035e-01             1.3051e-03       -22.669558563163  <--
     2.4414e-01     2.4414e+00             7.2080e-04       -22.669552072452
     9.7656e-01     9.7656e+00             2.6740e-04       -22.669545705599

*****************************************************************************
Applying the update for shift_i =   6.1035e-02     and shift_s =   6.1035e-01
*****************************************************************************

  Execution time = 1.7423e+02
  </log>
  <optVariables href="FORM.s016.opt.xml">
ci_001                -7.050452e-01 3 1  ON 0
ci_002                -7.061049e-01 3 1  ON 1
ci_003                -3.733937e-02 3 1  ON 2
ci_004                -3.872058e-02 3 1  ON 3
ci_005                 1.593324e-02 3 1  ON 4
ci_006                 1.544518e-02 3 1  ON 5
ci_007                 1.248130e-02 3 1  ON 6
ci_008                 1.256965e-02 3 1  ON 7
ci_009                -1.146780e-02 3 1  ON 8
ci_010                -1.218318e-02 3 1  ON 9
ci_011                -8.161795e-03 3 1  ON 10
ci_012                -6.833216e-03 3 1  ON 11
ci_013                 9.405188e-03 3 1  ON 12
ci_014                 9.326701e-03 3 1  ON 13
ci_015                 1.153075e-02 3 1  ON 14
ci_016                 1.306156e-02 3 1  ON 15
ci_017                 1.087792e-02 3 1  ON 16
ci_018                 1.031077e-02 3 1  ON 17
ci_019                -3.625289e-03 3 1  ON 18
ci_020                -3.837564e-03 3 1  ON 19
ci_021                -9.131375e-03 3 1  ON 20
ci_022                -8.324392e-03 3 1  ON 21
ci_023                 8.003010e-03 3 1  ON 22
ci_024                 8.851408e-03 3 1  ON 23
ci_025                 4.309220e-03 3 1  ON 24
ci_026                 4.503270e-03 3 1  ON 25
ci_027                 6.168545e-03 3 1  ON 26
ci_028                 7.018345e-03 3 1  ON 27
ci_029                -4.590320e-03 3 1  ON 28
ci_030                -5.567313e-03 3 1  ON 29
ci_031                -8.031649e-03 3 1  ON 30
ci_032                -7.770012e-03 3 1  ON 31
ci_033                 4.271776e-03 3 1  ON 32
ci_034                 3.285156e-03 3 1  ON 33
ci_035                 9.852418e-04 3 1  ON 34
ci_036                 1.084471e-03 3 1  ON 35
ci_037                 5.143659e-03 3 1  ON 36
ci_038                 4.687890e-03 3 1  ON 37
ci_039                 4.677374e-03 3 1  ON 38
ci_040                 5.589853e-03 3 1  ON 39
ci_041                 5.081902e-03 3 1  ON 40
ci_042                 4.993417e-03 3 1  ON 41
ci_043                 4.655308e-03 3 1  ON 42
ci_044                 5.323532e-03 3 1  ON 43
ci_045                 2.938438e-03 3 1  ON 44
ci_046                 2.771511e-03 3 1  ON 45
ci_047                -1.057805e-03 3 1  ON 46
ci_048                -5.034837e-04 3 1  ON 47
ci_049                 1.342436e-03 3 1  ON 48
ci_050                 2.337031e-03 3 1  ON 49
ci_051                -1.518744e-03 3 1  ON 50
ci_052                -1.883070e-03 3 1  ON 51
ci_053                -2.583443e-03 3 1  ON 52
ci_054                -2.537800e-03 3 1  ON 53
ci_055                -1.177148e-03 3 1  ON 54
ci_056                -1.158699e-03 3 1  ON 55
ci_057                -2.505804e-03 3 1  ON 56
ci_058                -2.355976e-03 3 1  ON 57
ci_059                 6.385491e-04 3 1  ON 58
ci_060                 6.675665e-04 3 1  ON 59
ci_061                -2.561660e-04 3 1  ON 60
ci_062                 9.211747e-05 3 1  ON 61
ci_063                -6.660332e-04 3 1  ON 62
ci_064                -6.499264e-04 3 1  ON 63
ci_065                -2.108614e-03 3 1  ON 64
ci_066                -2.309971e-03 3 1  ON 65
ci_067                -2.502164e-03 3 1  ON 66
ci_068                -2.814774e-03 3 1  ON 67
ci_069                 5.422133e-04 3 1  ON 68
ci_070                 1.429284e-04 3 1  ON 69
ci_071                -2.167664e-03 3 1  ON 70
ci_072                -1.892238e-03 3 1  ON 71
ci_073                -7.701207e-05 3 1  ON 72
ci_074                 4.736059e-04 3 1  ON 73
ci_075                -1.853620e-04 3 1  ON 74
ci_076                -1.049882e-03 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 2.9438e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s017 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s017 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=17  my_counter=0
  time step      = 5.0000e-02
  blocks         = 250
  steps          = 250
  substeps       = 10
  current        = 0
  target samples = 8.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">250</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">6.2500e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">8.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">6.2500e+04</parameter>
<parameter name="steps" condition="int">250</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2679e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="250">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =8000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 17
    time step          = 0.05
    reference energy   = -22.643
    reference variance = 0.243428
====================================================
  Execution time = 1.0123e+02
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s017
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 62500 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 6.1116e+04
  VMC Eavg = -2.2670e+01
  VMC Evar = 5.1175e-01
  Total weights = 7.820586849e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.8722e+01
  </log>
</opt>
<opt stage="main" walkers="62500">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.499564600001
                                         uncertainty =       0.001846520762

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.499564600001
                                         uncertainty =       0.001846520762

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000249891667
  error estimate for blocks of size 2^( 2) =       0.000258740912
  error estimate for blocks of size 2^( 3) =       0.000266366581
  error estimate for blocks of size 2^( 4) =       0.000272120069
  error estimate for blocks of size 2^( 5) =       0.000275694604
  error estimate for blocks of size 2^( 6) =       0.000277529144
  error estimate for blocks of size 2^( 7) =       0.000278575353
  error estimate for blocks of size 2^( 8) =       0.000278818185
  error estimate for blocks of size 2^( 9) =       0.000280582932

      target function =                  N/A
              le_mean =     -22.669822642437
             les_mean =     514.432605763498
             stat err =       0.000278876403
             autocorr =       1.245431914617
              std dev =       0.706800368182
             le_variance =       0.499566760462


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266982264244e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5259e-02, overlap shift 1.5259e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.669822642456       residual = 6.73e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.669839249451       residual = 3.97e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.669839124664       residual = 7.50e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.669839310520       residual = 3.96e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.669839242104       residual = 3.71e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.669839505725       residual = 1.84e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.669839552881       residual = 5.73e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.669839408781       residual = 1.05e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.669839499741       residual = 1.15e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 1.5259e-02 is 2.574729e-03

solving harmonic davidson linear method for identity shift 6.1035e-02, overlap shift 6.1035e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.669822642456       residual = 6.73e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.669836096497       residual = 2.67e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.669835788732       residual = 3.07e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.669835758626       residual = 6.39e-08           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.669835724920       residual = 1.48e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.669835769062       residual = 2.49e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          5 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 6.1035e-02 is 1.197117e-03

solving harmonic davidson linear method for identity shift 2.4414e-01, overlap shift 2.4414e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.669822642456       residual = 6.73e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.669830289273       residual = 1.14e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.669829996868       residual = 5.05e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.669829934661       residual = 2.01e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 2.4414e-01 is 6.538491e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.282738 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.1997e+02
  </log>
  <optVariables href="FORM.s017.opt.xml">
ci_001                -7.056131e-01 3 1  ON 0
ci_002                -7.054949e-01 3 1  ON 1
ci_003                -3.782427e-02 3 1  ON 2
ci_004                -3.827540e-02 3 1  ON 3
ci_005                 1.605127e-02 3 1  ON 4
ci_006                 1.576959e-02 3 1  ON 5
ci_007                 1.248444e-02 3 1  ON 6
ci_008                 1.255962e-02 3 1  ON 7
ci_009                -1.199409e-02 3 1  ON 8
ci_010                -1.244323e-02 3 1  ON 9
ci_011                -7.971536e-03 3 1  ON 10
ci_012                -8.030333e-03 3 1  ON 11
ci_013                 8.729514e-03 3 1  ON 12
ci_014                 9.473135e-03 3 1  ON 13
ci_015                 1.239719e-02 3 1  ON 14
ci_016                 1.314988e-02 3 1  ON 15
ci_017                 1.038988e-02 3 1  ON 16
ci_018                 1.080901e-02 3 1  ON 17
ci_019                -3.782779e-03 3 1  ON 18
ci_020                -3.468401e-03 3 1  ON 19
ci_021                -9.205016e-03 3 1  ON 20
ci_022                -9.091705e-03 3 1  ON 21
ci_023                 8.633054e-03 3 1  ON 22
ci_024                 8.157160e-03 3 1  ON 23
ci_025                 4.618195e-03 3 1  ON 24
ci_026                 3.820898e-03 3 1  ON 25
ci_027                 6.211218e-03 3 1  ON 26
ci_028                 6.450208e-03 3 1  ON 27
ci_029                -4.688325e-03 3 1  ON 28
ci_030                -5.678137e-03 3 1  ON 29
ci_031                -8.606865e-03 3 1  ON 30
ci_032                -7.943290e-03 3 1  ON 31
ci_033                 4.278138e-03 3 1  ON 32
ci_034                 4.150765e-03 3 1  ON 33
ci_035                 1.335873e-03 3 1  ON 34
ci_036                 1.023722e-03 3 1  ON 35
ci_037                 5.046404e-03 3 1  ON 36
ci_038                 4.821801e-03 3 1  ON 37
ci_039                 5.089912e-03 3 1  ON 38
ci_040                 5.142232e-03 3 1  ON 39
ci_041                 4.689110e-03 3 1  ON 40
ci_042                 4.648702e-03 3 1  ON 41
ci_043                 5.057524e-03 3 1  ON 42
ci_044                 4.388856e-03 3 1  ON 43
ci_045                 2.870512e-03 3 1  ON 44
ci_046                 2.843138e-03 3 1  ON 45
ci_047                -7.749770e-04 3 1  ON 46
ci_048                -5.864780e-04 3 1  ON 47
ci_049                 1.492459e-03 3 1  ON 48
ci_050                 1.671488e-03 3 1  ON 49
ci_051                -1.970533e-03 3 1  ON 50
ci_052                -1.887601e-03 3 1  ON 51
ci_053                -2.649659e-03 3 1  ON 52
ci_054                -2.464465e-03 3 1  ON 53
ci_055                -1.270029e-03 3 1  ON 54
ci_056                -1.279851e-03 3 1  ON 55
ci_057                -1.670898e-03 3 1  ON 56
ci_058                -1.675977e-03 3 1  ON 57
ci_059                 2.114615e-04 3 1  ON 58
ci_060                 1.744703e-04 3 1  ON 59
ci_061                 1.537467e-05 3 1  ON 60
ci_062                -1.707689e-04 3 1  ON 61
ci_063                -1.199684e-03 3 1  ON 62
ci_064                -3.820822e-04 3 1  ON 63
ci_065                -2.349143e-03 3 1  ON 64
ci_066                -2.451094e-03 3 1  ON 65
ci_067                -2.931846e-03 3 1  ON 66
ci_068                -2.426099e-03 3 1  ON 67
ci_069                 1.771256e-04 3 1  ON 68
ci_070                -1.177821e-05 3 1  ON 69
ci_071                -2.762905e-03 3 1  ON 70
ci_072                -2.371966e-03 3 1  ON 71
ci_073                 2.423070e-04 3 1  ON 72
ci_074                 4.176430e-04 3 1  ON 73
ci_075                -2.632065e-04 3 1  ON 74
ci_076                -1.372559e-03 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="250">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =8000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 17
    time step          = 0.05
    reference energy   = -22.5533
    reference variance = 0.364562
====================================================
  Execution time = 1.0130e+02
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s017
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 62500 
  VMC Eavg = -2.2670e+01
  VMC Evar = 5.1136e-01
  Total weights = 7.8205e+06
  Execution time = 1.4419e+01
  </log>
</opt>
<opt stage="main" walkers="62500">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.500495172242
                                         uncertainty =       0.002213747608

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.500495172242
                                         uncertainty =       0.002213747608

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000250125273
  error estimate for blocks of size 2^( 2) =       0.000259060874
  error estimate for blocks of size 2^( 3) =       0.000266962217
  error estimate for blocks of size 2^( 4) =       0.000272656753
  error estimate for blocks of size 2^( 5) =       0.000276016684
  error estimate for blocks of size 2^( 6) =       0.000277336791
  error estimate for blocks of size 2^( 7) =       0.000278001119
  error estimate for blocks of size 2^( 8) =       0.000278206348
  error estimate for blocks of size 2^( 9) =       0.000278040939

      target function =                  N/A
              le_mean =     -22.669992629999
             les_mean =     519.077749004247
             stat err =       0.000277896299
             autocorr =       1.234384262173
              std dev =       0.707461105700
             le_variance =       0.500501216078

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.498720091019
                                         uncertainty =       0.001383738906

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.498720091019
                                         uncertainty =       0.001383738906

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000249681625
  error estimate for blocks of size 2^( 2) =       0.000258630226
  error estimate for blocks of size 2^( 3) =       0.000266529668
  error estimate for blocks of size 2^( 4) =       0.000272233505
  error estimate for blocks of size 2^( 5) =       0.000275592220
  error estimate for blocks of size 2^( 6) =       0.000276920448
  error estimate for blocks of size 2^( 7) =       0.000277565944
  error estimate for blocks of size 2^( 8) =       0.000277760070
  error estimate for blocks of size 2^( 9) =       0.000277543561

      target function =                  N/A
              le_mean =     -22.669982092260
             les_mean =     514.443192956282
             stat err =       0.000277447506
             autocorr =       1.234776870744
              std dev =       0.706206280625
             le_variance =       0.498727310794

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.532737150672
                                         uncertainty =       0.033353798041

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.532737150672
                                         uncertainty =       0.033353798041

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000258048314
  error estimate for blocks of size 2^( 2) =       0.000266692064
  error estimate for blocks of size 2^( 3) =       0.000274368311
  error estimate for blocks of size 2^( 4) =       0.000279877058
  error estimate for blocks of size 2^( 5) =       0.000283167209
  error estimate for blocks of size 2^( 6) =       0.000284504877
  error estimate for blocks of size 2^( 7) =       0.000285329850
  error estimate for blocks of size 2^( 8) =       0.000285543332
  error estimate for blocks of size 2^( 9) =       0.000285249600

      target function =                  N/A
              le_mean =     -22.670069668041
             les_mean =     552.520304738865
             stat err =       0.000285156915
             autocorr =       1.221140864884
              std dev =       0.729870849693
             le_variance =       0.532711457232

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.498740807650
                                         uncertainty =       0.001397649588

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.498740807650
                                         uncertainty =       0.001397649588

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000249686850
  error estimate for blocks of size 2^( 2) =       0.000258639411
  error estimate for blocks of size 2^( 3) =       0.000266543011
  error estimate for blocks of size 2^( 4) =       0.000272249744
  error estimate for blocks of size 2^( 5) =       0.000275606221
  error estimate for blocks of size 2^( 6) =       0.000276941003
  error estimate for blocks of size 2^( 7) =       0.000277596215
  error estimate for blocks of size 2^( 8) =       0.000277780590
  error estimate for blocks of size 2^( 9) =       0.000277559276

      target function =                  N/A
              le_mean =     -22.669988578672
             les_mean =     514.718368592524
             stat err =       0.000277469271
             autocorr =       1.234918927368
              std dev =       0.706221058162
             le_variance =       0.498748182992


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.669992629999        initial
     1.5259e-02     1.5259e-01             2.5747e-03       -22.669982092260
     6.1035e-02     6.1035e-01             1.1971e-03       -22.670069668041  <--
     2.4414e-01     2.4414e+00             6.5385e-04       -22.669988578672

*****************************************************************************
Applying the update for shift_i =   6.1035e-02     and shift_s =   6.1035e-01
*****************************************************************************

  Execution time = 1.7384e+02
  </log>
  <optVariables href="FORM.s017.opt.xml">
ci_001                -7.056131e-01 3 1  ON 0
ci_002                -7.054949e-01 3 1  ON 1
ci_003                -3.782427e-02 3 1  ON 2
ci_004                -3.827540e-02 3 1  ON 3
ci_005                 1.605127e-02 3 1  ON 4
ci_006                 1.576959e-02 3 1  ON 5
ci_007                 1.248444e-02 3 1  ON 6
ci_008                 1.255962e-02 3 1  ON 7
ci_009                -1.199409e-02 3 1  ON 8
ci_010                -1.244323e-02 3 1  ON 9
ci_011                -7.971536e-03 3 1  ON 10
ci_012                -8.030333e-03 3 1  ON 11
ci_013                 8.729514e-03 3 1  ON 12
ci_014                 9.473135e-03 3 1  ON 13
ci_015                 1.239719e-02 3 1  ON 14
ci_016                 1.314988e-02 3 1  ON 15
ci_017                 1.038988e-02 3 1  ON 16
ci_018                 1.080901e-02 3 1  ON 17
ci_019                -3.782779e-03 3 1  ON 18
ci_020                -3.468401e-03 3 1  ON 19
ci_021                -9.205016e-03 3 1  ON 20
ci_022                -9.091705e-03 3 1  ON 21
ci_023                 8.633054e-03 3 1  ON 22
ci_024                 8.157160e-03 3 1  ON 23
ci_025                 4.618195e-03 3 1  ON 24
ci_026                 3.820898e-03 3 1  ON 25
ci_027                 6.211218e-03 3 1  ON 26
ci_028                 6.450208e-03 3 1  ON 27
ci_029                -4.688325e-03 3 1  ON 28
ci_030                -5.678137e-03 3 1  ON 29
ci_031                -8.606865e-03 3 1  ON 30
ci_032                -7.943290e-03 3 1  ON 31
ci_033                 4.278138e-03 3 1  ON 32
ci_034                 4.150765e-03 3 1  ON 33
ci_035                 1.335873e-03 3 1  ON 34
ci_036                 1.023722e-03 3 1  ON 35
ci_037                 5.046404e-03 3 1  ON 36
ci_038                 4.821801e-03 3 1  ON 37
ci_039                 5.089912e-03 3 1  ON 38
ci_040                 5.142232e-03 3 1  ON 39
ci_041                 4.689110e-03 3 1  ON 40
ci_042                 4.648702e-03 3 1  ON 41
ci_043                 5.057524e-03 3 1  ON 42
ci_044                 4.388856e-03 3 1  ON 43
ci_045                 2.870512e-03 3 1  ON 44
ci_046                 2.843138e-03 3 1  ON 45
ci_047                -7.749770e-04 3 1  ON 46
ci_048                -5.864780e-04 3 1  ON 47
ci_049                 1.492459e-03 3 1  ON 48
ci_050                 1.671488e-03 3 1  ON 49
ci_051                -1.970533e-03 3 1  ON 50
ci_052                -1.887601e-03 3 1  ON 51
ci_053                -2.649659e-03 3 1  ON 52
ci_054                -2.464465e-03 3 1  ON 53
ci_055                -1.270029e-03 3 1  ON 54
ci_056                -1.279851e-03 3 1  ON 55
ci_057                -1.670898e-03 3 1  ON 56
ci_058                -1.675977e-03 3 1  ON 57
ci_059                 2.114615e-04 3 1  ON 58
ci_060                 1.744703e-04 3 1  ON 59
ci_061                 1.537467e-05 3 1  ON 60
ci_062                -1.707689e-04 3 1  ON 61
ci_063                -1.199684e-03 3 1  ON 62
ci_064                -3.820822e-04 3 1  ON 63
ci_065                -2.349143e-03 3 1  ON 64
ci_066                -2.451094e-03 3 1  ON 65
ci_067                -2.931846e-03 3 1  ON 66
ci_068                -2.426099e-03 3 1  ON 67
ci_069                 1.771256e-04 3 1  ON 68
ci_070                -1.177821e-05 3 1  ON 69
ci_071                -2.762905e-03 3 1  ON 70
ci_072                -2.371966e-03 3 1  ON 71
ci_073                 2.423070e-04 3 1  ON 72
ci_074                 4.176430e-04 3 1  ON 73
ci_075                -2.632065e-04 3 1  ON 74
ci_076                -1.372559e-03 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 2.9382e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s018 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s018 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=18  my_counter=0
  time step      = 5.0000e-02
  blocks         = 250
  steps          = 250
  substeps       = 10
  current        = 0
  target samples = 8.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">250</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">6.2500e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">8.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">6.2500e+04</parameter>
<parameter name="steps" condition="int">250</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2674e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="250">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =8000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 18
    time step          = 0.05
    reference energy   = -22.6594
    reference variance = 0.854025
====================================================
  Execution time = 1.0135e+02
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s018
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 62500 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 6.1119e+04
  VMC Eavg = -2.2670e+01
  VMC Evar = 5.1306e-01
  Total weights = 7.820481328e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.8781e+01
  </log>
</opt>
<opt stage="main" walkers="62500">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.499295427250
                                         uncertainty =       0.001634054245

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.499295427250
                                         uncertainty =       0.001634054245

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000249824259
  error estimate for blocks of size 2^( 2) =       0.000258662603
  error estimate for blocks of size 2^( 3) =       0.000266536515
  error estimate for blocks of size 2^( 4) =       0.000272268132
  error estimate for blocks of size 2^( 5) =       0.000275610592
  error estimate for blocks of size 2^( 6) =       0.000277600145
  error estimate for blocks of size 2^( 7) =       0.000278550445
  error estimate for blocks of size 2^( 8) =       0.000278934213
  error estimate for blocks of size 2^( 9) =       0.000279095086

      target function =                  N/A
              le_mean =     -22.669680511334
             les_mean =     514.427473176505
             stat err =       0.000278544972
             autocorr =       1.243143980921
              std dev =       0.706609710356
             le_variance =       0.499297282770


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266968051133e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5259e-02, overlap shift 1.5259e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.669680511358       residual = 5.34e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.669693939278       residual = 4.84e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.669694430516       residual = 7.59e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.669694291956       residual = 4.83e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.669695000206       residual = 5.48e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.669694270048       residual = 1.55e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.669694342925       residual = 3.03e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.669694318971       residual = 7.56e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 1.5259e-02 is 2.964273e-03

solving harmonic davidson linear method for identity shift 6.1035e-02, overlap shift 6.1035e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.669680511358       residual = 5.34e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.669691369741       residual = 3.29e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.669691502115       residual = 3.22e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.669691388779       residual = 7.23e-08           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.669691507343       residual = 1.85e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.669691391482       residual = 2.14e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          5 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 6.1035e-02 is 9.874448e-04

solving harmonic davidson linear method for identity shift 2.4414e-01, overlap shift 2.4414e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.669680511358       residual = 5.34e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.669686661906       residual = 1.39e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.669686560500       residual = 5.96e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.669686521517       residual = 2.29e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 2.4414e-01 is 5.613296e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.284822 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.2015e+02
  </log>
  <optVariables href="FORM.s018.opt.xml">
ci_001                -7.063263e-01 3 1  ON 0
ci_002                -7.048317e-01 3 1  ON 1
ci_003                -3.766496e-02 3 1  ON 2
ci_004                -3.785023e-02 3 1  ON 3
ci_005                 1.593613e-02 3 1  ON 4
ci_006                 1.562562e-02 3 1  ON 5
ci_007                 1.219403e-02 3 1  ON 6
ci_008                 1.246737e-02 3 1  ON 7
ci_009                -1.163723e-02 3 1  ON 8
ci_010                -1.192235e-02 3 1  ON 9
ci_011                -8.260892e-03 3 1  ON 10
ci_012                -8.368178e-03 3 1  ON 11
ci_013                 9.461502e-03 3 1  ON 12
ci_014                 9.096181e-03 3 1  ON 13
ci_015                 1.222889e-02 3 1  ON 14
ci_016                 1.298433e-02 3 1  ON 15
ci_017                 1.072139e-02 3 1  ON 16
ci_018                 1.124829e-02 3 1  ON 17
ci_019                -3.562946e-03 3 1  ON 18
ci_020                -3.506172e-03 3 1  ON 19
ci_021                -8.360324e-03 3 1  ON 20
ci_022                -9.060709e-03 3 1  ON 21
ci_023                 8.313493e-03 3 1  ON 22
ci_024                 7.845004e-03 3 1  ON 23
ci_025                 4.200829e-03 3 1  ON 24
ci_026                 4.370995e-03 3 1  ON 25
ci_027                 6.365209e-03 3 1  ON 26
ci_028                 6.489308e-03 3 1  ON 27
ci_029                -4.366940e-03 3 1  ON 28
ci_030                -5.160328e-03 3 1  ON 29
ci_031                -9.259159e-03 3 1  ON 30
ci_032                -7.960972e-03 3 1  ON 31
ci_033                 4.513284e-03 3 1  ON 32
ci_034                 4.682506e-03 3 1  ON 33
ci_035                 8.913615e-04 3 1  ON 34
ci_036                 1.468365e-03 3 1  ON 35
ci_037                 4.995847e-03 3 1  ON 36
ci_038                 4.656535e-03 3 1  ON 37
ci_039                 5.674484e-03 3 1  ON 38
ci_040                 4.827694e-03 3 1  ON 39
ci_041                 5.144261e-03 3 1  ON 40
ci_042                 5.193895e-03 3 1  ON 41
ci_043                 4.681193e-03 3 1  ON 42
ci_044                 4.921326e-03 3 1  ON 43
ci_045                 2.786996e-03 3 1  ON 44
ci_046                 3.628477e-03 3 1  ON 45
ci_047                -8.026206e-04 3 1  ON 46
ci_048                -4.506654e-04 3 1  ON 47
ci_049                 9.801254e-04 3 1  ON 48
ci_050                 2.349325e-03 3 1  ON 49
ci_051                -1.436017e-03 3 1  ON 50
ci_052                -1.166700e-03 3 1  ON 51
ci_053                -2.700506e-03 3 1  ON 52
ci_054                -2.418375e-03 3 1  ON 53
ci_055                -1.314657e-03 3 1  ON 54
ci_056                -1.140004e-03 3 1  ON 55
ci_057                -1.798763e-03 3 1  ON 56
ci_058                -1.947803e-03 3 1  ON 57
ci_059                 7.333177e-05 3 1  ON 58
ci_060                 5.091398e-04 3 1  ON 59
ci_061                -3.789193e-04 3 1  ON 60
ci_062                 4.570332e-04 3 1  ON 61
ci_063                -7.749860e-04 3 1  ON 62
ci_064                -9.821177e-04 3 1  ON 63
ci_065                -2.827591e-03 3 1  ON 64
ci_066                -1.998337e-03 3 1  ON 65
ci_067                -3.106928e-03 3 1  ON 66
ci_068                -2.352435e-03 3 1  ON 67
ci_069                -5.086936e-04 3 1  ON 68
ci_070                -2.358394e-04 3 1  ON 69
ci_071                -2.374856e-03 3 1  ON 70
ci_072                -2.405252e-03 3 1  ON 71
ci_073                -1.342619e-04 3 1  ON 72
ci_074                 2.385980e-04 3 1  ON 73
ci_075                -3.086380e-04 3 1  ON 74
ci_076                -3.851140e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="250">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =8000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 18
    time step          = 0.05
    reference energy   = -22.6566
    reference variance = 0.200304
====================================================
  Execution time = 1.0077e+02
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s018
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 62500 
  VMC Eavg = -2.2670e+01
  VMC Evar = 5.1496e-01
  Total weights = 7.8203e+06
  Execution time = 1.4407e+01
  </log>
</opt>
<opt stage="main" walkers="62500">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

ERROR CostFunction-> Number of Effective Walkers is too small! 
  Number of effective walkers (samples) / total number of samples = 0.000110826
  User specified threshold minwalkers = 0.3
  If this message appears frequently. You might have to be cautious. 
  Find info about parameter "minwalkers" in the user manual!
Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.502654940726
                                         uncertainty =       0.001815446010

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.502654940726
                                         uncertainty =       0.001815446010

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000250663244
  error estimate for blocks of size 2^( 2) =       0.000259547658
  error estimate for blocks of size 2^( 3) =       0.000267545947
  error estimate for blocks of size 2^( 4) =       0.000273607603
  error estimate for blocks of size 2^( 5) =       0.000276867789
  error estimate for blocks of size 2^( 6) =       0.000278403606
  error estimate for blocks of size 2^( 7) =       0.000278568202
  error estimate for blocks of size 2^( 8) =       0.000279061908
  error estimate for blocks of size 2^( 9) =       0.000279859719

      target function =                  N/A
              le_mean =     -22.670159261142
             les_mean =     514.466595001535
             stat err =       0.000278973359
             autocorr =       1.238637295752
              std dev =       0.708982717397
             le_variance =       0.502656493567

ERROR CostFunction-> Number of Effective Walkers is too small! 
  Number of effective walkers (samples) / total number of samples = 0.0205292
  User specified threshold minwalkers = 0.3
  If this message appears frequently. You might have to be cautious. 
  Find info about parameter "minwalkers" in the user manual!
Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.502795001030
                                         uncertainty =       0.001891694502

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.502795001030
                                         uncertainty =       0.001891694502

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000250698266
  error estimate for blocks of size 2^( 2) =       0.000259580108
  error estimate for blocks of size 2^( 3) =       0.000267568500
  error estimate for blocks of size 2^( 4) =       0.000273632912
  error estimate for blocks of size 2^( 5) =       0.000276905679
  error estimate for blocks of size 2^( 6) =       0.000278442273
  error estimate for blocks of size 2^( 7) =       0.000278605446
  error estimate for blocks of size 2^( 8) =       0.000279126221
  error estimate for blocks of size 2^( 9) =       0.000279889623

      target function =                  N/A
              le_mean =     -22.670151978468
             les_mean =     514.548647772351
             stat err =       0.000279015891
             autocorr =       1.238668852694
              std dev =       0.709081775433
             le_variance =       0.502796964251

ERROR CostFunction-> Number of Effective Walkers is too small! 
  Number of effective walkers (samples) / total number of samples = 0.000111081
  User specified threshold minwalkers = 0.3
  If this message appears frequently. You might have to be cautious. 
  Find info about parameter "minwalkers" in the user manual!
Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.508174820016
                                         uncertainty =       0.004133794062

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.508174820016
                                         uncertainty =       0.004133794062

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000252034746
  error estimate for blocks of size 2^( 2) =       0.000260875146
  error estimate for blocks of size 2^( 3) =       0.000268860589
  error estimate for blocks of size 2^( 4) =       0.000274861709
  error estimate for blocks of size 2^( 5) =       0.000278080953
  error estimate for blocks of size 2^( 6) =       0.000279609502
  error estimate for blocks of size 2^( 7) =       0.000279775133
  error estimate for blocks of size 2^( 8) =       0.000280231082
  error estimate for blocks of size 2^( 9) =       0.000280992100

      target function =                  N/A
              le_mean =     -22.670196958324
             les_mean =     516.561534744211
             stat err =       0.000280151954
             autocorr =       1.235567501201
              std dev =       0.712861912641
             le_variance =       0.508172106494

ERROR CostFunction-> Number of Effective Walkers is too small! 
  Number of effective walkers (samples) / total number of samples = 0.00137544
  User specified threshold minwalkers = 0.3
  If this message appears frequently. You might have to be cautious. 
  Find info about parameter "minwalkers" in the user manual!
Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.502470028474
                                         uncertainty =       0.001845213116

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.502470028474
                                         uncertainty =       0.001845213116

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000250617161
  error estimate for blocks of size 2^( 2) =       0.000259504165
  error estimate for blocks of size 2^( 3) =       0.000267499983
  error estimate for blocks of size 2^( 4) =       0.000273560523
  error estimate for blocks of size 2^( 5) =       0.000276824130
  error estimate for blocks of size 2^( 6) =       0.000278363237
  error estimate for blocks of size 2^( 7) =       0.000278521478
  error estimate for blocks of size 2^( 8) =       0.000279025858
  error estimate for blocks of size 2^( 9) =       0.000279811861

      target function =                  N/A
              le_mean =     -22.670143862311
             les_mean =     514.463312357459
             stat err =       0.000278930609
             autocorr =       1.238713116944
              std dev =       0.708852376941
             le_variance =       0.502471692295


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.670159261142        initial
     1.5259e-02     1.5259e-01             2.9643e-03       -22.670151978468
     6.1035e-02     6.1035e-01             9.8744e-04       -22.670196958324  <--
     2.4414e-01     2.4414e+00             5.6133e-04       -22.670143862311

*****************************************************************************
Applying the update for shift_i =   6.1035e-02     and shift_s =   6.1035e-01
*****************************************************************************

  Execution time = 1.7315e+02
  </log>
  <optVariables href="FORM.s018.opt.xml">
ci_001                -7.063263e-01 3 1  ON 0
ci_002                -7.048317e-01 3 1  ON 1
ci_003                -3.766496e-02 3 1  ON 2
ci_004                -3.785023e-02 3 1  ON 3
ci_005                 1.593613e-02 3 1  ON 4
ci_006                 1.562562e-02 3 1  ON 5
ci_007                 1.219403e-02 3 1  ON 6
ci_008                 1.246737e-02 3 1  ON 7
ci_009                -1.163723e-02 3 1  ON 8
ci_010                -1.192235e-02 3 1  ON 9
ci_011                -8.260892e-03 3 1  ON 10
ci_012                -8.368178e-03 3 1  ON 11
ci_013                 9.461502e-03 3 1  ON 12
ci_014                 9.096181e-03 3 1  ON 13
ci_015                 1.222889e-02 3 1  ON 14
ci_016                 1.298433e-02 3 1  ON 15
ci_017                 1.072139e-02 3 1  ON 16
ci_018                 1.124829e-02 3 1  ON 17
ci_019                -3.562946e-03 3 1  ON 18
ci_020                -3.506172e-03 3 1  ON 19
ci_021                -8.360324e-03 3 1  ON 20
ci_022                -9.060709e-03 3 1  ON 21
ci_023                 8.313493e-03 3 1  ON 22
ci_024                 7.845004e-03 3 1  ON 23
ci_025                 4.200829e-03 3 1  ON 24
ci_026                 4.370995e-03 3 1  ON 25
ci_027                 6.365209e-03 3 1  ON 26
ci_028                 6.489308e-03 3 1  ON 27
ci_029                -4.366940e-03 3 1  ON 28
ci_030                -5.160328e-03 3 1  ON 29
ci_031                -9.259159e-03 3 1  ON 30
ci_032                -7.960972e-03 3 1  ON 31
ci_033                 4.513284e-03 3 1  ON 32
ci_034                 4.682506e-03 3 1  ON 33
ci_035                 8.913615e-04 3 1  ON 34
ci_036                 1.468365e-03 3 1  ON 35
ci_037                 4.995847e-03 3 1  ON 36
ci_038                 4.656535e-03 3 1  ON 37
ci_039                 5.674484e-03 3 1  ON 38
ci_040                 4.827694e-03 3 1  ON 39
ci_041                 5.144261e-03 3 1  ON 40
ci_042                 5.193895e-03 3 1  ON 41
ci_043                 4.681193e-03 3 1  ON 42
ci_044                 4.921326e-03 3 1  ON 43
ci_045                 2.786996e-03 3 1  ON 44
ci_046                 3.628477e-03 3 1  ON 45
ci_047                -8.026206e-04 3 1  ON 46
ci_048                -4.506654e-04 3 1  ON 47
ci_049                 9.801254e-04 3 1  ON 48
ci_050                 2.349325e-03 3 1  ON 49
ci_051                -1.436017e-03 3 1  ON 50
ci_052                -1.166700e-03 3 1  ON 51
ci_053                -2.700506e-03 3 1  ON 52
ci_054                -2.418375e-03 3 1  ON 53
ci_055                -1.314657e-03 3 1  ON 54
ci_056                -1.140004e-03 3 1  ON 55
ci_057                -1.798763e-03 3 1  ON 56
ci_058                -1.947803e-03 3 1  ON 57
ci_059                 7.333177e-05 3 1  ON 58
ci_060                 5.091398e-04 3 1  ON 59
ci_061                -3.789193e-04 3 1  ON 60
ci_062                 4.570332e-04 3 1  ON 61
ci_063                -7.749860e-04 3 1  ON 62
ci_064                -9.821177e-04 3 1  ON 63
ci_065                -2.827591e-03 3 1  ON 64
ci_066                -1.998337e-03 3 1  ON 65
ci_067                -3.106928e-03 3 1  ON 66
ci_068                -2.352435e-03 3 1  ON 67
ci_069                -5.086936e-04 3 1  ON 68
ci_070                -2.358394e-04 3 1  ON 69
ci_071                -2.374856e-03 3 1  ON 70
ci_072                -2.405252e-03 3 1  ON 71
ci_073                -1.342619e-04 3 1  ON 72
ci_074                 2.385980e-04 3 1  ON 73
ci_075                -3.086380e-04 3 1  ON 74
ci_076                -3.851140e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 2.9333e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s019 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s019 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=19  my_counter=0
  time step      = 5.0000e-02
  blocks         = 250
  steps          = 250
  substeps       = 10
  current        = 0
  target samples = 8.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">250</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">6.2500e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">8.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">6.2500e+04</parameter>
<parameter name="steps" condition="int">250</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2673e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="250">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =8000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 19
    time step          = 0.05
    reference energy   = -22.5243
    reference variance = 1.03791
====================================================
  Execution time = 1.0110e+02
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s019
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 62500 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 6.1132e+04
  VMC Eavg = -2.2670e+01
  VMC Evar = 5.1437e-01
  Total weights = 7.819916611e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.8720e+01
  </log>
</opt>
<opt stage="main" walkers="62500">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.499986674583
                                         uncertainty =       0.001801282509

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.499986674583
                                         uncertainty =       0.001801282509

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000249997466
  error estimate for blocks of size 2^( 2) =       0.000258868394
  error estimate for blocks of size 2^( 3) =       0.000266785820
  error estimate for blocks of size 2^( 4) =       0.000272082507
  error estimate for blocks of size 2^( 5) =       0.000275448630
  error estimate for blocks of size 2^( 6) =       0.000276842562
  error estimate for blocks of size 2^( 7) =       0.000277032499
  error estimate for blocks of size 2^( 8) =       0.000277380487
  error estimate for blocks of size 2^( 9) =       0.000278920951

      target function =                  N/A
              le_mean =     -22.670200598313
             les_mean =     514.452365748772
             stat err =       0.000277544125
             autocorr =       1.232516844605
              std dev =       0.707099613929
             le_variance =       0.499989864018


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.267020059831e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5259e-02, overlap shift 1.5259e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.670200598332       residual = 5.71e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.670213379667       residual = 6.13e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.670213957143       residual = 7.51e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.670214694897       residual = 9.18e-08           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.670214650328       residual = 2.78e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.670214648939       residual = 6.99e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          5 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 1.5259e-02 is 1.622135e-03

solving harmonic davidson linear method for identity shift 6.1035e-02, overlap shift 6.1035e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.670200598332       residual = 5.71e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.670210784441       residual = 3.96e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.670211065429       residual = 3.23e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.670211424112       residual = 2.11e-08           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.670211396412       residual = 2.78e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          4 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 6.1035e-02 is 1.162685e-03

solving harmonic davidson linear method for identity shift 2.4414e-01, overlap shift 2.4414e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.670200598332       residual = 5.71e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.670206219201       residual = 1.43e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.670206329240       residual = 6.31e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.670206418151       residual = 2.68e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 2.4414e-01 is 5.498070e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.289891 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.1985e+02
  </log>
  <optVariables href="FORM.s019.opt.xml">
ci_001                -7.062820e-01 3 1  ON 0
ci_002                -7.049529e-01 3 1  ON 1
ci_003                -3.696021e-02 3 1  ON 2
ci_004                -3.734683e-02 3 1  ON 3
ci_005                 1.590096e-02 3 1  ON 4
ci_006                 1.605575e-02 3 1  ON 5
ci_007                 1.270390e-02 3 1  ON 6
ci_008                 1.234049e-02 3 1  ON 7
ci_009                -1.170287e-02 3 1  ON 8
ci_010                -1.197305e-02 3 1  ON 9
ci_011                -7.165009e-03 3 1  ON 10
ci_012                -8.263078e-03 3 1  ON 11
ci_013                 9.704519e-03 3 1  ON 12
ci_014                 9.660586e-03 3 1  ON 13
ci_015                 1.166292e-02 3 1  ON 14
ci_016                 1.230576e-02 3 1  ON 15
ci_017                 1.114843e-02 3 1  ON 16
ci_018                 1.151031e-02 3 1  ON 17
ci_019                -3.442428e-03 3 1  ON 18
ci_020                -3.629743e-03 3 1  ON 19
ci_021                -9.349902e-03 3 1  ON 20
ci_022                -8.645916e-03 3 1  ON 21
ci_023                 8.334357e-03 3 1  ON 22
ci_024                 7.373111e-03 3 1  ON 23
ci_025                 4.575277e-03 3 1  ON 24
ci_026                 3.842823e-03 3 1  ON 25
ci_027                 6.862711e-03 3 1  ON 26
ci_028                 6.662509e-03 3 1  ON 27
ci_029                -4.926182e-03 3 1  ON 28
ci_030                -4.449632e-03 3 1  ON 29
ci_031                -8.096474e-03 3 1  ON 30
ci_032                -7.761900e-03 3 1  ON 31
ci_033                 4.010239e-03 3 1  ON 32
ci_034                 4.359961e-03 3 1  ON 33
ci_035                 1.005048e-03 3 1  ON 34
ci_036                 1.001775e-03 3 1  ON 35
ci_037                 5.788070e-03 3 1  ON 36
ci_038                 5.159329e-03 3 1  ON 37
ci_039                 5.543853e-03 3 1  ON 38
ci_040                 5.179692e-03 3 1  ON 39
ci_041                 5.479548e-03 3 1  ON 40
ci_042                 4.995496e-03 3 1  ON 41
ci_043                 4.265816e-03 3 1  ON 42
ci_044                 4.961693e-03 3 1  ON 43
ci_045                 2.654225e-03 3 1  ON 44
ci_046                 3.486040e-03 3 1  ON 45
ci_047                -5.781352e-04 3 1  ON 46
ci_048                -7.307253e-04 3 1  ON 47
ci_049                 1.175410e-03 3 1  ON 48
ci_050                 1.931037e-03 3 1  ON 49
ci_051                -1.086835e-03 3 1  ON 50
ci_052                -8.773824e-04 3 1  ON 51
ci_053                -3.190683e-03 3 1  ON 52
ci_054                -2.363284e-03 3 1  ON 53
ci_055                -1.214221e-03 3 1  ON 54
ci_056                -9.919566e-04 3 1  ON 55
ci_057                -1.831810e-03 3 1  ON 56
ci_058                -1.394383e-03 3 1  ON 57
ci_059                 3.798664e-04 3 1  ON 58
ci_060                 2.011040e-04 3 1  ON 59
ci_061                -1.089053e-03 3 1  ON 60
ci_062                 5.320542e-04 3 1  ON 61
ci_063                -4.975645e-04 3 1  ON 62
ci_064                -1.113810e-03 3 1  ON 63
ci_065                -3.018705e-03 3 1  ON 64
ci_066                -2.625445e-03 3 1  ON 65
ci_067                -2.611224e-03 3 1  ON 66
ci_068                -2.798057e-03 3 1  ON 67
ci_069                 2.241904e-04 3 1  ON 68
ci_070                -4.315283e-04 3 1  ON 69
ci_071                -2.365625e-03 3 1  ON 70
ci_072                -1.934532e-03 3 1  ON 71
ci_073                -6.412108e-05 3 1  ON 72
ci_074                 9.090803e-05 3 1  ON 73
ci_075                -7.543263e-06 3 1  ON 74
ci_076                -5.765057e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="250">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =8000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 19
    time step          = 0.05
    reference energy   = -22.6473
    reference variance = 0.966598
====================================================
  Execution time = 1.0009e+02
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s019
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 62500 
  VMC Eavg = -2.2670e+01
  VMC Evar = 5.1245e-01
  Total weights = 7.8210e+06
  Execution time = 1.4479e+01
  </log>
</opt>
<opt stage="main" walkers="62500">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.498800618779
                                         uncertainty =       0.001403162102

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.498800618779
                                         uncertainty =       0.001403162102

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000249700519
  error estimate for blocks of size 2^( 2) =       0.000258574465
  error estimate for blocks of size 2^( 3) =       0.000266343190
  error estimate for blocks of size 2^( 4) =       0.000271873264
  error estimate for blocks of size 2^( 5) =       0.000275803365
  error estimate for blocks of size 2^( 6) =       0.000277656874
  error estimate for blocks of size 2^( 7) =       0.000278360026
  error estimate for blocks of size 2^( 8) =       0.000278315552
  error estimate for blocks of size 2^( 9) =       0.000278513161

      target function =                  N/A
              le_mean =     -22.669984786370
             les_mean =     514.463134329042
             stat err =       0.000278211403
             autocorr =       1.241397777954
              std dev =       0.706259720417
             le_variance =       0.498802792684

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.498411885051
                                         uncertainty =       0.001387168778

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.498411885051
                                         uncertainty =       0.001387168778

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000249603206
  error estimate for blocks of size 2^( 2) =       0.000258478629
  error estimate for blocks of size 2^( 3) =       0.000266246909
  error estimate for blocks of size 2^( 4) =       0.000271775594
  error estimate for blocks of size 2^( 5) =       0.000275714916
  error estimate for blocks of size 2^( 6) =       0.000277560377
  error estimate for blocks of size 2^( 7) =       0.000278263928
  error estimate for blocks of size 2^( 8) =       0.000278221457
  error estimate for blocks of size 2^( 9) =       0.000278420844

      target function =                  N/A
              le_mean =     -22.669961303824
             les_mean =     514.441903149873
             stat err =       0.000278116652
             autocorr =       1.241519842128
              std dev =       0.705984478771
             le_variance =       0.498414084266

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.498642456196
                                         uncertainty =       0.001402567177

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.498642456196
                                         uncertainty =       0.001402567177

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000249660994
  error estimate for blocks of size 2^( 2) =       0.000258535843
  error estimate for blocks of size 2^( 3) =       0.000266302749
  error estimate for blocks of size 2^( 4) =       0.000271830682
  error estimate for blocks of size 2^( 5) =       0.000275776777
  error estimate for blocks of size 2^( 6) =       0.000277623154
  error estimate for blocks of size 2^( 7) =       0.000278316303
  error estimate for blocks of size 2^( 8) =       0.000278279035
  error estimate for blocks of size 2^( 9) =       0.000278482208

      target function =                  N/A
              le_mean =     -22.669978663917
             les_mean =     514.465247573015
             stat err =       0.000278175175
             autocorr =       1.241467480947
              std dev =       0.706147928772
             le_variance =       0.498644897309

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.498732522585
                                         uncertainty =       0.001380898340

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.498732522585
                                         uncertainty =       0.001380898340

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000249683438
  error estimate for blocks of size 2^( 2) =       0.000258557496
  error estimate for blocks of size 2^( 3) =       0.000266324551
  error estimate for blocks of size 2^( 4) =       0.000271852590
  error estimate for blocks of size 2^( 5) =       0.000275782524
  error estimate for blocks of size 2^( 6) =       0.000277632380
  error estimate for blocks of size 2^( 7) =       0.000278329462
  error estimate for blocks of size 2^( 8) =       0.000278270661
  error estimate for blocks of size 2^( 9) =       0.000278446227

      target function =                  N/A
              le_mean =     -22.669973766099
             les_mean =     516.443947057999
             stat err =       0.000278169682
             autocorr =       1.241195285228
              std dev =       0.706211409175
             le_variance =       0.498734554450


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.669984786370        initial  <--
     1.5259e-02     1.5259e-01             1.6221e-03       -22.669961303824
     6.1035e-02     6.1035e-01             1.1627e-03       -22.669978663917
     2.4414e-01     2.4414e+00             5.4981e-04       -22.669973766099

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 172.4302
  </log>
  <optVariables href="FORM.s019.opt.xml">
ci_001                -7.063263e-01 3 1  ON 0
ci_002                -7.048317e-01 3 1  ON 1
ci_003                -3.766496e-02 3 1  ON 2
ci_004                -3.785023e-02 3 1  ON 3
ci_005                 1.593613e-02 3 1  ON 4
ci_006                 1.562562e-02 3 1  ON 5
ci_007                 1.219403e-02 3 1  ON 6
ci_008                 1.246737e-02 3 1  ON 7
ci_009                -1.163723e-02 3 1  ON 8
ci_010                -1.192235e-02 3 1  ON 9
ci_011                -8.260892e-03 3 1  ON 10
ci_012                -8.368178e-03 3 1  ON 11
ci_013                 9.461502e-03 3 1  ON 12
ci_014                 9.096181e-03 3 1  ON 13
ci_015                 1.222889e-02 3 1  ON 14
ci_016                 1.298433e-02 3 1  ON 15
ci_017                 1.072139e-02 3 1  ON 16
ci_018                 1.124829e-02 3 1  ON 17
ci_019                -3.562946e-03 3 1  ON 18
ci_020                -3.506172e-03 3 1  ON 19
ci_021                -8.360324e-03 3 1  ON 20
ci_022                -9.060709e-03 3 1  ON 21
ci_023                 8.313493e-03 3 1  ON 22
ci_024                 7.845004e-03 3 1  ON 23
ci_025                 4.200829e-03 3 1  ON 24
ci_026                 4.370995e-03 3 1  ON 25
ci_027                 6.365209e-03 3 1  ON 26
ci_028                 6.489308e-03 3 1  ON 27
ci_029                -4.366940e-03 3 1  ON 28
ci_030                -5.160328e-03 3 1  ON 29
ci_031                -9.259159e-03 3 1  ON 30
ci_032                -7.960972e-03 3 1  ON 31
ci_033                 4.513284e-03 3 1  ON 32
ci_034                 4.682506e-03 3 1  ON 33
ci_035                 8.913615e-04 3 1  ON 34
ci_036                 1.468365e-03 3 1  ON 35
ci_037                 4.995847e-03 3 1  ON 36
ci_038                 4.656535e-03 3 1  ON 37
ci_039                 5.674484e-03 3 1  ON 38
ci_040                 4.827694e-03 3 1  ON 39
ci_041                 5.144261e-03 3 1  ON 40
ci_042                 5.193895e-03 3 1  ON 41
ci_043                 4.681193e-03 3 1  ON 42
ci_044                 4.921326e-03 3 1  ON 43
ci_045                 2.786996e-03 3 1  ON 44
ci_046                 3.628477e-03 3 1  ON 45
ci_047                -8.026206e-04 3 1  ON 46
ci_048                -4.506654e-04 3 1  ON 47
ci_049                 9.801254e-04 3 1  ON 48
ci_050                 2.349325e-03 3 1  ON 49
ci_051                -1.436017e-03 3 1  ON 50
ci_052                -1.166700e-03 3 1  ON 51
ci_053                -2.700506e-03 3 1  ON 52
ci_054                -2.418375e-03 3 1  ON 53
ci_055                -1.314657e-03 3 1  ON 54
ci_056                -1.140004e-03 3 1  ON 55
ci_057                -1.798763e-03 3 1  ON 56
ci_058                -1.947803e-03 3 1  ON 57
ci_059                 7.333177e-05 3 1  ON 58
ci_060                 5.091398e-04 3 1  ON 59
ci_061                -3.789193e-04 3 1  ON 60
ci_062                 4.570332e-04 3 1  ON 61
ci_063                -7.749860e-04 3 1  ON 62
ci_064                -9.821177e-04 3 1  ON 63
ci_065                -2.827591e-03 3 1  ON 64
ci_066                -1.998337e-03 3 1  ON 65
ci_067                -3.106928e-03 3 1  ON 66
ci_068                -2.352435e-03 3 1  ON 67
ci_069                -5.086936e-04 3 1  ON 68
ci_070                -2.358394e-04 3 1  ON 69
ci_071                -2.374856e-03 3 1  ON 70
ci_072                -2.405252e-03 3 1  ON 71
ci_073                -1.342619e-04 3 1  ON 72
ci_074                 2.385980e-04 3 1  ON 73
ci_075                -3.086380e-04 3 1  ON 74
ci_076                -3.851140e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 2.9229e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s020 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s020 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=20  my_counter=0
  time step      = 5.0000e-02
  blocks         = 250
  steps          = 250
  substeps       = 10
  current        = 0
  target samples = 8.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">250</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">6.2500e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">8.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">6.2500e+04</parameter>
<parameter name="steps" condition="int">250</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2669e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="250">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =8000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 20
    time step          = 0.05
    reference energy   = -22.7981
    reference variance = 0.247155
====================================================
  Execution time = 9.9081e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s020
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 62500 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 6.1137e+04
  VMC Eavg = -2.2669e+01
  VMC Evar = 5.1027e-01
  Total weights = 7.821038759e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.8931e+01
  </log>
</opt>
<opt stage="main" walkers="62500">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.495650886690
                                         uncertainty =       0.001320772007

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.495650886690
                                         uncertainty =       0.001320772007

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000248911291
  error estimate for blocks of size 2^( 2) =       0.000257953154
  error estimate for blocks of size 2^( 3) =       0.000265837244
  error estimate for blocks of size 2^( 4) =       0.000271398599
  error estimate for blocks of size 2^( 5) =       0.000274484950
  error estimate for blocks of size 2^( 6) =       0.000276239358
  error estimate for blocks of size 2^( 7) =       0.000277700366
  error estimate for blocks of size 2^( 8) =       0.000279092718
  error estimate for blocks of size 2^( 9) =       0.000281142913

      target function =                  N/A
              le_mean =     -22.668870904204
             les_mean =     514.387982282075
             stat err =       0.000278543839
             autocorr =       1.252269832387
              std dev =       0.704027446933
             le_variance =       0.495654646035


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266887090420e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5259e-01, overlap shift 1.5259e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.668870904224       residual = 6.32e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.668881019711       residual = 1.37e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.668881634744       residual = 5.23e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.668881613261       residual = 2.57e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 1.5259e-01 is 1.023384e-03

solving harmonic davidson linear method for identity shift 6.1035e-01, overlap shift 6.1035e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.668870904224       residual = 6.32e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.668875139283       residual = 6.25e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.668875299083       residual = 1.78e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.668875298420       residual = 5.33e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 6.1035e-01 is 4.121979e-04

solving harmonic davidson linear method for identity shift 2.4414e+00, overlap shift 2.4414e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.668870904224       residual = 6.32e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.668872177804       residual = 6.68e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.668872218110       residual = 1.72e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.668872219164       residual = 5.35e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 2.4414e+00 is 1.216695e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.291313 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.1803e+02
  </log>
  <optVariables href="FORM.s020.opt.xml">
ci_001                -7.063540e-01 3 1  ON 0
ci_002                -7.048212e-01 3 1  ON 1
ci_003                -3.760908e-02 3 1  ON 2
ci_004                -3.777409e-02 3 1  ON 3
ci_005                 1.593976e-02 3 1  ON 4
ci_006                 1.555313e-02 3 1  ON 5
ci_007                 1.220390e-02 3 1  ON 6
ci_008                 1.239184e-02 3 1  ON 7
ci_009                -1.167353e-02 3 1  ON 8
ci_010                -1.184487e-02 3 1  ON 9
ci_011                -8.244140e-03 3 1  ON 10
ci_012                -8.543910e-03 3 1  ON 11
ci_013                 9.468915e-03 3 1  ON 12
ci_014                 9.217477e-03 3 1  ON 13
ci_015                 1.225634e-02 3 1  ON 14
ci_016                 1.277772e-02 3 1  ON 15
ci_017                 1.069996e-02 3 1  ON 16
ci_018                 1.114066e-02 3 1  ON 17
ci_019                -3.569974e-03 3 1  ON 18
ci_020                -3.377386e-03 3 1  ON 19
ci_021                -8.283297e-03 3 1  ON 20
ci_022                -9.039176e-03 3 1  ON 21
ci_023                 8.244431e-03 3 1  ON 22
ci_024                 7.845842e-03 3 1  ON 23
ci_025                 4.226540e-03 3 1  ON 24
ci_026                 4.570567e-03 3 1  ON 25
ci_027                 6.420510e-03 3 1  ON 26
ci_028                 6.494208e-03 3 1  ON 27
ci_029                -4.532329e-03 3 1  ON 28
ci_030                -5.144043e-03 3 1  ON 29
ci_031                -8.995018e-03 3 1  ON 30
ci_032                -7.914305e-03 3 1  ON 31
ci_033                 4.638605e-03 3 1  ON 32
ci_034                 4.525942e-03 3 1  ON 33
ci_035                 8.276776e-04 3 1  ON 34
ci_036                 1.327898e-03 3 1  ON 35
ci_037                 5.014624e-03 3 1  ON 36
ci_038                 4.614094e-03 3 1  ON 37
ci_039                 5.600930e-03 3 1  ON 38
ci_040                 5.116186e-03 3 1  ON 39
ci_041                 5.023166e-03 3 1  ON 40
ci_042                 5.348073e-03 3 1  ON 41
ci_043                 4.797018e-03 3 1  ON 42
ci_044                 4.923919e-03 3 1  ON 43
ci_045                 2.794452e-03 3 1  ON 44
ci_046                 3.447244e-03 3 1  ON 45
ci_047                -7.777044e-04 3 1  ON 46
ci_048                -6.324796e-04 3 1  ON 47
ci_049                 1.392323e-03 3 1  ON 48
ci_050                 2.181202e-03 3 1  ON 49
ci_051                -1.275469e-03 3 1  ON 50
ci_052                -1.146207e-03 3 1  ON 51
ci_053                -2.787529e-03 3 1  ON 52
ci_054                -2.447572e-03 3 1  ON 53
ci_055                -1.260834e-03 3 1  ON 54
ci_056                -1.056010e-03 3 1  ON 55
ci_057                -1.707311e-03 3 1  ON 56
ci_058                -1.793511e-03 3 1  ON 57
ci_059                 6.014234e-05 3 1  ON 58
ci_060                 3.335244e-04 3 1  ON 59
ci_061                -3.203981e-04 3 1  ON 60
ci_062                 4.141576e-04 3 1  ON 61
ci_063                -8.918025e-04 3 1  ON 62
ci_064                -8.570937e-04 3 1  ON 63
ci_065                -2.710087e-03 3 1  ON 64
ci_066                -2.078341e-03 3 1  ON 65
ci_067                -3.085094e-03 3 1  ON 66
ci_068                -2.245019e-03 3 1  ON 67
ci_069                -3.457192e-04 3 1  ON 68
ci_070                -2.930026e-04 3 1  ON 69
ci_071                -2.289120e-03 3 1  ON 70
ci_072                -2.402189e-03 3 1  ON 71
ci_073                 1.932794e-04 3 1  ON 72
ci_074                 2.396036e-04 3 1  ON 73
ci_075                -4.336843e-04 3 1  ON 74
ci_076                -3.417149e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="250">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =8000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 20
    time step          = 0.05
    reference energy   = -22.8089
    reference variance = 0.93727
====================================================
  Execution time = 9.8656e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s020
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 62500 
  VMC Eavg = -2.2669e+01
  VMC Evar = 5.1489e-01
  Total weights = 7.8205e+06
  Execution time = 1.4929e+01
  </log>
</opt>
<opt stage="main" walkers="62500">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.500864976235
                                         uncertainty =       0.001403328379

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.500864976235
                                         uncertainty =       0.001403328379

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000250215981
  error estimate for blocks of size 2^( 2) =       0.000259028783
  error estimate for blocks of size 2^( 3) =       0.000267006116
  error estimate for blocks of size 2^( 4) =       0.000272938670
  error estimate for blocks of size 2^( 5) =       0.000276050418
  error estimate for blocks of size 2^( 6) =       0.000278194411
  error estimate for blocks of size 2^( 7) =       0.000278789910
  error estimate for blocks of size 2^( 8) =       0.000279066627
  error estimate for blocks of size 2^( 9) =       0.000278563058

      target function =                  N/A
              le_mean =     -22.669356684606
             les_mean =     514.416867477485
             stat err =       0.000278653502
             autocorr =       1.240220541134
              std dev =       0.707717668824
             le_variance =       0.500864298766

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.500738840785
                                         uncertainty =       0.001379277293

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.500738840785
                                         uncertainty =       0.001379277293

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000250184440
  error estimate for blocks of size 2^( 2) =       0.000259000202
  error estimate for blocks of size 2^( 3) =       0.000266976756
  error estimate for blocks of size 2^( 4) =       0.000272912430
  error estimate for blocks of size 2^( 5) =       0.000276029301
  error estimate for blocks of size 2^( 6) =       0.000278172809
  error estimate for blocks of size 2^( 7) =       0.000278772789
  error estimate for blocks of size 2^( 8) =       0.000279060740
  error estimate for blocks of size 2^( 9) =       0.000278540379

      target function =                  N/A
              le_mean =     -22.669357545766
             les_mean =     514.455631294672
             stat err =       0.000278636679
             autocorr =       1.240383497630
              std dev =       0.707628456804
             le_variance =       0.500738032879

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.500715447947
                                         uncertainty =       0.001383664365

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.500715447947
                                         uncertainty =       0.001383664365

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000250178608
  error estimate for blocks of size 2^( 2) =       0.000258994196
  error estimate for blocks of size 2^( 3) =       0.000266970223
  error estimate for blocks of size 2^( 4) =       0.000272906997
  error estimate for blocks of size 2^( 5) =       0.000276020026
  error estimate for blocks of size 2^( 6) =       0.000278164846
  error estimate for blocks of size 2^( 7) =       0.000278757535
  error estimate for blocks of size 2^( 8) =       0.000279044677
  error estimate for blocks of size 2^( 9) =       0.000278533642

      target function =                  N/A
              le_mean =     -22.669355360990
             les_mean =     514.444300951369
             stat err =       0.000278625175
             autocorr =       1.240338899735
              std dev =       0.707611961381
             le_variance =       0.500714687890

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.500819495771
                                         uncertainty =       0.001399905403

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.500819495771
                                         uncertainty =       0.001399905403

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000250204616
  error estimate for blocks of size 2^( 2) =       0.000259018269
  error estimate for blocks of size 2^( 3) =       0.000266995509
  error estimate for blocks of size 2^( 4) =       0.000272928778
  error estimate for blocks of size 2^( 5) =       0.000276039578
  error estimate for blocks of size 2^( 6) =       0.000278183870
  error estimate for blocks of size 2^( 7) =       0.000278777795
  error estimate for blocks of size 2^( 8) =       0.000279057565
  error estimate for blocks of size 2^( 9) =       0.000278551532

      target function =                  N/A
              le_mean =     -22.669355601188
             les_mean =     514.417008306042
             stat err =       0.000278642690
             autocorr =       1.240236977538
              std dev =       0.707685521292
             le_variance =       0.500818797046


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.669356684606        initial
     1.5259e-01     1.5259e+00             1.0234e-03       -22.669357545766  <--
     6.1035e-01     6.1035e+00             4.1220e-04       -22.669355360990
     2.4414e+00     2.4414e+01             1.2167e-04       -22.669355601188

*****************************************************************************
Applying the update for shift_i =   1.5259e-01     and shift_s =   1.5259e+00
*****************************************************************************

  Execution time = 1.7153e+02
  </log>
  <optVariables href="FORM.s020.opt.xml">
ci_001                -7.064209e-01 3 1  ON 0
ci_002                -7.047858e-01 3 1  ON 1
ci_003                -3.747270e-02 3 1  ON 2
ci_004                -3.758434e-02 3 1  ON 3
ci_005                 1.594600e-02 3 1  ON 4
ci_006                 1.546209e-02 3 1  ON 5
ci_007                 1.219673e-02 3 1  ON 6
ci_008                 1.228754e-02 3 1  ON 7
ci_009                -1.174374e-02 3 1  ON 8
ci_010                -1.173940e-02 3 1  ON 9
ci_011                -8.227008e-03 3 1  ON 10
ci_012                -8.819890e-03 3 1  ON 11
ci_013                 9.474321e-03 3 1  ON 12
ci_014                 9.416692e-03 3 1  ON 13
ci_015                 1.231731e-02 3 1  ON 14
ci_016                 1.241530e-02 3 1  ON 15
ci_017                 1.069793e-02 3 1  ON 16
ci_018                 1.096915e-02 3 1  ON 17
ci_019                -3.595687e-03 3 1  ON 18
ci_020                -3.178407e-03 3 1  ON 19
ci_021                -8.195943e-03 3 1  ON 20
ci_022                -9.021079e-03 3 1  ON 21
ci_023                 8.158481e-03 3 1  ON 22
ci_024                 7.842271e-03 3 1  ON 23
ci_025                 4.265921e-03 3 1  ON 24
ci_026                 4.887672e-03 3 1  ON 25
ci_027                 6.487943e-03 3 1  ON 26
ci_028                 6.493941e-03 3 1  ON 27
ci_029                -4.805421e-03 3 1  ON 28
ci_030                -5.112484e-03 3 1  ON 29
ci_031                -8.568846e-03 3 1  ON 30
ci_032                -7.839919e-03 3 1  ON 31
ci_033                 4.828795e-03 3 1  ON 32
ci_034                 4.301114e-03 3 1  ON 33
ci_035                 7.573715e-04 3 1  ON 34
ci_036                 1.170163e-03 3 1  ON 35
ci_037                 5.049447e-03 3 1  ON 36
ci_038                 4.569406e-03 3 1  ON 37
ci_039                 5.523950e-03 3 1  ON 38
ci_040                 5.437393e-03 3 1  ON 39
ci_041                 4.868625e-03 3 1  ON 40
ci_042                 5.540192e-03 3 1  ON 41
ci_043                 4.999530e-03 3 1  ON 42
ci_044                 4.947221e-03 3 1  ON 43
ci_045                 2.784617e-03 3 1  ON 44
ci_046                 3.198348e-03 3 1  ON 45
ci_047                -7.516687e-04 3 1  ON 46
ci_048                -8.269786e-04 3 1  ON 47
ci_049                 2.003509e-03 3 1  ON 48
ci_050                 1.921145e-03 3 1  ON 49
ci_051                -1.032600e-03 3 1  ON 50
ci_052                -1.108064e-03 3 1  ON 51
ci_053                -2.948168e-03 3 1  ON 52
ci_054                -2.476351e-03 3 1  ON 53
ci_055                -1.167023e-03 3 1  ON 54
ci_056                -9.429973e-04 3 1  ON 55
ci_057                -1.583164e-03 3 1  ON 56
ci_058                -1.591769e-03 3 1  ON 57
ci_059                 2.665445e-05 3 1  ON 58
ci_060                 1.278758e-04 3 1  ON 59
ci_061                -2.427418e-04 3 1  ON 60
ci_062                 3.426439e-04 3 1  ON 61
ci_063                -1.066666e-03 3 1  ON 62
ci_064                -6.553101e-04 3 1  ON 63
ci_065                -2.536372e-03 3 1  ON 64
ci_066                -2.189620e-03 3 1  ON 65
ci_067                -3.058306e-03 3 1  ON 66
ci_068                -2.089813e-03 3 1  ON 67
ci_069                -1.090513e-04 3 1  ON 68
ci_070                -3.693195e-04 3 1  ON 69
ci_071                -2.187803e-03 3 1  ON 70
ci_072                -2.389005e-03 3 1  ON 71
ci_073                 5.552132e-04 3 1  ON 72
ci_074                 2.549640e-04 3 1  ON 73
ci_075                -6.134930e-04 3 1  ON 74
ci_076                -2.765324e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 2.8957e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s021 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s021 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=21  my_counter=0
  time step      = 5.0000e-02
  blocks         = 250
  steps          = 250
  substeps       = 10
  current        = 0
  target samples = 8.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">250</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">6.2500e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">8.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">6.2500e+04</parameter>
<parameter name="steps" condition="int">250</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2675e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="250">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =8000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 21
    time step          = 0.05
    reference energy   = -22.6164
    reference variance = 0.342637
====================================================
  Execution time = 9.9639e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s021
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 62500 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 6.1082e+04
  VMC Eavg = -2.2670e+01
  VMC Evar = 5.0866e-01
  Total weights = 7.820816263e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.9422e+01
  </log>
</opt>
<opt stage="main" walkers="62500">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.496410911535
                                         uncertainty =       0.001327884751

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.496410911535
                                         uncertainty =       0.001327884751

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000249101127
  error estimate for blocks of size 2^( 2) =       0.000257934199
  error estimate for blocks of size 2^( 3) =       0.000265984476
  error estimate for blocks of size 2^( 4) =       0.000271713064
  error estimate for blocks of size 2^( 5) =       0.000274766638
  error estimate for blocks of size 2^( 6) =       0.000276711934
  error estimate for blocks of size 2^( 7) =       0.000277783619
  error estimate for blocks of size 2^( 8) =       0.000278640221
  error estimate for blocks of size 2^( 9) =       0.000279026228

      target function =                  N/A
              le_mean =     -22.670136631902
             les_mean =     514.443752269697
             stat err =       0.000278040501
             autocorr =       1.245847075782
              std dev =       0.704564385533
             le_variance =       0.496410973362


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.267013663190e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.8147e-02, overlap shift 3.8147e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.670136631924       residual = 3.84e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.670143049409       residual = 2.80e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.670141986414       residual = 2.73e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.670142267532       residual = 4.24e-08           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.670142331204       residual = 1.36e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.670142344425       residual = 4.62e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          5 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 3.8147e-02 is 7.847551e-04

solving harmonic davidson linear method for identity shift 1.5259e-01, overlap shift 1.5259e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.670136631924       residual = 3.84e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.670140887044       residual = 1.57e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.670140354131       residual = 9.87e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.670140496461       residual = 5.06e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 1.5259e-01 is 5.086038e-04

solving harmonic davidson linear method for identity shift 6.1035e-01, overlap shift 6.1035e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.670136631924       residual = 3.84e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.670138444313       residual = 8.73e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.670138326740       residual = 3.84e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.670138370785       residual = 1.22e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 6.1035e-01 is 2.249530e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.292932 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.1908e+02
  </log>
  <optVariables href="FORM.s021.opt.xml">
ci_001                -7.063055e-01 3 1  ON 0
ci_002                -7.048756e-01 3 1  ON 1
ci_003                -3.777487e-02 3 1  ON 2
ci_004                -3.757254e-02 3 1  ON 3
ci_005                 1.628563e-02 3 1  ON 4
ci_006                 1.556932e-02 3 1  ON 5
ci_007                 1.215550e-02 3 1  ON 6
ci_008                 1.233638e-02 3 1  ON 7
ci_009                -1.156668e-02 3 1  ON 8
ci_010                -1.165714e-02 3 1  ON 9
ci_011                -8.266565e-03 3 1  ON 10
ci_012                -8.365703e-03 3 1  ON 11
ci_013                 9.859395e-03 3 1  ON 12
ci_014                 9.514812e-03 3 1  ON 13
ci_015                 1.239208e-02 3 1  ON 14
ci_016                 1.241369e-02 3 1  ON 15
ci_017                 1.068060e-02 3 1  ON 16
ci_018                 1.106962e-02 3 1  ON 17
ci_019                -3.498051e-03 3 1  ON 18
ci_020                -3.372129e-03 3 1  ON 19
ci_021                -8.501620e-03 3 1  ON 20
ci_022                -9.118747e-03 3 1  ON 21
ci_023                 7.849201e-03 3 1  ON 22
ci_024                 8.152979e-03 3 1  ON 23
ci_025                 4.245473e-03 3 1  ON 24
ci_026                 4.492605e-03 3 1  ON 25
ci_027                 6.626010e-03 3 1  ON 26
ci_028                 6.511230e-03 3 1  ON 27
ci_029                -4.570164e-03 3 1  ON 28
ci_030                -5.148218e-03 3 1  ON 29
ci_031                -8.421903e-03 3 1  ON 30
ci_032                -7.785844e-03 3 1  ON 31
ci_033                 4.625986e-03 3 1  ON 32
ci_034                 4.204132e-03 3 1  ON 33
ci_035                 9.833544e-04 3 1  ON 34
ci_036                 1.517108e-03 3 1  ON 35
ci_037                 5.103721e-03 3 1  ON 36
ci_038                 4.735070e-03 3 1  ON 37
ci_039                 5.989182e-03 3 1  ON 38
ci_040                 5.431119e-03 3 1  ON 39
ci_041                 4.993989e-03 3 1  ON 40
ci_042                 5.229852e-03 3 1  ON 41
ci_043                 4.761741e-03 3 1  ON 42
ci_044                 5.293791e-03 3 1  ON 43
ci_045                 2.670292e-03 3 1  ON 44
ci_046                 2.837044e-03 3 1  ON 45
ci_047                -4.590476e-04 3 1  ON 46
ci_048                -5.434943e-04 3 1  ON 47
ci_049                 2.171656e-03 3 1  ON 48
ci_050                 1.549064e-03 3 1  ON 49
ci_051                -1.212153e-03 3 1  ON 50
ci_052                -1.002756e-03 3 1  ON 51
ci_053                -2.765760e-03 3 1  ON 52
ci_054                -2.660908e-03 3 1  ON 53
ci_055                -1.280453e-03 3 1  ON 54
ci_056                -1.248366e-03 3 1  ON 55
ci_057                -1.228212e-03 3 1  ON 56
ci_058                -1.778567e-03 3 1  ON 57
ci_059                 3.748745e-04 3 1  ON 58
ci_060                 2.138759e-04 3 1  ON 59
ci_061                 2.314318e-04 3 1  ON 60
ci_062                 1.568231e-04 3 1  ON 61
ci_063                -7.040792e-04 3 1  ON 62
ci_064                -7.252263e-04 3 1  ON 63
ci_065                -2.542354e-03 3 1  ON 64
ci_066                -2.088373e-03 3 1  ON 65
ci_067                -2.830953e-03 3 1  ON 66
ci_068                -2.543528e-03 3 1  ON 67
ci_069                -2.977745e-04 3 1  ON 68
ci_070                -1.763428e-04 3 1  ON 69
ci_071                -2.427568e-03 3 1  ON 70
ci_072                -2.751836e-03 3 1  ON 71
ci_073                 5.178120e-04 3 1  ON 72
ci_074                -5.474812e-05 3 1  ON 73
ci_075                -1.048892e-04 3 1  ON 74
ci_076                -4.359331e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="250">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =8000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 21
    time step          = 0.05
    reference energy   = -22.7738
    reference variance = 0.392811
====================================================
  Execution time = 9.9411e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s021
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 62500 
  VMC Eavg = -2.2670e+01
  VMC Evar = 5.1142e-01
  Total weights = 7.8209e+06
  Execution time = 1.4405e+01
  </log>
</opt>
<opt stage="main" walkers="62500">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.497056234483
                                         uncertainty =       0.001342811762

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.497056234483
                                         uncertainty =       0.001342811762

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000249262861
  error estimate for blocks of size 2^( 2) =       0.000258317188
  error estimate for blocks of size 2^( 3) =       0.000266289379
  error estimate for blocks of size 2^( 4) =       0.000272189099
  error estimate for blocks of size 2^( 5) =       0.000275602587
  error estimate for blocks of size 2^( 6) =       0.000277314732
  error estimate for blocks of size 2^( 7) =       0.000277808767
  error estimate for blocks of size 2^( 8) =       0.000278649481
  error estimate for blocks of size 2^( 9) =       0.000279624802

      target function =                  N/A
              le_mean =     -22.669663879202
             les_mean =     514.426744872811
             stat err =       0.000278349445
             autocorr =       1.246997460396
              std dev =       0.705021837687
             le_variance =       0.497055791616

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.497248102774
                                         uncertainty =       0.001366528410

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.497248102774
                                         uncertainty =       0.001366528410

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000249310949
  error estimate for blocks of size 2^( 2) =       0.000258362948
  error estimate for blocks of size 2^( 3) =       0.000266333156
  error estimate for blocks of size 2^( 4) =       0.000272227261
  error estimate for blocks of size 2^( 5) =       0.000275642182
  error estimate for blocks of size 2^( 6) =       0.000277353370
  error estimate for blocks of size 2^( 7) =       0.000277849175
  error estimate for blocks of size 2^( 8) =       0.000278684800
  error estimate for blocks of size 2^( 9) =       0.000279670584

      target function =                  N/A
              le_mean =     -22.669656096845
             les_mean =     514.428494043691
             stat err =       0.000278389482
             autocorr =       1.246875072576
              std dev =       0.705157850425
             le_variance =       0.497247594017

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.497410529164
                                         uncertainty =       0.001386451101

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.497410529164
                                         uncertainty =       0.001386451101

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000249351664
  error estimate for blocks of size 2^( 2) =       0.000258401106
  error estimate for blocks of size 2^( 3) =       0.000266370288
  error estimate for blocks of size 2^( 4) =       0.000272261198
  error estimate for blocks of size 2^( 5) =       0.000275675060
  error estimate for blocks of size 2^( 6) =       0.000277390950
  error estimate for blocks of size 2^( 7) =       0.000277885521
  error estimate for blocks of size 2^( 8) =       0.000278720621
  error estimate for blocks of size 2^( 9) =       0.000279688408

      target function =                  N/A
              le_mean =     -22.669659655518
             les_mean =     514.443541135747
             stat err =       0.000278421375
             autocorr =       1.246753526705
              std dev =       0.705273010706
             le_variance =       0.497410019630

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.497085162347
                                         uncertainty =       0.001348956520

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.497085162347
                                         uncertainty =       0.001348956520

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000249270111
  error estimate for blocks of size 2^( 2) =       0.000258323542
  error estimate for blocks of size 2^( 3) =       0.000266294775
  error estimate for blocks of size 2^( 4) =       0.000272192411
  error estimate for blocks of size 2^( 5) =       0.000275606636
  error estimate for blocks of size 2^( 6) =       0.000277317935
  error estimate for blocks of size 2^( 7) =       0.000277812756
  error estimate for blocks of size 2^( 8) =       0.000278654319
  error estimate for blocks of size 2^( 9) =       0.000279632221

      target function =                  N/A
              le_mean =     -22.669658686374
             les_mean =     514.427521130851
             stat err =       0.000278354308
             autocorr =       1.246968487519
              std dev =       0.705042343801
             le_variance =       0.497084706553


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.669663879202        initial  <--
     3.8147e-02     3.8147e-01             7.8476e-04       -22.669656096845
     1.5259e-01     1.5259e+00             5.0860e-04       -22.669659655518
     6.1035e-01     6.1035e+00             2.2495e-04       -22.669658686374

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 172.0353
  </log>
  <optVariables href="FORM.s021.opt.xml">
ci_001                -7.064209e-01 3 1  ON 0
ci_002                -7.047858e-01 3 1  ON 1
ci_003                -3.747270e-02 3 1  ON 2
ci_004                -3.758434e-02 3 1  ON 3
ci_005                 1.594600e-02 3 1  ON 4
ci_006                 1.546209e-02 3 1  ON 5
ci_007                 1.219673e-02 3 1  ON 6
ci_008                 1.228754e-02 3 1  ON 7
ci_009                -1.174374e-02 3 1  ON 8
ci_010                -1.173940e-02 3 1  ON 9
ci_011                -8.227008e-03 3 1  ON 10
ci_012                -8.819890e-03 3 1  ON 11
ci_013                 9.474321e-03 3 1  ON 12
ci_014                 9.416692e-03 3 1  ON 13
ci_015                 1.231731e-02 3 1  ON 14
ci_016                 1.241530e-02 3 1  ON 15
ci_017                 1.069793e-02 3 1  ON 16
ci_018                 1.096915e-02 3 1  ON 17
ci_019                -3.595687e-03 3 1  ON 18
ci_020                -3.178407e-03 3 1  ON 19
ci_021                -8.195943e-03 3 1  ON 20
ci_022                -9.021079e-03 3 1  ON 21
ci_023                 8.158481e-03 3 1  ON 22
ci_024                 7.842271e-03 3 1  ON 23
ci_025                 4.265921e-03 3 1  ON 24
ci_026                 4.887672e-03 3 1  ON 25
ci_027                 6.487943e-03 3 1  ON 26
ci_028                 6.493941e-03 3 1  ON 27
ci_029                -4.805421e-03 3 1  ON 28
ci_030                -5.112484e-03 3 1  ON 29
ci_031                -8.568846e-03 3 1  ON 30
ci_032                -7.839919e-03 3 1  ON 31
ci_033                 4.828795e-03 3 1  ON 32
ci_034                 4.301114e-03 3 1  ON 33
ci_035                 7.573715e-04 3 1  ON 34
ci_036                 1.170163e-03 3 1  ON 35
ci_037                 5.049447e-03 3 1  ON 36
ci_038                 4.569406e-03 3 1  ON 37
ci_039                 5.523950e-03 3 1  ON 38
ci_040                 5.437393e-03 3 1  ON 39
ci_041                 4.868625e-03 3 1  ON 40
ci_042                 5.540192e-03 3 1  ON 41
ci_043                 4.999530e-03 3 1  ON 42
ci_044                 4.947221e-03 3 1  ON 43
ci_045                 2.784617e-03 3 1  ON 44
ci_046                 3.198348e-03 3 1  ON 45
ci_047                -7.516687e-04 3 1  ON 46
ci_048                -8.269786e-04 3 1  ON 47
ci_049                 2.003509e-03 3 1  ON 48
ci_050                 1.921145e-03 3 1  ON 49
ci_051                -1.032600e-03 3 1  ON 50
ci_052                -1.108064e-03 3 1  ON 51
ci_053                -2.948168e-03 3 1  ON 52
ci_054                -2.476351e-03 3 1  ON 53
ci_055                -1.167023e-03 3 1  ON 54
ci_056                -9.429973e-04 3 1  ON 55
ci_057                -1.583164e-03 3 1  ON 56
ci_058                -1.591769e-03 3 1  ON 57
ci_059                 2.665445e-05 3 1  ON 58
ci_060                 1.278758e-04 3 1  ON 59
ci_061                -2.427418e-04 3 1  ON 60
ci_062                 3.426439e-04 3 1  ON 61
ci_063                -1.066666e-03 3 1  ON 62
ci_064                -6.553101e-04 3 1  ON 63
ci_065                -2.536372e-03 3 1  ON 64
ci_066                -2.189620e-03 3 1  ON 65
ci_067                -3.058306e-03 3 1  ON 66
ci_068                -2.089813e-03 3 1  ON 67
ci_069                -1.090513e-04 3 1  ON 68
ci_070                -3.693195e-04 3 1  ON 69
ci_071                -2.187803e-03 3 1  ON 70
ci_072                -2.389005e-03 3 1  ON 71
ci_073                 5.552132e-04 3 1  ON 72
ci_074                 2.549640e-04 3 1  ON 73
ci_075                -6.134930e-04 3 1  ON 74
ci_076                -2.765324e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 2.9112e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s022 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s022 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=22  my_counter=0
  time step      = 5.0000e-02
  blocks         = 250
  steps          = 250
  substeps       = 10
  current        = 0
  target samples = 8.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">250</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">6.2500e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">8.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">6.2500e+04</parameter>
<parameter name="steps" condition="int">250</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2676e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="250">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =8000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 22
    time step          = 0.05
    reference energy   = -22.6843
    reference variance = 0.409553
====================================================
  Execution time = 9.9155e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s022
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 62500 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 6.1061e+04
  VMC Eavg = -2.2670e+01
  VMC Evar = 5.1261e-01
  Total weights = 7.820353847e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.8763e+01
  </log>
</opt>
<opt stage="main" walkers="62500">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.500149421252
                                         uncertainty =       0.002458464409

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.500149421252
                                         uncertainty =       0.002458464409

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000250035792
  error estimate for blocks of size 2^( 2) =       0.000259079064
  error estimate for blocks of size 2^( 3) =       0.000266972922
  error estimate for blocks of size 2^( 4) =       0.000272754455
  error estimate for blocks of size 2^( 5) =       0.000276236140
  error estimate for blocks of size 2^( 6) =       0.000277957771
  error estimate for blocks of size 2^( 7) =       0.000278559056
  error estimate for blocks of size 2^( 8) =       0.000278863507
  error estimate for blocks of size 2^( 9) =       0.000278965580

      target function =                  N/A
              le_mean =     -22.669539993302
             les_mean =     514.420657199582
             stat err =       0.000278586478
             autocorr =       1.241411334082
              std dev =       0.707208014963
             le_variance =       0.500143176428


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266953999330e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.8147e-01, overlap shift 3.8147e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.669539993327       residual = 4.28e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.669543675154       residual = 7.17e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.669543511362       residual = 2.35e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.669543534341       residual = 8.60e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 3.8147e-01 is 4.325885e-04

solving harmonic davidson linear method for identity shift 1.5259e+00, overlap shift 1.5259e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.669539993327       residual = 4.28e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.669541209302       residual = 4.30e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.669541175515       residual = 1.22e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.669541183721       residual = 4.45e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 1.5259e+00 is 1.598025e-04

solving harmonic davidson linear method for identity shift 6.1035e+00, overlap shift 6.1035e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.669539993327       residual = 4.28e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.669540323850       residual = 4.56e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.669540318478       residual = 1.13e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.669540319870       residual = 4.76e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 6.1035e+00 is 4.531692e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.294308 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.1794e+02
  </log>
  <optVariables href="FORM.s022.opt.xml">
ci_001                -7.064320e-01 3 1  ON 0
ci_002                -7.047740e-01 3 1  ON 1
ci_003                -3.746393e-02 3 1  ON 2
ci_004                -3.760607e-02 3 1  ON 3
ci_005                 1.592082e-02 3 1  ON 4
ci_006                 1.546650e-02 3 1  ON 5
ci_007                 1.220248e-02 3 1  ON 6
ci_008                 1.229800e-02 3 1  ON 7
ci_009                -1.171572e-02 3 1  ON 8
ci_010                -1.174830e-02 3 1  ON 9
ci_011                -8.235254e-03 3 1  ON 10
ci_012                -8.763800e-03 3 1  ON 11
ci_013                 9.511333e-03 3 1  ON 12
ci_014                 9.348529e-03 3 1  ON 13
ci_015                 1.234803e-02 3 1  ON 14
ci_016                 1.247420e-02 3 1  ON 15
ci_017                 1.075601e-02 3 1  ON 16
ci_018                 1.093823e-02 3 1  ON 17
ci_019                -3.592546e-03 3 1  ON 18
ci_020                -3.224078e-03 3 1  ON 19
ci_021                -8.231716e-03 3 1  ON 20
ci_022                -9.056676e-03 3 1  ON 21
ci_023                 8.115485e-03 3 1  ON 22
ci_024                 7.853199e-03 3 1  ON 23
ci_025                 4.241079e-03 3 1  ON 24
ci_026                 4.870131e-03 3 1  ON 25
ci_027                 6.460285e-03 3 1  ON 26
ci_028                 6.533618e-03 3 1  ON 27
ci_029                -4.865703e-03 3 1  ON 28
ci_030                -5.137916e-03 3 1  ON 29
ci_031                -8.500645e-03 3 1  ON 30
ci_032                -7.833766e-03 3 1  ON 31
ci_033                 4.809763e-03 3 1  ON 32
ci_034                 4.301397e-03 3 1  ON 33
ci_035                 9.171740e-04 3 1  ON 34
ci_036                 1.151880e-03 3 1  ON 35
ci_037                 5.072434e-03 3 1  ON 36
ci_038                 4.659348e-03 3 1  ON 37
ci_039                 5.465425e-03 3 1  ON 38
ci_040                 5.442190e-03 3 1  ON 39
ci_041                 4.929482e-03 3 1  ON 40
ci_042                 5.508168e-03 3 1  ON 41
ci_043                 5.003351e-03 3 1  ON 42
ci_044                 4.923184e-03 3 1  ON 43
ci_045                 2.795495e-03 3 1  ON 44
ci_046                 3.155687e-03 3 1  ON 45
ci_047                -7.856281e-04 3 1  ON 46
ci_048                -7.730833e-04 3 1  ON 47
ci_049                 1.979857e-03 3 1  ON 48
ci_050                 1.830075e-03 3 1  ON 49
ci_051                -1.029953e-03 3 1  ON 50
ci_052                -1.100551e-03 3 1  ON 51
ci_053                -2.934922e-03 3 1  ON 52
ci_054                -2.503088e-03 3 1  ON 53
ci_055                -1.193285e-03 3 1  ON 54
ci_056                -9.849083e-04 3 1  ON 55
ci_057                -1.612659e-03 3 1  ON 56
ci_058                -1.621218e-03 3 1  ON 57
ci_059                -3.122194e-06 3 1  ON 58
ci_060                 1.148598e-04 3 1  ON 59
ci_061                -2.993918e-04 3 1  ON 60
ci_062                 3.601070e-04 3 1  ON 61
ci_063                -9.820359e-04 3 1  ON 62
ci_064                -6.239461e-04 3 1  ON 63
ci_065                -2.429982e-03 3 1  ON 64
ci_066                -2.223798e-03 3 1  ON 65
ci_067                -2.927449e-03 3 1  ON 66
ci_068                -2.164823e-03 3 1  ON 67
ci_069                -7.308654e-05 3 1  ON 68
ci_070                -3.813998e-04 3 1  ON 69
ci_071                -2.217470e-03 3 1  ON 70
ci_072                -2.363559e-03 3 1  ON 71
ci_073                 5.535056e-04 3 1  ON 72
ci_074                 2.040271e-04 3 1  ON 73
ci_075                -6.122426e-04 3 1  ON 74
ci_076                -3.259554e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="250">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =8000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 22
    time step          = 0.05
    reference energy   = -22.6441
    reference variance = 0.346252
====================================================
  Execution time = 1.0157e+02
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s022
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 62500 
  VMC Eavg = -2.2670e+01
  VMC Evar = 5.1564e-01
  Total weights = 7.8208e+06
  Execution time = 1.4387e+01
  </log>
</opt>
<opt stage="main" walkers="62500">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

ERROR CostFunction-> Number of Effective Walkers is too small! 
  Number of effective walkers (samples) / total number of samples = 0.00411452
  User specified threshold minwalkers = 0.3
  If this message appears frequently. You might have to be cautious. 
  Find info about parameter "minwalkers" in the user manual!
Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.500923197007
                                         uncertainty =       0.002598437337

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.500923197007
                                         uncertainty =       0.002598437337

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000250230374
  error estimate for blocks of size 2^( 2) =       0.000259190706
  error estimate for blocks of size 2^( 3) =       0.000267289546
  error estimate for blocks of size 2^( 4) =       0.000273040088
  error estimate for blocks of size 2^( 5) =       0.000276144551
  error estimate for blocks of size 2^( 6) =       0.000277406516
  error estimate for blocks of size 2^( 7) =       0.000278491352
  error estimate for blocks of size 2^( 8) =       0.000278381896
  error estimate for blocks of size 2^( 9) =       0.000279906523

      target function =                  N/A
              le_mean =     -22.669662877553
             les_mean =     515.731577803877
             stat err =       0.000278546572
             autocorr =       1.239126329322
              std dev =       0.707758377328
             le_variance =       0.500921920678

ERROR CostFunction-> Number of Effective Walkers is too small! 
  Number of effective walkers (samples) / total number of samples = 0.000253979
  User specified threshold minwalkers = 0.3
  If this message appears frequently. You might have to be cautious. 
  Find info about parameter "minwalkers" in the user manual!
Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.500694401136
                                         uncertainty =       0.002434356983

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.500694401136
                                         uncertainty =       0.002434356983

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000250173273
  error estimate for blocks of size 2^( 2) =       0.000259135557
  error estimate for blocks of size 2^( 3) =       0.000267236596
  error estimate for blocks of size 2^( 4) =       0.000272989204
  error estimate for blocks of size 2^( 5) =       0.000276087938
  error estimate for blocks of size 2^( 6) =       0.000277352148
  error estimate for blocks of size 2^( 7) =       0.000278432903
  error estimate for blocks of size 2^( 8) =       0.000278318010
  error estimate for blocks of size 2^( 9) =       0.000279847480

      target function =                  N/A
              le_mean =     -22.669664003708
             les_mean =     514.430832224932
             stat err =       0.000278487635
             autocorr =       1.239167493610
              std dev =       0.707596871839
             le_variance =       0.500693333036

ERROR CostFunction-> Number of Effective Walkers is too small! 
  Number of effective walkers (samples) / total number of samples = 0.00415712
  User specified threshold minwalkers = 0.3
  If this message appears frequently. You might have to be cautious. 
  Find info about parameter "minwalkers" in the user manual!
Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.500797817927
                                         uncertainty =       0.002526351629

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.500797817927
                                         uncertainty =       0.002526351629

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000250199076
  error estimate for blocks of size 2^( 2) =       0.000259160207
  error estimate for blocks of size 2^( 3) =       0.000267260114
  error estimate for blocks of size 2^( 4) =       0.000273011770
  error estimate for blocks of size 2^( 5) =       0.000276110564
  error estimate for blocks of size 2^( 6) =       0.000277374294
  error estimate for blocks of size 2^( 7) =       0.000278457449
  error estimate for blocks of size 2^( 8) =       0.000278343210
  error estimate for blocks of size 2^( 9) =       0.000279869289

      target function =                  N/A
              le_mean =     -22.669662266091
             les_mean =     514.429843516705
             stat err =       0.000278511060
             autocorr =       1.239120353178
              std dev =       0.707669853157
             le_variance =       0.500796621068

ERROR CostFunction-> Number of Effective Walkers is too small! 
  Number of effective walkers (samples) / total number of samples = 0.0132643
  User specified threshold minwalkers = 0.3
  If this message appears frequently. You might have to be cautious. 
  Find info about parameter "minwalkers" in the user manual!
Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.500880185369
                                         uncertainty =       0.002591994492

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.500880185369
                                         uncertainty =       0.002591994492

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000250219627
  error estimate for blocks of size 2^( 2) =       0.000259179770
  error estimate for blocks of size 2^( 3) =       0.000267278349
  error estimate for blocks of size 2^( 4) =       0.000273029224
  error estimate for blocks of size 2^( 5) =       0.000276128458
  error estimate for blocks of size 2^( 6) =       0.000277391942
  error estimate for blocks of size 2^( 7) =       0.000278478190
  error estimate for blocks of size 2^( 8) =       0.000278365303
  error estimate for blocks of size 2^( 9) =       0.000279890720

      target function =                  N/A
              le_mean =     -22.669661010227
             les_mean =     514.429357547264
             stat err =       0.000278531539
             autocorr =       1.239099015309
              std dev =       0.707727980487
             le_variance =       0.500878894364


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.669662877553        initial
     3.8147e-01     3.8147e+00             4.3259e-04       -22.669664003708  <--
     1.5259e+00     1.5259e+01             1.5980e-04       -22.669662266091
     6.1035e+00     6.1035e+01             4.5317e-05       -22.669661010227

*****************************************************************************
Applying the update for shift_i =   3.8147e-01     and shift_s =   3.8147e+00
*****************************************************************************

  Execution time = 1.7584e+02
  </log>
  <optVariables href="FORM.s022.opt.xml">
ci_001                -7.064638e-01 3 1  ON 0
ci_002                -7.047388e-01 3 1  ON 1
ci_003                -3.745097e-02 3 1  ON 2
ci_004                -3.766578e-02 3 1  ON 3
ci_005                 1.587669e-02 3 1  ON 4
ci_006                 1.547271e-02 3 1  ON 5
ci_007                 1.222094e-02 3 1  ON 6
ci_008                 1.231564e-02 3 1  ON 7
ci_009                -1.166083e-02 3 1  ON 8
ci_010                -1.176791e-02 3 1  ON 9
ci_011                -8.260311e-03 3 1  ON 10
ci_012                -8.635860e-03 3 1  ON 11
ci_013                 9.607367e-03 3 1  ON 12
ci_014                 9.207654e-03 3 1  ON 13
ci_015                 1.241976e-02 3 1  ON 14
ci_016                 1.260539e-02 3 1  ON 15
ci_017                 1.087918e-02 3 1  ON 16
ci_018                 1.087108e-02 3 1  ON 17
ci_019                -3.581887e-03 3 1  ON 18
ci_020                -3.325424e-03 3 1  ON 19
ci_021                -8.321575e-03 3 1  ON 20
ci_022                -9.132984e-03 3 1  ON 21
ci_023                 8.030716e-03 3 1  ON 22
ci_024                 7.873880e-03 3 1  ON 23
ci_025                 4.179836e-03 3 1  ON 24
ci_026                 4.836036e-03 3 1  ON 25
ci_027                 6.412790e-03 3 1  ON 26
ci_028                 6.602279e-03 3 1  ON 27
ci_029                -5.003784e-03 3 1  ON 28
ci_030                -5.190925e-03 3 1  ON 29
ci_031                -8.341235e-03 3 1  ON 30
ci_032                -7.814329e-03 3 1  ON 31
ci_033                 4.766680e-03 3 1  ON 32
ci_034                 4.306200e-03 3 1  ON 33
ci_035                 1.189960e-03 3 1  ON 34
ci_036                 1.121728e-03 3 1  ON 35
ci_037                 5.124297e-03 3 1  ON 36
ci_038                 4.843789e-03 3 1  ON 37
ci_039                 5.362700e-03 3 1  ON 38
ci_040                 5.449543e-03 3 1  ON 39
ci_041                 5.049057e-03 3 1  ON 40
ci_042                 5.445235e-03 3 1  ON 41
ci_043                 5.015598e-03 3 1  ON 42
ci_044                 4.865721e-03 3 1  ON 43
ci_045                 2.818314e-03 3 1  ON 44
ci_046                 3.064690e-03 3 1  ON 45
ci_047                -8.389083e-04 3 1  ON 46
ci_048                -6.812176e-04 3 1  ON 47
ci_049                 1.929123e-03 3 1  ON 48
ci_050                 1.637195e-03 3 1  ON 49
ci_051                -1.021935e-03 3 1  ON 50
ci_052                -1.084550e-03 3 1  ON 51
ci_053                -2.909364e-03 3 1  ON 52
ci_054                -2.566730e-03 3 1  ON 53
ci_055                -1.264554e-03 3 1  ON 54
ci_056                -1.066421e-03 3 1  ON 55
ci_057                -1.672280e-03 3 1  ON 56
ci_058                -1.678747e-03 3 1  ON 57
ci_059                -5.508184e-05 3 1  ON 58
ci_060                 9.430263e-05 3 1  ON 59
ci_061                -4.147232e-04 3 1  ON 60
ci_062                 4.020378e-04 3 1  ON 61
ci_063                -7.949307e-04 3 1  ON 62
ci_064                -5.597653e-04 3 1  ON 63
ci_065                -2.202350e-03 3 1  ON 64
ci_066                -2.290315e-03 3 1  ON 65
ci_067                -2.643803e-03 3 1  ON 66
ci_068                -2.320979e-03 3 1  ON 67
ci_069                -2.742576e-06 3 1  ON 68
ci_070                -4.030684e-04 3 1  ON 69
ci_071                -2.280839e-03 3 1  ON 70
ci_072                -2.310982e-03 3 1  ON 71
ci_073                 5.509526e-04 3 1  ON 72
ci_074                 1.142630e-04 3 1  ON 73
ci_075                -6.104267e-04 3 1  ON 74
ci_076                -4.266187e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 2.9378e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s023 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s023 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=23  my_counter=0
  time step      = 5.0000e-02
  blocks         = 250
  steps          = 250
  substeps       = 10
  current        = 0
  target samples = 8.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">250</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">6.2500e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">8.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">6.2500e+04</parameter>
<parameter name="steps" condition="int">250</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2676e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="250">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =8000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 23
    time step          = 0.05
    reference energy   = -22.7163
    reference variance = 0.722553
====================================================
  Execution time = 9.9500e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s023
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 62500 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 6.1103e+04
  VMC Eavg = -2.2670e+01
  VMC Evar = 5.1054e-01
  Total weights = 7.820368371e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.8851e+01
  </log>
</opt>
<opt stage="main" walkers="62500">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.497407129174
                                         uncertainty =       0.001262177442

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.497407129174
                                         uncertainty =       0.001262177442

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000249351273
  error estimate for blocks of size 2^( 2) =       0.000258287518
  error estimate for blocks of size 2^( 3) =       0.000266275660
  error estimate for blocks of size 2^( 4) =       0.000271783993
  error estimate for blocks of size 2^( 5) =       0.000275012043
  error estimate for blocks of size 2^( 6) =       0.000276944587
  error estimate for blocks of size 2^( 7) =       0.000277649511
  error estimate for blocks of size 2^( 8) =       0.000277858845
  error estimate for blocks of size 2^( 9) =       0.000278104833

      target function =                  N/A
              le_mean =     -22.669565003784
             les_mean =     514.419716735322
             stat err =       0.000277639444
             autocorr =       1.239764377242
              std dev =       0.705271903367
             le_variance =       0.497408457679


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266956500378e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.5367e-02, overlap shift 9.5367e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.669565003809       residual = 3.39e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.669569634185       residual = 8.50e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.669569806100       residual = 4.80e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.669569812595       residual = 4.49e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 9.5367e-02 is 9.918946e-04

solving harmonic davidson linear method for identity shift 3.8147e-01, overlap shift 3.8147e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.669565003809       residual = 3.39e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.669567207619       residual = 3.55e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.669567231213       residual = 1.07e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.669567235778       residual = 5.83e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 3.8147e-01 is 4.638043e-04

solving harmonic davidson linear method for identity shift 1.5259e+00, overlap shift 1.5259e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.669565003809       residual = 3.39e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.669565715584       residual = 2.83e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.669565716255       residual = 7.65e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 1.5259e+00 is 1.491710e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.298643 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.1837e+02
  </log>
  <optVariables href="FORM.s023.opt.xml">
ci_001                -7.064403e-01 3 1  ON 0
ci_002                -7.047664e-01 3 1  ON 1
ci_003                -3.758991e-02 3 1  ON 2
ci_004                -3.767790e-02 3 1  ON 3
ci_005                 1.585779e-02 3 1  ON 4
ci_006                 1.549841e-02 3 1  ON 5
ci_007                 1.213499e-02 3 1  ON 6
ci_008                 1.242997e-02 3 1  ON 7
ci_009                -1.176981e-02 3 1  ON 8
ci_010                -1.164636e-02 3 1  ON 9
ci_011                -8.235455e-03 3 1  ON 10
ci_012                -8.390770e-03 3 1  ON 11
ci_013                 9.575817e-03 3 1  ON 12
ci_014                 9.194770e-03 3 1  ON 13
ci_015                 1.240959e-02 3 1  ON 14
ci_016                 1.245645e-02 3 1  ON 15
ci_017                 1.074004e-02 3 1  ON 16
ci_018                 1.091171e-02 3 1  ON 17
ci_019                -3.747070e-03 3 1  ON 18
ci_020                -3.534398e-03 3 1  ON 19
ci_021                -8.368218e-03 3 1  ON 20
ci_022                -9.203734e-03 3 1  ON 21
ci_023                 8.000915e-03 3 1  ON 22
ci_024                 7.869977e-03 3 1  ON 23
ci_025                 4.184032e-03 3 1  ON 24
ci_026                 4.796031e-03 3 1  ON 25
ci_027                 6.399770e-03 3 1  ON 26
ci_028                 6.469210e-03 3 1  ON 27
ci_029                -4.841733e-03 3 1  ON 28
ci_030                -5.045941e-03 3 1  ON 29
ci_031                -8.229172e-03 3 1  ON 30
ci_032                -7.813107e-03 3 1  ON 31
ci_033                 4.709102e-03 3 1  ON 32
ci_034                 4.057089e-03 3 1  ON 33
ci_035                 1.138231e-03 3 1  ON 34
ci_036                 1.166063e-03 3 1  ON 35
ci_037                 5.149153e-03 3 1  ON 36
ci_038                 4.947924e-03 3 1  ON 37
ci_039                 5.394255e-03 3 1  ON 38
ci_040                 5.500515e-03 3 1  ON 39
ci_041                 5.141919e-03 3 1  ON 40
ci_042                 5.317573e-03 3 1  ON 41
ci_043                 5.078030e-03 3 1  ON 42
ci_044                 4.685044e-03 3 1  ON 43
ci_045                 2.873548e-03 3 1  ON 44
ci_046                 2.817805e-03 3 1  ON 45
ci_047                -8.151361e-04 3 1  ON 46
ci_048                -6.092528e-04 3 1  ON 47
ci_049                 1.823215e-03 3 1  ON 48
ci_050                 1.765927e-03 3 1  ON 49
ci_051                -1.079915e-03 3 1  ON 50
ci_052                -1.548354e-03 3 1  ON 51
ci_053                -2.630253e-03 3 1  ON 52
ci_054                -2.754404e-03 3 1  ON 53
ci_055                -1.357542e-03 3 1  ON 54
ci_056                -1.109872e-03 3 1  ON 55
ci_057                -1.671841e-03 3 1  ON 56
ci_058                -1.687297e-03 3 1  ON 57
ci_059                -1.319719e-04 3 1  ON 58
ci_060                 9.294365e-05 3 1  ON 59
ci_061                -2.180139e-04 3 1  ON 60
ci_062                 2.453993e-04 3 1  ON 61
ci_063                -9.061137e-04 3 1  ON 62
ci_064                -7.129674e-04 3 1  ON 63
ci_065                -2.084665e-03 3 1  ON 64
ci_066                -2.240764e-03 3 1  ON 65
ci_067                -2.705151e-03 3 1  ON 66
ci_068                -2.133298e-03 3 1  ON 67
ci_069                 2.613162e-04 3 1  ON 68
ci_070                -2.867613e-04 3 1  ON 69
ci_071                -2.399655e-03 3 1  ON 70
ci_072                -2.498388e-03 3 1  ON 71
ci_073                 4.898420e-04 3 1  ON 72
ci_074                 6.966743e-05 3 1  ON 73
ci_075                -4.808824e-04 3 1  ON 74
ci_076                -3.688654e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="250">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =8000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 23
    time step          = 0.05
    reference energy   = -22.6074
    reference variance = 0.439529
====================================================
  Execution time = 1.0116e+02
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s023
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 62500 
  VMC Eavg = -2.2670e+01
  VMC Evar = 5.1161e-01
  Total weights = 7.8206e+06
  Execution time = 1.4415e+01
  </log>
</opt>
<opt stage="main" walkers="62500">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.499209422809
                                         uncertainty =       0.001529490081

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.499209422809
                                         uncertainty =       0.001529490081

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000249803056
  error estimate for blocks of size 2^( 2) =       0.000258800854
  error estimate for blocks of size 2^( 3) =       0.000266713662
  error estimate for blocks of size 2^( 4) =       0.000272444194
  error estimate for blocks of size 2^( 5) =       0.000275656573
  error estimate for blocks of size 2^( 6) =       0.000277609733
  error estimate for blocks of size 2^( 7) =       0.000278561427
  error estimate for blocks of size 2^( 8) =       0.000278760349
  error estimate for blocks of size 2^( 9) =       0.000280820848

      target function =                  N/A
              le_mean =     -22.669778866638
             les_mean =     514.431187434598
             stat err =       0.000278938089
             autocorr =       1.246867055497
              std dev =       0.706549738663
             le_variance =       0.499212533205

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.499171108254
                                         uncertainty =       0.001511454924

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.499171108254
                                         uncertainty =       0.001511454924

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000249793411
  error estimate for blocks of size 2^( 2) =       0.000258794830
  error estimate for blocks of size 2^( 3) =       0.000266709115
  error estimate for blocks of size 2^( 4) =       0.000272443241
  error estimate for blocks of size 2^( 5) =       0.000275658042
  error estimate for blocks of size 2^( 6) =       0.000277608025
  error estimate for blocks of size 2^( 7) =       0.000278570674
  error estimate for blocks of size 2^( 8) =       0.000278765462
  error estimate for blocks of size 2^( 9) =       0.000280851165

      target function =                  N/A
              le_mean =     -22.669782763433
             les_mean =     514.483312104344
             stat err =       0.000278948832
             autocorr =       1.247059387712
              std dev =       0.706522459978
             le_variance =       0.499173986453

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.499097532722
                                         uncertainty =       0.001520716876

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.499097532722
                                         uncertainty =       0.001520716876

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000249775045
  error estimate for blocks of size 2^( 2) =       0.000258776516
  error estimate for blocks of size 2^( 3) =       0.000266691703
  error estimate for blocks of size 2^( 4) =       0.000272424503
  error estimate for blocks of size 2^( 5) =       0.000275634304
  error estimate for blocks of size 2^( 6) =       0.000277587636
  error estimate for blocks of size 2^( 7) =       0.000278545986
  error estimate for blocks of size 2^( 8) =       0.000278743439
  error estimate for blocks of size 2^( 9) =       0.000280814623

      target function =                  N/A
              le_mean =     -22.669780008206
             les_mean =     514.453042900300
             stat err =       0.000278922921
             autocorr =       1.247011090048
              std dev =       0.706470513264
             le_variance =       0.499100586112

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.499184109164
                                         uncertainty =       0.001528198170

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.499184109164
                                         uncertainty =       0.001528198170

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000249796720
  error estimate for blocks of size 2^( 2) =       0.000258795022
  error estimate for blocks of size 2^( 3) =       0.000266708087
  error estimate for blocks of size 2^( 4) =       0.000272439145
  error estimate for blocks of size 2^( 5) =       0.000275650854
  error estimate for blocks of size 2^( 6) =       0.000277604237
  error estimate for blocks of size 2^( 7) =       0.000278557340
  error estimate for blocks of size 2^( 8) =       0.000278755097
  error estimate for blocks of size 2^( 9) =       0.000280816811

      target function =                  N/A
              le_mean =     -22.669777195254
             les_mean =     514.459246360905
             stat err =       0.000278933371
             autocorr =       1.246888127403
              std dev =       0.706531817668
             le_variance =       0.499187209377


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.669778866638        initial
     9.5367e-02     9.5367e-01             9.9189e-04       -22.669782763433  <--
     3.8147e-01     3.8147e+00             4.6380e-04       -22.669780008206
     1.5259e+00     1.5259e+01             1.4917e-04       -22.669777195254

*****************************************************************************
Applying the update for shift_i =   9.5367e-02     and shift_s =   9.5367e-01
*****************************************************************************

  Execution time = 1.7403e+02
  </log>
  <optVariables href="FORM.s023.opt.xml">
ci_001                -7.063896e-01 3 1  ON 0
ci_002                -7.048152e-01 3 1  ON 1
ci_003                -3.783091e-02 3 1  ON 2
ci_004                -3.772071e-02 3 1  ON 3
ci_005                 1.583387e-02 3 1  ON 4
ci_006                 1.551869e-02 3 1  ON 5
ci_007                 1.204413e-02 3 1  ON 6
ci_008                 1.262943e-02 3 1  ON 7
ci_009                -1.186767e-02 3 1  ON 8
ci_010                -1.148489e-02 3 1  ON 9
ci_011                -8.234249e-03 3 1  ON 10
ci_012                -8.052420e-03 3 1  ON 11
ci_013                 9.524724e-03 3 1  ON 12
ci_014                 9.175810e-03 3 1  ON 13
ci_015                 1.238675e-02 3 1  ON 14
ci_016                 1.226300e-02 3 1  ON 15
ci_017                 1.058143e-02 3 1  ON 16
ci_018                 1.098253e-02 3 1  ON 17
ci_019                -3.971933e-03 3 1  ON 18
ci_020                -3.808105e-03 3 1  ON 19
ci_021                -8.430400e-03 3 1  ON 20
ci_022                -9.296161e-03 3 1  ON 21
ci_023                 7.969143e-03 3 1  ON 22
ci_024                 7.868199e-03 3 1  ON 23
ci_025                 4.215093e-03 3 1  ON 24
ci_026                 4.778462e-03 3 1  ON 25
ci_027                 6.385699e-03 3 1  ON 26
ci_028                 6.362042e-03 3 1  ON 27
ci_029                -4.679083e-03 3 1  ON 28
ci_030                -4.869163e-03 3 1  ON 29
ci_031                -8.084767e-03 3 1  ON 30
ci_032                -7.805537e-03 3 1  ON 31
ci_033                 4.634891e-03 3 1  ON 32
ci_034                 3.798191e-03 3 1  ON 33
ci_035                 1.098119e-03 3 1  ON 34
ci_036                 1.202102e-03 3 1  ON 35
ci_037                 5.177151e-03 3 1  ON 36
ci_038                 5.063656e-03 3 1  ON 37
ci_039                 5.418928e-03 3 1  ON 38
ci_040                 5.542909e-03 3 1  ON 39
ci_041                 5.230393e-03 3 1  ON 40
ci_042                 5.196652e-03 3 1  ON 41
ci_043                 5.139213e-03 3 1  ON 42
ci_044                 4.455048e-03 3 1  ON 43
ci_045                 2.960016e-03 3 1  ON 44
ci_046                 2.568736e-03 3 1  ON 45
ci_047                -7.971509e-04 3 1  ON 46
ci_048                -5.546516e-04 3 1  ON 47
ci_049                 1.701016e-03 3 1  ON 48
ci_050                 1.914881e-03 3 1  ON 49
ci_051                -1.126656e-03 3 1  ON 50
ci_052                -2.076444e-03 3 1  ON 51
ci_053                -2.310406e-03 3 1  ON 52
ci_054                -2.999830e-03 3 1  ON 53
ci_055                -1.457519e-03 3 1  ON 54
ci_056                -1.209617e-03 3 1  ON 55
ci_057                -1.668982e-03 3 1  ON 56
ci_058                -1.695149e-03 3 1  ON 57
ci_059                -1.949736e-04 3 1  ON 58
ci_060                 9.590043e-05 3 1  ON 59
ci_061                 9.461352e-06 3 1  ON 60
ci_062                 8.383974e-05 3 1  ON 61
ci_063                -1.048367e-03 3 1  ON 62
ci_064                -8.993256e-04 3 1  ON 63
ci_065                -1.984633e-03 3 1  ON 64
ci_066                -2.195885e-03 3 1  ON 65
ci_067                -2.773772e-03 3 1  ON 66
ci_068                -1.918693e-03 3 1  ON 67
ci_069                 5.235929e-04 3 1  ON 68
ci_070                -1.659129e-04 3 1  ON 69
ci_071                -2.523845e-03 3 1  ON 70
ci_072                -2.662093e-03 3 1  ON 71
ci_073                 4.472950e-04 3 1  ON 72
ci_074                 3.512965e-05 3 1  ON 73
ci_075                -3.535107e-04 3 1  ON 74
ci_076                -3.102004e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 2.9242e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s024 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s024 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=24  my_counter=0
  time step      = 5.0000e-02
  blocks         = 250
  steps          = 250
  substeps       = 10
  current        = 0
  target samples = 8.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">250</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">6.2500e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">8.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">6.2500e+04</parameter>
<parameter name="steps" condition="int">250</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2675e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="250">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =8000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 24
    time step          = 0.05
    reference energy   = -22.6366
    reference variance = 0.35313
====================================================
  Execution time = 9.9536e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s024
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 62500 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 6.1098e+04
  VMC Eavg = -2.2669e+01
  VMC Evar = 5.2657e-01
  Total weights = 7.821150277e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.8774e+01
  </log>
</opt>
<opt stage="main" walkers="62500">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.509413686156
                                         uncertainty =       0.008848121662

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.509413686156
                                         uncertainty =       0.008848121662

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000252345510
  error estimate for blocks of size 2^( 2) =       0.000261192584
  error estimate for blocks of size 2^( 3) =       0.000269082494
  error estimate for blocks of size 2^( 4) =       0.000274819774
  error estimate for blocks of size 2^( 5) =       0.000278052967
  error estimate for blocks of size 2^( 6) =       0.000279769867
  error estimate for blocks of size 2^( 7) =       0.000280717481
  error estimate for blocks of size 2^( 8) =       0.000280781023
  error estimate for blocks of size 2^( 9) =       0.000282230369

      target function =                  N/A
              le_mean =     -22.669216318255
             les_mean =     514.419940451256
             stat err =       0.000280874685
             autocorr =       1.238893669179
              std dev =       0.713740885216
             le_variance =       0.509426051228


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266921631825e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3842e-02, overlap shift 2.3842e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.669216318275       residual = 2.23e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.669225178381       residual = 1.68e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.669227281224       residual = 2.77e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.669226404008       residual = 4.95e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.669226080595       residual = 4.36e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.669226084624       residual = 3.35e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          5 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 2.3842e-02 is 4.655035e-03

solving harmonic davidson linear method for identity shift 9.5367e-02, overlap shift 9.5367e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.669216318275       residual = 2.23e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.669222664489       residual = 8.30e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.669223903664       residual = 6.07e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.669223698907       residual = 4.62e-08           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.669223637653       residual = 2.08e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          4 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 9.5367e-02 is 2.294029e-03

solving harmonic davidson linear method for identity shift 3.8147e-01, overlap shift 3.8147e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.669216318275       residual = 2.23e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.669219290840       residual = 2.07e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.669219818438       residual = 4.07e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.669219830814       residual = 1.53e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 3.8147e-01 is 9.091403e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.300326 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.1833e+02
  </log>
  <optVariables href="FORM.s024.opt.xml">
ci_001                -7.064676e-01 3 1  ON 0
ci_002                -7.047673e-01 3 1  ON 1
ci_003                -3.553688e-02 3 1  ON 2
ci_004                -3.879616e-02 3 1  ON 3
ci_005                 1.456795e-02 3 1  ON 4
ci_006                 1.569017e-02 3 1  ON 5
ci_007                 1.392177e-02 3 1  ON 6
ci_008                 1.243787e-02 3 1  ON 7
ci_009                -1.189771e-02 3 1  ON 8
ci_010                -1.049760e-02 3 1  ON 9
ci_011                -9.172630e-03 3 1  ON 10
ci_012                -8.124428e-03 3 1  ON 11
ci_013                 9.838845e-03 3 1  ON 12
ci_014                 9.424672e-03 3 1  ON 13
ci_015                 1.453335e-02 3 1  ON 14
ci_016                 1.269217e-02 3 1  ON 15
ci_017                 1.072985e-02 3 1  ON 16
ci_018                 1.109136e-02 3 1  ON 17
ci_019                -4.205701e-03 3 1  ON 18
ci_020                -3.549027e-03 3 1  ON 19
ci_021                -9.603862e-03 3 1  ON 20
ci_022                -9.273253e-03 3 1  ON 21
ci_023                 7.351343e-03 3 1  ON 22
ci_024                 7.966900e-03 3 1  ON 23
ci_025                 4.265487e-03 3 1  ON 24
ci_026                 5.019434e-03 3 1  ON 25
ci_027                 7.303905e-03 3 1  ON 26
ci_028                 6.643073e-03 3 1  ON 27
ci_029                -4.406026e-03 3 1  ON 28
ci_030                -3.792064e-03 3 1  ON 29
ci_031                -7.577582e-03 3 1  ON 30
ci_032                -7.308310e-03 3 1  ON 31
ci_033                 3.602962e-03 3 1  ON 32
ci_034                 4.016308e-03 3 1  ON 33
ci_035                 1.024236e-03 3 1  ON 34
ci_036                 1.016332e-03 3 1  ON 35
ci_037                 5.206902e-03 3 1  ON 36
ci_038                 4.424204e-03 3 1  ON 37
ci_039                 5.112624e-03 3 1  ON 38
ci_040                 5.799031e-03 3 1  ON 39
ci_041                 5.008602e-03 3 1  ON 40
ci_042                 5.216372e-03 3 1  ON 41
ci_043                 4.777882e-03 3 1  ON 42
ci_044                 4.534260e-03 3 1  ON 43
ci_045                 3.117187e-03 3 1  ON 44
ci_046                 3.072570e-03 3 1  ON 45
ci_047                -8.536102e-04 3 1  ON 46
ci_048                -7.627655e-04 3 1  ON 47
ci_049                 1.813925e-03 3 1  ON 48
ci_050                 1.573291e-03 3 1  ON 49
ci_051                -2.574989e-03 3 1  ON 50
ci_052                -1.342889e-03 3 1  ON 51
ci_053                -2.257117e-03 3 1  ON 52
ci_054                -2.791708e-03 3 1  ON 53
ci_055                -1.667663e-03 3 1  ON 54
ci_056                -6.077531e-04 3 1  ON 55
ci_057                 1.232954e-04 3 1  ON 56
ci_058                -1.693974e-03 3 1  ON 57
ci_059                -1.274288e-04 3 1  ON 58
ci_060                 5.055217e-04 3 1  ON 59
ci_061                 6.118157e-05 3 1  ON 60
ci_062                -2.907328e-04 3 1  ON 61
ci_063                -4.663399e-04 3 1  ON 62
ci_064                -1.330127e-03 3 1  ON 63
ci_065                -2.069994e-03 3 1  ON 64
ci_066                -2.765823e-03 3 1  ON 65
ci_067                -2.833694e-03 3 1  ON 66
ci_068                -2.819768e-03 3 1  ON 67
ci_069                -6.341494e-04 3 1  ON 68
ci_070                -3.043402e-04 3 1  ON 69
ci_071                -1.082414e-03 3 1  ON 70
ci_072                -2.269280e-03 3 1  ON 71
ci_073                 4.736040e-04 3 1  ON 72
ci_074                 2.352612e-04 3 1  ON 73
ci_075                 2.810371e-04 3 1  ON 74
ci_076                -2.763583e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="250">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =8000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 24
    time step          = 0.05
    reference energy   = -22.6649
    reference variance = 1.48833
====================================================
  Execution time = 1.0104e+02
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s024
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 62500 
  VMC Eavg = -2.2669e+01
  VMC Evar = 5.1577e-01
  Total weights = 7.8203e+06
  Execution time = 1.4371e+01
  </log>
</opt>
<opt stage="main" walkers="62500">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

ERROR CostFunction-> Number of Effective Walkers is too small! 
  Number of effective walkers (samples) / total number of samples = 0.000105824
  User specified threshold minwalkers = 0.3
  If this message appears frequently. You might have to be cautious. 
  Find info about parameter "minwalkers" in the user manual!
Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.508854609124
                                         uncertainty =       0.006703676044

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.508854609124
                                         uncertainty =       0.006703676044

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000252200828
  error estimate for blocks of size 2^( 2) =       0.000260989710
  error estimate for blocks of size 2^( 3) =       0.000269014269
  error estimate for blocks of size 2^( 4) =       0.000274528960
  error estimate for blocks of size 2^( 5) =       0.000277671998
  error estimate for blocks of size 2^( 6) =       0.000279123806
  error estimate for blocks of size 2^( 7) =       0.000279972259
  error estimate for blocks of size 2^( 8) =       0.000280371077
  error estimate for blocks of size 2^( 9) =       0.000282066767

      target function =                  N/A
              le_mean =     -22.669289938610
             les_mean =     514.994693346029
             stat err =       0.000280383478
             autocorr =       1.235981075094
              std dev =       0.713331661771
             le_variance =       0.508842059685

ERROR CostFunction-> Number of Effective Walkers is too small! 
  Number of effective walkers (samples) / total number of samples = 0.000403295
  User specified threshold minwalkers = 0.3
  If this message appears frequently. You might have to be cautious. 
  Find info about parameter "minwalkers" in the user manual!
Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.501764159197
                                         uncertainty =       0.001766410270

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.501764159197
                                         uncertainty =       0.001766410270

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000250440674
  error estimate for blocks of size 2^( 2) =       0.000259321488
  error estimate for blocks of size 2^( 3) =       0.000267359695
  error estimate for blocks of size 2^( 4) =       0.000272948798
  error estimate for blocks of size 2^( 5) =       0.000276079416
  error estimate for blocks of size 2^( 6) =       0.000277519190
  error estimate for blocks of size 2^( 7) =       0.000278263525
  error estimate for blocks of size 2^( 8) =       0.000278689532
  error estimate for blocks of size 2^( 9) =       0.000280378148

      target function =                  N/A
              le_mean =     -22.669229769834
             les_mean =     514.543244263291
             stat err =       0.000278712599
             autocorr =       1.238521287745
              std dev =       0.708353194100
             le_variance =       0.501764247591

ERROR CostFunction-> Number of Effective Walkers is too small! 
  Number of effective walkers (samples) / total number of samples = 0.000106089
  User specified threshold minwalkers = 0.3
  If this message appears frequently. You might have to be cautious. 
  Find info about parameter "minwalkers" in the user manual!
Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.502951911095
                                         uncertainty =       0.001955104366

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.502951911095
                                         uncertainty =       0.001955104366

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000250736752
  error estimate for blocks of size 2^( 2) =       0.000259614782
  error estimate for blocks of size 2^( 3) =       0.000267648465
  error estimate for blocks of size 2^( 4) =       0.000273237640
  error estimate for blocks of size 2^( 5) =       0.000276372526
  error estimate for blocks of size 2^( 6) =       0.000277784769
  error estimate for blocks of size 2^( 7) =       0.000278468850
  error estimate for blocks of size 2^( 8) =       0.000278909035
  error estimate for blocks of size 2^( 9) =       0.000280609832

      target function =                  N/A
              le_mean =     -22.669251346981
             les_mean =     514.498614166901
             stat err =       0.000278943121
             autocorr =       1.237642803910
              std dev =       0.709190630485
             le_variance =       0.502951350368

ERROR CostFunction-> Number of Effective Walkers is too small! 
  Number of effective walkers (samples) / total number of samples = 0.000556586
  User specified threshold minwalkers = 0.3
  If this message appears frequently. You might have to be cautious. 
  Find info about parameter "minwalkers" in the user manual!
Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.501681752296
                                         uncertainty =       0.001765489258

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.501681752296
                                         uncertainty =       0.001765489258

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000250420062
  error estimate for blocks of size 2^( 2) =       0.000259288482
  error estimate for blocks of size 2^( 3) =       0.000267319483
  error estimate for blocks of size 2^( 4) =       0.000272904750
  error estimate for blocks of size 2^( 5) =       0.000276033407
  error estimate for blocks of size 2^( 6) =       0.000277468314
  error estimate for blocks of size 2^( 7) =       0.000278253240
  error estimate for blocks of size 2^( 8) =       0.000278670236
  error estimate for blocks of size 2^( 9) =       0.000280338847

      target function =                  N/A
              le_mean =     -22.669227993968
             les_mean =     514.492642864258
             stat err =       0.000278682660
             autocorr =       1.238459063205
              std dev =       0.708294895778
             le_variance =       0.501681659385


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.669289938610        initial  <--
     2.3842e-02     2.3842e-01             4.6550e-03       -22.669229769834
     9.5367e-02     9.5367e-01             2.2940e-03       -22.669251346981
     3.8147e-01     3.8147e+00             9.0914e-04       -22.669227993968

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 173.9734
  </log>
  <optVariables href="FORM.s024.opt.xml">
ci_001                -7.063896e-01 3 1  ON 0
ci_002                -7.048152e-01 3 1  ON 1
ci_003                -3.783091e-02 3 1  ON 2
ci_004                -3.772071e-02 3 1  ON 3
ci_005                 1.583387e-02 3 1  ON 4
ci_006                 1.551869e-02 3 1  ON 5
ci_007                 1.204413e-02 3 1  ON 6
ci_008                 1.262943e-02 3 1  ON 7
ci_009                -1.186767e-02 3 1  ON 8
ci_010                -1.148489e-02 3 1  ON 9
ci_011                -8.234249e-03 3 1  ON 10
ci_012                -8.052420e-03 3 1  ON 11
ci_013                 9.524724e-03 3 1  ON 12
ci_014                 9.175810e-03 3 1  ON 13
ci_015                 1.238675e-02 3 1  ON 14
ci_016                 1.226300e-02 3 1  ON 15
ci_017                 1.058143e-02 3 1  ON 16
ci_018                 1.098253e-02 3 1  ON 17
ci_019                -3.971933e-03 3 1  ON 18
ci_020                -3.808105e-03 3 1  ON 19
ci_021                -8.430400e-03 3 1  ON 20
ci_022                -9.296161e-03 3 1  ON 21
ci_023                 7.969143e-03 3 1  ON 22
ci_024                 7.868199e-03 3 1  ON 23
ci_025                 4.215093e-03 3 1  ON 24
ci_026                 4.778462e-03 3 1  ON 25
ci_027                 6.385699e-03 3 1  ON 26
ci_028                 6.362042e-03 3 1  ON 27
ci_029                -4.679083e-03 3 1  ON 28
ci_030                -4.869163e-03 3 1  ON 29
ci_031                -8.084767e-03 3 1  ON 30
ci_032                -7.805537e-03 3 1  ON 31
ci_033                 4.634891e-03 3 1  ON 32
ci_034                 3.798191e-03 3 1  ON 33
ci_035                 1.098119e-03 3 1  ON 34
ci_036                 1.202102e-03 3 1  ON 35
ci_037                 5.177151e-03 3 1  ON 36
ci_038                 5.063656e-03 3 1  ON 37
ci_039                 5.418928e-03 3 1  ON 38
ci_040                 5.542909e-03 3 1  ON 39
ci_041                 5.230393e-03 3 1  ON 40
ci_042                 5.196652e-03 3 1  ON 41
ci_043                 5.139213e-03 3 1  ON 42
ci_044                 4.455048e-03 3 1  ON 43
ci_045                 2.960016e-03 3 1  ON 44
ci_046                 2.568736e-03 3 1  ON 45
ci_047                -7.971509e-04 3 1  ON 46
ci_048                -5.546516e-04 3 1  ON 47
ci_049                 1.701016e-03 3 1  ON 48
ci_050                 1.914881e-03 3 1  ON 49
ci_051                -1.126656e-03 3 1  ON 50
ci_052                -2.076444e-03 3 1  ON 51
ci_053                -2.310406e-03 3 1  ON 52
ci_054                -2.999830e-03 3 1  ON 53
ci_055                -1.457519e-03 3 1  ON 54
ci_056                -1.209617e-03 3 1  ON 55
ci_057                -1.668982e-03 3 1  ON 56
ci_058                -1.695149e-03 3 1  ON 57
ci_059                -1.949736e-04 3 1  ON 58
ci_060                 9.590043e-05 3 1  ON 59
ci_061                 9.461352e-06 3 1  ON 60
ci_062                 8.383974e-05 3 1  ON 61
ci_063                -1.048367e-03 3 1  ON 62
ci_064                -8.993256e-04 3 1  ON 63
ci_065                -1.984633e-03 3 1  ON 64
ci_066                -2.195885e-03 3 1  ON 65
ci_067                -2.773772e-03 3 1  ON 66
ci_068                -1.918693e-03 3 1  ON 67
ci_069                 5.235929e-04 3 1  ON 68
ci_070                -1.659129e-04 3 1  ON 69
ci_071                -2.523845e-03 3 1  ON 70
ci_072                -2.662093e-03 3 1  ON 71
ci_073                 4.472950e-04 3 1  ON 72
ci_074                 3.512965e-05 3 1  ON 73
ci_075                -3.535107e-04 3 1  ON 74
ci_076                -3.102004e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 2.9231e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s025 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s025 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=25  my_counter=0
  time step      = 5.0000e-02
  blocks         = 250
  steps          = 250
  substeps       = 10
  current        = 0
  target samples = 8.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">250</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">6.2500e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">8.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">6.2500e+04</parameter>
<parameter name="steps" condition="int">250</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2674e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="250">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =8000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 25
    time step          = 0.05
    reference energy   = -22.7905
    reference variance = 1.01524
====================================================
  Execution time = 9.9475e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s025
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 62500 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 6.1078e+04
  VMC Eavg = -2.2670e+01
  VMC Evar = 5.1156e-01
  Total weights = 7.820335675e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.8723e+01
  </log>
</opt>
<opt stage="main" walkers="62500">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.498967653049
                                         uncertainty =       0.001742356034

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.498967653049
                                         uncertainty =       0.001742356034

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000249741362
  error estimate for blocks of size 2^( 2) =       0.000258568416
  error estimate for blocks of size 2^( 3) =       0.000266578485
  error estimate for blocks of size 2^( 4) =       0.000272283848
  error estimate for blocks of size 2^( 5) =       0.000275492878
  error estimate for blocks of size 2^( 6) =       0.000276975190
  error estimate for blocks of size 2^( 7) =       0.000277621202
  error estimate for blocks of size 2^( 8) =       0.000277596158
  error estimate for blocks of size 2^( 9) =       0.000277438737

      target function =                  N/A
              le_mean =     -22.669542567200
             les_mean =     514.419722273438
             stat err =       0.000277407822
             autocorr =       1.233833205154
              std dev =       0.706375241934
             le_variance =       0.498965982418


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266954256720e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3842e-01, overlap shift 2.3842e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.669542567223       residual = 9.11e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.669547202689       residual = 1.55e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.669547712513       residual = 7.75e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.669547640563       residual = 3.82e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 2.3842e-01 is 8.176075e-04

solving harmonic davidson linear method for identity shift 9.5367e-01, overlap shift 9.5367e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.669542567223       residual = 9.11e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.669544233251       residual = 1.22e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.669544484414       residual = 3.70e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.669544450748       residual = 1.17e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 9.5367e-01 is 2.914523e-04

solving harmonic davidson linear method for identity shift 3.8147e+00, overlap shift 3.8147e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.669542567223       residual = 9.11e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.669543034898       residual = 1.33e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.669543114276       residual = 4.40e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.669543103677       residual = 1.27e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 3.8147e+00 is 8.155430e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.304748 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.1822e+02
  </log>
  <optVariables href="FORM.s025.opt.xml">
ci_001                -7.063322e-01 3 1  ON 0
ci_002                -7.048698e-01 3 1  ON 1
ci_003                -3.780215e-02 3 1  ON 2
ci_004                -3.778072e-02 3 1  ON 3
ci_005                 1.583578e-02 3 1  ON 4
ci_006                 1.551778e-02 3 1  ON 5
ci_007                 1.199011e-02 3 1  ON 6
ci_008                 1.257385e-02 3 1  ON 7
ci_009                -1.191435e-02 3 1  ON 8
ci_010                -1.143843e-02 3 1  ON 9
ci_011                -8.277006e-03 3 1  ON 10
ci_012                -8.030763e-03 3 1  ON 11
ci_013                 9.585961e-03 3 1  ON 12
ci_014                 9.223812e-03 3 1  ON 13
ci_015                 1.239146e-02 3 1  ON 14
ci_016                 1.242167e-02 3 1  ON 15
ci_017                 1.066840e-02 3 1  ON 16
ci_018                 1.104867e-02 3 1  ON 17
ci_019                -3.818363e-03 3 1  ON 18
ci_020                -3.775377e-03 3 1  ON 19
ci_021                -8.635894e-03 3 1  ON 20
ci_022                -9.307062e-03 3 1  ON 21
ci_023                 7.795348e-03 3 1  ON 22
ci_024                 7.899094e-03 3 1  ON 23
ci_025                 4.297642e-03 3 1  ON 24
ci_026                 4.625193e-03 3 1  ON 25
ci_027                 6.347736e-03 3 1  ON 26
ci_028                 6.247291e-03 3 1  ON 27
ci_029                -4.682951e-03 3 1  ON 28
ci_030                -4.758994e-03 3 1  ON 29
ci_031                -8.076249e-03 3 1  ON 30
ci_032                -7.832303e-03 3 1  ON 31
ci_033                 4.736726e-03 3 1  ON 32
ci_034                 3.813958e-03 3 1  ON 33
ci_035                 1.171254e-03 3 1  ON 34
ci_036                 1.292281e-03 3 1  ON 35
ci_037                 5.258343e-03 3 1  ON 36
ci_038                 5.045361e-03 3 1  ON 37
ci_039                 5.362853e-03 3 1  ON 38
ci_040                 5.475825e-03 3 1  ON 39
ci_041                 5.190369e-03 3 1  ON 40
ci_042                 5.193055e-03 3 1  ON 41
ci_043                 5.058014e-03 3 1  ON 42
ci_044                 4.620773e-03 3 1  ON 43
ci_045                 2.931377e-03 3 1  ON 44
ci_046                 2.716413e-03 3 1  ON 45
ci_047                -7.581755e-04 3 1  ON 46
ci_048                -5.058472e-04 3 1  ON 47
ci_049                 1.583252e-03 3 1  ON 48
ci_050                 1.623429e-03 3 1  ON 49
ci_051                -1.114221e-03 3 1  ON 50
ci_052                -2.006555e-03 3 1  ON 51
ci_053                -2.261099e-03 3 1  ON 52
ci_054                -2.933795e-03 3 1  ON 53
ci_055                -1.518873e-03 3 1  ON 54
ci_056                -1.283003e-03 3 1  ON 55
ci_057                -1.606161e-03 3 1  ON 56
ci_058                -1.531409e-03 3 1  ON 57
ci_059                -1.008296e-04 3 1  ON 58
ci_060                 1.140490e-04 3 1  ON 59
ci_061                -6.623804e-05 3 1  ON 60
ci_062                -9.293243e-06 3 1  ON 61
ci_063                -1.063724e-03 3 1  ON 62
ci_064                -9.570992e-04 3 1  ON 63
ci_065                -2.021025e-03 3 1  ON 64
ci_066                -2.474941e-03 3 1  ON 65
ci_067                -2.670733e-03 3 1  ON 66
ci_068                -1.927259e-03 3 1  ON 67
ci_069                 4.353338e-04 3 1  ON 68
ci_070                -3.344852e-04 3 1  ON 69
ci_071                -2.581922e-03 3 1  ON 70
ci_072                -2.418671e-03 3 1  ON 71
ci_073                 4.131017e-04 3 1  ON 72
ci_074                -1.374838e-04 3 1  ON 73
ci_075                -3.628047e-04 3 1  ON 74
ci_076                -2.837078e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="250">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =8000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 25
    time step          = 0.05
    reference energy   = -22.5844
    reference variance = 0.387631
====================================================
  Execution time = 1.0121e+02
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s025
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 62500 
  VMC Eavg = -2.2670e+01
  VMC Evar = 5.0910e-01
  Total weights = 7.8204e+06
  Execution time = 1.4396e+01
  </log>
</opt>
<opt stage="main" walkers="62500">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.496366611233
                                         uncertainty =       0.001459641391

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.496366611233
                                         uncertainty =       0.001459641391

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000249089728
  error estimate for blocks of size 2^( 2) =       0.000258159911
  error estimate for blocks of size 2^( 3) =       0.000266200131
  error estimate for blocks of size 2^( 4) =       0.000271829556
  error estimate for blocks of size 2^( 5) =       0.000275164208
  error estimate for blocks of size 2^( 6) =       0.000276921608
  error estimate for blocks of size 2^( 7) =       0.000278292779
  error estimate for blocks of size 2^( 8) =       0.000278448065
  error estimate for blocks of size 2^( 9) =       0.000278125130

      target function =                  N/A
              le_mean =     -22.669611806106
             les_mean =     514.425371233249
             stat err =       0.000277946896
             autocorr =       1.245122319085
              std dev =       0.704532143660
             le_variance =       0.496365541450

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.496592578368
                                         uncertainty =       0.001455658007

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.496592578368
                                         uncertainty =       0.001455658007

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000249146410
  error estimate for blocks of size 2^( 2) =       0.000258218697
  error estimate for blocks of size 2^( 3) =       0.000266261493
  error estimate for blocks of size 2^( 4) =       0.000271889742
  error estimate for blocks of size 2^( 5) =       0.000275231298
  error estimate for blocks of size 2^( 6) =       0.000276993859
  error estimate for blocks of size 2^( 7) =       0.000278374796
  error estimate for blocks of size 2^( 8) =       0.000278536608
  error estimate for blocks of size 2^( 9) =       0.000278236809

      target function =                  N/A
              le_mean =     -22.669618950713
             les_mean =     514.780759898608
             stat err =       0.000278035518
             autocorr =       1.245349612299
              std dev =       0.704692465009
             le_variance =       0.496591470240

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.496369545227
                                         uncertainty =       0.001457571753

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.496369545227
                                         uncertainty =       0.001457571753

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000249090465
  error estimate for blocks of size 2^( 2) =       0.000258162431
  error estimate for blocks of size 2^( 3) =       0.000266204677
  error estimate for blocks of size 2^( 4) =       0.000271836045
  error estimate for blocks of size 2^( 5) =       0.000275171804
  error estimate for blocks of size 2^( 6) =       0.000276929980
  error estimate for blocks of size 2^( 7) =       0.000278302671
  error estimate for blocks of size 2^( 8) =       0.000278456921
  error estimate for blocks of size 2^( 9) =       0.000278142383

      target function =                  N/A
              le_mean =     -22.669610731956
             les_mean =     514.433488803462
             stat err =       0.000277957989
             autocorr =       1.245214340726
              std dev =       0.704534228467
             le_variance =       0.496368479081

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.496360061381
                                         uncertainty =       0.001459139273

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.496360061381
                                         uncertainty =       0.001459139273

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000249088086
  error estimate for blocks of size 2^( 2) =       0.000258158661
  error estimate for blocks of size 2^( 3) =       0.000266199334
  error estimate for blocks of size 2^( 4) =       0.000271828683
  error estimate for blocks of size 2^( 5) =       0.000275163116
  error estimate for blocks of size 2^( 6) =       0.000276920909
  error estimate for blocks of size 2^( 7) =       0.000278292535
  error estimate for blocks of size 2^( 8) =       0.000278445749
  error estimate for blocks of size 2^( 9) =       0.000278122447

      target function =                  N/A
              le_mean =     -22.669610739420
             les_mean =     514.420662029026
             stat err =       0.000277945410
             autocorr =       1.245125431773
              std dev =       0.704527497834
             le_variance =       0.496358995204


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.669611806106        initial
     2.3842e-01     2.3842e+00             8.1761e-04       -22.669618950713  <--
     9.5367e-01     9.5367e+00             2.9145e-04       -22.669610731956
     3.8147e+00     3.8147e+01             8.1554e-05       -22.669610739420

*****************************************************************************
Applying the update for shift_i =   2.3842e-01     and shift_s =   2.3842e+00
*****************************************************************************

  Execution time = 1.7407e+02
  </log>
  <optVariables href="FORM.s025.opt.xml">
ci_001                -7.061702e-01 3 1  ON 0
ci_002                -7.050237e-01 3 1  ON 1
ci_003                -3.773448e-02 3 1  ON 2
ci_004                -3.794721e-02 3 1  ON 3
ci_005                 1.584061e-02 3 1  ON 4
ci_006                 1.552517e-02 3 1  ON 5
ci_007                 1.188268e-02 3 1  ON 6
ci_008                 1.244620e-02 3 1  ON 7
ci_009                -1.200021e-02 3 1  ON 8
ci_010                -1.135966e-02 3 1  ON 9
ci_011                -8.339956e-03 3 1  ON 10
ci_012                -8.004878e-03 3 1  ON 11
ci_013                 9.711043e-03 3 1  ON 12
ci_014                 9.312791e-03 3 1  ON 13
ci_015                 1.238173e-02 3 1  ON 14
ci_016                 1.273178e-02 3 1  ON 15
ci_017                 1.081812e-02 3 1  ON 16
ci_018                 1.118259e-02 3 1  ON 17
ci_019                -3.503322e-03 3 1  ON 18
ci_020                -3.695371e-03 3 1  ON 19
ci_021                -9.055478e-03 3 1  ON 20
ci_022                -9.320281e-03 3 1  ON 21
ci_023                 7.508097e-03 3 1  ON 22
ci_024                 7.956478e-03 3 1  ON 23
ci_025                 4.436853e-03 3 1  ON 24
ci_026                 4.324958e-03 3 1  ON 25
ci_027                 6.296516e-03 3 1  ON 26
ci_028                 6.087361e-03 3 1  ON 27
ci_029                -4.690243e-03 3 1  ON 28
ci_030                -4.524715e-03 3 1  ON 29
ci_031                -8.037348e-03 3 1  ON 30
ci_032                -7.877310e-03 3 1  ON 31
ci_033                 4.928547e-03 3 1  ON 32
ci_034                 3.829995e-03 3 1  ON 33
ci_035                 1.277047e-03 3 1  ON 34
ci_036                 1.422507e-03 3 1  ON 35
ci_037                 5.410157e-03 3 1  ON 36
ci_038                 5.012848e-03 3 1  ON 37
ci_039                 5.285262e-03 3 1  ON 38
ci_040                 5.379639e-03 3 1  ON 39
ci_041                 5.126407e-03 3 1  ON 40
ci_042                 5.193945e-03 3 1  ON 41
ci_043                 4.918243e-03 3 1  ON 42
ci_044                 4.909496e-03 3 1  ON 43
ci_045                 2.859475e-03 3 1  ON 44
ci_046                 2.983379e-03 3 1  ON 45
ci_047                -7.020911e-04 3 1  ON 46
ci_048                -4.322441e-04 3 1  ON 47
ci_049                 1.370767e-03 3 1  ON 48
ci_050                 1.097274e-03 3 1  ON 49
ci_051                -1.089364e-03 3 1  ON 50
ci_052                -1.892585e-03 3 1  ON 51
ci_053                -2.161884e-03 3 1  ON 52
ci_054                -2.802611e-03 3 1  ON 53
ci_055                -1.639205e-03 3 1  ON 54
ci_056                -1.415348e-03 3 1  ON 55
ci_057                -1.499483e-03 3 1  ON 56
ci_058                -1.253388e-03 3 1  ON 57
ci_059                 4.266969e-05 3 1  ON 58
ci_060                 1.535073e-04 3 1  ON 59
ci_061                -1.942803e-04 3 1  ON 60
ci_062                -1.691616e-04 3 1  ON 61
ci_063                -1.086755e-03 3 1  ON 62
ci_064                -1.050885e-03 3 1  ON 63
ci_065                -2.081836e-03 3 1  ON 64
ci_066                -2.965981e-03 3 1  ON 65
ci_067                -2.475282e-03 3 1  ON 66
ci_068                -1.936540e-03 3 1  ON 67
ci_069                 2.807303e-04 3 1  ON 68
ci_070                -6.226691e-04 3 1  ON 69
ci_071                -2.673128e-03 3 1  ON 70
ci_072                -1.989788e-03 3 1  ON 71
ci_073                 3.563842e-04 3 1  ON 72
ci_074                -3.808144e-04 3 1  ON 73
ci_075                -3.717953e-04 3 1  ON 74
ci_076                -2.378642e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 2.9231e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s026 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s026 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=26  my_counter=0
  time step      = 5.0000e-02
  blocks         = 250
  steps          = 250
  substeps       = 10
  current        = 0
  target samples = 8.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">250</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">6.2500e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">8.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">6.2500e+04</parameter>
<parameter name="steps" condition="int">250</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2675e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="250">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =8000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 26
    time step          = 0.05
    reference energy   = -22.639
    reference variance = 0.45112
====================================================
  Execution time = 9.9614e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s026
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 62500 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 6.1096e+04
  VMC Eavg = -2.2669e+01
  VMC Evar = 5.1307e-01
  Total weights = 7.821242221e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.8736e+01
  </log>
</opt>
<opt stage="main" walkers="62500">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.499796379562
                                         uncertainty =       0.001536606729

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.499796379562
                                         uncertainty =       0.001536606729

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000249949641
  error estimate for blocks of size 2^( 2) =       0.000258863930
  error estimate for blocks of size 2^( 3) =       0.000266829919
  error estimate for blocks of size 2^( 4) =       0.000272519334
  error estimate for blocks of size 2^( 5) =       0.000275862345
  error estimate for blocks of size 2^( 6) =       0.000277582964
  error estimate for blocks of size 2^( 7) =       0.000278859906
  error estimate for blocks of size 2^( 8) =       0.000279070496
  error estimate for blocks of size 2^( 9) =       0.000279202314

      target function =                  N/A
              le_mean =     -22.669424414043
             les_mean =     514.415877306063
             stat err =       0.000278678920
             autocorr =       1.243091799477
              std dev =       0.706964345204
             le_variance =       0.499798585390


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266942441404e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.9605e-02, overlap shift 5.9605e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.669424414066       residual = 7.49e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.669434582880       residual = 2.80e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.669434708701       residual = 2.31e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.669434788681       residual = 2.27e-08           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.669434742810       residual = 6.87e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          4 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 5.9605e-02 is 1.242665e-03

solving harmonic davidson linear method for identity shift 2.3842e-01, overlap shift 2.3842e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.669424414066       residual = 7.49e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.669430074121       residual = 1.13e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.669430061075       residual = 4.49e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.669430060440       residual = 1.70e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 2.3842e-01 is 6.679816e-04

solving harmonic davidson linear method for identity shift 9.5367e-01, overlap shift 9.5367e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.669424414066       residual = 7.49e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.669426454780       residual = 8.42e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.669426452947       residual = 2.12e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.669426443390       residual = 5.63e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 9.5367e-01 is 2.388837e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.306238 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.1837e+02
  </log>
  <optVariables href="FORM.s026.opt.xml">
ci_001                -7.061139e-01 3 1  ON 0
ci_002                -7.050859e-01 3 1  ON 1
ci_003                -3.770350e-02 3 1  ON 2
ci_004                -3.810520e-02 3 1  ON 3
ci_005                 1.585376e-02 3 1  ON 4
ci_006                 1.579899e-02 3 1  ON 5
ci_007                 1.177479e-02 3 1  ON 6
ci_008                 1.247109e-02 3 1  ON 7
ci_009                -1.179185e-02 3 1  ON 8
ci_010                -1.150663e-02 3 1  ON 9
ci_011                -8.351083e-03 3 1  ON 10
ci_012                -8.181298e-03 3 1  ON 11
ci_013                 9.563979e-03 3 1  ON 12
ci_014                 9.450288e-03 3 1  ON 13
ci_015                 1.259289e-02 3 1  ON 14
ci_016                 1.217399e-02 3 1  ON 15
ci_017                 1.065432e-02 3 1  ON 16
ci_018                 1.083319e-02 3 1  ON 17
ci_019                -3.342216e-03 3 1  ON 18
ci_020                -3.789170e-03 3 1  ON 19
ci_021                -8.794753e-03 3 1  ON 20
ci_022                -8.793549e-03 3 1  ON 21
ci_023                 7.666829e-03 3 1  ON 22
ci_024                 8.175579e-03 3 1  ON 23
ci_025                 3.956456e-03 3 1  ON 24
ci_026                 3.890011e-03 3 1  ON 25
ci_027                 6.383589e-03 3 1  ON 26
ci_028                 6.236332e-03 3 1  ON 27
ci_029                -5.349671e-03 3 1  ON 28
ci_030                -4.659695e-03 3 1  ON 29
ci_031                -8.294958e-03 3 1  ON 30
ci_032                -8.121789e-03 3 1  ON 31
ci_033                 4.419376e-03 3 1  ON 32
ci_034                 3.877138e-03 3 1  ON 33
ci_035                 1.185319e-03 3 1  ON 34
ci_036                 1.214700e-03 3 1  ON 35
ci_037                 5.268524e-03 3 1  ON 36
ci_038                 5.153668e-03 3 1  ON 37
ci_039                 5.563954e-03 3 1  ON 38
ci_040                 5.513478e-03 3 1  ON 39
ci_041                 5.190130e-03 3 1  ON 40
ci_042                 5.327479e-03 3 1  ON 41
ci_043                 4.727113e-03 3 1  ON 42
ci_044                 4.729184e-03 3 1  ON 43
ci_045                 2.751417e-03 3 1  ON 44
ci_046                 2.976685e-03 3 1  ON 45
ci_047                -6.572611e-04 3 1  ON 46
ci_048                -6.762018e-04 3 1  ON 47
ci_049                 1.326496e-03 3 1  ON 48
ci_050                 1.742737e-03 3 1  ON 49
ci_051                -1.097612e-03 3 1  ON 50
ci_052                -1.558357e-03 3 1  ON 51
ci_053                -2.829865e-03 3 1  ON 52
ci_054                -2.608257e-03 3 1  ON 53
ci_055                -1.511814e-03 3 1  ON 54
ci_056                -1.277071e-03 3 1  ON 55
ci_057                -1.509867e-03 3 1  ON 56
ci_058                -1.400506e-03 3 1  ON 57
ci_059                 8.050399e-05 3 1  ON 58
ci_060                 1.642812e-04 3 1  ON 59
ci_061                -1.324273e-04 3 1  ON 60
ci_062                -3.107187e-04 3 1  ON 61
ci_063                -6.933835e-04 3 1  ON 62
ci_064                -7.816380e-04 3 1  ON 63
ci_065                -2.261105e-03 3 1  ON 64
ci_066                -2.557411e-03 3 1  ON 65
ci_067                -2.387107e-03 3 1  ON 66
ci_068                -2.269293e-03 3 1  ON 67
ci_069                -6.893299e-05 3 1  ON 68
ci_070                -2.607192e-04 3 1  ON 69
ci_071                -2.366844e-03 3 1  ON 70
ci_072                -2.016607e-03 3 1  ON 71
ci_073                 1.117403e-04 3 1  ON 72
ci_074                 9.816375e-05 3 1  ON 73
ci_075                -5.811809e-04 3 1  ON 74
ci_076                -1.810580e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="250">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =8000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 26
    time step          = 0.05
    reference energy   = -22.7302
    reference variance = 0.376615
====================================================
  Execution time = 1.0272e+02
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s026
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 62500 
  VMC Eavg = -2.2670e+01
  VMC Evar = 5.2002e-01
  Total weights = 7.8206e+06
  Execution time = 1.4384e+01
  </log>
</opt>
<opt stage="main" walkers="62500">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

ERROR CostFunction-> Number of Effective Walkers is too small! 
  Number of effective walkers (samples) / total number of samples = 0.0567242
  User specified threshold minwalkers = 0.3
  If this message appears frequently. You might have to be cautious. 
  Find info about parameter "minwalkers" in the user manual!
Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.504479977854
                                         uncertainty =       0.002150870645

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.504479977854
                                         uncertainty =       0.002150870645

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000251117679
  error estimate for blocks of size 2^( 2) =       0.000259996762
  error estimate for blocks of size 2^( 3) =       0.000267978288
  error estimate for blocks of size 2^( 4) =       0.000273829886
  error estimate for blocks of size 2^( 5) =       0.000277187872
  error estimate for blocks of size 2^( 6) =       0.000279174337
  error estimate for blocks of size 2^( 7) =       0.000280059554
  error estimate for blocks of size 2^( 8) =       0.000280417984
  error estimate for blocks of size 2^( 9) =       0.000281058858

      target function =                  N/A
              le_mean =     -22.669885889559
             les_mean =     514.446260889218
             stat err =       0.000280177683
             autocorr =       1.244837044568
              std dev =       0.710268054048
             le_variance =       0.504480708602

ERROR CostFunction-> Number of Effective Walkers is too small! 
  Number of effective walkers (samples) / total number of samples = 0.0965923
  User specified threshold minwalkers = 0.3
  If this message appears frequently. You might have to be cautious. 
  Find info about parameter "minwalkers" in the user manual!
Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.504830618645
                                         uncertainty =       0.002193061147

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.504830618645
                                         uncertainty =       0.002193061147

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000251204928
  error estimate for blocks of size 2^( 2) =       0.000260079543
  error estimate for blocks of size 2^( 3) =       0.000268054187
  error estimate for blocks of size 2^( 4) =       0.000273909424
  error estimate for blocks of size 2^( 5) =       0.000277263279
  error estimate for blocks of size 2^( 6) =       0.000279245579
  error estimate for blocks of size 2^( 7) =       0.000280136672
  error estimate for blocks of size 2^( 8) =       0.000280472375
  error estimate for blocks of size 2^( 9) =       0.000281123602

      target function =                  N/A
              le_mean =     -22.669883835396
             les_mean =     514.587715699523
             stat err =       0.000280244557
             autocorr =       1.244566374799
              std dev =       0.710514832536
             le_variance =       0.504831327254

ERROR CostFunction-> Number of Effective Walkers is too small! 
  Number of effective walkers (samples) / total number of samples = 0.0555396
  User specified threshold minwalkers = 0.3
  If this message appears frequently. You might have to be cautious. 
  Find info about parameter "minwalkers" in the user manual!
Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.504870786331
                                         uncertainty =       0.002201109843

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.504870786331
                                         uncertainty =       0.002201109843

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000251214929
  error estimate for blocks of size 2^( 2) =       0.000260091203
  error estimate for blocks of size 2^( 3) =       0.000268066104
  error estimate for blocks of size 2^( 4) =       0.000273922672
  error estimate for blocks of size 2^( 5) =       0.000277276053
  error estimate for blocks of size 2^( 6) =       0.000279262371
  error estimate for blocks of size 2^( 7) =       0.000280155402
  error estimate for blocks of size 2^( 8) =       0.000280487037
  error estimate for blocks of size 2^( 9) =       0.000281158281

      target function =                  N/A
              le_mean =     -22.669887003362
             les_mean =     514.482368496906
             stat err =       0.000280265773
             autocorr =       1.244655709669
              std dev =       0.710543120450
             le_variance =       0.504871526018

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.504487363348
                                         uncertainty =       0.002157045699

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.504487363348
                                         uncertainty =       0.002157045699

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000251119516
  error estimate for blocks of size 2^( 2) =       0.000259998610
  error estimate for blocks of size 2^( 3) =       0.000267978896
  error estimate for blocks of size 2^( 4) =       0.000273831451
  error estimate for blocks of size 2^( 5) =       0.000277189293
  error estimate for blocks of size 2^( 6) =       0.000279175802
  error estimate for blocks of size 2^( 7) =       0.000280063979
  error estimate for blocks of size 2^( 8) =       0.000280422661
  error estimate for blocks of size 2^( 9) =       0.000281067089

      target function =                  N/A
              le_mean =     -22.669880307114
             les_mean =     514.449453703288
             stat err =       0.000280182383
             autocorr =       1.244860586146
              std dev =       0.710273250623
             le_variance =       0.504488090551


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.669885889559        initial
     5.9605e-02     5.9605e-01             1.2427e-03       -22.669883835396
     2.3842e-01     2.3842e+00             6.6798e-04       -22.669887003362  <--
     9.5367e-01     9.5367e+00             2.3888e-04       -22.669880307114

*****************************************************************************
Applying the update for shift_i =   2.3842e-01     and shift_s =   2.3842e+00
*****************************************************************************

  Execution time = 1.7568e+02
  </log>
  <optVariables href="FORM.s026.opt.xml">
ci_001                -7.061139e-01 3 1  ON 0
ci_002                -7.050859e-01 3 1  ON 1
ci_003                -3.770350e-02 3 1  ON 2
ci_004                -3.810520e-02 3 1  ON 3
ci_005                 1.585376e-02 3 1  ON 4
ci_006                 1.579899e-02 3 1  ON 5
ci_007                 1.177479e-02 3 1  ON 6
ci_008                 1.247109e-02 3 1  ON 7
ci_009                -1.179185e-02 3 1  ON 8
ci_010                -1.150663e-02 3 1  ON 9
ci_011                -8.351083e-03 3 1  ON 10
ci_012                -8.181298e-03 3 1  ON 11
ci_013                 9.563979e-03 3 1  ON 12
ci_014                 9.450288e-03 3 1  ON 13
ci_015                 1.259289e-02 3 1  ON 14
ci_016                 1.217399e-02 3 1  ON 15
ci_017                 1.065432e-02 3 1  ON 16
ci_018                 1.083319e-02 3 1  ON 17
ci_019                -3.342216e-03 3 1  ON 18
ci_020                -3.789170e-03 3 1  ON 19
ci_021                -8.794753e-03 3 1  ON 20
ci_022                -8.793549e-03 3 1  ON 21
ci_023                 7.666829e-03 3 1  ON 22
ci_024                 8.175579e-03 3 1  ON 23
ci_025                 3.956456e-03 3 1  ON 24
ci_026                 3.890011e-03 3 1  ON 25
ci_027                 6.383589e-03 3 1  ON 26
ci_028                 6.236332e-03 3 1  ON 27
ci_029                -5.349671e-03 3 1  ON 28
ci_030                -4.659695e-03 3 1  ON 29
ci_031                -8.294958e-03 3 1  ON 30
ci_032                -8.121789e-03 3 1  ON 31
ci_033                 4.419376e-03 3 1  ON 32
ci_034                 3.877138e-03 3 1  ON 33
ci_035                 1.185319e-03 3 1  ON 34
ci_036                 1.214700e-03 3 1  ON 35
ci_037                 5.268524e-03 3 1  ON 36
ci_038                 5.153668e-03 3 1  ON 37
ci_039                 5.563954e-03 3 1  ON 38
ci_040                 5.513478e-03 3 1  ON 39
ci_041                 5.190130e-03 3 1  ON 40
ci_042                 5.327479e-03 3 1  ON 41
ci_043                 4.727113e-03 3 1  ON 42
ci_044                 4.729184e-03 3 1  ON 43
ci_045                 2.751417e-03 3 1  ON 44
ci_046                 2.976685e-03 3 1  ON 45
ci_047                -6.572611e-04 3 1  ON 46
ci_048                -6.762018e-04 3 1  ON 47
ci_049                 1.326496e-03 3 1  ON 48
ci_050                 1.742737e-03 3 1  ON 49
ci_051                -1.097612e-03 3 1  ON 50
ci_052                -1.558357e-03 3 1  ON 51
ci_053                -2.829865e-03 3 1  ON 52
ci_054                -2.608257e-03 3 1  ON 53
ci_055                -1.511814e-03 3 1  ON 54
ci_056                -1.277071e-03 3 1  ON 55
ci_057                -1.509867e-03 3 1  ON 56
ci_058                -1.400506e-03 3 1  ON 57
ci_059                 8.050399e-05 3 1  ON 58
ci_060                 1.642812e-04 3 1  ON 59
ci_061                -1.324273e-04 3 1  ON 60
ci_062                -3.107187e-04 3 1  ON 61
ci_063                -6.933835e-04 3 1  ON 62
ci_064                -7.816380e-04 3 1  ON 63
ci_065                -2.261105e-03 3 1  ON 64
ci_066                -2.557411e-03 3 1  ON 65
ci_067                -2.387107e-03 3 1  ON 66
ci_068                -2.269293e-03 3 1  ON 67
ci_069                -6.893299e-05 3 1  ON 68
ci_070                -2.607192e-04 3 1  ON 69
ci_071                -2.366844e-03 3 1  ON 70
ci_072                -2.016607e-03 3 1  ON 71
ci_073                 1.117403e-04 3 1  ON 72
ci_074                 9.816375e-05 3 1  ON 73
ci_075                -5.811809e-04 3 1  ON 74
ci_076                -1.810580e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 2.9409e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s027 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s027 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=27  my_counter=0
  time step      = 5.0000e-02
  blocks         = 250
  steps          = 250
  substeps       = 10
  current        = 0
  target samples = 8.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">250</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">6.2500e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">8.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">6.2500e+04</parameter>
<parameter name="steps" condition="int">250</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2675e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="250">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =8000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 27
    time step          = 0.05
    reference energy   = -22.6461
    reference variance = 0.451825
====================================================
  Execution time = 9.9813e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s027
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 62500 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 6.1046e+04
  VMC Eavg = -2.2670e+01
  VMC Evar = 5.1387e-01
  Total weights = 7.820813312e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.8877e+01
  </log>
</opt>
<opt stage="main" walkers="62500">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.500396244316
                                         uncertainty =       0.001883836452

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.500396244316
                                         uncertainty =       0.001883836452

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000250099936
  error estimate for blocks of size 2^( 2) =       0.000258922723
  error estimate for blocks of size 2^( 3) =       0.000266838202
  error estimate for blocks of size 2^( 4) =       0.000272305187
  error estimate for blocks of size 2^( 5) =       0.000275495872
  error estimate for blocks of size 2^( 6) =       0.000277769383
  error estimate for blocks of size 2^( 7) =       0.000278660914
  error estimate for blocks of size 2^( 8) =       0.000278838424
  error estimate for blocks of size 2^( 9) =       0.000279075673

      target function =                  N/A
              le_mean =     -22.669619969987
             les_mean =     514.425535561959
             stat err =       0.000278586098
             autocorr =       1.240771248576
              std dev =       0.707389442535
             le_variance =       0.500399823410


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266961996999e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.9605e-02, overlap shift 5.9605e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.669619970006       residual = 4.57e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.669623144649       residual = 2.24e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.669622708596       residual = 2.42e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.669623157001       residual = 2.13e-08           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.669623183792       residual = 1.81e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          4 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 5.9605e-02 is 1.263879e-03

solving harmonic davidson linear method for identity shift 2.3842e-01, overlap shift 2.3842e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.669619970006       residual = 4.57e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.669621729381       residual = 7.51e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.669621576921       residual = 3.03e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.669621636981       residual = 9.02e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 2.3842e-01 is 6.449543e-04

solving harmonic davidson linear method for identity shift 9.5367e-01, overlap shift 9.5367e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.669619970006       residual = 4.57e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.669620602144       residual = 3.64e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.669620583788       residual = 6.43e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 9.5367e-01 is 2.190087e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.307798 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.1871e+02
  </log>
  <optVariables href="FORM.s027.opt.xml">
ci_001                -7.061263e-01 3 1  ON 0
ci_002                -7.050997e-01 3 1  ON 1
ci_003                -3.735938e-02 3 1  ON 2
ci_004                -3.784682e-02 3 1  ON 3
ci_005                 1.585348e-02 3 1  ON 4
ci_006                 1.581629e-02 3 1  ON 5
ci_007                 1.169129e-02 3 1  ON 6
ci_008                 1.226687e-02 3 1  ON 7
ci_009                -1.169611e-02 3 1  ON 8
ci_010                -1.158968e-02 3 1  ON 9
ci_011                -8.070066e-03 3 1  ON 10
ci_012                -8.110654e-03 3 1  ON 11
ci_013                 9.379305e-03 3 1  ON 12
ci_014                 9.355926e-03 3 1  ON 13
ci_015                 1.212989e-02 3 1  ON 14
ci_016                 1.257108e-02 3 1  ON 15
ci_017                 1.098958e-02 3 1  ON 16
ci_018                 1.092278e-02 3 1  ON 17
ci_019                -3.308849e-03 3 1  ON 18
ci_020                -3.891024e-03 3 1  ON 19
ci_021                -8.908448e-03 3 1  ON 20
ci_022                -8.955343e-03 3 1  ON 21
ci_023                 7.956373e-03 3 1  ON 22
ci_024                 8.156005e-03 3 1  ON 23
ci_025                 4.601411e-03 3 1  ON 24
ci_026                 4.071269e-03 3 1  ON 25
ci_027                 6.484556e-03 3 1  ON 26
ci_028                 6.603805e-03 3 1  ON 27
ci_029                -5.165121e-03 3 1  ON 28
ci_030                -4.507165e-03 3 1  ON 29
ci_031                -8.029132e-03 3 1  ON 30
ci_032                -8.154253e-03 3 1  ON 31
ci_033                 4.413559e-03 3 1  ON 32
ci_034                 4.191231e-03 3 1  ON 33
ci_035                 1.258822e-03 3 1  ON 34
ci_036                 1.104715e-03 3 1  ON 35
ci_037                 5.458796e-03 3 1  ON 36
ci_038                 5.145649e-03 3 1  ON 37
ci_039                 5.630185e-03 3 1  ON 38
ci_040                 5.703350e-03 3 1  ON 39
ci_041                 5.119462e-03 3 1  ON 40
ci_042                 5.274587e-03 3 1  ON 41
ci_043                 4.956971e-03 3 1  ON 42
ci_044                 4.761695e-03 3 1  ON 43
ci_045                 2.802429e-03 3 1  ON 44
ci_046                 2.776475e-03 3 1  ON 45
ci_047                -3.749447e-04 3 1  ON 46
ci_048                -5.520008e-04 3 1  ON 47
ci_049                 1.289150e-03 3 1  ON 48
ci_050                 1.509328e-03 3 1  ON 49
ci_051                -1.178929e-03 3 1  ON 50
ci_052                -1.443597e-03 3 1  ON 51
ci_053                -2.607721e-03 3 1  ON 52
ci_054                -2.693832e-03 3 1  ON 53
ci_055                -1.750533e-03 3 1  ON 54
ci_056                -1.535585e-03 3 1  ON 55
ci_057                -1.413395e-03 3 1  ON 56
ci_058                -1.515341e-03 3 1  ON 57
ci_059                 3.657976e-05 3 1  ON 58
ci_060                 4.938955e-04 3 1  ON 59
ci_061                -1.563683e-04 3 1  ON 60
ci_062                -9.006718e-05 3 1  ON 61
ci_063                -3.717098e-04 3 1  ON 62
ci_064                -9.535377e-04 3 1  ON 63
ci_065                -2.491712e-03 3 1  ON 64
ci_066                -2.333502e-03 3 1  ON 65
ci_067                -2.207898e-03 3 1  ON 66
ci_068                -2.136910e-03 3 1  ON 67
ci_069                -2.785211e-04 3 1  ON 68
ci_070                -3.974749e-04 3 1  ON 69
ci_071                -2.187389e-03 3 1  ON 70
ci_072                -2.322748e-03 3 1  ON 71
ci_073                 2.370453e-04 3 1  ON 72
ci_074                 6.726517e-05 3 1  ON 73
ci_075                -5.684686e-04 3 1  ON 74
ci_076                -3.304900e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="250">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =8000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 27
    time step          = 0.05
    reference energy   = -22.6774
    reference variance = 0.484454
====================================================
  Execution time = 1.0123e+02
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s027
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 62500 
  VMC Eavg = -2.2669e+01
  VMC Evar = 5.0930e-01
  Total weights = 7.8207e+06
  Execution time = 1.4410e+01
  </log>
</opt>
<opt stage="main" walkers="62500">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.498009493163
                                         uncertainty =       0.001128533326

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.498009493163
                                         uncertainty =       0.001128533326

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000249502447
  error estimate for blocks of size 2^( 2) =       0.000258373758
  error estimate for blocks of size 2^( 3) =       0.000266249612
  error estimate for blocks of size 2^( 4) =       0.000272068412
  error estimate for blocks of size 2^( 5) =       0.000274942558
  error estimate for blocks of size 2^( 6) =       0.000276815944
  error estimate for blocks of size 2^( 7) =       0.000278255916
  error estimate for blocks of size 2^( 8) =       0.000280204250
  error estimate for blocks of size 2^( 9) =       0.000280636369

      target function =                  N/A
              le_mean =     -22.669502442104
             les_mean =     514.449862116890
             stat err =       0.000278978120
             autocorr =       1.250232163897
              std dev =       0.705699488961
             le_variance =       0.498011768720

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.497839537479
                                         uncertainty =       0.001118854893

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.497839537479
                                         uncertainty =       0.001118854893

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000249459880
  error estimate for blocks of size 2^( 2) =       0.000258332946
  error estimate for blocks of size 2^( 3) =       0.000266208333
  error estimate for blocks of size 2^( 4) =       0.000272022022
  error estimate for blocks of size 2^( 5) =       0.000274888166
  error estimate for blocks of size 2^( 6) =       0.000276752508
  error estimate for blocks of size 2^( 7) =       0.000278186756
  error estimate for blocks of size 2^( 8) =       0.000280120393
  error estimate for blocks of size 2^( 9) =       0.000280534048

      target function =                  N/A
              le_mean =     -22.669496439908
             les_mean =     514.427607537247
             stat err =       0.000278898426
             autocorr =       1.249944439471
              std dev =       0.705579091559
             le_variance =       0.497841854446

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.497847805994
                                         uncertainty =       0.001119827522

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.497847805994
                                         uncertainty =       0.001119827522

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000249461952
  error estimate for blocks of size 2^( 2) =       0.000258334212
  error estimate for blocks of size 2^( 3) =       0.000266210111
  error estimate for blocks of size 2^( 4) =       0.000272022923
  error estimate for blocks of size 2^( 5) =       0.000274887478
  error estimate for blocks of size 2^( 6) =       0.000276752390
  error estimate for blocks of size 2^( 7) =       0.000278188939
  error estimate for blocks of size 2^( 8) =       0.000280120800
  error estimate for blocks of size 2^( 9) =       0.000280533359

      target function =                  N/A
              le_mean =     -22.669498406621
             les_mean =     514.418787593514
             stat err =       0.000278898872
             autocorr =       1.249927677936
              std dev =       0.705584950632
             le_variance =       0.497850122558

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.497955433201
                                         uncertainty =       0.001126396644

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.497955433201
                                         uncertainty =       0.001126396644

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000249488911
  error estimate for blocks of size 2^( 2) =       0.000258360601
  error estimate for blocks of size 2^( 3) =       0.000266236839
  error estimate for blocks of size 2^( 4) =       0.000272054624
  error estimate for blocks of size 2^( 5) =       0.000274926642
  error estimate for blocks of size 2^( 6) =       0.000276797700
  error estimate for blocks of size 2^( 7) =       0.000278236846
  error estimate for blocks of size 2^( 8) =       0.000280183360
  error estimate for blocks of size 2^( 9) =       0.000280606553

      target function =                  N/A
              le_mean =     -22.669498414582
             les_mean =     514.424554184212
             stat err =       0.000278956115
             autocorr =       1.250170591232
              std dev =       0.705661201924
             le_variance =       0.497957731901


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.669502442104        initial  <--
     5.9605e-02     5.9605e-01             1.2639e-03       -22.669496439908
     2.3842e-01     2.3842e+00             6.4495e-04       -22.669498406621
     9.5367e-01     9.5367e+00             2.1901e-04       -22.669498414582

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 174.3531
  </log>
  <optVariables href="FORM.s027.opt.xml">
ci_001                -7.061139e-01 3 1  ON 0
ci_002                -7.050859e-01 3 1  ON 1
ci_003                -3.770350e-02 3 1  ON 2
ci_004                -3.810520e-02 3 1  ON 3
ci_005                 1.585376e-02 3 1  ON 4
ci_006                 1.579899e-02 3 1  ON 5
ci_007                 1.177479e-02 3 1  ON 6
ci_008                 1.247109e-02 3 1  ON 7
ci_009                -1.179185e-02 3 1  ON 8
ci_010                -1.150663e-02 3 1  ON 9
ci_011                -8.351083e-03 3 1  ON 10
ci_012                -8.181298e-03 3 1  ON 11
ci_013                 9.563979e-03 3 1  ON 12
ci_014                 9.450288e-03 3 1  ON 13
ci_015                 1.259289e-02 3 1  ON 14
ci_016                 1.217399e-02 3 1  ON 15
ci_017                 1.065432e-02 3 1  ON 16
ci_018                 1.083319e-02 3 1  ON 17
ci_019                -3.342216e-03 3 1  ON 18
ci_020                -3.789170e-03 3 1  ON 19
ci_021                -8.794753e-03 3 1  ON 20
ci_022                -8.793549e-03 3 1  ON 21
ci_023                 7.666829e-03 3 1  ON 22
ci_024                 8.175579e-03 3 1  ON 23
ci_025                 3.956456e-03 3 1  ON 24
ci_026                 3.890011e-03 3 1  ON 25
ci_027                 6.383589e-03 3 1  ON 26
ci_028                 6.236332e-03 3 1  ON 27
ci_029                -5.349671e-03 3 1  ON 28
ci_030                -4.659695e-03 3 1  ON 29
ci_031                -8.294958e-03 3 1  ON 30
ci_032                -8.121789e-03 3 1  ON 31
ci_033                 4.419376e-03 3 1  ON 32
ci_034                 3.877138e-03 3 1  ON 33
ci_035                 1.185319e-03 3 1  ON 34
ci_036                 1.214700e-03 3 1  ON 35
ci_037                 5.268524e-03 3 1  ON 36
ci_038                 5.153668e-03 3 1  ON 37
ci_039                 5.563954e-03 3 1  ON 38
ci_040                 5.513478e-03 3 1  ON 39
ci_041                 5.190130e-03 3 1  ON 40
ci_042                 5.327479e-03 3 1  ON 41
ci_043                 4.727113e-03 3 1  ON 42
ci_044                 4.729184e-03 3 1  ON 43
ci_045                 2.751417e-03 3 1  ON 44
ci_046                 2.976685e-03 3 1  ON 45
ci_047                -6.572611e-04 3 1  ON 46
ci_048                -6.762018e-04 3 1  ON 47
ci_049                 1.326496e-03 3 1  ON 48
ci_050                 1.742737e-03 3 1  ON 49
ci_051                -1.097612e-03 3 1  ON 50
ci_052                -1.558357e-03 3 1  ON 51
ci_053                -2.829865e-03 3 1  ON 52
ci_054                -2.608257e-03 3 1  ON 53
ci_055                -1.511814e-03 3 1  ON 54
ci_056                -1.277071e-03 3 1  ON 55
ci_057                -1.509867e-03 3 1  ON 56
ci_058                -1.400506e-03 3 1  ON 57
ci_059                 8.050399e-05 3 1  ON 58
ci_060                 1.642812e-04 3 1  ON 59
ci_061                -1.324273e-04 3 1  ON 60
ci_062                -3.107187e-04 3 1  ON 61
ci_063                -6.933835e-04 3 1  ON 62
ci_064                -7.816380e-04 3 1  ON 63
ci_065                -2.261105e-03 3 1  ON 64
ci_066                -2.557411e-03 3 1  ON 65
ci_067                -2.387107e-03 3 1  ON 66
ci_068                -2.269293e-03 3 1  ON 67
ci_069                -6.893299e-05 3 1  ON 68
ci_070                -2.607192e-04 3 1  ON 69
ci_071                -2.366844e-03 3 1  ON 70
ci_072                -2.016607e-03 3 1  ON 71
ci_073                 1.117403e-04 3 1  ON 72
ci_074                 9.816375e-05 3 1  ON 73
ci_075                -5.811809e-04 3 1  ON 74
ci_076                -1.810580e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 2.9307e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s028 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s028 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=28  my_counter=0
  time step      = 5.0000e-02
  blocks         = 250
  steps          = 250
  substeps       = 10
  current        = 0
  target samples = 8.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">250</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">6.2500e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">8.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">6.2500e+04</parameter>
<parameter name="steps" condition="int">250</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2675e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="250">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =8000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 28
    time step          = 0.05
    reference energy   = -22.5683
    reference variance = 0.372221
====================================================
  Execution time = 9.9607e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s028
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 62500 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 6.1056e+04
  VMC Eavg = -2.2669e+01
  VMC Evar = 5.1144e-01
  Total weights = 7.821277928e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.8870e+01
  </log>
</opt>
<opt stage="main" walkers="62500">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.496848134657
                                         uncertainty =       0.001306371536

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.496848134657
                                         uncertainty =       0.001306371536

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000249210689
  error estimate for blocks of size 2^( 2) =       0.000258129959
  error estimate for blocks of size 2^( 3) =       0.000266264111
  error estimate for blocks of size 2^( 4) =       0.000271875795
  error estimate for blocks of size 2^( 5) =       0.000275121907
  error estimate for blocks of size 2^( 6) =       0.000276998851
  error estimate for blocks of size 2^( 7) =       0.000277075587
  error estimate for blocks of size 2^( 8) =       0.000278386114
  error estimate for blocks of size 2^( 9) =       0.000278249025

      target function =                  N/A
              le_mean =     -22.669476627892
             les_mean =     514.416612918823
             stat err =       0.000277677394
             autocorr =       1.241502847589
              std dev =       0.704874271664
             le_variance =       0.496847738853


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266947662789e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.9605e-01, overlap shift 5.9605e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.669476627914       residual = 3.16e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.669477766486       residual = 5.61e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.669477817277       residual = 1.89e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.669477813657       residual = 4.45e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 5.9605e-01 is 2.642503e-04

solving harmonic davidson linear method for identity shift 2.3842e+00, overlap shift 2.3842e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.669476627914       residual = 3.16e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.669476970614       residual = 5.24e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.669476995254       residual = 1.56e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.669476994869       residual = 4.40e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 2.3842e+00 is 7.553359e-05

solving harmonic davidson linear method for identity shift 9.5367e+00, overlap shift 9.5367e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.669476627914       residual = 3.16e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.669476718192       residual = 5.46e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.669476725507       residual = 1.78e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.669476725510       residual = 5.11e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 9.5367e+00 is 1.959739e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.309185 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.1849e+02
  </log>
  <optVariables href="FORM.s028.opt.xml">
ci_001                -7.061270e-01 3 1  ON 0
ci_002                -7.050729e-01 3 1  ON 1
ci_003                -3.769179e-02 3 1  ON 2
ci_004                -3.811141e-02 3 1  ON 3
ci_005                 1.583415e-02 3 1  ON 4
ci_006                 1.576840e-02 3 1  ON 5
ci_007                 1.180343e-02 3 1  ON 6
ci_008                 1.245287e-02 3 1  ON 7
ci_009                -1.178010e-02 3 1  ON 8
ci_010                -1.153036e-02 3 1  ON 9
ci_011                -8.326933e-03 3 1  ON 10
ci_012                -8.186699e-03 3 1  ON 11
ci_013                 9.540363e-03 3 1  ON 12
ci_014                 9.440470e-03 3 1  ON 13
ci_015                 1.262333e-02 3 1  ON 14
ci_016                 1.220166e-02 3 1  ON 15
ci_017                 1.066226e-02 3 1  ON 16
ci_018                 1.085473e-02 3 1  ON 17
ci_019                -3.343523e-03 3 1  ON 18
ci_020                -3.820644e-03 3 1  ON 19
ci_021                -8.797820e-03 3 1  ON 20
ci_022                -8.811954e-03 3 1  ON 21
ci_023                 7.628747e-03 3 1  ON 22
ci_024                 8.165452e-03 3 1  ON 23
ci_025                 3.969260e-03 3 1  ON 24
ci_026                 3.965544e-03 3 1  ON 25
ci_027                 6.359247e-03 3 1  ON 26
ci_028                 6.275910e-03 3 1  ON 27
ci_029                -5.323586e-03 3 1  ON 28
ci_030                -4.655239e-03 3 1  ON 29
ci_031                -8.295933e-03 3 1  ON 30
ci_032                -8.136948e-03 3 1  ON 31
ci_033                 4.457268e-03 3 1  ON 32
ci_034                 3.924943e-03 3 1  ON 33
ci_035                 1.160863e-03 3 1  ON 34
ci_036                 1.221714e-03 3 1  ON 35
ci_037                 5.276067e-03 3 1  ON 36
ci_038                 5.124428e-03 3 1  ON 37
ci_039                 5.510442e-03 3 1  ON 38
ci_040                 5.510577e-03 3 1  ON 39
ci_041                 5.152777e-03 3 1  ON 40
ci_042                 5.309713e-03 3 1  ON 41
ci_043                 4.753830e-03 3 1  ON 42
ci_044                 4.751379e-03 3 1  ON 43
ci_045                 2.807595e-03 3 1  ON 44
ci_046                 2.975227e-03 3 1  ON 45
ci_047                -6.473972e-04 3 1  ON 46
ci_048                -6.865935e-04 3 1  ON 47
ci_049                 1.309745e-03 3 1  ON 48
ci_050                 1.708935e-03 3 1  ON 49
ci_051                -1.122679e-03 3 1  ON 50
ci_052                -1.505775e-03 3 1  ON 51
ci_053                -2.808493e-03 3 1  ON 52
ci_054                -2.629828e-03 3 1  ON 53
ci_055                -1.549322e-03 3 1  ON 54
ci_056                -1.297140e-03 3 1  ON 55
ci_057                -1.487828e-03 3 1  ON 56
ci_058                -1.384304e-03 3 1  ON 57
ci_059                 1.441615e-04 3 1  ON 58
ci_060                 1.685054e-04 3 1  ON 59
ci_061                -1.632997e-04 3 1  ON 60
ci_062                -2.824516e-04 3 1  ON 61
ci_063                -6.861703e-04 3 1  ON 62
ci_064                -7.403840e-04 3 1  ON 63
ci_065                -2.246486e-03 3 1  ON 64
ci_066                -2.524105e-03 3 1  ON 65
ci_067                -2.420478e-03 3 1  ON 66
ci_068                -2.257270e-03 3 1  ON 67
ci_069                -9.032787e-05 3 1  ON 68
ci_070                -2.328340e-04 3 1  ON 69
ci_071                -2.379693e-03 3 1  ON 70
ci_072                -2.021685e-03 3 1  ON 71
ci_073                 1.223331e-04 3 1  ON 72
ci_074                 1.196711e-04 3 1  ON 73
ci_075                -5.425242e-04 3 1  ON 74
ci_076                -1.849799e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="250">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =8000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 28
    time step          = 0.05
    reference energy   = -22.7722
    reference variance = 0.294308
====================================================
  Execution time = 1.0112e+02
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s028
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 62500 
  VMC Eavg = -2.2670e+01
  VMC Evar = 5.1229e-01
  Total weights = 7.8219e+06
  Execution time = 1.4466e+01
  </log>
</opt>
<opt stage="main" walkers="62500">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.498657825304
                                         uncertainty =       0.001514526694

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.498657825304
                                         uncertainty =       0.001514526694

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000249665161
  error estimate for blocks of size 2^( 2) =       0.000258584961
  error estimate for blocks of size 2^( 3) =       0.000266640394
  error estimate for blocks of size 2^( 4) =       0.000272379786
  error estimate for blocks of size 2^( 5) =       0.000275547461
  error estimate for blocks of size 2^( 6) =       0.000277414052
  error estimate for blocks of size 2^( 7) =       0.000278527005
  error estimate for blocks of size 2^( 8) =       0.000278064264
  error estimate for blocks of size 2^( 9) =       0.000278936401

      target function =                  N/A
              le_mean =     -22.669651881446
             les_mean =     514.426064962219
             stat err =       0.000278235431
             autocorr =       1.241963908160
              std dev =       0.706159714782
             le_variance =       0.498661542781

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.498638640936
                                         uncertainty =       0.001516259110

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.498638640936
                                         uncertainty =       0.001516259110

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000249660360
  error estimate for blocks of size 2^( 2) =       0.000258580154
  error estimate for blocks of size 2^( 3) =       0.000266635686
  error estimate for blocks of size 2^( 4) =       0.000272375553
  error estimate for blocks of size 2^( 5) =       0.000275542069
  error estimate for blocks of size 2^( 6) =       0.000277408042
  error estimate for blocks of size 2^( 7) =       0.000278519287
  error estimate for blocks of size 2^( 8) =       0.000278053241
  error estimate for blocks of size 2^( 9) =       0.000278924876

      target function =                  N/A
              le_mean =     -22.669652037184
             les_mean =     514.426103718127
             stat err =       0.000278226362
             autocorr =       1.241930711939
              std dev =       0.706146134932
             le_variance =       0.498642363879

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.498644533811
                                         uncertainty =       0.001515561513

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.498644533811
                                         uncertainty =       0.001515561513

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000249661835
  error estimate for blocks of size 2^( 2) =       0.000258581668
  error estimate for blocks of size 2^( 3) =       0.000266637197
  error estimate for blocks of size 2^( 4) =       0.000272376886
  error estimate for blocks of size 2^( 5) =       0.000275543870
  error estimate for blocks of size 2^( 6) =       0.000277409936
  error estimate for blocks of size 2^( 7) =       0.000278521615
  error estimate for blocks of size 2^( 8) =       0.000278057000
  error estimate for blocks of size 2^( 9) =       0.000278928778

      target function =                  N/A
              le_mean =     -22.669651745818
             les_mean =     514.425626177613
             stat err =       0.000278229332
             autocorr =       1.241942561967
              std dev =       0.706150305728
             le_variance =       0.498648254280

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.498655726531
                                         uncertainty =       0.001514657599

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.498655726531
                                         uncertainty =       0.001514657599

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000249664636
  error estimate for blocks of size 2^( 2) =       0.000258584408
  error estimate for blocks of size 2^( 3) =       0.000266639835
  error estimate for blocks of size 2^( 4) =       0.000272379211
  error estimate for blocks of size 2^( 5) =       0.000275546771
  error estimate for blocks of size 2^( 6) =       0.000277413339
  error estimate for blocks of size 2^( 7) =       0.000278526002
  error estimate for blocks of size 2^( 8) =       0.000278062913
  error estimate for blocks of size 2^( 9) =       0.000278935045

      target function =                  N/A
              le_mean =     -22.669651855236
             les_mean =     514.430002036348
             stat err =       0.000278234325
             autocorr =       1.241959264222
              std dev =       0.706158228996
             le_variance =       0.498659444379


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.669651881446        initial
     5.9605e-01     5.9605e+00             2.6425e-04       -22.669652037184  <--
     2.3842e+00     2.3842e+01             7.5534e-05       -22.669651745818
     9.5367e+00     9.5367e+01             1.9597e-05       -22.669651855236

*****************************************************************************
Applying the update for shift_i =   5.9605e-01     and shift_s =   5.9605e+00
*****************************************************************************

  Execution time = 1.7401e+02
  </log>
  <optVariables href="FORM.s028.opt.xml">
ci_001                -7.061651e-01 3 1  ON 0
ci_002                -7.050345e-01 3 1  ON 1
ci_003                -3.765890e-02 3 1  ON 2
ci_004                -3.812903e-02 3 1  ON 3
ci_005                 1.579425e-02 3 1  ON 4
ci_006                 1.570237e-02 3 1  ON 5
ci_007                 1.187222e-02 3 1  ON 6
ci_008                 1.240542e-02 3 1  ON 7
ci_009                -1.174928e-02 3 1  ON 8
ci_010                -1.158639e-02 3 1  ON 9
ci_011                -8.268946e-03 3 1  ON 10
ci_012                -8.199436e-03 3 1  ON 11
ci_013                 9.483298e-03 3 1  ON 12
ci_014                 9.417226e-03 3 1  ON 13
ci_015                 1.269818e-02 3 1  ON 14
ci_016                 1.227003e-02 3 1  ON 15
ci_017                 1.067760e-02 3 1  ON 16
ci_018                 1.090267e-02 3 1  ON 17
ci_019                -3.349584e-03 3 1  ON 18
ci_020                -3.904644e-03 3 1  ON 19
ci_021                -8.806343e-03 3 1  ON 20
ci_022                -8.855767e-03 3 1  ON 21
ci_023                 7.544039e-03 3 1  ON 22
ci_024                 8.142405e-03 3 1  ON 23
ci_025                 4.000584e-03 3 1  ON 24
ci_026                 4.154261e-03 3 1  ON 25
ci_027                 6.311244e-03 3 1  ON 26
ci_028                 6.357770e-03 3 1  ON 27
ci_029                -5.261136e-03 3 1  ON 28
ci_030                -4.648206e-03 3 1  ON 29
ci_031                -8.297221e-03 3 1  ON 30
ci_032                -8.172241e-03 3 1  ON 31
ci_033                 4.544231e-03 3 1  ON 32
ci_034                 4.038967e-03 3 1  ON 33
ci_035                 1.111316e-03 3 1  ON 34
ci_036                 1.235908e-03 3 1  ON 35
ci_037                 5.291413e-03 3 1  ON 36
ci_038                 5.054498e-03 3 1  ON 37
ci_039                 5.399877e-03 3 1  ON 38
ci_040                 5.504880e-03 3 1  ON 39
ci_041                 5.070262e-03 3 1  ON 40
ci_042                 5.270077e-03 3 1  ON 41
ci_043                 4.814447e-03 3 1  ON 42
ci_044                 4.806320e-03 3 1  ON 43
ci_045                 2.939556e-03 3 1  ON 44
ci_046                 2.967302e-03 3 1  ON 45
ci_047                -6.274191e-04 3 1  ON 46
ci_048                -7.074403e-04 3 1  ON 47
ci_049                 1.270403e-03 3 1  ON 48
ci_050                 1.629691e-03 3 1  ON 49
ci_051                -1.184800e-03 3 1  ON 50
ci_052                -1.380933e-03 3 1  ON 51
ci_053                -2.757195e-03 3 1  ON 52
ci_054                -2.681958e-03 3 1  ON 53
ci_055                -1.641554e-03 3 1  ON 54
ci_056                -1.344698e-03 3 1  ON 55
ci_057                -1.436256e-03 3 1  ON 56
ci_058                -1.347003e-03 3 1  ON 57
ci_059                 2.778341e-04 3 1  ON 58
ci_060                 1.759181e-04 3 1  ON 59
ci_061                -2.361976e-04 3 1  ON 60
ci_062                -2.139197e-04 3 1  ON 61
ci_063                -6.706799e-04 3 1  ON 62
ci_064                -6.421244e-04 3 1  ON 63
ci_065                -2.212997e-03 3 1  ON 64
ci_066                -2.448253e-03 3 1  ON 65
ci_067                -2.497360e-03 3 1  ON 66
ci_068                -2.226249e-03 3 1  ON 67
ci_069                -1.422351e-04 3 1  ON 68
ci_070                -1.674286e-04 3 1  ON 69
ci_071                -2.409991e-03 3 1  ON 70
ci_072                -2.034851e-03 3 1  ON 71
ci_073                 1.404304e-04 3 1  ON 72
ci_074                 1.640613e-04 3 1  ON 73
ci_075                -4.531219e-04 3 1  ON 74
ci_076                -1.963113e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 2.9251e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s029 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s029 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=29  my_counter=0
  time step      = 5.0000e-02
  blocks         = 250
  steps          = 250
  substeps       = 10
  current        = 0
  target samples = 8.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">250</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">6.2500e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">8.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">6.2500e+04</parameter>
<parameter name="steps" condition="int">250</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2674e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="250">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =8000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 29
    time step          = 0.05
    reference energy   = -22.731
    reference variance = 0.414417
====================================================
  Execution time = 9.9189e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s029
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 62500 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 6.1008e+04
  VMC Eavg = -2.2670e+01
  VMC Evar = 5.1069e-01
  Total weights = 7.820906269e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.8836e+01
  </log>
</opt>
<opt stage="main" walkers="62500">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.497108382362
                                         uncertainty =       0.001582247103

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.497108382362
                                         uncertainty =       0.001582247103

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000249275849
  error estimate for blocks of size 2^( 2) =       0.000258104801
  error estimate for blocks of size 2^( 3) =       0.000265970027
  error estimate for blocks of size 2^( 4) =       0.000271805701
  error estimate for blocks of size 2^( 5) =       0.000275233557
  error estimate for blocks of size 2^( 6) =       0.000277232402
  error estimate for blocks of size 2^( 7) =       0.000277906285
  error estimate for blocks of size 2^( 8) =       0.000279101434
  error estimate for blocks of size 2^( 9) =       0.000279859183

      target function =                  N/A
              le_mean =     -22.670183432175
             les_mean =     514.447902720140
             stat err =       0.000278524826
             autocorr =       1.248439251062
              std dev =       0.705058572559
             le_variance =       0.497107590740


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.267018343218e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.4901e-01, overlap shift 1.4901e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.670183432201       residual = 1.20e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.670184719343       residual = 4.94e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.670185061964       residual = 3.62e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.670185049625       residual = 1.30e-08           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.670185060420       residual = 9.37e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          4 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 1.4901e-01 is 1.801527e-03

solving harmonic davidson linear method for identity shift 5.9605e-01, overlap shift 5.9605e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.670183432201       residual = 1.20e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.670183961902       residual = 2.73e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.670184012400       residual = 7.56e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.670183996042       residual = 2.41e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 5.9605e-01 is 7.249387e-04

solving harmonic davidson linear method for identity shift 2.3842e+00, overlap shift 2.3842e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.670183432201       residual = 1.20e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.670183590138       residual = 2.81e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.670183591006       residual = 4.43e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.670183589762       residual = 1.50e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 2.3842e+00 is 2.140942e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.310679 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.1804e+02
  </log>
  <optVariables href="FORM.s029.opt.xml">
ci_001                -7.060893e-01 3 1  ON 0
ci_002                -7.051155e-01 3 1  ON 1
ci_003                -3.777780e-02 3 1  ON 2
ci_004                -3.773953e-02 3 1  ON 3
ci_005                 1.591931e-02 3 1  ON 4
ci_006                 1.572614e-02 3 1  ON 5
ci_007                 1.184813e-02 3 1  ON 6
ci_008                 1.230626e-02 3 1  ON 7
ci_009                -1.191247e-02 3 1  ON 8
ci_010                -1.165282e-02 3 1  ON 9
ci_011                -8.148104e-03 3 1  ON 10
ci_012                -8.135022e-03 3 1  ON 11
ci_013                 9.431262e-03 3 1  ON 12
ci_014                 9.218291e-03 3 1  ON 13
ci_015                 1.262225e-02 3 1  ON 14
ci_016                 1.248343e-02 3 1  ON 15
ci_017                 1.062505e-02 3 1  ON 16
ci_018                 1.095132e-02 3 1  ON 17
ci_019                -3.281165e-03 3 1  ON 18
ci_020                -3.841961e-03 3 1  ON 19
ci_021                -8.795365e-03 3 1  ON 20
ci_022                -8.901241e-03 3 1  ON 21
ci_023                 7.340188e-03 3 1  ON 22
ci_024                 8.276010e-03 3 1  ON 23
ci_025                 4.141530e-03 3 1  ON 24
ci_026                 4.078942e-03 3 1  ON 25
ci_027                 6.662465e-03 3 1  ON 26
ci_028                 6.670992e-03 3 1  ON 27
ci_029                -5.145565e-03 3 1  ON 28
ci_030                -4.503743e-03 3 1  ON 29
ci_031                -8.344385e-03 3 1  ON 30
ci_032                -8.061151e-03 3 1  ON 31
ci_033                 4.248713e-03 3 1  ON 32
ci_034                 4.014488e-03 3 1  ON 33
ci_035                 8.366631e-04 3 1  ON 34
ci_036                 1.360788e-03 3 1  ON 35
ci_037                 5.306534e-03 3 1  ON 36
ci_038                 4.914120e-03 3 1  ON 37
ci_039                 5.559313e-03 3 1  ON 38
ci_040                 5.552724e-03 3 1  ON 39
ci_041                 5.238114e-03 3 1  ON 40
ci_042                 5.355963e-03 3 1  ON 41
ci_043                 4.974688e-03 3 1  ON 42
ci_044                 4.751200e-03 3 1  ON 43
ci_045                 3.430049e-03 3 1  ON 44
ci_046                 3.101073e-03 3 1  ON 45
ci_047                -4.841505e-04 3 1  ON 46
ci_048                -7.978815e-04 3 1  ON 47
ci_049                 1.395494e-03 3 1  ON 48
ci_050                 1.589893e-03 3 1  ON 49
ci_051                -1.157682e-03 3 1  ON 50
ci_052                -1.026600e-03 3 1  ON 51
ci_053                -2.693798e-03 3 1  ON 52
ci_054                -2.600070e-03 3 1  ON 53
ci_055                -1.709521e-03 3 1  ON 54
ci_056                -1.520012e-03 3 1  ON 55
ci_057                -1.338196e-03 3 1  ON 56
ci_058                -1.492225e-03 3 1  ON 57
ci_059                 2.182950e-04 3 1  ON 58
ci_060                 1.987728e-05 3 1  ON 59
ci_061                -7.332630e-05 3 1  ON 60
ci_062                 5.110190e-04 3 1  ON 61
ci_063                -6.517515e-04 3 1  ON 62
ci_064                -6.181861e-04 3 1  ON 63
ci_065                -2.238714e-03 3 1  ON 64
ci_066                -2.283727e-03 3 1  ON 65
ci_067                -2.945353e-03 3 1  ON 66
ci_068                -2.304783e-03 3 1  ON 67
ci_069                -2.099141e-04 3 1  ON 68
ci_070                -2.473420e-04 3 1  ON 69
ci_071                -2.302533e-03 3 1  ON 70
ci_072                -2.482172e-03 3 1  ON 71
ci_073                 2.228420e-04 3 1  ON 72
ci_074                 2.553068e-04 3 1  ON 73
ci_075                -3.955821e-04 3 1  ON 74
ci_076                -2.518886e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="250">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =8000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 29
    time step          = 0.05
    reference energy   = -22.6154
    reference variance = 0.305136
====================================================
  Execution time = 1.0112e+02
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s029
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 62500 
  VMC Eavg = -2.2670e+01
  VMC Evar = 5.1597e-01
  Total weights = 7.8203e+06
  Execution time = 1.4435e+01
  </log>
</opt>
<opt stage="main" walkers="62500">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.513544869737
                                         uncertainty =       0.011877789065

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.513544869737
                                         uncertainty =       0.011877789065

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000253366669
  error estimate for blocks of size 2^( 2) =       0.000262125959
  error estimate for blocks of size 2^( 3) =       0.000269842304
  error estimate for blocks of size 2^( 4) =       0.000275427250
  error estimate for blocks of size 2^( 5) =       0.000278364159
  error estimate for blocks of size 2^( 6) =       0.000280027907
  error estimate for blocks of size 2^( 7) =       0.000281036115
  error estimate for blocks of size 2^( 8) =       0.000281621154
  error estimate for blocks of size 2^( 9) =       0.000281935878

      target function =                  N/A
              le_mean =     -22.669894655554
             les_mean =     527.926199799292
             stat err =       0.000281155263
             autocorr =       1.231383901431
              std dev =       0.716629160325
             le_variance =       0.513557353429

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.501707366004
                                         uncertainty =       0.001650281892

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.501707366004
                                         uncertainty =       0.001650281892

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000250426512
  error estimate for blocks of size 2^( 2) =       0.000259293765
  error estimate for blocks of size 2^( 3) =       0.000267096914
  error estimate for blocks of size 2^( 4) =       0.000272746069
  error estimate for blocks of size 2^( 5) =       0.000275697127
  error estimate for blocks of size 2^( 6) =       0.000277375322
  error estimate for blocks of size 2^( 7) =       0.000278453100
  error estimate for blocks of size 2^( 8) =       0.000279163843
  error estimate for blocks of size 2^( 9) =       0.000279502689

      target function =                  N/A
              le_mean =     -22.669857026689
             les_mean =     514.445390308477
             stat err =       0.000278623738
             autocorr =       1.237871657316
              std dev =       0.708313140679
             le_variance =       0.501707505259

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.501650757685
                                         uncertainty =       0.001650097830

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.501650757685
                                         uncertainty =       0.001650097830

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000250412384
  error estimate for blocks of size 2^( 2) =       0.000259279986
  error estimate for blocks of size 2^( 3) =       0.000267085139
  error estimate for blocks of size 2^( 4) =       0.000272735952
  error estimate for blocks of size 2^( 5) =       0.000275687774
  error estimate for blocks of size 2^( 6) =       0.000277363336
  error estimate for blocks of size 2^( 7) =       0.000278438952
  error estimate for blocks of size 2^( 8) =       0.000279151012
  error estimate for blocks of size 2^( 9) =       0.000279487218

      target function =                  N/A
              le_mean =     -22.669855985727
             les_mean =     514.440418585875
             stat err =       0.000278610130
             autocorr =       1.237890411924
              std dev =       0.708273179003
             le_variance =       0.501650896096

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.501616364247
                                         uncertainty =       0.001631922524

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.501616364247
                                         uncertainty =       0.001631922524

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000250403798
  error estimate for blocks of size 2^( 2) =       0.000259276465
  error estimate for blocks of size 2^( 3) =       0.000267086764
  error estimate for blocks of size 2^( 4) =       0.000272739688
  error estimate for blocks of size 2^( 5) =       0.000275691129
  error estimate for blocks of size 2^( 6) =       0.000277368981
  error estimate for blocks of size 2^( 7) =       0.000278445351
  error estimate for blocks of size 2^( 8) =       0.000279146924
  error estimate for blocks of size 2^( 9) =       0.000279475398

      target function =                  N/A
              le_mean =     -22.669856009568
             les_mean =     514.440827910278
             stat err =       0.000278609164
             autocorr =       1.237966718087
              std dev =       0.708248894719
             le_variance =       0.501616496870


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.669894655554        initial  <--
     1.4901e-01     1.4901e+00             1.8015e-03       -22.669857026689
     5.9605e-01     5.9605e+00             7.2494e-04       -22.669855985727
     2.3842e+00     2.3842e+01             2.1409e-04       -22.669856009568

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 173.4924
  </log>
  <optVariables href="FORM.s029.opt.xml">
ci_001                -7.061651e-01 3 1  ON 0
ci_002                -7.050345e-01 3 1  ON 1
ci_003                -3.765890e-02 3 1  ON 2
ci_004                -3.812903e-02 3 1  ON 3
ci_005                 1.579425e-02 3 1  ON 4
ci_006                 1.570237e-02 3 1  ON 5
ci_007                 1.187222e-02 3 1  ON 6
ci_008                 1.240542e-02 3 1  ON 7
ci_009                -1.174928e-02 3 1  ON 8
ci_010                -1.158639e-02 3 1  ON 9
ci_011                -8.268946e-03 3 1  ON 10
ci_012                -8.199436e-03 3 1  ON 11
ci_013                 9.483298e-03 3 1  ON 12
ci_014                 9.417226e-03 3 1  ON 13
ci_015                 1.269818e-02 3 1  ON 14
ci_016                 1.227003e-02 3 1  ON 15
ci_017                 1.067760e-02 3 1  ON 16
ci_018                 1.090267e-02 3 1  ON 17
ci_019                -3.349584e-03 3 1  ON 18
ci_020                -3.904644e-03 3 1  ON 19
ci_021                -8.806343e-03 3 1  ON 20
ci_022                -8.855767e-03 3 1  ON 21
ci_023                 7.544039e-03 3 1  ON 22
ci_024                 8.142405e-03 3 1  ON 23
ci_025                 4.000584e-03 3 1  ON 24
ci_026                 4.154261e-03 3 1  ON 25
ci_027                 6.311244e-03 3 1  ON 26
ci_028                 6.357770e-03 3 1  ON 27
ci_029                -5.261136e-03 3 1  ON 28
ci_030                -4.648206e-03 3 1  ON 29
ci_031                -8.297221e-03 3 1  ON 30
ci_032                -8.172241e-03 3 1  ON 31
ci_033                 4.544231e-03 3 1  ON 32
ci_034                 4.038967e-03 3 1  ON 33
ci_035                 1.111316e-03 3 1  ON 34
ci_036                 1.235908e-03 3 1  ON 35
ci_037                 5.291413e-03 3 1  ON 36
ci_038                 5.054498e-03 3 1  ON 37
ci_039                 5.399877e-03 3 1  ON 38
ci_040                 5.504880e-03 3 1  ON 39
ci_041                 5.070262e-03 3 1  ON 40
ci_042                 5.270077e-03 3 1  ON 41
ci_043                 4.814447e-03 3 1  ON 42
ci_044                 4.806320e-03 3 1  ON 43
ci_045                 2.939556e-03 3 1  ON 44
ci_046                 2.967302e-03 3 1  ON 45
ci_047                -6.274191e-04 3 1  ON 46
ci_048                -7.074403e-04 3 1  ON 47
ci_049                 1.270403e-03 3 1  ON 48
ci_050                 1.629691e-03 3 1  ON 49
ci_051                -1.184800e-03 3 1  ON 50
ci_052                -1.380933e-03 3 1  ON 51
ci_053                -2.757195e-03 3 1  ON 52
ci_054                -2.681958e-03 3 1  ON 53
ci_055                -1.641554e-03 3 1  ON 54
ci_056                -1.344698e-03 3 1  ON 55
ci_057                -1.436256e-03 3 1  ON 56
ci_058                -1.347003e-03 3 1  ON 57
ci_059                 2.778341e-04 3 1  ON 58
ci_060                 1.759181e-04 3 1  ON 59
ci_061                -2.361976e-04 3 1  ON 60
ci_062                -2.139197e-04 3 1  ON 61
ci_063                -6.706799e-04 3 1  ON 62
ci_064                -6.421244e-04 3 1  ON 63
ci_065                -2.212997e-03 3 1  ON 64
ci_066                -2.448253e-03 3 1  ON 65
ci_067                -2.497360e-03 3 1  ON 66
ci_068                -2.226249e-03 3 1  ON 67
ci_069                -1.422351e-04 3 1  ON 68
ci_070                -1.674286e-04 3 1  ON 69
ci_071                -2.409991e-03 3 1  ON 70
ci_072                -2.034851e-03 3 1  ON 71
ci_073                 1.404304e-04 3 1  ON 72
ci_074                 1.640613e-04 3 1  ON 73
ci_075                -4.531219e-04 3 1  ON 74
ci_076                -1.963113e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 2.9160e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s030 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s030 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=30  my_counter=0
  time step      = 5.0000e-02
  blocks         = 250
  steps          = 250
  substeps       = 10
  current        = 0
  target samples = 8.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">250</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">6.2500e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">8.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">6.2500e+04</parameter>
<parameter name="steps" condition="int">250</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2674e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="250">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =8000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 30
    time step          = 0.05
    reference energy   = -22.7125
    reference variance = 1.00653
====================================================
  Execution time = 1.0082e+02
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s030
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 62500 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 6.1113e+04
  VMC Eavg = -2.2670e+01
  VMC Evar = 5.1172e-01
  Total weights = 7.820570008e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.8824e+01
  </log>
</opt>
<opt stage="main" walkers="62500">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.499168734081
                                         uncertainty =       0.001451821299

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.499168734081
                                         uncertainty =       0.001451821299

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000249791666
  error estimate for blocks of size 2^( 2) =       0.000258711078
  error estimate for blocks of size 2^( 3) =       0.000266663062
  error estimate for blocks of size 2^( 4) =       0.000272655192
  error estimate for blocks of size 2^( 5) =       0.000275901236
  error estimate for blocks of size 2^( 6) =       0.000278057393
  error estimate for blocks of size 2^( 7) =       0.000279148543
  error estimate for blocks of size 2^( 8) =       0.000279619963
  error estimate for blocks of size 2^( 9) =       0.000280609714

      target function =                  N/A
              le_mean =     -22.669778797359
             les_mean =     514.430591006488
             stat err =       0.000279358903
             autocorr =       1.250746061606
              std dev =       0.706517524411
             le_variance =       0.499167012299


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266977879736e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.4901e+00, overlap shift 1.4901e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.669778797382       residual = 3.75e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.669779423688       residual = 4.87e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.669779377580       residual = 1.25e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.669779367912       residual = 4.38e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 1.4901e+00 is 1.333174e-04

solving harmonic davidson linear method for identity shift 5.9605e+00, overlap shift 5.9605e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.669778797382       residual = 3.75e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.669778967438       residual = 5.61e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.669778958925       residual = 1.58e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.669778955361       residual = 5.36e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 5.9605e+00 is 3.736836e-05

solving harmonic davidson linear method for identity shift 2.3842e+01, overlap shift 2.3842e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.669778797382       residual = 3.75e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.669778840831       residual = 5.91e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.669778838956       residual = 1.75e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.669778837984       residual = 6.00e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 2.3842e+01 is 9.639802e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.312043 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.1967e+02
  </log>
  <optVariables href="FORM.s030.opt.xml">
ci_001                -7.061685e-01 3 1  ON 0
ci_002                -7.050310e-01 3 1  ON 1
ci_003                -3.766644e-02 3 1  ON 2
ci_004                -3.812906e-02 3 1  ON 3
ci_005                 1.580265e-02 3 1  ON 4
ci_006                 1.569360e-02 3 1  ON 5
ci_007                 1.189109e-02 3 1  ON 6
ci_008                 1.238739e-02 3 1  ON 7
ci_009                -1.175589e-02 3 1  ON 8
ci_010                -1.159848e-02 3 1  ON 9
ci_011                -8.254828e-03 3 1  ON 10
ci_012                -8.193374e-03 3 1  ON 11
ci_013                 9.491954e-03 3 1  ON 12
ci_014                 9.427271e-03 3 1  ON 13
ci_015                 1.268151e-02 3 1  ON 14
ci_016                 1.226587e-02 3 1  ON 15
ci_017                 1.068474e-02 3 1  ON 16
ci_018                 1.091487e-02 3 1  ON 17
ci_019                -3.347410e-03 3 1  ON 18
ci_020                -3.896448e-03 3 1  ON 19
ci_021                -8.815573e-03 3 1  ON 20
ci_022                -8.859847e-03 3 1  ON 21
ci_023                 7.556141e-03 3 1  ON 22
ci_024                 8.105966e-03 3 1  ON 23
ci_025                 3.994877e-03 3 1  ON 24
ci_026                 4.168658e-03 3 1  ON 25
ci_027                 6.339148e-03 3 1  ON 26
ci_028                 6.350135e-03 3 1  ON 27
ci_029                -5.269376e-03 3 1  ON 28
ci_030                -4.672074e-03 3 1  ON 29
ci_031                -8.272187e-03 3 1  ON 30
ci_032                -8.161015e-03 3 1  ON 31
ci_033                 4.545368e-03 3 1  ON 32
ci_034                 4.056849e-03 3 1  ON 33
ci_035                 1.099931e-03 3 1  ON 34
ci_036                 1.243973e-03 3 1  ON 35
ci_037                 5.285126e-03 3 1  ON 36
ci_038                 5.052405e-03 3 1  ON 37
ci_039                 5.362509e-03 3 1  ON 38
ci_040                 5.485534e-03 3 1  ON 39
ci_041                 5.049993e-03 3 1  ON 40
ci_042                 5.253815e-03 3 1  ON 41
ci_043                 4.829417e-03 3 1  ON 42
ci_044                 4.810196e-03 3 1  ON 43
ci_045                 2.945288e-03 3 1  ON 44
ci_046                 2.969449e-03 3 1  ON 45
ci_047                -6.440293e-04 3 1  ON 46
ci_048                -7.081154e-04 3 1  ON 47
ci_049                 1.280964e-03 3 1  ON 48
ci_050                 1.635161e-03 3 1  ON 49
ci_051                -1.184241e-03 3 1  ON 50
ci_052                -1.382316e-03 3 1  ON 51
ci_053                -2.748226e-03 3 1  ON 52
ci_054                -2.688128e-03 3 1  ON 53
ci_055                -1.640593e-03 3 1  ON 54
ci_056                -1.340986e-03 3 1  ON 55
ci_057                -1.456615e-03 3 1  ON 56
ci_058                -1.358706e-03 3 1  ON 57
ci_059                 2.794762e-04 3 1  ON 58
ci_060                 1.782119e-04 3 1  ON 59
ci_061                -2.131337e-04 3 1  ON 60
ci_062                -2.101496e-04 3 1  ON 61
ci_063                -6.549906e-04 3 1  ON 62
ci_064                -6.393379e-04 3 1  ON 63
ci_065                -2.228488e-03 3 1  ON 64
ci_066                -2.445943e-03 3 1  ON 65
ci_067                -2.491345e-03 3 1  ON 66
ci_068                -2.227730e-03 3 1  ON 67
ci_069                -1.359256e-04 3 1  ON 68
ci_070                -1.745894e-04 3 1  ON 69
ci_071                -2.414555e-03 3 1  ON 70
ci_072                -2.031587e-03 3 1  ON 71
ci_073                 1.408060e-04 3 1  ON 72
ci_074                 1.654573e-04 3 1  ON 73
ci_075                -4.528314e-04 3 1  ON 74
ci_076                -1.973200e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="250">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =8000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 30
    time step          = 0.05
    reference energy   = -22.6941
    reference variance = 0.534654
====================================================
  Execution time = 1.0076e+02
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s030
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 62500 
  VMC Eavg = -2.2670e+01
  VMC Evar = 5.1428e-01
  Total weights = 7.8202e+06
  Execution time = 1.4427e+01
  </log>
</opt>
<opt stage="main" walkers="62500">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

ERROR CostFunction-> Number of Effective Walkers is too small! 
  Number of effective walkers (samples) / total number of samples = 2.04928e-05
  User specified threshold minwalkers = 0.3
  If this message appears frequently. You might have to be cautious. 
  Find info about parameter "minwalkers" in the user manual!
Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.501307644739
                                         uncertainty =       0.001442194616

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.501307644739
                                         uncertainty =       0.001442194616

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000250327620
  error estimate for blocks of size 2^( 2) =       0.000259238468
  error estimate for blocks of size 2^( 3) =       0.000267342894
  error estimate for blocks of size 2^( 4) =       0.000272845639
  error estimate for blocks of size 2^( 5) =       0.000276164248
  error estimate for blocks of size 2^( 6) =       0.000277528369
  error estimate for blocks of size 2^( 7) =       0.000278420086
  error estimate for blocks of size 2^( 8) =       0.000279367377
  error estimate for blocks of size 2^( 9) =       0.000279862318

      target function =                  N/A
              le_mean =     -22.669707149089
             les_mean =     514.429921687756
             stat err =       0.000278794537
             autocorr =       1.240369212783
              std dev =       0.708033431875
             le_variance =       0.501311340653

ERROR CostFunction-> Number of Effective Walkers is too small! 
  Number of effective walkers (samples) / total number of samples = 1.6651e-05
  User specified threshold minwalkers = 0.3
  If this message appears frequently. You might have to be cautious. 
  Find info about parameter "minwalkers" in the user manual!
Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.501304032791
                                         uncertainty =       0.001446657771

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.501304032791
                                         uncertainty =       0.001446657771

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000250326717
  error estimate for blocks of size 2^( 2) =       0.000259237747
  error estimate for blocks of size 2^( 3) =       0.000267342491
  error estimate for blocks of size 2^( 4) =       0.000272846444
  error estimate for blocks of size 2^( 5) =       0.000276164562
  error estimate for blocks of size 2^( 6) =       0.000277528649
  error estimate for blocks of size 2^( 7) =       0.000278420080
  error estimate for blocks of size 2^( 8) =       0.000279369836
  error estimate for blocks of size 2^( 9) =       0.000279865609

      target function =                  N/A
              le_mean =     -22.669708343971
             les_mean =     514.433842246885
             stat err =       0.000278796044
             autocorr =       1.240391572931
              std dev =       0.708030875191
             le_variance =       0.501307720224

ERROR CostFunction-> Number of Effective Walkers is too small! 
  Number of effective walkers (samples) / total number of samples = 2.04953e-05
  User specified threshold minwalkers = 0.3
  If this message appears frequently. You might have to be cautious. 
  Find info about parameter "minwalkers" in the user manual!
Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.501304821560
                                         uncertainty =       0.001444545191

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.501304821560
                                         uncertainty =       0.001444545191

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000250326914
  error estimate for blocks of size 2^( 2) =       0.000259237862
  error estimate for blocks of size 2^( 3) =       0.000267342494
  error estimate for blocks of size 2^( 4) =       0.000272845825
  error estimate for blocks of size 2^( 5) =       0.000276164143
  error estimate for blocks of size 2^( 6) =       0.000277528230
  error estimate for blocks of size 2^( 7) =       0.000278419445
  error estimate for blocks of size 2^( 8) =       0.000279367675
  error estimate for blocks of size 2^( 9) =       0.000279862678

      target function =                  N/A
              le_mean =     -22.669707638287
             les_mean =     514.430848107151
             stat err =       0.000278794507
             autocorr =       1.240375940749
              std dev =       0.708031434802
             le_variance =       0.501308512667

ERROR CostFunction-> Number of Effective Walkers is too small! 
  Number of effective walkers (samples) / total number of samples = 2.45721e-05
  User specified threshold minwalkers = 0.3
  If this message appears frequently. You might have to be cautious. 
  Find info about parameter "minwalkers" in the user manual!
Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.501307169209
                                         uncertainty =       0.001442482417

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.501307169209
                                         uncertainty =       0.001442482417

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000250327502
  error estimate for blocks of size 2^( 2) =       0.000259238363
  error estimate for blocks of size 2^( 3) =       0.000267342816
  error estimate for blocks of size 2^( 4) =       0.000272845637
  error estimate for blocks of size 2^( 5) =       0.000276164211
  error estimate for blocks of size 2^( 6) =       0.000277528329
  error estimate for blocks of size 2^( 7) =       0.000278419989
  error estimate for blocks of size 2^( 8) =       0.000279367400
  error estimate for blocks of size 2^( 9) =       0.000279862351

      target function =                  N/A
              le_mean =     -22.669707203370
             les_mean =     514.429934514926
             stat err =       0.000278794517
             autocorr =       1.240370212317
              std dev =       0.708033095619
             le_variance =       0.501310864491


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.669707149089        initial
     1.4901e+00     1.4901e+01             1.3332e-04       -22.669708343971  <--
     5.9605e+00     5.9605e+01             3.7368e-05       -22.669707638287
     2.3842e+01     2.3842e+02             9.6398e-06       -22.669707203370

*****************************************************************************
Applying the update for shift_i =   1.4901e+00     and shift_s =   1.4901e+01
*****************************************************************************

  Execution time = 1.7315e+02
  </log>
  <optVariables href="FORM.s030.opt.xml">
ci_001                -7.061791e-01 3 1  ON 0
ci_002                -7.050200e-01 3 1  ON 1
ci_003                -3.768774e-02 3 1  ON 2
ci_004                -3.812930e-02 3 1  ON 3
ci_005                 1.582422e-02 3 1  ON 4
ci_006                 1.567136e-02 3 1  ON 5
ci_007                 1.194250e-02 3 1  ON 6
ci_008                 1.233809e-02 3 1  ON 7
ci_009                -1.177465e-02 3 1  ON 8
ci_010                -1.163253e-02 3 1  ON 9
ci_011                -8.216483e-03 3 1  ON 10
ci_012                -8.176484e-03 3 1  ON 11
ci_013                 9.516094e-03 3 1  ON 12
ci_014                 9.455404e-03 3 1  ON 13
ci_015                 1.263463e-02 3 1  ON 14
ci_016                 1.225414e-02 3 1  ON 15
ci_017                 1.070436e-02 3 1  ON 16
ci_018                 1.094918e-02 3 1  ON 17
ci_019                -3.340730e-03 3 1  ON 18
ci_020                -3.874114e-03 3 1  ON 19
ci_021                -8.842303e-03 3 1  ON 20
ci_022                -8.872023e-03 3 1  ON 21
ci_023                 7.588266e-03 3 1  ON 22
ci_024                 8.009088e-03 3 1  ON 23
ci_025                 3.978336e-03 3 1  ON 24
ci_026                 4.207870e-03 3 1  ON 25
ci_027                 6.410273e-03 3 1  ON 26
ci_028                 6.331325e-03 3 1  ON 27
ci_029                -5.291540e-03 3 1  ON 28
ci_030                -4.737531e-03 3 1  ON 29
ci_031                -8.202771e-03 3 1  ON 30
ci_032                -8.129595e-03 3 1  ON 31
ci_033                 4.548319e-03 3 1  ON 32
ci_034                 4.105546e-03 3 1  ON 33
ci_035                 1.070967e-03 3 1  ON 34
ci_036                 1.264335e-03 3 1  ON 35
ci_037                 5.268226e-03 3 1  ON 36
ci_038                 5.047020e-03 3 1  ON 37
ci_039                 5.266843e-03 3 1  ON 38
ci_040                 5.436549e-03 3 1  ON 39
ci_041                 4.996717e-03 3 1  ON 40
ci_042                 5.211271e-03 3 1  ON 41
ci_043                 4.869482e-03 3 1  ON 42
ci_044                 4.820290e-03 3 1  ON 43
ci_045                 2.960492e-03 3 1  ON 44
ci_046                 2.974427e-03 3 1  ON 45
ci_047                -6.865577e-04 3 1  ON 46
ci_048                -7.093484e-04 3 1  ON 47
ci_049                 1.310142e-03 3 1  ON 48
ci_050                 1.649749e-03 3 1  ON 49
ci_051                -1.183136e-03 3 1  ON 50
ci_052                -1.385643e-03 3 1  ON 51
ci_053                -2.724746e-03 3 1  ON 52
ci_054                -2.705155e-03 3 1  ON 53
ci_055                -1.638711e-03 3 1  ON 54
ci_056                -1.331603e-03 3 1  ON 55
ci_057                -1.510688e-03 3 1  ON 56
ci_058                -1.389956e-03 3 1  ON 57
ci_059                 2.835817e-04 3 1  ON 58
ci_060                 1.839514e-04 3 1  ON 59
ci_061                -1.508509e-04 3 1  ON 60
ci_062                -2.002412e-04 3 1  ON 61
ci_063                -6.118578e-04 3 1  ON 62
ci_064                -6.314820e-04 3 1  ON 63
ci_065                -2.270115e-03 3 1  ON 64
ci_066                -2.439137e-03 3 1  ON 65
ci_067                -2.475038e-03 3 1  ON 66
ci_068                -2.231837e-03 3 1  ON 67
ci_069                -1.186750e-04 3 1  ON 68
ci_070                -1.936971e-04 3 1  ON 69
ci_071                -2.427298e-03 3 1  ON 70
ci_072                -2.022177e-03 3 1  ON 71
ci_073                 1.415839e-04 3 1  ON 72
ci_074                 1.687587e-04 3 1  ON 73
ci_075                -4.520624e-04 3 1  ON 74
ci_076                -1.998395e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 2.9282e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s031 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s031 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=31  my_counter=0
  time step      = 5.0000e-02
  blocks         = 250
  steps          = 250
  substeps       = 10
  current        = 0
  target samples = 8.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">250</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">6.2500e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">8.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">6.2500e+04</parameter>
<parameter name="steps" condition="int">250</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2675e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="250">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =8000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 31
    time step          = 0.05
    reference energy   = -22.838
    reference variance = 1.72557
====================================================
  Execution time = 1.0094e+02
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s031
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 62500 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 6.1059e+04
  VMC Eavg = -2.2670e+01
  VMC Evar = 5.1203e-01
  Total weights = 7.821077928e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.8743e+01
  </log>
</opt>
<opt stage="main" walkers="62500">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.499505355716
                                         uncertainty =       0.001406828999

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.499505355716
                                         uncertainty =       0.001406828999

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000249875973
  error estimate for blocks of size 2^( 2) =       0.000258746290
  error estimate for blocks of size 2^( 3) =       0.000266744610
  error estimate for blocks of size 2^( 4) =       0.000272216540
  error estimate for blocks of size 2^( 5) =       0.000275346985
  error estimate for blocks of size 2^( 6) =       0.000277012179
  error estimate for blocks of size 2^( 7) =       0.000278411134
  error estimate for blocks of size 2^( 8) =       0.000278558283
  error estimate for blocks of size 2^( 9) =       0.000278607030

      target function =                  N/A
              le_mean =     -22.669969932696
             les_mean =     514.439570681276
             stat err =       0.000278147157
             autocorr =       1.239082580074
              std dev =       0.706755980900
             le_variance =       0.499504016538


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266996993270e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.7253e-01, overlap shift 3.7253e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.669969932724       residual = 7.39e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.669973359958       residual = 6.49e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.669973139016       residual = 1.39e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.669973179767       residual = 4.30e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 3.7253e-01 is 7.967603e-04

solving harmonic davidson linear method for identity shift 1.4901e+00, overlap shift 1.4901e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.669969932724       residual = 7.39e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.669971020259       residual = 5.57e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.669970991588       residual = 8.87e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 1.4901e+00 is 2.506688e-04

solving harmonic davidson linear method for identity shift 5.9605e+00, overlap shift 5.9605e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.669969932724       residual = 7.39e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.669970224232       residual = 6.37e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.669970221076       residual = 1.03e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.669970222942       residual = 1.79e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 5.9605e+00 is 6.731439e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.316379 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.1971e+02
  </log>
  <optVariables href="FORM.s031.opt.xml">
ci_001                -7.062212e-01 3 1  ON 0
ci_002                -7.049828e-01 3 1  ON 1
ci_003                -3.765969e-02 3 1  ON 2
ci_004                -3.809097e-02 3 1  ON 3
ci_005                 1.581023e-02 3 1  ON 4
ci_006                 1.572169e-02 3 1  ON 5
ci_007                 1.197142e-02 3 1  ON 6
ci_008                 1.231071e-02 3 1  ON 7
ci_009                -1.174784e-02 3 1  ON 8
ci_010                -1.168432e-02 3 1  ON 9
ci_011                -8.192519e-03 3 1  ON 10
ci_012                -8.201877e-03 3 1  ON 11
ci_013                 9.574186e-03 3 1  ON 12
ci_014                 9.394808e-03 3 1  ON 13
ci_015                 1.261704e-02 3 1  ON 14
ci_016                 1.236951e-02 3 1  ON 15
ci_017                 1.059220e-02 3 1  ON 16
ci_018                 1.090635e-02 3 1  ON 17
ci_019                -3.352275e-03 3 1  ON 18
ci_020                -3.804271e-03 3 1  ON 19
ci_021                -8.809516e-03 3 1  ON 20
ci_022                -8.877302e-03 3 1  ON 21
ci_023                 7.539497e-03 3 1  ON 22
ci_024                 7.925600e-03 3 1  ON 23
ci_025                 4.104643e-03 3 1  ON 24
ci_026                 4.183860e-03 3 1  ON 25
ci_027                 6.411940e-03 3 1  ON 26
ci_028                 6.346524e-03 3 1  ON 27
ci_029                -5.200859e-03 3 1  ON 28
ci_030                -4.691260e-03 3 1  ON 29
ci_031                -8.148752e-03 3 1  ON 30
ci_032                -8.210410e-03 3 1  ON 31
ci_033                 4.507246e-03 3 1  ON 32
ci_034                 4.085907e-03 3 1  ON 33
ci_035                 1.093151e-03 3 1  ON 34
ci_036                 1.214877e-03 3 1  ON 35
ci_037                 5.263673e-03 3 1  ON 36
ci_038                 5.016762e-03 3 1  ON 37
ci_039                 5.259176e-03 3 1  ON 38
ci_040                 5.439431e-03 3 1  ON 39
ci_041                 5.106054e-03 3 1  ON 40
ci_042                 5.144037e-03 3 1  ON 41
ci_043                 4.922924e-03 3 1  ON 42
ci_044                 4.803344e-03 3 1  ON 43
ci_045                 2.950231e-03 3 1  ON 44
ci_046                 2.999625e-03 3 1  ON 45
ci_047                -6.911981e-04 3 1  ON 46
ci_048                -7.257297e-04 3 1  ON 47
ci_049                 1.206636e-03 3 1  ON 48
ci_050                 1.645700e-03 3 1  ON 49
ci_051                -1.098438e-03 3 1  ON 50
ci_052                -1.400728e-03 3 1  ON 51
ci_053                -2.791875e-03 3 1  ON 52
ci_054                -2.716267e-03 3 1  ON 53
ci_055                -1.622071e-03 3 1  ON 54
ci_056                -1.460167e-03 3 1  ON 55
ci_057                -1.472191e-03 3 1  ON 56
ci_058                -1.491716e-03 3 1  ON 57
ci_059                 2.571773e-04 3 1  ON 58
ci_060                 2.183765e-04 3 1  ON 59
ci_061                -1.634501e-04 3 1  ON 60
ci_062                -2.370828e-04 3 1  ON 61
ci_063                -8.625266e-04 3 1  ON 62
ci_064                -6.211703e-04 3 1  ON 63
ci_065                -2.220943e-03 3 1  ON 64
ci_066                -2.385291e-03 3 1  ON 65
ci_067                -2.542039e-03 3 1  ON 66
ci_068                -2.294821e-03 3 1  ON 67
ci_069                -1.270603e-04 3 1  ON 68
ci_070                -1.355909e-04 3 1  ON 69
ci_071                -2.355195e-03 3 1  ON 70
ci_072                -1.997462e-03 3 1  ON 71
ci_073                 2.053387e-04 3 1  ON 72
ci_074                 1.602410e-04 3 1  ON 73
ci_075                -4.913295e-04 3 1  ON 74
ci_076                -1.647674e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="250">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =8000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 31
    time step          = 0.05
    reference energy   = -22.6621
    reference variance = 0.316466
====================================================
  Execution time = 1.0060e+02
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s031
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 62500 
  VMC Eavg = -2.2670e+01
  VMC Evar = 5.0995e-01
  Total weights = 7.8209e+06
  Execution time = 1.4400e+01
  </log>
</opt>
<opt stage="main" walkers="62500">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.496774363236
                                         uncertainty =       0.001440557703

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.496774363236
                                         uncertainty =       0.001440557703

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000249192529
  error estimate for blocks of size 2^( 2) =       0.000258023523
  error estimate for blocks of size 2^( 3) =       0.000266020594
  error estimate for blocks of size 2^( 4) =       0.000271792493
  error estimate for blocks of size 2^( 5) =       0.000274787197
  error estimate for blocks of size 2^( 6) =       0.000276841318
  error estimate for blocks of size 2^( 7) =       0.000278071331
  error estimate for blocks of size 2^( 8) =       0.000277988114
  error estimate for blocks of size 2^( 9) =       0.000277922084

      target function =                  N/A
              le_mean =     -22.669732508279
             les_mean =     514.431708031802
             stat err =       0.000277705712
             autocorr =       1.241937068952
              std dev =       0.704822907598
             le_variance =       0.496775331076

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.496850215004
                                         uncertainty =       0.001453412429

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.496850215004
                                         uncertainty =       0.001453412429

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000249211548
  error estimate for blocks of size 2^( 2) =       0.000258039501
  error estimate for blocks of size 2^( 3) =       0.000266035535
  error estimate for blocks of size 2^( 4) =       0.000271805658
  error estimate for blocks of size 2^( 5) =       0.000274799698
  error estimate for blocks of size 2^( 6) =       0.000276854255
  error estimate for blocks of size 2^( 7) =       0.000278088919
  error estimate for blocks of size 2^( 8) =       0.000278012796
  error estimate for blocks of size 2^( 9) =       0.000277950213

      target function =                  N/A
              le_mean =     -22.669735083901
             les_mean =     514.429350796732
             stat err =       0.000277726546
             autocorr =       1.241933834744
              std dev =       0.704876702873
             le_variance =       0.496851166252

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.496808020644
                                         uncertainty =       0.001448350383

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.496808020644
                                         uncertainty =       0.001448350383

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000249200968
  error estimate for blocks of size 2^( 2) =       0.000258030156
  error estimate for blocks of size 2^( 3) =       0.000266026635
  error estimate for blocks of size 2^( 4) =       0.000271797469
  error estimate for blocks of size 2^( 5) =       0.000274791771
  error estimate for blocks of size 2^( 6) =       0.000276846290
  error estimate for blocks of size 2^( 7) =       0.000278079041
  error estimate for blocks of size 2^( 8) =       0.000278000040
  error estimate for blocks of size 2^( 9) =       0.000277934169

      target function =                  N/A
              le_mean =     -22.669733449952
             les_mean =     514.428506855128
             stat err =       0.000277714885
             autocorr =       1.241935000061
              std dev =       0.704846777125
             le_variance =       0.496808979223

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.496776345593
                                         uncertainty =       0.001441491737

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.496776345593
                                         uncertainty =       0.001441491737

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000249193026
  error estimate for blocks of size 2^( 2) =       0.000258023815
  error estimate for blocks of size 2^( 3) =       0.000266020732
  error estimate for blocks of size 2^( 4) =       0.000271792471
  error estimate for blocks of size 2^( 5) =       0.000274787266
  error estimate for blocks of size 2^( 6) =       0.000276841519
  error estimate for blocks of size 2^( 7) =       0.000278071881
  error estimate for blocks of size 2^( 8) =       0.000277988752
  error estimate for blocks of size 2^( 9) =       0.000277922388

      target function =                  N/A
              le_mean =     -22.669732620501
             les_mean =     514.427216566103
             stat err =       0.000277706135
             autocorr =       1.241935902152
              std dev =       0.704824313127
             le_variance =       0.496777312375


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.669732508279        initial
     3.7253e-01     3.7253e+00             7.9676e-04       -22.669735083901  <--
     1.4901e+00     1.4901e+01             2.5067e-04       -22.669733449952
     5.9605e+00     5.9605e+01             6.7314e-05       -22.669732620501

*****************************************************************************
Applying the update for shift_i =   3.7253e-01     and shift_s =   3.7253e+00
*****************************************************************************

  Execution time = 1.7289e+02
  </log>
  <optVariables href="FORM.s031.opt.xml">
ci_001                -7.063456e-01 3 1  ON 0
ci_002                -7.048712e-01 3 1  ON 1
ci_003                -3.758118e-02 3 1  ON 2
ci_004                -3.798696e-02 3 1  ON 3
ci_005                 1.578654e-02 3 1  ON 4
ci_006                 1.581435e-02 3 1  ON 5
ci_007                 1.202093e-02 3 1  ON 6
ci_008                 1.225230e-02 3 1  ON 7
ci_009                -1.168013e-02 3 1  ON 8
ci_010                -1.178163e-02 3 1  ON 9
ci_011                -8.139914e-03 3 1  ON 10
ci_012                -8.252681e-03 3 1  ON 11
ci_013                 9.690550e-03 3 1  ON 12
ci_014                 9.260302e-03 3 1  ON 13
ci_015                 1.258157e-02 3 1  ON 14
ci_016                 1.264990e-02 3 1  ON 15
ci_017                 1.032467e-02 3 1  ON 16
ci_018                 1.080995e-02 3 1  ON 17
ci_019                -3.393689e-03 3 1  ON 18
ci_020                -3.642060e-03 3 1  ON 19
ci_021                -8.736166e-03 3 1  ON 20
ci_022                -8.886624e-03 3 1  ON 21
ci_023                 7.439618e-03 3 1  ON 22
ci_024                 7.761104e-03 3 1  ON 23
ci_025                 4.394050e-03 3 1  ON 24
ci_026                 4.126861e-03 3 1  ON 25
ci_027                 6.414224e-03 3 1  ON 26
ci_028                 6.371784e-03 3 1  ON 27
ci_029                -5.012618e-03 3 1  ON 28
ci_030                -4.603829e-03 3 1  ON 29
ci_031                -8.035949e-03 3 1  ON 30
ci_032                -8.390181e-03 3 1  ON 31
ci_033                 4.426358e-03 3 1  ON 32
ci_034                 4.041930e-03 3 1  ON 33
ci_035                 1.129116e-03 3 1  ON 34
ci_036                 1.125597e-03 3 1  ON 35
ci_037                 5.270709e-03 3 1  ON 36
ci_038                 4.943298e-03 3 1  ON 37
ci_039                 5.251707e-03 3 1  ON 38
ci_040                 5.441497e-03 3 1  ON 39
ci_041                 5.319519e-03 3 1  ON 40
ci_042                 5.008175e-03 3 1  ON 41
ci_043                 5.043746e-03 3 1  ON 42
ci_044                 4.772999e-03 3 1  ON 43
ci_045                 2.933232e-03 3 1  ON 44
ci_046                 3.056085e-03 3 1  ON 45
ci_047                -7.012707e-04 3 1  ON 46
ci_048                -7.559953e-04 3 1  ON 47
ci_049                 9.772668e-04 3 1  ON 48
ci_050                 1.638696e-03 3 1  ON 49
ci_051                -9.302930e-04 3 1  ON 50
ci_052                -1.432851e-03 3 1  ON 51
ci_053                -2.936790e-03 3 1  ON 52
ci_054                -2.735375e-03 3 1  ON 53
ci_055                -1.577269e-03 3 1  ON 54
ci_056                -1.736927e-03 3 1  ON 55
ci_057                -1.387107e-03 3 1  ON 56
ci_058                -1.698394e-03 3 1  ON 57
ci_059                 2.018048e-04 3 1  ON 58
ci_060                 2.790164e-04 3 1  ON 59
ci_061                -1.795718e-04 3 1  ON 60
ci_062                -3.164687e-04 3 1  ON 61
ci_063                -1.408618e-03 3 1  ON 62
ci_064                -6.033542e-04 3 1  ON 63
ci_065                -2.121130e-03 3 1  ON 64
ci_066                -2.285333e-03 3 1  ON 65
ci_067                -2.689065e-03 3 1  ON 66
ci_068                -2.421612e-03 3 1  ON 67
ci_069                -1.403248e-04 3 1  ON 68
ci_070                -1.893763e-05 3 1  ON 69
ci_071                -2.214203e-03 3 1  ON 70
ci_072                -1.945385e-03 3 1  ON 71
ci_073                 3.197860e-04 3 1  ON 72
ci_074                 1.424041e-04 3 1  ON 73
ci_075                -5.739577e-04 3 1  ON 74
ci_076                -9.466987e-05 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 2.9261e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s032 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s032 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=32  my_counter=0
  time step      = 5.0000e-02
  blocks         = 250
  steps          = 250
  substeps       = 10
  current        = 0
  target samples = 8.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">250</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">6.2500e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">8.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">6.2500e+04</parameter>
<parameter name="steps" condition="int">250</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2678e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="250">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =8000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 32
    time step          = 0.05
    reference energy   = -22.7395
    reference variance = 0.4424
====================================================
  Execution time = 1.0140e+02
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s032
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 62500 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 6.1117e+04
  VMC Eavg = -2.2669e+01
  VMC Evar = 5.2039e-01
  Total weights = 7.820926460e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.8686e+01
  </log>
</opt>
<opt stage="main" walkers="62500">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.504759149034
                                         uncertainty =       0.002787783093

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.504759149034
                                         uncertainty =       0.002787783093

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000251185483
  error estimate for blocks of size 2^( 2) =       0.000260062741
  error estimate for blocks of size 2^( 3) =       0.000268026128
  error estimate for blocks of size 2^( 4) =       0.000273775861
  error estimate for blocks of size 2^( 5) =       0.000277187312
  error estimate for blocks of size 2^( 6) =       0.000279081531
  error estimate for blocks of size 2^( 7) =       0.000279741309
  error estimate for blocks of size 2^( 8) =       0.000279421958
  error estimate for blocks of size 2^( 9) =       0.000279453829

      target function =                  N/A
              le_mean =     -22.669498841020
             les_mean =     514.426565205381
             stat err =       0.000279424657
             autocorr =       1.237486245939
              std dev =       0.710459832933
             le_variance =       0.504753174211


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266949884102e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.3132e-02, overlap shift 9.3132e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.669498841040       residual = 3.86e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.669503285558       residual = 1.20e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.669503357559       residual = 1.02e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.669503533568       residual = 1.58e-08           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.669503460144       residual = 2.13e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          4 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 9.3132e-02 is 8.163293e-04

solving harmonic davidson linear method for identity shift 3.7253e-01, overlap shift 3.7253e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.669498841040       residual = 3.86e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.669500954173       residual = 5.24e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.669501023950       residual = 1.88e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.669501054502       residual = 4.83e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 3.7253e-01 is 3.708480e-04

solving harmonic davidson linear method for identity shift 1.4901e+00, overlap shift 1.4901e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.669498841040       residual = 3.86e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.669499523089       residual = 4.74e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.669499560736       residual = 1.36e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.669499558589       residual = 3.15e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 1.4901e+00 is 1.314237e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.317866 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.2010e+02
  </log>
  <optVariables href="FORM.s032.opt.xml">
ci_001                -7.064383e-01 3 1  ON 0
ci_002                -7.047986e-01 3 1  ON 1
ci_003                -3.757073e-02 3 1  ON 2
ci_004                -3.792007e-02 3 1  ON 3
ci_005                 1.586182e-02 3 1  ON 4
ci_006                 1.584027e-02 3 1  ON 5
ci_007                 1.239177e-02 3 1  ON 6
ci_008                 1.229051e-02 3 1  ON 7
ci_009                -1.156049e-02 3 1  ON 8
ci_010                -1.174077e-02 3 1  ON 9
ci_011                -8.194389e-03 3 1  ON 10
ci_012                -8.209988e-03 3 1  ON 11
ci_013                 9.742361e-03 3 1  ON 12
ci_014                 9.139605e-03 3 1  ON 13
ci_015                 1.235928e-02 3 1  ON 14
ci_016                 1.245698e-02 3 1  ON 15
ci_017                 1.036111e-02 3 1  ON 16
ci_018                 1.076468e-02 3 1  ON 17
ci_019                -3.380054e-03 3 1  ON 18
ci_020                -3.544147e-03 3 1  ON 19
ci_021                -8.588895e-03 3 1  ON 20
ci_022                -8.878374e-03 3 1  ON 21
ci_023                 7.583737e-03 3 1  ON 22
ci_024                 7.659791e-03 3 1  ON 23
ci_025                 4.126044e-03 3 1  ON 24
ci_026                 3.995399e-03 3 1  ON 25
ci_027                 6.428587e-03 3 1  ON 26
ci_028                 6.338507e-03 3 1  ON 27
ci_029                -4.833762e-03 3 1  ON 28
ci_030                -4.842924e-03 3 1  ON 29
ci_031                -7.789045e-03 3 1  ON 30
ci_032                -8.245270e-03 3 1  ON 31
ci_033                 4.170466e-03 3 1  ON 32
ci_034                 4.043175e-03 3 1  ON 33
ci_035                 1.234553e-03 3 1  ON 34
ci_036                 1.215547e-03 3 1  ON 35
ci_037                 5.216813e-03 3 1  ON 36
ci_038                 4.900158e-03 3 1  ON 37
ci_039                 4.887402e-03 3 1  ON 38
ci_040                 5.507374e-03 3 1  ON 39
ci_041                 5.251556e-03 3 1  ON 40
ci_042                 4.951271e-03 3 1  ON 41
ci_043                 4.944254e-03 3 1  ON 42
ci_044                 4.817296e-03 3 1  ON 43
ci_045                 2.980948e-03 3 1  ON 44
ci_046                 2.966073e-03 3 1  ON 45
ci_047                -6.143699e-04 3 1  ON 46
ci_048                -7.763211e-04 3 1  ON 47
ci_049                 7.919282e-04 3 1  ON 48
ci_050                 1.774558e-03 3 1  ON 49
ci_051                -1.101406e-03 3 1  ON 50
ci_052                -1.431961e-03 3 1  ON 51
ci_053                -2.832531e-03 3 1  ON 52
ci_054                -2.676345e-03 3 1  ON 53
ci_055                -1.564052e-03 3 1  ON 54
ci_056                -1.669082e-03 3 1  ON 55
ci_057                -1.286916e-03 3 1  ON 56
ci_058                -1.604211e-03 3 1  ON 57
ci_059                 2.390465e-04 3 1  ON 58
ci_060                 2.330172e-04 3 1  ON 59
ci_061                -4.432078e-05 3 1  ON 60
ci_062                -1.257984e-04 3 1  ON 61
ci_063                -1.245532e-03 3 1  ON 62
ci_064                -8.906096e-04 3 1  ON 63
ci_065                -2.356754e-03 3 1  ON 64
ci_066                -2.421318e-03 3 1  ON 65
ci_067                -2.775807e-03 3 1  ON 66
ci_068                -2.578162e-03 3 1  ON 67
ci_069                 9.650963e-05 3 1  ON 68
ci_070                -1.497666e-04 3 1  ON 69
ci_071                -2.287325e-03 3 1  ON 70
ci_072                -1.761462e-03 3 1  ON 71
ci_073                 3.319891e-04 3 1  ON 72
ci_074                 1.621935e-04 3 1  ON 73
ci_075                -3.313265e-04 3 1  ON 74
ci_076                -1.559431e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="250">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =8000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 32
    time step          = 0.05
    reference energy   = -22.6591
    reference variance = 0.298231
====================================================
  Execution time = 1.0050e+02
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s032
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 62500 
  VMC Eavg = -2.2670e+01
  VMC Evar = 5.1541e-01
  Total weights = 7.8202e+06
  Execution time = 1.4369e+01
  </log>
</opt>
<opt stage="main" walkers="62500">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.501166646132
                                         uncertainty =       0.002196108231

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.501166646132
                                         uncertainty =       0.002196108231

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000250292701
  error estimate for blocks of size 2^( 2) =       0.000259264674
  error estimate for blocks of size 2^( 3) =       0.000267187807
  error estimate for blocks of size 2^( 4) =       0.000272717652
  error estimate for blocks of size 2^( 5) =       0.000275669345
  error estimate for blocks of size 2^( 6) =       0.000277386359
  error estimate for blocks of size 2^( 7) =       0.000278896315
  error estimate for blocks of size 2^( 8) =       0.000278745209
  error estimate for blocks of size 2^( 9) =       0.000278067246

      target function =                  N/A
              le_mean =     -22.669772056155
             les_mean =     514.456732427496
             stat err =       0.000278273782
             autocorr =       1.236084650325
              std dev =       0.707934663287
             le_variance =       0.501171487484

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.501012708357
                                         uncertainty =       0.002137558081

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.501012708357
                                         uncertainty =       0.002137558081

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000250254216
  error estimate for blocks of size 2^( 2) =       0.000259226754
  error estimate for blocks of size 2^( 3) =       0.000267153113
  error estimate for blocks of size 2^( 4) =       0.000272681779
  error estimate for blocks of size 2^( 5) =       0.000275633656
  error estimate for blocks of size 2^( 6) =       0.000277352496
  error estimate for blocks of size 2^( 7) =       0.000278870311
  error estimate for blocks of size 2^( 8) =       0.000278711467
  error estimate for blocks of size 2^( 9) =       0.000278047591

      target function =                  N/A
              le_mean =     -22.669775226102
             les_mean =     514.450152934950
             stat err =       0.000278245466
             autocorr =       1.236213229741
              std dev =       0.707825813201
             le_variance =       0.501017381834

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.501196306806
                                         uncertainty =       0.002132349373

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.501196306806
                                         uncertainty =       0.002132349373

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000250300129
  error estimate for blocks of size 2^( 2) =       0.000259275527
  error estimate for blocks of size 2^( 3) =       0.000267199867
  error estimate for blocks of size 2^( 4) =       0.000272724328
  error estimate for blocks of size 2^( 5) =       0.000275684400
  error estimate for blocks of size 2^( 6) =       0.000277397077
  error estimate for blocks of size 2^( 7) =       0.000278901553
  error estimate for blocks of size 2^( 8) =       0.000278746752
  error estimate for blocks of size 2^( 9) =       0.000278009239

      target function =                  N/A
              le_mean =     -22.669768905761
             les_mean =     514.717611498898
             stat err =       0.000278263655
             autocorr =       1.235921324923
              std dev =       0.707955672961
             le_variance =       0.501201234878

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.501142518236
                                         uncertainty =       0.002185082059

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.501142518236
                                         uncertainty =       0.002185082059

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000250286667
  error estimate for blocks of size 2^( 2) =       0.000259258225
  error estimate for blocks of size 2^( 3) =       0.000267183140
  error estimate for blocks of size 2^( 4) =       0.000272711338
  error estimate for blocks of size 2^( 5) =       0.000275663182
  error estimate for blocks of size 2^( 6) =       0.000277379973
  error estimate for blocks of size 2^( 7) =       0.000278890283
  error estimate for blocks of size 2^( 8) =       0.000278739798
  error estimate for blocks of size 2^( 9) =       0.000278060873

      target function =                  N/A
              le_mean =     -22.669772232637
             les_mean =     514.497853544151
             stat err =       0.000278267732
             autocorr =       1.236090492100
              std dev =       0.707917598607
             le_variance =       0.501147326417


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.669772056155        initial
     9.3132e-02     9.3132e-01             8.1633e-04       -22.669775226102  <--
     3.7253e-01     3.7253e+00             3.7085e-04       -22.669768905761
     1.4901e+00     1.4901e+01             1.3142e-04       -22.669772232637

*****************************************************************************
Applying the update for shift_i =   9.3132e-02     and shift_s =   9.3132e-01
*****************************************************************************

  Execution time = 1.7268e+02
  </log>
  <optVariables href="FORM.s032.opt.xml">
ci_001                -7.066968e-01 3 1  ON 0
ci_002                -7.045669e-01 3 1  ON 1
ci_003                -3.755981e-02 3 1  ON 2
ci_004                -3.778706e-02 3 1  ON 3
ci_005                 1.592638e-02 3 1  ON 4
ci_006                 1.586003e-02 3 1  ON 5
ci_007                 1.283726e-02 3 1  ON 6
ci_008                 1.233518e-02 3 1  ON 7
ci_009                -1.139909e-02 3 1  ON 8
ci_010                -1.171078e-02 3 1  ON 9
ci_011                -8.275080e-03 3 1  ON 10
ci_012                -8.175662e-03 3 1  ON 11
ci_013                 9.803735e-03 3 1  ON 12
ci_014                 8.964125e-03 3 1  ON 13
ci_015                 1.205673e-02 3 1  ON 14
ci_016                 1.218552e-02 3 1  ON 15
ci_017                 1.044564e-02 3 1  ON 16
ci_018                 1.075787e-02 3 1  ON 17
ci_019                -3.319695e-03 3 1  ON 18
ci_020                -3.399225e-03 3 1  ON 19
ci_021                -8.426761e-03 3 1  ON 20
ci_022                -8.901910e-03 3 1  ON 21
ci_023                 7.732263e-03 3 1  ON 22
ci_024                 7.557594e-03 3 1  ON 23
ci_025                 3.763107e-03 3 1  ON 24
ci_026                 3.819628e-03 3 1  ON 25
ci_027                 6.450047e-03 3 1  ON 26
ci_028                 6.313445e-03 3 1  ON 27
ci_029                -4.611708e-03 3 1  ON 28
ci_030                -5.097176e-03 3 1  ON 29
ci_031                -7.496034e-03 3 1  ON 30
ci_032                -8.054316e-03 3 1  ON 31
ci_033                 3.862941e-03 3 1  ON 32
ci_034                 4.044150e-03 3 1  ON 33
ci_035                 1.312609e-03 3 1  ON 34
ci_036                 1.275987e-03 3 1  ON 35
ci_037                 5.160314e-03 3 1  ON 36
ci_038                 4.850305e-03 3 1  ON 37
ci_039                 4.591053e-03 3 1  ON 38
ci_040                 5.560253e-03 3 1  ON 39
ci_041                 5.192302e-03 3 1  ON 40
ci_042                 4.896844e-03 3 1  ON 41
ci_043                 4.826783e-03 3 1  ON 42
ci_044                 4.853308e-03 3 1  ON 43
ci_045                 3.056075e-03 3 1  ON 44
ci_046                 2.866466e-03 3 1  ON 45
ci_047                -5.493346e-04 3 1  ON 46
ci_048                -7.893502e-04 3 1  ON 47
ci_049                 5.843585e-04 3 1  ON 48
ci_050                 1.922036e-03 3 1  ON 49
ci_051                -1.320477e-03 3 1  ON 50
ci_052                -1.446439e-03 3 1  ON 51
ci_053                -2.708885e-03 3 1  ON 52
ci_054                -2.605633e-03 3 1  ON 53
ci_055                -1.564132e-03 3 1  ON 54
ci_056                -1.582158e-03 3 1  ON 55
ci_057                -1.174080e-03 3 1  ON 56
ci_058                -1.508799e-03 3 1  ON 57
ci_059                 2.668736e-04 3 1  ON 58
ci_060                 1.949966e-04 3 1  ON 59
ci_061                 1.060685e-04 3 1  ON 60
ci_062                 9.689731e-05 3 1  ON 61
ci_063                -1.050998e-03 3 1  ON 62
ci_064                -1.233317e-03 3 1  ON 63
ci_065                -2.630396e-03 3 1  ON 64
ci_066                -2.536263e-03 3 1  ON 65
ci_067                -2.892504e-03 3 1  ON 66
ci_068                -2.771592e-03 3 1  ON 67
ci_069                 3.424660e-04 3 1  ON 68
ci_070                -2.804557e-04 3 1  ON 69
ci_071                -2.371021e-03 3 1  ON 70
ci_072                -1.569729e-03 3 1  ON 71
ci_073                 3.412833e-04 3 1  ON 72
ci_074                 1.793984e-04 3 1  ON 73
ci_075                -7.878160e-05 3 1  ON 74
ci_076                -2.099991e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 2.9278e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s033 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s033 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=33  my_counter=0
  time step      = 5.0000e-02
  blocks         = 250
  steps          = 250
  substeps       = 10
  current        = 0
  target samples = 8.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">250</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">6.2500e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">8.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">6.2500e+04</parameter>
<parameter name="steps" condition="int">250</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2678e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="250">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =8000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 33
    time step          = 0.05
    reference energy   = -22.7127
    reference variance = 0.33631
====================================================
  Execution time = 1.0101e+02
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s033
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 62500 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 6.1055e+04
  VMC Eavg = -2.2670e+01
  VMC Evar = 5.0916e-01
  Total weights = 7.821153281e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.8768e+01
  </log>
</opt>
<opt stage="main" walkers="62500">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.497239792922
                                         uncertainty =       0.001633730898

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.497239792922
                                         uncertainty =       0.001633730898

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000249308638
  error estimate for blocks of size 2^( 2) =       0.000258302558
  error estimate for blocks of size 2^( 3) =       0.000266245653
  error estimate for blocks of size 2^( 4) =       0.000271837301
  error estimate for blocks of size 2^( 5) =       0.000275121999
  error estimate for blocks of size 2^( 6) =       0.000276846502
  error estimate for blocks of size 2^( 7) =       0.000277610196
  error estimate for blocks of size 2^( 8) =       0.000278078368
  error estimate for blocks of size 2^( 9) =       0.000279246538

      target function =                  N/A
              le_mean =     -22.669593485214
             les_mean =     514.419628617393
             stat err =       0.000277945401
             autocorr =       1.242923308751
              std dev =       0.705151314737
             le_variance =       0.497238376676


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266959348521e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3283e-02, overlap shift 2.3283e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.669593485236       residual = 3.41e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.669602409261       residual = 2.24e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.669602518928       residual = 2.08e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.669602625816       residual = 3.32e-08           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.669602521184       residual = 7.22e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          4 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 2.3283e-02 is 9.497185e-04

solving harmonic davidson linear method for identity shift 9.3132e-02, overlap shift 9.3132e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.669593485236       residual = 3.41e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.669599932019       residual = 1.25e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.669599877223       residual = 8.31e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.669599897223       residual = 6.04e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 9.3132e-02 is 6.752496e-04

solving harmonic davidson linear method for identity shift 3.7253e-01, overlap shift 3.7253e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.669593485236       residual = 3.41e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.669596540044       residual = 5.17e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.669596461479       residual = 2.60e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.669596464528       residual = 9.57e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 3.7253e-01 is 3.170490e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.327734 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.1984e+02
  </log>
  <optVariables href="FORM.s033.opt.xml">
ci_001                -7.067407e-01 3 1  ON 0
ci_002                -7.045055e-01 3 1  ON 1
ci_003                -3.743915e-02 3 1  ON 2
ci_004                -3.818506e-02 3 1  ON 3
ci_005                 1.585545e-02 3 1  ON 4
ci_006                 1.591492e-02 3 1  ON 5
ci_007                 1.226666e-02 3 1  ON 6
ci_008                 1.270675e-02 3 1  ON 7
ci_009                -1.132265e-02 3 1  ON 8
ci_010                -1.144073e-02 3 1  ON 9
ci_011                -8.772992e-03 3 1  ON 10
ci_012                -8.257923e-03 3 1  ON 11
ci_013                 9.522377e-03 3 1  ON 12
ci_014                 9.145599e-03 3 1  ON 13
ci_015                 1.202769e-02 3 1  ON 14
ci_016                 1.209916e-02 3 1  ON 15
ci_017                 1.049205e-02 3 1  ON 16
ci_018                 1.081340e-02 3 1  ON 17
ci_019                -3.923171e-03 3 1  ON 18
ci_020                -3.555335e-03 3 1  ON 19
ci_021                -8.892874e-03 3 1  ON 20
ci_022                -9.052824e-03 3 1  ON 21
ci_023                 7.620479e-03 3 1  ON 22
ci_024                 7.934131e-03 3 1  ON 23
ci_025                 4.231697e-03 3 1  ON 24
ci_026                 4.181530e-03 3 1  ON 25
ci_027                 6.563840e-03 3 1  ON 26
ci_028                 6.214520e-03 3 1  ON 27
ci_029                -4.806650e-03 3 1  ON 28
ci_030                -4.502720e-03 3 1  ON 29
ci_031                -7.271621e-03 3 1  ON 30
ci_032                -7.708931e-03 3 1  ON 31
ci_033                 4.400614e-03 3 1  ON 32
ci_034                 4.007331e-03 3 1  ON 33
ci_035                 1.125758e-03 3 1  ON 34
ci_036                 1.241421e-03 3 1  ON 35
ci_037                 5.275825e-03 3 1  ON 36
ci_038                 4.770328e-03 3 1  ON 37
ci_039                 5.033552e-03 3 1  ON 38
ci_040                 5.769133e-03 3 1  ON 39
ci_041                 4.796578e-03 3 1  ON 40
ci_042                 5.017954e-03 3 1  ON 41
ci_043                 4.742042e-03 3 1  ON 42
ci_044                 4.908241e-03 3 1  ON 43
ci_045                 2.568085e-03 3 1  ON 44
ci_046                 3.216833e-03 3 1  ON 45
ci_047                -5.474997e-04 3 1  ON 46
ci_048                -9.366168e-04 3 1  ON 47
ci_049                 7.872879e-04 3 1  ON 48
ci_050                 1.623710e-03 3 1  ON 49
ci_051                -1.294830e-03 3 1  ON 50
ci_052                -1.995196e-03 3 1  ON 51
ci_053                -2.365151e-03 3 1  ON 52
ci_054                -2.544864e-03 3 1  ON 53
ci_055                -1.436350e-03 3 1  ON 54
ci_056                -1.292640e-03 3 1  ON 55
ci_057                -1.700694e-03 3 1  ON 56
ci_058                -1.401594e-03 3 1  ON 57
ci_059                 1.581290e-05 3 1  ON 58
ci_060                 3.040918e-04 3 1  ON 59
ci_061                -2.660082e-04 3 1  ON 60
ci_062                -4.215962e-04 3 1  ON 61
ci_063                -9.413952e-04 3 1  ON 62
ci_064                -7.628465e-04 3 1  ON 63
ci_065                -2.808186e-03 3 1  ON 64
ci_066                -2.772328e-03 3 1  ON 65
ci_067                -2.580698e-03 3 1  ON 66
ci_068                -2.096343e-03 3 1  ON 67
ci_069                 4.983276e-05 3 1  ON 68
ci_070                -2.484580e-04 3 1  ON 69
ci_071                -1.949879e-03 3 1  ON 70
ci_072                -1.968868e-03 3 1  ON 71
ci_073                 1.785283e-04 3 1  ON 72
ci_074                 1.317905e-04 3 1  ON 73
ci_075                 1.197981e-04 3 1  ON 74
ci_076                -1.844107e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="250">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =8000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 33
    time step          = 0.05
    reference energy   = -22.8484
    reference variance = 0.319754
====================================================
  Execution time = 1.0040e+02
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s033
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 62500 
  VMC Eavg = -2.2669e+01
  VMC Evar = 5.1059e-01
  Total weights = 7.8204e+06
  Execution time = 1.4413e+01
  </log>
</opt>
<opt stage="main" walkers="62500">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.497766155758
                                         uncertainty =       0.001371712007

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.497766155758
                                         uncertainty =       0.001371712007

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000249440892
  error estimate for blocks of size 2^( 2) =       0.000258256414
  error estimate for blocks of size 2^( 3) =       0.000266190060
  error estimate for blocks of size 2^( 4) =       0.000271884885
  error estimate for blocks of size 2^( 5) =       0.000275466345
  error estimate for blocks of size 2^( 6) =       0.000277547169
  error estimate for blocks of size 2^( 7) =       0.000278845771
  error estimate for blocks of size 2^( 8) =       0.000279487769
  error estimate for blocks of size 2^( 9) =       0.000279539821

      target function =                  N/A
              le_mean =     -22.669504170340
             les_mean =     514.482042519181
             stat err =       0.000278855133
             autocorr =       1.249746653341
              std dev =       0.705525386070
             le_variance =       0.497766070390

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.497399272039
                                         uncertainty =       0.001345926426

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.497399272039
                                         uncertainty =       0.001345926426

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000249348975
  error estimate for blocks of size 2^( 2) =       0.000258169875
  error estimate for blocks of size 2^( 3) =       0.000266107100
  error estimate for blocks of size 2^( 4) =       0.000271810281
  error estimate for blocks of size 2^( 5) =       0.000275395918
  error estimate for blocks of size 2^( 6) =       0.000277479559
  error estimate for blocks of size 2^( 7) =       0.000278784905
  error estimate for blocks of size 2^( 8) =       0.000279398986
  error estimate for blocks of size 2^( 9) =       0.000279456236

      target function =                  N/A
              le_mean =     -22.669489630148
             les_mean =     514.430658553391
             stat err =       0.000278779922
             autocorr =       1.249993657230
              std dev =       0.705265404016
             le_variance =       0.497399290102

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.505265420685
                                         uncertainty =       0.007612207078

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.505265420685
                                         uncertainty =       0.007612207078

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000251314203
  error estimate for blocks of size 2^( 2) =       0.000260068137
  error estimate for blocks of size 2^( 3) =       0.000267958468
  error estimate for blocks of size 2^( 4) =       0.000273609849
  error estimate for blocks of size 2^( 5) =       0.000277163324
  error estimate for blocks of size 2^( 6) =       0.000279230546
  error estimate for blocks of size 2^( 7) =       0.000280608786
  error estimate for blocks of size 2^( 8) =       0.000281209497
  error estimate for blocks of size 2^( 9) =       0.000281323185

      target function =                  N/A
              le_mean =     -22.669532885176
             les_mean =     519.037473479539
             stat err =       0.000280593004
             autocorr =       1.246578435016
              std dev =       0.710823908536
             le_variance =       0.505270628946

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.497548269635
                                         uncertainty =       0.001349362723

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.497548269635
                                         uncertainty =       0.001349362723

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000249386305
  error estimate for blocks of size 2^( 2) =       0.000258204535
  error estimate for blocks of size 2^( 3) =       0.000266137260
  error estimate for blocks of size 2^( 4) =       0.000271838804
  error estimate for blocks of size 2^( 5) =       0.000275423534
  error estimate for blocks of size 2^( 6) =       0.000277511410
  error estimate for blocks of size 2^( 7) =       0.000278817378
  error estimate for blocks of size 2^( 8) =       0.000279441868
  error estimate for blocks of size 2^( 9) =       0.000279502241

      target function =                  N/A
              le_mean =     -22.669493105372
             les_mean =     514.464144394995
             stat err =       0.000278818225
             autocorr =       1.249962875019
              std dev =       0.705370988964
             le_variance =       0.497548232072


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.669504170340        initial
     2.3283e-02     2.3283e-01             9.4972e-04       -22.669489630148
     9.3132e-02     9.3132e-01             6.7525e-04       -22.669532885176  <--
     3.7253e-01     3.7253e+00             3.1705e-04       -22.669493105372

*****************************************************************************
Applying the update for shift_i =   9.3132e-02     and shift_s =   9.3132e-01
*****************************************************************************

  Execution time = 1.7278e+02
  </log>
  <optVariables href="FORM.s033.opt.xml">
ci_001                -7.067407e-01 3 1  ON 0
ci_002                -7.045055e-01 3 1  ON 1
ci_003                -3.743915e-02 3 1  ON 2
ci_004                -3.818506e-02 3 1  ON 3
ci_005                 1.585545e-02 3 1  ON 4
ci_006                 1.591492e-02 3 1  ON 5
ci_007                 1.226666e-02 3 1  ON 6
ci_008                 1.270675e-02 3 1  ON 7
ci_009                -1.132265e-02 3 1  ON 8
ci_010                -1.144073e-02 3 1  ON 9
ci_011                -8.772992e-03 3 1  ON 10
ci_012                -8.257923e-03 3 1  ON 11
ci_013                 9.522377e-03 3 1  ON 12
ci_014                 9.145599e-03 3 1  ON 13
ci_015                 1.202769e-02 3 1  ON 14
ci_016                 1.209916e-02 3 1  ON 15
ci_017                 1.049205e-02 3 1  ON 16
ci_018                 1.081340e-02 3 1  ON 17
ci_019                -3.923171e-03 3 1  ON 18
ci_020                -3.555335e-03 3 1  ON 19
ci_021                -8.892874e-03 3 1  ON 20
ci_022                -9.052824e-03 3 1  ON 21
ci_023                 7.620479e-03 3 1  ON 22
ci_024                 7.934131e-03 3 1  ON 23
ci_025                 4.231697e-03 3 1  ON 24
ci_026                 4.181530e-03 3 1  ON 25
ci_027                 6.563840e-03 3 1  ON 26
ci_028                 6.214520e-03 3 1  ON 27
ci_029                -4.806650e-03 3 1  ON 28
ci_030                -4.502720e-03 3 1  ON 29
ci_031                -7.271621e-03 3 1  ON 30
ci_032                -7.708931e-03 3 1  ON 31
ci_033                 4.400614e-03 3 1  ON 32
ci_034                 4.007331e-03 3 1  ON 33
ci_035                 1.125758e-03 3 1  ON 34
ci_036                 1.241421e-03 3 1  ON 35
ci_037                 5.275825e-03 3 1  ON 36
ci_038                 4.770328e-03 3 1  ON 37
ci_039                 5.033552e-03 3 1  ON 38
ci_040                 5.769133e-03 3 1  ON 39
ci_041                 4.796578e-03 3 1  ON 40
ci_042                 5.017954e-03 3 1  ON 41
ci_043                 4.742042e-03 3 1  ON 42
ci_044                 4.908241e-03 3 1  ON 43
ci_045                 2.568085e-03 3 1  ON 44
ci_046                 3.216833e-03 3 1  ON 45
ci_047                -5.474997e-04 3 1  ON 46
ci_048                -9.366168e-04 3 1  ON 47
ci_049                 7.872879e-04 3 1  ON 48
ci_050                 1.623710e-03 3 1  ON 49
ci_051                -1.294830e-03 3 1  ON 50
ci_052                -1.995196e-03 3 1  ON 51
ci_053                -2.365151e-03 3 1  ON 52
ci_054                -2.544864e-03 3 1  ON 53
ci_055                -1.436350e-03 3 1  ON 54
ci_056                -1.292640e-03 3 1  ON 55
ci_057                -1.700694e-03 3 1  ON 56
ci_058                -1.401594e-03 3 1  ON 57
ci_059                 1.581290e-05 3 1  ON 58
ci_060                 3.040918e-04 3 1  ON 59
ci_061                -2.660082e-04 3 1  ON 60
ci_062                -4.215962e-04 3 1  ON 61
ci_063                -9.413952e-04 3 1  ON 62
ci_064                -7.628465e-04 3 1  ON 63
ci_065                -2.808186e-03 3 1  ON 64
ci_066                -2.772328e-03 3 1  ON 65
ci_067                -2.580698e-03 3 1  ON 66
ci_068                -2.096343e-03 3 1  ON 67
ci_069                 4.983276e-05 3 1  ON 68
ci_070                -2.484580e-04 3 1  ON 69
ci_071                -1.949879e-03 3 1  ON 70
ci_072                -1.968868e-03 3 1  ON 71
ci_073                 1.785283e-04 3 1  ON 72
ci_074                 1.317905e-04 3 1  ON 73
ci_075                 1.197981e-04 3 1  ON 74
ci_076                -1.844107e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 2.9265e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s034 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s034 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=34  my_counter=0
  time step      = 5.0000e-02
  blocks         = 250
  steps          = 250
  substeps       = 10
  current        = 0
  target samples = 8.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">250</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">6.2500e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">8.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">6.2500e+04</parameter>
<parameter name="steps" condition="int">250</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2681e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="250">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =8000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 34
    time step          = 0.05
    reference energy   = -22.5785
    reference variance = 0.371118
====================================================
  Execution time = 1.0085e+02
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s034
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 62500 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 6.1087e+04
  VMC Eavg = -2.2669e+01
  VMC Evar = 5.0988e-01
  Total weights = 7.820995515e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.8775e+01
  </log>
</opt>
<opt stage="main" walkers="62500">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.497933788589
                                         uncertainty =       0.002171643418

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.497933788589
                                         uncertainty =       0.002171643418

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000249483613
  error estimate for blocks of size 2^( 2) =       0.000258344349
  error estimate for blocks of size 2^( 3) =       0.000266212697
  error estimate for blocks of size 2^( 4) =       0.000272214184
  error estimate for blocks of size 2^( 5) =       0.000275566558
  error estimate for blocks of size 2^( 6) =       0.000277305642
  error estimate for blocks of size 2^( 7) =       0.000278625621
  error estimate for blocks of size 2^( 8) =       0.000279563000
  error estimate for blocks of size 2^( 9) =       0.000279663600

      target function =                  N/A
              le_mean =     -22.669440428662
             les_mean =     514.413411541440
             stat err =       0.000278789466
             autocorr =       1.248730352421
              std dev =       0.705646219009
             le_variance =       0.497936586401


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266944042866e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3283e-02, overlap shift 2.3283e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.669440428683       residual = 4.47e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.669446158439       residual = 3.04e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.669445700314       residual = 3.36e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.669445054658       residual = 8.76e-08           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.669444915727       residual = 3.95e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.669445037313       residual = 1.85e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.669445148146       residual = 7.77e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 2.3283e-02 is 1.148157e-03

solving harmonic davidson linear method for identity shift 9.3132e-02, overlap shift 9.3132e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.669440428683       residual = 4.47e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.669444683953       residual = 1.77e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.669444338451       residual = 1.26e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.669444112640       residual = 1.20e-08           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.669444105173       residual = 1.35e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          4 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 9.3132e-02 is 8.457699e-04

solving harmonic davidson linear method for identity shift 3.7253e-01, overlap shift 3.7253e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.669440428683       residual = 4.47e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.669442525541       residual = 7.08e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.669442377325       residual = 3.49e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.669442363231       residual = 1.16e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 3.7253e-01 is 4.004350e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.329560 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.1964e+02
  </log>
  <optVariables href="FORM.s034.opt.xml">
ci_001                -7.065474e-01 3 1  ON 0
ci_002                -7.046657e-01 3 1  ON 1
ci_003                -3.746577e-02 3 1  ON 2
ci_004                -3.870759e-02 3 1  ON 3
ci_005                 1.577698e-02 3 1  ON 4
ci_006                 1.552746e-02 3 1  ON 5
ci_007                 1.260851e-02 3 1  ON 6
ci_008                 1.282760e-02 3 1  ON 7
ci_009                -1.141969e-02 3 1  ON 8
ci_010                -1.129496e-02 3 1  ON 9
ci_011                -8.493190e-03 3 1  ON 10
ci_012                -8.188427e-03 3 1  ON 11
ci_013                 9.574799e-03 3 1  ON 12
ci_014                 9.204741e-03 3 1  ON 13
ci_015                 1.214942e-02 3 1  ON 14
ci_016                 1.256713e-02 3 1  ON 15
ci_017                 1.068131e-02 3 1  ON 16
ci_018                 1.118498e-02 3 1  ON 17
ci_019                -3.692851e-03 3 1  ON 18
ci_020                -3.775572e-03 3 1  ON 19
ci_021                -9.154585e-03 3 1  ON 20
ci_022                -9.159990e-03 3 1  ON 21
ci_023                 8.277052e-03 3 1  ON 22
ci_024                 7.556679e-03 3 1  ON 23
ci_025                 3.599901e-03 3 1  ON 24
ci_026                 4.389037e-03 3 1  ON 25
ci_027                 5.935524e-03 3 1  ON 26
ci_028                 5.924547e-03 3 1  ON 27
ci_029                -4.588975e-03 3 1  ON 28
ci_030                -4.094637e-03 3 1  ON 29
ci_031                -7.352120e-03 3 1  ON 30
ci_032                -7.635310e-03 3 1  ON 31
ci_033                 4.307513e-03 3 1  ON 32
ci_034                 4.680864e-03 3 1  ON 33
ci_035                 1.100284e-03 3 1  ON 34
ci_036                 9.249437e-04 3 1  ON 35
ci_037                 4.928697e-03 3 1  ON 36
ci_038                 4.668144e-03 3 1  ON 37
ci_039                 5.358562e-03 3 1  ON 38
ci_040                 5.575218e-03 3 1  ON 39
ci_041                 5.015963e-03 3 1  ON 40
ci_042                 4.810403e-03 3 1  ON 41
ci_043                 4.711654e-03 3 1  ON 42
ci_044                 4.411723e-03 3 1  ON 43
ci_045                 2.868214e-03 3 1  ON 44
ci_046                 2.945599e-03 3 1  ON 45
ci_047                -6.032912e-04 3 1  ON 46
ci_048                -8.121005e-04 3 1  ON 47
ci_049                 1.453170e-03 3 1  ON 48
ci_050                 2.004542e-03 3 1  ON 49
ci_051                -2.044504e-03 3 1  ON 50
ci_052                -2.352181e-03 3 1  ON 51
ci_053                -2.347922e-03 3 1  ON 52
ci_054                -2.777113e-03 3 1  ON 53
ci_055                -1.302906e-03 3 1  ON 54
ci_056                -1.401813e-03 3 1  ON 55
ci_057                -1.659712e-03 3 1  ON 56
ci_058                -1.277882e-03 3 1  ON 57
ci_059                 2.430111e-04 3 1  ON 58
ci_060                 1.360817e-04 3 1  ON 59
ci_061                 3.003421e-06 3 1  ON 60
ci_062                 4.241737e-04 3 1  ON 61
ci_063                -8.765892e-04 3 1  ON 62
ci_064                -6.345203e-04 3 1  ON 63
ci_065                -2.667655e-03 3 1  ON 64
ci_066                -2.757500e-03 3 1  ON 65
ci_067                -2.764431e-03 3 1  ON 66
ci_068                -1.379779e-03 3 1  ON 67
ci_069                 8.624156e-05 3 1  ON 68
ci_070                -3.936378e-04 3 1  ON 69
ci_071                -2.373184e-03 3 1  ON 70
ci_072                -2.018129e-03 3 1  ON 71
ci_073                 3.204230e-04 3 1  ON 72
ci_074                 4.622008e-04 3 1  ON 73
ci_075                -2.206195e-04 3 1  ON 74
ci_076                -4.045844e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="250">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =8000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 34
    time step          = 0.05
    reference energy   = -22.6987
    reference variance = 0.425496
====================================================
  Execution time = 1.0014e+02
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s034
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 62500 
  VMC Eavg = -2.2670e+01
  VMC Evar = 5.1109e-01
  Total weights = 7.8207e+06
  Execution time = 1.4419e+01
  </log>
</opt>
<opt stage="main" walkers="62500">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.498287794923
                                         uncertainty =       0.001482128361

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.498287794923
                                         uncertainty =       0.001482128361

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000249572193
  error estimate for blocks of size 2^( 2) =       0.000258486882
  error estimate for blocks of size 2^( 3) =       0.000266596412
  error estimate for blocks of size 2^( 4) =       0.000272285988
  error estimate for blocks of size 2^( 5) =       0.000275734820
  error estimate for blocks of size 2^( 6) =       0.000276955652
  error estimate for blocks of size 2^( 7) =       0.000277432071
  error estimate for blocks of size 2^( 8) =       0.000278575008
  error estimate for blocks of size 2^( 9) =       0.000278780261

      target function =                  N/A
              le_mean =     -22.669618620908
             les_mean =     514.455727295279
             stat err =       0.000277935748
             autocorr =       1.240213424824
              std dev =       0.705896760147
             le_variance =       0.498290235986

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.498349594269
                                         uncertainty =       0.001485371188

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.498349594269
                                         uncertainty =       0.001485371188

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000249587640
  error estimate for blocks of size 2^( 2) =       0.000258503543
  error estimate for blocks of size 2^( 3) =       0.000266616920
  error estimate for blocks of size 2^( 4) =       0.000272306772
  error estimate for blocks of size 2^( 5) =       0.000275763039
  error estimate for blocks of size 2^( 6) =       0.000276984547
  error estimate for blocks of size 2^( 7) =       0.000277466364
  error estimate for blocks of size 2^( 8) =       0.000278607210
  error estimate for blocks of size 2^( 9) =       0.000278800000

      target function =                  N/A
              le_mean =     -22.669609377116
             les_mean =     514.426891777710
             stat err =       0.000277964530
             autocorr =       1.240316761454
              std dev =       0.705940451767
             le_variance =       0.498351921441

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.498546820812
                                         uncertainty =       0.001491221201

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.498546820812
                                         uncertainty =       0.001491221201

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000249637006
  error estimate for blocks of size 2^( 2) =       0.000258553508
  error estimate for blocks of size 2^( 3) =       0.000266666138
  error estimate for blocks of size 2^( 4) =       0.000272356175
  error estimate for blocks of size 2^( 5) =       0.000275814071
  error estimate for blocks of size 2^( 6) =       0.000277038336
  error estimate for blocks of size 2^( 7) =       0.000277525127
  error estimate for blocks of size 2^( 8) =       0.000278667871
  error estimate for blocks of size 2^( 9) =       0.000278856069

      target function =                  N/A
              le_mean =     -22.669619984664
             les_mean =     514.439313677423
             stat err =       0.000278021851
             autocorr =       1.240337657836
              std dev =       0.706080079573
             le_variance =       0.498549078769

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.498225178946
                                         uncertainty =       0.001483467482

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.498225178946
                                         uncertainty =       0.001483467482

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000249556503
  error estimate for blocks of size 2^( 2) =       0.000258472278
  error estimate for blocks of size 2^( 3) =       0.000266583996
  error estimate for blocks of size 2^( 4) =       0.000272274464
  error estimate for blocks of size 2^( 5) =       0.000275725276
  error estimate for blocks of size 2^( 6) =       0.000276943435
  error estimate for blocks of size 2^( 7) =       0.000277424206
  error estimate for blocks of size 2^( 8) =       0.000278562477
  error estimate for blocks of size 2^( 9) =       0.000278758564

      target function =                  N/A
              le_mean =     -22.669610281334
             les_mean =     514.424017104597
             stat err =       0.000277922171
             autocorr =       1.240248198375
              std dev =       0.705852380928
             le_variance =       0.498227583662


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.669618620908        initial
     2.3283e-02     2.3283e-01             1.1482e-03       -22.669609377116
     9.3132e-02     9.3132e-01             8.4577e-04       -22.669619984664  <--
     3.7253e-01     3.7253e+00             4.0044e-04       -22.669610281334

*****************************************************************************
Applying the update for shift_i =   9.3132e-02     and shift_s =   9.3132e-01
*****************************************************************************

  Execution time = 1.7254e+02
  </log>
  <optVariables href="FORM.s034.opt.xml">
ci_001                -7.065474e-01 3 1  ON 0
ci_002                -7.046657e-01 3 1  ON 1
ci_003                -3.746577e-02 3 1  ON 2
ci_004                -3.870759e-02 3 1  ON 3
ci_005                 1.577698e-02 3 1  ON 4
ci_006                 1.552746e-02 3 1  ON 5
ci_007                 1.260851e-02 3 1  ON 6
ci_008                 1.282760e-02 3 1  ON 7
ci_009                -1.141969e-02 3 1  ON 8
ci_010                -1.129496e-02 3 1  ON 9
ci_011                -8.493190e-03 3 1  ON 10
ci_012                -8.188427e-03 3 1  ON 11
ci_013                 9.574799e-03 3 1  ON 12
ci_014                 9.204741e-03 3 1  ON 13
ci_015                 1.214942e-02 3 1  ON 14
ci_016                 1.256713e-02 3 1  ON 15
ci_017                 1.068131e-02 3 1  ON 16
ci_018                 1.118498e-02 3 1  ON 17
ci_019                -3.692851e-03 3 1  ON 18
ci_020                -3.775572e-03 3 1  ON 19
ci_021                -9.154585e-03 3 1  ON 20
ci_022                -9.159990e-03 3 1  ON 21
ci_023                 8.277052e-03 3 1  ON 22
ci_024                 7.556679e-03 3 1  ON 23
ci_025                 3.599901e-03 3 1  ON 24
ci_026                 4.389037e-03 3 1  ON 25
ci_027                 5.935524e-03 3 1  ON 26
ci_028                 5.924547e-03 3 1  ON 27
ci_029                -4.588975e-03 3 1  ON 28
ci_030                -4.094637e-03 3 1  ON 29
ci_031                -7.352120e-03 3 1  ON 30
ci_032                -7.635310e-03 3 1  ON 31
ci_033                 4.307513e-03 3 1  ON 32
ci_034                 4.680864e-03 3 1  ON 33
ci_035                 1.100284e-03 3 1  ON 34
ci_036                 9.249437e-04 3 1  ON 35
ci_037                 4.928697e-03 3 1  ON 36
ci_038                 4.668144e-03 3 1  ON 37
ci_039                 5.358562e-03 3 1  ON 38
ci_040                 5.575218e-03 3 1  ON 39
ci_041                 5.015963e-03 3 1  ON 40
ci_042                 4.810403e-03 3 1  ON 41
ci_043                 4.711654e-03 3 1  ON 42
ci_044                 4.411723e-03 3 1  ON 43
ci_045                 2.868214e-03 3 1  ON 44
ci_046                 2.945599e-03 3 1  ON 45
ci_047                -6.032912e-04 3 1  ON 46
ci_048                -8.121005e-04 3 1  ON 47
ci_049                 1.453170e-03 3 1  ON 48
ci_050                 2.004542e-03 3 1  ON 49
ci_051                -2.044504e-03 3 1  ON 50
ci_052                -2.352181e-03 3 1  ON 51
ci_053                -2.347922e-03 3 1  ON 52
ci_054                -2.777113e-03 3 1  ON 53
ci_055                -1.302906e-03 3 1  ON 54
ci_056                -1.401813e-03 3 1  ON 55
ci_057                -1.659712e-03 3 1  ON 56
ci_058                -1.277882e-03 3 1  ON 57
ci_059                 2.430111e-04 3 1  ON 58
ci_060                 1.360817e-04 3 1  ON 59
ci_061                 3.003421e-06 3 1  ON 60
ci_062                 4.241737e-04 3 1  ON 61
ci_063                -8.765892e-04 3 1  ON 62
ci_064                -6.345203e-04 3 1  ON 63
ci_065                -2.667655e-03 3 1  ON 64
ci_066                -2.757500e-03 3 1  ON 65
ci_067                -2.764431e-03 3 1  ON 66
ci_068                -1.379779e-03 3 1  ON 67
ci_069                 8.624156e-05 3 1  ON 68
ci_070                -3.936378e-04 3 1  ON 69
ci_071                -2.373184e-03 3 1  ON 70
ci_072                -2.018129e-03 3 1  ON 71
ci_073                 3.204230e-04 3 1  ON 72
ci_074                 4.622008e-04 3 1  ON 73
ci_075                -2.206195e-04 3 1  ON 74
ci_076                -4.045844e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 2.9219e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s035 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s035 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=35  my_counter=0
  time step      = 5.0000e-02
  blocks         = 250
  steps          = 250
  substeps       = 10
  current        = 0
  target samples = 8.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">250</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">6.2500e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">8.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">6.2500e+04</parameter>
<parameter name="steps" condition="int">250</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2680e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="250">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =8000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 35
    time step          = 0.05
    reference energy   = -22.7072
    reference variance = 0.283823
====================================================
  Execution time = 1.0101e+02
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s035
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 62500 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 6.1078e+04
  VMC Eavg = -2.2669e+01
  VMC Evar = 5.1609e-01
  Total weights = 7.821042184e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.8791e+01
  </log>
</opt>
<opt stage="main" walkers="62500">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.499485256800
                                         uncertainty =       0.001634715759

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.499485256800
                                         uncertainty =       0.001634715759

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000249871575
  error estimate for blocks of size 2^( 2) =       0.000258739693
  error estimate for blocks of size 2^( 3) =       0.000266882868
  error estimate for blocks of size 2^( 4) =       0.000272476278
  error estimate for blocks of size 2^( 5) =       0.000275744286
  error estimate for blocks of size 2^( 6) =       0.000277598485
  error estimate for blocks of size 2^( 7) =       0.000277702763
  error estimate for blocks of size 2^( 8) =       0.000278485738
  error estimate for blocks of size 2^( 9) =       0.000278257408

      target function =                  N/A
              le_mean =     -22.669492554044
             les_mean =     514.421984621693
             stat err =       0.000278011099
             autocorr =       1.237914242594
              std dev =       0.706743539928
             le_variance =       0.499486431230


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266949255404e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3283e-02, overlap shift 2.3283e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.669492554069       residual = 1.08e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.669510946283       residual = 1.01e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.669509781863       residual = 1.27e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.669510074883       residual = 5.54e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.669510813516       residual = 4.14e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.669510705238       residual = 1.16e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.669510448995       residual = 2.69e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.669510365662       residual = 5.62e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 2.3283e-02 is 2.325476e-03

solving harmonic davidson linear method for identity shift 9.3132e-02, overlap shift 9.3132e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.669492554069       residual = 1.08e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.669506084524       residual = 6.09e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.669505403541       residual = 4.09e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.669505594056       residual = 4.38e-08           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.669505698110       residual = 7.52e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          4 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 9.3132e-02 is 1.269843e-03

solving harmonic davidson linear method for identity shift 3.7253e-01, overlap shift 3.7253e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.669492554069       residual = 1.08e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.669499130692       residual = 2.70e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.669499051250       residual = 1.22e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.669499143079       residual = 3.05e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 3.7253e-01 is 6.762526e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.331536 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.1982e+02
  </log>
  <optVariables href="FORM.s035.opt.xml">
ci_001                -7.060574e-01 3 1  ON 0
ci_002                -7.051253e-01 3 1  ON 1
ci_003                -3.676174e-02 3 1  ON 2
ci_004                -3.881421e-02 3 1  ON 3
ci_005                 1.570442e-02 3 1  ON 4
ci_006                 1.679730e-02 3 1  ON 5
ci_007                 1.254179e-02 3 1  ON 6
ci_008                 1.265368e-02 3 1  ON 7
ci_009                -1.161415e-02 3 1  ON 8
ci_010                -1.096233e-02 3 1  ON 9
ci_011                -8.389634e-03 3 1  ON 10
ci_012                -7.358948e-03 3 1  ON 11
ci_013                 9.293498e-03 3 1  ON 12
ci_014                 1.038891e-02 3 1  ON 13
ci_015                 1.189712e-02 3 1  ON 14
ci_016                 1.251099e-02 3 1  ON 15
ci_017                 1.173268e-02 3 1  ON 16
ci_018                 1.086294e-02 3 1  ON 17
ci_019                -3.507052e-03 3 1  ON 18
ci_020                -3.226206e-03 3 1  ON 19
ci_021                -9.300996e-03 3 1  ON 20
ci_022                -1.018470e-02 3 1  ON 21
ci_023                 8.197561e-03 3 1  ON 22
ci_024                 8.106576e-03 3 1  ON 23
ci_025                 3.630509e-03 3 1  ON 24
ci_026                 3.772301e-03 3 1  ON 25
ci_027                 6.475134e-03 3 1  ON 26
ci_028                 5.703094e-03 3 1  ON 27
ci_029                -5.263817e-03 3 1  ON 28
ci_030                -4.390771e-03 3 1  ON 29
ci_031                -7.704567e-03 3 1  ON 30
ci_032                -7.513108e-03 3 1  ON 31
ci_033                 4.579826e-03 3 1  ON 32
ci_034                 5.433476e-03 3 1  ON 33
ci_035                 1.059308e-03 3 1  ON 34
ci_036                 1.163621e-03 3 1  ON 35
ci_037                 4.646310e-03 3 1  ON 36
ci_038                 5.889166e-03 3 1  ON 37
ci_039                 5.496197e-03 3 1  ON 38
ci_040                 5.448966e-03 3 1  ON 39
ci_041                 4.651674e-03 3 1  ON 40
ci_042                 4.995649e-03 3 1  ON 41
ci_043                 5.304742e-03 3 1  ON 42
ci_044                 4.692479e-03 3 1  ON 43
ci_045                 2.731502e-03 3 1  ON 44
ci_046                 2.725657e-03 3 1  ON 45
ci_047                -6.624058e-04 3 1  ON 46
ci_048                -1.067531e-03 3 1  ON 47
ci_049                 2.434915e-03 3 1  ON 48
ci_050                 2.060841e-03 3 1  ON 49
ci_051                -1.142851e-03 3 1  ON 50
ci_052                -1.726187e-03 3 1  ON 51
ci_053                -2.504404e-03 3 1  ON 52
ci_054                -3.792954e-03 3 1  ON 53
ci_055                -1.388627e-03 3 1  ON 54
ci_056                -1.754307e-03 3 1  ON 55
ci_057                -1.796155e-03 3 1  ON 56
ci_058                -1.637159e-03 3 1  ON 57
ci_059                 7.472502e-04 3 1  ON 58
ci_060                 1.060098e-03 3 1  ON 59
ci_061                -1.275199e-04 3 1  ON 60
ci_062                -7.110931e-05 3 1  ON 61
ci_063                -5.541789e-04 3 1  ON 62
ci_064                -1.379524e-03 3 1  ON 63
ci_065                -2.583973e-03 3 1  ON 64
ci_066                -1.852102e-03 3 1  ON 65
ci_067                -2.438444e-03 3 1  ON 66
ci_068                -1.574525e-03 3 1  ON 67
ci_069                -1.568215e-04 3 1  ON 68
ci_070                -4.862838e-04 3 1  ON 69
ci_071                -2.164981e-03 3 1  ON 70
ci_072                -1.612284e-03 3 1  ON 71
ci_073                 1.603886e-04 3 1  ON 72
ci_074                -9.728859e-05 3 1  ON 73
ci_075                -5.096943e-04 3 1  ON 74
ci_076                -3.715266e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="250">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =8000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 35
    time step          = 0.05
    reference energy   = -22.536
    reference variance = 0.628035
====================================================
  Execution time = 1.0020e+02
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s035
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 62500 
  VMC Eavg = -2.2670e+01
  VMC Evar = 5.0912e-01
  Total weights = 7.8206e+06
  Execution time = 1.4414e+01
  </log>
</opt>
<opt stage="main" walkers="62500">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.497495757163
                                         uncertainty =       0.001444741626

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.497495757163
                                         uncertainty =       0.001444741626

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000249373858
  error estimate for blocks of size 2^( 2) =       0.000258332503
  error estimate for blocks of size 2^( 3) =       0.000266284945
  error estimate for blocks of size 2^( 4) =       0.000271929909
  error estimate for blocks of size 2^( 5) =       0.000275320505
  error estimate for blocks of size 2^( 6) =       0.000277125185
  error estimate for blocks of size 2^( 7) =       0.000278537862
  error estimate for blocks of size 2^( 8) =       0.000277539732
  error estimate for blocks of size 2^( 9) =       0.000276226649

      target function =                  N/A
              le_mean =     -22.669860645102
             les_mean =     514.542142236157
             stat err =       0.000277357357
             autocorr =       1.237022304533
              std dev =       0.705335785239
             le_variance =       0.497498569939

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.497419887689
                                         uncertainty =       0.001407060678

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.497419887689
                                         uncertainty =       0.001407060678

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000249354877
  error estimate for blocks of size 2^( 2) =       0.000258305188
  error estimate for blocks of size 2^( 3) =       0.000266251016
  error estimate for blocks of size 2^( 4) =       0.000271895091
  error estimate for blocks of size 2^( 5) =       0.000275292097
  error estimate for blocks of size 2^( 6) =       0.000277073016
  error estimate for blocks of size 2^( 7) =       0.000278467870
  error estimate for blocks of size 2^( 8) =       0.000277488971
  error estimate for blocks of size 2^( 9) =       0.000276199458

      target function =                  N/A
              le_mean =     -22.669832558200
             les_mean =     514.455934134044
             stat err =       0.000277307329
             autocorr =       1.236764362211
              std dev =       0.705282096867
             le_variance =       0.497422836162

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.497577935729
                                         uncertainty =       0.001383408184

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.497577935729
                                         uncertainty =       0.001383408184

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000249394418
  error estimate for blocks of size 2^( 2) =       0.000258338063
  error estimate for blocks of size 2^( 3) =       0.000266277778
  error estimate for blocks of size 2^( 4) =       0.000271918230
  error estimate for blocks of size 2^( 5) =       0.000275313980
  error estimate for blocks of size 2^( 6) =       0.000277092665
  error estimate for blocks of size 2^( 7) =       0.000278503473
  error estimate for blocks of size 2^( 8) =       0.000277525313
  error estimate for blocks of size 2^( 9) =       0.000276230054

      target function =                  N/A
              le_mean =     -22.669851559393
             les_mean =     514.462073314671
             stat err =       0.000277337876
             autocorr =       1.236644619827
              std dev =       0.705393937447
             le_variance =       0.497580606986

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.497126447831
                                         uncertainty =       0.001430561323

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.497126447831
                                         uncertainty =       0.001430561323

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000249281287
  error estimate for blocks of size 2^( 2) =       0.000258236694
  error estimate for blocks of size 2^( 3) =       0.000266189542
  error estimate for blocks of size 2^( 4) =       0.000271835181
  error estimate for blocks of size 2^( 5) =       0.000275231050
  error estimate for blocks of size 2^( 6) =       0.000277020278
  error estimate for blocks of size 2^( 7) =       0.000278423294
  error estimate for blocks of size 2^( 8) =       0.000277428453
  error estimate for blocks of size 2^( 9) =       0.000276107132

      target function =                  N/A
              le_mean =     -22.669842317950
             les_mean =     514.435026595134
             stat err =       0.000277244789
             autocorr =       1.236936569870
              std dev =       0.705073953152
             le_variance =       0.497129279413


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.669860645102        initial  <--
     2.3283e-02     2.3283e-01             2.3255e-03       -22.669832558200
     9.3132e-02     9.3132e-01             1.2698e-03       -22.669851559393
     3.7253e-01     3.7253e+00             6.7625e-04       -22.669842317950

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 172.5549
  </log>
  <optVariables href="FORM.s035.opt.xml">
ci_001                -7.065474e-01 3 1  ON 0
ci_002                -7.046657e-01 3 1  ON 1
ci_003                -3.746577e-02 3 1  ON 2
ci_004                -3.870759e-02 3 1  ON 3
ci_005                 1.577698e-02 3 1  ON 4
ci_006                 1.552746e-02 3 1  ON 5
ci_007                 1.260851e-02 3 1  ON 6
ci_008                 1.282760e-02 3 1  ON 7
ci_009                -1.141969e-02 3 1  ON 8
ci_010                -1.129496e-02 3 1  ON 9
ci_011                -8.493190e-03 3 1  ON 10
ci_012                -8.188427e-03 3 1  ON 11
ci_013                 9.574799e-03 3 1  ON 12
ci_014                 9.204741e-03 3 1  ON 13
ci_015                 1.214942e-02 3 1  ON 14
ci_016                 1.256713e-02 3 1  ON 15
ci_017                 1.068131e-02 3 1  ON 16
ci_018                 1.118498e-02 3 1  ON 17
ci_019                -3.692851e-03 3 1  ON 18
ci_020                -3.775572e-03 3 1  ON 19
ci_021                -9.154585e-03 3 1  ON 20
ci_022                -9.159990e-03 3 1  ON 21
ci_023                 8.277052e-03 3 1  ON 22
ci_024                 7.556679e-03 3 1  ON 23
ci_025                 3.599901e-03 3 1  ON 24
ci_026                 4.389037e-03 3 1  ON 25
ci_027                 5.935524e-03 3 1  ON 26
ci_028                 5.924547e-03 3 1  ON 27
ci_029                -4.588975e-03 3 1  ON 28
ci_030                -4.094637e-03 3 1  ON 29
ci_031                -7.352120e-03 3 1  ON 30
ci_032                -7.635310e-03 3 1  ON 31
ci_033                 4.307513e-03 3 1  ON 32
ci_034                 4.680864e-03 3 1  ON 33
ci_035                 1.100284e-03 3 1  ON 34
ci_036                 9.249437e-04 3 1  ON 35
ci_037                 4.928697e-03 3 1  ON 36
ci_038                 4.668144e-03 3 1  ON 37
ci_039                 5.358562e-03 3 1  ON 38
ci_040                 5.575218e-03 3 1  ON 39
ci_041                 5.015963e-03 3 1  ON 40
ci_042                 4.810403e-03 3 1  ON 41
ci_043                 4.711654e-03 3 1  ON 42
ci_044                 4.411723e-03 3 1  ON 43
ci_045                 2.868214e-03 3 1  ON 44
ci_046                 2.945599e-03 3 1  ON 45
ci_047                -6.032912e-04 3 1  ON 46
ci_048                -8.121005e-04 3 1  ON 47
ci_049                 1.453170e-03 3 1  ON 48
ci_050                 2.004542e-03 3 1  ON 49
ci_051                -2.044504e-03 3 1  ON 50
ci_052                -2.352181e-03 3 1  ON 51
ci_053                -2.347922e-03 3 1  ON 52
ci_054                -2.777113e-03 3 1  ON 53
ci_055                -1.302906e-03 3 1  ON 54
ci_056                -1.401813e-03 3 1  ON 55
ci_057                -1.659712e-03 3 1  ON 56
ci_058                -1.277882e-03 3 1  ON 57
ci_059                 2.430111e-04 3 1  ON 58
ci_060                 1.360817e-04 3 1  ON 59
ci_061                 3.003421e-06 3 1  ON 60
ci_062                 4.241737e-04 3 1  ON 61
ci_063                -8.765892e-04 3 1  ON 62
ci_064                -6.345203e-04 3 1  ON 63
ci_065                -2.667655e-03 3 1  ON 64
ci_066                -2.757500e-03 3 1  ON 65
ci_067                -2.764431e-03 3 1  ON 66
ci_068                -1.379779e-03 3 1  ON 67
ci_069                 8.624156e-05 3 1  ON 68
ci_070                -3.936378e-04 3 1  ON 69
ci_071                -2.373184e-03 3 1  ON 70
ci_072                -2.018129e-03 3 1  ON 71
ci_073                 3.204230e-04 3 1  ON 72
ci_074                 4.622008e-04 3 1  ON 73
ci_075                -2.206195e-04 3 1  ON 74
ci_076                -4.045844e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 2.9238e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s036 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s036 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=36  my_counter=0
  time step      = 5.0000e-02
  blocks         = 250
  steps          = 250
  substeps       = 10
  current        = 0
  target samples = 8.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">250</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">6.2500e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">8.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">6.2500e+04</parameter>
<parameter name="steps" condition="int">250</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2678e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="250">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =8000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 36
    time step          = 0.05
    reference energy   = -22.6426
    reference variance = 0.501653
====================================================
  Execution time = 1.0093e+02
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s036
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 62500 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 6.1082e+04
  VMC Eavg = -2.2670e+01
  VMC Evar = 5.1142e-01
  Total weights = 7.821063314e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.8811e+01
  </log>
</opt>
<opt stage="main" walkers="62500">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.498912625284
                                         uncertainty =       0.001464854056

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.498912625284
                                         uncertainty =       0.001464854056

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000249728638
  error estimate for blocks of size 2^( 2) =       0.000258591653
  error estimate for blocks of size 2^( 3) =       0.000266606028
  error estimate for blocks of size 2^( 4) =       0.000272371602
  error estimate for blocks of size 2^( 5) =       0.000275699995
  error estimate for blocks of size 2^( 6) =       0.000277559610
  error estimate for blocks of size 2^( 7) =       0.000278594207
  error estimate for blocks of size 2^( 8) =       0.000278703343
  error estimate for blocks of size 2^( 9) =       0.000280102021

      target function =                  N/A
              le_mean =     -22.670149151415
             les_mean =     514.447078958892
             stat err =       0.000278739795
             autocorr =       1.245837088951
              std dev =       0.706339254299
             le_variance =       0.498915142164


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.267014915141e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3283e-01, overlap shift 2.3283e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.670149151443       residual = 5.00e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.670154465701       residual = 1.19e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.670155053777       residual = 6.30e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.670155080020       residual = 1.97e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 2.3283e-01 is 5.540573e-04

solving harmonic davidson linear method for identity shift 9.3132e-01, overlap shift 9.3132e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.670149151443       residual = 5.00e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.670151124284       residual = 6.16e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.670151289738       residual = 2.18e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.670151301481       residual = 6.03e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 9.3132e-01 is 2.309282e-04

solving harmonic davidson linear method for identity shift 3.7253e+00, overlap shift 3.7253e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.670149151443       residual = 5.00e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.670149712697       residual = 6.46e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.670149754289       residual = 1.81e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.670149760517       residual = 4.79e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 3.7253e+00 is 6.931204e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.332916 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.1976e+02
  </log>
  <optVariables href="FORM.s036.opt.xml">
ci_001                -7.065300e-01 3 1  ON 0
ci_002                -7.046836e-01 3 1  ON 1
ci_003                -3.736846e-02 3 1  ON 2
ci_004                -3.869033e-02 3 1  ON 3
ci_005                 1.582671e-02 3 1  ON 4
ci_006                 1.563746e-02 3 1  ON 5
ci_007                 1.253032e-02 3 1  ON 6
ci_008                 1.280720e-02 3 1  ON 7
ci_009                -1.146865e-02 3 1  ON 8
ci_010                -1.127001e-02 3 1  ON 9
ci_011                -8.480893e-03 3 1  ON 10
ci_012                -8.187768e-03 3 1  ON 11
ci_013                 9.551721e-03 3 1  ON 12
ci_014                 9.235274e-03 3 1  ON 13
ci_015                 1.227427e-02 3 1  ON 14
ci_016                 1.248931e-02 3 1  ON 15
ci_017                 1.063478e-02 3 1  ON 16
ci_018                 1.107687e-02 3 1  ON 17
ci_019                -3.673392e-03 3 1  ON 18
ci_020                -3.891765e-03 3 1  ON 19
ci_021                -9.162098e-03 3 1  ON 20
ci_022                -9.220012e-03 3 1  ON 21
ci_023                 8.280047e-03 3 1  ON 22
ci_024                 7.658030e-03 3 1  ON 23
ci_025                 3.581411e-03 3 1  ON 24
ci_026                 4.269588e-03 3 1  ON 25
ci_027                 6.166452e-03 3 1  ON 26
ci_028                 6.027327e-03 3 1  ON 27
ci_029                -4.783031e-03 3 1  ON 28
ci_030                -4.191210e-03 3 1  ON 29
ci_031                -7.393239e-03 3 1  ON 30
ci_032                -7.605856e-03 3 1  ON 31
ci_033                 4.230449e-03 3 1  ON 32
ci_034                 4.647286e-03 3 1  ON 33
ci_035                 1.216246e-03 3 1  ON 34
ci_036                 1.009895e-03 3 1  ON 35
ci_037                 4.955792e-03 3 1  ON 36
ci_038                 4.659399e-03 3 1  ON 37
ci_039                 5.318311e-03 3 1  ON 38
ci_040                 5.508141e-03 3 1  ON 39
ci_041                 4.960282e-03 3 1  ON 40
ci_042                 4.812658e-03 3 1  ON 41
ci_043                 4.860145e-03 3 1  ON 42
ci_044                 4.478715e-03 3 1  ON 43
ci_045                 2.779064e-03 3 1  ON 44
ci_046                 2.934331e-03 3 1  ON 45
ci_047                -5.809061e-04 3 1  ON 46
ci_048                -7.160004e-04 3 1  ON 47
ci_049                 1.386511e-03 3 1  ON 48
ci_050                 1.928822e-03 3 1  ON 49
ci_051                -1.961392e-03 3 1  ON 50
ci_052                -2.188614e-03 3 1  ON 51
ci_053                -2.475543e-03 3 1  ON 52
ci_054                -2.739768e-03 3 1  ON 53
ci_055                -1.373810e-03 3 1  ON 54
ci_056                -1.476339e-03 3 1  ON 55
ci_057                -1.698042e-03 3 1  ON 56
ci_058                -1.397556e-03 3 1  ON 57
ci_059                 2.370572e-04 3 1  ON 58
ci_060                 1.205915e-04 3 1  ON 59
ci_061                 9.941945e-05 3 1  ON 60
ci_062                 3.003496e-04 3 1  ON 61
ci_063                -8.912620e-04 3 1  ON 62
ci_064                -6.063946e-04 3 1  ON 63
ci_065                -2.700441e-03 3 1  ON 64
ci_066                -2.712440e-03 3 1  ON 65
ci_067                -2.747307e-03 3 1  ON 66
ci_068                -1.416707e-03 3 1  ON 67
ci_069                 8.069840e-05 3 1  ON 68
ci_070                -2.230943e-04 3 1  ON 69
ci_071                -2.360715e-03 3 1  ON 70
ci_072                -2.029623e-03 3 1  ON 71
ci_073                 2.875501e-04 3 1  ON 72
ci_074                 3.418213e-04 3 1  ON 73
ci_075                -2.394979e-04 3 1  ON 74
ci_076                -4.229273e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="250">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =8000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 36
    time step          = 0.05
    reference energy   = -22.5626
    reference variance = 0.775597
====================================================
  Execution time = 9.9162e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s036
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 62500 
  VMC Eavg = -2.2670e+01
  VMC Evar = 5.1430e-01
  Total weights = 7.8204e+06
  Execution time = 1.4710e+01
  </log>
</opt>
<opt stage="main" walkers="62500">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

ERROR CostFunction-> Number of Effective Walkers is too small! 
  Number of effective walkers (samples) / total number of samples = 0.00199788
  User specified threshold minwalkers = 0.3
  If this message appears frequently. You might have to be cautious. 
  Find info about parameter "minwalkers" in the user manual!
Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.500811026511
                                         uncertainty =       0.001886189550

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.500811026511
                                         uncertainty =       0.001886189550

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000250202334
  error estimate for blocks of size 2^( 2) =       0.000259309731
  error estimate for blocks of size 2^( 3) =       0.000267257897
  error estimate for blocks of size 2^( 4) =       0.000272966114
  error estimate for blocks of size 2^( 5) =       0.000276218892
  error estimate for blocks of size 2^( 6) =       0.000277752865
  error estimate for blocks of size 2^( 7) =       0.000277827180
  error estimate for blocks of size 2^( 8) =       0.000278559354
  error estimate for blocks of size 2^( 9) =       0.000279819624

      target function =                  N/A
              le_mean =     -22.669960758272
             les_mean =     514.442033585747
             stat err =       0.000278489756
             autocorr =       1.238898523643
              std dev =       0.707679067705
             le_variance =       0.500809662868

ERROR CostFunction-> Number of Effective Walkers is too small! 
  Number of effective walkers (samples) / total number of samples = 0.000138579
  User specified threshold minwalkers = 0.3
  If this message appears frequently. You might have to be cautious. 
  Find info about parameter "minwalkers" in the user manual!
Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.500832363249
                                         uncertainty =       0.001890135627

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.500832363249
                                         uncertainty =       0.001890135627

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000250207651
  error estimate for blocks of size 2^( 2) =       0.000259312677
  error estimate for blocks of size 2^( 3) =       0.000267260144
  error estimate for blocks of size 2^( 4) =       0.000272967324
  error estimate for blocks of size 2^( 5) =       0.000276223978
  error estimate for blocks of size 2^( 6) =       0.000277762675
  error estimate for blocks of size 2^( 7) =       0.000277837968
  error estimate for blocks of size 2^( 8) =       0.000278578109
  error estimate for blocks of size 2^( 9) =       0.000279840280

      target function =                  N/A
              le_mean =     -22.669960512141
             les_mean =     514.443011118304
             stat err =       0.000278504758
             autocorr =       1.238979342159
              std dev =       0.707694108231
             le_variance =       0.500830950824

ERROR CostFunction-> Number of Effective Walkers is too small! 
  Number of effective walkers (samples) / total number of samples = 0.00201435
  User specified threshold minwalkers = 0.3
  If this message appears frequently. You might have to be cautious. 
  Find info about parameter "minwalkers" in the user manual!
Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.500825570892
                                         uncertainty =       0.001888114002

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.500825570892
                                         uncertainty =       0.001888114002

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000250205960
  error estimate for blocks of size 2^( 2) =       0.000259311342
  error estimate for blocks of size 2^( 3) =       0.000267258926
  error estimate for blocks of size 2^( 4) =       0.000272966697
  error estimate for blocks of size 2^( 5) =       0.000276222666
  error estimate for blocks of size 2^( 6) =       0.000277760932
  error estimate for blocks of size 2^( 7) =       0.000277836083
  error estimate for blocks of size 2^( 8) =       0.000278574541
  error estimate for blocks of size 2^( 9) =       0.000279837267

      target function =                  N/A
              le_mean =     -22.669959795046
             les_mean =     514.447905735240
             stat err =       0.000278502206
             autocorr =       1.238973382504
              std dev =       0.707689325208
             le_variance =       0.500824181014

ERROR CostFunction-> Number of Effective Walkers is too small! 
  Number of effective walkers (samples) / total number of samples = 0.00617345
  User specified threshold minwalkers = 0.3
  If this message appears frequently. You might have to be cautious. 
  Find info about parameter "minwalkers" in the user manual!
Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.500809789840
                                         uncertainty =       0.001886379471

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.500809789840
                                         uncertainty =       0.001886379471

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000250202024
  error estimate for blocks of size 2^( 2) =       0.000259309178
  error estimate for blocks of size 2^( 3) =       0.000267257283
  error estimate for blocks of size 2^( 4) =       0.000272965415
  error estimate for blocks of size 2^( 5) =       0.000276218640
  error estimate for blocks of size 2^( 6) =       0.000277753327
  error estimate for blocks of size 2^( 7) =       0.000277827897
  error estimate for blocks of size 2^( 8) =       0.000278561371
  error estimate for blocks of size 2^( 9) =       0.000279821535

      target function =                  N/A
              le_mean =     -22.669960332176
             les_mean =     514.443875333447
             stat err =       0.000278491033
             autocorr =       1.238912953404
              std dev =       0.707678191414
             le_variance =       0.500808422603


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.669960758272        initial  <--
     2.3283e-01     2.3283e+00             5.5406e-04       -22.669960512141
     9.3132e-01     9.3132e+00             2.3093e-04       -22.669959795046
     3.7253e+00     3.7253e+01             6.9312e-05       -22.669960332176

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 171.5818
  </log>
  <optVariables href="FORM.s036.opt.xml">
ci_001                -7.065474e-01 3 1  ON 0
ci_002                -7.046657e-01 3 1  ON 1
ci_003                -3.746577e-02 3 1  ON 2
ci_004                -3.870759e-02 3 1  ON 3
ci_005                 1.577698e-02 3 1  ON 4
ci_006                 1.552746e-02 3 1  ON 5
ci_007                 1.260851e-02 3 1  ON 6
ci_008                 1.282760e-02 3 1  ON 7
ci_009                -1.141969e-02 3 1  ON 8
ci_010                -1.129496e-02 3 1  ON 9
ci_011                -8.493190e-03 3 1  ON 10
ci_012                -8.188427e-03 3 1  ON 11
ci_013                 9.574799e-03 3 1  ON 12
ci_014                 9.204741e-03 3 1  ON 13
ci_015                 1.214942e-02 3 1  ON 14
ci_016                 1.256713e-02 3 1  ON 15
ci_017                 1.068131e-02 3 1  ON 16
ci_018                 1.118498e-02 3 1  ON 17
ci_019                -3.692851e-03 3 1  ON 18
ci_020                -3.775572e-03 3 1  ON 19
ci_021                -9.154585e-03 3 1  ON 20
ci_022                -9.159990e-03 3 1  ON 21
ci_023                 8.277052e-03 3 1  ON 22
ci_024                 7.556679e-03 3 1  ON 23
ci_025                 3.599901e-03 3 1  ON 24
ci_026                 4.389037e-03 3 1  ON 25
ci_027                 5.935524e-03 3 1  ON 26
ci_028                 5.924547e-03 3 1  ON 27
ci_029                -4.588975e-03 3 1  ON 28
ci_030                -4.094637e-03 3 1  ON 29
ci_031                -7.352120e-03 3 1  ON 30
ci_032                -7.635310e-03 3 1  ON 31
ci_033                 4.307513e-03 3 1  ON 32
ci_034                 4.680864e-03 3 1  ON 33
ci_035                 1.100284e-03 3 1  ON 34
ci_036                 9.249437e-04 3 1  ON 35
ci_037                 4.928697e-03 3 1  ON 36
ci_038                 4.668144e-03 3 1  ON 37
ci_039                 5.358562e-03 3 1  ON 38
ci_040                 5.575218e-03 3 1  ON 39
ci_041                 5.015963e-03 3 1  ON 40
ci_042                 4.810403e-03 3 1  ON 41
ci_043                 4.711654e-03 3 1  ON 42
ci_044                 4.411723e-03 3 1  ON 43
ci_045                 2.868214e-03 3 1  ON 44
ci_046                 2.945599e-03 3 1  ON 45
ci_047                -6.032912e-04 3 1  ON 46
ci_048                -8.121005e-04 3 1  ON 47
ci_049                 1.453170e-03 3 1  ON 48
ci_050                 2.004542e-03 3 1  ON 49
ci_051                -2.044504e-03 3 1  ON 50
ci_052                -2.352181e-03 3 1  ON 51
ci_053                -2.347922e-03 3 1  ON 52
ci_054                -2.777113e-03 3 1  ON 53
ci_055                -1.302906e-03 3 1  ON 54
ci_056                -1.401813e-03 3 1  ON 55
ci_057                -1.659712e-03 3 1  ON 56
ci_058                -1.277882e-03 3 1  ON 57
ci_059                 2.430111e-04 3 1  ON 58
ci_060                 1.360817e-04 3 1  ON 59
ci_061                 3.003421e-06 3 1  ON 60
ci_062                 4.241737e-04 3 1  ON 61
ci_063                -8.765892e-04 3 1  ON 62
ci_064                -6.345203e-04 3 1  ON 63
ci_065                -2.667655e-03 3 1  ON 64
ci_066                -2.757500e-03 3 1  ON 65
ci_067                -2.764431e-03 3 1  ON 66
ci_068                -1.379779e-03 3 1  ON 67
ci_069                 8.624156e-05 3 1  ON 68
ci_070                -3.936378e-04 3 1  ON 69
ci_071                -2.373184e-03 3 1  ON 70
ci_072                -2.018129e-03 3 1  ON 71
ci_073                 3.204230e-04 3 1  ON 72
ci_074                 4.622008e-04 3 1  ON 73
ci_075                -2.206195e-04 3 1  ON 74
ci_076                -4.045844e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 2.9135e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s037 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s037 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=37  my_counter=0
  time step      = 5.0000e-02
  blocks         = 250
  steps          = 250
  substeps       = 10
  current        = 0
  target samples = 8.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">250</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">6.2500e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">8.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">6.2500e+04</parameter>
<parameter name="steps" condition="int">250</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2676e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="250">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =8000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 37
    time step          = 0.05
    reference energy   = -22.5721
    reference variance = 0.979959
====================================================
  Execution time = 1.0072e+02
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s037
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 62500 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 6.1135e+04
  VMC Eavg = -2.2670e+01
  VMC Evar = 5.1690e-01
  Total weights = 7.821691096e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.8808e+01
  </log>
</opt>
<opt stage="main" walkers="62500">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.500354683815
                                         uncertainty =       0.002074219658

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.500354683815
                                         uncertainty =       0.002074219658

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000250089151
  error estimate for blocks of size 2^( 2) =       0.000258925174
  error estimate for blocks of size 2^( 3) =       0.000266787350
  error estimate for blocks of size 2^( 4) =       0.000272859539
  error estimate for blocks of size 2^( 5) =       0.000276127520
  error estimate for blocks of size 2^( 6) =       0.000278196873
  error estimate for blocks of size 2^( 7) =       0.000279550377
  error estimate for blocks of size 2^( 8) =       0.000280520760
  error estimate for blocks of size 2^( 9) =       0.000281739548

      target function =                  N/A
              le_mean =     -22.669628726647
             les_mean =     514.428969210894
             stat err =       0.000280001889
             autocorr =       1.253522747328
              std dev =       0.707358938058
             le_variance =       0.500356667251


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266962872665e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3283e+00, overlap shift 2.3283e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.669628726665       residual = 8.64e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.669629970379       residual = 1.80e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.669630059042       residual = 6.70e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.669630042579       residual = 1.80e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 2.3283e+00 is 1.620562e-04

solving harmonic davidson linear method for identity shift 9.3132e+00, overlap shift 9.3132e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.669628726665       residual = 8.64e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.669629053612       residual = 1.89e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.669629082279       residual = 6.89e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.669629077711       residual = 1.89e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 9.3132e+00 is 4.233033e-05

solving harmonic davidson linear method for identity shift 3.7253e+01, overlap shift 3.7253e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.669628726665       residual = 8.64e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.669628809468       residual = 1.92e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.669628817095       residual = 6.96e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.669628815933       residual = 1.91e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 3.7253e+01 is 1.070281e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.334327 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.1955e+02
  </log>
  <optVariables href="FORM.s037.opt.xml">
ci_001                -7.065463e-01 3 1  ON 0
ci_002                -7.046669e-01 3 1  ON 1
ci_003                -3.746564e-02 3 1  ON 2
ci_004                -3.868763e-02 3 1  ON 3
ci_005                 1.577242e-02 3 1  ON 4
ci_006                 1.552927e-02 3 1  ON 5
ci_007                 1.260546e-02 3 1  ON 6
ci_008                 1.282955e-02 3 1  ON 7
ci_009                -1.142459e-02 3 1  ON 8
ci_010                -1.130440e-02 3 1  ON 9
ci_011                -8.494133e-03 3 1  ON 10
ci_012                -8.193020e-03 3 1  ON 11
ci_013                 9.573030e-03 3 1  ON 12
ci_014                 9.205006e-03 3 1  ON 13
ci_015                 1.217075e-02 3 1  ON 14
ci_016                 1.256435e-02 3 1  ON 15
ci_017                 1.069493e-02 3 1  ON 16
ci_018                 1.115860e-02 3 1  ON 17
ci_019                -3.693383e-03 3 1  ON 18
ci_020                -3.771986e-03 3 1  ON 19
ci_021                -9.162237e-03 3 1  ON 20
ci_022                -9.168492e-03 3 1  ON 21
ci_023                 8.270617e-03 3 1  ON 22
ci_024                 7.565337e-03 3 1  ON 23
ci_025                 3.612347e-03 3 1  ON 24
ci_026                 4.387540e-03 3 1  ON 25
ci_027                 5.941131e-03 3 1  ON 26
ci_028                 5.946183e-03 3 1  ON 27
ci_029                -4.583639e-03 3 1  ON 28
ci_030                -4.100087e-03 3 1  ON 29
ci_031                -7.348252e-03 3 1  ON 30
ci_032                -7.659219e-03 3 1  ON 31
ci_033                 4.307185e-03 3 1  ON 32
ci_034                 4.685368e-03 3 1  ON 33
ci_035                 1.103042e-03 3 1  ON 34
ci_036                 9.374805e-04 3 1  ON 35
ci_037                 4.940204e-03 3 1  ON 36
ci_038                 4.666639e-03 3 1  ON 37
ci_039                 5.355592e-03 3 1  ON 38
ci_040                 5.586078e-03 3 1  ON 39
ci_041                 4.994081e-03 3 1  ON 40
ci_042                 4.812605e-03 3 1  ON 41
ci_043                 4.702603e-03 3 1  ON 42
ci_044                 4.427931e-03 3 1  ON 43
ci_045                 2.879352e-03 3 1  ON 44
ci_046                 2.958010e-03 3 1  ON 45
ci_047                -6.020530e-04 3 1  ON 46
ci_048                -8.067552e-04 3 1  ON 47
ci_049                 1.448245e-03 3 1  ON 48
ci_050                 2.004448e-03 3 1  ON 49
ci_051                -2.035945e-03 3 1  ON 50
ci_052                -2.341057e-03 3 1  ON 51
ci_053                -2.353635e-03 3 1  ON 52
ci_054                -2.775380e-03 3 1  ON 53
ci_055                -1.260575e-03 3 1  ON 54
ci_056                -1.406385e-03 3 1  ON 55
ci_057                -1.673955e-03 3 1  ON 56
ci_058                -1.278484e-03 3 1  ON 57
ci_059                 2.491979e-04 3 1  ON 58
ci_060                 1.608584e-04 3 1  ON 59
ci_061                -5.551936e-06 3 1  ON 60
ci_062                 3.994172e-04 3 1  ON 61
ci_063                -8.738884e-04 3 1  ON 62
ci_064                -6.341779e-04 3 1  ON 63
ci_065                -2.652471e-03 3 1  ON 64
ci_066                -2.765852e-03 3 1  ON 65
ci_067                -2.748569e-03 3 1  ON 66
ci_068                -1.400213e-03 3 1  ON 67
ci_069                 9.543103e-05 3 1  ON 68
ci_070                -4.063179e-04 3 1  ON 69
ci_071                -2.369304e-03 3 1  ON 70
ci_072                -2.010871e-03 3 1  ON 71
ci_073                 3.157497e-04 3 1  ON 72
ci_074                 4.704665e-04 3 1  ON 73
ci_075                -2.106542e-04 3 1  ON 74
ci_076                -3.977355e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="250">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =8000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 37
    time step          = 0.05
    reference energy   = -22.606
    reference variance = 0.293628
====================================================
  Execution time = 9.8553e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s037
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 62500 
  VMC Eavg = -2.2670e+01
  VMC Evar = 5.1319e-01
  Total weights = 7.8208e+06
  Execution time = 1.4372e+01
  </log>
</opt>
<opt stage="main" walkers="62500">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

ERROR CostFunction-> Number of Effective Walkers is too small! 
  Number of effective walkers (samples) / total number of samples = 0.0264904
  User specified threshold minwalkers = 0.3
  If this message appears frequently. You might have to be cautious. 
  Find info about parameter "minwalkers" in the user manual!
Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.498988958065
                                         uncertainty =       0.001351617429

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.498988958065
                                         uncertainty =       0.001351617429

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000249747860
  error estimate for blocks of size 2^( 2) =       0.000258588728
  error estimate for blocks of size 2^( 3) =       0.000266687232
  error estimate for blocks of size 2^( 4) =       0.000272639701
  error estimate for blocks of size 2^( 5) =       0.000276188982
  error estimate for blocks of size 2^( 6) =       0.000277548363
  error estimate for blocks of size 2^( 7) =       0.000279127174
  error estimate for blocks of size 2^( 8) =       0.000279573306
  error estimate for blocks of size 2^( 9) =       0.000280193776

      target function =                  N/A
              le_mean =     -22.670031037595
             les_mean =     514.443628693042
             stat err =       0.000279110655
             autocorr =       1.248962157570
              std dev =       0.706393621637
             le_variance =       0.498991948689

ERROR CostFunction-> Number of Effective Walkers is too small! 
  Number of effective walkers (samples) / total number of samples = 0.000602264
  User specified threshold minwalkers = 0.3
  If this message appears frequently. You might have to be cautious. 
  Find info about parameter "minwalkers" in the user manual!
Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.498987189056
                                         uncertainty =       0.001350118517

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.498987189056
                                         uncertainty =       0.001350118517

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000249747419
  error estimate for blocks of size 2^( 2) =       0.000258587938
  error estimate for blocks of size 2^( 3) =       0.000266686470
  error estimate for blocks of size 2^( 4) =       0.000272638850
  error estimate for blocks of size 2^( 5) =       0.000276187782
  error estimate for blocks of size 2^( 6) =       0.000277546538
  error estimate for blocks of size 2^( 7) =       0.000279125567
  error estimate for blocks of size 2^( 8) =       0.000279573402
  error estimate for blocks of size 2^( 9) =       0.000280193490

      target function =                  N/A
              le_mean =     -22.670031259190
             les_mean =     514.443477249380
             stat err =       0.000279109749
             autocorr =       1.248958460297
              std dev =       0.706392375033
             le_variance =       0.498990187505

ERROR CostFunction-> Number of Effective Walkers is too small! 
  Number of effective walkers (samples) / total number of samples = 0.0269555
  User specified threshold minwalkers = 0.3
  If this message appears frequently. You might have to be cautious. 
  Find info about parameter "minwalkers" in the user manual!
Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.498987595578
                                         uncertainty =       0.001350817135

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.498987595578
                                         uncertainty =       0.001350817135

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000249747520
  error estimate for blocks of size 2^( 2) =       0.000258588200
  error estimate for blocks of size 2^( 3) =       0.000266686725
  error estimate for blocks of size 2^( 4) =       0.000272639131
  error estimate for blocks of size 2^( 5) =       0.000276188220
  error estimate for blocks of size 2^( 6) =       0.000277547283
  error estimate for blocks of size 2^( 7) =       0.000279126233
  error estimate for blocks of size 2^( 8) =       0.000279573228
  error estimate for blocks of size 2^( 9) =       0.000280193528

      target function =                  N/A
              le_mean =     -22.670031100305
             les_mean =     514.444061582551
             stat err =       0.000279110068
             autocorr =       1.248960306061
              std dev =       0.706392660210
             le_variance =       0.498990590399

ERROR CostFunction-> Number of Effective Walkers is too small! 
  Number of effective walkers (samples) / total number of samples = 0.0830864
  User specified threshold minwalkers = 0.3
  If this message appears frequently. You might have to be cautious. 
  Find info about parameter "minwalkers" in the user manual!
Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.498988730465
                                         uncertainty =       0.001351514383

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.498988730465
                                         uncertainty =       0.001351514383

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000249747803
  error estimate for blocks of size 2^( 2) =       0.000258588647
  error estimate for blocks of size 2^( 3) =       0.000266687154
  error estimate for blocks of size 2^( 4) =       0.000272639615
  error estimate for blocks of size 2^( 5) =       0.000276188871
  error estimate for blocks of size 2^( 6) =       0.000277548215
  error estimate for blocks of size 2^( 7) =       0.000279127044
  error estimate for blocks of size 2^( 8) =       0.000279573289
  error estimate for blocks of size 2^( 9) =       0.000280193734

      target function =                  N/A
              le_mean =     -22.670031037893
             les_mean =     514.443569837975
             stat err =       0.000279110570
             autocorr =       1.248961969984
              std dev =       0.706393460915
             le_variance =       0.498991721624


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.670031037595        initial
     2.3283e+00     2.3283e+01             1.6206e-04       -22.670031259190  <--
     9.3132e+00     9.3132e+01             4.2330e-05       -22.670031100305
     3.7253e+01     3.7253e+02             1.0703e-05       -22.670031037893

*****************************************************************************
Applying the update for shift_i =   2.3283e+00     and shift_s =   2.3283e+01
*****************************************************************************

  Execution time = 1.7114e+02
  </log>
  <optVariables href="FORM.s037.opt.xml">
ci_001                -7.065426e-01 3 1  ON 0
ci_002                -7.046710e-01 3 1  ON 1
ci_003                -3.746536e-02 3 1  ON 2
ci_004                -3.862922e-02 3 1  ON 3
ci_005                 1.576001e-02 3 1  ON 4
ci_006                 1.553422e-02 3 1  ON 5
ci_007                 1.259643e-02 3 1  ON 6
ci_008                 1.283464e-02 3 1  ON 7
ci_009                -1.143803e-02 3 1  ON 8
ci_010                -1.133115e-02 3 1  ON 9
ci_011                -8.496541e-03 3 1  ON 10
ci_012                -8.206340e-03 3 1  ON 11
ci_013                 9.568216e-03 3 1  ON 12
ci_014                 9.205670e-03 3 1  ON 13
ci_015                 1.223185e-02 3 1  ON 14
ci_016                 1.255600e-02 3 1  ON 15
ci_017                 1.073336e-02 3 1  ON 16
ci_018                 1.108329e-02 3 1  ON 17
ci_019                -3.695192e-03 3 1  ON 18
ci_020                -3.761612e-03 3 1  ON 19
ci_021                -9.184177e-03 3 1  ON 20
ci_022                -9.192070e-03 3 1  ON 21
ci_023                 8.252792e-03 3 1  ON 22
ci_024                 7.589139e-03 3 1  ON 23
ci_025                 3.647795e-03 3 1  ON 24
ci_026                 4.383395e-03 3 1  ON 25
ci_027                 5.956248e-03 3 1  ON 26
ci_028                 6.004309e-03 3 1  ON 27
ci_029                -4.569322e-03 3 1  ON 28
ci_030                -4.115300e-03 3 1  ON 29
ci_031                -7.337288e-03 3 1  ON 30
ci_032                -7.726932e-03 3 1  ON 31
ci_033                 4.305939e-03 3 1  ON 32
ci_034                 4.697411e-03 3 1  ON 33
ci_035                 1.110463e-03 3 1  ON 34
ci_036                 9.709746e-04 3 1  ON 35
ci_037                 4.972466e-03 3 1  ON 36
ci_038                 4.662306e-03 3 1  ON 37
ci_039                 5.347739e-03 3 1  ON 38
ci_040                 5.615330e-03 3 1  ON 39
ci_041                 4.934489e-03 3 1  ON 40
ci_042                 4.818406e-03 3 1  ON 41
ci_043                 4.677408e-03 3 1  ON 42
ci_044                 4.473658e-03 3 1  ON 43
ci_045                 2.910516e-03 3 1  ON 44
ci_046                 2.993052e-03 3 1  ON 45
ci_047                -5.986895e-04 3 1  ON 46
ci_048                -7.922539e-04 3 1  ON 47
ci_049                 1.434452e-03 3 1  ON 48
ci_050                 2.004481e-03 3 1  ON 49
ci_051                -2.012010e-03 3 1  ON 50
ci_052                -2.309861e-03 3 1  ON 51
ci_053                -2.370023e-03 3 1  ON 52
ci_054                -2.770194e-03 3 1  ON 53
ci_055                -1.140850e-03 3 1  ON 54
ci_056                -1.418680e-03 3 1  ON 55
ci_057                -1.713099e-03 3 1  ON 56
ci_058                -1.280098e-03 3 1  ON 57
ci_059                 2.658484e-04 3 1  ON 58
ci_060                 2.277697e-04 3 1  ON 59
ci_061                -2.957482e-05 3 1  ON 60
ci_062                 3.292566e-04 3 1  ON 61
ci_063                -8.663762e-04 3 1  ON 62
ci_064                -6.332394e-04 3 1  ON 63
ci_065                -2.610188e-03 3 1  ON 64
ci_066                -2.789133e-03 3 1  ON 65
ci_067                -2.705304e-03 3 1  ON 66
ci_068                -1.457526e-03 3 1  ON 67
ci_069                 1.208045e-04 3 1  ON 68
ci_070                -4.416705e-04 3 1  ON 69
ci_071                -2.358554e-03 3 1  ON 70
ci_072                -1.991167e-03 3 1  ON 71
ci_073                 3.031169e-04 3 1  ON 72
ci_074                 4.920354e-04 3 1  ON 73
ci_075                -1.829379e-04 3 1  ON 74
ci_076                -3.784482e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 2.9070e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s038 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s038 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=38  my_counter=0
  time step      = 5.0000e-02
  blocks         = 250
  steps          = 250
  substeps       = 10
  current        = 0
  target samples = 8.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">250</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">6.2500e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">8.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">6.2500e+04</parameter>
<parameter name="steps" condition="int">250</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2674e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="250">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =8000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 38
    time step          = 0.05
    reference energy   = -22.6855
    reference variance = 1.47604
====================================================
  Execution time = 1.0106e+02
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s038
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 62500 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 6.1077e+04
  VMC Eavg = -2.2670e+01
  VMC Evar = 5.1124e-01
  Total weights = 7.820654370e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.8805e+01
  </log>
</opt>
<opt stage="main" walkers="62500">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.498543100309
                                         uncertainty =       0.001726378867

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.498543100309
                                         uncertainty =       0.001726378867

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000249635217
  error estimate for blocks of size 2^( 2) =       0.000258581884
  error estimate for blocks of size 2^( 3) =       0.000266349019
  error estimate for blocks of size 2^( 4) =       0.000272171891
  error estimate for blocks of size 2^( 5) =       0.000275473465
  error estimate for blocks of size 2^( 6) =       0.000277166862
  error estimate for blocks of size 2^( 7) =       0.000278427195
  error estimate for blocks of size 2^( 8) =       0.000278673562
  error estimate for blocks of size 2^( 9) =       0.000278896958

      target function =                  N/A
              le_mean =     -22.669799621073
             les_mean =     514.431051498355
             stat err =       0.000278291144
             autocorr =       1.242759424072
              std dev =       0.706075020337
             le_variance =       0.498541934344


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266979962107e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.8208e-01, overlap shift 5.8208e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.669799621097       residual = 1.26e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.669804284646       residual = 1.10e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.669804489091       residual = 4.70e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.669804493132       residual = 1.12e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 5.8208e-01 is 7.501760e-04

solving harmonic davidson linear method for identity shift 2.3283e+00, overlap shift 2.3283e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.669799621097       residual = 1.26e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.669801007621       residual = 1.16e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.669801071795       residual = 4.13e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.669801069396       residual = 7.89e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 2.3283e+00 is 2.224752e-04

solving harmonic davidson linear method for identity shift 9.3132e+00, overlap shift 9.3132e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.669799621097       residual = 1.26e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.669799984942       residual = 1.26e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.669800002203       residual = 4.44e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.669800001457       residual = 9.93e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 9.3132e+00 is 5.831310e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.335708 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.1988e+02
  </log>
  <optVariables href="FORM.s038.opt.xml">
ci_001                -7.065598e-01 3 1  ON 0
ci_002                -7.046524e-01 3 1  ON 1
ci_003                -3.743923e-02 3 1  ON 2
ci_004                -3.862370e-02 3 1  ON 3
ci_005                 1.583026e-02 3 1  ON 4
ci_006                 1.557648e-02 3 1  ON 5
ci_007                 1.257523e-02 3 1  ON 6
ci_008                 1.279164e-02 3 1  ON 7
ci_009                -1.148718e-02 3 1  ON 8
ci_010                -1.134531e-02 3 1  ON 9
ci_011                -8.439764e-03 3 1  ON 10
ci_012                -8.209534e-03 3 1  ON 11
ci_013                 9.549322e-03 3 1  ON 12
ci_014                 9.243400e-03 3 1  ON 13
ci_015                 1.225005e-02 3 1  ON 14
ci_016                 1.256958e-02 3 1  ON 15
ci_017                 1.088335e-02 3 1  ON 16
ci_018                 1.096510e-02 3 1  ON 17
ci_019                -3.704132e-03 3 1  ON 18
ci_020                -3.726612e-03 3 1  ON 19
ci_021                -9.206671e-03 3 1  ON 20
ci_022                -9.186434e-03 3 1  ON 21
ci_023                 8.306366e-03 3 1  ON 22
ci_024                 7.664402e-03 3 1  ON 23
ci_025                 3.674474e-03 3 1  ON 24
ci_026                 4.324144e-03 3 1  ON 25
ci_027                 5.996213e-03 3 1  ON 26
ci_028                 6.004389e-03 3 1  ON 27
ci_029                -4.513335e-03 3 1  ON 28
ci_030                -4.158458e-03 3 1  ON 29
ci_031                -7.317711e-03 3 1  ON 30
ci_032                -7.709996e-03 3 1  ON 31
ci_033                 4.278786e-03 3 1  ON 32
ci_034                 4.696044e-03 3 1  ON 33
ci_035                 1.120442e-03 3 1  ON 34
ci_036                 9.786155e-04 3 1  ON 35
ci_037                 4.933307e-03 3 1  ON 36
ci_038                 4.664658e-03 3 1  ON 37
ci_039                 5.407602e-03 3 1  ON 38
ci_040                 5.536964e-03 3 1  ON 39
ci_041                 4.933963e-03 3 1  ON 40
ci_042                 4.758406e-03 3 1  ON 41
ci_043                 4.621416e-03 3 1  ON 42
ci_044                 4.506088e-03 3 1  ON 43
ci_045                 3.016621e-03 3 1  ON 44
ci_046                 2.922803e-03 3 1  ON 45
ci_047                -6.122602e-04 3 1  ON 46
ci_048                -7.532421e-04 3 1  ON 47
ci_049                 1.656928e-03 3 1  ON 48
ci_050                 1.895454e-03 3 1  ON 49
ci_051                -1.921967e-03 3 1  ON 50
ci_052                -2.272341e-03 3 1  ON 51
ci_053                -2.415913e-03 3 1  ON 52
ci_054                -2.814698e-03 3 1  ON 53
ci_055                -1.194091e-03 3 1  ON 54
ci_056                -1.423373e-03 3 1  ON 55
ci_057                -1.694739e-03 3 1  ON 56
ci_058                -1.249212e-03 3 1  ON 57
ci_059                 2.920471e-04 3 1  ON 58
ci_060                 2.160360e-04 3 1  ON 59
ci_061                -2.741468e-05 3 1  ON 60
ci_062                 3.255570e-04 3 1  ON 61
ci_063                -8.851552e-04 3 1  ON 62
ci_064                -6.314095e-04 3 1  ON 63
ci_065                -2.582410e-03 3 1  ON 64
ci_066                -2.784806e-03 3 1  ON 65
ci_067                -2.692219e-03 3 1  ON 66
ci_068                -1.571473e-03 3 1  ON 67
ci_069                 9.771698e-05 3 1  ON 68
ci_070                -4.257894e-04 3 1  ON 69
ci_071                -2.331623e-03 3 1  ON 70
ci_072                -1.985756e-03 3 1  ON 71
ci_073                 2.595711e-04 3 1  ON 72
ci_074                 4.556435e-04 3 1  ON 73
ci_075                -1.982516e-04 3 1  ON 74
ci_076                -4.029616e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="250">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =8000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 38
    time step          = 0.05
    reference energy   = -22.7864
    reference variance = 0.612362
====================================================
  Execution time = 9.8977e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s038
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 62500 
  VMC Eavg = -2.2670e+01
  VMC Evar = 5.1484e-01
  Total weights = 7.8203e+06
  Execution time = 1.4357e+01
  </log>
</opt>
<opt stage="main" walkers="62500">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.501530209650
                                         uncertainty =       0.002026166163

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.501530209650
                                         uncertainty =       0.002026166163

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000250381893
  error estimate for blocks of size 2^( 2) =       0.000259301845
  error estimate for blocks of size 2^( 3) =       0.000267321335
  error estimate for blocks of size 2^( 4) =       0.000272905722
  error estimate for blocks of size 2^( 5) =       0.000275879018
  error estimate for blocks of size 2^( 6) =       0.000277913164
  error estimate for blocks of size 2^( 7) =       0.000279111010
  error estimate for blocks of size 2^( 8) =       0.000279326148
  error estimate for blocks of size 2^( 9) =       0.000281088695

      target function =                  N/A
              le_mean =     -22.669848691952
             les_mean =     514.437967282698
             stat err =       0.000279359754
             autocorr =       1.244863813203
              std dev =       0.708186937528
             le_variance =       0.501528738485

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.501897961852
                                         uncertainty =       0.002028989050

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.501897961852
                                         uncertainty =       0.002028989050

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000250473748
  error estimate for blocks of size 2^( 2) =       0.000259389965
  error estimate for blocks of size 2^( 3) =       0.000267401058
  error estimate for blocks of size 2^( 4) =       0.000272985027
  error estimate for blocks of size 2^( 5) =       0.000275955228
  error estimate for blocks of size 2^( 6) =       0.000277977241
  error estimate for blocks of size 2^( 7) =       0.000279177600
  error estimate for blocks of size 2^( 8) =       0.000279378215
  error estimate for blocks of size 2^( 9) =       0.000281143386

      target function =                  N/A
              le_mean =     -22.669854940594
             les_mean =     515.626903336885
             stat err =       0.000279419111
             autocorr =       1.244479605768
              std dev =       0.708446742327
             le_variance =       0.501896786714

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.501568483588
                                         uncertainty =       0.002028395209

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.501568483588
                                         uncertainty =       0.002028395209

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000250391438
  error estimate for blocks of size 2^( 2) =       0.000259309064
  error estimate for blocks of size 2^( 3) =       0.000267327469
  error estimate for blocks of size 2^( 4) =       0.000272911165
  error estimate for blocks of size 2^( 5) =       0.000275883190
  error estimate for blocks of size 2^( 6) =       0.000277915507
  error estimate for blocks of size 2^( 7) =       0.000279113440
  error estimate for blocks of size 2^( 8) =       0.000279325385
  error estimate for blocks of size 2^( 9) =       0.000281090950

      target function =                  N/A
              le_mean =     -22.669848731565
             les_mean =     514.437337318637
             stat err =       0.000279361321
             autocorr =       1.244782863289
              std dev =       0.708213935810
             le_variance =       0.501566978876

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.501535319853
                                         uncertainty =       0.002026471655

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.501535319853
                                         uncertainty =       0.002026471655

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000250383167
  error estimate for blocks of size 2^( 2) =       0.000259302816
  error estimate for blocks of size 2^( 3) =       0.000267322232
  error estimate for blocks of size 2^( 4) =       0.000272906702
  error estimate for blocks of size 2^( 5) =       0.000275880768
  error estimate for blocks of size 2^( 6) =       0.000277914328
  error estimate for blocks of size 2^( 7) =       0.000279112007
  error estimate for blocks of size 2^( 8) =       0.000279324659
  error estimate for blocks of size 2^( 9) =       0.000281087663

      target function =                  N/A
              le_mean =     -22.669847826742
             les_mean =     514.460220031877
             stat err =       0.000279359664
             autocorr =       1.244850344626
              std dev =       0.708190540977
             le_variance =       0.501533842330


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.669848691952        initial
     5.8208e-01     5.8208e+00             7.5018e-04       -22.669854940594  <--
     2.3283e+00     2.3283e+01             2.2248e-04       -22.669848731565
     9.3132e+00     9.3132e+01             5.8313e-05       -22.669847826742

*****************************************************************************
Applying the update for shift_i =   5.8208e-01     and shift_s =   5.8208e+00
*****************************************************************************

  Execution time = 1.7143e+02
  </log>
  <optVariables href="FORM.s038.opt.xml">
ci_001                -7.066156e-01 3 1  ON 0
ci_002                -7.045953e-01 3 1  ON 1
ci_003                -3.736769e-02 3 1  ON 2
ci_004                -3.860894e-02 3 1  ON 3
ci_005                 1.597949e-02 3 1  ON 4
ci_006                 1.566633e-02 3 1  ON 5
ci_007                 1.251624e-02 3 1  ON 6
ci_008                 1.268516e-02 3 1  ON 7
ci_009                -1.160050e-02 3 1  ON 8
ci_010                -1.138004e-02 3 1  ON 9
ci_011                -8.293824e-03 3 1  ON 10
ci_012                -8.213537e-03 3 1  ON 11
ci_013                 9.499624e-03 3 1  ON 12
ci_014                 9.335889e-03 3 1  ON 13
ci_015                 1.230325e-02 3 1  ON 14
ci_016                 1.259452e-02 3 1  ON 15
ci_017                 1.124622e-02 3 1  ON 16
ci_018                 1.067612e-02 3 1  ON 17
ci_019                -3.729708e-03 3 1  ON 18
ci_020                -3.630943e-03 3 1  ON 19
ci_021                -9.266608e-03 3 1  ON 20
ci_022                -9.171798e-03 3 1  ON 21
ci_023                 8.426070e-03 3 1  ON 22
ci_024                 7.833687e-03 3 1  ON 23
ci_025                 3.739458e-03 3 1  ON 24
ci_026                 4.174144e-03 3 1  ON 25
ci_027                 6.075637e-03 3 1  ON 26
ci_028                 6.005134e-03 3 1  ON 27
ci_029                -4.385834e-03 3 1  ON 28
ci_030                -4.262557e-03 3 1  ON 29
ci_031                -7.268109e-03 3 1  ON 30
ci_032                -7.664170e-03 3 1  ON 31
ci_033                 4.207054e-03 3 1  ON 32
ci_034                 4.699935e-03 3 1  ON 33
ci_035                 1.141170e-03 3 1  ON 34
ci_036                 9.958862e-04 3 1  ON 35
ci_037                 4.840849e-03 3 1  ON 36
ci_038                 4.673242e-03 3 1  ON 37
ci_039                 5.529299e-03 3 1  ON 38
ci_040                 5.373476e-03 3 1  ON 39
ci_041                 4.931262e-03 3 1  ON 40
ci_042                 4.626882e-03 3 1  ON 41
ci_043                 4.486144e-03 3 1  ON 42
ci_044                 4.579850e-03 3 1  ON 43
ci_045                 3.267748e-03 3 1  ON 44
ci_046                 2.757686e-03 3 1  ON 45
ci_047                -6.423219e-04 3 1  ON 46
ci_048                -6.733628e-04 3 1  ON 47
ci_049                 2.184628e-03 3 1  ON 48
ci_050                 1.635535e-03 3 1  ON 49
ci_051                -1.708187e-03 3 1  ON 50
ci_052                -2.179899e-03 3 1  ON 51
ci_053                -2.527784e-03 3 1  ON 52
ci_054                -2.918645e-03 3 1  ON 53
ci_055                -1.325833e-03 3 1  ON 54
ci_056                -1.427035e-03 3 1  ON 55
ci_057                -1.653500e-03 3 1  ON 56
ci_058                -1.178485e-03 3 1  ON 57
ci_059                 3.511324e-04 3 1  ON 58
ci_060                 1.937696e-04 3 1  ON 59
ci_061                -2.405519e-05 3 1  ON 60
ci_062                 3.228589e-04 3 1  ON 61
ci_063                -9.311312e-04 3 1  ON 62
ci_064                -6.233939e-04 3 1  ON 63
ci_065                -2.524881e-03 3 1  ON 64
ci_066                -2.771502e-03 3 1  ON 65
ci_067                -2.660682e-03 3 1  ON 66
ci_068                -1.839998e-03 3 1  ON 67
ci_069                 4.217291e-05 3 1  ON 68
ci_070                -3.866211e-04 3 1  ON 69
ci_071                -2.273753e-03 3 1  ON 70
ci_072                -1.973867e-03 3 1  ON 71
ci_073                 1.679232e-04 3 1  ON 72
ci_074                 3.821283e-04 3 1  ON 73
ci_075                -2.330003e-04 3 1  ON 74
ci_076                -4.607925e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 2.9132e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s039 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s039 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=39  my_counter=0
  time step      = 5.0000e-02
  blocks         = 250
  steps          = 250
  substeps       = 10
  current        = 0
  target samples = 8.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">250</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">6.2500e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">8.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">6.2500e+04</parameter>
<parameter name="steps" condition="int">250</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2676e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="250">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =8000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 39
    time step          = 0.05
    reference energy   = -22.708
    reference variance = 0.444957
====================================================
  Execution time = 1.0164e+02
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s039
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 62500 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 6.1126e+04
  VMC Eavg = -2.2670e+01
  VMC Evar = 5.1211e-01
  Total weights = 7.820436955e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.8827e+01
  </log>
</opt>
<opt stage="main" walkers="62500">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.499237634365
                                         uncertainty =       0.001388066591

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.499237634365
                                         uncertainty =       0.001388066591

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000249809576
  error estimate for blocks of size 2^( 2) =       0.000258674749
  error estimate for blocks of size 2^( 3) =       0.000266551278
  error estimate for blocks of size 2^( 4) =       0.000272428348
  error estimate for blocks of size 2^( 5) =       0.000275603610
  error estimate for blocks of size 2^( 6) =       0.000277389957
  error estimate for blocks of size 2^( 7) =       0.000278561454
  error estimate for blocks of size 2^( 8) =       0.000279299513
  error estimate for blocks of size 2^( 9) =       0.000279656084

      target function =                  N/A
              le_mean =     -22.669917254210
             les_mean =     514.437256570720
             stat err =       0.000278726752
             autocorr =       1.244913409803
              std dev =       0.706568179378
             le_variance =       0.499238592109


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266991725421e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.4552e-01, overlap shift 1.4552e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.669917254235       residual = 4.83e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.669922801772       residual = 1.67e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.669922507955       residual = 1.39e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.669922708744       residual = 8.98e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 1.4552e-01 is 6.561917e-04

solving harmonic davidson linear method for identity shift 5.8208e-01, overlap shift 5.8208e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.669917254235       residual = 4.83e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.669919634186       residual = 6.88e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.669919605318       residual = 2.10e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.669919619073       residual = 4.82e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 5.8208e-01 is 3.256967e-04

solving harmonic davidson linear method for identity shift 2.3283e+00, overlap shift 2.3283e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.669917254235       residual = 4.83e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.669917978955       residual = 6.42e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.669917993684       residual = 1.35e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.669917993764       residual = 3.58e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 2.3283e+00 is 1.071561e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.337075 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.2048e+02
  </log>
  <optVariables href="FORM.s039.opt.xml">
ci_001                -7.067081e-01 3 1  ON 0
ci_002                -7.044979e-01 3 1  ON 1
ci_003                -3.729243e-02 3 1  ON 2
ci_004                -3.852608e-02 3 1  ON 3
ci_005                 1.602380e-02 3 1  ON 4
ci_006                 1.569283e-02 3 1  ON 5
ci_007                 1.263302e-02 3 1  ON 6
ci_008                 1.267908e-02 3 1  ON 7
ci_009                -1.156499e-02 3 1  ON 8
ci_010                -1.145465e-02 3 1  ON 9
ci_011                -8.308881e-03 3 1  ON 10
ci_012                -8.113770e-03 3 1  ON 11
ci_013                 9.392178e-03 3 1  ON 12
ci_014                 9.243269e-03 3 1  ON 13
ci_015                 1.242122e-02 3 1  ON 14
ci_016                 1.254297e-02 3 1  ON 15
ci_017                 1.138473e-02 3 1  ON 16
ci_018                 1.069126e-02 3 1  ON 17
ci_019                -3.733978e-03 3 1  ON 18
ci_020                -3.647107e-03 3 1  ON 19
ci_021                -9.232328e-03 3 1  ON 20
ci_022                -9.221786e-03 3 1  ON 21
ci_023                 8.552758e-03 3 1  ON 22
ci_024                 7.884592e-03 3 1  ON 23
ci_025                 3.929578e-03 3 1  ON 24
ci_026                 4.278233e-03 3 1  ON 25
ci_027                 6.128459e-03 3 1  ON 26
ci_028                 6.330831e-03 3 1  ON 27
ci_029                -4.580219e-03 3 1  ON 28
ci_030                -4.229005e-03 3 1  ON 29
ci_031                -7.209597e-03 3 1  ON 30
ci_032                -7.556337e-03 3 1  ON 31
ci_033                 4.410364e-03 3 1  ON 32
ci_034                 4.643732e-03 3 1  ON 33
ci_035                 1.346531e-03 3 1  ON 34
ci_036                 1.070385e-03 3 1  ON 35
ci_037                 4.843474e-03 3 1  ON 36
ci_038                 4.625274e-03 3 1  ON 37
ci_039                 5.568117e-03 3 1  ON 38
ci_040                 5.472243e-03 3 1  ON 39
ci_041                 5.043314e-03 3 1  ON 40
ci_042                 4.654593e-03 3 1  ON 41
ci_043                 4.677911e-03 3 1  ON 42
ci_044                 4.566618e-03 3 1  ON 43
ci_045                 3.307215e-03 3 1  ON 44
ci_046                 2.896169e-03 3 1  ON 45
ci_047                -5.319703e-04 3 1  ON 46
ci_048                -7.860975e-04 3 1  ON 47
ci_049                 2.212642e-03 3 1  ON 48
ci_050                 1.505432e-03 3 1  ON 49
ci_051                -1.700489e-03 3 1  ON 50
ci_052                -1.928413e-03 3 1  ON 51
ci_053                -2.602456e-03 3 1  ON 52
ci_054                -2.743440e-03 3 1  ON 53
ci_055                -1.370432e-03 3 1  ON 54
ci_056                -1.412141e-03 3 1  ON 55
ci_057                -1.666436e-03 3 1  ON 56
ci_058                -1.223030e-03 3 1  ON 57
ci_059                 2.401475e-04 3 1  ON 58
ci_060                 3.486153e-04 3 1  ON 59
ci_061                 4.303513e-05 3 1  ON 60
ci_062                 1.556210e-04 3 1  ON 61
ci_063                -6.772365e-04 3 1  ON 62
ci_064                -5.611064e-04 3 1  ON 63
ci_065                -2.455688e-03 3 1  ON 64
ci_066                -2.558918e-03 3 1  ON 65
ci_067                -2.543445e-03 3 1  ON 66
ci_068                -1.954629e-03 3 1  ON 67
ci_069                -3.094298e-05 3 1  ON 68
ci_070                -2.568991e-04 3 1  ON 69
ci_071                -2.423601e-03 3 1  ON 70
ci_072                -2.093481e-03 3 1  ON 71
ci_073                 2.298029e-04 3 1  ON 72
ci_074                 2.177532e-04 3 1  ON 73
ci_075                -2.581942e-04 3 1  ON 74
ci_076                -4.686368e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="250">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =8000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 39
    time step          = 0.05
    reference energy   = -22.605
    reference variance = 0.968699
====================================================
  Execution time = 9.8810e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s039
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 62500 
  VMC Eavg = -2.2669e+01
  VMC Evar = 5.1201e-01
  Total weights = 7.8207e+06
  Execution time = 1.4425e+01
  </log>
</opt>
<opt stage="main" walkers="62500">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.500851251690
                                         uncertainty =       0.003166056842

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.500851251690
                                         uncertainty =       0.003166056842

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000250213140
  error estimate for blocks of size 2^( 2) =       0.000259184962
  error estimate for blocks of size 2^( 3) =       0.000267033014
  error estimate for blocks of size 2^( 4) =       0.000272586876
  error estimate for blocks of size 2^( 5) =       0.000275854134
  error estimate for blocks of size 2^( 6) =       0.000277587661
  error estimate for blocks of size 2^( 7) =       0.000278293893
  error estimate for blocks of size 2^( 8) =       0.000278824602
  error estimate for blocks of size 2^( 9) =       0.000280017525

      target function =                  N/A
              le_mean =     -22.669516147794
             les_mean =     537.696446575280
             stat err =       0.000278680920
             autocorr =       1.240492798451
              std dev =       0.707709630904
             le_variance =       0.500852921674

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.498135696470
                                         uncertainty =       0.001512913648

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.498135696470
                                         uncertainty =       0.001512913648

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000249534381
  error estimate for blocks of size 2^( 2) =       0.000258527435
  error estimate for blocks of size 2^( 3) =       0.000266382596
  error estimate for blocks of size 2^( 4) =       0.000271938358
  error estimate for blocks of size 2^( 5) =       0.000275200895
  error estimate for blocks of size 2^( 6) =       0.000276923348
  error estimate for blocks of size 2^( 7) =       0.000277621447
  error estimate for blocks of size 2^( 8) =       0.000278245280
  error estimate for blocks of size 2^( 9) =       0.000279517793

      target function =                  N/A
              le_mean =     -22.669499516732
             les_mean =     514.421796974485
             stat err =       0.000278076967
             autocorr =       1.241850322684
              std dev =       0.705789810882
             le_variance =       0.498139257145

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.498140792068
                                         uncertainty =       0.001513726648

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.498140792068
                                         uncertainty =       0.001513726648

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000249535658
  error estimate for blocks of size 2^( 2) =       0.000258528783
  error estimate for blocks of size 2^( 3) =       0.000266383839
  error estimate for blocks of size 2^( 4) =       0.000271939912
  error estimate for blocks of size 2^( 5) =       0.000275203460
  error estimate for blocks of size 2^( 6) =       0.000276925628
  error estimate for blocks of size 2^( 7) =       0.000277623838
  error estimate for blocks of size 2^( 8) =       0.000278248133
  error estimate for blocks of size 2^( 9) =       0.000279518929

      target function =                  N/A
              le_mean =     -22.669497744168
             les_mean =     514.428335424896
             stat err =       0.000278079132
             autocorr =       1.241856944976
              std dev =       0.705793423858
             le_variance =       0.498144357161

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.498166624534
                                         uncertainty =       0.001516121955

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.498166624534
                                         uncertainty =       0.001516121955

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000249542126
  error estimate for blocks of size 2^( 2) =       0.000258537535
  error estimate for blocks of size 2^( 3) =       0.000266394821
  error estimate for blocks of size 2^( 4) =       0.000271953260
  error estimate for blocks of size 2^( 5) =       0.000275217306
  error estimate for blocks of size 2^( 6) =       0.000276938731
  error estimate for blocks of size 2^( 7) =       0.000277636772
  error estimate for blocks of size 2^( 8) =       0.000278254356
  error estimate for blocks of size 2^( 9) =       0.000279523317

      target function =                  N/A
              le_mean =     -22.669496811775
             les_mean =     514.418633058062
             stat err =       0.000278088294
             autocorr =       1.241874394111
              std dev =       0.705811718951
             le_variance =       0.498170182609


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.669516147794        initial  <--
     1.4552e-01     1.4552e+00             6.5619e-04       -22.669499516732
     5.8208e-01     5.8208e+00             3.2570e-04       -22.669497744168
     2.3283e+00     2.3283e+01             1.0716e-04       -22.669496811775

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 171.5515
  </log>
  <optVariables href="FORM.s039.opt.xml">
ci_001                -7.066156e-01 3 1  ON 0
ci_002                -7.045953e-01 3 1  ON 1
ci_003                -3.736769e-02 3 1  ON 2
ci_004                -3.860894e-02 3 1  ON 3
ci_005                 1.597949e-02 3 1  ON 4
ci_006                 1.566633e-02 3 1  ON 5
ci_007                 1.251624e-02 3 1  ON 6
ci_008                 1.268516e-02 3 1  ON 7
ci_009                -1.160050e-02 3 1  ON 8
ci_010                -1.138004e-02 3 1  ON 9
ci_011                -8.293824e-03 3 1  ON 10
ci_012                -8.213537e-03 3 1  ON 11
ci_013                 9.499624e-03 3 1  ON 12
ci_014                 9.335889e-03 3 1  ON 13
ci_015                 1.230325e-02 3 1  ON 14
ci_016                 1.259452e-02 3 1  ON 15
ci_017                 1.124622e-02 3 1  ON 16
ci_018                 1.067612e-02 3 1  ON 17
ci_019                -3.729708e-03 3 1  ON 18
ci_020                -3.630943e-03 3 1  ON 19
ci_021                -9.266608e-03 3 1  ON 20
ci_022                -9.171798e-03 3 1  ON 21
ci_023                 8.426070e-03 3 1  ON 22
ci_024                 7.833687e-03 3 1  ON 23
ci_025                 3.739458e-03 3 1  ON 24
ci_026                 4.174144e-03 3 1  ON 25
ci_027                 6.075637e-03 3 1  ON 26
ci_028                 6.005134e-03 3 1  ON 27
ci_029                -4.385834e-03 3 1  ON 28
ci_030                -4.262557e-03 3 1  ON 29
ci_031                -7.268109e-03 3 1  ON 30
ci_032                -7.664170e-03 3 1  ON 31
ci_033                 4.207054e-03 3 1  ON 32
ci_034                 4.699935e-03 3 1  ON 33
ci_035                 1.141170e-03 3 1  ON 34
ci_036                 9.958862e-04 3 1  ON 35
ci_037                 4.840849e-03 3 1  ON 36
ci_038                 4.673242e-03 3 1  ON 37
ci_039                 5.529299e-03 3 1  ON 38
ci_040                 5.373476e-03 3 1  ON 39
ci_041                 4.931262e-03 3 1  ON 40
ci_042                 4.626882e-03 3 1  ON 41
ci_043                 4.486144e-03 3 1  ON 42
ci_044                 4.579850e-03 3 1  ON 43
ci_045                 3.267748e-03 3 1  ON 44
ci_046                 2.757686e-03 3 1  ON 45
ci_047                -6.423219e-04 3 1  ON 46
ci_048                -6.733628e-04 3 1  ON 47
ci_049                 2.184628e-03 3 1  ON 48
ci_050                 1.635535e-03 3 1  ON 49
ci_051                -1.708187e-03 3 1  ON 50
ci_052                -2.179899e-03 3 1  ON 51
ci_053                -2.527784e-03 3 1  ON 52
ci_054                -2.918645e-03 3 1  ON 53
ci_055                -1.325833e-03 3 1  ON 54
ci_056                -1.427035e-03 3 1  ON 55
ci_057                -1.653500e-03 3 1  ON 56
ci_058                -1.178485e-03 3 1  ON 57
ci_059                 3.511324e-04 3 1  ON 58
ci_060                 1.937696e-04 3 1  ON 59
ci_061                -2.405519e-05 3 1  ON 60
ci_062                 3.228589e-04 3 1  ON 61
ci_063                -9.311312e-04 3 1  ON 62
ci_064                -6.233939e-04 3 1  ON 63
ci_065                -2.524881e-03 3 1  ON 64
ci_066                -2.771502e-03 3 1  ON 65
ci_067                -2.660682e-03 3 1  ON 66
ci_068                -1.839998e-03 3 1  ON 67
ci_069                 4.217291e-05 3 1  ON 68
ci_070                -3.866211e-04 3 1  ON 69
ci_071                -2.273753e-03 3 1  ON 70
ci_072                -1.973867e-03 3 1  ON 71
ci_073                 1.679232e-04 3 1  ON 72
ci_074                 3.821283e-04 3 1  ON 73
ci_075                -2.330003e-04 3 1  ON 74
ci_076                -4.607925e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 2.9204e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s040 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s040 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=40  my_counter=0
  time step      = 5.0000e-02
  blocks         = 250
  steps          = 250
  substeps       = 10
  current        = 0
  target samples = 8.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">250</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">6.2500e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">8.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">6.2500e+04</parameter>
<parameter name="steps" condition="int">250</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2675e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="250">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =8000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 40
    time step          = 0.05
    reference energy   = -22.7118
    reference variance = 0.333327
====================================================
  Execution time = 1.0111e+02
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s040
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 62500 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 6.1116e+04
  VMC Eavg = -2.2670e+01
  VMC Evar = 5.1186e-01
  Total weights = 7.820864803e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.8836e+01
  </log>
</opt>
<opt stage="main" walkers="62500">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.498978871062
                                         uncertainty =       0.001794088507

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.498978871062
                                         uncertainty =       0.001794088507

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000249744706
  error estimate for blocks of size 2^( 2) =       0.000258861948
  error estimate for blocks of size 2^( 3) =       0.000266794825
  error estimate for blocks of size 2^( 4) =       0.000272527589
  error estimate for blocks of size 2^( 5) =       0.000275801250
  error estimate for blocks of size 2^( 6) =       0.000277584534
  error estimate for blocks of size 2^( 7) =       0.000278443743
  error estimate for blocks of size 2^( 8) =       0.000279339366
  error estimate for blocks of size 2^( 9) =       0.000280499331

      target function =                  N/A
              le_mean =     -22.669979388622
             les_mean =     514.439827776632
             stat err =       0.000278966743
             autocorr =       1.247706054497
              std dev =       0.706384701287
             le_variance =       0.498979346213


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266997938862e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.4552e+00, overlap shift 1.4552e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.669979388645       residual = 4.88e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.669980536272       residual = 3.56e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.669980525915       residual = 8.08e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 1.4552e+00 is 1.252558e-04

solving harmonic davidson linear method for identity shift 5.8208e+00, overlap shift 5.8208e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.669979388645       residual = 4.88e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.669979698944       residual = 3.80e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.669979691282       residual = 7.75e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 5.8208e+00 is 3.378789e-05

solving harmonic davidson linear method for identity shift 2.3283e+01, overlap shift 2.3283e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.669979388645       residual = 4.88e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.669979467834       residual = 3.95e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.669979465556       residual = 7.89e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 2.3283e+01 is 8.618062e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.338381 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.1996e+02
  </log>
  <optVariables href="FORM.s040.opt.xml">
ci_001                -7.066194e-01 3 1  ON 0
ci_002                -7.045924e-01 3 1  ON 1
ci_003                -3.734693e-02 3 1  ON 2
ci_004                -3.860372e-02 3 1  ON 3
ci_005                 1.597882e-02 3 1  ON 4
ci_006                 1.565106e-02 3 1  ON 5
ci_007                 1.249384e-02 3 1  ON 6
ci_008                 1.269781e-02 3 1  ON 7
ci_009                -1.160941e-02 3 1  ON 8
ci_010                -1.138916e-02 3 1  ON 9
ci_011                -8.289358e-03 3 1  ON 10
ci_012                -8.219932e-03 3 1  ON 11
ci_013                 9.483301e-03 3 1  ON 12
ci_014                 9.326439e-03 3 1  ON 13
ci_015                 1.230109e-02 3 1  ON 14
ci_016                 1.259305e-02 3 1  ON 15
ci_017                 1.124668e-02 3 1  ON 16
ci_018                 1.069462e-02 3 1  ON 17
ci_019                -3.716743e-03 3 1  ON 18
ci_020                -3.631527e-03 3 1  ON 19
ci_021                -9.252415e-03 3 1  ON 20
ci_022                -9.174000e-03 3 1  ON 21
ci_023                 8.409348e-03 3 1  ON 22
ci_024                 7.836403e-03 3 1  ON 23
ci_025                 3.730502e-03 3 1  ON 24
ci_026                 4.193042e-03 3 1  ON 25
ci_027                 6.101341e-03 3 1  ON 26
ci_028                 6.032301e-03 3 1  ON 27
ci_029                -4.400652e-03 3 1  ON 28
ci_030                -4.280489e-03 3 1  ON 29
ci_031                -7.274058e-03 3 1  ON 30
ci_032                -7.688033e-03 3 1  ON 31
ci_033                 4.208135e-03 3 1  ON 32
ci_034                 4.704022e-03 3 1  ON 33
ci_035                 1.134962e-03 3 1  ON 34
ci_036                 1.000190e-03 3 1  ON 35
ci_037                 4.846698e-03 3 1  ON 36
ci_038                 4.683927e-03 3 1  ON 37
ci_039                 5.507619e-03 3 1  ON 38
ci_040                 5.373987e-03 3 1  ON 39
ci_041                 4.941618e-03 3 1  ON 40
ci_042                 4.636282e-03 3 1  ON 41
ci_043                 4.490489e-03 3 1  ON 42
ci_044                 4.573822e-03 3 1  ON 43
ci_045                 3.274155e-03 3 1  ON 44
ci_046                 2.772664e-03 3 1  ON 45
ci_047                -6.357517e-04 3 1  ON 46
ci_048                -6.781836e-04 3 1  ON 47
ci_049                 2.165159e-03 3 1  ON 48
ci_050                 1.633866e-03 3 1  ON 49
ci_051                -1.709916e-03 3 1  ON 50
ci_052                -2.146754e-03 3 1  ON 51
ci_053                -2.560472e-03 3 1  ON 52
ci_054                -2.910879e-03 3 1  ON 53
ci_055                -1.354383e-03 3 1  ON 54
ci_056                -1.436960e-03 3 1  ON 55
ci_057                -1.650967e-03 3 1  ON 56
ci_058                -1.174039e-03 3 1  ON 57
ci_059                 3.450085e-04 3 1  ON 58
ci_060                 1.893394e-04 3 1  ON 59
ci_061                -2.862194e-05 3 1  ON 60
ci_062                 3.062369e-04 3 1  ON 61
ci_063                -9.294583e-04 3 1  ON 62
ci_064                -5.904040e-04 3 1  ON 63
ci_065                -2.539077e-03 3 1  ON 64
ci_066                -2.753700e-03 3 1  ON 65
ci_067                -2.634474e-03 3 1  ON 66
ci_068                -1.873786e-03 3 1  ON 67
ci_069                 2.582877e-05 3 1  ON 68
ci_070                -3.814539e-04 3 1  ON 69
ci_071                -2.279378e-03 3 1  ON 70
ci_072                -1.976770e-03 3 1  ON 71
ci_073                 1.785231e-04 3 1  ON 72
ci_074                 3.880351e-04 3 1  ON 73
ci_075                -2.364929e-04 3 1  ON 74
ci_076                -4.614793e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="250">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =8000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 40
    time step          = 0.05
    reference energy   = -22.6688
    reference variance = 0.570399
====================================================
  Execution time = 9.8807e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s040
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 62500 
  VMC Eavg = -2.2669e+01
  VMC Evar = 5.1504e-01
  Total weights = 7.8210e+06
  Execution time = 1.4438e+01
  </log>
</opt>
<opt stage="main" walkers="62500">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.500880684177
                                         uncertainty =       0.003295085965

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.500880684177
                                         uncertainty =       0.003295085965

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000250219872
  error estimate for blocks of size 2^( 2) =       0.000259107241
  error estimate for blocks of size 2^( 3) =       0.000267039849
  error estimate for blocks of size 2^( 4) =       0.000272837208
  error estimate for blocks of size 2^( 5) =       0.000276096147
  error estimate for blocks of size 2^( 6) =       0.000277941428
  error estimate for blocks of size 2^( 7) =       0.000278720839
  error estimate for blocks of size 2^( 8) =       0.000280040308
  error estimate for blocks of size 2^( 9) =       0.000280053043

      target function =                  N/A
              le_mean =     -22.669347799073
             les_mean =     514.414569754331
             stat err =       0.000279188904
             autocorr =       1.244952303747
              std dev =       0.707728673519
             le_variance =       0.500879875321

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.500825609619
                                         uncertainty =       0.003293636418

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.500825609619
                                         uncertainty =       0.003293636418

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000250206111
  error estimate for blocks of size 2^( 2) =       0.000259094235
  error estimate for blocks of size 2^( 3) =       0.000267027157
  error estimate for blocks of size 2^( 4) =       0.000272824554
  error estimate for blocks of size 2^( 5) =       0.000276082617
  error estimate for blocks of size 2^( 6) =       0.000277927920
  error estimate for blocks of size 2^( 7) =       0.000278706402
  error estimate for blocks of size 2^( 8) =       0.000280025382
  error estimate for blocks of size 2^( 9) =       0.000280038817

      target function =                  N/A
              le_mean =     -22.669346590608
             les_mean =     514.414696149946
             stat err =       0.000279174630
             autocorr =       1.244961941261
              std dev =       0.707689750115
             le_variance =       0.500824782418

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.500847683402
                                         uncertainty =       0.003293928938

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.500847683402
                                         uncertainty =       0.003293928938

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000250211627
  error estimate for blocks of size 2^( 2) =       0.000259099440
  error estimate for blocks of size 2^( 3) =       0.000267032266
  error estimate for blocks of size 2^( 4) =       0.000272829646
  error estimate for blocks of size 2^( 5) =       0.000276088087
  error estimate for blocks of size 2^( 6) =       0.000277933397
  error estimate for blocks of size 2^( 7) =       0.000278712237
  error estimate for blocks of size 2^( 8) =       0.000280031545
  error estimate for blocks of size 2^( 9) =       0.000280044409

      target function =                  N/A
              le_mean =     -22.669347100766
             les_mean =     514.414248663378
             stat err =       0.000279180397
             autocorr =       1.244958483914
              std dev =       0.707705351385
             le_variance =       0.500846864379

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.500875900302
                                         uncertainty =       0.003294879166

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.500875900302
                                         uncertainty =       0.003294879166

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000250218677
  error estimate for blocks of size 2^( 2) =       0.000259106100
  error estimate for blocks of size 2^( 3) =       0.000267038741
  error estimate for blocks of size 2^( 4) =       0.000272836109
  error estimate for blocks of size 2^( 5) =       0.000276094989
  error estimate for blocks of size 2^( 6) =       0.000277940257
  error estimate for blocks of size 2^( 7) =       0.000278719592
  error estimate for blocks of size 2^( 8) =       0.000280039082
  error estimate for blocks of size 2^( 9) =       0.000280051803

      target function =                  N/A
              le_mean =     -22.669347685211
             les_mean =     514.414735932299
             stat err =       0.000279187684
             autocorr =       1.244953309411
              std dev =       0.707725292842
             le_variance =       0.500875090129


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.669347799073        initial  <--
     1.4552e+00     1.4552e+01             1.2526e-04       -22.669346590608
     5.8208e+00     5.8208e+01             3.3788e-05       -22.669347100766
     2.3283e+01     2.3283e+02             8.6181e-06       -22.669347685211

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 172.9343
  </log>
  <optVariables href="FORM.s040.opt.xml">
ci_001                -7.066156e-01 3 1  ON 0
ci_002                -7.045953e-01 3 1  ON 1
ci_003                -3.736769e-02 3 1  ON 2
ci_004                -3.860894e-02 3 1  ON 3
ci_005                 1.597949e-02 3 1  ON 4
ci_006                 1.566633e-02 3 1  ON 5
ci_007                 1.251624e-02 3 1  ON 6
ci_008                 1.268516e-02 3 1  ON 7
ci_009                -1.160050e-02 3 1  ON 8
ci_010                -1.138004e-02 3 1  ON 9
ci_011                -8.293824e-03 3 1  ON 10
ci_012                -8.213537e-03 3 1  ON 11
ci_013                 9.499624e-03 3 1  ON 12
ci_014                 9.335889e-03 3 1  ON 13
ci_015                 1.230325e-02 3 1  ON 14
ci_016                 1.259452e-02 3 1  ON 15
ci_017                 1.124622e-02 3 1  ON 16
ci_018                 1.067612e-02 3 1  ON 17
ci_019                -3.729708e-03 3 1  ON 18
ci_020                -3.630943e-03 3 1  ON 19
ci_021                -9.266608e-03 3 1  ON 20
ci_022                -9.171798e-03 3 1  ON 21
ci_023                 8.426070e-03 3 1  ON 22
ci_024                 7.833687e-03 3 1  ON 23
ci_025                 3.739458e-03 3 1  ON 24
ci_026                 4.174144e-03 3 1  ON 25
ci_027                 6.075637e-03 3 1  ON 26
ci_028                 6.005134e-03 3 1  ON 27
ci_029                -4.385834e-03 3 1  ON 28
ci_030                -4.262557e-03 3 1  ON 29
ci_031                -7.268109e-03 3 1  ON 30
ci_032                -7.664170e-03 3 1  ON 31
ci_033                 4.207054e-03 3 1  ON 32
ci_034                 4.699935e-03 3 1  ON 33
ci_035                 1.141170e-03 3 1  ON 34
ci_036                 9.958862e-04 3 1  ON 35
ci_037                 4.840849e-03 3 1  ON 36
ci_038                 4.673242e-03 3 1  ON 37
ci_039                 5.529299e-03 3 1  ON 38
ci_040                 5.373476e-03 3 1  ON 39
ci_041                 4.931262e-03 3 1  ON 40
ci_042                 4.626882e-03 3 1  ON 41
ci_043                 4.486144e-03 3 1  ON 42
ci_044                 4.579850e-03 3 1  ON 43
ci_045                 3.267748e-03 3 1  ON 44
ci_046                 2.757686e-03 3 1  ON 45
ci_047                -6.423219e-04 3 1  ON 46
ci_048                -6.733628e-04 3 1  ON 47
ci_049                 2.184628e-03 3 1  ON 48
ci_050                 1.635535e-03 3 1  ON 49
ci_051                -1.708187e-03 3 1  ON 50
ci_052                -2.179899e-03 3 1  ON 51
ci_053                -2.527784e-03 3 1  ON 52
ci_054                -2.918645e-03 3 1  ON 53
ci_055                -1.325833e-03 3 1  ON 54
ci_056                -1.427035e-03 3 1  ON 55
ci_057                -1.653500e-03 3 1  ON 56
ci_058                -1.178485e-03 3 1  ON 57
ci_059                 3.511324e-04 3 1  ON 58
ci_060                 1.937696e-04 3 1  ON 59
ci_061                -2.405519e-05 3 1  ON 60
ci_062                 3.228589e-04 3 1  ON 61
ci_063                -9.311312e-04 3 1  ON 62
ci_064                -6.233939e-04 3 1  ON 63
ci_065                -2.524881e-03 3 1  ON 64
ci_066                -2.771502e-03 3 1  ON 65
ci_067                -2.660682e-03 3 1  ON 66
ci_068                -1.839998e-03 3 1  ON 67
ci_069                 4.217291e-05 3 1  ON 68
ci_070                -3.866211e-04 3 1  ON 69
ci_071                -2.273753e-03 3 1  ON 70
ci_072                -1.973867e-03 3 1  ON 71
ci_073                 1.679232e-04 3 1  ON 72
ci_074                 3.821283e-04 3 1  ON 73
ci_075                -2.330003e-04 3 1  ON 74
ci_076                -4.607925e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 2.9290e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s041 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s041 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=41  my_counter=0
  time step      = 5.0000e-02
  blocks         = 250
  steps          = 250
  substeps       = 10
  current        = 0
  target samples = 8.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">250</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">6.2500e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">8.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">6.2500e+04</parameter>
<parameter name="steps" condition="int">250</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2676e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="250">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =8000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 41
    time step          = 0.05
    reference energy   = -22.6733
    reference variance = 0.679457
====================================================
  Execution time = 1.0109e+02
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s041
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 62500 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 6.1061e+04
  VMC Eavg = -2.2670e+01
  VMC Evar = 5.1406e-01
  Total weights = 7.820056217e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.9019e+01
  </log>
</opt>
<opt stage="main" walkers="62500">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.498968278198
                                         uncertainty =       0.001395228183

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.498968278198
                                         uncertainty =       0.001395228183

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000249742208
  error estimate for blocks of size 2^( 2) =       0.000258763270
  error estimate for blocks of size 2^( 3) =       0.000266718590
  error estimate for blocks of size 2^( 4) =       0.000272318543
  error estimate for blocks of size 2^( 5) =       0.000275292380
  error estimate for blocks of size 2^( 6) =       0.000276992014
  error estimate for blocks of size 2^( 7) =       0.000278679130
  error estimate for blocks of size 2^( 8) =       0.000278771842
  error estimate for blocks of size 2^( 9) =       0.000278944267

      target function =                  N/A
              le_mean =     -22.669909218865
             les_mean =     514.438843534661
             stat err =       0.000278346813
             autocorr =       1.242191672802
              std dev =       0.706377635167
             le_variance =       0.498969363465


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266990921886e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.4552e+01, overlap shift 1.4552e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.669909218891       residual = 4.59e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.669909388794       residual = 5.60e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.669909398263       residual = 2.26e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.669909397247       residual = 9.09e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 1.4552e+01 is 1.339761e-05

solving harmonic davidson linear method for identity shift 5.8208e+01, overlap shift 5.8208e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.669909218891       residual = 4.59e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.669909261730       residual = 5.71e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.669909264144       residual = 2.29e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.669909263892       residual = 9.42e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 5.8208e+01 is 3.376409e-06

solving harmonic davidson linear method for identity shift 2.3283e+02, overlap shift 2.3283e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.669909218891       residual = 4.59e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.669909229624       residual = 5.73e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.669909230230       residual = 2.30e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.669909230168       residual = 9.51e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 2.3283e+02 is 8.458071e-07

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.339769 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.2013e+02
  </log>
  <optVariables href="FORM.s041.opt.xml">
ci_001                -7.066153e-01 3 1  ON 0
ci_002                -7.045954e-01 3 1  ON 1
ci_003                -3.736818e-02 3 1  ON 2
ci_004                -3.860851e-02 3 1  ON 3
ci_005                 1.598100e-02 3 1  ON 4
ci_006                 1.566576e-02 3 1  ON 5
ci_007                 1.251419e-02 3 1  ON 6
ci_008                 1.268401e-02 3 1  ON 7
ci_009                -1.160086e-02 3 1  ON 8
ci_010                -1.138078e-02 3 1  ON 9
ci_011                -8.292819e-03 3 1  ON 10
ci_012                -8.212376e-03 3 1  ON 11
ci_013                 9.499880e-03 3 1  ON 12
ci_014                 9.337146e-03 3 1  ON 13
ci_015                 1.230261e-02 3 1  ON 14
ci_016                 1.259581e-02 3 1  ON 15
ci_017                 1.124643e-02 3 1  ON 16
ci_018                 1.067715e-02 3 1  ON 17
ci_019                -3.727372e-03 3 1  ON 18
ci_020                -3.630632e-03 3 1  ON 19
ci_021                -9.267177e-03 3 1  ON 20
ci_022                -9.173341e-03 3 1  ON 21
ci_023                 8.423850e-03 3 1  ON 22
ci_024                 7.834045e-03 3 1  ON 23
ci_025                 3.741492e-03 3 1  ON 24
ci_026                 4.174296e-03 3 1  ON 25
ci_027                 6.078150e-03 3 1  ON 26
ci_028                 6.006267e-03 3 1  ON 27
ci_029                -4.386876e-03 3 1  ON 28
ci_030                -4.265296e-03 3 1  ON 29
ci_031                -7.269864e-03 3 1  ON 30
ci_032                -7.665029e-03 3 1  ON 31
ci_033                 4.208924e-03 3 1  ON 32
ci_034                 4.701200e-03 3 1  ON 33
ci_035                 1.142832e-03 3 1  ON 34
ci_036                 9.970829e-04 3 1  ON 35
ci_037                 4.841340e-03 3 1  ON 36
ci_038                 4.673942e-03 3 1  ON 37
ci_039                 5.528049e-03 3 1  ON 38
ci_040                 5.373825e-03 3 1  ON 39
ci_041                 4.933097e-03 3 1  ON 40
ci_042                 4.629639e-03 3 1  ON 41
ci_043                 4.488441e-03 3 1  ON 42
ci_044                 4.581354e-03 3 1  ON 43
ci_045                 3.268762e-03 3 1  ON 44
ci_046                 2.757735e-03 3 1  ON 45
ci_047                -6.434649e-04 3 1  ON 46
ci_048                -6.739515e-04 3 1  ON 47
ci_049                 2.181252e-03 3 1  ON 48
ci_050                 1.635068e-03 3 1  ON 49
ci_051                -1.707011e-03 3 1  ON 50
ci_052                -2.179499e-03 3 1  ON 51
ci_053                -2.529670e-03 3 1  ON 52
ci_054                -2.917697e-03 3 1  ON 53
ci_055                -1.323173e-03 3 1  ON 54
ci_056                -1.428614e-03 3 1  ON 55
ci_057                -1.652819e-03 3 1  ON 56
ci_058                -1.181175e-03 3 1  ON 57
ci_059                 3.531127e-04 3 1  ON 58
ci_060                 1.926331e-04 3 1  ON 59
ci_061                -2.519107e-05 3 1  ON 60
ci_062                 3.213788e-04 3 1  ON 61
ci_063                -9.291673e-04 3 1  ON 62
ci_064                -6.218048e-04 3 1  ON 63
ci_065                -2.525816e-03 3 1  ON 64
ci_066                -2.772420e-03 3 1  ON 65
ci_067                -2.660629e-03 3 1  ON 66
ci_068                -1.841560e-03 3 1  ON 67
ci_069                 4.391340e-05 3 1  ON 68
ci_070                -3.860136e-04 3 1  ON 69
ci_071                -2.273339e-03 3 1  ON 70
ci_072                -1.974508e-03 3 1  ON 71
ci_073                 1.667945e-04 3 1  ON 72
ci_074                 3.811902e-04 3 1  ON 73
ci_075                -2.323181e-04 3 1  ON 74
ci_076                -4.613507e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="250">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =8000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 41
    time step          = 0.05
    reference energy   = -22.6321
    reference variance = 0.287005
====================================================
  Execution time = 9.9080e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s041
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 62500 
  VMC Eavg = -2.2670e+01
  VMC Evar = 5.1414e-01
  Total weights = 7.8214e+06
  Execution time = 1.4484e+01
  </log>
</opt>
<opt stage="main" walkers="62500">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.499889276351
                                         uncertainty =       0.001634726110

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.499889276351
                                         uncertainty =       0.001634726110

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000249973156
  error estimate for blocks of size 2^( 2) =       0.000258884809
  error estimate for blocks of size 2^( 3) =       0.000267196774
  error estimate for blocks of size 2^( 4) =       0.000272978812
  error estimate for blocks of size 2^( 5) =       0.000276349536
  error estimate for blocks of size 2^( 6) =       0.000278096774
  error estimate for blocks of size 2^( 7) =       0.000279152187
  error estimate for blocks of size 2^( 8) =       0.000279235543
  error estimate for blocks of size 2^( 9) =       0.000279208234

      target function =                  N/A
              le_mean =     -22.669816986743
             les_mean =     514.434737449049
             stat err =       0.000278923184
             autocorr =       1.245037640904
              std dev =       0.707030855973
             le_variance =       0.499892631298

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.499890802372
                                         uncertainty =       0.001634941989

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.499890802372
                                         uncertainty =       0.001634941989

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000249973538
  error estimate for blocks of size 2^( 2) =       0.000258885130
  error estimate for blocks of size 2^( 3) =       0.000267197094
  error estimate for blocks of size 2^( 4) =       0.000272979107
  error estimate for blocks of size 2^( 5) =       0.000276349814
  error estimate for blocks of size 2^( 6) =       0.000278097036
  error estimate for blocks of size 2^( 7) =       0.000279152511
  error estimate for blocks of size 2^( 8) =       0.000279235894
  error estimate for blocks of size 2^( 9) =       0.000279208488

      target function =                  N/A
              le_mean =     -22.669816996364
             les_mean =     514.434752469828
             stat err =       0.000278923482
             autocorr =       1.245036497062
              std dev =       0.707031936231
             le_variance =       0.499894158851

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.499890034802
                                         uncertainty =       0.001634835022

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.499890034802
                                         uncertainty =       0.001634835022

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000249973346
  error estimate for blocks of size 2^( 2) =       0.000258884968
  error estimate for blocks of size 2^( 3) =       0.000267196933
  error estimate for blocks of size 2^( 4) =       0.000272978958
  error estimate for blocks of size 2^( 5) =       0.000276349674
  error estimate for blocks of size 2^( 6) =       0.000278096904
  error estimate for blocks of size 2^( 7) =       0.000279152347
  error estimate for blocks of size 2^( 8) =       0.000279235717
  error estimate for blocks of size 2^( 9) =       0.000279208359

      target function =                  N/A
              le_mean =     -22.669816990691
             les_mean =     514.434741738157
             stat err =       0.000278923332
             autocorr =       1.245037065212
              std dev =       0.707031392883
             le_variance =       0.499893390522

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.499889370313
                                         uncertainty =       0.001634739748

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.499889370313
                                         uncertainty =       0.001634739748

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000249973180
  error estimate for blocks of size 2^( 2) =       0.000258884829
  error estimate for blocks of size 2^( 3) =       0.000267196794
  error estimate for blocks of size 2^( 4) =       0.000272978830
  error estimate for blocks of size 2^( 5) =       0.000276349553
  error estimate for blocks of size 2^( 6) =       0.000278096790
  error estimate for blocks of size 2^( 7) =       0.000279152206
  error estimate for blocks of size 2^( 8) =       0.000279235564
  error estimate for blocks of size 2^( 9) =       0.000279208250

      target function =                  N/A
              le_mean =     -22.669816987136
             les_mean =     514.434737676069
             stat err =       0.000278923203
             autocorr =       1.245037568943
              std dev =       0.707030922491
             le_variance =       0.499892725358


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.669816986743        initial
     1.4552e+01     1.4552e+02             1.3398e-05       -22.669816996364  <--
     5.8208e+01     5.8208e+02             3.3764e-06       -22.669816990691
     2.3283e+02     2.3283e+03             8.4581e-07       -22.669816987136

*****************************************************************************
Applying the update for shift_i =   1.4552e+01     and shift_s =   1.4552e+02
*****************************************************************************

  Execution time = 1.7186e+02
  </log>
  <optVariables href="FORM.s041.opt.xml">
ci_001                -7.066145e-01 3 1  ON 0
ci_002                -7.045957e-01 3 1  ON 1
ci_003                -3.736966e-02 3 1  ON 2
ci_004                -3.860723e-02 3 1  ON 3
ci_005                 1.598549e-02 3 1  ON 4
ci_006                 1.566406e-02 3 1  ON 5
ci_007                 1.250810e-02 3 1  ON 6
ci_008                 1.268060e-02 3 1  ON 7
ci_009                -1.160194e-02 3 1  ON 8
ci_010                -1.138301e-02 3 1  ON 9
ci_011                -8.289831e-03 3 1  ON 10
ci_012                -8.208940e-03 3 1  ON 11
ci_013                 9.500650e-03 3 1  ON 12
ci_014                 9.340898e-03 3 1  ON 13
ci_015                 1.230072e-02 3 1  ON 14
ci_016                 1.259967e-02 3 1  ON 15
ci_017                 1.124706e-02 3 1  ON 16
ci_018                 1.068021e-02 3 1  ON 17
ci_019                -3.720428e-03 3 1  ON 18
ci_020                -3.629700e-03 3 1  ON 19
ci_021                -9.268868e-03 3 1  ON 20
ci_022                -9.177928e-03 3 1  ON 21
ci_023                 8.417273e-03 3 1  ON 22
ci_024                 7.835104e-03 3 1  ON 23
ci_025                 3.747528e-03 3 1  ON 24
ci_026                 4.174745e-03 3 1  ON 25
ci_027                 6.085554e-03 3 1  ON 26
ci_028                 6.009601e-03 3 1  ON 27
ci_029                -4.389969e-03 3 1  ON 28
ci_030                -4.273426e-03 3 1  ON 29
ci_031                -7.275078e-03 3 1  ON 30
ci_032                -7.667576e-03 3 1  ON 31
ci_033                 4.214473e-03 3 1  ON 32
ci_034                 4.704958e-03 3 1  ON 33
ci_035                 1.147721e-03 3 1  ON 34
ci_036                 1.000602e-03 3 1  ON 35
ci_037                 4.842796e-03 3 1  ON 36
ci_038                 4.676019e-03 3 1  ON 37
ci_039                 5.524358e-03 3 1  ON 38
ci_040                 5.374851e-03 3 1  ON 39
ci_041                 4.938523e-03 3 1  ON 40
ci_042                 4.637791e-03 3 1  ON 41
ci_043                 4.495258e-03 3 1  ON 42
ci_044                 4.585813e-03 3 1  ON 43
ci_045                 3.271760e-03 3 1  ON 44
ci_046                 2.757875e-03 3 1  ON 45
ci_047                -6.468199e-04 3 1  ON 46
ci_048                -6.756807e-04 3 1  ON 47
ci_049                 2.171231e-03 3 1  ON 48
ci_050                 1.633685e-03 3 1  ON 49
ci_051                -1.703518e-03 3 1  ON 50
ci_052                -2.178302e-03 3 1  ON 51
ci_053                -2.535276e-03 3 1  ON 52
ci_054                -2.914890e-03 3 1  ON 53
ci_055                -1.315260e-03 3 1  ON 54
ci_056                -1.433296e-03 3 1  ON 55
ci_057                -1.650794e-03 3 1  ON 56
ci_058                -1.189148e-03 3 1  ON 57
ci_059                 3.589584e-04 3 1  ON 58
ci_060                 1.892838e-04 3 1  ON 59
ci_061                -2.855625e-05 3 1  ON 60
ci_062                 3.169698e-04 3 1  ON 61
ci_063                -9.233324e-04 3 1  ON 62
ci_064                -6.170837e-04 3 1  ON 63
ci_065                -2.528590e-03 3 1  ON 64
ci_066                -2.775132e-03 3 1  ON 65
ci_067                -2.660478e-03 3 1  ON 66
ci_068                -1.846188e-03 3 1  ON 67
ci_069                 4.907861e-05 3 1  ON 68
ci_070                -3.842081e-04 3 1  ON 69
ci_071                -2.272106e-03 3 1  ON 70
ci_072                -1.976405e-03 3 1  ON 71
ci_073                 1.634567e-04 3 1  ON 72
ci_074                 3.784286e-04 3 1  ON 73
ci_075                -2.303022e-04 3 1  ON 74
ci_076                -4.630064e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 2.9200e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s042 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s042 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=42  my_counter=0
  time step      = 5.0000e-02
  blocks         = 250
  steps          = 250
  substeps       = 10
  current        = 0
  target samples = 8.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">250</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">6.2500e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">8.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">6.2500e+04</parameter>
<parameter name="steps" condition="int">250</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2675e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="250">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =8000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 42
    time step          = 0.05
    reference energy   = -22.7508
    reference variance = 0.860936
====================================================
  Execution time = 1.0123e+02
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s042
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 62500 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 6.1067e+04
  VMC Eavg = -2.2670e+01
  VMC Evar = 5.1415e-01
  Total weights = 7.820737994e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.8839e+01
  </log>
</opt>
<opt stage="main" walkers="62500">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.500829918837
                                         uncertainty =       0.002397066375

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.500829918837
                                         uncertainty =       0.002397066375

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000250208774
  error estimate for blocks of size 2^( 2) =       0.000259149819
  error estimate for blocks of size 2^( 3) =       0.000266998189
  error estimate for blocks of size 2^( 4) =       0.000272710314
  error estimate for blocks of size 2^( 5) =       0.000276248093
  error estimate for blocks of size 2^( 6) =       0.000278154605
  error estimate for blocks of size 2^( 7) =       0.000278686408
  error estimate for blocks of size 2^( 8) =       0.000279469929
  error estimate for blocks of size 2^( 9) =       0.000280408134

      target function =                  N/A
              le_mean =     -22.670169837685
             les_mean =     514.450752521458
             stat err =       0.000279179769
             autocorr =       1.244981272558
              std dev =       0.707697282229
             le_variance =       0.500835443275


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.267016983768e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.6380e+00, overlap shift 3.6380e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.670169837711       residual = 7.98e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.670170480539       residual = 8.87e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.670170501873       residual = 2.01e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.670170495170       residual = 4.44e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 3.6380e+00 is 8.088450e-05

solving harmonic davidson linear method for identity shift 1.4552e+01, overlap shift 1.4552e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.670169837711       residual = 7.98e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.670170003659       residual = 9.89e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.670170010230       residual = 2.31e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.670170008468       residual = 5.30e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 1.4552e+01 is 2.068520e-05

solving harmonic davidson linear method for identity shift 5.8208e+01, overlap shift 5.8208e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.670169837711       residual = 7.98e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.670169879539       residual = 1.02e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.670169881266       residual = 2.41e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.670169880821       residual = 5.56e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 5.8208e+01 is 5.201129e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.341143 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.2008e+02
  </log>
  <optVariables href="FORM.s042.opt.xml">
ci_001                -7.066134e-01 3 1  ON 0
ci_002                -7.045975e-01 3 1  ON 1
ci_003                -3.736252e-02 3 1  ON 2
ci_004                -3.860457e-02 3 1  ON 3
ci_005                 1.598381e-02 3 1  ON 4
ci_006                 1.565325e-02 3 1  ON 5
ci_007                 1.251259e-02 3 1  ON 6
ci_008                 1.267356e-02 3 1  ON 7
ci_009                -1.160699e-02 3 1  ON 8
ci_010                -1.138692e-02 3 1  ON 9
ci_011                -8.283768e-03 3 1  ON 10
ci_012                -8.211648e-03 3 1  ON 11
ci_013                 9.501200e-03 3 1  ON 12
ci_014                 9.331531e-03 3 1  ON 13
ci_015                 1.232140e-02 3 1  ON 14
ci_016                 1.260212e-02 3 1  ON 15
ci_017                 1.124083e-02 3 1  ON 16
ci_018                 1.068241e-02 3 1  ON 17
ci_019                -3.719693e-03 3 1  ON 18
ci_020                -3.625073e-03 3 1  ON 19
ci_021                -9.268892e-03 3 1  ON 20
ci_022                -9.186501e-03 3 1  ON 21
ci_023                 8.406497e-03 3 1  ON 22
ci_024                 7.832890e-03 3 1  ON 23
ci_025                 3.744829e-03 3 1  ON 24
ci_026                 4.169063e-03 3 1  ON 25
ci_027                 6.099624e-03 3 1  ON 26
ci_028                 5.999013e-03 3 1  ON 27
ci_029                -4.394420e-03 3 1  ON 28
ci_030                -4.270757e-03 3 1  ON 29
ci_031                -7.285432e-03 3 1  ON 30
ci_032                -7.662930e-03 3 1  ON 31
ci_033                 4.209484e-03 3 1  ON 32
ci_034                 4.703520e-03 3 1  ON 33
ci_035                 1.147436e-03 3 1  ON 34
ci_036                 9.995095e-04 3 1  ON 35
ci_037                 4.849137e-03 3 1  ON 36
ci_038                 4.674976e-03 3 1  ON 37
ci_039                 5.510710e-03 3 1  ON 38
ci_040                 5.372058e-03 3 1  ON 39
ci_041                 4.935701e-03 3 1  ON 40
ci_042                 4.645098e-03 3 1  ON 41
ci_043                 4.489813e-03 3 1  ON 42
ci_044                 4.586195e-03 3 1  ON 43
ci_045                 3.277075e-03 3 1  ON 44
ci_046                 2.754066e-03 3 1  ON 45
ci_047                -6.452041e-04 3 1  ON 46
ci_048                -6.726917e-04 3 1  ON 47
ci_049                 2.167299e-03 3 1  ON 48
ci_050                 1.629546e-03 3 1  ON 49
ci_051                -1.699125e-03 3 1  ON 50
ci_052                -2.170481e-03 3 1  ON 51
ci_053                -2.538701e-03 3 1  ON 52
ci_054                -2.918061e-03 3 1  ON 53
ci_055                -1.322736e-03 3 1  ON 54
ci_056                -1.436851e-03 3 1  ON 55
ci_057                -1.652757e-03 3 1  ON 56
ci_058                -1.206273e-03 3 1  ON 57
ci_059                 3.614245e-04 3 1  ON 58
ci_060                 1.885232e-04 3 1  ON 59
ci_061                -3.461556e-05 3 1  ON 60
ci_062                 3.124851e-04 3 1  ON 61
ci_063                -9.136975e-04 3 1  ON 62
ci_064                -6.123944e-04 3 1  ON 63
ci_065                -2.532698e-03 3 1  ON 64
ci_066                -2.760705e-03 3 1  ON 65
ci_067                -2.655158e-03 3 1  ON 66
ci_068                -1.847432e-03 3 1  ON 67
ci_069                 3.751847e-05 3 1  ON 68
ci_070                -3.713172e-04 3 1  ON 69
ci_071                -2.263295e-03 3 1  ON 70
ci_072                -1.985646e-03 3 1  ON 71
ci_073                 1.664377e-04 3 1  ON 72
ci_074                 3.719683e-04 3 1  ON 73
ci_075                -2.382575e-04 3 1  ON 74
ci_076                -4.615983e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="250">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =8000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 42
    time step          = 0.05
    reference energy   = -22.6529
    reference variance = 0.402263
====================================================
  Execution time = 9.9135e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s042
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 62500 
  VMC Eavg = -2.2670e+01
  VMC Evar = 5.1216e-01
  Total weights = 7.8209e+06
  Execution time = 1.4448e+01
  </log>
</opt>
<opt stage="main" walkers="62500">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.499704921071
                                         uncertainty =       0.001537076386

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.499704921071
                                         uncertainty =       0.001537076386

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000249926149
  error estimate for blocks of size 2^( 2) =       0.000258851449
  error estimate for blocks of size 2^( 3) =       0.000266943517
  error estimate for blocks of size 2^( 4) =       0.000272658438
  error estimate for blocks of size 2^( 5) =       0.000276052005
  error estimate for blocks of size 2^( 6) =       0.000278066811
  error estimate for blocks of size 2^( 7) =       0.000278820701
  error estimate for blocks of size 2^( 8) =       0.000278497496
  error estimate for blocks of size 2^( 9) =       0.000278729059

      target function =                  N/A
              le_mean =     -22.669759178377
             les_mean =     514.430238075679
             stat err =       0.000278528517
             autocorr =       1.241983822451
              std dev =       0.706897898375
             le_variance =       0.499704638726

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.499718666981
                                         uncertainty =       0.001537782473

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.499718666981
                                         uncertainty =       0.001537782473

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000249929586
  error estimate for blocks of size 2^( 2) =       0.000258855108
  error estimate for blocks of size 2^( 3) =       0.000266947252
  error estimate for blocks of size 2^( 4) =       0.000272662290
  error estimate for blocks of size 2^( 5) =       0.000276055761
  error estimate for blocks of size 2^( 6) =       0.000278070186
  error estimate for blocks of size 2^( 7) =       0.000278824408
  error estimate for blocks of size 2^( 8) =       0.000278501482
  error estimate for blocks of size 2^( 9) =       0.000278734067

      target function =                  N/A
              le_mean =     -22.669759549741
             les_mean =     514.430271895832
             stat err =       0.000278532536
             autocorr =       1.241985507067
              std dev =       0.706907619341
             le_variance =       0.499718382283

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.499711698539
                                         uncertainty =       0.001537420823

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.499711698539
                                         uncertainty =       0.001537420823

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000249927843
  error estimate for blocks of size 2^( 2) =       0.000258853266
  error estimate for blocks of size 2^( 3) =       0.000266945372
  error estimate for blocks of size 2^( 4) =       0.000272660344
  error estimate for blocks of size 2^( 5) =       0.000276053875
  error estimate for blocks of size 2^( 6) =       0.000278068489
  error estimate for blocks of size 2^( 7) =       0.000278822546
  error estimate for blocks of size 2^( 8) =       0.000278499488
  error estimate for blocks of size 2^( 9) =       0.000278731544

      target function =                  N/A
              le_mean =     -22.669759332961
             les_mean =     514.430114399997
             stat err =       0.000278530517
             autocorr =       1.241984817703
              std dev =       0.706902691312
             le_variance =       0.499711414985

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.499705743595
                                         uncertainty =       0.001537117970

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.499705743595
                                         uncertainty =       0.001537117970

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000249926354
  error estimate for blocks of size 2^( 2) =       0.000258851671
  error estimate for blocks of size 2^( 3) =       0.000266943743
  error estimate for blocks of size 2^( 4) =       0.000272658671
  error estimate for blocks of size 2^( 5) =       0.000276052233
  error estimate for blocks of size 2^( 6) =       0.000278067016
  error estimate for blocks of size 2^( 7) =       0.000278820926
  error estimate for blocks of size 2^( 8) =       0.000278497739
  error estimate for blocks of size 2^( 9) =       0.000278729363

      target function =                  N/A
              le_mean =     -22.669759195097
             les_mean =     514.430204112347
             stat err =       0.000278528761
             autocorr =       1.241983955226
              std dev =       0.706898480051
             le_variance =       0.499705461099


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.669759178377        initial
     3.6380e+00     3.6380e+01             8.0884e-05       -22.669759549741  <--
     1.4552e+01     1.4552e+02             2.0685e-05       -22.669759332961
     5.8208e+01     5.8208e+02             5.2011e-06       -22.669759195097

*****************************************************************************
Applying the update for shift_i =   3.6380e+00     and shift_s =   3.6380e+01
*****************************************************************************

  Execution time = 1.7320e+02
  </log>
  <optVariables href="FORM.s042.opt.xml">
ci_001                -7.066103e-01 3 1  ON 0
ci_002                -7.046027e-01 3 1  ON 1
ci_003                -3.734140e-02 3 1  ON 2
ci_004                -3.859671e-02 3 1  ON 3
ci_005                 1.597912e-02 3 1  ON 4
ci_006                 1.562279e-02 3 1  ON 5
ci_007                 1.252531e-02 3 1  ON 6
ci_008                 1.265326e-02 3 1  ON 7
ci_009                -1.162159e-02 3 1  ON 8
ci_010                -1.139803e-02 3 1  ON 9
ci_011                -8.266056e-03 3 1  ON 10
ci_012                -8.219515e-03 3 1  ON 11
ci_013                 9.503101e-03 3 1  ON 12
ci_014                 9.304588e-03 3 1  ON 13
ci_015                 1.238160e-02 3 1  ON 14
ci_016                 1.260928e-02 3 1  ON 15
ci_017                 1.122270e-02 3 1  ON 16
ci_018                 1.068842e-02 3 1  ON 17
ci_019                -3.717472e-03 3 1  ON 18
ci_020                -3.611540e-03 3 1  ON 19
ci_021                -9.268714e-03 3 1  ON 20
ci_022                -9.211521e-03 3 1  ON 21
ci_023                 8.375766e-03 3 1  ON 22
ci_024                 7.826670e-03 3 1  ON 23
ci_025                 3.737019e-03 3 1  ON 24
ci_026                 4.152394e-03 3 1  ON 25
ci_027                 6.139065e-03 3 1  ON 26
ci_028                 5.969406e-03 3 1  ON 27
ci_029                -4.407217e-03 3 1  ON 28
ci_030                -4.263443e-03 3 1  ON 29
ci_031                -7.315498e-03 3 1  ON 30
ci_032                -7.649257e-03 3 1  ON 31
ci_033                 4.195017e-03 3 1  ON 32
ci_034                 4.699423e-03 3 1  ON 33
ci_035                 1.146673e-03 3 1  ON 34
ci_036                 9.964644e-04 3 1  ON 35
ci_037                 4.867351e-03 3 1  ON 36
ci_038                 4.671782e-03 3 1  ON 37
ci_039                 5.472366e-03 3 1  ON 38
ci_040                 5.364260e-03 3 1  ON 39
ci_041                 4.927709e-03 3 1  ON 40
ci_042                 4.665864e-03 3 1  ON 41
ci_043                 4.474153e-03 3 1  ON 42
ci_044                 4.587327e-03 3 1  ON 43
ci_045                 3.292491e-03 3 1  ON 44
ci_046                 2.743088e-03 3 1  ON 45
ci_047                -6.407456e-04 3 1  ON 46
ci_048                -6.643336e-04 3 1  ON 47
ci_049                 2.156064e-03 3 1  ON 48
ci_050                 1.617616e-03 3 1  ON 49
ci_051                -1.686748e-03 3 1  ON 50
ci_052                -2.147698e-03 3 1  ON 51
ci_053                -2.548621e-03 3 1  ON 52
ci_054                -2.927271e-03 3 1  ON 53
ci_055                -1.344324e-03 3 1  ON 54
ci_056                -1.446985e-03 3 1  ON 55
ci_057                -1.658302e-03 3 1  ON 56
ci_058                -1.255230e-03 3 1  ON 57
ci_059                 3.683008e-04 3 1  ON 58
ci_060                 1.864075e-04 3 1  ON 59
ci_061                -5.193559e-05 3 1  ON 60
ci_062                 2.997235e-04 3 1  ON 61
ci_063                -8.858686e-04 3 1  ON 62
ci_064                -5.989996e-04 3 1  ON 63
ci_065                -2.544372e-03 3 1  ON 64
ci_066                -2.719478e-03 3 1  ON 65
ci_067                -2.639667e-03 3 1  ON 66
ci_068                -1.850975e-03 3 1  ON 67
ci_069                 4.484966e-06 3 1  ON 68
ci_070                -3.344502e-04 3 1  ON 69
ci_071                -2.238200e-03 3 1  ON 70
ci_072                -2.012258e-03 3 1  ON 71
ci_073                 1.746725e-04 3 1  ON 72
ci_074                 3.538930e-04 3 1  ON 73
ci_075                -2.608801e-04 3 1  ON 74
ci_076                -4.577328e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 2.9329e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s043 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s043 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=43  my_counter=0
  time step      = 5.0000e-02
  blocks         = 250
  steps          = 250
  substeps       = 10
  current        = 0
  target samples = 8.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">250</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">6.2500e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">8.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">6.2500e+04</parameter>
<parameter name="steps" condition="int">250</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2676e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="250">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =8000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 43
    time step          = 0.05
    reference energy   = -22.6187
    reference variance = 0.618481
====================================================
  Execution time = 9.9401e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s043
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 62500 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 6.1046e+04
  VMC Eavg = -2.2670e+01
  VMC Evar = 5.1248e-01
  Total weights = 7.820639690e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.9410e+01
  </log>
</opt>
<opt stage="main" walkers="62500">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.499023542948
                                         uncertainty =       0.001418931545

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.499023542948
                                         uncertainty =       0.001418931545

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000249755355
  error estimate for blocks of size 2^( 2) =       0.000258613503
  error estimate for blocks of size 2^( 3) =       0.000266524309
  error estimate for blocks of size 2^( 4) =       0.000272192866
  error estimate for blocks of size 2^( 5) =       0.000275429187
  error estimate for blocks of size 2^( 6) =       0.000277108431
  error estimate for blocks of size 2^( 7) =       0.000278059513
  error estimate for blocks of size 2^( 8) =       0.000279093815
  error estimate for blocks of size 2^( 9) =       0.000278554902

      target function =                  N/A
              le_mean =     -22.669557392043
             les_mean =     514.421308513645
             stat err =       0.000278204165
             autocorr =       1.240788157278
              std dev =       0.706414819778
             le_variance =       0.499021897602


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266955739204e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.0949e-01, overlap shift 9.0949e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.669557392066       residual = 4.55e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.669558826967       residual = 4.72e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.669558783258       residual = 1.58e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.669558800629       residual = 4.78e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 9.0949e-01 is 2.342651e-04

solving harmonic davidson linear method for identity shift 3.6380e+00, overlap shift 3.6380e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.669557392066       residual = 4.55e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.669557800434       residual = 5.20e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.669557789181       residual = 1.60e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.669557794960       residual = 6.01e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 3.6380e+00 is 7.089300e-05

solving harmonic davidson linear method for identity shift 1.4552e+01, overlap shift 1.4552e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.669557392066       residual = 4.55e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.669557497817       residual = 5.61e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.669557495077       residual = 1.72e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.669557496629       residual = 6.78e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 1.4552e+01 is 1.870646e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.345566 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.1883e+02
  </log>
  <optVariables href="FORM.s043.opt.xml">
ci_001                -7.066005e-01 3 1  ON 0
ci_002                -7.046115e-01 3 1  ON 1
ci_003                -3.735830e-02 3 1  ON 2
ci_004                -3.857821e-02 3 1  ON 3
ci_005                 1.596749e-02 3 1  ON 4
ci_006                 1.563560e-02 3 1  ON 5
ci_007                 1.253334e-02 3 1  ON 6
ci_008                 1.260215e-02 3 1  ON 7
ci_009                -1.161620e-02 3 1  ON 8
ci_010                -1.140352e-02 3 1  ON 9
ci_011                -8.264683e-03 3 1  ON 10
ci_012                -8.205319e-03 3 1  ON 11
ci_013                 9.529515e-03 3 1  ON 12
ci_014                 9.316479e-03 3 1  ON 13
ci_015                 1.238731e-02 3 1  ON 14
ci_016                 1.261916e-02 3 1  ON 15
ci_017                 1.122799e-02 3 1  ON 16
ci_018                 1.072092e-02 3 1  ON 17
ci_019                -3.683098e-03 3 1  ON 18
ci_020                -3.606906e-03 3 1  ON 19
ci_021                -9.240097e-03 3 1  ON 20
ci_022                -9.205437e-03 3 1  ON 21
ci_023                 8.351812e-03 3 1  ON 22
ci_024                 7.823333e-03 3 1  ON 23
ci_025                 3.745760e-03 3 1  ON 24
ci_026                 4.158988e-03 3 1  ON 25
ci_027                 6.188356e-03 3 1  ON 26
ci_028                 6.040299e-03 3 1  ON 27
ci_029                -4.439578e-03 3 1  ON 28
ci_030                -4.274274e-03 3 1  ON 29
ci_031                -7.353837e-03 3 1  ON 30
ci_032                -7.626348e-03 3 1  ON 31
ci_033                 4.215472e-03 3 1  ON 32
ci_034                 4.699871e-03 3 1  ON 33
ci_035                 1.123794e-03 3 1  ON 34
ci_036                 1.013581e-03 3 1  ON 35
ci_037                 4.890924e-03 3 1  ON 36
ci_038                 4.661747e-03 3 1  ON 37
ci_039                 5.483292e-03 3 1  ON 38
ci_040                 5.384372e-03 3 1  ON 39
ci_041                 4.883152e-03 3 1  ON 40
ci_042                 4.679237e-03 3 1  ON 41
ci_043                 4.489935e-03 3 1  ON 42
ci_044                 4.615740e-03 3 1  ON 43
ci_045                 3.288609e-03 3 1  ON 44
ci_046                 2.741473e-03 3 1  ON 45
ci_047                -6.378916e-04 3 1  ON 46
ci_048                -6.683727e-04 3 1  ON 47
ci_049                 2.143601e-03 3 1  ON 48
ci_050                 1.613498e-03 3 1  ON 49
ci_051                -1.686662e-03 3 1  ON 50
ci_052                -2.152673e-03 3 1  ON 51
ci_053                -2.550243e-03 3 1  ON 52
ci_054                -2.908645e-03 3 1  ON 53
ci_055                -1.359506e-03 3 1  ON 54
ci_056                -1.452640e-03 3 1  ON 55
ci_057                -1.649073e-03 3 1  ON 56
ci_058                -1.281008e-03 3 1  ON 57
ci_059                 3.573355e-04 3 1  ON 58
ci_060                 2.217966e-04 3 1  ON 59
ci_061                -4.506315e-05 3 1  ON 60
ci_062                 2.889011e-04 3 1  ON 61
ci_063                -8.666744e-04 3 1  ON 62
ci_064                -6.283056e-04 3 1  ON 63
ci_065                -2.534222e-03 3 1  ON 64
ci_066                -2.700504e-03 3 1  ON 65
ci_067                -2.593722e-03 3 1  ON 66
ci_068                -1.891426e-03 3 1  ON 67
ci_069                -2.434039e-06 3 1  ON 68
ci_070                -3.044414e-04 3 1  ON 69
ci_071                -2.240456e-03 3 1  ON 70
ci_072                -1.994753e-03 3 1  ON 71
ci_073                 1.562026e-04 3 1  ON 72
ci_074                 3.436747e-04 3 1  ON 73
ci_075                -2.693328e-04 3 1  ON 74
ci_076                -4.390739e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="250">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =8000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 43
    time step          = 0.05
    reference energy   = -22.6424
    reference variance = 0.355528
====================================================
  Execution time = 9.8916e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s043
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 62500 
  VMC Eavg = -2.2670e+01
  VMC Evar = 5.1460e-01
  Total weights = 7.8206e+06
  Execution time = 1.4391e+01
  </log>
</opt>
<opt stage="main" walkers="62500">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.501175222955
                                         uncertainty =       0.001372430073

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.501175222955
                                         uncertainty =       0.001372430073

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000250293928
  error estimate for blocks of size 2^( 2) =       0.000259157992
  error estimate for blocks of size 2^( 3) =       0.000267159449
  error estimate for blocks of size 2^( 4) =       0.000273120354
  error estimate for blocks of size 2^( 5) =       0.000276168482
  error estimate for blocks of size 2^( 6) =       0.000277827505
  error estimate for blocks of size 2^( 7) =       0.000278967890
  error estimate for blocks of size 2^( 8) =       0.000279625247
  error estimate for blocks of size 2^( 9) =       0.000281352021

      target function =                  N/A
              le_mean =     -22.669617810973
             les_mean =     514.426364007960
             stat err =       0.000279443166
             autocorr =       1.246482993971
              std dev =       0.707938134492
             le_variance =       0.501176402268

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.501162051323
                                         uncertainty =       0.001369546113

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.501162051323
                                         uncertainty =       0.001369546113

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000250290636
  error estimate for blocks of size 2^( 2) =       0.000259154344
  error estimate for blocks of size 2^( 3) =       0.000267155551
  error estimate for blocks of size 2^( 4) =       0.000273115624
  error estimate for blocks of size 2^( 5) =       0.000276163760
  error estimate for blocks of size 2^( 6) =       0.000277822084
  error estimate for blocks of size 2^( 7) =       0.000278961763
  error estimate for blocks of size 2^( 8) =       0.000279616808
  error estimate for blocks of size 2^( 9) =       0.000281339151

      target function =                  N/A
              le_mean =     -22.669618185964
             les_mean =     514.427611072175
             stat err =       0.000279434951
             autocorr =       1.246442500011
              std dev =       0.707928824086
             le_variance =       0.501163219972

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.501164178405
                                         uncertainty =       0.001370493097

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.501164178405
                                         uncertainty =       0.001370493097

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000250291168
  error estimate for blocks of size 2^( 2) =       0.000259155079
  error estimate for blocks of size 2^( 3) =       0.000267156416
  error estimate for blocks of size 2^( 4) =       0.000273116903
  error estimate for blocks of size 2^( 5) =       0.000276164986
  error estimate for blocks of size 2^( 6) =       0.000277823614
  error estimate for blocks of size 2^( 7) =       0.000278963474
  error estimate for blocks of size 2^( 8) =       0.000279619478
  error estimate for blocks of size 2^( 9) =       0.000281343745

      target function =                  N/A
              le_mean =     -22.669617882810
             les_mean =     514.426377232684
             stat err =       0.000279437578
             autocorr =       1.246460627437
              std dev =       0.707930329451
             le_variance =       0.501165351356

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.501173367408
                                         uncertainty =       0.001372138701

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.501173367408
                                         uncertainty =       0.001372138701

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000250293464
  error estimate for blocks of size 2^( 2) =       0.000259157506
  error estimate for blocks of size 2^( 3) =       0.000267158948
  error estimate for blocks of size 2^( 4) =       0.000273119800
  error estimate for blocks of size 2^( 5) =       0.000276167920
  error estimate for blocks of size 2^( 6) =       0.000277826890
  error estimate for blocks of size 2^( 7) =       0.000278967207
  error estimate for blocks of size 2^( 8) =       0.000279624362
  error estimate for blocks of size 2^( 9) =       0.000281350813

      target function =                  N/A
              le_mean =     -22.669617792617
             les_mean =     514.426143358609
             stat err =       0.000279442318
             autocorr =       1.246480049889
              std dev =       0.707936823382
             le_variance =       0.501174545900


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.669617810973        initial
     9.0949e-01     9.0949e+00             2.3427e-04       -22.669618185964  <--
     3.6380e+00     3.6380e+01             7.0893e-05       -22.669617882810
     1.4552e+01     1.4552e+02             1.8706e-05       -22.669617792617

*****************************************************************************
Applying the update for shift_i =   9.0949e-01     and shift_s =   9.0949e+00
*****************************************************************************

  Execution time = 1.7192e+02
  </log>
  <optVariables href="FORM.s043.opt.xml">
ci_001                -7.065713e-01 3 1  ON 0
ci_002                -7.046383e-01 3 1  ON 1
ci_003                -3.740510e-02 3 1  ON 2
ci_004                -3.852653e-02 3 1  ON 3
ci_005                 1.593961e-02 3 1  ON 4
ci_006                 1.566609e-02 3 1  ON 5
ci_007                 1.255319e-02 3 1  ON 6
ci_008                 1.247133e-02 3 1  ON 7
ci_009                -1.160341e-02 3 1  ON 8
ci_010                -1.141934e-02 3 1  ON 9
ci_011                -8.261228e-03 3 1  ON 10
ci_012                -8.169932e-03 3 1  ON 11
ci_013                 9.600954e-03 3 1  ON 12
ci_014                 9.346351e-03 3 1  ON 13
ci_015                 1.240041e-02 3 1  ON 14
ci_016                 1.264565e-02 3 1  ON 15
ci_017                 1.124041e-02 3 1  ON 16
ci_018                 1.080683e-02 3 1  ON 17
ci_019                -3.591892e-03 3 1  ON 18
ci_020                -3.595283e-03 3 1  ON 19
ci_021                -9.162545e-03 3 1  ON 20
ci_022                -9.191055e-03 3 1  ON 21
ci_023                 8.291950e-03 3 1  ON 22
ci_024                 7.813385e-03 3 1  ON 23
ci_025                 3.766532e-03 3 1  ON 24
ci_026                 4.176383e-03 3 1  ON 25
ci_027                 6.303427e-03 3 1  ON 26
ci_028                 6.203671e-03 3 1  ON 27
ci_029                -4.522416e-03 3 1  ON 28
ci_030                -4.303785e-03 3 1  ON 29
ci_031                -7.456314e-03 3 1  ON 30
ci_032                -7.565390e-03 3 1  ON 31
ci_033                 4.268622e-03 3 1  ON 32
ci_034                 4.701613e-03 3 1  ON 33
ci_035                 1.071118e-03 3 1  ON 34
ci_036                 1.052711e-03 3 1  ON 35
ci_037                 4.952578e-03 3 1  ON 36
ci_038                 4.636406e-03 3 1  ON 37
ci_039                 5.509005e-03 3 1  ON 38
ci_040                 5.429926e-03 3 1  ON 39
ci_041                 4.774017e-03 3 1  ON 40
ci_042                 4.711113e-03 3 1  ON 41
ci_043                 4.529639e-03 3 1  ON 42
ci_044                 4.687061e-03 3 1  ON 43
ci_045                 3.277290e-03 3 1  ON 44
ci_046                 2.736796e-03 3 1  ON 45
ci_047                -6.316397e-04 3 1  ON 46
ci_048                -6.762696e-04 3 1  ON 47
ci_049                 2.111730e-03 3 1  ON 48
ci_050                 1.603127e-03 3 1  ON 49
ci_051                -1.686730e-03 3 1  ON 50
ci_052                -2.163502e-03 3 1  ON 51
ci_053                -2.553396e-03 3 1  ON 52
ci_054                -2.861788e-03 3 1  ON 53
ci_055                -1.400572e-03 3 1  ON 54
ci_056                -1.466283e-03 3 1  ON 55
ci_057                -1.626001e-03 3 1  ON 56
ci_058                -1.345014e-03 3 1  ON 57
ci_059                 3.319410e-04 3 1  ON 58
ci_060                 3.053876e-04 3 1  ON 59
ci_061                -2.693691e-05 3 1  ON 60
ci_062                 2.612361e-04 3 1  ON 61
ci_063                -8.159623e-04 3 1  ON 62
ci_064                -7.034432e-04 3 1  ON 63
ci_065                -2.506657e-03 3 1  ON 64
ci_066                -2.652749e-03 3 1  ON 65
ci_067                -2.473987e-03 3 1  ON 66
ci_068                -1.996125e-03 3 1  ON 67
ci_069                -1.957548e-05 3 1  ON 68
ci_070                -2.299303e-04 3 1  ON 69
ci_071                -2.246613e-03 3 1  ON 70
ci_072                -1.948297e-03 3 1  ON 71
ci_073                 1.135957e-04 3 1  ON 72
ci_074                 3.183469e-04 3 1  ON 73
ci_075                -2.909028e-04 3 1  ON 74
ci_076                -3.929367e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 2.9077e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s044 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s044 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=44  my_counter=0
  time step      = 5.0000e-02
  blocks         = 250
  steps          = 250
  substeps       = 10
  current        = 0
  target samples = 8.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">250</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">6.2500e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">8.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">6.2500e+04</parameter>
<parameter name="steps" condition="int">250</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2675e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="250">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =8000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 44
    time step          = 0.05
    reference energy   = -22.608
    reference variance = 0.680675
====================================================
  Execution time = 9.9220e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s044
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 62500 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 6.1034e+04
  VMC Eavg = -2.2670e+01
  VMC Evar = 5.1314e-01
  Total weights = 7.819958610e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.9185e+01
  </log>
</opt>
<opt stage="main" walkers="62500">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.499836338423
                                         uncertainty =       0.001470578769

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.499836338423
                                         uncertainty =       0.001470578769

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000249958902
  error estimate for blocks of size 2^( 2) =       0.000258855793
  error estimate for blocks of size 2^( 3) =       0.000266848987
  error estimate for blocks of size 2^( 4) =       0.000272532084
  error estimate for blocks of size 2^( 5) =       0.000275768075
  error estimate for blocks of size 2^( 6) =       0.000277701790
  error estimate for blocks of size 2^( 7) =       0.000278933057
  error estimate for blocks of size 2^( 8) =       0.000279048324
  error estimate for blocks of size 2^( 9) =       0.000279054628

      target function =                  N/A
              le_mean =     -22.669777525617
             les_mean =     514.431956609246
             stat err =       0.000278684450
             autocorr =       1.243049017613
              std dev =       0.706990539557
             le_variance =       0.499835623023


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266977752562e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.2737e-01, overlap shift 2.2737e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.669777525639       residual = 4.36e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.669781425718       residual = 4.31e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.669783926286       residual = 6.39e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.669784337395       residual = 1.94e-08           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.669784298297       residual = 1.12e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          4 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 2.2737e-01 is 1.309927e-03

solving harmonic davidson linear method for identity shift 9.0949e-01, overlap shift 9.0949e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.669777525639       residual = 4.36e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.669779150920       residual = 4.05e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.669780078359       residual = 3.73e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.669780142741       residual = 8.32e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 9.0949e-01 is 5.612895e-04

solving harmonic davidson linear method for identity shift 3.6380e+00, overlap shift 3.6380e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.669777525639       residual = 4.36e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.669778013261       residual = 3.95e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.669778277639       residual = 4.78e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.669778283887       residual = 9.06e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 3.6380e+00 is 1.703184e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.350279 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.1843e+02
  </log>
  <optVariables href="FORM.s044.opt.xml">
ci_001                -7.065154e-01 3 1  ON 0
ci_002                -7.047066e-01 3 1  ON 1
ci_003                -3.751642e-02 3 1  ON 2
ci_004                -3.839659e-02 3 1  ON 3
ci_005                 1.595847e-02 3 1  ON 4
ci_006                 1.560475e-02 3 1  ON 5
ci_007                 1.251711e-02 3 1  ON 6
ci_008                 1.244490e-02 3 1  ON 7
ci_009                -1.164802e-02 3 1  ON 8
ci_010                -1.127720e-02 3 1  ON 9
ci_011                -8.094208e-03 3 1  ON 10
ci_012                -7.869194e-03 3 1  ON 11
ci_013                 9.799197e-03 3 1  ON 12
ci_014                 9.445823e-03 3 1  ON 13
ci_015                 1.226028e-02 3 1  ON 14
ci_016                 1.279012e-02 3 1  ON 15
ci_017                 1.100599e-02 3 1  ON 16
ci_018                 1.064426e-02 3 1  ON 17
ci_019                -3.533124e-03 3 1  ON 18
ci_020                -3.555069e-03 3 1  ON 19
ci_021                -9.142996e-03 3 1  ON 20
ci_022                -9.188468e-03 3 1  ON 21
ci_023                 8.279542e-03 3 1  ON 22
ci_024                 7.851559e-03 3 1  ON 23
ci_025                 4.019026e-03 3 1  ON 24
ci_026                 4.154192e-03 3 1  ON 25
ci_027                 6.140901e-03 3 1  ON 26
ci_028                 6.509968e-03 3 1  ON 27
ci_029                -4.642401e-03 3 1  ON 28
ci_030                -4.450084e-03 3 1  ON 29
ci_031                -7.565827e-03 3 1  ON 30
ci_032                -7.493640e-03 3 1  ON 31
ci_033                 4.262287e-03 3 1  ON 32
ci_034                 4.760894e-03 3 1  ON 33
ci_035                 1.141837e-03 3 1  ON 34
ci_036                 1.009626e-03 3 1  ON 35
ci_037                 4.391288e-03 3 1  ON 36
ci_038                 4.822555e-03 3 1  ON 37
ci_039                 5.389977e-03 3 1  ON 38
ci_040                 5.479467e-03 3 1  ON 39
ci_041                 4.904497e-03 3 1  ON 40
ci_042                 4.649927e-03 3 1  ON 41
ci_043                 4.587573e-03 3 1  ON 42
ci_044                 4.475063e-03 3 1  ON 43
ci_045                 3.301063e-03 3 1  ON 44
ci_046                 2.829089e-03 3 1  ON 45
ci_047                -6.692644e-04 3 1  ON 46
ci_048                -6.903637e-04 3 1  ON 47
ci_049                 2.157132e-03 3 1  ON 48
ci_050                 1.548798e-03 3 1  ON 49
ci_051                -1.556391e-03 3 1  ON 50
ci_052                -2.055109e-03 3 1  ON 51
ci_053                -2.611573e-03 3 1  ON 52
ci_054                -2.652725e-03 3 1  ON 53
ci_055                -1.426082e-03 3 1  ON 54
ci_056                -1.321056e-03 3 1  ON 55
ci_057                -1.669450e-03 3 1  ON 56
ci_058                -1.510160e-03 3 1  ON 57
ci_059                 3.677765e-04 3 1  ON 58
ci_060                 3.659441e-04 3 1  ON 59
ci_061                -4.887245e-04 3 1  ON 60
ci_062                 3.261426e-04 3 1  ON 61
ci_063                -3.860117e-04 3 1  ON 62
ci_064                -6.428448e-04 3 1  ON 63
ci_065                -2.526000e-03 3 1  ON 64
ci_066                -2.839716e-03 3 1  ON 65
ci_067                -2.547141e-03 3 1  ON 66
ci_068                -1.767982e-03 3 1  ON 67
ci_069                 1.525449e-05 3 1  ON 68
ci_070                -1.378102e-04 3 1  ON 69
ci_071                -2.297168e-03 3 1  ON 70
ci_072                -1.991354e-03 3 1  ON 71
ci_073                 1.969058e-04 3 1  ON 72
ci_074                 1.997142e-04 3 1  ON 73
ci_075                -2.427126e-04 3 1  ON 74
ci_076                -5.717426e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="250">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =8000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 44
    time step          = 0.05
    reference energy   = -22.6424
    reference variance = 0.508197
====================================================
  Execution time = 9.8726e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s044
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 62500 
  VMC Eavg = -2.2670e+01
  VMC Evar = 5.1002e-01
  Total weights = 7.8209e+06
  Execution time = 1.4399e+01
  </log>
</opt>
<opt stage="main" walkers="62500">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.497942401648
                                         uncertainty =       0.001440427153

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.497942401648
                                         uncertainty =       0.001440427153

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000249485184
  error estimate for blocks of size 2^( 2) =       0.000258504801
  error estimate for blocks of size 2^( 3) =       0.000266747991
  error estimate for blocks of size 2^( 4) =       0.000272526277
  error estimate for blocks of size 2^( 5) =       0.000275869645
  error estimate for blocks of size 2^( 6) =       0.000277962916
  error estimate for blocks of size 2^( 7) =       0.000278821731
  error estimate for blocks of size 2^( 8) =       0.000279062897
  error estimate for blocks of size 2^( 9) =       0.000279051319

      target function =                  N/A
              le_mean =     -22.669939485257
             les_mean =     514.440404388583
             stat err =       0.000278724716
             autocorr =       1.248134662387
              std dev =       0.705650660871
             le_variance =       0.497942855188

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.497975009964
                                         uncertainty =       0.001433918671

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.497975009964
                                         uncertainty =       0.001433918671

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000249493374
  error estimate for blocks of size 2^( 2) =       0.000258512045
  error estimate for blocks of size 2^( 3) =       0.000266757851
  error estimate for blocks of size 2^( 4) =       0.000272537839
  error estimate for blocks of size 2^( 5) =       0.000275881748
  error estimate for blocks of size 2^( 6) =       0.000277982267
  error estimate for blocks of size 2^( 7) =       0.000278841562
  error estimate for blocks of size 2^( 8) =       0.000279098079
  error estimate for blocks of size 2^( 9) =       0.000279099145

      target function =                  N/A
              le_mean =     -22.669947526655
             les_mean =     514.442615779791
             stat err =       0.000278755263
             autocorr =       1.248326301906
              std dev =       0.705673825504
             le_variance =       0.497975548002

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.498122743291
                                         uncertainty =       0.001441082322

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.498122743291
                                         uncertainty =       0.001441082322

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000249530422
  error estimate for blocks of size 2^( 2) =       0.000258548523
  error estimate for blocks of size 2^( 3) =       0.000266795182
  error estimate for blocks of size 2^( 4) =       0.000272573878
  error estimate for blocks of size 2^( 5) =       0.000275914115
  error estimate for blocks of size 2^( 6) =       0.000278021265
  error estimate for blocks of size 2^( 7) =       0.000278868280
  error estimate for blocks of size 2^( 8) =       0.000279156086
  error estimate for blocks of size 2^( 9) =       0.000279146590

      target function =                  N/A
              le_mean =     -22.669946688379
             les_mean =     514.470521331029
             stat err =       0.000278798055
             autocorr =       1.248338824687
              std dev =       0.705778613769
             le_variance =       0.498123451653

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.497930254618
                                         uncertainty =       0.001439468408

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.497930254618
                                         uncertainty =       0.001439468408

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000249482143
  error estimate for blocks of size 2^( 2) =       0.000258501741
  error estimate for blocks of size 2^( 3) =       0.000266745368
  error estimate for blocks of size 2^( 4) =       0.000272524069
  error estimate for blocks of size 2^( 5) =       0.000275867756
  error estimate for blocks of size 2^( 6) =       0.000277961642
  error estimate for blocks of size 2^( 7) =       0.000278819490
  error estimate for blocks of size 2^( 8) =       0.000279065157
  error estimate for blocks of size 2^( 9) =       0.000279056629

      target function =                  N/A
              le_mean =     -22.669938444465
             les_mean =     514.441890243708
             stat err =       0.000278725730
             autocorr =       1.248174166452
              std dev =       0.705642060659
             le_variance =       0.497930717771


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.669939485257        initial
     2.2737e-01     2.2737e+00             1.3099e-03       -22.669947526655  <--
     9.0949e-01     9.0949e+00             5.6129e-04       -22.669946688379
     3.6380e+00     3.6380e+01             1.7032e-04       -22.669938444465

*****************************************************************************
Applying the update for shift_i =   2.2737e-01     and shift_s =   2.2737e+00
*****************************************************************************

  Execution time = 1.7105e+02
  </log>
  <optVariables href="FORM.s044.opt.xml">
ci_001                -7.063905e-01 3 1  ON 0
ci_002                -7.048474e-01 3 1  ON 1
ci_003                -3.774731e-02 3 1  ON 2
ci_004                -3.813221e-02 3 1  ON 3
ci_005                 1.599545e-02 3 1  ON 4
ci_006                 1.550888e-02 3 1  ON 5
ci_007                 1.242912e-02 3 1  ON 6
ci_008                 1.240346e-02 3 1  ON 7
ci_009                -1.175014e-02 3 1  ON 8
ci_010                -1.108037e-02 3 1  ON 9
ci_011                -7.795950e-03 3 1  ON 10
ci_012                -7.402904e-03 3 1  ON 11
ci_013                 1.011437e-02 3 1  ON 12
ci_014                 9.636058e-03 3 1  ON 13
ci_015                 1.199271e-02 3 1  ON 14
ci_016                 1.309352e-02 3 1  ON 15
ci_017                 1.062242e-02 3 1  ON 16
ci_018                 1.035861e-02 3 1  ON 17
ci_019                -3.456530e-03 3 1  ON 18
ci_020                -3.481407e-03 3 1  ON 19
ci_021                -9.095502e-03 3 1  ON 20
ci_022                -9.160560e-03 3 1  ON 21
ci_023                 8.270552e-03 3 1  ON 22
ci_024                 7.905779e-03 3 1  ON 23
ci_025                 4.409617e-03 3 1  ON 24
ci_026                 4.104140e-03 3 1  ON 25
ci_027                 5.920290e-03 3 1  ON 26
ci_028                 6.931578e-03 3 1  ON 27
ci_029                -4.858238e-03 3 1  ON 28
ci_030                -4.698831e-03 3 1  ON 29
ci_031                -7.788621e-03 3 1  ON 30
ci_032                -7.433505e-03 3 1  ON 31
ci_033                 4.242346e-03 3 1  ON 32
ci_034                 4.857155e-03 3 1  ON 33
ci_035                 1.236239e-03 3 1  ON 34
ci_036                 9.519143e-04 3 1  ON 35
ci_037                 3.642651e-03 3 1  ON 36
ci_038                 5.124362e-03 3 1  ON 37
ci_039                 5.221891e-03 3 1  ON 38
ci_040                 5.562468e-03 3 1  ON 39
ci_041                 5.104092e-03 3 1  ON 40
ci_042                 4.610320e-03 3 1  ON 41
ci_043                 4.702931e-03 3 1  ON 42
ci_044                 4.211733e-03 3 1  ON 43
ci_045                 3.361565e-03 3 1  ON 44
ci_046                 2.990748e-03 3 1  ON 45
ci_047                -7.223265e-04 3 1  ON 46
ci_048                -6.951881e-04 3 1  ON 47
ci_049                 2.246903e-03 3 1  ON 48
ci_050                 1.453878e-03 3 1  ON 49
ci_051                -1.356423e-03 3 1  ON 50
ci_052                -1.860124e-03 3 1  ON 51
ci_053                -2.762293e-03 3 1  ON 52
ci_054                -2.399506e-03 3 1  ON 53
ci_055                -1.479667e-03 3 1  ON 54
ci_056                -1.071225e-03 3 1  ON 55
ci_057                -1.736662e-03 3 1  ON 56
ci_058                -1.755779e-03 3 1  ON 57
ci_059                 4.326755e-04 3 1  ON 58
ci_060                 4.234176e-04 3 1  ON 59
ci_061                -1.111968e-03 3 1  ON 60
ci_062                 3.896551e-04 3 1  ON 61
ci_063                 2.970930e-04 3 1  ON 62
ci_064                -5.045911e-04 3 1  ON 63
ci_065                -2.558989e-03 3 1  ON 64
ci_066                -3.105917e-03 3 1  ON 65
ci_067                -2.647322e-03 3 1  ON 66
ci_068                -1.481999e-03 3 1  ON 67
ci_069                 7.490899e-05 3 1  ON 68
ci_070                -5.431710e-06 3 1  ON 69
ci_071                -2.363389e-03 3 1  ON 70
ci_072                -2.082063e-03 3 1  ON 71
ci_073                 2.956153e-04 3 1  ON 72
ci_074                 5.265688e-05 3 1  ON 73
ci_075                -1.674696e-04 3 1  ON 74
ci_076                -8.115549e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 2.8949e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s045 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s045 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=45  my_counter=0
  time step      = 5.0000e-02
  blocks         = 250
  steps          = 250
  substeps       = 10
  current        = 0
  target samples = 8.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">250</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">6.2500e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">8.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">6.2500e+04</parameter>
<parameter name="steps" condition="int">250</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2674e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="250">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =8000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 45
    time step          = 0.05
    reference energy   = -22.641
    reference variance = 0.41693
====================================================
  Execution time = 1.0116e+02
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s045
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 62500 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 6.1091e+04
  VMC Eavg = -2.2670e+01
  VMC Evar = 5.1048e-01
  Total weights = 7.821472685e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.8774e+01
  </log>
</opt>
<opt stage="main" walkers="62500">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.496508597832
                                         uncertainty =       0.001513310682

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.496508597832
                                         uncertainty =       0.001513310682

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000249125850
  error estimate for blocks of size 2^( 2) =       0.000258016346
  error estimate for blocks of size 2^( 3) =       0.000266169269
  error estimate for blocks of size 2^( 4) =       0.000271850791
  error estimate for blocks of size 2^( 5) =       0.000274896001
  error estimate for blocks of size 2^( 6) =       0.000276637007
  error estimate for blocks of size 2^( 7) =       0.000277984761
  error estimate for blocks of size 2^( 8) =       0.000278772800
  error estimate for blocks of size 2^( 9) =       0.000279057755

      target function =                  N/A
              le_mean =     -22.669570201561
             les_mean =     514.419893974990
             stat err =       0.000278113081
             autocorr =       1.246250209470
              std dev =       0.704634312458
             le_variance =       0.496509514293


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266957020156e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.6843e-02, overlap shift 5.6843e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.669570201583       residual = 6.28e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.669585108010       residual = 2.36e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.669585159219       residual = 2.35e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.669585447730       residual = 2.56e-08           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.669585455005       residual = 8.12e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          4 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 5.6843e-02 is 1.631653e-03

solving harmonic davidson linear method for identity shift 2.2737e-01, overlap shift 2.2737e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.669570201583       residual = 6.28e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.669578518544       residual = 1.32e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.669578710544       residual = 6.10e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.669578808245       residual = 1.62e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 2.2737e-01 is 9.026388e-04

solving harmonic davidson linear method for identity shift 9.0949e-01, overlap shift 9.0949e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.669570201583       residual = 6.28e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.669573206020       residual = 1.05e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.669573359175       residual = 2.74e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.669573394484       residual = 9.13e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 9.0949e-01 is 3.247893e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.351817 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.1995e+02
  </log>
  <optVariables href="FORM.s045.opt.xml">
ci_001                -7.062765e-01 3 1  ON 0
ci_002                -7.049176e-01 3 1  ON 1
ci_003                -3.799210e-02 3 1  ON 2
ci_004                -3.821919e-02 3 1  ON 3
ci_005                 1.591776e-02 3 1  ON 4
ci_006                 1.578378e-02 3 1  ON 5
ci_007                 1.267947e-02 3 1  ON 6
ci_008                 1.241381e-02 3 1  ON 7
ci_009                -1.187863e-02 3 1  ON 8
ci_010                -1.112445e-02 3 1  ON 9
ci_011                -7.729303e-03 3 1  ON 10
ci_012                -7.570225e-03 3 1  ON 11
ci_013                 1.036304e-02 3 1  ON 12
ci_014                 9.466668e-03 3 1  ON 13
ci_015                 1.232771e-02 3 1  ON 14
ci_016                 1.289070e-02 3 1  ON 15
ci_017                 1.045326e-02 3 1  ON 16
ci_018                 1.096411e-02 3 1  ON 17
ci_019                -3.367559e-03 3 1  ON 18
ci_020                -3.463457e-03 3 1  ON 19
ci_021                -9.212499e-03 3 1  ON 20
ci_022                -9.342476e-03 3 1  ON 21
ci_023                 8.298135e-03 3 1  ON 22
ci_024                 7.918589e-03 3 1  ON 23
ci_025                 4.369315e-03 3 1  ON 24
ci_026                 4.295275e-03 3 1  ON 25
ci_027                 6.148656e-03 3 1  ON 26
ci_028                 7.006561e-03 3 1  ON 27
ci_029                -4.659805e-03 3 1  ON 28
ci_030                -4.497244e-03 3 1  ON 29
ci_031                -7.530138e-03 3 1  ON 30
ci_032                -7.672111e-03 3 1  ON 31
ci_033                 4.661654e-03 3 1  ON 32
ci_034                 4.856372e-03 3 1  ON 33
ci_035                 1.284474e-03 3 1  ON 34
ci_036                 9.217519e-04 3 1  ON 35
ci_037                 4.288403e-03 3 1  ON 36
ci_038                 5.030394e-03 3 1  ON 37
ci_039                 5.266379e-03 3 1  ON 38
ci_040                 5.628757e-03 3 1  ON 39
ci_041                 4.892030e-03 3 1  ON 40
ci_042                 4.941163e-03 3 1  ON 41
ci_043                 4.696638e-03 3 1  ON 42
ci_044                 4.356302e-03 3 1  ON 43
ci_045                 3.069449e-03 3 1  ON 44
ci_046                 2.978219e-03 3 1  ON 45
ci_047                -5.795002e-04 3 1  ON 46
ci_048                -5.006199e-04 3 1  ON 47
ci_049                 1.344264e-03 3 1  ON 48
ci_050                 1.553060e-03 3 1  ON 49
ci_051                -1.513737e-03 3 1  ON 50
ci_052                -1.507988e-03 3 1  ON 51
ci_053                -2.176927e-03 3 1  ON 52
ci_054                -2.658265e-03 3 1  ON 53
ci_055                -1.691622e-03 3 1  ON 54
ci_056                -1.035628e-03 3 1  ON 55
ci_057                -1.604799e-03 3 1  ON 56
ci_058                -1.668186e-03 3 1  ON 57
ci_059                 1.571179e-04 3 1  ON 58
ci_060                 3.701628e-04 3 1  ON 59
ci_061                -4.193240e-04 3 1  ON 60
ci_062                 1.414703e-04 3 1  ON 61
ci_063                -6.078384e-06 3 1  ON 62
ci_064                -6.310276e-04 3 1  ON 63
ci_065                -2.567843e-03 3 1  ON 64
ci_066                -2.867693e-03 3 1  ON 65
ci_067                -2.335703e-03 3 1  ON 66
ci_068                -1.948086e-03 3 1  ON 67
ci_069                 2.312430e-04 3 1  ON 68
ci_070                -2.779251e-04 3 1  ON 69
ci_071                -2.321303e-03 3 1  ON 70
ci_072                -2.582337e-03 3 1  ON 71
ci_073                 2.725198e-04 3 1  ON 72
ci_074                 1.211120e-04 3 1  ON 73
ci_075                -1.834567e-04 3 1  ON 74
ci_076                -9.005383e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="250">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =8000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 45
    time step          = 0.05
    reference energy   = -22.6687
    reference variance = 0.34433
====================================================
  Execution time = 1.0053e+02
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s045
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 62500 
  VMC Eavg = -2.2669e+01
  VMC Evar = 5.1280e-01
  Total weights = 7.8208e+06
  Execution time = 1.4396e+01
  </log>
</opt>
<opt stage="main" walkers="62500">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

ERROR CostFunction-> Number of Effective Walkers is too small! 
  Number of effective walkers (samples) / total number of samples = 0.25169
  User specified threshold minwalkers = 0.3
  If this message appears frequently. You might have to be cautious. 
  Find info about parameter "minwalkers" in the user manual!
Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.500009509745
                                         uncertainty =       0.001349130585

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.500009509745
                                         uncertainty =       0.001349130585

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000250002593
  error estimate for blocks of size 2^( 2) =       0.000258973154
  error estimate for blocks of size 2^( 3) =       0.000266979775
  error estimate for blocks of size 2^( 4) =       0.000272428614
  error estimate for blocks of size 2^( 5) =       0.000275858890
  error estimate for blocks of size 2^( 6) =       0.000277782835
  error estimate for blocks of size 2^( 7) =       0.000278234092
  error estimate for blocks of size 2^( 8) =       0.000278283178
  error estimate for blocks of size 2^( 9) =       0.000278483096

      target function =                  N/A
              le_mean =     -22.669229092558
             les_mean =     514.438208614448
             stat err =       0.000278195800
             autocorr =       1.238260770946
              std dev =       0.707114114255
             le_variance =       0.500010370578

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.499883199965
                                         uncertainty =       0.001337071709

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.499883199965
                                         uncertainty =       0.001337071709

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000249970996
  error estimate for blocks of size 2^( 2) =       0.000258939491
  error estimate for blocks of size 2^( 3) =       0.000266943884
  error estimate for blocks of size 2^( 4) =       0.000272396372
  error estimate for blocks of size 2^( 5) =       0.000275826979
  error estimate for blocks of size 2^( 6) =       0.000277742619
  error estimate for blocks of size 2^( 7) =       0.000278190968
  error estimate for blocks of size 2^( 8) =       0.000278233123
  error estimate for blocks of size 2^( 9) =       0.000278457021

      target function =                  N/A
              le_mean =     -22.669226754753
             les_mean =     514.414698518742
             stat err =       0.000278155933
             autocorr =       1.238218852160
              std dev =       0.707024746686
             le_variance =       0.499883992426

ERROR CostFunction-> Number of Effective Walkers is too small! 
  Number of effective walkers (samples) / total number of samples = 0.260755
  User specified threshold minwalkers = 0.3
  If this message appears frequently. You might have to be cautious. 
  Find info about parameter "minwalkers" in the user manual!
Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.500236661155
                                         uncertainty =       0.001452441499

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.500236661155
                                         uncertainty =       0.001452441499

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000250059383
  error estimate for blocks of size 2^( 2) =       0.000259025959
  error estimate for blocks of size 2^( 3) =       0.000267033688
  error estimate for blocks of size 2^( 4) =       0.000272489831
  error estimate for blocks of size 2^( 5) =       0.000275906924
  error estimate for blocks of size 2^( 6) =       0.000277812217
  error estimate for blocks of size 2^( 7) =       0.000278245228
  error estimate for blocks of size 2^( 8) =       0.000278303984
  error estimate for blocks of size 2^( 9) =       0.000278487628

      target function =                  N/A
              le_mean =     -22.669222799295
             les_mean =     514.640924801640
             stat err =       0.000278212264
             autocorr =       1.237844897909
              std dev =       0.707274741770
             le_variance =       0.500237560346

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.499921255660
                                         uncertainty =       0.001346769626

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.499921255660
                                         uncertainty =       0.001346769626

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000249980524
  error estimate for blocks of size 2^( 2) =       0.000258950105
  error estimate for blocks of size 2^( 3) =       0.000266956404
  error estimate for blocks of size 2^( 4) =       0.000272404009
  error estimate for blocks of size 2^( 5) =       0.000275836332
  error estimate for blocks of size 2^( 6) =       0.000277757482
  error estimate for blocks of size 2^( 7) =       0.000278208657
  error estimate for blocks of size 2^( 8) =       0.000278251441
  error estimate for blocks of size 2^( 9) =       0.000278468835

      target function =                  N/A
              le_mean =     -22.669225542579
             les_mean =     514.409804097596
             stat err =       0.000278171604
             autocorr =       1.238263981027
              std dev =       0.707051695421
             le_variance =       0.499922099997


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.669229092558        initial  <--
     5.6843e-02     5.6843e-01             1.6317e-03       -22.669226754753
     2.2737e-01     2.2737e+00             9.0264e-04       -22.669222799295
     9.0949e-01     9.0949e+00             3.2479e-04       -22.669225542579

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 172.8414
  </log>
  <optVariables href="FORM.s045.opt.xml">
ci_001                -7.063905e-01 3 1  ON 0
ci_002                -7.048474e-01 3 1  ON 1
ci_003                -3.774731e-02 3 1  ON 2
ci_004                -3.813221e-02 3 1  ON 3
ci_005                 1.599545e-02 3 1  ON 4
ci_006                 1.550888e-02 3 1  ON 5
ci_007                 1.242912e-02 3 1  ON 6
ci_008                 1.240346e-02 3 1  ON 7
ci_009                -1.175014e-02 3 1  ON 8
ci_010                -1.108037e-02 3 1  ON 9
ci_011                -7.795950e-03 3 1  ON 10
ci_012                -7.402904e-03 3 1  ON 11
ci_013                 1.011437e-02 3 1  ON 12
ci_014                 9.636058e-03 3 1  ON 13
ci_015                 1.199271e-02 3 1  ON 14
ci_016                 1.309352e-02 3 1  ON 15
ci_017                 1.062242e-02 3 1  ON 16
ci_018                 1.035861e-02 3 1  ON 17
ci_019                -3.456530e-03 3 1  ON 18
ci_020                -3.481407e-03 3 1  ON 19
ci_021                -9.095502e-03 3 1  ON 20
ci_022                -9.160560e-03 3 1  ON 21
ci_023                 8.270552e-03 3 1  ON 22
ci_024                 7.905779e-03 3 1  ON 23
ci_025                 4.409617e-03 3 1  ON 24
ci_026                 4.104140e-03 3 1  ON 25
ci_027                 5.920290e-03 3 1  ON 26
ci_028                 6.931578e-03 3 1  ON 27
ci_029                -4.858238e-03 3 1  ON 28
ci_030                -4.698831e-03 3 1  ON 29
ci_031                -7.788621e-03 3 1  ON 30
ci_032                -7.433505e-03 3 1  ON 31
ci_033                 4.242346e-03 3 1  ON 32
ci_034                 4.857155e-03 3 1  ON 33
ci_035                 1.236239e-03 3 1  ON 34
ci_036                 9.519143e-04 3 1  ON 35
ci_037                 3.642651e-03 3 1  ON 36
ci_038                 5.124362e-03 3 1  ON 37
ci_039                 5.221891e-03 3 1  ON 38
ci_040                 5.562468e-03 3 1  ON 39
ci_041                 5.104092e-03 3 1  ON 40
ci_042                 4.610320e-03 3 1  ON 41
ci_043                 4.702931e-03 3 1  ON 42
ci_044                 4.211733e-03 3 1  ON 43
ci_045                 3.361565e-03 3 1  ON 44
ci_046                 2.990748e-03 3 1  ON 45
ci_047                -7.223265e-04 3 1  ON 46
ci_048                -6.951881e-04 3 1  ON 47
ci_049                 2.246903e-03 3 1  ON 48
ci_050                 1.453878e-03 3 1  ON 49
ci_051                -1.356423e-03 3 1  ON 50
ci_052                -1.860124e-03 3 1  ON 51
ci_053                -2.762293e-03 3 1  ON 52
ci_054                -2.399506e-03 3 1  ON 53
ci_055                -1.479667e-03 3 1  ON 54
ci_056                -1.071225e-03 3 1  ON 55
ci_057                -1.736662e-03 3 1  ON 56
ci_058                -1.755779e-03 3 1  ON 57
ci_059                 4.326755e-04 3 1  ON 58
ci_060                 4.234176e-04 3 1  ON 59
ci_061                -1.111968e-03 3 1  ON 60
ci_062                 3.896551e-04 3 1  ON 61
ci_063                 2.970930e-04 3 1  ON 62
ci_064                -5.045911e-04 3 1  ON 63
ci_065                -2.558989e-03 3 1  ON 64
ci_066                -3.105917e-03 3 1  ON 65
ci_067                -2.647322e-03 3 1  ON 66
ci_068                -1.481999e-03 3 1  ON 67
ci_069                 7.490899e-05 3 1  ON 68
ci_070                -5.431710e-06 3 1  ON 69
ci_071                -2.363389e-03 3 1  ON 70
ci_072                -2.082063e-03 3 1  ON 71
ci_073                 2.956153e-04 3 1  ON 72
ci_074                 5.265688e-05 3 1  ON 73
ci_075                -1.674696e-04 3 1  ON 74
ci_076                -8.115549e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 2.9281e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s046 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s046 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=46  my_counter=0
  time step      = 5.0000e-02
  blocks         = 250
  steps          = 250
  substeps       = 10
  current        = 0
  target samples = 8.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">250</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">6.2500e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">8.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">6.2500e+04</parameter>
<parameter name="steps" condition="int">250</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2673e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="250">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =8000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 46
    time step          = 0.05
    reference energy   = -22.6446
    reference variance = 0.477877
====================================================
  Execution time = 1.0100e+02
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s046
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 62500 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 6.1058e+04
  VMC Eavg = -2.2670e+01
  VMC Evar = 5.1185e-01
  Total weights = 7.820619383e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.9204e+01
  </log>
</opt>
<opt stage="main" walkers="62500">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.499813739070
                                         uncertainty =       0.001548725173

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.499813739070
                                         uncertainty =       0.001548725173

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000249954029
  error estimate for blocks of size 2^( 2) =       0.000258773600
  error estimate for blocks of size 2^( 3) =       0.000266643318
  error estimate for blocks of size 2^( 4) =       0.000272112107
  error estimate for blocks of size 2^( 5) =       0.000275636628
  error estimate for blocks of size 2^( 6) =       0.000277762272
  error estimate for blocks of size 2^( 7) =       0.000278696932
  error estimate for blocks of size 2^( 8) =       0.000279711340
  error estimate for blocks of size 2^( 9) =       0.000281003003

      target function =                  N/A
              le_mean =     -22.669566495231
             les_mean =     514.421096459095
             stat err =       0.000279293387
             autocorr =       1.248535863375
              std dev =       0.706976756320
             le_variance =       0.499816133977


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266956649523e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.6843e-01, overlap shift 5.6843e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.669566495256       residual = 6.21e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.669569664585       residual = 1.11e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.669569937239       residual = 4.08e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.669569966023       residual = 1.19e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 5.6843e-01 is 3.423913e-04

solving harmonic davidson linear method for identity shift 2.2737e+00, overlap shift 2.2737e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.669566495256       residual = 6.21e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.669567455220       residual = 9.06e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.669567560876       residual = 2.59e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.669567566644       residual = 8.34e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 2.2737e+00 is 1.002908e-04

solving harmonic davidson linear method for identity shift 9.0949e+00, overlap shift 9.0949e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.669566495256       residual = 6.21e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.669566748650       residual = 9.17e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.669566778544       residual = 2.56e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.669566780082       residual = 9.42e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 9.0949e+00 is 2.662774e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.353212 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.2022e+02
  </log>
  <optVariables href="FORM.s046.opt.xml">
ci_001                -7.064042e-01 3 1  ON 0
ci_002                -7.048326e-01 3 1  ON 1
ci_003                -3.770398e-02 3 1  ON 2
ci_004                -3.814922e-02 3 1  ON 3
ci_005                 1.597751e-02 3 1  ON 4
ci_006                 1.556823e-02 3 1  ON 5
ci_007                 1.243200e-02 3 1  ON 6
ci_008                 1.242352e-02 3 1  ON 7
ci_009                -1.180962e-02 3 1  ON 8
ci_010                -1.112444e-02 3 1  ON 9
ci_011                -7.848238e-03 3 1  ON 10
ci_012                -7.398961e-03 3 1  ON 11
ci_013                 1.008164e-02 3 1  ON 12
ci_014                 9.614463e-03 3 1  ON 13
ci_015                 1.198596e-02 3 1  ON 14
ci_016                 1.309202e-02 3 1  ON 15
ci_017                 1.063032e-02 3 1  ON 16
ci_018                 1.039155e-02 3 1  ON 17
ci_019                -3.493941e-03 3 1  ON 18
ci_020                -3.480530e-03 3 1  ON 19
ci_021                -9.090753e-03 3 1  ON 20
ci_022                -9.146658e-03 3 1  ON 21
ci_023                 8.196633e-03 3 1  ON 22
ci_024                 7.892491e-03 3 1  ON 23
ci_025                 4.402711e-03 3 1  ON 24
ci_026                 4.074980e-03 3 1  ON 25
ci_027                 6.018451e-03 3 1  ON 26
ci_028                 6.914990e-03 3 1  ON 27
ci_029                -4.863756e-03 3 1  ON 28
ci_030                -4.710636e-03 3 1  ON 29
ci_031                -7.773299e-03 3 1  ON 30
ci_032                -7.436140e-03 3 1  ON 31
ci_033                 4.285324e-03 3 1  ON 32
ci_034                 4.828348e-03 3 1  ON 33
ci_035                 1.231037e-03 3 1  ON 34
ci_036                 1.029731e-03 3 1  ON 35
ci_037                 3.733179e-03 3 1  ON 36
ci_038                 5.093297e-03 3 1  ON 37
ci_039                 5.245617e-03 3 1  ON 38
ci_040                 5.563068e-03 3 1  ON 39
ci_041                 5.112826e-03 3 1  ON 40
ci_042                 4.565628e-03 3 1  ON 41
ci_043                 4.720954e-03 3 1  ON 42
ci_044                 4.241913e-03 3 1  ON 43
ci_045                 3.329869e-03 3 1  ON 44
ci_046                 3.055725e-03 3 1  ON 45
ci_047                -6.951385e-04 3 1  ON 46
ci_048                -6.581316e-04 3 1  ON 47
ci_049                 2.180694e-03 3 1  ON 48
ci_050                 1.502178e-03 3 1  ON 49
ci_051                -1.340912e-03 3 1  ON 50
ci_052                -1.841425e-03 3 1  ON 51
ci_053                -2.731052e-03 3 1  ON 52
ci_054                -2.391113e-03 3 1  ON 53
ci_055                -1.463519e-03 3 1  ON 54
ci_056                -1.122267e-03 3 1  ON 55
ci_057                -1.677634e-03 3 1  ON 56
ci_058                -1.767226e-03 3 1  ON 57
ci_059                 3.908745e-04 3 1  ON 58
ci_060                 4.429751e-04 3 1  ON 59
ci_061                -1.054712e-03 3 1  ON 60
ci_062                 3.454728e-04 3 1  ON 61
ci_063                 1.968023e-04 3 1  ON 62
ci_064                -5.088649e-04 3 1  ON 63
ci_065                -2.547806e-03 3 1  ON 64
ci_066                -3.043755e-03 3 1  ON 65
ci_067                -2.610781e-03 3 1  ON 66
ci_068                -1.520600e-03 3 1  ON 67
ci_069                 1.363285e-04 3 1  ON 68
ci_070                -1.054606e-05 3 1  ON 69
ci_071                -2.414952e-03 3 1  ON 70
ci_072                -2.081198e-03 3 1  ON 71
ci_073                 2.967712e-04 3 1  ON 72
ci_074                 5.778606e-05 3 1  ON 73
ci_075                -1.837972e-04 3 1  ON 74
ci_076                -7.374127e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="250">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =8000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 46
    time step          = 0.05
    reference energy   = -22.5609
    reference variance = 0.570342
====================================================
  Execution time = 1.0032e+02
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s046
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 62500 
  VMC Eavg = -2.2670e+01
  VMC Evar = 5.1518e-01
  Total weights = 7.8205e+06
  Execution time = 1.4394e+01
  </log>
</opt>
<opt stage="main" walkers="62500">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.499848581744
                                         uncertainty =       0.001662571279

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.499848581744
                                         uncertainty =       0.001662571279

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000249962107
  error estimate for blocks of size 2^( 2) =       0.000258855908
  error estimate for blocks of size 2^( 3) =       0.000266783756
  error estimate for blocks of size 2^( 4) =       0.000272436309
  error estimate for blocks of size 2^( 5) =       0.000275798184
  error estimate for blocks of size 2^( 6) =       0.000277701030
  error estimate for blocks of size 2^( 7) =       0.000279459794
  error estimate for blocks of size 2^( 8) =       0.000280746422
  error estimate for blocks of size 2^( 9) =       0.000279651232

      target function =                  N/A
              le_mean =     -22.669543311463
             les_mean =     514.423730424043
             stat err =       0.000279389619
             autocorr =       1.249315649457
              std dev =       0.706999602378
             le_variance =       0.499848437763

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.499850068673
                                         uncertainty =       0.001667339431

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.499850068673
                                         uncertainty =       0.001667339431

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000249962474
  error estimate for blocks of size 2^( 2) =       0.000258854768
  error estimate for blocks of size 2^( 3) =       0.000266781072
  error estimate for blocks of size 2^( 4) =       0.000272433652
  error estimate for blocks of size 2^( 5) =       0.000275793455
  error estimate for blocks of size 2^( 6) =       0.000277697742
  error estimate for blocks of size 2^( 7) =       0.000279455270
  error estimate for blocks of size 2^( 8) =       0.000280743132
  error estimate for blocks of size 2^( 9) =       0.000279651386

      target function =                  N/A
              le_mean =     -22.669544147090
             les_mean =     514.431079537786
             stat err =       0.000279386882
             autocorr =       1.249287495535
              std dev =       0.707000642511
             le_variance =       0.499849908510

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.499842602175
                                         uncertainty =       0.001665222616

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.499842602175
                                         uncertainty =       0.001665222616

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000249960608
  error estimate for blocks of size 2^( 2) =       0.000258853561
  error estimate for blocks of size 2^( 3) =       0.000266780599
  error estimate for blocks of size 2^( 4) =       0.000272433319
  error estimate for blocks of size 2^( 5) =       0.000275794395
  error estimate for blocks of size 2^( 6) =       0.000277697924
  error estimate for blocks of size 2^( 7) =       0.000279456039
  error estimate for blocks of size 2^( 8) =       0.000280743690
  error estimate for blocks of size 2^( 9) =       0.000279649559

      target function =                  N/A
              le_mean =     -22.669543003710
             les_mean =     514.425524427920
             stat err =       0.000279386803
             autocorr =       1.249305436708
              std dev =       0.706995364944
             le_variance =       0.499842446052

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.499846914307
                                         uncertainty =       0.001662889369

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.499846914307
                                         uncertainty =       0.001662889369

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000249961689
  error estimate for blocks of size 2^( 2) =       0.000258855386
  error estimate for blocks of size 2^( 3) =       0.000266783138
  error estimate for blocks of size 2^( 4) =       0.000272435700
  error estimate for blocks of size 2^( 5) =       0.000275797475
  error estimate for blocks of size 2^( 6) =       0.000277700474
  error estimate for blocks of size 2^( 7) =       0.000279459084
  error estimate for blocks of size 2^( 8) =       0.000280745854
  error estimate for blocks of size 2^( 9) =       0.000279650781

      target function =                  N/A
              le_mean =     -22.669543227210
             les_mean =     514.423492171845
             stat err =       0.000279389048
             autocorr =       1.249314714173
              std dev =       0.706998421979
             le_variance =       0.499846768681


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.669543311463        initial
     5.6843e-01     5.6843e+00             3.4239e-04       -22.669544147090  <--
     2.2737e+00     2.2737e+01             1.0029e-04       -22.669543003710
     9.0949e+00     9.0949e+01             2.6628e-05       -22.669543227210

*****************************************************************************
Applying the update for shift_i =   5.6843e-01     and shift_s =   5.6843e+00
*****************************************************************************

  Execution time = 1.7259e+02
  </log>
  <optVariables href="FORM.s046.opt.xml">
ci_001                -7.064446e-01 3 1  ON 0
ci_002                -7.047909e-01 3 1  ON 1
ci_003                -3.758184e-02 3 1  ON 2
ci_004                -3.819890e-02 3 1  ON 3
ci_005                 1.593734e-02 3 1  ON 4
ci_006                 1.569366e-02 3 1  ON 5
ci_007                 1.243717e-02 3 1  ON 6
ci_008                 1.246610e-02 3 1  ON 7
ci_009                -1.194888e-02 3 1  ON 8
ci_010                -1.122384e-02 3 1  ON 9
ci_011                -7.980102e-03 3 1  ON 10
ci_012                -7.392236e-03 3 1  ON 11
ci_013                 1.000055e-02 3 1  ON 12
ci_014                 9.559746e-03 3 1  ON 13
ci_015                 1.196673e-02 3 1  ON 14
ci_016                 1.308779e-02 3 1  ON 15
ci_017                 1.064834e-02 3 1  ON 16
ci_018                 1.047348e-02 3 1  ON 17
ci_019                -3.585422e-03 3 1  ON 18
ci_020                -3.475775e-03 3 1  ON 19
ci_021                -9.075882e-03 3 1  ON 20
ci_022                -9.111957e-03 3 1  ON 21
ci_023                 8.029837e-03 3 1  ON 22
ci_024                 7.863121e-03 3 1  ON 23
ci_025                 4.389387e-03 3 1  ON 24
ci_026                 4.001829e-03 3 1  ON 25
ci_027                 6.218930e-03 3 1  ON 26
ci_028                 6.881247e-03 3 1  ON 27
ci_029                -4.883617e-03 3 1  ON 28
ci_030                -4.745522e-03 3 1  ON 29
ci_031                -7.736525e-03 3 1  ON 30
ci_032                -7.439987e-03 3 1  ON 31
ci_033                 4.391403e-03 3 1  ON 32
ci_034                 4.755532e-03 3 1  ON 33
ci_035                 1.220496e-03 3 1  ON 34
ci_036                 1.188215e-03 3 1  ON 35
ci_037                 3.946518e-03 3 1  ON 36
ci_038                 5.017697e-03 3 1  ON 37
ci_039                 5.292741e-03 3 1  ON 38
ci_040                 5.564629e-03 3 1  ON 39
ci_041                 5.132541e-03 3 1  ON 40
ci_042                 4.467317e-03 3 1  ON 41
ci_043                 4.769325e-03 3 1  ON 42
ci_044                 4.308547e-03 3 1  ON 43
ci_045                 3.251174e-03 3 1  ON 44
ci_046                 3.211342e-03 3 1  ON 45
ci_047                -6.421662e-04 3 1  ON 46
ci_048                -5.831718e-04 3 1  ON 47
ci_049                 2.026674e-03 3 1  ON 48
ci_050                 1.616734e-03 3 1  ON 49
ci_051                -1.301702e-03 3 1  ON 50
ci_052                -1.798518e-03 3 1  ON 51
ci_053                -2.653448e-03 3 1  ON 52
ci_054                -2.369188e-03 3 1  ON 53
ci_055                -1.423446e-03 3 1  ON 54
ci_056                -1.247390e-03 3 1  ON 55
ci_057                -1.544517e-03 3 1  ON 56
ci_058                -1.792726e-03 3 1  ON 57
ci_059                 3.039567e-04 3 1  ON 58
ci_060                 4.859924e-04 3 1  ON 59
ci_061                -9.160899e-04 3 1  ON 60
ci_062                 2.404404e-04 3 1  ON 61
ci_063                -4.529831e-05 3 1  ON 62
ci_064                -5.196658e-04 3 1  ON 63
ci_065                -2.524176e-03 3 1  ON 64
ci_066                -2.901249e-03 3 1  ON 65
ci_067                -2.524516e-03 3 1  ON 66
ci_068                -1.610480e-03 3 1  ON 67
ci_069                 2.789141e-04 3 1  ON 68
ci_070                -2.694820e-05 3 1  ON 69
ci_071                -2.537186e-03 3 1  ON 70
ci_072                -2.082051e-03 3 1  ON 71
ci_073                 3.023239e-04 3 1  ON 72
ci_074                 6.715889e-05 3 1  ON 73
ci_075                -2.239516e-04 3 1  ON 74
ci_076                -5.677673e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 2.9282e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s047 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s047 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=47  my_counter=0
  time step      = 5.0000e-02
  blocks         = 250
  steps          = 250
  substeps       = 10
  current        = 0
  target samples = 8.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">250</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">6.2500e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">8.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">6.2500e+04</parameter>
<parameter name="steps" condition="int">250</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2672e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="250">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =8000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 47
    time step          = 0.05
    reference energy   = -22.5855
    reference variance = 0.456072
====================================================
  Execution time = 1.0094e+02
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s047
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 62500 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 6.1044e+04
  VMC Eavg = -2.2670e+01
  VMC Evar = 5.1280e-01
  Total weights = 7.820622222e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.8797e+01
  </log>
</opt>
<opt stage="main" walkers="62500">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.499751857407
                                         uncertainty =       0.001885353943

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.499751857407
                                         uncertainty =       0.001885353943

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000249938550
  error estimate for blocks of size 2^( 2) =       0.000258991913
  error estimate for blocks of size 2^( 3) =       0.000266984110
  error estimate for blocks of size 2^( 4) =       0.000272603197
  error estimate for blocks of size 2^( 5) =       0.000276032381
  error estimate for blocks of size 2^( 6) =       0.000277681736
  error estimate for blocks of size 2^( 7) =       0.000279545989
  error estimate for blocks of size 2^( 8) =       0.000280495186
  error estimate for blocks of size 2^( 9) =       0.000281223079

      target function =                  N/A
              le_mean =     -22.669900237525
             les_mean =     514.437179169185
             stat err =       0.000279736497
             autocorr =       1.252655858795
              std dev =       0.706932974215
             le_variance =       0.499754230033


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266990023753e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.4211e-01, overlap shift 1.4211e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.669900237550       residual = 6.03e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.669908212194       residual = 2.38e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.669908414148       residual = 1.42e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.669908649476       residual = 4.79e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 1.4211e-01 is 1.055957e-03

solving harmonic davidson linear method for identity shift 5.6843e-01, overlap shift 5.6843e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.669900237550       residual = 6.03e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.669903532460       residual = 9.47e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.669903679946       residual = 3.51e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.669903743430       residual = 8.28e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 5.6843e-01 is 3.917886e-04

solving harmonic davidson linear method for identity shift 2.2737e+00, overlap shift 2.2737e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.669900237550       residual = 6.03e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.669901221896       residual = 8.30e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.669901288369       residual = 1.84e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.669901299118       residual = 4.88e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 2.2737e+00 is 1.120419e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.354665 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.1976e+02
  </log>
  <optVariables href="FORM.s047.opt.xml">
ci_001                -7.064559e-01 3 1  ON 0
ci_002                -7.047998e-01 3 1  ON 1
ci_003                -3.757819e-02 3 1  ON 2
ci_004                -3.793860e-02 3 1  ON 3
ci_005                 1.571553e-02 3 1  ON 4
ci_006                 1.563375e-02 3 1  ON 5
ci_007                 1.235898e-02 3 1  ON 6
ci_008                 1.231058e-02 3 1  ON 7
ci_009                -1.178097e-02 3 1  ON 8
ci_010                -1.143462e-02 3 1  ON 9
ci_011                -7.763185e-03 3 1  ON 10
ci_012                -7.621195e-03 3 1  ON 11
ci_013                 9.884017e-03 3 1  ON 12
ci_014                 9.607175e-03 3 1  ON 13
ci_015                 1.235851e-02 3 1  ON 14
ci_016                 1.305887e-02 3 1  ON 15
ci_017                 1.059699e-02 3 1  ON 16
ci_018                 1.047104e-02 3 1  ON 17
ci_019                -3.441986e-03 3 1  ON 18
ci_020                -3.361565e-03 3 1  ON 19
ci_021                -9.021543e-03 3 1  ON 20
ci_022                -9.277494e-03 3 1  ON 21
ci_023                 7.924453e-03 3 1  ON 22
ci_024                 7.944332e-03 3 1  ON 23
ci_025                 4.366268e-03 3 1  ON 24
ci_026                 4.048859e-03 3 1  ON 25
ci_027                 6.328198e-03 3 1  ON 26
ci_028                 6.692033e-03 3 1  ON 27
ci_029                -4.699687e-03 3 1  ON 28
ci_030                -4.789990e-03 3 1  ON 29
ci_031                -7.719448e-03 3 1  ON 30
ci_032                -7.407122e-03 3 1  ON 31
ci_033                 4.437508e-03 3 1  ON 32
ci_034                 4.888517e-03 3 1  ON 33
ci_035                 1.194001e-03 3 1  ON 34
ci_036                 1.183874e-03 3 1  ON 35
ci_037                 4.165770e-03 3 1  ON 36
ci_038                 5.076344e-03 3 1  ON 37
ci_039                 5.210647e-03 3 1  ON 38
ci_040                 5.547777e-03 3 1  ON 39
ci_041                 5.044685e-03 3 1  ON 40
ci_042                 4.563472e-03 3 1  ON 41
ci_043                 4.864150e-03 3 1  ON 42
ci_044                 4.384663e-03 3 1  ON 43
ci_045                 3.300626e-03 3 1  ON 44
ci_046                 3.256515e-03 3 1  ON 45
ci_047                -6.095140e-04 3 1  ON 46
ci_048                -7.284010e-04 3 1  ON 47
ci_049                 1.862459e-03 3 1  ON 48
ci_050                 1.638165e-03 3 1  ON 49
ci_051                -1.229170e-03 3 1  ON 50
ci_052                -1.709323e-03 3 1  ON 51
ci_053                -2.633024e-03 3 1  ON 52
ci_054                -2.446162e-03 3 1  ON 53
ci_055                -1.463832e-03 3 1  ON 54
ci_056                -1.455948e-03 3 1  ON 55
ci_057                -1.538264e-03 3 1  ON 56
ci_058                -1.853389e-03 3 1  ON 57
ci_059                 4.550163e-04 3 1  ON 58
ci_060                 3.650487e-04 3 1  ON 59
ci_061                -7.875457e-04 3 1  ON 60
ci_062                 1.795375e-04 3 1  ON 61
ci_063                -1.350169e-04 3 1  ON 62
ci_064                -6.839560e-04 3 1  ON 63
ci_065                -2.422710e-03 3 1  ON 64
ci_066                -2.739693e-03 3 1  ON 65
ci_067                -2.325757e-03 3 1  ON 66
ci_068                -1.928019e-03 3 1  ON 67
ci_069                 2.484520e-04 3 1  ON 68
ci_070                 5.954606e-05 3 1  ON 69
ci_071                -2.438903e-03 3 1  ON 70
ci_072                -2.075263e-03 3 1  ON 71
ci_073                 2.370387e-04 3 1  ON 72
ci_074                 2.125494e-04 3 1  ON 73
ci_075                -2.222915e-04 3 1  ON 74
ci_076                -6.306670e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="250">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =8000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 47
    time step          = 0.05
    reference energy   = -22.6184
    reference variance = 0.290137
====================================================
  Execution time = 1.0064e+02
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s047
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 62500 
  VMC Eavg = -2.2670e+01
  VMC Evar = 5.1662e-01
  Total weights = 7.8204e+06
  Execution time = 1.4400e+01
  </log>
</opt>
<opt stage="main" walkers="62500">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.502155694058
                                         uncertainty =       0.001772103986

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.502155694058
                                         uncertainty =       0.001772103986

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000250539391
  error estimate for blocks of size 2^( 2) =       0.000259468993
  error estimate for blocks of size 2^( 3) =       0.000267438189
  error estimate for blocks of size 2^( 4) =       0.000273211324
  error estimate for blocks of size 2^( 5) =       0.000276348461
  error estimate for blocks of size 2^( 6) =       0.000277614832
  error estimate for blocks of size 2^( 7) =       0.000278156815
  error estimate for blocks of size 2^( 8) =       0.000278849762
  error estimate for blocks of size 2^( 9) =       0.000279645969

      target function =                  N/A
              le_mean =     -22.670050050101
             les_mean =     514.466844604950
             stat err =       0.000278566844
             autocorr =       1.236251451770
              std dev =       0.708632408939
             le_variance =       0.502159890998

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.502312662871
                                         uncertainty =       0.001786245208

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.502312662871
                                         uncertainty =       0.001786245208

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000250578551
  error estimate for blocks of size 2^( 2) =       0.000259508808
  error estimate for blocks of size 2^( 3) =       0.000267478238
  error estimate for blocks of size 2^( 4) =       0.000273251922
  error estimate for blocks of size 2^( 5) =       0.000276382492
  error estimate for blocks of size 2^( 6) =       0.000277653007
  error estimate for blocks of size 2^( 7) =       0.000278201352
  error estimate for blocks of size 2^( 8) =       0.000278901245
  error estimate for blocks of size 2^( 9) =       0.000279697846

      target function =                  N/A
              le_mean =     -22.670056502675
             les_mean =     514.484777125503
             stat err =       0.000278613363
             autocorr =       1.236277876937
              std dev =       0.708743169513
             le_variance =       0.502316880331

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.502236216505
                                         uncertainty =       0.001780162201

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.502236216505
                                         uncertainty =       0.001780162201

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000250559479
  error estimate for blocks of size 2^( 2) =       0.000259490675
  error estimate for blocks of size 2^( 3) =       0.000267460976
  error estimate for blocks of size 2^( 4) =       0.000273234970
  error estimate for blocks of size 2^( 5) =       0.000276366486
  error estimate for blocks of size 2^( 6) =       0.000277638131
  error estimate for blocks of size 2^( 7) =       0.000278184210
  error estimate for blocks of size 2^( 8) =       0.000278886484
  error estimate for blocks of size 2^( 9) =       0.000279683230

      target function =                  N/A
              le_mean =     -22.670053545580
             les_mean =     514.448451992880
             stat err =       0.000278598014
             autocorr =       1.236329849466
              std dev =       0.708689228175
             le_variance =       0.502240422131

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.502149956365
                                         uncertainty =       0.001772959589

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.502149956365
                                         uncertainty =       0.001772959589

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000250537961
  error estimate for blocks of size 2^( 2) =       0.000259467802
  error estimate for blocks of size 2^( 3) =       0.000267437345
  error estimate for blocks of size 2^( 4) =       0.000273211178
  error estimate for blocks of size 2^( 5) =       0.000276345896
  error estimate for blocks of size 2^( 6) =       0.000277613152
  error estimate for blocks of size 2^( 7) =       0.000278155985
  error estimate for blocks of size 2^( 8) =       0.000278854860
  error estimate for blocks of size 2^( 9) =       0.000279656543

      target function =                  N/A
              le_mean =     -22.670050024655
             les_mean =     514.449787674539
             stat err =       0.000278570135
             autocorr =       1.236294775592
              std dev =       0.708628363378
             le_variance =       0.502154157384


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.670050050101        initial
     1.4211e-01     1.4211e+00             1.0560e-03       -22.670056502675  <--
     5.6843e-01     5.6843e+00             3.9179e-04       -22.670053545580
     2.2737e+00     2.2737e+01             1.1204e-04       -22.670050024655

*****************************************************************************
Applying the update for shift_i =   1.4211e-01     and shift_s =   1.4211e+00
*****************************************************************************

  Execution time = 1.7295e+02
  </log>
  <optVariables href="FORM.s047.opt.xml">
ci_001                -7.064370e-01 3 1  ON 0
ci_002                -7.048539e-01 3 1  ON 1
ci_003                -3.760192e-02 3 1  ON 2
ci_004                -3.734648e-02 3 1  ON 3
ci_005                 1.547997e-02 3 1  ON 4
ci_006                 1.557041e-02 3 1  ON 5
ci_007                 1.223312e-02 3 1  ON 6
ci_008                 1.207967e-02 3 1  ON 7
ci_009                -1.152287e-02 3 1  ON 8
ci_010                -1.176149e-02 3 1  ON 9
ci_011                -7.445291e-03 3 1  ON 10
ci_012                -7.971250e-03 3 1  ON 11
ci_013                 9.733084e-03 3 1  ON 12
ci_014                 9.682952e-03 3 1  ON 13
ci_015                 1.302268e-02 3 1  ON 14
ci_016                 1.300987e-02 3 1  ON 15
ci_017                 1.049983e-02 3 1  ON 16
ci_018                 1.041633e-02 3 1  ON 17
ci_019                -3.218165e-03 3 1  ON 18
ci_020                -3.174174e-03 3 1  ON 19
ci_021                -8.950602e-03 3 1  ON 20
ci_022                -9.563611e-03 3 1  ON 21
ci_023                 7.797044e-03 3 1  ON 22
ci_024                 8.055490e-03 3 1  ON 23
ci_025                 4.318495e-03 3 1  ON 24
ci_026                 4.109448e-03 3 1  ON 25
ci_027                 6.445638e-03 3 1  ON 26
ci_028                 6.499114e-03 3 1  ON 27
ci_029                -4.427265e-03 3 1  ON 28
ci_030                -4.898978e-03 3 1  ON 29
ci_031                -7.704070e-03 3 1  ON 30
ci_032                -7.315619e-03 3 1  ON 31
ci_033                 4.503146e-03 3 1  ON 32
ci_034                 5.080673e-03 3 1  ON 33
ci_035                 1.166112e-03 3 1  ON 34
ci_036                 1.166789e-03 3 1  ON 35
ci_037                 4.471995e-03 3 1  ON 36
ci_038                 5.172756e-03 3 1  ON 37
ci_039                 5.126453e-03 3 1  ON 38
ci_040                 5.537546e-03 3 1  ON 39
ci_041                 4.938125e-03 3 1  ON 40
ci_042                 4.683150e-03 3 1  ON 41
ci_043                 4.976721e-03 3 1  ON 42
ci_044                 4.526609e-03 3 1  ON 43
ci_045                 3.371137e-03 3 1  ON 44
ci_046                 3.306376e-03 3 1  ON 45
ci_047                -5.646610e-04 3 1  ON 46
ci_048                -8.776477e-04 3 1  ON 47
ci_049                 1.626685e-03 3 1  ON 48
ci_050                 1.674039e-03 3 1  ON 49
ci_051                -1.126157e-03 3 1  ON 50
ci_052                -1.569696e-03 3 1  ON 51
ci_053                -2.616551e-03 3 1  ON 52
ci_054                -2.540020e-03 3 1  ON 53
ci_055                -1.528005e-03 3 1  ON 54
ci_056                -1.764481e-03 3 1  ON 55
ci_057                -1.525889e-03 3 1  ON 56
ci_058                -1.938895e-03 3 1  ON 57
ci_059                 6.161128e-04 3 1  ON 58
ci_060                 2.229272e-04 3 1  ON 59
ci_061                -5.781263e-04 3 1  ON 60
ci_062                 1.005941e-04 3 1  ON 61
ci_063                -2.811346e-04 3 1  ON 62
ci_064                -9.249861e-04 3 1  ON 63
ci_065                -2.286525e-03 3 1  ON 64
ci_066                -2.527879e-03 3 1  ON 65
ci_067                -2.028560e-03 3 1  ON 66
ci_068                -2.382994e-03 3 1  ON 67
ci_069                 1.989920e-04 3 1  ON 68
ci_070                 1.803118e-04 3 1  ON 69
ci_071                -2.309777e-03 3 1  ON 70
ci_072                -2.069273e-03 3 1  ON 71
ci_073                 1.588902e-04 3 1  ON 72
ci_074                 3.739487e-04 3 1  ON 73
ci_075                -2.254305e-04 3 1  ON 74
ci_076                -7.204242e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 2.9271e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s048 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s048 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=48  my_counter=0
  time step      = 5.0000e-02
  blocks         = 250
  steps          = 250
  substeps       = 10
  current        = 0
  target samples = 8.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">250</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">6.2500e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">8.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">6.2500e+04</parameter>
<parameter name="steps" condition="int">250</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2670e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="250">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =8000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 48
    time step          = 0.05
    reference energy   = -22.622
    reference variance = 0.413838
====================================================
  Execution time = 1.0124e+02
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s048
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 62500 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 6.1108e+04
  VMC Eavg = -2.2670e+01
  VMC Evar = 5.1512e-01
  Total weights = 7.820563030e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.9151e+01
  </log>
</opt>
<opt stage="main" walkers="62500">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.500564989983
                                         uncertainty =       0.001888931352

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.500564989983
                                         uncertainty =       0.001888931352

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000250141267
  error estimate for blocks of size 2^( 2) =       0.000258901400
  error estimate for blocks of size 2^( 3) =       0.000267051060
  error estimate for blocks of size 2^( 4) =       0.000272797610
  error estimate for blocks of size 2^( 5) =       0.000276346969
  error estimate for blocks of size 2^( 6) =       0.000278752131
  error estimate for blocks of size 2^( 7) =       0.000279673336
  error estimate for blocks of size 2^( 8) =       0.000280158890
  error estimate for blocks of size 2^( 9) =       0.000280411029

      target function =                  N/A
              le_mean =     -22.669723142969
             les_mean =     514.431465488225
             stat err =       0.000279748847
             autocorr =       1.250736776862
              std dev =       0.707506343313
             le_variance =       0.500565225828


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266972314297e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.5527e-02, overlap shift 3.5527e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.669723142992       residual = 5.26e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.669730102456       residual = 2.56e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.669729963204       residual = 4.61e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.669730202416       residual = 1.63e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.669730113198       residual = 6.05e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.669730326008       residual = 1.47e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.669730328573       residual = 2.15e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 3.5527e-02 is 1.172653e-03

solving harmonic davidson linear method for identity shift 1.4211e-01, overlap shift 1.4211e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.669723142992       residual = 5.26e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.669727730012       residual = 1.19e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.669727592102       residual = 8.89e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.669727618627       residual = 5.23e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 1.4211e-01 is 7.446182e-04

solving harmonic davidson linear method for identity shift 5.6843e-01, overlap shift 5.6843e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.669723142992       residual = 5.26e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.669725083701       residual = 6.24e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.669725034637       residual = 2.70e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.669725029582       residual = 7.99e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 5.6843e-01 is 3.103006e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.359815 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.2042e+02
  </log>
  <optVariables href="FORM.s048.opt.xml">
ci_001                -7.061790e-01 3 1  ON 0
ci_002                -7.051155e-01 3 1  ON 1
ci_003                -3.727136e-02 3 1  ON 2
ci_004                -3.752658e-02 3 1  ON 3
ci_005                 1.566911e-02 3 1  ON 4
ci_006                 1.574662e-02 3 1  ON 5
ci_007                 1.221302e-02 3 1  ON 6
ci_008                 1.220114e-02 3 1  ON 7
ci_009                -1.142187e-02 3 1  ON 8
ci_010                -1.174969e-02 3 1  ON 9
ci_011                -8.046502e-03 3 1  ON 10
ci_012                -7.890893e-03 3 1  ON 11
ci_013                 9.648214e-03 3 1  ON 12
ci_014                 9.893479e-03 3 1  ON 13
ci_015                 1.268415e-02 3 1  ON 14
ci_016                 1.232460e-02 3 1  ON 15
ci_017                 1.055256e-02 3 1  ON 16
ci_018                 1.022456e-02 3 1  ON 17
ci_019                -3.601602e-03 3 1  ON 18
ci_020                -3.342842e-03 3 1  ON 19
ci_021                -9.336027e-03 3 1  ON 20
ci_022                -9.303725e-03 3 1  ON 21
ci_023                 8.145289e-03 3 1  ON 22
ci_024                 8.249433e-03 3 1  ON 23
ci_025                 3.916744e-03 3 1  ON 24
ci_026                 3.900156e-03 3 1  ON 25
ci_027                 6.434428e-03 3 1  ON 26
ci_028                 6.488231e-03 3 1  ON 27
ci_029                -4.506574e-03 3 1  ON 28
ci_030                -5.272151e-03 3 1  ON 29
ci_031                -7.813790e-03 3 1  ON 30
ci_032                -7.484116e-03 3 1  ON 31
ci_033                 4.675915e-03 3 1  ON 32
ci_034                 4.875064e-03 3 1  ON 33
ci_035                 1.136446e-03 3 1  ON 34
ci_036                 1.120523e-03 3 1  ON 35
ci_037                 4.442810e-03 3 1  ON 36
ci_038                 5.208640e-03 3 1  ON 37
ci_039                 5.508631e-03 3 1  ON 38
ci_040                 5.625733e-03 3 1  ON 39
ci_041                 5.137207e-03 3 1  ON 40
ci_042                 4.976891e-03 3 1  ON 41
ci_043                 4.945840e-03 3 1  ON 42
ci_044                 5.147739e-03 3 1  ON 43
ci_045                 2.714540e-03 3 1  ON 44
ci_046                 3.463012e-03 3 1  ON 45
ci_047                -3.859097e-04 3 1  ON 46
ci_048                -7.508225e-04 3 1  ON 47
ci_049                 1.663660e-03 3 1  ON 48
ci_050                 1.614258e-03 3 1  ON 49
ci_051                -1.061860e-03 3 1  ON 50
ci_052                -1.844260e-03 3 1  ON 51
ci_053                -2.533994e-03 3 1  ON 52
ci_054                -2.366661e-03 3 1  ON 53
ci_055                -1.095530e-03 3 1  ON 54
ci_056                -1.019863e-03 3 1  ON 55
ci_057                -1.578767e-03 3 1  ON 56
ci_058                -1.681874e-03 3 1  ON 57
ci_059                 2.667948e-04 3 1  ON 58
ci_060                 5.072814e-04 3 1  ON 59
ci_061                -1.979772e-05 3 1  ON 60
ci_062                 2.134122e-04 3 1  ON 61
ci_063                -7.264202e-04 3 1  ON 62
ci_064                -9.583342e-04 3 1  ON 63
ci_065                -2.014371e-03 3 1  ON 64
ci_066                -2.661065e-03 3 1  ON 65
ci_067                -2.004139e-03 3 1  ON 66
ci_068                -1.793287e-03 3 1  ON 67
ci_069                 7.937956e-05 3 1  ON 68
ci_070                 2.313687e-04 3 1  ON 69
ci_071                -1.969061e-03 3 1  ON 70
ci_072                -1.961681e-03 3 1  ON 71
ci_073                -1.871280e-04 3 1  ON 72
ci_074                 9.939523e-06 3 1  ON 73
ci_075                -3.330796e-04 3 1  ON 74
ci_076                -4.891868e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="250">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =8000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 48
    time step          = 0.05
    reference energy   = -22.7129
    reference variance = 0.516573
====================================================
  Execution time = 1.0059e+02
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s048
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 62500 
  VMC Eavg = -2.2670e+01
  VMC Evar = 5.1029e-01
  Total weights = 7.8200e+06
  Execution time = 1.4368e+01
  </log>
</opt>
<opt stage="main" walkers="62500">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.497771372499
                                         uncertainty =       0.001360683856

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.497771372499
                                         uncertainty =       0.001360683856

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000249442894
  error estimate for blocks of size 2^( 2) =       0.000258478291
  error estimate for blocks of size 2^( 3) =       0.000266321809
  error estimate for blocks of size 2^( 4) =       0.000272138991
  error estimate for blocks of size 2^( 5) =       0.000275806651
  error estimate for blocks of size 2^( 6) =       0.000277665917
  error estimate for blocks of size 2^( 7) =       0.000278545419
  error estimate for blocks of size 2^( 8) =       0.000279066698
  error estimate for blocks of size 2^( 9) =       0.000278886678

      target function =                  N/A
              le_mean =     -22.669607206817
             les_mean =     514.458775007929
             stat err =       0.000278541178
             autocorr =       1.246914119957
              std dev =       0.705531046756
             le_variance =       0.497774057937

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.497752332415
                                         uncertainty =       0.001370070492

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.497752332415
                                         uncertainty =       0.001370070492

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000249438115
  error estimate for blocks of size 2^( 2) =       0.000258468372
  error estimate for blocks of size 2^( 3) =       0.000266308768
  error estimate for blocks of size 2^( 4) =       0.000272124412
  error estimate for blocks of size 2^( 5) =       0.000275790370
  error estimate for blocks of size 2^( 6) =       0.000277637580
  error estimate for blocks of size 2^( 7) =       0.000278523710
  error estimate for blocks of size 2^( 8) =       0.000279051935
  error estimate for blocks of size 2^( 9) =       0.000278892800

      target function =                  N/A
              le_mean =     -22.669589770634
             les_mean =     514.422420074691
             stat err =       0.000278526506
             autocorr =       1.246830539985
              std dev =       0.705517530566
             le_variance =       0.497754985936

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.497844894047
                                         uncertainty =       0.001374356256

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.497844894047
                                         uncertainty =       0.001374356256

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000249461300
  error estimate for blocks of size 2^( 2) =       0.000258488339
  error estimate for blocks of size 2^( 3) =       0.000266326948
  error estimate for blocks of size 2^( 4) =       0.000272141352
  error estimate for blocks of size 2^( 5) =       0.000275807807
  error estimate for blocks of size 2^( 6) =       0.000277652558
  error estimate for blocks of size 2^( 7) =       0.000278539532
  error estimate for blocks of size 2^( 8) =       0.000279069632
  error estimate for blocks of size 2^( 9) =       0.000278920889

      target function =                  N/A
              le_mean =     -22.669594652378
             les_mean =     514.427227594930
             stat err =       0.000278545653
             autocorr =       1.246770180489
              std dev =       0.705583108063
             le_variance =       0.497847522384

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.497712585143
                                         uncertainty =       0.001361580883

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.497712585143
                                         uncertainty =       0.001361580883

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000249428165
  error estimate for blocks of size 2^( 2) =       0.000258463285
  error estimate for blocks of size 2^( 3) =       0.000266305894
  error estimate for blocks of size 2^( 4) =       0.000272122531
  error estimate for blocks of size 2^( 5) =       0.000275788378
  error estimate for blocks of size 2^( 6) =       0.000277641244
  error estimate for blocks of size 2^( 7) =       0.000278523458
  error estimate for blocks of size 2^( 8) =       0.000279043451
  error estimate for blocks of size 2^( 9) =       0.000278871521

      target function =                  N/A
              le_mean =     -22.669595187646
             les_mean =     514.425641893269
             stat err =       0.000278519918
             autocorr =       1.246871029430
              std dev =       0.705489388057
             le_variance =       0.497715276661


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.669607206817        initial  <--
     3.5527e-02     3.5527e-01             1.1727e-03       -22.669589770634
     1.4211e-01     1.4211e+00             7.4462e-04       -22.669594652378
     5.6843e-01     5.6843e+00             3.1030e-04       -22.669595187646

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 172.7760
  </log>
  <optVariables href="FORM.s048.opt.xml">
ci_001                -7.064370e-01 3 1  ON 0
ci_002                -7.048539e-01 3 1  ON 1
ci_003                -3.760192e-02 3 1  ON 2
ci_004                -3.734648e-02 3 1  ON 3
ci_005                 1.547997e-02 3 1  ON 4
ci_006                 1.557041e-02 3 1  ON 5
ci_007                 1.223312e-02 3 1  ON 6
ci_008                 1.207967e-02 3 1  ON 7
ci_009                -1.152287e-02 3 1  ON 8
ci_010                -1.176149e-02 3 1  ON 9
ci_011                -7.445291e-03 3 1  ON 10
ci_012                -7.971250e-03 3 1  ON 11
ci_013                 9.733084e-03 3 1  ON 12
ci_014                 9.682952e-03 3 1  ON 13
ci_015                 1.302268e-02 3 1  ON 14
ci_016                 1.300987e-02 3 1  ON 15
ci_017                 1.049983e-02 3 1  ON 16
ci_018                 1.041633e-02 3 1  ON 17
ci_019                -3.218165e-03 3 1  ON 18
ci_020                -3.174174e-03 3 1  ON 19
ci_021                -8.950602e-03 3 1  ON 20
ci_022                -9.563611e-03 3 1  ON 21
ci_023                 7.797044e-03 3 1  ON 22
ci_024                 8.055490e-03 3 1  ON 23
ci_025                 4.318495e-03 3 1  ON 24
ci_026                 4.109448e-03 3 1  ON 25
ci_027                 6.445638e-03 3 1  ON 26
ci_028                 6.499114e-03 3 1  ON 27
ci_029                -4.427265e-03 3 1  ON 28
ci_030                -4.898978e-03 3 1  ON 29
ci_031                -7.704070e-03 3 1  ON 30
ci_032                -7.315619e-03 3 1  ON 31
ci_033                 4.503146e-03 3 1  ON 32
ci_034                 5.080673e-03 3 1  ON 33
ci_035                 1.166112e-03 3 1  ON 34
ci_036                 1.166789e-03 3 1  ON 35
ci_037                 4.471995e-03 3 1  ON 36
ci_038                 5.172756e-03 3 1  ON 37
ci_039                 5.126453e-03 3 1  ON 38
ci_040                 5.537546e-03 3 1  ON 39
ci_041                 4.938125e-03 3 1  ON 40
ci_042                 4.683150e-03 3 1  ON 41
ci_043                 4.976721e-03 3 1  ON 42
ci_044                 4.526609e-03 3 1  ON 43
ci_045                 3.371137e-03 3 1  ON 44
ci_046                 3.306376e-03 3 1  ON 45
ci_047                -5.646610e-04 3 1  ON 46
ci_048                -8.776477e-04 3 1  ON 47
ci_049                 1.626685e-03 3 1  ON 48
ci_050                 1.674039e-03 3 1  ON 49
ci_051                -1.126157e-03 3 1  ON 50
ci_052                -1.569696e-03 3 1  ON 51
ci_053                -2.616551e-03 3 1  ON 52
ci_054                -2.540020e-03 3 1  ON 53
ci_055                -1.528005e-03 3 1  ON 54
ci_056                -1.764481e-03 3 1  ON 55
ci_057                -1.525889e-03 3 1  ON 56
ci_058                -1.938895e-03 3 1  ON 57
ci_059                 6.161128e-04 3 1  ON 58
ci_060                 2.229272e-04 3 1  ON 59
ci_061                -5.781263e-04 3 1  ON 60
ci_062                 1.005941e-04 3 1  ON 61
ci_063                -2.811346e-04 3 1  ON 62
ci_064                -9.249861e-04 3 1  ON 63
ci_065                -2.286525e-03 3 1  ON 64
ci_066                -2.527879e-03 3 1  ON 65
ci_067                -2.028560e-03 3 1  ON 66
ci_068                -2.382994e-03 3 1  ON 67
ci_069                 1.989920e-04 3 1  ON 68
ci_070                 1.803118e-04 3 1  ON 69
ci_071                -2.309777e-03 3 1  ON 70
ci_072                -2.069273e-03 3 1  ON 71
ci_073                 1.588902e-04 3 1  ON 72
ci_074                 3.739487e-04 3 1  ON 73
ci_075                -2.254305e-04 3 1  ON 74
ci_076                -7.204242e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 2.9321e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s049 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s049 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=49  my_counter=0
  time step      = 5.0000e-02
  blocks         = 250
  steps          = 250
  substeps       = 10
  current        = 0
  target samples = 8.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">250</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">6.2500e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">8.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">6.2500e+04</parameter>
<parameter name="steps" condition="int">250</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2670e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="250">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =8000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 49
    time step          = 0.05
    reference energy   = -22.6409
    reference variance = 0.468571
====================================================
  Execution time = 1.0115e+02
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s049
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 62500 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 6.1049e+04
  VMC Eavg = -2.2670e+01
  VMC Evar = 5.1070e-01
  Total weights = 7.820392072e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.9197e+01
  </log>
</opt>
<opt stage="main" walkers="62500">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.498123932427
                                         uncertainty =       0.001436356346

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.498123932427
                                         uncertainty =       0.001436356346

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000249530809
  error estimate for blocks of size 2^( 2) =       0.000258481855
  error estimate for blocks of size 2^( 3) =       0.000266435617
  error estimate for blocks of size 2^( 4) =       0.000272143474
  error estimate for blocks of size 2^( 5) =       0.000275177227
  error estimate for blocks of size 2^( 6) =       0.000277013697
  error estimate for blocks of size 2^( 7) =       0.000277471502
  error estimate for blocks of size 2^( 8) =       0.000277544371
  error estimate for blocks of size 2^( 9) =       0.000280315394

      target function =                  N/A
              le_mean =     -22.669659728414
             les_mean =     514.424170506467
             stat err =       0.000278086241
             autocorr =       1.241968714130
              std dev =       0.705779707539
             le_variance =       0.498124995574


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266965972841e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.5527e-01, overlap shift 3.5527e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.669659728437       residual = 5.43e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.669663081391       residual = 9.87e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.669662964733       residual = 3.76e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.669662984234       residual = 1.05e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 3.5527e-01 is 8.470215e-04

solving harmonic davidson linear method for identity shift 1.4211e+00, overlap shift 1.4211e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.669659728437       residual = 5.43e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.669660828931       residual = 8.96e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.669660763601       residual = 1.61e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.669660768529       residual = 5.14e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 1.4211e+00 is 2.776088e-04

solving harmonic davidson linear method for identity shift 5.6843e+00, overlap shift 5.6843e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.669659728437       residual = 5.43e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.669660026906       residual = 9.88e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.669660007814       residual = 1.72e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.669660008450       residual = 6.27e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 5.6843e+00 is 7.527872e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.364336 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.2037e+02
  </log>
  <optVariables href="FORM.s049.opt.xml">
ci_001                -7.064906e-01 3 1  ON 0
ci_002                -7.047992e-01 3 1  ON 1
ci_003                -3.757961e-02 3 1  ON 2
ci_004                -3.733306e-02 3 1  ON 3
ci_005                 1.550486e-02 3 1  ON 4
ci_006                 1.563172e-02 3 1  ON 5
ci_007                 1.230365e-02 3 1  ON 6
ci_008                 1.208660e-02 3 1  ON 7
ci_009                -1.152170e-02 3 1  ON 8
ci_010                -1.174520e-02 3 1  ON 9
ci_011                -7.462092e-03 3 1  ON 10
ci_012                -7.965610e-03 3 1  ON 11
ci_013                 9.705071e-03 3 1  ON 12
ci_014                 9.668371e-03 3 1  ON 13
ci_015                 1.302299e-02 3 1  ON 14
ci_016                 1.291171e-02 3 1  ON 15
ci_017                 1.040652e-02 3 1  ON 16
ci_018                 1.040454e-02 3 1  ON 17
ci_019                -3.282213e-03 3 1  ON 18
ci_020                -3.223981e-03 3 1  ON 19
ci_021                -8.940863e-03 3 1  ON 20
ci_022                -9.550597e-03 3 1  ON 21
ci_023                 7.830652e-03 3 1  ON 22
ci_024                 8.088119e-03 3 1  ON 23
ci_025                 4.217588e-03 3 1  ON 24
ci_026                 4.061074e-03 3 1  ON 25
ci_027                 6.414756e-03 3 1  ON 26
ci_028                 6.538113e-03 3 1  ON 27
ci_029                -4.500516e-03 3 1  ON 28
ci_030                -4.936168e-03 3 1  ON 29
ci_031                -7.782393e-03 3 1  ON 30
ci_032                -7.363142e-03 3 1  ON 31
ci_033                 4.557967e-03 3 1  ON 32
ci_034                 5.058784e-03 3 1  ON 33
ci_035                 1.117353e-03 3 1  ON 34
ci_036                 1.192259e-03 3 1  ON 35
ci_037                 4.749604e-03 3 1  ON 36
ci_038                 5.166510e-03 3 1  ON 37
ci_039                 5.177455e-03 3 1  ON 38
ci_040                 5.434994e-03 3 1  ON 39
ci_041                 4.934842e-03 3 1  ON 40
ci_042                 4.742527e-03 3 1  ON 41
ci_043                 4.997465e-03 3 1  ON 42
ci_044                 4.485080e-03 3 1  ON 43
ci_045                 3.364667e-03 3 1  ON 44
ci_046                 3.273402e-03 3 1  ON 45
ci_047                -5.399327e-04 3 1  ON 46
ci_048                -8.578910e-04 3 1  ON 47
ci_049                 1.624122e-03 3 1  ON 48
ci_050                 1.645030e-03 3 1  ON 49
ci_051                -1.152599e-03 3 1  ON 50
ci_052                -1.505078e-03 3 1  ON 51
ci_053                -2.647262e-03 3 1  ON 52
ci_054                -2.605308e-03 3 1  ON 53
ci_055                -1.511783e-03 3 1  ON 54
ci_056                -1.873561e-03 3 1  ON 55
ci_057                -1.586831e-03 3 1  ON 56
ci_058                -1.876876e-03 3 1  ON 57
ci_059                 5.532908e-04 3 1  ON 58
ci_060                 2.596794e-04 3 1  ON 59
ci_061                -7.168094e-04 3 1  ON 60
ci_062                 1.396873e-04 3 1  ON 61
ci_063                -2.917330e-04 3 1  ON 62
ci_064                -9.425997e-04 3 1  ON 63
ci_065                -2.285109e-03 3 1  ON 64
ci_066                -2.516838e-03 3 1  ON 65
ci_067                -2.060755e-03 3 1  ON 66
ci_068                -2.321902e-03 3 1  ON 67
ci_069                 1.893932e-04 3 1  ON 68
ci_070                 1.156793e-04 3 1  ON 69
ci_071                -2.246037e-03 3 1  ON 70
ci_072                -2.090214e-03 3 1  ON 71
ci_073                 1.828722e-04 3 1  ON 72
ci_074                 3.221649e-04 3 1  ON 73
ci_075                -2.158108e-04 3 1  ON 74
ci_076                -6.296012e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="250">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =8000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 49
    time step          = 0.05
    reference energy   = -22.7555
    reference variance = 0.519709
====================================================
  Execution time = 1.0031e+02
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s049
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 62500 
  VMC Eavg = -2.2670e+01
  VMC Evar = 5.1008e-01
  Total weights = 7.8200e+06
  Execution time = 1.4428e+01
  </log>
</opt>
<opt stage="main" walkers="62500">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.497421948801
                                         uncertainty =       0.001125251275

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.497421948801
                                         uncertainty =       0.001125251275

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000249354794
  error estimate for blocks of size 2^( 2) =       0.000258302792
  error estimate for blocks of size 2^( 3) =       0.000266321988
  error estimate for blocks of size 2^( 4) =       0.000272021423
  error estimate for blocks of size 2^( 5) =       0.000275300871
  error estimate for blocks of size 2^( 6) =       0.000277181172
  error estimate for blocks of size 2^( 7) =       0.000278449607
  error estimate for blocks of size 2^( 8) =       0.000278145613
  error estimate for blocks of size 2^( 9) =       0.000278834190

      target function =                  N/A
              le_mean =     -22.669626651221
             les_mean =     514.441225196461
             stat err =       0.000278152645
             autocorr =       1.244316738082
              std dev =       0.705281864230
             le_variance =       0.497422508012

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.497495362859
                                         uncertainty =       0.001130300739

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.497495362859
                                         uncertainty =       0.001130300739

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000249373201
  error estimate for blocks of size 2^( 2) =       0.000258318637
  error estimate for blocks of size 2^( 3) =       0.000266337245
  error estimate for blocks of size 2^( 4) =       0.000272035347
  error estimate for blocks of size 2^( 5) =       0.000275315633
  error estimate for blocks of size 2^( 6) =       0.000277193206
  error estimate for blocks of size 2^( 7) =       0.000278465525
  error estimate for blocks of size 2^( 8) =       0.000278163268
  error estimate for blocks of size 2^( 9) =       0.000278861270

      target function =                  N/A
              le_mean =     -22.669628319275
             les_mean =     514.434018521869
             stat err =       0.000278170817
             autocorr =       1.244295620471
              std dev =       0.705333925692
             le_variance =       0.497495946732

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.497463487731
                                         uncertainty =       0.001128401939

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.497463487731
                                         uncertainty =       0.001128401939

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000249365210
  error estimate for blocks of size 2^( 2) =       0.000258311648
  error estimate for blocks of size 2^( 3) =       0.000266330482
  error estimate for blocks of size 2^( 4) =       0.000272029025
  error estimate for blocks of size 2^( 5) =       0.000275308707
  error estimate for blocks of size 2^( 6) =       0.000277187080
  error estimate for blocks of size 2^( 7) =       0.000278459130
  error estimate for blocks of size 2^( 8) =       0.000278155131
  error estimate for blocks of size 2^( 9) =       0.000278851551

      target function =                  N/A
              le_mean =     -22.669627118388
             les_mean =     514.431226038097
             stat err =       0.000278163223
             autocorr =       1.244307426859
              std dev =       0.705311323793
             le_variance =       0.497464063471

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.497425426556
                                         uncertainty =       0.001125549994

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.497425426556
                                         uncertainty =       0.001125549994

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000249355667
  error estimate for blocks of size 2^( 2) =       0.000258303511
  error estimate for blocks of size 2^( 3) =       0.000266322633
  error estimate for blocks of size 2^( 4) =       0.000272022106
  error estimate for blocks of size 2^( 5) =       0.000275301929
  error estimate for blocks of size 2^( 6) =       0.000277181594
  error estimate for blocks of size 2^( 7) =       0.000278451424
  error estimate for blocks of size 2^( 8) =       0.000278147206
  error estimate for blocks of size 2^( 9) =       0.000278838152

      target function =                  N/A
              le_mean =     -22.669626735137
             les_mean =     514.431583718087
             stat err =       0.000278154594
             autocorr =       1.244325468899
              std dev =       0.705284331225
             le_variance =       0.497425987872


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.669626651221        initial
     3.5527e-01     3.5527e+00             8.4702e-04       -22.669628319275  <--
     1.4211e+00     1.4211e+01             2.7761e-04       -22.669627118388
     5.6843e+00     5.6843e+01             7.5279e-05       -22.669626735137

*****************************************************************************
Applying the update for shift_i =   3.5527e-01     and shift_s =   3.5527e+00
*****************************************************************************

  Execution time = 1.7271e+02
  </log>
  <optVariables href="FORM.s049.opt.xml">
ci_001                -7.066562e-01 3 1  ON 0
ci_002                -7.046334e-01 3 1  ON 1
ci_003                -3.751952e-02 3 1  ON 2
ci_004                -3.729920e-02 3 1  ON 3
ci_005                 1.554792e-02 3 1  ON 4
ci_006                 1.573984e-02 3 1  ON 5
ci_007                 1.244925e-02 3 1  ON 6
ci_008                 1.209511e-02 3 1  ON 7
ci_009                -1.152214e-02 3 1  ON 8
ci_010                -1.170893e-02 3 1  ON 9
ci_011                -7.499712e-03 3 1  ON 10
ci_012                -7.943082e-03 3 1  ON 11
ci_013                 9.664829e-03 3 1  ON 12
ci_014                 9.631534e-03 3 1  ON 13
ci_015                 1.302759e-02 3 1  ON 14
ci_016                 1.269632e-02 3 1  ON 15
ci_017                 1.021849e-02 3 1  ON 16
ci_018                 1.037546e-02 3 1  ON 17
ci_019                -3.419310e-03 3 1  ON 18
ci_020                -3.328945e-03 3 1  ON 19
ci_021                -8.907379e-03 3 1  ON 20
ci_022                -9.511698e-03 3 1  ON 21
ci_023                 7.896487e-03 3 1  ON 22
ci_024                 8.148538e-03 3 1  ON 23
ci_025                 4.012571e-03 3 1  ON 24
ci_026                 3.957062e-03 3 1  ON 25
ci_027                 6.361157e-03 3 1  ON 26
ci_028                 6.603511e-03 3 1  ON 27
ci_029                -4.653793e-03 3 1  ON 28
ci_030                -5.012849e-03 3 1  ON 29
ci_031                -7.954149e-03 3 1  ON 30
ci_032                -7.470044e-03 3 1  ON 31
ci_033                 4.675933e-03 3 1  ON 32
ci_034                 5.014815e-03 3 1  ON 33
ci_035                 1.034526e-03 3 1  ON 34
ci_036                 1.236639e-03 3 1  ON 35
ci_037                 5.319017e-03 3 1  ON 36
ci_038                 5.153684e-03 3 1  ON 37
ci_039                 5.266734e-03 3 1  ON 38
ci_040                 5.252069e-03 3 1  ON 39
ci_041                 4.929001e-03 3 1  ON 40
ci_042                 4.857714e-03 3 1  ON 41
ci_043                 5.037229e-03 3 1  ON 42
ci_044                 4.394702e-03 3 1  ON 43
ci_045                 3.345108e-03 3 1  ON 44
ci_046                 3.203657e-03 3 1  ON 45
ci_047                -5.017760e-04 3 1  ON 46
ci_048                -8.251353e-04 3 1  ON 47
ci_049                 1.618804e-03 3 1  ON 48
ci_050                 1.585603e-03 3 1  ON 49
ci_051                -1.212137e-03 3 1  ON 50
ci_052                -1.366349e-03 3 1  ON 51
ci_053                -2.709295e-03 3 1  ON 52
ci_054                -2.741293e-03 3 1  ON 53
ci_055                -1.475366e-03 3 1  ON 54
ci_056                -2.103713e-03 3 1  ON 55
ci_057                -1.707010e-03 3 1  ON 56
ci_058                -1.752528e-03 3 1  ON 57
ci_059                 4.414566e-04 3 1  ON 58
ci_060                 3.285709e-04 3 1  ON 59
ci_061                -9.828681e-04 3 1  ON 60
ci_062                 2.200554e-04 3 1  ON 61
ci_063                -3.155476e-04 3 1  ON 62
ci_064                -9.797121e-04 3 1  ON 63
ci_065                -2.278674e-03 3 1  ON 64
ci_066                -2.490496e-03 3 1  ON 65
ci_067                -2.129593e-03 3 1  ON 66
ci_068                -2.188503e-03 3 1  ON 67
ci_069                 1.718853e-04 3 1  ON 68
ci_070                -1.569826e-05 3 1  ON 69
ci_071                -2.122581e-03 3 1  ON 70
ci_072                -2.137999e-03 3 1  ON 71
ci_073                 2.289798e-04 3 1  ON 72
ci_074                 2.318225e-04 3 1  ON 73
ci_075                -1.966046e-04 3 1  ON 74
ci_076                -4.462550e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 2.9309e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s050 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s050 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=50  my_counter=0
  time step      = 5.0000e-02
  blocks         = 250
  steps          = 250
  substeps       = 10
  current        = 0
  target samples = 8.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">250</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">6.2500e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">8.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">6.2500e+04</parameter>
<parameter name="steps" condition="int">250</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2671e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="250">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =8000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 50
    time step          = 0.05
    reference energy   = -22.5983
    reference variance = 0.655358
====================================================
  Execution time = 1.0054e+02
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s050
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 62500 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 6.1056e+04
  VMC Eavg = -2.2670e+01
  VMC Evar = 5.1032e-01
  Total weights = 7.820293738e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.9153e+01
  </log>
</opt>
<opt stage="main" walkers="62500">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.498558126809
                                         uncertainty =       0.001688045103

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.498558126809
                                         uncertainty =       0.001688045103

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000249639718
  error estimate for blocks of size 2^( 2) =       0.000258615494
  error estimate for blocks of size 2^( 3) =       0.000266701544
  error estimate for blocks of size 2^( 4) =       0.000272132008
  error estimate for blocks of size 2^( 5) =       0.000275529250
  error estimate for blocks of size 2^( 6) =       0.000277419010
  error estimate for blocks of size 2^( 7) =       0.000278570353
  error estimate for blocks of size 2^( 8) =       0.000278639815
  error estimate for blocks of size 2^( 9) =       0.000277690060

      target function =                  N/A
              le_mean =     -22.670174270280
             les_mean =     514.447122643804
             stat err =       0.000278079810
             autocorr =       1.240827895166
              std dev =       0.706087749711
             le_variance =       0.498559910292


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.267017427028e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 8.8818e-02, overlap shift 8.8818e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.670174270300       residual = 4.13e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.670182207126       residual = 1.42e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.670182175701       residual = 1.17e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.670182145268       residual = 1.26e-08           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.670182141386       residual = 1.69e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          4 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 8.8818e-02 is 1.156278e-03

solving harmonic davidson linear method for identity shift 3.5527e-01, overlap shift 3.5527e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.670174270300       residual = 4.13e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.670178086780       residual = 5.98e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.670177990985       residual = 2.88e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.670177977233       residual = 1.21e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 3.5527e-01 is 5.407020e-04

solving harmonic davidson linear method for identity shift 1.4211e+00, overlap shift 1.4211e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.670174270300       residual = 4.13e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.670175510797       residual = 5.32e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.670175477171       residual = 2.00e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.670175475235       residual = 6.37e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 1.4211e+00 is 1.740178e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.365872 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.1971e+02
  </log>
  <optVariables href="FORM.s050.opt.xml">
ci_001                -7.065893e-01 3 1  ON 0
ci_002                -7.046876e-01 3 1  ON 1
ci_003                -3.738501e-02 3 1  ON 2
ci_004                -3.742384e-02 3 1  ON 3
ci_005                 1.556625e-02 3 1  ON 4
ci_006                 1.570554e-02 3 1  ON 5
ci_007                 1.224126e-02 3 1  ON 6
ci_008                 1.220209e-02 3 1  ON 7
ci_009                -1.161095e-02 3 1  ON 8
ci_010                -1.175148e-02 3 1  ON 9
ci_011                -7.966574e-03 3 1  ON 10
ci_012                -7.890513e-03 3 1  ON 11
ci_013                 9.572950e-03 3 1  ON 12
ci_014                 9.713162e-03 3 1  ON 13
ci_015                 1.301940e-02 3 1  ON 14
ci_016                 1.294319e-02 3 1  ON 15
ci_017                 1.041732e-02 3 1  ON 16
ci_018                 1.064515e-02 3 1  ON 17
ci_019                -3.610606e-03 3 1  ON 18
ci_020                -3.481224e-03 3 1  ON 19
ci_021                -8.991050e-03 3 1  ON 20
ci_022                -9.472604e-03 3 1  ON 21
ci_023                 7.995786e-03 3 1  ON 22
ci_024                 7.951247e-03 3 1  ON 23
ci_025                 3.913723e-03 3 1  ON 24
ci_026                 4.193440e-03 3 1  ON 25
ci_027                 6.445541e-03 3 1  ON 26
ci_028                 6.343683e-03 3 1  ON 27
ci_029                -4.565963e-03 3 1  ON 28
ci_030                -4.948972e-03 3 1  ON 29
ci_031                -8.060951e-03 3 1  ON 30
ci_032                -7.345619e-03 3 1  ON 31
ci_033                 4.607350e-03 3 1  ON 32
ci_034                 4.850735e-03 3 1  ON 33
ci_035                 9.332439e-04 3 1  ON 34
ci_036                 1.201553e-03 3 1  ON 35
ci_037                 5.386272e-03 3 1  ON 36
ci_038                 5.248550e-03 3 1  ON 37
ci_039                 5.324833e-03 3 1  ON 38
ci_040                 5.352879e-03 3 1  ON 39
ci_041                 4.967384e-03 3 1  ON 40
ci_042                 4.971095e-03 3 1  ON 41
ci_043                 4.939643e-03 3 1  ON 42
ci_044                 4.527319e-03 3 1  ON 43
ci_045                 3.364027e-03 3 1  ON 44
ci_046                 3.211225e-03 3 1  ON 45
ci_047                -4.563699e-04 3 1  ON 46
ci_048                -7.315953e-04 3 1  ON 47
ci_049                 1.677118e-03 3 1  ON 48
ci_050                 1.549087e-03 3 1  ON 49
ci_051                -1.477432e-03 3 1  ON 50
ci_052                -1.205489e-03 3 1  ON 51
ci_053                -2.561258e-03 3 1  ON 52
ci_054                -2.639661e-03 3 1  ON 53
ci_055                -1.697912e-03 3 1  ON 54
ci_056                -2.249031e-03 3 1  ON 55
ci_057                -1.580014e-03 3 1  ON 56
ci_058                -1.691841e-03 3 1  ON 57
ci_059                 3.951402e-04 3 1  ON 58
ci_060                 2.602993e-04 3 1  ON 59
ci_061                -4.421661e-04 3 1  ON 60
ci_062                 3.162763e-04 3 1  ON 61
ci_063                -5.463676e-04 3 1  ON 62
ci_064                -8.435377e-04 3 1  ON 63
ci_065                -2.187681e-03 3 1  ON 64
ci_066                -2.301783e-03 3 1  ON 65
ci_067                -2.444754e-03 3 1  ON 66
ci_068                -2.069969e-03 3 1  ON 67
ci_069                 5.746333e-05 3 1  ON 68
ci_070                -7.819158e-05 3 1  ON 69
ci_071                -1.943341e-03 3 1  ON 70
ci_072                -2.020392e-03 3 1  ON 71
ci_073                 3.293299e-04 3 1  ON 72
ci_074                 2.824110e-04 3 1  ON 73
ci_075                -3.453899e-04 3 1  ON 74
ci_076                -1.976008e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="250">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =8000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 50
    time step          = 0.05
    reference energy   = -22.538
    reference variance = 0.401829
====================================================
  Execution time = 1.0071e+02
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s050
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 62500 
  VMC Eavg = -2.2670e+01
  VMC Evar = 5.1525e-01
  Total weights = 7.8212e+06
  Execution time = 1.4440e+01
  </log>
</opt>
<opt stage="main" walkers="62500">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.500842451436
                                         uncertainty =       0.001485127932

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.500842451436
                                         uncertainty =       0.001485127932

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000250210429
  error estimate for blocks of size 2^( 2) =       0.000259200642
  error estimate for blocks of size 2^( 3) =       0.000267195313
  error estimate for blocks of size 2^( 4) =       0.000272873499
  error estimate for blocks of size 2^( 5) =       0.000276539695
  error estimate for blocks of size 2^( 6) =       0.000278288214
  error estimate for blocks of size 2^( 7) =       0.000279677112
  error estimate for blocks of size 2^( 8) =       0.000280294661
  error estimate for blocks of size 2^( 9) =       0.000281270760

      target function =                  N/A
              le_mean =     -22.670005127375
             les_mean =     514.454353145366
             stat err =       0.000279882687
             autocorr =       1.251241824525
              std dev =       0.707701964901
             le_variance =       0.500842071125

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.500881917550
                                         uncertainty =       0.001486784105

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.500881917550
                                         uncertainty =       0.001486784105

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000250220287
  error estimate for blocks of size 2^( 2) =       0.000259208952
  error estimate for blocks of size 2^( 3) =       0.000267203429
  error estimate for blocks of size 2^( 4) =       0.000272882302
  error estimate for blocks of size 2^( 5) =       0.000276546472
  error estimate for blocks of size 2^( 6) =       0.000278298140
  error estimate for blocks of size 2^( 7) =       0.000279689714
  error estimate for blocks of size 2^( 8) =       0.000280319945
  error estimate for blocks of size 2^( 9) =       0.000281281881

      target function =                  N/A
              le_mean =     -22.670002591762
             les_mean =     514.451065221859
             stat err =       0.000279897420
             autocorr =       1.251274960375
              std dev =       0.707729847469
             le_variance =       0.500881536999

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.500881825302
                                         uncertainty =       0.001487825809

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.500881825302
                                         uncertainty =       0.001487825809

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000250220263
  error estimate for blocks of size 2^( 2) =       0.000259209374
  error estimate for blocks of size 2^( 3) =       0.000267204615
  error estimate for blocks of size 2^( 4) =       0.000272882807
  error estimate for blocks of size 2^( 5) =       0.000276547134
  error estimate for blocks of size 2^( 6) =       0.000278298289
  error estimate for blocks of size 2^( 7) =       0.000279690206
  error estimate for blocks of size 2^( 8) =       0.000280320454
  error estimate for blocks of size 2^( 9) =       0.000281278937

      target function =                  N/A
              le_mean =     -22.670000918620
             les_mean =     514.458918470949
             stat err =       0.000279896971
             autocorr =       1.251271190831
              std dev =       0.707729779623
             le_variance =       0.500881440966

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.500834141762
                                         uncertainty =       0.001485312441

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.500834141762
                                         uncertainty =       0.001485312441

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000250208353
  error estimate for blocks of size 2^( 2) =       0.000259198521
  error estimate for blocks of size 2^( 3) =       0.000267193294
  error estimate for blocks of size 2^( 4) =       0.000272871732
  error estimate for blocks of size 2^( 5) =       0.000276537349
  error estimate for blocks of size 2^( 6) =       0.000278286682
  error estimate for blocks of size 2^( 7) =       0.000279674996
  error estimate for blocks of size 2^( 8) =       0.000280294421
  error estimate for blocks of size 2^( 9) =       0.000281270380

      target function =                  N/A
              le_mean =     -22.670003338487
             les_mean =     514.448513438299
             stat err =       0.000279881620
             autocorr =       1.251253044369
              std dev =       0.707696093411
             le_variance =       0.500833760629


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.670005127375        initial  <--
     8.8818e-02     8.8818e-01             1.1563e-03       -22.670002591762
     3.5527e-01     3.5527e+00             5.4070e-04       -22.670000918620
     1.4211e+00     1.4211e+01             1.7402e-04       -22.670003338487

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 173.1700
  </log>
  <optVariables href="FORM.s050.opt.xml">
ci_001                -7.066562e-01 3 1  ON 0
ci_002                -7.046334e-01 3 1  ON 1
ci_003                -3.751952e-02 3 1  ON 2
ci_004                -3.729920e-02 3 1  ON 3
ci_005                 1.554792e-02 3 1  ON 4
ci_006                 1.573984e-02 3 1  ON 5
ci_007                 1.244925e-02 3 1  ON 6
ci_008                 1.209511e-02 3 1  ON 7
ci_009                -1.152214e-02 3 1  ON 8
ci_010                -1.170893e-02 3 1  ON 9
ci_011                -7.499712e-03 3 1  ON 10
ci_012                -7.943082e-03 3 1  ON 11
ci_013                 9.664829e-03 3 1  ON 12
ci_014                 9.631534e-03 3 1  ON 13
ci_015                 1.302759e-02 3 1  ON 14
ci_016                 1.269632e-02 3 1  ON 15
ci_017                 1.021849e-02 3 1  ON 16
ci_018                 1.037546e-02 3 1  ON 17
ci_019                -3.419310e-03 3 1  ON 18
ci_020                -3.328945e-03 3 1  ON 19
ci_021                -8.907379e-03 3 1  ON 20
ci_022                -9.511698e-03 3 1  ON 21
ci_023                 7.896487e-03 3 1  ON 22
ci_024                 8.148538e-03 3 1  ON 23
ci_025                 4.012571e-03 3 1  ON 24
ci_026                 3.957062e-03 3 1  ON 25
ci_027                 6.361157e-03 3 1  ON 26
ci_028                 6.603511e-03 3 1  ON 27
ci_029                -4.653793e-03 3 1  ON 28
ci_030                -5.012849e-03 3 1  ON 29
ci_031                -7.954149e-03 3 1  ON 30
ci_032                -7.470044e-03 3 1  ON 31
ci_033                 4.675933e-03 3 1  ON 32
ci_034                 5.014815e-03 3 1  ON 33
ci_035                 1.034526e-03 3 1  ON 34
ci_036                 1.236639e-03 3 1  ON 35
ci_037                 5.319017e-03 3 1  ON 36
ci_038                 5.153684e-03 3 1  ON 37
ci_039                 5.266734e-03 3 1  ON 38
ci_040                 5.252069e-03 3 1  ON 39
ci_041                 4.929001e-03 3 1  ON 40
ci_042                 4.857714e-03 3 1  ON 41
ci_043                 5.037229e-03 3 1  ON 42
ci_044                 4.394702e-03 3 1  ON 43
ci_045                 3.345108e-03 3 1  ON 44
ci_046                 3.203657e-03 3 1  ON 45
ci_047                -5.017760e-04 3 1  ON 46
ci_048                -8.251353e-04 3 1  ON 47
ci_049                 1.618804e-03 3 1  ON 48
ci_050                 1.585603e-03 3 1  ON 49
ci_051                -1.212137e-03 3 1  ON 50
ci_052                -1.366349e-03 3 1  ON 51
ci_053                -2.709295e-03 3 1  ON 52
ci_054                -2.741293e-03 3 1  ON 53
ci_055                -1.475366e-03 3 1  ON 54
ci_056                -2.103713e-03 3 1  ON 55
ci_057                -1.707010e-03 3 1  ON 56
ci_058                -1.752528e-03 3 1  ON 57
ci_059                 4.414566e-04 3 1  ON 58
ci_060                 3.285709e-04 3 1  ON 59
ci_061                -9.828681e-04 3 1  ON 60
ci_062                 2.200554e-04 3 1  ON 61
ci_063                -3.155476e-04 3 1  ON 62
ci_064                -9.797121e-04 3 1  ON 63
ci_065                -2.278674e-03 3 1  ON 64
ci_066                -2.490496e-03 3 1  ON 65
ci_067                -2.129593e-03 3 1  ON 66
ci_068                -2.188503e-03 3 1  ON 67
ci_069                 1.718853e-04 3 1  ON 68
ci_070                -1.569826e-05 3 1  ON 69
ci_071                -2.122581e-03 3 1  ON 70
ci_072                -2.137999e-03 3 1  ON 71
ci_073                 2.289798e-04 3 1  ON 72
ci_074                 2.318225e-04 3 1  ON 73
ci_075                -1.966046e-04 3 1  ON 74
ci_076                -4.462550e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 2.9289e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s051 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s051 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=51  my_counter=0
  time step      = 5.0000e-02
  blocks         = 250
  steps          = 250
  substeps       = 10
  current        = 0
  target samples = 8.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">250</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">6.2500e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">8.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">6.2500e+04</parameter>
<parameter name="steps" condition="int">250</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2669e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="250">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =8000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 51
    time step          = 0.05
    reference energy   = -22.6237
    reference variance = 0.381192
====================================================
  Execution time = 1.0069e+02
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s051
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 62500 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 6.1065e+04
  VMC Eavg = -2.2669e+01
  VMC Evar = 5.1808e-01
  Total weights = 7.820707646e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.9019e+01
  </log>
</opt>
<opt stage="main" walkers="62500">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.502713748756
                                         uncertainty =       0.003915284927

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.502713748756
                                         uncertainty =       0.003915284927

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000250677339
  error estimate for blocks of size 2^( 2) =       0.000259719826
  error estimate for blocks of size 2^( 3) =       0.000267733060
  error estimate for blocks of size 2^( 4) =       0.000273382013
  error estimate for blocks of size 2^( 5) =       0.000276461465
  error estimate for blocks of size 2^( 6) =       0.000278392634
  error estimate for blocks of size 2^( 7) =       0.000279529903
  error estimate for blocks of size 2^( 8) =       0.000280355252
  error estimate for blocks of size 2^( 9) =       0.000281118181

      target function =                  N/A
              le_mean =     -22.669181838458
             les_mean =     514.409887860435
             stat err =       0.000279848993
             autocorr =       1.246284930887
              std dev =       0.709022585212
             le_variance =       0.502713026341


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266918183846e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 8.8818e-01, overlap shift 8.8818e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.669181838481       residual = 3.74e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.669183172834       residual = 4.54e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.669183287338       residual = 2.41e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.669183286599       residual = 6.57e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 8.8818e-01 is 2.097191e-04

solving harmonic davidson linear method for identity shift 3.5527e+00, overlap shift 3.5527e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.669181838481       residual = 3.74e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.669182222170       residual = 4.23e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.669182257907       residual = 2.25e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.669182257076       residual = 8.15e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 3.5527e+00 is 6.362046e-05

solving harmonic davidson linear method for identity shift 1.4211e+01, overlap shift 1.4211e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.669181838481       residual = 3.74e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.669181938145       residual = 4.36e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.669181947555       residual = 2.41e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.669181947429       residual = 9.18e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 1.4211e+01 is 1.680815e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.367279 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.1973e+02
  </log>
  <optVariables href="FORM.s051.opt.xml">
ci_001                -7.066612e-01 3 1  ON 0
ci_002                -7.046254e-01 3 1  ON 1
ci_003                -3.751382e-02 3 1  ON 2
ci_004                -3.731768e-02 3 1  ON 3
ci_005                 1.560250e-02 3 1  ON 4
ci_006                 1.572964e-02 3 1  ON 5
ci_007                 1.244444e-02 3 1  ON 6
ci_008                 1.209334e-02 3 1  ON 7
ci_009                -1.154662e-02 3 1  ON 8
ci_010                -1.171246e-02 3 1  ON 9
ci_011                -7.528418e-03 3 1  ON 10
ci_012                -7.927606e-03 3 1  ON 11
ci_013                 9.680570e-03 3 1  ON 12
ci_014                 9.634753e-03 3 1  ON 13
ci_015                 1.300201e-02 3 1  ON 14
ci_016                 1.271210e-02 3 1  ON 15
ci_017                 1.025256e-02 3 1  ON 16
ci_018                 1.037532e-02 3 1  ON 17
ci_019                -3.414155e-03 3 1  ON 18
ci_020                -3.331826e-03 3 1  ON 19
ci_021                -8.920180e-03 3 1  ON 20
ci_022                -9.516364e-03 3 1  ON 21
ci_023                 7.920035e-03 3 1  ON 22
ci_024                 8.162922e-03 3 1  ON 23
ci_025                 4.003409e-03 3 1  ON 24
ci_026                 3.969024e-03 3 1  ON 25
ci_027                 6.346871e-03 3 1  ON 26
ci_028                 6.620254e-03 3 1  ON 27
ci_029                -4.657136e-03 3 1  ON 28
ci_030                -4.976000e-03 3 1  ON 29
ci_031                -7.976244e-03 3 1  ON 30
ci_032                -7.469470e-03 3 1  ON 31
ci_033                 4.640885e-03 3 1  ON 32
ci_034                 5.020095e-03 3 1  ON 33
ci_035                 1.026839e-03 3 1  ON 34
ci_036                 1.236399e-03 3 1  ON 35
ci_037                 5.318603e-03 3 1  ON 36
ci_038                 5.157111e-03 3 1  ON 37
ci_039                 5.267518e-03 3 1  ON 38
ci_040                 5.256642e-03 3 1  ON 39
ci_041                 4.917546e-03 3 1  ON 40
ci_042                 4.840311e-03 3 1  ON 41
ci_043                 5.043876e-03 3 1  ON 42
ci_044                 4.417494e-03 3 1  ON 43
ci_045                 3.342776e-03 3 1  ON 44
ci_046                 3.216146e-03 3 1  ON 45
ci_047                -5.653964e-04 3 1  ON 46
ci_048                -8.227129e-04 3 1  ON 47
ci_049                 1.621835e-03 3 1  ON 48
ci_050                 1.570944e-03 3 1  ON 49
ci_051                -1.209206e-03 3 1  ON 50
ci_052                -1.354408e-03 3 1  ON 51
ci_053                -2.725242e-03 3 1  ON 52
ci_054                -2.753711e-03 3 1  ON 53
ci_055                -1.473768e-03 3 1  ON 54
ci_056                -2.070966e-03 3 1  ON 55
ci_057                -1.666994e-03 3 1  ON 56
ci_058                -1.756114e-03 3 1  ON 57
ci_059                 4.332583e-04 3 1  ON 58
ci_060                 3.096039e-04 3 1  ON 59
ci_061                -9.319907e-04 3 1  ON 60
ci_062                 2.173609e-04 3 1  ON 61
ci_063                -3.445727e-04 3 1  ON 62
ci_064                -9.671039e-04 3 1  ON 63
ci_065                -2.282903e-03 3 1  ON 64
ci_066                -2.474227e-03 3 1  ON 65
ci_067                -2.137715e-03 3 1  ON 66
ci_068                -2.170928e-03 3 1  ON 67
ci_069                 1.697009e-04 3 1  ON 68
ci_070                -5.725164e-05 3 1  ON 69
ci_071                -2.132862e-03 3 1  ON 70
ci_072                -2.128738e-03 3 1  ON 71
ci_073                 2.328775e-04 3 1  ON 72
ci_074                 2.362121e-04 3 1  ON 73
ci_075                -2.115733e-04 3 1  ON 74
ci_076                -4.457206e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="250">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =8000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 51
    time step          = 0.05
    reference energy   = -22.6407
    reference variance = 0.407546
====================================================
  Execution time = 1.0043e+02
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s051
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 62500 
  VMC Eavg = -2.2670e+01
  VMC Evar = 5.1066e-01
  Total weights = 7.8212e+06
  Execution time = 1.4441e+01
  </log>
</opt>
<opt stage="main" walkers="62500">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.498424665639
                                         uncertainty =       0.001912646975

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.498424665639
                                         uncertainty =       0.001912646975

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000249606047
  error estimate for blocks of size 2^( 2) =       0.000258550094
  error estimate for blocks of size 2^( 3) =       0.000266546798
  error estimate for blocks of size 2^( 4) =       0.000271972767
  error estimate for blocks of size 2^( 5) =       0.000275338228
  error estimate for blocks of size 2^( 6) =       0.000277197282
  error estimate for blocks of size 2^( 7) =       0.000278207080
  error estimate for blocks of size 2^( 8) =       0.000278294156
  error estimate for blocks of size 2^( 9) =       0.000277965333

      target function =                  N/A
              le_mean =     -22.669787283378
             les_mean =     514.429931198236
             stat err =       0.000277915963
             autocorr =       1.239700511820
              std dev =       0.705992513164
             le_variance =       0.498425428644

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.498440149533
                                         uncertainty =       0.001915166586

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.498440149533
                                         uncertainty =       0.001915166586

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000249609922
  error estimate for blocks of size 2^( 2) =       0.000258552832
  error estimate for blocks of size 2^( 3) =       0.000266549362
  error estimate for blocks of size 2^( 4) =       0.000271974534
  error estimate for blocks of size 2^( 5) =       0.000275340013
  error estimate for blocks of size 2^( 6) =       0.000277198837
  error estimate for blocks of size 2^( 7) =       0.000278208176
  error estimate for blocks of size 2^( 8) =       0.000278294922
  error estimate for blocks of size 2^( 9) =       0.000277970630

      target function =                  N/A
              le_mean =     -22.669787759676
             les_mean =     514.446352780986
             stat err =       0.000277918141
             autocorr =       1.239681454667
              std dev =       0.706003473960
             le_variance =       0.498440905243

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.498431790572
                                         uncertainty =       0.001914021255

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.498431790572
                                         uncertainty =       0.001914021255

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000249607830
  error estimate for blocks of size 2^( 2) =       0.000258551156
  error estimate for blocks of size 2^( 3) =       0.000266547654
  error estimate for blocks of size 2^( 4) =       0.000271973138
  error estimate for blocks of size 2^( 5) =       0.000275338565
  error estimate for blocks of size 2^( 6) =       0.000277197568
  error estimate for blocks of size 2^( 7) =       0.000278206685
  error estimate for blocks of size 2^( 8) =       0.000278293401
  error estimate for blocks of size 2^( 9) =       0.000277966723

      target function =                  N/A
              le_mean =     -22.669787396675
             les_mean =     514.430779851621
             stat err =       0.000277916094
             autocorr =       1.239683974794
              std dev =       0.705997556119
             le_variance =       0.498432549246

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.498425389116
                                         uncertainty =       0.001912817229

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.498425389116
                                         uncertainty =       0.001912817229

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000249606228
  error estimate for blocks of size 2^( 2) =       0.000258550179
  error estimate for blocks of size 2^( 3) =       0.000266546855
  error estimate for blocks of size 2^( 4) =       0.000271972753
  error estimate for blocks of size 2^( 5) =       0.000275338199
  error estimate for blocks of size 2^( 6) =       0.000277197245
  error estimate for blocks of size 2^( 7) =       0.000278207010
  error estimate for blocks of size 2^( 8) =       0.000278294009
  error estimate for blocks of size 2^( 9) =       0.000277965362

      target function =                  N/A
              le_mean =     -22.669787269784
             les_mean =     514.429872708926
             stat err =       0.000277915906
             autocorr =       1.239698209089
              std dev =       0.705993025157
             le_variance =       0.498426151570


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.669787283378        initial
     8.8818e-01     8.8818e+00             2.0972e-04       -22.669787759676  <--
     3.5527e+00     3.5527e+01             6.3620e-05       -22.669787396675
     1.4211e+01     1.4211e+02             1.6808e-05       -22.669787269784

*****************************************************************************
Applying the update for shift_i =   8.8818e-01     and shift_s =   8.8818e+00
*****************************************************************************

  Execution time = 1.7282e+02
  </log>
  <optVariables href="FORM.s051.opt.xml">
ci_001                -7.066787e-01 3 1  ON 0
ci_002                -7.046003e-01 3 1  ON 1
ci_003                -3.749550e-02 3 1  ON 2
ci_004                -3.737026e-02 3 1  ON 3
ci_005                 1.573179e-02 3 1  ON 4
ci_006                 1.570491e-02 3 1  ON 5
ci_007                 1.243345e-02 3 1  ON 6
ci_008                 1.208732e-02 3 1  ON 7
ci_009                -1.161039e-02 3 1  ON 8
ci_010                -1.171868e-02 3 1  ON 9
ci_011                -7.601193e-03 3 1  ON 10
ci_012                -7.887691e-03 3 1  ON 11
ci_013                 9.718493e-03 3 1  ON 12
ci_014                 9.644443e-03 3 1  ON 13
ci_015                 1.293355e-02 3 1  ON 14
ci_016                 1.275349e-02 3 1  ON 15
ci_017                 1.034083e-02 3 1  ON 16
ci_018                 1.037588e-02 3 1  ON 17
ci_019                -3.399600e-03 3 1  ON 18
ci_020                -3.339303e-03 3 1  ON 19
ci_021                -8.953422e-03 3 1  ON 20
ci_022                -9.529001e-03 3 1  ON 21
ci_023                 7.977802e-03 3 1  ON 22
ci_024                 8.198409e-03 3 1  ON 23
ci_025                 3.978851e-03 3 1  ON 24
ci_026                 4.000722e-03 3 1  ON 25
ci_027                 6.312931e-03 3 1  ON 26
ci_028                 6.658444e-03 3 1  ON 27
ci_029                -4.666285e-03 3 1  ON 28
ci_030                -4.882358e-03 3 1  ON 29
ci_031                -8.032964e-03 3 1  ON 30
ci_032                -7.467051e-03 3 1  ON 31
ci_033                 4.551280e-03 3 1  ON 32
ci_034                 5.033290e-03 3 1  ON 33
ci_035                 1.008114e-03 3 1  ON 34
ci_036                 1.235657e-03 3 1  ON 35
ci_037                 5.319481e-03 3 1  ON 36
ci_038                 5.166010e-03 3 1  ON 37
ci_039                 5.269226e-03 3 1  ON 38
ci_040                 5.267340e-03 3 1  ON 39
ci_041                 4.889957e-03 3 1  ON 40
ci_042                 4.797921e-03 3 1  ON 41
ci_043                 5.062545e-03 3 1  ON 42
ci_044                 4.473824e-03 3 1  ON 43
ci_045                 3.338203e-03 3 1  ON 44
ci_046                 3.248085e-03 3 1  ON 45
ci_047                -7.114950e-04 3 1  ON 46
ci_048                -8.168669e-04 3 1  ON 47
ci_049                 1.629948e-03 3 1  ON 48
ci_050                 1.533708e-03 3 1  ON 49
ci_051                -1.201120e-03 3 1  ON 50
ci_052                -1.324705e-03 3 1  ON 51
ci_053                -2.764680e-03 3 1  ON 52
ci_054                -2.785263e-03 3 1  ON 53
ci_055                -1.469673e-03 3 1  ON 54
ci_056                -1.987321e-03 3 1  ON 55
ci_057                -1.567788e-03 3 1  ON 56
ci_058                -1.764973e-03 3 1  ON 57
ci_059                 4.142599e-04 3 1  ON 58
ci_060                 2.650652e-04 3 1  ON 59
ci_061                -8.050165e-04 3 1  ON 60
ci_062                 2.100909e-04 3 1  ON 61
ci_063                -4.184837e-04 3 1  ON 62
ci_064                -9.344021e-04 3 1  ON 63
ci_065                -2.294311e-03 3 1  ON 64
ci_066                -2.434368e-03 3 1  ON 65
ci_067                -2.158196e-03 3 1  ON 66
ci_068                -2.126606e-03 3 1  ON 67
ci_069                 1.650840e-04 3 1  ON 68
ci_070                -1.623241e-04 3 1  ON 69
ci_071                -2.159174e-03 3 1  ON 70
ci_072                -2.105836e-03 3 1  ON 71
ci_073                 2.429953e-04 3 1  ON 72
ci_074                 2.468430e-04 3 1  ON 73
ci_075                -2.494121e-04 3 1  ON 74
ci_076                -4.443229e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 2.9256e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s052 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s052 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=52  my_counter=0
  time step      = 5.0000e-02
  blocks         = 250
  steps          = 250
  substeps       = 10
  current        = 0
  target samples = 8.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">250</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">6.2500e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">8.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">6.2500e+04</parameter>
<parameter name="steps" condition="int">250</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2668e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="250">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =8000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 52
    time step          = 0.05
    reference energy   = -22.7019
    reference variance = 1.36698
====================================================
  Execution time = 1.0059e+02
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s052
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 62500 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 6.1078e+04
  VMC Eavg = -2.2669e+01
  VMC Evar = 5.1373e-01
  Total weights = 7.820249627e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.8825e+01
  </log>
</opt>
<opt stage="main" walkers="62500">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.498372059932
                                         uncertainty =       0.001522410900

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.498372059932
                                         uncertainty =       0.001522410900

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000249592798
  error estimate for blocks of size 2^( 2) =       0.000258421708
  error estimate for blocks of size 2^( 3) =       0.000266393944
  error estimate for blocks of size 2^( 4) =       0.000271859705
  error estimate for blocks of size 2^( 5) =       0.000274998958
  error estimate for blocks of size 2^( 6) =       0.000276155109
  error estimate for blocks of size 2^( 7) =       0.000277246358
  error estimate for blocks of size 2^( 8) =       0.000277562550
  error estimate for blocks of size 2^( 9) =       0.000277949311

      target function =                  N/A
              le_mean =     -22.669157419151
             les_mean =     514.404423543882
             stat err =       0.000277228332
             autocorr =       1.233704435648
              std dev =       0.705955038631
             le_variance =       0.498372516568


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266915741915e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.2204e-01, overlap shift 2.2204e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.669157419173       residual = 2.83e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.669163350201       residual = 3.43e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.669163045499       residual = 1.45e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.669163056558       residual = 3.20e-08           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.669163011455       residual = 6.61e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          4 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 2.2204e-01 is 3.191938e-03

solving harmonic davidson linear method for identity shift 8.8818e-01, overlap shift 8.8818e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.669157419173       residual = 2.83e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.669159614896       residual = 1.56e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.669159505627       residual = 2.81e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.669159487554       residual = 8.68e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 8.8818e-01 is 1.011327e-03

solving harmonic davidson linear method for identity shift 3.5527e+00, overlap shift 3.5527e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.669157419173       residual = 2.83e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.669158043106       residual = 1.30e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.669158017083       residual = 2.70e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.669158006351       residual = 8.02e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 3.5527e+00 is 2.852335e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.368821 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.1943e+02
  </log>
  <optVariables href="FORM.s052.opt.xml">
ci_001                -7.068024e-01 3 1  ON 0
ci_002                -7.045227e-01 3 1  ON 1
ci_003                -3.748306e-02 3 1  ON 2
ci_004                -3.645215e-02 3 1  ON 3
ci_005                 1.567452e-02 3 1  ON 4
ci_006                 1.601096e-02 3 1  ON 5
ci_007                 1.237321e-02 3 1  ON 6
ci_008                 1.268546e-02 3 1  ON 7
ci_009                -1.176797e-02 3 1  ON 8
ci_010                -1.188812e-02 3 1  ON 9
ci_011                -7.670276e-03 3 1  ON 10
ci_012                -7.490609e-03 3 1  ON 11
ci_013                 9.755894e-03 3 1  ON 12
ci_014                 9.038024e-03 3 1  ON 13
ci_015                 1.279323e-02 3 1  ON 14
ci_016                 1.304284e-02 3 1  ON 15
ci_017                 1.023923e-02 3 1  ON 16
ci_018                 1.040156e-02 3 1  ON 17
ci_019                -3.440312e-03 3 1  ON 18
ci_020                -3.647160e-03 3 1  ON 19
ci_021                -8.918960e-03 3 1  ON 20
ci_022                -9.646325e-03 3 1  ON 21
ci_023                 7.162884e-03 3 1  ON 22
ci_024                 8.164409e-03 3 1  ON 23
ci_025                 4.028267e-03 3 1  ON 24
ci_026                 4.003561e-03 3 1  ON 25
ci_027                 6.352916e-03 3 1  ON 26
ci_028                 6.961947e-03 3 1  ON 27
ci_029                -4.859089e-03 3 1  ON 28
ci_030                -4.765163e-03 3 1  ON 29
ci_031                -7.862798e-03 3 1  ON 30
ci_032                -7.567377e-03 3 1  ON 31
ci_033                 3.756227e-03 3 1  ON 32
ci_034                 4.941692e-03 3 1  ON 33
ci_035                 9.592741e-04 3 1  ON 34
ci_036                 2.028976e-03 3 1  ON 35
ci_037                 5.302855e-03 3 1  ON 36
ci_038                 5.598685e-03 3 1  ON 37
ci_039                 5.352455e-03 3 1  ON 38
ci_040                 5.360696e-03 3 1  ON 39
ci_041                 4.880596e-03 3 1  ON 40
ci_042                 4.800716e-03 3 1  ON 41
ci_043                 5.010721e-03 3 1  ON 42
ci_044                 4.757491e-03 3 1  ON 43
ci_045                 3.616086e-03 3 1  ON 44
ci_046                 3.159700e-03 3 1  ON 45
ci_047                -6.563777e-04 3 1  ON 46
ci_048                -1.868386e-04 3 1  ON 47
ci_049                 1.981165e-03 3 1  ON 48
ci_050                 1.566218e-03 3 1  ON 49
ci_051                -1.227967e-03 3 1  ON 50
ci_052                -1.322669e-03 3 1  ON 51
ci_053                -2.650152e-03 3 1  ON 52
ci_054                -2.338352e-03 3 1  ON 53
ci_055                -1.560550e-03 3 1  ON 54
ci_056                -1.991207e-03 3 1  ON 55
ci_057                -1.590566e-03 3 1  ON 56
ci_058                -1.506706e-03 3 1  ON 57
ci_059                 4.324650e-04 3 1  ON 58
ci_060                 5.374129e-04 3 1  ON 59
ci_061                -6.068667e-04 3 1  ON 60
ci_062                 1.438521e-04 3 1  ON 61
ci_063                -3.922762e-04 3 1  ON 62
ci_064                -4.424123e-04 3 1  ON 63
ci_065                -2.077398e-03 3 1  ON 64
ci_066                -2.198179e-03 3 1  ON 65
ci_067                -2.085378e-03 3 1  ON 66
ci_068                -2.183236e-03 3 1  ON 67
ci_069                 2.005071e-04 3 1  ON 68
ci_070                -1.173651e-03 3 1  ON 69
ci_071                -2.062729e-03 3 1  ON 70
ci_072                -1.574601e-03 3 1  ON 71
ci_073                 3.224063e-04 3 1  ON 72
ci_074                 7.020193e-04 3 1  ON 73
ci_075                -2.220268e-04 3 1  ON 74
ci_076                -1.286635e-03 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="250">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =8000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 52
    time step          = 0.05
    reference energy   = -22.6106
    reference variance = 0.376696
====================================================
  Execution time = 1.0042e+02
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s052
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 62500 
  VMC Eavg = -2.2670e+01
  VMC Evar = 5.1412e-01
  Total weights = 7.8204e+06
  Execution time = 1.4455e+01
  </log>
</opt>
<opt stage="main" walkers="62500">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

ERROR CostFunction-> Number of Effective Walkers is too small! 
  Number of effective walkers (samples) / total number of samples = 0.000380427
  User specified threshold minwalkers = 0.3
  If this message appears frequently. You might have to be cautious. 
  Find info about parameter "minwalkers" in the user manual!
Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.500730895034
                                         uncertainty =       0.001518736358

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.500730895034
                                         uncertainty =       0.001518736358

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000250183151
  error estimate for blocks of size 2^( 2) =       0.000259070854
  error estimate for blocks of size 2^( 3) =       0.000267048143
  error estimate for blocks of size 2^( 4) =       0.000272587326
  error estimate for blocks of size 2^( 5) =       0.000275979235
  error estimate for blocks of size 2^( 6) =       0.000277671081
  error estimate for blocks of size 2^( 7) =       0.000278594384
  error estimate for blocks of size 2^( 8) =       0.000278402136
  error estimate for blocks of size 2^( 9) =       0.000277486053

      target function =                  N/A
              le_mean =     -22.669870097179
             les_mean =     514.451068671955
             stat err =       0.000278038413
             autocorr =       1.235075440323
              std dev =       0.707624811618
             le_variance =       0.500732874017

ERROR CostFunction-> Number of Effective Walkers is too small! 
  Number of effective walkers (samples) / total number of samples = 8.10994e-05
  User specified threshold minwalkers = 0.3
  If this message appears frequently. You might have to be cautious. 
  Find info about parameter "minwalkers" in the user manual!
Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.509827823926
                                         uncertainty =       0.006109528970

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.509827823926
                                         uncertainty =       0.006109528970

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000252445116
  error estimate for blocks of size 2^( 2) =       0.000261253203
  error estimate for blocks of size 2^( 3) =       0.000269150391
  error estimate for blocks of size 2^( 4) =       0.000274657613
  error estimate for blocks of size 2^( 5) =       0.000278023031
  error estimate for blocks of size 2^( 6) =       0.000279709883
  error estimate for blocks of size 2^( 7) =       0.000280662576
  error estimate for blocks of size 2^( 8) =       0.000280559140
  error estimate for blocks of size 2^( 9) =       0.000279699210

      target function =                  N/A
              le_mean =     -22.669947564923
             les_mean =     518.298977396175
             stat err =       0.000280157702
             autocorr =       1.231604272708
              std dev =       0.714022614248
             le_variance =       0.509828293657

ERROR CostFunction-> Number of Effective Walkers is too small! 
  Number of effective walkers (samples) / total number of samples = 0.000382027
  User specified threshold minwalkers = 0.3
  If this message appears frequently. You might have to be cautious. 
  Find info about parameter "minwalkers" in the user manual!
Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.501147772953
                                         uncertainty =       0.001544174459

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.501147772953
                                         uncertainty =       0.001544174459

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000250287182
  error estimate for blocks of size 2^( 2) =       0.000259168802
  error estimate for blocks of size 2^( 3) =       0.000267143190
  error estimate for blocks of size 2^( 4) =       0.000272672325
  error estimate for blocks of size 2^( 5) =       0.000276058176
  error estimate for blocks of size 2^( 6) =       0.000277758153
  error estimate for blocks of size 2^( 7) =       0.000278688422
  error estimate for blocks of size 2^( 8) =       0.000278503622
  error estimate for blocks of size 2^( 9) =       0.000277609439

      target function =                  N/A
              le_mean =     -22.669872811509
             les_mean =     514.462158928389
             stat err =       0.000278139909
             autocorr =       1.234950072043
              std dev =       0.707919053802
             le_variance =       0.501149386736

ERROR CostFunction-> Number of Effective Walkers is too small! 
  Number of effective walkers (samples) / total number of samples = 0.00114063
  User specified threshold minwalkers = 0.3
  If this message appears frequently. You might have to be cautious. 
  Find info about parameter "minwalkers" in the user manual!
Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.522739554303
                                         uncertainty =       0.022018241319

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.522739554303
                                         uncertainty =       0.022018241319

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000255622421
  error estimate for blocks of size 2^( 2) =       0.000264300294
  error estimate for blocks of size 2^( 3) =       0.000272137052
  error estimate for blocks of size 2^( 4) =       0.000277586994
  error estimate for blocks of size 2^( 5) =       0.000280854575
  error estimate for blocks of size 2^( 6) =       0.000282527991
  error estimate for blocks of size 2^( 7) =       0.000283492734
  error estimate for blocks of size 2^( 8) =       0.000283273993
  error estimate for blocks of size 2^( 9) =       0.000282611514

      target function =                  N/A
              le_mean =     -22.669911968162
             les_mean =     624.279652985055
             stat err =       0.000282976558
             autocorr =       1.225470978931
              std dev =       0.723009390024
             le_variance =       0.522742578062


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.669870097179        initial
     2.2204e-01     2.2204e+00             3.1919e-03       -22.669947564923  <--
     8.8818e-01     8.8818e+00             1.0113e-03       -22.669872811509
     3.5527e+00     3.5527e+01             2.8523e-04       -22.669911968162

*****************************************************************************
Applying the update for shift_i =   2.2204e-01     and shift_s =   2.2204e+00
*****************************************************************************

  Execution time = 1.7291e+02
  </log>
  <optVariables href="FORM.s052.opt.xml">
ci_001                -7.071479e-01 3 1  ON 0
ci_002                -7.042959e-01 3 1  ON 1
ci_003                -3.743844e-02 3 1  ON 2
ci_004                -3.417832e-02 3 1  ON 3
ci_005                 1.558702e-02 3 1  ON 4
ci_006                 1.646188e-02 3 1  ON 5
ci_007                 1.226156e-02 3 1  ON 6
ci_008                 1.373821e-02 3 1  ON 7
ci_009                -1.204365e-02 3 1  ON 8
ci_010                -1.210508e-02 3 1  ON 9
ci_011                -7.798182e-03 3 1  ON 10
ci_012                -6.839988e-03 3 1  ON 11
ci_013                 9.828485e-03 3 1  ON 12
ci_014                 7.999026e-03 3 1  ON 13
ci_015                 1.250777e-02 3 1  ON 14
ci_016                 1.367694e-02 3 1  ON 15
ci_017                 9.992169e-03 3 1  ON 16
ci_018                 1.048083e-02 3 1  ON 17
ci_019                -3.534020e-03 3 1  ON 18
ci_020                -4.257948e-03 3 1  ON 19
ci_021                -8.862389e-03 3 1  ON 20
ci_022                -9.840200e-03 3 1  ON 21
ci_023                 5.778105e-03 3 1  ON 22
ci_024                 8.101642e-03 3 1  ON 23
ci_025                 4.130481e-03 3 1  ON 24
ci_026                 4.064937e-03 3 1  ON 25
ci_027                 6.432009e-03 3 1  ON 26
ci_028                 7.392843e-03 3 1  ON 27
ci_029                -5.234671e-03 3 1  ON 28
ci_030                -4.549332e-03 3 1  ON 29
ci_031                -7.536551e-03 3 1  ON 30
ci_032                -7.769909e-03 3 1  ON 31
ci_033                 2.218272e-03 3 1  ON 32
ci_034                 4.787143e-03 3 1  ON 33
ci_035                 8.942080e-04 3 1  ON 34
ci_036                 3.124838e-03 3 1  ON 35
ci_037                 5.274538e-03 3 1  ON 36
ci_038                 6.317453e-03 3 1  ON 37
ci_039                 5.471704e-03 3 1  ON 38
ci_040                 5.479180e-03 3 1  ON 39
ci_041                 4.867858e-03 3 1  ON 40
ci_042                 4.794035e-03 3 1  ON 41
ci_043                 4.920157e-03 3 1  ON 42
ci_044                 5.283616e-03 3 1  ON 43
ci_045                 4.225833e-03 3 1  ON 44
ci_046                 2.999345e-03 3 1  ON 45
ci_047                -5.902360e-04 3 1  ON 46
ci_048                 6.847560e-04 3 1  ON 47
ci_049                 2.622755e-03 3 1  ON 48
ci_050                 1.629845e-03 3 1  ON 49
ci_051                -1.275135e-03 3 1  ON 50
ci_052                -1.434632e-03 3 1  ON 51
ci_053                -2.440445e-03 3 1  ON 52
ci_054                -1.505038e-03 3 1  ON 53
ci_055                -1.730876e-03 3 1  ON 54
ci_056                -2.000032e-03 3 1  ON 55
ci_057                -1.630983e-03 3 1  ON 56
ci_058                -1.041563e-03 3 1  ON 57
ci_059                 4.514452e-04 3 1  ON 58
ci_060                 9.453873e-04 3 1  ON 59
ci_061                -2.578433e-04 3 1  ON 60
ci_062                 3.963846e-05 3 1  ON 61
ci_063                -3.443356e-04 3 1  ON 62
ci_064                 4.265643e-04 3 1  ON 63
ci_065                -1.704535e-03 3 1  ON 64
ci_066                -1.731433e-03 3 1  ON 65
ci_067                -1.940726e-03 3 1  ON 66
ci_068                -2.300478e-03 3 1  ON 67
ci_069                 2.518065e-04 3 1  ON 68
ci_070                -2.963110e-03 3 1  ON 69
ci_071                -1.894987e-03 3 1  ON 70
ci_072                -6.483316e-04 3 1  ON 71
ci_073                 4.322073e-04 3 1  ON 72
ci_074                 1.322285e-03 3 1  ON 73
ci_075                -1.784121e-04 3 1  ON 74
ci_076                -2.741610e-03 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 2.9235e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s053 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s053 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=53  my_counter=0
  time step      = 5.0000e-02
  blocks         = 250
  steps          = 250
  substeps       = 10
  current        = 0
  target samples = 8.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">250</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">6.2500e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">8.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">6.2500e+04</parameter>
<parameter name="steps" condition="int">250</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2668e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="250">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =8000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 53
    time step          = 0.05
    reference energy   = -22.7124
    reference variance = 0.410626
====================================================
  Execution time = 1.0075e+02
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s053
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 62500 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 6.1097e+04
  VMC Eavg = -2.2670e+01
  VMC Evar = 5.1815e-01
  Total weights = 7.820918915e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.8809e+01
  </log>
</opt>
<opt stage="main" walkers="62500">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.500760611152
                                         uncertainty =       0.002568442901

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.500760611152
                                         uncertainty =       0.002568442901

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000250191010
  error estimate for blocks of size 2^( 2) =       0.000259107673
  error estimate for blocks of size 2^( 3) =       0.000267001003
  error estimate for blocks of size 2^( 4) =       0.000272555567
  error estimate for blocks of size 2^( 5) =       0.000275596113
  error estimate for blocks of size 2^( 6) =       0.000277786366
  error estimate for blocks of size 2^( 7) =       0.000278979277
  error estimate for blocks of size 2^( 8) =       0.000280309952
  error estimate for blocks of size 2^( 9) =       0.000282132767

      target function =                  N/A
              le_mean =     -22.669529983846
             les_mean =     514.425737010180
             stat err =       0.000279802090
             autocorr =       1.250715430892
              std dev =       0.707647039634
             le_variance =       0.500764332703


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266952998385e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.5511e-02, overlap shift 5.5511e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.669529983871       residual = 2.20e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.669603891559       residual = 1.08e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.669602109333       residual = 9.14e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.669601721068       residual = 6.19e-08           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.669601883602       residual = 9.59e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          4 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 5.5511e-02 is 2.368612e-03

solving harmonic davidson linear method for identity shift 2.2204e-01, overlap shift 2.2204e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.669529983871       residual = 2.20e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.669573682087       residual = 4.92e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.669572294749       residual = 2.44e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.669572280695       residual = 1.20e-08           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.669572354087       residual = 2.91e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          4 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 2.2204e-01 is 1.375027e-03

solving harmonic davidson linear method for identity shift 8.8818e-01, overlap shift 8.8818e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.669529983871       residual = 2.20e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.669546567605       residual = 2.54e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.669546136225       residual = 8.39e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.669546191715       residual = 3.69e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 8.8818e-01 is 5.120417e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.370517 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.1958e+02
  </log>
  <optVariables href="FORM.s053.opt.xml">
ci_001                -7.072198e-01 3 1  ON 0
ci_002                -7.042599e-01 3 1  ON 1
ci_003                -3.725342e-02 3 1  ON 2
ci_004                -3.451784e-02 3 1  ON 3
ci_005                 1.552016e-02 3 1  ON 4
ci_006                 1.598155e-02 3 1  ON 5
ci_007                 1.217537e-02 3 1  ON 6
ci_008                 1.292833e-02 3 1  ON 7
ci_009                -1.195962e-02 3 1  ON 8
ci_010                -1.202348e-02 3 1  ON 9
ci_011                -8.363922e-03 3 1  ON 10
ci_012                -7.593922e-03 3 1  ON 11
ci_013                 9.318467e-03 3 1  ON 12
ci_014                 8.950922e-03 3 1  ON 13
ci_015                 1.245944e-02 3 1  ON 14
ci_016                 1.305361e-02 3 1  ON 15
ci_017                 1.041550e-02 3 1  ON 16
ci_018                 1.028334e-02 3 1  ON 17
ci_019                -3.552352e-03 3 1  ON 18
ci_020                -4.013853e-03 3 1  ON 19
ci_021                -8.737305e-03 3 1  ON 20
ci_022                -9.306290e-03 3 1  ON 21
ci_023                 6.811750e-03 3 1  ON 22
ci_024                 8.178040e-03 3 1  ON 23
ci_025                 4.175667e-03 3 1  ON 24
ci_026                 4.136215e-03 3 1  ON 25
ci_027                 6.934923e-03 3 1  ON 26
ci_028                 7.465528e-03 3 1  ON 27
ci_029                -5.630621e-03 3 1  ON 28
ci_030                -4.891867e-03 3 1  ON 29
ci_031                -7.619242e-03 3 1  ON 30
ci_032                -7.965317e-03 3 1  ON 31
ci_033                 3.008681e-03 3 1  ON 32
ci_034                 4.625932e-03 3 1  ON 33
ci_035                 9.867693e-04 3 1  ON 34
ci_036                 2.158195e-03 3 1  ON 35
ci_037                 4.767919e-03 3 1  ON 36
ci_038                 5.964686e-03 3 1  ON 37
ci_039                 5.413065e-03 3 1  ON 38
ci_040                 5.284186e-03 3 1  ON 39
ci_041                 4.620080e-03 3 1  ON 40
ci_042                 4.554074e-03 3 1  ON 41
ci_043                 4.997932e-03 3 1  ON 42
ci_044                 4.992268e-03 3 1  ON 43
ci_045                 3.320342e-03 3 1  ON 44
ci_046                 3.389149e-03 3 1  ON 45
ci_047                -7.100188e-04 3 1  ON 46
ci_048                 2.449496e-04 3 1  ON 47
ci_049                 2.306296e-03 3 1  ON 48
ci_050                 1.566507e-03 3 1  ON 49
ci_051                -1.356869e-03 3 1  ON 50
ci_052                -1.362113e-03 3 1  ON 51
ci_053                -2.781823e-03 3 1  ON 52
ci_054                -2.006467e-03 3 1  ON 53
ci_055                -1.784561e-03 3 1  ON 54
ci_056                -2.000120e-03 3 1  ON 55
ci_057                -1.707757e-03 3 1  ON 56
ci_058                -1.091291e-03 3 1  ON 57
ci_059                 3.180053e-04 3 1  ON 58
ci_060                 6.551996e-04 3 1  ON 59
ci_061                 2.020526e-04 3 1  ON 60
ci_062                 3.096255e-05 3 1  ON 61
ci_063                -3.858847e-04 3 1  ON 62
ci_064                 2.155512e-04 3 1  ON 63
ci_065                -1.920637e-03 3 1  ON 64
ci_066                -1.952624e-03 3 1  ON 65
ci_067                -1.968881e-03 3 1  ON 66
ci_068                -2.354039e-03 3 1  ON 67
ci_069                -7.928349e-05 3 1  ON 68
ci_070                -1.588083e-03 3 1  ON 69
ci_071                -1.742588e-03 3 1  ON 70
ci_072                -1.099643e-03 3 1  ON 71
ci_073                 2.715637e-04 3 1  ON 72
ci_074                 8.625820e-04 3 1  ON 73
ci_075                -2.089665e-04 3 1  ON 74
ci_076                -1.492262e-03 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="250">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =8000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 53
    time step          = 0.05
    reference energy   = -22.6792
    reference variance = 0.397104
====================================================
  Execution time = 1.0051e+02
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s053
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 62500 
  VMC Eavg = -2.2670e+01
  VMC Evar = 5.1548e-01
  Total weights = 7.8205e+06
  Execution time = 1.4428e+01
  </log>
</opt>
<opt stage="main" walkers="62500">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.499629891985
                                         uncertainty =       0.002087373343

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.499629891985
                                         uncertainty =       0.002087373343

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000249908491
  error estimate for blocks of size 2^( 2) =       0.000258695956
  error estimate for blocks of size 2^( 3) =       0.000266649197
  error estimate for blocks of size 2^( 4) =       0.000272056401
  error estimate for blocks of size 2^( 5) =       0.000275428991
  error estimate for blocks of size 2^( 6) =       0.000277532999
  error estimate for blocks of size 2^( 7) =       0.000278058428
  error estimate for blocks of size 2^( 8) =       0.000278343108
  error estimate for blocks of size 2^( 9) =       0.000279876403

      target function =                  N/A
              le_mean =     -22.670240815622
             les_mean =     514.478556661637
             stat err =       0.000278452735
             autocorr =       1.241483491404
              std dev =       0.706847956035
             le_variance =       0.499634032951

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.499427084326
                                         uncertainty =       0.002031466976

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.499427084326
                                         uncertainty =       0.002031466976

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000249857798
  error estimate for blocks of size 2^( 2) =       0.000258652467
  error estimate for blocks of size 2^( 3) =       0.000266607941
  error estimate for blocks of size 2^( 4) =       0.000272016430
  error estimate for blocks of size 2^( 5) =       0.000275387825
  error estimate for blocks of size 2^( 6) =       0.000277496377
  error estimate for blocks of size 2^( 7) =       0.000278020522
  error estimate for blocks of size 2^( 8) =       0.000278322712
  error estimate for blocks of size 2^( 9) =       0.000279893301

      target function =                  N/A
              le_mean =     -22.670229520302
             les_mean =     514.663056577563
             stat err =       0.000278433228
             autocorr =       1.241813303423
              std dev =       0.706704573814
             le_variance =       0.499431354650

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.499549554495
                                         uncertainty =       0.002024849183

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.499549554495
                                         uncertainty =       0.002024849183

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000249888405
  error estimate for blocks of size 2^( 2) =       0.000258683223
  error estimate for blocks of size 2^( 3) =       0.000266646118
  error estimate for blocks of size 2^( 4) =       0.000272050927
  error estimate for blocks of size 2^( 5) =       0.000275422169
  error estimate for blocks of size 2^( 6) =       0.000277527882
  error estimate for blocks of size 2^( 7) =       0.000278051625
  error estimate for blocks of size 2^( 8) =       0.000278361062
  error estimate for blocks of size 2^( 9) =       0.000279931774

      target function =                  N/A
              le_mean =     -22.670243661485
             les_mean =     514.481012258737
             stat err =       0.000278468086
             autocorr =       1.241819998205
              std dev =       0.706791141997
             le_variance =       0.499553718406

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.499678631885
                                         uncertainty =       0.002106868407

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.499678631885
                                         uncertainty =       0.002106868407

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000249920690
  error estimate for blocks of size 2^( 2) =       0.000258715324
  error estimate for blocks of size 2^( 3) =       0.000266668435
  error estimate for blocks of size 2^( 4) =       0.000272076024
  error estimate for blocks of size 2^( 5) =       0.000275444436
  error estimate for blocks of size 2^( 6) =       0.000277549098
  error estimate for blocks of size 2^( 7) =       0.000278078962
  error estimate for blocks of size 2^( 8) =       0.000278366687
  error estimate for blocks of size 2^( 9) =       0.000279897144

      target function =                  N/A
              le_mean =     -22.670233591205
             les_mean =     514.476344858908
             stat err =       0.000278472973
             autocorr =       1.241542755578
              std dev =       0.706882457885
             le_variance =       0.499682809266


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.670240815622        initial
     5.5511e-02     5.5511e-01             2.3686e-03       -22.670229520302
     2.2204e-01     2.2204e+00             1.3750e-03       -22.670243661485  <--
     8.8818e-01     8.8818e+00             5.1204e-04       -22.670233591205

*****************************************************************************
Applying the update for shift_i =   2.2204e-01     and shift_s =   2.2204e+00
*****************************************************************************

  Execution time = 1.7294e+02
  </log>
  <optVariables href="FORM.s053.opt.xml">
ci_001                -7.072198e-01 3 1  ON 0
ci_002                -7.042599e-01 3 1  ON 1
ci_003                -3.725342e-02 3 1  ON 2
ci_004                -3.451784e-02 3 1  ON 3
ci_005                 1.552016e-02 3 1  ON 4
ci_006                 1.598155e-02 3 1  ON 5
ci_007                 1.217537e-02 3 1  ON 6
ci_008                 1.292833e-02 3 1  ON 7
ci_009                -1.195962e-02 3 1  ON 8
ci_010                -1.202348e-02 3 1  ON 9
ci_011                -8.363922e-03 3 1  ON 10
ci_012                -7.593922e-03 3 1  ON 11
ci_013                 9.318467e-03 3 1  ON 12
ci_014                 8.950922e-03 3 1  ON 13
ci_015                 1.245944e-02 3 1  ON 14
ci_016                 1.305361e-02 3 1  ON 15
ci_017                 1.041550e-02 3 1  ON 16
ci_018                 1.028334e-02 3 1  ON 17
ci_019                -3.552352e-03 3 1  ON 18
ci_020                -4.013853e-03 3 1  ON 19
ci_021                -8.737305e-03 3 1  ON 20
ci_022                -9.306290e-03 3 1  ON 21
ci_023                 6.811750e-03 3 1  ON 22
ci_024                 8.178040e-03 3 1  ON 23
ci_025                 4.175667e-03 3 1  ON 24
ci_026                 4.136215e-03 3 1  ON 25
ci_027                 6.934923e-03 3 1  ON 26
ci_028                 7.465528e-03 3 1  ON 27
ci_029                -5.630621e-03 3 1  ON 28
ci_030                -4.891867e-03 3 1  ON 29
ci_031                -7.619242e-03 3 1  ON 30
ci_032                -7.965317e-03 3 1  ON 31
ci_033                 3.008681e-03 3 1  ON 32
ci_034                 4.625932e-03 3 1  ON 33
ci_035                 9.867693e-04 3 1  ON 34
ci_036                 2.158195e-03 3 1  ON 35
ci_037                 4.767919e-03 3 1  ON 36
ci_038                 5.964686e-03 3 1  ON 37
ci_039                 5.413065e-03 3 1  ON 38
ci_040                 5.284186e-03 3 1  ON 39
ci_041                 4.620080e-03 3 1  ON 40
ci_042                 4.554074e-03 3 1  ON 41
ci_043                 4.997932e-03 3 1  ON 42
ci_044                 4.992268e-03 3 1  ON 43
ci_045                 3.320342e-03 3 1  ON 44
ci_046                 3.389149e-03 3 1  ON 45
ci_047                -7.100188e-04 3 1  ON 46
ci_048                 2.449496e-04 3 1  ON 47
ci_049                 2.306296e-03 3 1  ON 48
ci_050                 1.566507e-03 3 1  ON 49
ci_051                -1.356869e-03 3 1  ON 50
ci_052                -1.362113e-03 3 1  ON 51
ci_053                -2.781823e-03 3 1  ON 52
ci_054                -2.006467e-03 3 1  ON 53
ci_055                -1.784561e-03 3 1  ON 54
ci_056                -2.000120e-03 3 1  ON 55
ci_057                -1.707757e-03 3 1  ON 56
ci_058                -1.091291e-03 3 1  ON 57
ci_059                 3.180053e-04 3 1  ON 58
ci_060                 6.551996e-04 3 1  ON 59
ci_061                 2.020526e-04 3 1  ON 60
ci_062                 3.096255e-05 3 1  ON 61
ci_063                -3.858847e-04 3 1  ON 62
ci_064                 2.155512e-04 3 1  ON 63
ci_065                -1.920637e-03 3 1  ON 64
ci_066                -1.952624e-03 3 1  ON 65
ci_067                -1.968881e-03 3 1  ON 66
ci_068                -2.354039e-03 3 1  ON 67
ci_069                -7.928349e-05 3 1  ON 68
ci_070                -1.588083e-03 3 1  ON 69
ci_071                -1.742588e-03 3 1  ON 70
ci_072                -1.099643e-03 3 1  ON 71
ci_073                 2.715637e-04 3 1  ON 72
ci_074                 8.625820e-04 3 1  ON 73
ci_075                -2.089665e-04 3 1  ON 74
ci_076                -1.492262e-03 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 2.9253e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s054 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s054 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=54  my_counter=0
  time step      = 5.0000e-02
  blocks         = 250
  steps          = 250
  substeps       = 10
  current        = 0
  target samples = 8.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">250</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">6.2500e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">8.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">6.2500e+04</parameter>
<parameter name="steps" condition="int">250</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2668e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="250">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =8000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 54
    time step          = 0.05
    reference energy   = -22.6045
    reference variance = 0.497691
====================================================
  Execution time = 1.0068e+02
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s054
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 62500 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 6.1112e+04
  VMC Eavg = -2.2669e+01
  VMC Evar = 5.0981e-01
  Total weights = 7.820265069e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.8811e+01
  </log>
</opt>
<opt stage="main" walkers="62500">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.498955478039
                                         uncertainty =       0.002186593651

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.498955478039
                                         uncertainty =       0.002186593651

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000249739372
  error estimate for blocks of size 2^( 2) =       0.000258732489
  error estimate for blocks of size 2^( 3) =       0.000266757847
  error estimate for blocks of size 2^( 4) =       0.000272663063
  error estimate for blocks of size 2^( 5) =       0.000276101603
  error estimate for blocks of size 2^( 6) =       0.000277404666
  error estimate for blocks of size 2^( 7) =       0.000278032020
  error estimate for blocks of size 2^( 8) =       0.000279166787
  error estimate for blocks of size 2^( 9) =       0.000279745637

      target function =                  N/A
              le_mean =     -22.669495124437
             les_mean =     514.415820332808
             stat err =       0.000278587277
             autocorr =       1.244367117302
              std dev =       0.706369614857
             le_variance =       0.498958032793


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266949512444e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.5511e-02, overlap shift 5.5511e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.669495124467       residual = 1.11e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.669527197648       residual = 5.66e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.669529053838       residual = 3.56e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.669528743266       residual = 4.13e-08           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.669528895799       residual = 1.14e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.669528935797       residual = 2.31e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          5 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 5.5511e-02 is 1.619388e-03

solving harmonic davidson linear method for identity shift 2.2204e-01, overlap shift 2.2204e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.669495124467       residual = 1.11e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.669514060205       residual = 2.25e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.669514597718       residual = 5.16e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.669514542214       residual = 1.38e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 2.2204e-01 is 8.934541e-04

solving harmonic davidson linear method for identity shift 8.8818e-01, overlap shift 8.8818e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.669495124467       residual = 1.11e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.669502301329       residual = 9.80e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.669502438690       residual = 1.61e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.669502444531       residual = 3.84e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 8.8818e-01 is 3.191081e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.375864 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.1951e+02
  </log>
  <optVariables href="FORM.s054.opt.xml">
ci_001                -7.072925e-01 3 1  ON 0
ci_002                -7.041983e-01 3 1  ON 1
ci_003                -3.739685e-02 3 1  ON 2
ci_004                -3.483192e-02 3 1  ON 3
ci_005                 1.568892e-02 3 1  ON 4
ci_006                 1.584892e-02 3 1  ON 5
ci_007                 1.205145e-02 3 1  ON 6
ci_008                 1.252102e-02 3 1  ON 7
ci_009                -1.205458e-02 3 1  ON 8
ci_010                -1.158667e-02 3 1  ON 9
ci_011                -7.925989e-03 3 1  ON 10
ci_012                -7.610800e-03 3 1  ON 11
ci_013                 9.549363e-03 3 1  ON 12
ci_014                 9.002201e-03 3 1  ON 13
ci_015                 1.266882e-02 3 1  ON 14
ci_016                 1.243572e-02 3 1  ON 15
ci_017                 1.043233e-02 3 1  ON 16
ci_018                 1.065277e-02 3 1  ON 17
ci_019                -3.390007e-03 3 1  ON 18
ci_020                -3.918925e-03 3 1  ON 19
ci_021                -8.695514e-03 3 1  ON 20
ci_022                -9.015977e-03 3 1  ON 21
ci_023                 7.201893e-03 3 1  ON 22
ci_024                 7.890281e-03 3 1  ON 23
ci_025                 4.349534e-03 3 1  ON 24
ci_026                 4.148206e-03 3 1  ON 25
ci_027                 6.950429e-03 3 1  ON 26
ci_028                 7.097469e-03 3 1  ON 27
ci_029                -5.000267e-03 3 1  ON 28
ci_030                -4.771347e-03 3 1  ON 29
ci_031                -7.652219e-03 3 1  ON 30
ci_032                -8.333270e-03 3 1  ON 31
ci_033                 3.902135e-03 3 1  ON 32
ci_034                 4.979584e-03 3 1  ON 33
ci_035                 1.215275e-03 3 1  ON 34
ci_036                 1.635414e-03 3 1  ON 35
ci_037                 4.762528e-03 3 1  ON 36
ci_038                 5.685952e-03 3 1  ON 37
ci_039                 5.375701e-03 3 1  ON 38
ci_040                 4.953776e-03 3 1  ON 39
ci_041                 4.659795e-03 3 1  ON 40
ci_042                 4.662506e-03 3 1  ON 41
ci_043                 4.903203e-03 3 1  ON 42
ci_044                 4.554591e-03 3 1  ON 43
ci_045                 3.410471e-03 3 1  ON 44
ci_046                 3.400160e-03 3 1  ON 45
ci_047                -7.318936e-04 3 1  ON 46
ci_048                -4.629337e-04 3 1  ON 47
ci_049                 2.106266e-03 3 1  ON 48
ci_050                 1.527259e-03 3 1  ON 49
ci_051                -1.438110e-03 3 1  ON 50
ci_052                -1.322427e-03 3 1  ON 51
ci_053                -2.580223e-03 3 1  ON 52
ci_054                -2.382604e-03 3 1  ON 53
ci_055                -1.450777e-03 3 1  ON 54
ci_056                -1.467485e-03 3 1  ON 55
ci_057                -1.298953e-03 3 1  ON 56
ci_058                -1.103763e-03 3 1  ON 57
ci_059                 4.650355e-04 3 1  ON 58
ci_060                 3.228649e-04 3 1  ON 59
ci_061                 2.846667e-04 3 1  ON 60
ci_062                -2.130645e-04 3 1  ON 61
ci_063                -2.780797e-04 3 1  ON 62
ci_064                -2.855299e-04 3 1  ON 63
ci_065                -1.654843e-03 3 1  ON 64
ci_066                -2.290773e-03 3 1  ON 65
ci_067                -2.277374e-03 3 1  ON 66
ci_068                -2.396688e-03 3 1  ON 67
ci_069                -2.252612e-04 3 1  ON 68
ci_070                -1.021634e-03 3 1  ON 69
ci_071                -1.979902e-03 3 1  ON 70
ci_072                -1.632945e-03 3 1  ON 71
ci_073                 2.918523e-04 3 1  ON 72
ci_074                 5.429924e-04 3 1  ON 73
ci_075                -2.271887e-04 3 1  ON 74
ci_076                -1.109360e-03 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="250">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =8000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 54
    time step          = 0.05
    reference energy   = -22.7496
    reference variance = 0.508693
====================================================
  Execution time = 1.0028e+02
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s054
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 62500 
  VMC Eavg = -2.2670e+01
  VMC Evar = 5.1446e-01
  Total weights = 7.8208e+06
  Execution time = 1.4433e+01
  </log>
</opt>
<opt stage="main" walkers="62500">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

ERROR CostFunction-> Number of Effective Walkers is too small! 
  Number of effective walkers (samples) / total number of samples = 0.000336514
  User specified threshold minwalkers = 0.3
  If this message appears frequently. You might have to be cautious. 
  Find info about parameter "minwalkers" in the user manual!
Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.501812304401
                                         uncertainty =       0.002672202929

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.501812304401
                                         uncertainty =       0.002672202929

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000250453395
  error estimate for blocks of size 2^( 2) =       0.000259357294
  error estimate for blocks of size 2^( 3) =       0.000267205561
  error estimate for blocks of size 2^( 4) =       0.000272859073
  error estimate for blocks of size 2^( 5) =       0.000276003070
  error estimate for blocks of size 2^( 6) =       0.000277977826
  error estimate for blocks of size 2^( 7) =       0.000279563294
  error estimate for blocks of size 2^( 8) =       0.000280075656
  error estimate for blocks of size 2^( 9) =       0.000280127235

      target function =                  N/A
              le_mean =     -22.669769529007
             les_mean =     514.510638217923
             stat err =       0.000279436003
             autocorr =       1.244832378785
              std dev =       0.708389174998
             le_variance =       0.501815223254

ERROR CostFunction-> Number of Effective Walkers is too small! 
  Number of effective walkers (samples) / total number of samples = 0.00105271
  User specified threshold minwalkers = 0.3
  If this message appears frequently. You might have to be cautious. 
  Find info about parameter "minwalkers" in the user manual!
Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.501988833896
                                         uncertainty =       0.002762854425

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.501988833896
                                         uncertainty =       0.002762854425

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000250497409
  error estimate for blocks of size 2^( 2) =       0.000259402410
  error estimate for blocks of size 2^( 3) =       0.000267250925
  error estimate for blocks of size 2^( 4) =       0.000272897047
  error estimate for blocks of size 2^( 5) =       0.000276033172
  error estimate for blocks of size 2^( 6) =       0.000278026247
  error estimate for blocks of size 2^( 7) =       0.000279606670
  error estimate for blocks of size 2^( 8) =       0.000280130624
  error estimate for blocks of size 2^( 9) =       0.000280289507

      target function =                  N/A
              le_mean =     -22.669754563657
             les_mean =     514.464121023158
             stat err =       0.000279513262
             autocorr =       1.245083166277
              std dev =       0.708513666196
             le_variance =       0.501991615186

ERROR CostFunction-> Number of Effective Walkers is too small! 
  Number of effective walkers (samples) / total number of samples = 0.000337884
  User specified threshold minwalkers = 0.3
  If this message appears frequently. You might have to be cautious. 
  Find info about parameter "minwalkers" in the user manual!
Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.501917486744
                                         uncertainty =       0.002767878396

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.501917486744
                                         uncertainty =       0.002767878396

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000250479694
  error estimate for blocks of size 2^( 2) =       0.000259386217
  error estimate for blocks of size 2^( 3) =       0.000267236043
  error estimate for blocks of size 2^( 4) =       0.000272883777
  error estimate for blocks of size 2^( 5) =       0.000276024046
  error estimate for blocks of size 2^( 6) =       0.000278005347
  error estimate for blocks of size 2^( 7) =       0.000279590705
  error estimate for blocks of size 2^( 8) =       0.000280106123
  error estimate for blocks of size 2^( 9) =       0.000280280596

      target function =                  N/A
              le_mean =     -22.669759105011
             les_mean =     514.446423026236
             stat err =       0.000279495693
             autocorr =       1.245102740641
              std dev =       0.708463562021
             le_variance =       0.501920618712

ERROR CostFunction-> Number of Effective Walkers is too small! 
  Number of effective walkers (samples) / total number of samples = 0.00160988
  User specified threshold minwalkers = 0.3
  If this message appears frequently. You might have to be cautious. 
  Find info about parameter "minwalkers" in the user manual!
Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.501772945024
                                         uncertainty =       0.002682632390

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.501772945024
                                         uncertainty =       0.002682632390

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000250443595
  error estimate for blocks of size 2^( 2) =       0.000259350076
  error estimate for blocks of size 2^( 3) =       0.000267197349
  error estimate for blocks of size 2^( 4) =       0.000272847928
  error estimate for blocks of size 2^( 5) =       0.000275981256
  error estimate for blocks of size 2^( 6) =       0.000277950783
  error estimate for blocks of size 2^( 7) =       0.000279526251
  error estimate for blocks of size 2^( 8) =       0.000280065805
  error estimate for blocks of size 2^( 9) =       0.000280194845

      target function =                  N/A
              le_mean =     -22.669752699233
             les_mean =     514.443892133403
             stat err =       0.000279434421
             autocorr =       1.244915705946
              std dev =       0.708361456179
             le_variance =       0.501775952600


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.669769529007        initial  <--
     5.5511e-02     5.5511e-01             1.6194e-03       -22.669754563657
     2.2204e-01     2.2204e+00             8.9345e-04       -22.669759105011
     8.8818e-01     8.8818e+00             3.1911e-04       -22.669752699233

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 172.6915
  </log>
  <optVariables href="FORM.s054.opt.xml">
ci_001                -7.072198e-01 3 1  ON 0
ci_002                -7.042599e-01 3 1  ON 1
ci_003                -3.725342e-02 3 1  ON 2
ci_004                -3.451784e-02 3 1  ON 3
ci_005                 1.552016e-02 3 1  ON 4
ci_006                 1.598155e-02 3 1  ON 5
ci_007                 1.217537e-02 3 1  ON 6
ci_008                 1.292833e-02 3 1  ON 7
ci_009                -1.195962e-02 3 1  ON 8
ci_010                -1.202348e-02 3 1  ON 9
ci_011                -8.363922e-03 3 1  ON 10
ci_012                -7.593922e-03 3 1  ON 11
ci_013                 9.318467e-03 3 1  ON 12
ci_014                 8.950922e-03 3 1  ON 13
ci_015                 1.245944e-02 3 1  ON 14
ci_016                 1.305361e-02 3 1  ON 15
ci_017                 1.041550e-02 3 1  ON 16
ci_018                 1.028334e-02 3 1  ON 17
ci_019                -3.552352e-03 3 1  ON 18
ci_020                -4.013853e-03 3 1  ON 19
ci_021                -8.737305e-03 3 1  ON 20
ci_022                -9.306290e-03 3 1  ON 21
ci_023                 6.811750e-03 3 1  ON 22
ci_024                 8.178040e-03 3 1  ON 23
ci_025                 4.175667e-03 3 1  ON 24
ci_026                 4.136215e-03 3 1  ON 25
ci_027                 6.934923e-03 3 1  ON 26
ci_028                 7.465528e-03 3 1  ON 27
ci_029                -5.630621e-03 3 1  ON 28
ci_030                -4.891867e-03 3 1  ON 29
ci_031                -7.619242e-03 3 1  ON 30
ci_032                -7.965317e-03 3 1  ON 31
ci_033                 3.008681e-03 3 1  ON 32
ci_034                 4.625932e-03 3 1  ON 33
ci_035                 9.867693e-04 3 1  ON 34
ci_036                 2.158195e-03 3 1  ON 35
ci_037                 4.767919e-03 3 1  ON 36
ci_038                 5.964686e-03 3 1  ON 37
ci_039                 5.413065e-03 3 1  ON 38
ci_040                 5.284186e-03 3 1  ON 39
ci_041                 4.620080e-03 3 1  ON 40
ci_042                 4.554074e-03 3 1  ON 41
ci_043                 4.997932e-03 3 1  ON 42
ci_044                 4.992268e-03 3 1  ON 43
ci_045                 3.320342e-03 3 1  ON 44
ci_046                 3.389149e-03 3 1  ON 45
ci_047                -7.100188e-04 3 1  ON 46
ci_048                 2.449496e-04 3 1  ON 47
ci_049                 2.306296e-03 3 1  ON 48
ci_050                 1.566507e-03 3 1  ON 49
ci_051                -1.356869e-03 3 1  ON 50
ci_052                -1.362113e-03 3 1  ON 51
ci_053                -2.781823e-03 3 1  ON 52
ci_054                -2.006467e-03 3 1  ON 53
ci_055                -1.784561e-03 3 1  ON 54
ci_056                -2.000120e-03 3 1  ON 55
ci_057                -1.707757e-03 3 1  ON 56
ci_058                -1.091291e-03 3 1  ON 57
ci_059                 3.180053e-04 3 1  ON 58
ci_060                 6.551996e-04 3 1  ON 59
ci_061                 2.020526e-04 3 1  ON 60
ci_062                 3.096255e-05 3 1  ON 61
ci_063                -3.858847e-04 3 1  ON 62
ci_064                 2.155512e-04 3 1  ON 63
ci_065                -1.920637e-03 3 1  ON 64
ci_066                -1.952624e-03 3 1  ON 65
ci_067                -1.968881e-03 3 1  ON 66
ci_068                -2.354039e-03 3 1  ON 67
ci_069                -7.928349e-05 3 1  ON 68
ci_070                -1.588083e-03 3 1  ON 69
ci_071                -1.742588e-03 3 1  ON 70
ci_072                -1.099643e-03 3 1  ON 71
ci_073                 2.715637e-04 3 1  ON 72
ci_074                 8.625820e-04 3 1  ON 73
ci_075                -2.089665e-04 3 1  ON 74
ci_076                -1.492262e-03 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 2.9222e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s055 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s055 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=55  my_counter=0
  time step      = 5.0000e-02
  blocks         = 250
  steps          = 250
  substeps       = 10
  current        = 0
  target samples = 8.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">250</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">6.2500e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">8.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">6.2500e+04</parameter>
<parameter name="steps" condition="int">250</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2668e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="250">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =8000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 55
    time step          = 0.05
    reference energy   = -22.8047
    reference variance = 1.04755
====================================================
  Execution time = 1.0075e+02
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s055
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 62500 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 6.1153e+04
  VMC Eavg = -2.2670e+01
  VMC Evar = 5.1434e-01
  Total weights = 7.820850316e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.8815e+01
  </log>
</opt>
<opt stage="main" walkers="62500">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.499722817306
                                         uncertainty =       0.001750519350

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.499722817306
                                         uncertainty =       0.001750519350

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000249931614
  error estimate for blocks of size 2^( 2) =       0.000258877533
  error estimate for blocks of size 2^( 3) =       0.000266862686
  error estimate for blocks of size 2^( 4) =       0.000272317342
  error estimate for blocks of size 2^( 5) =       0.000275606704
  error estimate for blocks of size 2^( 6) =       0.000277281177
  error estimate for blocks of size 2^( 7) =       0.000277573072
  error estimate for blocks of size 2^( 8) =       0.000278722548
  error estimate for blocks of size 2^( 9) =       0.000279320244

      target function =                  N/A
              le_mean =     -22.669732465182
             les_mean =     514.431109133888
             stat err =       0.000278224260
             autocorr =       1.239217694774
              std dev =       0.706913355526
             le_variance =       0.499726492220


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266973246518e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.5511e-01, overlap shift 5.5511e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.669732465203       residual = 1.24e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.669742433438       residual = 1.80e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.669742373059       residual = 4.54e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.669742395452       residual = 1.55e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 5.5511e-01 is 4.677431e-04

solving harmonic davidson linear method for identity shift 2.2204e+00, overlap shift 2.2204e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.669732465203       residual = 1.24e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.669735572434       residual = 1.31e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.669735561439       residual = 3.13e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.669735567001       residual = 9.62e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 2.2204e+00 is 1.432195e-04

solving harmonic davidson linear method for identity shift 8.8818e+00, overlap shift 8.8818e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.669732465203       residual = 1.24e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.669733293103       residual = 1.32e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.669733292279       residual = 3.17e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.669733293150       residual = 1.07e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 8.8818e+00 is 3.909496e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.377259 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.1958e+02
  </log>
  <optVariables href="FORM.s055.opt.xml">
ci_001                -7.072216e-01 3 1  ON 0
ci_002                -7.042599e-01 3 1  ON 1
ci_003                -3.725610e-02 3 1  ON 2
ci_004                -3.458068e-02 3 1  ON 3
ci_005                 1.551483e-02 3 1  ON 4
ci_006                 1.593202e-02 3 1  ON 5
ci_007                 1.218374e-02 3 1  ON 6
ci_008                 1.287906e-02 3 1  ON 7
ci_009                -1.194874e-02 3 1  ON 8
ci_010                -1.195961e-02 3 1  ON 9
ci_011                -8.293070e-03 3 1  ON 10
ci_012                -7.565232e-03 3 1  ON 11
ci_013                 9.285857e-03 3 1  ON 12
ci_014                 8.976514e-03 3 1  ON 13
ci_015                 1.250236e-02 3 1  ON 14
ci_016                 1.300219e-02 3 1  ON 15
ci_017                 1.042117e-02 3 1  ON 16
ci_018                 1.030506e-02 3 1  ON 17
ci_019                -3.593951e-03 3 1  ON 18
ci_020                -3.999140e-03 3 1  ON 19
ci_021                -8.779250e-03 3 1  ON 20
ci_022                -9.326737e-03 3 1  ON 21
ci_023                 6.931361e-03 3 1  ON 22
ci_024                 8.157506e-03 3 1  ON 23
ci_025                 4.150285e-03 3 1  ON 24
ci_026                 4.163142e-03 3 1  ON 25
ci_027                 6.893304e-03 3 1  ON 26
ci_028                 7.376182e-03 3 1  ON 27
ci_029                -5.583713e-03 3 1  ON 28
ci_030                -4.935678e-03 3 1  ON 29
ci_031                -7.640349e-03 3 1  ON 30
ci_032                -7.929622e-03 3 1  ON 31
ci_033                 3.043663e-03 3 1  ON 32
ci_034                 4.617663e-03 3 1  ON 33
ci_035                 1.023290e-03 3 1  ON 34
ci_036                 2.016717e-03 3 1  ON 35
ci_037                 4.829349e-03 3 1  ON 36
ci_038                 5.931237e-03 3 1  ON 37
ci_039                 5.412622e-03 3 1  ON 38
ci_040                 5.269973e-03 3 1  ON 39
ci_041                 4.647535e-03 3 1  ON 40
ci_042                 4.582384e-03 3 1  ON 41
ci_043                 4.946187e-03 3 1  ON 42
ci_044                 5.010362e-03 3 1  ON 43
ci_045                 3.312747e-03 3 1  ON 44
ci_046                 3.382809e-03 3 1  ON 45
ci_047                -7.518701e-04 3 1  ON 46
ci_048                 1.285194e-04 3 1  ON 47
ci_049                 2.252850e-03 3 1  ON 48
ci_050                 1.619864e-03 3 1  ON 49
ci_051                -1.351223e-03 3 1  ON 50
ci_052                -1.380522e-03 3 1  ON 51
ci_053                -2.784993e-03 3 1  ON 52
ci_054                -2.005913e-03 3 1  ON 53
ci_055                -1.814661e-03 3 1  ON 54
ci_056                -1.908318e-03 3 1  ON 55
ci_057                -1.657940e-03 3 1  ON 56
ci_058                -1.073991e-03 3 1  ON 57
ci_059                 2.665739e-04 3 1  ON 58
ci_060                 5.713894e-04 3 1  ON 59
ci_061                 1.787576e-04 3 1  ON 60
ci_062                 7.000578e-05 3 1  ON 61
ci_063                -4.112474e-04 3 1  ON 62
ci_064                 7.702714e-05 3 1  ON 63
ci_065                -2.006752e-03 3 1  ON 64
ci_066                -1.965404e-03 3 1  ON 65
ci_067                -1.931844e-03 3 1  ON 66
ci_068                -2.370817e-03 3 1  ON 67
ci_069                -1.037690e-04 3 1  ON 68
ci_070                -1.457148e-03 3 1  ON 69
ci_071                -1.808260e-03 3 1  ON 70
ci_072                -1.189439e-03 3 1  ON 71
ci_073                 2.240552e-04 3 1  ON 72
ci_074                 7.193625e-04 3 1  ON 73
ci_075                -2.938516e-04 3 1  ON 74
ci_076                -1.416865e-03 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="250">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =8000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 55
    time step          = 0.05
    reference energy   = -22.6438
    reference variance = 0.388322
====================================================
  Execution time = 1.0031e+02
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s055
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 62500 
  VMC Eavg = -2.2670e+01
  VMC Evar = 5.1449e-01
  Total weights = 7.8213e+06
  Execution time = 1.4462e+01
  </log>
</opt>
<opt stage="main" walkers="62500">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.499057211932
                                         uncertainty =       0.001608899768

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.499057211932
                                         uncertainty =       0.001608899768

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000249763899
  error estimate for blocks of size 2^( 2) =       0.000258527456
  error estimate for blocks of size 2^( 3) =       0.000266636416
  error estimate for blocks of size 2^( 4) =       0.000272121754
  error estimate for blocks of size 2^( 5) =       0.000275228596
  error estimate for blocks of size 2^( 6) =       0.000276772497
  error estimate for blocks of size 2^( 7) =       0.000277094038
  error estimate for blocks of size 2^( 8) =       0.000277654968
  error estimate for blocks of size 2^( 9) =       0.000279331915

      target function =                  N/A
              le_mean =     -22.669534955565
             les_mean =     514.422564273582
             stat err =       0.000277713354
             autocorr =       1.236329403988
              std dev =       0.706438986039
             le_variance =       0.499056040996

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.498989949731
                                         uncertainty =       0.001600505447

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.498989949731
                                         uncertainty =       0.001600505447

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000249747061
  error estimate for blocks of size 2^( 2) =       0.000258511226
  error estimate for blocks of size 2^( 3) =       0.000266620681
  error estimate for blocks of size 2^( 4) =       0.000272106995
  error estimate for blocks of size 2^( 5) =       0.000275215401
  error estimate for blocks of size 2^( 6) =       0.000276761779
  error estimate for blocks of size 2^( 7) =       0.000277085233
  error estimate for blocks of size 2^( 8) =       0.000277644478
  error estimate for blocks of size 2^( 9) =       0.000279324869

      target function =                  N/A
              le_mean =     -22.669537638227
             les_mean =     514.425295158903
             stat err =       0.000277704090
             autocorr =       1.236413619251
              std dev =       0.706391360709
             le_variance =       0.498988754485

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.499006247866
                                         uncertainty =       0.001603607207

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.499006247866
                                         uncertainty =       0.001603607207

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000249751142
  error estimate for blocks of size 2^( 2) =       0.000258515047
  error estimate for blocks of size 2^( 3) =       0.000266624562
  error estimate for blocks of size 2^( 4) =       0.000272110599
  error estimate for blocks of size 2^( 5) =       0.000275218433
  error estimate for blocks of size 2^( 6) =       0.000276763797
  error estimate for blocks of size 2^( 7) =       0.000277086789
  error estimate for blocks of size 2^( 8) =       0.000277646850
  error estimate for blocks of size 2^( 9) =       0.000279325869

      target function =                  N/A
              le_mean =     -22.669535716452
             les_mean =     514.422626298317
             stat err =       0.000277705826
             autocorr =       1.236388675108
              std dev =       0.706402903540
             le_variance =       0.499005062130

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.499049286710
                                         uncertainty =       0.001608152640

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.499049286710
                                         uncertainty =       0.001608152640

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000249761915
  error estimate for blocks of size 2^( 2) =       0.000258525554
  error estimate for blocks of size 2^( 3) =       0.000266634625
  error estimate for blocks of size 2^( 4) =       0.000272119949
  error estimate for blocks of size 2^( 5) =       0.000275227256
  error estimate for blocks of size 2^( 6) =       0.000276771999
  error estimate for blocks of size 2^( 7) =       0.000277094776
  error estimate for blocks of size 2^( 8) =       0.000277655828
  error estimate for blocks of size 2^( 9) =       0.000279334029

      target function =                  N/A
              le_mean =     -22.669535101952
             les_mean =     514.439064453793
             stat err =       0.000277714158
             autocorr =       1.236356198550
              std dev =       0.706433375080
             le_variance =       0.499048113427


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.669534955565        initial
     5.5511e-01     5.5511e+00             4.6774e-04       -22.669537638227  <--
     2.2204e+00     2.2204e+01             1.4322e-04       -22.669535716452
     8.8818e+00     8.8818e+01             3.9095e-05       -22.669535101952

*****************************************************************************
Applying the update for shift_i =   5.5511e-01     and shift_s =   5.5511e+00
*****************************************************************************

  Execution time = 1.7271e+02
  </log>
  <optVariables href="FORM.s055.opt.xml">
ci_001                -7.072271e-01 3 1  ON 0
ci_002                -7.042556e-01 3 1  ON 1
ci_003                -3.726794e-02 3 1  ON 2
ci_004                -3.474870e-02 3 1  ON 3
ci_005                 1.550378e-02 3 1  ON 4
ci_006                 1.582905e-02 3 1  ON 5
ci_007                 1.220920e-02 3 1  ON 6
ci_008                 1.277372e-02 3 1  ON 7
ci_009                -1.192720e-02 3 1  ON 8
ci_010                -1.181997e-02 3 1  ON 9
ci_011                -8.121860e-03 3 1  ON 10
ci_012                -7.495470e-03 3 1  ON 11
ci_013                 9.211873e-03 3 1  ON 12
ci_014                 9.025575e-03 3 1  ON 13
ci_015                 1.260810e-02 3 1  ON 14
ci_016                 1.287356e-02 3 1  ON 15
ci_017                 1.044092e-02 3 1  ON 16
ci_018                 1.035480e-02 3 1  ON 17
ci_019                -3.693911e-03 3 1  ON 18
ci_020                -3.967218e-03 3 1  ON 19
ci_021                -8.879414e-03 3 1  ON 20
ci_022                -9.385602e-03 3 1  ON 21
ci_023                 7.198767e-03 3 1  ON 22
ci_024                 8.113565e-03 3 1  ON 23
ci_025                 4.091704e-03 3 1  ON 24
ci_026                 4.227448e-03 3 1  ON 25
ci_027                 6.805701e-03 3 1  ON 26
ci_028                 7.196144e-03 3 1  ON 27
ci_029                -5.465496e-03 3 1  ON 28
ci_030                -5.036063e-03 3 1  ON 29
ci_031                -7.691546e-03 3 1  ON 30
ci_032                -7.837938e-03 3 1  ON 31
ci_033                 3.128542e-03 3 1  ON 32
ci_034                 4.597976e-03 3 1  ON 33
ci_035                 1.092954e-03 3 1  ON 34
ci_036                 1.731748e-03 3 1  ON 35
ci_037                 4.971901e-03 3 1  ON 36
ci_038                 5.856393e-03 3 1  ON 37
ci_039                 5.410568e-03 3 1  ON 38
ci_040                 5.243426e-03 3 1  ON 39
ci_041                 4.708499e-03 3 1  ON 40
ci_042                 4.645759e-03 3 1  ON 41
ci_043                 4.821574e-03 3 1  ON 42
ci_044                 5.041641e-03 3 1  ON 43
ci_045                 3.292636e-03 3 1  ON 44
ci_046                 3.368647e-03 3 1  ON 45
ci_047                -8.343812e-04 3 1  ON 46
ci_048                -1.051899e-04 3 1  ON 47
ci_049                 2.128545e-03 3 1  ON 48
ci_050                 1.743624e-03 3 1  ON 49
ci_051                -1.334331e-03 3 1  ON 50
ci_052                -1.414410e-03 3 1  ON 51
ci_053                -2.795180e-03 3 1  ON 52
ci_054                -2.004775e-03 3 1  ON 53
ci_055                -1.892040e-03 3 1  ON 54
ci_056                -1.684126e-03 3 1  ON 55
ci_057                -1.545762e-03 3 1  ON 56
ci_058                -1.036897e-03 3 1  ON 57
ci_059                 1.641706e-04 3 1  ON 58
ci_060                 4.030590e-04 3 1  ON 59
ci_061                 1.199574e-04 3 1  ON 60
ci_062                 1.624374e-04 3 1  ON 61
ci_063                -4.737606e-04 3 1  ON 62
ci_064                -2.521919e-04 3 1  ON 63
ci_065                -2.204878e-03 3 1  ON 64
ci_066                -1.992812e-03 3 1  ON 65
ci_067                -1.842987e-03 3 1  ON 66
ci_068                -2.417415e-03 3 1  ON 67
ci_069                -1.561070e-04 3 1  ON 68
ci_070                -1.158317e-03 3 1  ON 69
ci_071                -1.960909e-03 3 1  ON 70
ci_072                -1.394469e-03 3 1  ON 71
ci_073                 1.287240e-04 3 1  ON 72
ci_074                 4.344389e-04 3 1  ON 73
ci_075                -4.854428e-04 3 1  ON 74
ci_076                -1.249430e-03 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 2.9230e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s056 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s056 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=56  my_counter=0
  time step      = 5.0000e-02
  blocks         = 250
  steps          = 250
  substeps       = 10
  current        = 0
  target samples = 8.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">250</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">6.2500e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">8.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">6.2500e+04</parameter>
<parameter name="steps" condition="int">250</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2669e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="250">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =8000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 56
    time step          = 0.05
    reference energy   = -22.5925
    reference variance = 0.393687
====================================================
  Execution time = 1.0048e+02
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s056
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 62500 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 6.1133e+04
  VMC Eavg = -2.2670e+01
  VMC Evar = 5.1682e-01
  Total weights = 7.820352772e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.8842e+01
  </log>
</opt>
<opt stage="main" walkers="62500">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.498976392284
                                         uncertainty =       0.001678928630

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.498976392284
                                         uncertainty =       0.001678928630

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000249743923
  error estimate for blocks of size 2^( 2) =       0.000258639880
  error estimate for blocks of size 2^( 3) =       0.000266622723
  error estimate for blocks of size 2^( 4) =       0.000272412354
  error estimate for blocks of size 2^( 5) =       0.000275926803
  error estimate for blocks of size 2^( 6) =       0.000277945037
  error estimate for blocks of size 2^( 7) =       0.000279027211
  error estimate for blocks of size 2^( 8) =       0.000280799888
  error estimate for blocks of size 2^( 9) =       0.000281027373

      target function =                  N/A
              le_mean =     -22.669587905499
             les_mean =     514.427038344681
             stat err =       0.000279699877
             autocorr =       1.254280562693
              std dev =       0.706382486537
             le_variance =       0.498976217287


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266958790550e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.3878e-01, overlap shift 1.3878e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.669587905521       residual = 6.97e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.669602849418       residual = 1.47e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.669602871963       residual = 8.69e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.669602981050       residual = 6.54e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 1.3878e-01 is 9.107058e-04

solving harmonic davidson linear method for identity shift 5.5511e-01, overlap shift 5.5511e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.669587905521       residual = 6.97e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.669594431038       residual = 5.51e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.669594261831       residual = 1.50e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.669594290944       residual = 6.54e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 5.5511e-01 is 3.871685e-04

solving harmonic davidson linear method for identity shift 2.2204e+00, overlap shift 2.2204e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.669587905521       residual = 6.97e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.669589911315       residual = 5.84e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.669589843219       residual = 1.18e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.669589849799       residual = 4.48e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 2.2204e+00 is 1.195379e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.378686 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.1934e+02
  </log>
  <optVariables href="FORM.s056.opt.xml">
ci_001                -7.072611e-01 3 1  ON 0
ci_002                -7.042057e-01 3 1  ON 1
ci_003                -3.735623e-02 3 1  ON 2
ci_004                -3.487580e-02 3 1  ON 3
ci_005                 1.561944e-02 3 1  ON 4
ci_006                 1.592668e-02 3 1  ON 5
ci_007                 1.229980e-02 3 1  ON 6
ci_008                 1.265081e-02 3 1  ON 7
ci_009                -1.198623e-02 3 1  ON 8
ci_010                -1.170832e-02 3 1  ON 9
ci_011                -8.051799e-03 3 1  ON 10
ci_012                -7.603669e-03 3 1  ON 11
ci_013                 9.151183e-03 3 1  ON 12
ci_014                 9.157937e-03 3 1  ON 13
ci_015                 1.261582e-02 3 1  ON 14
ci_016                 1.297154e-02 3 1  ON 15
ci_017                 1.052240e-02 3 1  ON 16
ci_018                 1.046554e-02 3 1  ON 17
ci_019                -3.806681e-03 3 1  ON 18
ci_020                -3.967301e-03 3 1  ON 19
ci_021                -8.832227e-03 3 1  ON 20
ci_022                -9.259464e-03 3 1  ON 21
ci_023                 7.585936e-03 3 1  ON 22
ci_024                 7.917694e-03 3 1  ON 23
ci_025                 4.133337e-03 3 1  ON 24
ci_026                 4.126440e-03 3 1  ON 25
ci_027                 6.839286e-03 3 1  ON 26
ci_028                 7.064959e-03 3 1  ON 27
ci_029                -5.274816e-03 3 1  ON 28
ci_030                -4.953259e-03 3 1  ON 29
ci_031                -7.694913e-03 3 1  ON 30
ci_032                -7.662880e-03 3 1  ON 31
ci_033                 3.497787e-03 3 1  ON 32
ci_034                 4.676483e-03 3 1  ON 33
ci_035                 1.069342e-03 3 1  ON 34
ci_036                 1.600995e-03 3 1  ON 35
ci_037                 4.890930e-03 3 1  ON 36
ci_038                 5.821694e-03 3 1  ON 37
ci_039                 5.189297e-03 3 1  ON 38
ci_040                 5.462234e-03 3 1  ON 39
ci_041                 4.728729e-03 3 1  ON 40
ci_042                 4.719945e-03 3 1  ON 41
ci_043                 4.896983e-03 3 1  ON 42
ci_044                 4.888976e-03 3 1  ON 43
ci_045                 3.348146e-03 3 1  ON 44
ci_046                 3.206289e-03 3 1  ON 45
ci_047                -6.260743e-04 3 1  ON 46
ci_048                -3.426290e-04 3 1  ON 47
ci_049                 2.073391e-03 3 1  ON 48
ci_050                 1.624383e-03 3 1  ON 49
ci_051                -1.233894e-03 3 1  ON 50
ci_052                -1.304248e-03 3 1  ON 51
ci_053                -2.933455e-03 3 1  ON 52
ci_054                -2.167910e-03 3 1  ON 53
ci_055                -1.755273e-03 3 1  ON 54
ci_056                -1.681269e-03 3 1  ON 55
ci_057                -1.630075e-03 3 1  ON 56
ci_058                -1.254497e-03 3 1  ON 57
ci_059                -6.508987e-06 3 1  ON 58
ci_060                 3.850453e-04 3 1  ON 59
ci_061                -2.991460e-05 3 1  ON 60
ci_062                 1.204592e-04 3 1  ON 61
ci_063                -6.247160e-04 3 1  ON 62
ci_064                -3.035013e-04 3 1  ON 63
ci_065                -2.216183e-03 3 1  ON 64
ci_066                -2.057139e-03 3 1  ON 65
ci_067                -1.931956e-03 3 1  ON 66
ci_068                -2.450477e-03 3 1  ON 67
ci_069                -2.735435e-04 3 1  ON 68
ci_070                -1.073627e-03 3 1  ON 69
ci_071                -1.885223e-03 3 1  ON 70
ci_072                -1.743498e-03 3 1  ON 71
ci_073                 3.420936e-05 3 1  ON 72
ci_074                 2.371470e-04 3 1  ON 73
ci_075                -4.998337e-04 3 1  ON 74
ci_076                -1.110174e-03 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="250">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =8000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 56
    time step          = 0.05
    reference energy   = -22.637
    reference variance = 0.40556
====================================================
  Execution time = 1.0039e+02
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s056
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 62500 
  VMC Eavg = -2.2670e+01
  VMC Evar = 5.1782e-01
  Total weights = 7.8208e+06
  Execution time = 1.4396e+01
  </log>
</opt>
<opt stage="main" walkers="62500">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.500985377049
                                         uncertainty =       0.002203510306

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.500985377049
                                         uncertainty =       0.002203510306

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000250245914
  error estimate for blocks of size 2^( 2) =       0.000259191027
  error estimate for blocks of size 2^( 3) =       0.000267058819
  error estimate for blocks of size 2^( 4) =       0.000272689460
  error estimate for blocks of size 2^( 5) =       0.000276028276
  error estimate for blocks of size 2^( 6) =       0.000277849882
  error estimate for blocks of size 2^( 7) =       0.000278377078
  error estimate for blocks of size 2^( 8) =       0.000278877158
  error estimate for blocks of size 2^( 9) =       0.000278580701

      target function =                  N/A
              le_mean =     -22.670289821737
             les_mean =     514.475315420592
             stat err =       0.000278421205
             autocorr =       1.237857422395
              std dev =       0.707802332167
             le_variance =       0.500984141421

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.500922303571
                                         uncertainty =       0.002175250118

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.500922303571
                                         uncertainty =       0.002175250118

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000250230169
  error estimate for blocks of size 2^( 2) =       0.000259172255
  error estimate for blocks of size 2^( 3) =       0.000267040937
  error estimate for blocks of size 2^( 4) =       0.000272670165
  error estimate for blocks of size 2^( 5) =       0.000276014209
  error estimate for blocks of size 2^( 6) =       0.000277835091
  error estimate for blocks of size 2^( 7) =       0.000278355994
  error estimate for blocks of size 2^( 8) =       0.000278868331
  error estimate for blocks of size 2^( 9) =       0.000278596669

      target function =                  N/A
              le_mean =     -22.670292609632
             les_mean =     514.466484633594
             stat err =       0.000278414021
             autocorr =       1.237949322360
              std dev =       0.707757798683
             le_variance =       0.500921101597

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.500916641182
                                         uncertainty =       0.002180158877

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.500916641182
                                         uncertainty =       0.002180158877

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000250228751
  error estimate for blocks of size 2^( 2) =       0.000259170714
  error estimate for blocks of size 2^( 3) =       0.000267039584
  error estimate for blocks of size 2^( 4) =       0.000272669313
  error estimate for blocks of size 2^( 5) =       0.000276014530
  error estimate for blocks of size 2^( 6) =       0.000277836479
  error estimate for blocks of size 2^( 7) =       0.000278357410
  error estimate for blocks of size 2^( 8) =       0.000278867409
  error estimate for blocks of size 2^( 9) =       0.000278590884

      target function =                  N/A
              le_mean =     -22.670291687223
             les_mean =     514.470632765165
             stat err =       0.000278413045
             autocorr =       1.237954678456
              std dev =       0.707753786828
             le_variance =       0.500915422770

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.500960577671
                                         uncertainty =       0.002199794553

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.500960577671
                                         uncertainty =       0.002199794553

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000250239722
  error estimate for blocks of size 2^( 2) =       0.000259184284
  error estimate for blocks of size 2^( 3) =       0.000267052319
  error estimate for blocks of size 2^( 4) =       0.000272682601
  error estimate for blocks of size 2^( 5) =       0.000276022708
  error estimate for blocks of size 2^( 6) =       0.000277844700
  error estimate for blocks of size 2^( 7) =       0.000278369172
  error estimate for blocks of size 2^( 8) =       0.000278870815
  error estimate for blocks of size 2^( 9) =       0.000278574372

      target function =                  N/A
              le_mean =     -22.670288644765
             les_mean =     514.460867175104
             stat err =       0.000278414765
             autocorr =       1.237861419012
              std dev =       0.707784817504
             le_variance =       0.500959347890


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.670289821737        initial
     1.3878e-01     1.3878e+00             9.1071e-04       -22.670292609632  <--
     5.5511e-01     5.5511e+00             3.8717e-04       -22.670291687223
     2.2204e+00     2.2204e+01             1.1954e-04       -22.670288644765

*****************************************************************************
Applying the update for shift_i =   1.3878e-01     and shift_s =   1.3878e+00
*****************************************************************************

  Execution time = 1.7266e+02
  </log>
  <optVariables href="FORM.s056.opt.xml">
ci_001                -7.073715e-01 3 1  ON 0
ci_002                -7.040676e-01 3 1  ON 1
ci_003                -3.755353e-02 3 1  ON 2
ci_004                -3.514230e-02 3 1  ON 3
ci_005                 1.574122e-02 3 1  ON 4
ci_006                 1.603687e-02 3 1  ON 5
ci_007                 1.239487e-02 3 1  ON 6
ci_008                 1.248275e-02 3 1  ON 7
ci_009                -1.204227e-02 3 1  ON 8
ci_010                -1.155575e-02 3 1  ON 9
ci_011                -7.942604e-03 3 1  ON 10
ci_012                -7.729920e-03 3 1  ON 11
ci_013                 9.030714e-03 3 1  ON 12
ci_014                 9.335399e-03 3 1  ON 13
ci_015                 1.262334e-02 3 1  ON 14
ci_016                 1.312946e-02 3 1  ON 15
ci_017                 1.064109e-02 3 1  ON 16
ci_018                 1.063849e-02 3 1  ON 17
ci_019                -3.992724e-03 3 1  ON 18
ci_020                -3.963602e-03 3 1  ON 19
ci_021                -8.734512e-03 3 1  ON 20
ci_022                -9.073872e-03 3 1  ON 21
ci_023                 8.075851e-03 3 1  ON 22
ci_024                 7.668754e-03 3 1  ON 23
ci_025                 4.205813e-03 3 1  ON 24
ci_026                 3.951925e-03 3 1  ON 25
ci_027                 6.867968e-03 3 1  ON 26
ci_028                 6.927268e-03 3 1  ON 27
ci_029                -5.005105e-03 3 1  ON 28
ci_030                -4.829731e-03 3 1  ON 29
ci_031                -7.704221e-03 3 1  ON 30
ci_032                -7.391026e-03 3 1  ON 31
ci_033                 4.039248e-03 3 1  ON 32
ci_034                 4.806351e-03 3 1  ON 33
ci_035                 1.053876e-03 3 1  ON 34
ci_036                 1.463065e-03 3 1  ON 35
ci_037                 4.768835e-03 3 1  ON 36
ci_038                 5.786523e-03 3 1  ON 37
ci_039                 4.958564e-03 3 1  ON 38
ci_040                 5.688932e-03 3 1  ON 39
ci_041                 4.753718e-03 3 1  ON 40
ci_042                 4.806132e-03 3 1  ON 41
ci_043                 4.991802e-03 3 1  ON 42
ci_044                 4.673945e-03 3 1  ON 43
ci_045                 3.379599e-03 3 1  ON 44
ci_046                 2.966413e-03 3 1  ON 45
ci_047                -4.257330e-04 3 1  ON 46
ci_048                -5.837156e-04 3 1  ON 47
ci_049                 2.001565e-03 3 1  ON 48
ci_050                 1.450757e-03 3 1  ON 49
ci_051                -1.105749e-03 3 1  ON 50
ci_052                -1.094890e-03 3 1  ON 51
ci_053                -3.133425e-03 3 1  ON 52
ci_054                -2.401356e-03 3 1  ON 53
ci_055                -1.526863e-03 3 1  ON 54
ci_056                -1.668290e-03 3 1  ON 55
ci_057                -1.736681e-03 3 1  ON 56
ci_058                -1.541239e-03 3 1  ON 57
ci_059                -1.797890e-04 3 1  ON 58
ci_060                 3.720241e-04 3 1  ON 59
ci_061                -2.375781e-04 3 1  ON 60
ci_062                 3.751001e-05 3 1  ON 61
ci_063                -8.499208e-04 3 1  ON 62
ci_064                -3.705512e-04 3 1  ON 63
ci_065                -2.246794e-03 3 1  ON 64
ci_066                -2.149884e-03 3 1  ON 65
ci_067                -2.074833e-03 3 1  ON 66
ci_068                -2.499117e-03 3 1  ON 67
ci_069                -4.301016e-04 3 1  ON 68
ci_070                -9.592307e-04 3 1  ON 69
ci_071                -1.792172e-03 3 1  ON 70
ci_072                -2.227507e-03 3 1  ON 71
ci_073                -5.200979e-05 3 1  ON 72
ci_074                 3.721894e-05 3 1  ON 73
ci_075                -5.204778e-04 3 1  ON 74
ci_076                -9.245900e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 2.9202e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s057 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s057 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=57  my_counter=0
  time step      = 5.0000e-02
  blocks         = 250
  steps          = 250
  substeps       = 10
  current        = 0
  target samples = 8.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">250</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">6.2500e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">8.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">6.2500e+04</parameter>
<parameter name="steps" condition="int">250</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2668e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="250">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =8000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 57
    time step          = 0.05
    reference energy   = -22.6999
    reference variance = 0.392667
====================================================
  Execution time = 1.0043e+02
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s057
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 62500 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 6.1150e+04
  VMC Eavg = -2.2669e+01
  VMC Evar = 5.1646e-01
  Total weights = 7.820644653e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.8685e+01
  </log>
</opt>
<opt stage="main" walkers="62500">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.499923358142
                                         uncertainty =       0.001772085012

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.499923358142
                                         uncertainty =       0.001772085012

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000249980719
  error estimate for blocks of size 2^( 2) =       0.000258902859
  error estimate for blocks of size 2^( 3) =       0.000266750032
  error estimate for blocks of size 2^( 4) =       0.000272272362
  error estimate for blocks of size 2^( 5) =       0.000275553879
  error estimate for blocks of size 2^( 6) =       0.000277388238
  error estimate for blocks of size 2^( 7) =       0.000277932745
  error estimate for blocks of size 2^( 8) =       0.000278874820
  error estimate for blocks of size 2^( 9) =       0.000279008915

      target function =                  N/A
              le_mean =     -22.669390046560
             les_mean =     514.417707324763
             stat err =       0.000278301180
             autocorr =       1.239415917107
              std dev =       0.707052245954
             le_variance =       0.499922878509


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266939004656e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.4694e-02, overlap shift 3.4694e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.669390046586       residual = 4.92e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.669402113029       residual = 3.69e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.669401326157       residual = 8.56e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.669401162120       residual = 2.72e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.669401543740       residual = 1.10e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.669401561446       residual = 2.52e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.669401557069       residual = 3.95e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 3.4694e-02 is 1.546974e-03

solving harmonic davidson linear method for identity shift 1.3878e-01, overlap shift 1.3878e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.669390046586       residual = 4.92e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.669398057521       residual = 2.04e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.669397562546       residual = 1.79e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.669397522356       residual = 9.54e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 1.3878e-01 is 8.630821e-04

solving harmonic davidson linear method for identity shift 5.5511e-01, overlap shift 5.5511e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.669390046586       residual = 4.92e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.669393463644       residual = 1.12e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.669393325795       residual = 5.14e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.669393330319       residual = 1.38e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 5.5511e-01 is 3.569456e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.380398 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.1913e+02
  </log>
  <optVariables href="FORM.s057.opt.xml">
ci_001                -7.070208e-01 3 1  ON 0
ci_002                -7.043965e-01 3 1  ON 1
ci_003                -3.800549e-02 3 1  ON 2
ci_004                -3.539604e-02 3 1  ON 3
ci_005                 1.586749e-02 3 1  ON 4
ci_006                 1.616136e-02 3 1  ON 5
ci_007                 1.194937e-02 3 1  ON 6
ci_008                 1.230331e-02 3 1  ON 7
ci_009                -1.191201e-02 3 1  ON 8
ci_010                -1.159577e-02 3 1  ON 9
ci_011                -8.148240e-03 3 1  ON 10
ci_012                -8.202073e-03 3 1  ON 11
ci_013                 9.318426e-03 3 1  ON 12
ci_014                 9.663595e-03 3 1  ON 13
ci_015                 1.265987e-02 3 1  ON 14
ci_016                 1.307897e-02 3 1  ON 15
ci_017                 1.087599e-02 3 1  ON 16
ci_018                 1.027441e-02 3 1  ON 17
ci_019                -4.030044e-03 3 1  ON 18
ci_020                -3.826774e-03 3 1  ON 19
ci_021                -8.993540e-03 3 1  ON 20
ci_022                -8.351759e-03 3 1  ON 21
ci_023                 7.584388e-03 3 1  ON 22
ci_024                 7.836590e-03 3 1  ON 23
ci_025                 3.981628e-03 3 1  ON 24
ci_026                 3.831849e-03 3 1  ON 25
ci_027                 7.040932e-03 3 1  ON 26
ci_028                 6.939331e-03 3 1  ON 27
ci_029                -4.659906e-03 3 1  ON 28
ci_030                -4.836532e-03 3 1  ON 29
ci_031                -7.341071e-03 3 1  ON 30
ci_032                -7.811497e-03 3 1  ON 31
ci_033                 4.309726e-03 3 1  ON 32
ci_034                 4.633340e-03 3 1  ON 33
ci_035                 1.266337e-03 3 1  ON 34
ci_036                 1.125741e-03 3 1  ON 35
ci_037                 4.514703e-03 3 1  ON 36
ci_038                 5.657829e-03 3 1  ON 37
ci_039                 5.158844e-03 3 1  ON 38
ci_040                 5.647273e-03 3 1  ON 39
ci_041                 4.591909e-03 3 1  ON 40
ci_042                 4.349594e-03 3 1  ON 41
ci_043                 4.791487e-03 3 1  ON 42
ci_044                 4.980186e-03 3 1  ON 43
ci_045                 3.010899e-03 3 1  ON 44
ci_046                 3.112476e-03 3 1  ON 45
ci_047                -6.898851e-04 3 1  ON 46
ci_048                -5.323962e-04 3 1  ON 47
ci_049                 1.959757e-03 3 1  ON 48
ci_050                 1.528980e-03 3 1  ON 49
ci_051                -1.353673e-03 3 1  ON 50
ci_052                -8.669318e-04 3 1  ON 51
ci_053                -2.548556e-03 3 1  ON 52
ci_054                -3.264438e-03 3 1  ON 53
ci_055                -1.568736e-03 3 1  ON 54
ci_056                -1.859559e-03 3 1  ON 55
ci_057                -1.531356e-03 3 1  ON 56
ci_058                -1.533190e-03 3 1  ON 57
ci_059                -4.289569e-05 3 1  ON 58
ci_060                 4.805363e-04 3 1  ON 59
ci_061                 1.269720e-04 3 1  ON 60
ci_062                -3.873814e-04 3 1  ON 61
ci_063                -9.425743e-04 3 1  ON 62
ci_064                -5.802899e-04 3 1  ON 63
ci_065                -2.230325e-03 3 1  ON 64
ci_066                -1.943099e-03 3 1  ON 65
ci_067                -1.884222e-03 3 1  ON 66
ci_068                -2.569620e-03 3 1  ON 67
ci_069                -1.664546e-04 3 1  ON 68
ci_070                -3.787780e-04 3 1  ON 69
ci_071                -2.351516e-03 3 1  ON 70
ci_072                -2.247527e-03 3 1  ON 71
ci_073                -4.792762e-05 3 1  ON 72
ci_074                 2.779041e-04 3 1  ON 73
ci_075                -4.574103e-04 3 1  ON 74
ci_076                -4.022104e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="250">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =8000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 57
    time step          = 0.05
    reference energy   = -22.665
    reference variance = 0.453538
====================================================
  Execution time = 1.0027e+02
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s057
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 62500 
  VMC Eavg = -2.2670e+01
  VMC Evar = 5.1565e-01
  Total weights = 7.8203e+06
  Execution time = 1.4407e+01
  </log>
</opt>
<opt stage="main" walkers="62500">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

ERROR CostFunction-> Number of Effective Walkers is too small! 
  Number of effective walkers (samples) / total number of samples = 0.000404421
  User specified threshold minwalkers = 0.3
  If this message appears frequently. You might have to be cautious. 
  Find info about parameter "minwalkers" in the user manual!
Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.501623258048
                                         uncertainty =       0.002614209543

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.501623258048
                                         uncertainty =       0.002614209543

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000250407082
  error estimate for blocks of size 2^( 2) =       0.000259315187
  error estimate for blocks of size 2^( 3) =       0.000267179279
  error estimate for blocks of size 2^( 4) =       0.000272714587
  error estimate for blocks of size 2^( 5) =       0.000275843285
  error estimate for blocks of size 2^( 6) =       0.000277401861
  error estimate for blocks of size 2^( 7) =       0.000278345950
  error estimate for blocks of size 2^( 8) =       0.000278416955
  error estimate for blocks of size 2^( 9) =       0.000279236457

      target function =                  N/A
              le_mean =     -22.669724718281
             les_mean =     514.445813045294
             stat err =       0.000278350306
             autocorr =       1.235634964723
              std dev =       0.708258184228
             le_variance =       0.501629655526

ERROR CostFunction-> Number of Effective Walkers is too small! 
  Number of effective walkers (samples) / total number of samples = 0.00540781
  User specified threshold minwalkers = 0.3
  If this message appears frequently. You might have to be cautious. 
  Find info about parameter "minwalkers" in the user manual!
Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.501615518585
                                         uncertainty =       0.002563789147

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.501615518585
                                         uncertainty =       0.002563789147

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000250405094
  error estimate for blocks of size 2^( 2) =       0.000259314818
  error estimate for blocks of size 2^( 3) =       0.000267188636
  error estimate for blocks of size 2^( 4) =       0.000272722945
  error estimate for blocks of size 2^( 5) =       0.000275866071
  error estimate for blocks of size 2^( 6) =       0.000277419891
  error estimate for blocks of size 2^( 7) =       0.000278356466
  error estimate for blocks of size 2^( 8) =       0.000278401809
  error estimate for blocks of size 2^( 9) =       0.000279233262

      target function =                  N/A
              le_mean =     -22.669718408645
             les_mean =     514.610400944546
             stat err =       0.000278352857
             autocorr =       1.235677240018
              std dev =       0.708252559541
             le_variance =       0.501621688097

ERROR CostFunction-> Number of Effective Walkers is too small! 
  Number of effective walkers (samples) / total number of samples = 0.000406283
  User specified threshold minwalkers = 0.3
  If this message appears frequently. You might have to be cautious. 
  Find info about parameter "minwalkers" in the user manual!
Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.502090020021
                                         uncertainty =       0.002677310398

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.502090020021
                                         uncertainty =       0.002677310398

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000250523786
  error estimate for blocks of size 2^( 2) =       0.000259432908
  error estimate for blocks of size 2^( 3) =       0.000267302568
  error estimate for blocks of size 2^( 4) =       0.000272830385
  error estimate for blocks of size 2^( 5) =       0.000275970340
  error estimate for blocks of size 2^( 6) =       0.000277525691
  error estimate for blocks of size 2^( 7) =       0.000278497937
  error estimate for blocks of size 2^( 8) =       0.000278549436
  error estimate for blocks of size 2^( 9) =       0.000279418756

      target function =                  N/A
              le_mean =     -22.669724440178
             les_mean =     514.568192878050
             stat err =       0.000278497955
             autocorr =       1.235794015223
              std dev =       0.708588272138
             le_variance =       0.502097339412

ERROR CostFunction-> Number of Effective Walkers is too small! 
  Number of effective walkers (samples) / total number of samples = 0.00351829
  User specified threshold minwalkers = 0.3
  If this message appears frequently. You might have to be cautious. 
  Find info about parameter "minwalkers" in the user manual!
Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.501509650698
                                         uncertainty =       0.002615782595

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.501509650698
                                         uncertainty =       0.002615782595

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000250378726
  error estimate for blocks of size 2^( 2) =       0.000259287372
  error estimate for blocks of size 2^( 3) =       0.000267155058
  error estimate for blocks of size 2^( 4) =       0.000272687798
  error estimate for blocks of size 2^( 5) =       0.000275817811
  error estimate for blocks of size 2^( 6) =       0.000277377996
  error estimate for blocks of size 2^( 7) =       0.000278318809
  error estimate for blocks of size 2^( 8) =       0.000278388613
  error estimate for blocks of size 2^( 9) =       0.000279241515

      target function =                  N/A
              le_mean =     -22.669718787811
             les_mean =     514.435628186974
             stat err =       0.000278331733
             autocorr =       1.235749938076
              std dev =       0.708177979873
             le_variance =       0.501516051177


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.669724718281        initial  <--
     3.4694e-02     3.4694e-01             1.5470e-03       -22.669718408645
     1.3878e-01     1.3878e+00             8.6308e-04       -22.669724440178
     5.5511e-01     5.5511e+00             3.5695e-04       -22.669718787811

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 172.5272
  </log>
  <optVariables href="FORM.s057.opt.xml">
ci_001                -7.073715e-01 3 1  ON 0
ci_002                -7.040676e-01 3 1  ON 1
ci_003                -3.755353e-02 3 1  ON 2
ci_004                -3.514230e-02 3 1  ON 3
ci_005                 1.574122e-02 3 1  ON 4
ci_006                 1.603687e-02 3 1  ON 5
ci_007                 1.239487e-02 3 1  ON 6
ci_008                 1.248275e-02 3 1  ON 7
ci_009                -1.204227e-02 3 1  ON 8
ci_010                -1.155575e-02 3 1  ON 9
ci_011                -7.942604e-03 3 1  ON 10
ci_012                -7.729920e-03 3 1  ON 11
ci_013                 9.030714e-03 3 1  ON 12
ci_014                 9.335399e-03 3 1  ON 13
ci_015                 1.262334e-02 3 1  ON 14
ci_016                 1.312946e-02 3 1  ON 15
ci_017                 1.064109e-02 3 1  ON 16
ci_018                 1.063849e-02 3 1  ON 17
ci_019                -3.992724e-03 3 1  ON 18
ci_020                -3.963602e-03 3 1  ON 19
ci_021                -8.734512e-03 3 1  ON 20
ci_022                -9.073872e-03 3 1  ON 21
ci_023                 8.075851e-03 3 1  ON 22
ci_024                 7.668754e-03 3 1  ON 23
ci_025                 4.205813e-03 3 1  ON 24
ci_026                 3.951925e-03 3 1  ON 25
ci_027                 6.867968e-03 3 1  ON 26
ci_028                 6.927268e-03 3 1  ON 27
ci_029                -5.005105e-03 3 1  ON 28
ci_030                -4.829731e-03 3 1  ON 29
ci_031                -7.704221e-03 3 1  ON 30
ci_032                -7.391026e-03 3 1  ON 31
ci_033                 4.039248e-03 3 1  ON 32
ci_034                 4.806351e-03 3 1  ON 33
ci_035                 1.053876e-03 3 1  ON 34
ci_036                 1.463065e-03 3 1  ON 35
ci_037                 4.768835e-03 3 1  ON 36
ci_038                 5.786523e-03 3 1  ON 37
ci_039                 4.958564e-03 3 1  ON 38
ci_040                 5.688932e-03 3 1  ON 39
ci_041                 4.753718e-03 3 1  ON 40
ci_042                 4.806132e-03 3 1  ON 41
ci_043                 4.991802e-03 3 1  ON 42
ci_044                 4.673945e-03 3 1  ON 43
ci_045                 3.379599e-03 3 1  ON 44
ci_046                 2.966413e-03 3 1  ON 45
ci_047                -4.257330e-04 3 1  ON 46
ci_048                -5.837156e-04 3 1  ON 47
ci_049                 2.001565e-03 3 1  ON 48
ci_050                 1.450757e-03 3 1  ON 49
ci_051                -1.105749e-03 3 1  ON 50
ci_052                -1.094890e-03 3 1  ON 51
ci_053                -3.133425e-03 3 1  ON 52
ci_054                -2.401356e-03 3 1  ON 53
ci_055                -1.526863e-03 3 1  ON 54
ci_056                -1.668290e-03 3 1  ON 55
ci_057                -1.736681e-03 3 1  ON 56
ci_058                -1.541239e-03 3 1  ON 57
ci_059                -1.797890e-04 3 1  ON 58
ci_060                 3.720241e-04 3 1  ON 59
ci_061                -2.375781e-04 3 1  ON 60
ci_062                 3.751001e-05 3 1  ON 61
ci_063                -8.499208e-04 3 1  ON 62
ci_064                -3.705512e-04 3 1  ON 63
ci_065                -2.246794e-03 3 1  ON 64
ci_066                -2.149884e-03 3 1  ON 65
ci_067                -2.074833e-03 3 1  ON 66
ci_068                -2.499117e-03 3 1  ON 67
ci_069                -4.301016e-04 3 1  ON 68
ci_070                -9.592307e-04 3 1  ON 69
ci_071                -1.792172e-03 3 1  ON 70
ci_072                -2.227507e-03 3 1  ON 71
ci_073                -5.200979e-05 3 1  ON 72
ci_074                 3.721894e-05 3 1  ON 73
ci_075                -5.204778e-04 3 1  ON 74
ci_076                -9.245900e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 2.9167e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s058 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s058 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=58  my_counter=0
  time step      = 5.0000e-02
  blocks         = 250
  steps          = 250
  substeps       = 10
  current        = 0
  target samples = 8.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">250</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">6.2500e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">8.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">6.2500e+04</parameter>
<parameter name="steps" condition="int">250</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2669e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="250">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =8000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 58
    time step          = 0.05
    reference energy   = -22.6607
    reference variance = 0.51068
====================================================
  Execution time = 1.0016e+02
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s058
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 62500 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 6.1181e+04
  VMC Eavg = -2.2670e+01
  VMC Evar = 5.0734e-01
  Total weights = 7.820691084e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.8822e+01
  </log>
</opt>
<opt stage="main" walkers="62500">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.495950193015
                                         uncertainty =       0.001283709290

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.495950193015
                                         uncertainty =       0.001283709290

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000248985907
  error estimate for blocks of size 2^( 2) =       0.000257936639
  error estimate for blocks of size 2^( 3) =       0.000265813005
  error estimate for blocks of size 2^( 4) =       0.000271470063
  error estimate for blocks of size 2^( 5) =       0.000274951262
  error estimate for blocks of size 2^( 6) =       0.000276593575
  error estimate for blocks of size 2^( 7) =       0.000277763598
  error estimate for blocks of size 2^( 8) =       0.000277118149
  error estimate for blocks of size 2^( 9) =       0.000278799037

      target function =                  N/A
              le_mean =     -22.670257463276
             les_mean =     514.447913791698
             stat err =       0.000277568590
             autocorr =       1.242770982418
              std dev =       0.704238494313
             le_variance =       0.495951856872


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.267025746328e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.4694e-01, overlap shift 3.4694e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.670257463303       residual = 5.45e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.670260499963       residual = 1.28e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.670261021270       residual = 4.60e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.670261036848       residual = 1.31e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 3.4694e-01 is 5.498396e-04

solving harmonic davidson linear method for identity shift 1.3878e+00, overlap shift 1.3878e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.670257463303       residual = 5.45e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.670258471867       residual = 6.99e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.670258631953       residual = 2.15e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.670258633932       residual = 3.70e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 1.3878e+00 is 1.530526e-04

solving harmonic davidson linear method for identity shift 5.5511e+00, overlap shift 5.5511e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.670257463303       residual = 5.45e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.670257738005       residual = 7.48e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.670257780564       residual = 2.18e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.670257781414       residual = 4.43e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 5.5511e+00 is 4.366395e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.381806 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.1900e+02
  </log>
  <optVariables href="FORM.s058.opt.xml">
ci_001                -7.073681e-01 3 1  ON 0
ci_002                -7.040674e-01 3 1  ON 1
ci_003                -3.749345e-02 3 1  ON 2
ci_004                -3.529525e-02 3 1  ON 3
ci_005                 1.575172e-02 3 1  ON 4
ci_006                 1.596839e-02 3 1  ON 5
ci_007                 1.239627e-02 3 1  ON 6
ci_008                 1.246825e-02 3 1  ON 7
ci_009                -1.203404e-02 3 1  ON 8
ci_010                -1.153111e-02 3 1  ON 9
ci_011                -8.038386e-03 3 1  ON 10
ci_012                -7.719566e-03 3 1  ON 11
ci_013                 9.059277e-03 3 1  ON 12
ci_014                 9.314159e-03 3 1  ON 13
ci_015                 1.259866e-02 3 1  ON 14
ci_016                 1.307046e-02 3 1  ON 15
ci_017                 1.067917e-02 3 1  ON 16
ci_018                 1.069372e-02 3 1  ON 17
ci_019                -3.959065e-03 3 1  ON 18
ci_020                -3.982353e-03 3 1  ON 19
ci_021                -8.791264e-03 3 1  ON 20
ci_022                -9.085051e-03 3 1  ON 21
ci_023                 8.155326e-03 3 1  ON 22
ci_024                 7.676057e-03 3 1  ON 23
ci_025                 4.197808e-03 3 1  ON 24
ci_026                 4.049050e-03 3 1  ON 25
ci_027                 6.775649e-03 3 1  ON 26
ci_028                 6.774216e-03 3 1  ON 27
ci_029                -4.975406e-03 3 1  ON 28
ci_030                -4.840304e-03 3 1  ON 29
ci_031                -7.731951e-03 3 1  ON 30
ci_032                -7.421521e-03 3 1  ON 31
ci_033                 4.108373e-03 3 1  ON 32
ci_034                 4.733439e-03 3 1  ON 33
ci_035                 1.082816e-03 3 1  ON 34
ci_036                 1.333098e-03 3 1  ON 35
ci_037                 4.850450e-03 3 1  ON 36
ci_038                 5.714241e-03 3 1  ON 37
ci_039                 5.048292e-03 3 1  ON 38
ci_040                 5.627384e-03 3 1  ON 39
ci_041                 4.812695e-03 3 1  ON 40
ci_042                 4.765118e-03 3 1  ON 41
ci_043                 4.989150e-03 3 1  ON 42
ci_044                 4.740214e-03 3 1  ON 43
ci_045                 3.392489e-03 3 1  ON 44
ci_046                 3.000048e-03 3 1  ON 45
ci_047                -4.721978e-04 3 1  ON 46
ci_048                -5.621388e-04 3 1  ON 47
ci_049                 1.960623e-03 3 1  ON 48
ci_050                 1.488575e-03 3 1  ON 49
ci_051                -1.090441e-03 3 1  ON 50
ci_052                -1.205698e-03 3 1  ON 51
ci_053                -3.043944e-03 3 1  ON 52
ci_054                -2.450766e-03 3 1  ON 53
ci_055                -1.534383e-03 3 1  ON 54
ci_056                -1.661695e-03 3 1  ON 55
ci_057                -1.760339e-03 3 1  ON 56
ci_058                -1.520130e-03 3 1  ON 57
ci_059                -1.910140e-04 3 1  ON 58
ci_060                 4.156291e-04 3 1  ON 59
ci_061                -2.933299e-04 3 1  ON 60
ci_062                 7.134418e-05 3 1  ON 61
ci_063                -8.007243e-04 3 1  ON 62
ci_064                -2.735349e-04 3 1  ON 63
ci_065                -2.258580e-03 3 1  ON 64
ci_066                -2.177615e-03 3 1  ON 65
ci_067                -2.120995e-03 3 1  ON 66
ci_068                -2.447347e-03 3 1  ON 67
ci_069                -4.222464e-04 3 1  ON 68
ci_070                -8.688912e-04 3 1  ON 69
ci_071                -1.837601e-03 3 1  ON 70
ci_072                -2.174803e-03 3 1  ON 71
ci_073                 1.631635e-05 3 1  ON 72
ci_074                 8.189231e-05 3 1  ON 73
ci_075                -4.398824e-04 3 1  ON 74
ci_076                -8.737271e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="250">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =8000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 58
    time step          = 0.05
    reference energy   = -22.6988
    reference variance = 0.54553
====================================================
  Execution time = 9.8575e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s058
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 62500 
  VMC Eavg = -2.2670e+01
  VMC Evar = 5.1305e-01
  Total weights = 7.8203e+06
  Execution time = 1.4840e+01
  </log>
</opt>
<opt stage="main" walkers="62500">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.499261469607
                                         uncertainty =       0.001444988965

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.499261469607
                                         uncertainty =       0.001444988965

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000249814864
  error estimate for blocks of size 2^( 2) =       0.000258723895
  error estimate for blocks of size 2^( 3) =       0.000266589438
  error estimate for blocks of size 2^( 4) =       0.000272341977
  error estimate for blocks of size 2^( 5) =       0.000275223530
  error estimate for blocks of size 2^( 6) =       0.000277253175
  error estimate for blocks of size 2^( 7) =       0.000278245788
  error estimate for blocks of size 2^( 8) =       0.000279513442
  error estimate for blocks of size 2^( 9) =       0.000279301345

      target function =                  N/A
              le_mean =     -22.669924737735
             les_mean =     514.453617283647
             stat err =       0.000278578438
             autocorr =       1.243536236146
              std dev =       0.706583138317
             le_variance =       0.499259731354

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.499280201794
                                         uncertainty =       0.001451557280

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.499280201794
                                         uncertainty =       0.001451557280

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000249819544
  error estimate for blocks of size 2^( 2) =       0.000258728853
  error estimate for blocks of size 2^( 3) =       0.000266596083
  error estimate for blocks of size 2^( 4) =       0.000272348161
  error estimate for blocks of size 2^( 5) =       0.000275233355
  error estimate for blocks of size 2^( 6) =       0.000277258759
  error estimate for blocks of size 2^( 7) =       0.000278246674
  error estimate for blocks of size 2^( 8) =       0.000279513640
  error estimate for blocks of size 2^( 9) =       0.000279309867

      target function =                  N/A
              le_mean =     -22.669924879789
             les_mean =     514.441814686713
             stat err =       0.000278582235
             autocorr =       1.243523550005
              std dev =       0.706596374181
             le_variance =       0.499278436005

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.499267486321
                                         uncertainty =       0.001449340051

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.499267486321
                                         uncertainty =       0.001449340051

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000249816366
  error estimate for blocks of size 2^( 2) =       0.000258725941
  error estimate for blocks of size 2^( 3) =       0.000266592700
  error estimate for blocks of size 2^( 4) =       0.000272345044
  error estimate for blocks of size 2^( 5) =       0.000275229206
  error estimate for blocks of size 2^( 6) =       0.000277255974
  error estimate for blocks of size 2^( 7) =       0.000278245237
  error estimate for blocks of size 2^( 8) =       0.000279512611
  error estimate for blocks of size 2^( 9) =       0.000279306993

      target function =                  N/A
              le_mean =     -22.669923875267
             les_mean =     514.439144152268
             stat err =       0.000278580204
             autocorr =       1.243537057282
              std dev =       0.706587384527
             le_variance =       0.499265731972

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.499259588957
                                         uncertainty =       0.001445590439

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.499259588957
                                         uncertainty =       0.001445590439

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000249814393
  error estimate for blocks of size 2^( 2) =       0.000258723617
  error estimate for blocks of size 2^( 3) =       0.000266589632
  error estimate for blocks of size 2^( 4) =       0.000272342214
  error estimate for blocks of size 2^( 5) =       0.000275224378
  error estimate for blocks of size 2^( 6) =       0.000277253845
  error estimate for blocks of size 2^( 7) =       0.000278246189
  error estimate for blocks of size 2^( 8) =       0.000279513945
  error estimate for blocks of size 2^( 9) =       0.000279304198

      target function =                  N/A
              le_mean =     -22.669924650700
             les_mean =     514.438698155410
             stat err =       0.000278579544
             autocorr =       1.243550804898
              std dev =       0.706581806388
             le_variance =       0.499257849119


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.669924737735        initial
     3.4694e-01     3.4694e+00             5.4984e-04       -22.669924879789  <--
     1.3878e+00     1.3878e+01             1.5305e-04       -22.669923875267
     5.5511e+00     5.5511e+01             4.3664e-05       -22.669924650700

*****************************************************************************
Applying the update for shift_i =   3.4694e-01     and shift_s =   3.4694e+00
*****************************************************************************

  Execution time = 1.7141e+02
  </log>
  <optVariables href="FORM.s058.opt.xml">
ci_001                -7.073656e-01 3 1  ON 0
ci_002                -7.040588e-01 3 1  ON 1
ci_003                -3.733189e-02 3 1  ON 2
ci_004                -3.569214e-02 3 1  ON 3
ci_005                 1.576951e-02 3 1  ON 4
ci_006                 1.584799e-02 3 1  ON 5
ci_007                 1.240303e-02 3 1  ON 6
ci_008                 1.244226e-02 3 1  ON 7
ci_009                -1.201702e-02 3 1  ON 8
ci_010                -1.148050e-02 3 1  ON 9
ci_011                -8.251593e-03 3 1  ON 10
ci_012                -7.692996e-03 3 1  ON 11
ci_013                 9.132012e-03 3 1  ON 12
ci_014                 9.264447e-03 3 1  ON 13
ci_015                 1.253591e-02 3 1  ON 14
ci_016                 1.292993e-02 3 1  ON 15
ci_017                 1.076876e-02 3 1  ON 16
ci_018                 1.081473e-02 3 1  ON 17
ci_019                -3.879712e-03 3 1  ON 18
ci_020                -4.036339e-03 3 1  ON 19
ci_021                -8.918074e-03 3 1  ON 20
ci_022                -9.111973e-03 3 1  ON 21
ci_023                 8.309895e-03 3 1  ON 22
ci_024                 7.695787e-03 3 1  ON 23
ci_025                 4.175663e-03 3 1  ON 24
ci_026                 4.264731e-03 3 1  ON 25
ci_027                 6.614948e-03 3 1  ON 26
ci_028                 6.518810e-03 3 1  ON 27
ci_029                -4.910488e-03 3 1  ON 28
ci_030                -4.854866e-03 3 1  ON 29
ci_031                -7.786326e-03 3 1  ON 30
ci_032                -7.485750e-03 3 1  ON 31
ci_033                 4.254474e-03 3 1  ON 32
ci_034                 4.575706e-03 3 1  ON 33
ci_035                 1.128930e-03 3 1  ON 34
ci_036                 1.121164e-03 3 1  ON 35
ci_037                 5.020007e-03 3 1  ON 36
ci_038                 5.559000e-03 3 1  ON 37
ci_039                 5.203143e-03 3 1  ON 38
ci_040                 5.526163e-03 3 1  ON 39
ci_041                 4.923529e-03 3 1  ON 40
ci_042                 4.690778e-03 3 1  ON 41
ci_043                 4.990943e-03 3 1  ON 42
ci_044                 4.875679e-03 3 1  ON 43
ci_045                 3.413834e-03 3 1  ON 44
ci_046                 3.075778e-03 3 1  ON 45
ci_047                -5.473622e-04 3 1  ON 46
ci_048                -5.288057e-04 3 1  ON 47
ci_049                 1.876518e-03 3 1  ON 48
ci_050                 1.564857e-03 3 1  ON 49
ci_051                -1.054608e-03 3 1  ON 50
ci_052                -1.440491e-03 3 1  ON 51
ci_053                -2.847292e-03 3 1  ON 52
ci_054                -2.561789e-03 3 1  ON 53
ci_055                -1.548810e-03 3 1  ON 54
ci_056                -1.647786e-03 3 1  ON 55
ci_057                -1.806402e-03 3 1  ON 56
ci_058                -1.477632e-03 3 1  ON 57
ci_059                -2.160040e-04 3 1  ON 58
ci_060                 4.863452e-04 3 1  ON 59
ci_061                -4.116402e-04 3 1  ON 60
ci_062                 1.388367e-04 3 1  ON 61
ci_063                -6.970505e-04 3 1  ON 62
ci_064                -7.147534e-05 3 1  ON 63
ci_065                -2.284878e-03 3 1  ON 64
ci_066                -2.236948e-03 3 1  ON 65
ci_067                -2.213171e-03 3 1  ON 66
ci_068                -2.335044e-03 3 1  ON 67
ci_069                -4.113468e-04 3 1  ON 68
ci_070                -6.853394e-04 3 1  ON 69
ci_071                -1.931369e-03 3 1  ON 70
ci_072                -2.052788e-03 3 1  ON 71
ci_073                 1.334716e-04 3 1  ON 72
ci_074                 1.564134e-04 3 1  ON 73
ci_075                -2.765162e-04 3 1  ON 74
ci_076                -7.789947e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 2.9042e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s059 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s059 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=59  my_counter=0
  time step      = 5.0000e-02
  blocks         = 250
  steps          = 250
  substeps       = 10
  current        = 0
  target samples = 8.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">250</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">6.2500e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">8.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">6.2500e+04</parameter>
<parameter name="steps" condition="int">250</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2669e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="250">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =8000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 59
    time step          = 0.05
    reference energy   = -22.7495
    reference variance = 0.606087
====================================================
  Execution time = 9.8998e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s059
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 62500 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 6.1094e+04
  VMC Eavg = -2.2669e+01
  VMC Evar = 5.1173e-01
  Total weights = 7.820776909e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.8952e+01
  </log>
</opt>
<opt stage="main" walkers="62500">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.499521952125
                                         uncertainty =       0.001620586205

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.499521952125
                                         uncertainty =       0.001620586205

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000249880857
  error estimate for blocks of size 2^( 2) =       0.000258787739
  error estimate for blocks of size 2^( 3) =       0.000266688312
  error estimate for blocks of size 2^( 4) =       0.000272185909
  error estimate for blocks of size 2^( 5) =       0.000275676876
  error estimate for blocks of size 2^( 6) =       0.000277060010
  error estimate for blocks of size 2^( 7) =       0.000278317999
  error estimate for blocks of size 2^( 8) =       0.000279498095
  error estimate for blocks of size 2^( 9) =       0.000278059556

      target function =                  N/A
              le_mean =     -22.669261406980
             les_mean =     514.407144313559
             stat err =       0.000278233915
             autocorr =       1.239807213081
              std dev =       0.706769794355
             le_variance =       0.499523542212


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266926140698e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 8.6736e-02, overlap shift 8.6736e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.669261407001       residual = 4.61e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.669264943652       residual = 2.14e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.669264501092       residual = 2.52e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.669264574411       residual = 2.60e-08           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.669264660820       residual = 3.81e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          4 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 8.6736e-02 is 8.407305e-04

solving harmonic davidson linear method for identity shift 3.4694e-01, overlap shift 3.4694e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.669261407001       residual = 4.61e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.669263172773       residual = 6.61e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.669263103034       residual = 1.84e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.669263106802       residual = 5.63e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 3.4694e-01 is 3.955233e-04

solving harmonic davidson linear method for identity shift 1.3878e+00, overlap shift 1.3878e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.669261407001       residual = 4.61e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.669261995025       residual = 4.44e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.669262015172       residual = 9.36e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 1.3878e+00 is 1.402751e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.383248 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.1797e+02
  </log>
  <optVariables href="FORM.s059.opt.xml">
ci_001                -7.072729e-01 3 1  ON 0
ci_002                -7.041558e-01 3 1  ON 1
ci_003                -3.707829e-02 3 1  ON 2
ci_004                -3.593964e-02 3 1  ON 3
ci_005                 1.556998e-02 3 1  ON 4
ci_006                 1.583870e-02 3 1  ON 5
ci_007                 1.234477e-02 3 1  ON 6
ci_008                 1.261543e-02 3 1  ON 7
ci_009                -1.183893e-02 3 1  ON 8
ci_010                -1.146333e-02 3 1  ON 9
ci_011                -8.440615e-03 3 1  ON 10
ci_012                -7.691249e-03 3 1  ON 11
ci_013                 9.164099e-03 3 1  ON 12
ci_014                 9.463817e-03 3 1  ON 13
ci_015                 1.241119e-02 3 1  ON 14
ci_016                 1.275110e-02 3 1  ON 15
ci_017                 1.104442e-02 3 1  ON 16
ci_018                 1.105263e-02 3 1  ON 17
ci_019                -3.844071e-03 3 1  ON 18
ci_020                -4.163526e-03 3 1  ON 19
ci_021                -9.032231e-03 3 1  ON 20
ci_022                -9.043122e-03 3 1  ON 21
ci_023                 8.172089e-03 3 1  ON 22
ci_024                 7.803466e-03 3 1  ON 23
ci_025                 4.383423e-03 3 1  ON 24
ci_026                 4.114106e-03 3 1  ON 25
ci_027                 6.640302e-03 3 1  ON 26
ci_028                 6.470017e-03 3 1  ON 27
ci_029                -4.962879e-03 3 1  ON 28
ci_030                -4.970063e-03 3 1  ON 29
ci_031                -7.772039e-03 3 1  ON 30
ci_032                -7.532361e-03 3 1  ON 31
ci_033                 4.129130e-03 3 1  ON 32
ci_034                 4.534838e-03 3 1  ON 33
ci_035                 1.064872e-03 3 1  ON 34
ci_036                 1.282567e-03 3 1  ON 35
ci_037                 5.057360e-03 3 1  ON 36
ci_038                 5.355841e-03 3 1  ON 37
ci_039                 5.111652e-03 3 1  ON 38
ci_040                 5.381118e-03 3 1  ON 39
ci_041                 5.049619e-03 3 1  ON 40
ci_042                 4.843212e-03 3 1  ON 41
ci_043                 4.991436e-03 3 1  ON 42
ci_044                 4.743447e-03 3 1  ON 43
ci_045                 3.235764e-03 3 1  ON 44
ci_046                 3.069526e-03 3 1  ON 45
ci_047                -6.142221e-04 3 1  ON 46
ci_048                -4.445913e-04 3 1  ON 47
ci_049                 1.783796e-03 3 1  ON 48
ci_050                 1.632653e-03 3 1  ON 49
ci_051                -1.103768e-03 3 1  ON 50
ci_052                -1.361823e-03 3 1  ON 51
ci_053                -2.679297e-03 3 1  ON 52
ci_054                -2.551150e-03 3 1  ON 53
ci_055                -1.521417e-03 3 1  ON 54
ci_056                -1.252263e-03 3 1  ON 55
ci_057                -1.876605e-03 3 1  ON 56
ci_058                -1.261682e-03 3 1  ON 57
ci_059                 1.617785e-04 3 1  ON 58
ci_060                 4.891692e-04 3 1  ON 59
ci_061                -2.511627e-04 3 1  ON 60
ci_062                 2.512085e-04 3 1  ON 61
ci_063                -5.985018e-04 3 1  ON 62
ci_064                -7.976750e-05 3 1  ON 63
ci_065                -2.609318e-03 3 1  ON 64
ci_066                -2.345469e-03 3 1  ON 65
ci_067                -2.123882e-03 3 1  ON 66
ci_068                -2.130440e-03 3 1  ON 67
ci_069                -4.042673e-04 3 1  ON 68
ci_070                -3.772573e-04 3 1  ON 69
ci_071                -1.890113e-03 3 1  ON 70
ci_072                -1.987861e-03 3 1  ON 71
ci_073                 2.560518e-04 3 1  ON 72
ci_074                 3.991502e-04 3 1  ON 73
ci_075                -7.721077e-05 3 1  ON 74
ci_076                -5.353524e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="250">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =8000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 59
    time step          = 0.05
    reference energy   = -22.6237
    reference variance = 0.356667
====================================================
  Execution time = 9.8800e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s059
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 62500 
  VMC Eavg = -2.2669e+01
  VMC Evar = 5.1481e-01
  Total weights = 7.8203e+06
  Execution time = 1.4433e+01
  </log>
</opt>
<opt stage="main" walkers="62500">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.497118819231
                                         uncertainty =       0.001409138168

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.497118819231
                                         uncertainty =       0.001409138168

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000249278889
  error estimate for blocks of size 2^( 2) =       0.000258321565
  error estimate for blocks of size 2^( 3) =       0.000266380609
  error estimate for blocks of size 2^( 4) =       0.000272217223
  error estimate for blocks of size 2^( 5) =       0.000275386000
  error estimate for blocks of size 2^( 6) =       0.000277213214
  error estimate for blocks of size 2^( 7) =       0.000277560664
  error estimate for blocks of size 2^( 8) =       0.000277872554
  error estimate for blocks of size 2^( 9) =       0.000276850772

      target function =                  N/A
              le_mean =     -22.669304319812
             les_mean =     514.416480335946
             stat err =       0.000277374301
             autocorr =       1.238116292708
              std dev =       0.705067172656
             le_variance =       0.497119717957

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.496971661837
                                         uncertainty =       0.001398844835

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.496971661837
                                         uncertainty =       0.001398844835

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000249241982
  error estimate for blocks of size 2^( 2) =       0.000258288532
  error estimate for blocks of size 2^( 3) =       0.000266350189
  error estimate for blocks of size 2^( 4) =       0.000272188918
  error estimate for blocks of size 2^( 5) =       0.000275357487
  error estimate for blocks of size 2^( 6) =       0.000277184837
  error estimate for blocks of size 2^( 7) =       0.000277529663
  error estimate for blocks of size 2^( 8) =       0.000277844646
  error estimate for blocks of size 2^( 9) =       0.000276813153

      target function =                  N/A
              le_mean =     -22.669302806620
             les_mean =     514.419067399393
             stat err =       0.000277343075
             autocorr =       1.238204159024
              std dev =       0.704962783399
             le_variance =       0.496972525978

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.496976784213
                                         uncertainty =       0.001399183909

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.496976784213
                                         uncertainty =       0.001399183909

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000249243267
  error estimate for blocks of size 2^( 2) =       0.000258290057
  error estimate for blocks of size 2^( 3) =       0.000266351841
  error estimate for blocks of size 2^( 4) =       0.000272190387
  error estimate for blocks of size 2^( 5) =       0.000275360042
  error estimate for blocks of size 2^( 6) =       0.000277184381
  error estimate for blocks of size 2^( 7) =       0.000277530025
  error estimate for blocks of size 2^( 8) =       0.000277843418
  error estimate for blocks of size 2^( 9) =       0.000276809909

      target function =                  N/A
              le_mean =     -22.669301043468
             les_mean =     514.471686527507
             stat err =       0.000277341933
             autocorr =       1.238181205497
              std dev =       0.704966416120
             le_variance =       0.496977647857

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.497076809327
                                         uncertainty =       0.001406806368

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.497076809327
                                         uncertainty =       0.001406806368

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000249268355
  error estimate for blocks of size 2^( 2) =       0.000258311839
  error estimate for blocks of size 2^( 3) =       0.000266371416
  error estimate for blocks of size 2^( 4) =       0.000272208433
  error estimate for blocks of size 2^( 5) =       0.000275377156
  error estimate for blocks of size 2^( 6) =       0.000277203977
  error estimate for blocks of size 2^( 7) =       0.000277551117
  error estimate for blocks of size 2^( 8) =       0.000277862391
  error estimate for blocks of size 2^( 9) =       0.000276838135

      target function =                  N/A
              le_mean =     -22.669302275714
             les_mean =     514.413718008310
             stat err =       0.000277363905
             autocorr =       1.238128136614
              std dev =       0.705037375328
             le_variance =       0.497077700609


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.669304319812        initial  <--
     8.6736e-02     8.6736e-01             8.4073e-04       -22.669302806620
     3.4694e-01     3.4694e+00             3.9552e-04       -22.669301043468
     1.3878e+00     1.3878e+01             1.4028e-04       -22.669302275714

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 171.3798
  </log>
  <optVariables href="FORM.s059.opt.xml">
ci_001                -7.073656e-01 3 1  ON 0
ci_002                -7.040588e-01 3 1  ON 1
ci_003                -3.733189e-02 3 1  ON 2
ci_004                -3.569214e-02 3 1  ON 3
ci_005                 1.576951e-02 3 1  ON 4
ci_006                 1.584799e-02 3 1  ON 5
ci_007                 1.240303e-02 3 1  ON 6
ci_008                 1.244226e-02 3 1  ON 7
ci_009                -1.201702e-02 3 1  ON 8
ci_010                -1.148050e-02 3 1  ON 9
ci_011                -8.251593e-03 3 1  ON 10
ci_012                -7.692996e-03 3 1  ON 11
ci_013                 9.132012e-03 3 1  ON 12
ci_014                 9.264447e-03 3 1  ON 13
ci_015                 1.253591e-02 3 1  ON 14
ci_016                 1.292993e-02 3 1  ON 15
ci_017                 1.076876e-02 3 1  ON 16
ci_018                 1.081473e-02 3 1  ON 17
ci_019                -3.879712e-03 3 1  ON 18
ci_020                -4.036339e-03 3 1  ON 19
ci_021                -8.918074e-03 3 1  ON 20
ci_022                -9.111973e-03 3 1  ON 21
ci_023                 8.309895e-03 3 1  ON 22
ci_024                 7.695787e-03 3 1  ON 23
ci_025                 4.175663e-03 3 1  ON 24
ci_026                 4.264731e-03 3 1  ON 25
ci_027                 6.614948e-03 3 1  ON 26
ci_028                 6.518810e-03 3 1  ON 27
ci_029                -4.910488e-03 3 1  ON 28
ci_030                -4.854866e-03 3 1  ON 29
ci_031                -7.786326e-03 3 1  ON 30
ci_032                -7.485750e-03 3 1  ON 31
ci_033                 4.254474e-03 3 1  ON 32
ci_034                 4.575706e-03 3 1  ON 33
ci_035                 1.128930e-03 3 1  ON 34
ci_036                 1.121164e-03 3 1  ON 35
ci_037                 5.020007e-03 3 1  ON 36
ci_038                 5.559000e-03 3 1  ON 37
ci_039                 5.203143e-03 3 1  ON 38
ci_040                 5.526163e-03 3 1  ON 39
ci_041                 4.923529e-03 3 1  ON 40
ci_042                 4.690778e-03 3 1  ON 41
ci_043                 4.990943e-03 3 1  ON 42
ci_044                 4.875679e-03 3 1  ON 43
ci_045                 3.413834e-03 3 1  ON 44
ci_046                 3.075778e-03 3 1  ON 45
ci_047                -5.473622e-04 3 1  ON 46
ci_048                -5.288057e-04 3 1  ON 47
ci_049                 1.876518e-03 3 1  ON 48
ci_050                 1.564857e-03 3 1  ON 49
ci_051                -1.054608e-03 3 1  ON 50
ci_052                -1.440491e-03 3 1  ON 51
ci_053                -2.847292e-03 3 1  ON 52
ci_054                -2.561789e-03 3 1  ON 53
ci_055                -1.548810e-03 3 1  ON 54
ci_056                -1.647786e-03 3 1  ON 55
ci_057                -1.806402e-03 3 1  ON 56
ci_058                -1.477632e-03 3 1  ON 57
ci_059                -2.160040e-04 3 1  ON 58
ci_060                 4.863452e-04 3 1  ON 59
ci_061                -4.116402e-04 3 1  ON 60
ci_062                 1.388367e-04 3 1  ON 61
ci_063                -6.970505e-04 3 1  ON 62
ci_064                -7.147534e-05 3 1  ON 63
ci_065                -2.284878e-03 3 1  ON 64
ci_066                -2.236948e-03 3 1  ON 65
ci_067                -2.213171e-03 3 1  ON 66
ci_068                -2.335044e-03 3 1  ON 67
ci_069                -4.113468e-04 3 1  ON 68
ci_070                -6.853394e-04 3 1  ON 69
ci_071                -1.931369e-03 3 1  ON 70
ci_072                -2.052788e-03 3 1  ON 71
ci_073                 1.334716e-04 3 1  ON 72
ci_074                 1.564134e-04 3 1  ON 73
ci_075                -2.765162e-04 3 1  ON 74
ci_076                -7.789947e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 2.8935e+02 secs
  Total Execution time = 1.7567e+04 secs

=========================================================
  A new xml input file : FORM.s059.cont.xml
