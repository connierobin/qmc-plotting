Rank =    0  Free Memory = 87428 MB
Rank =    1  Free Memory = 87428 MB
Rank =    2  Free Memory = 87428 MB
Rank =    3  Free Memory = 87428 MB
Rank =    4  Free Memory = 87428 MB
Rank =    5  Free Memory = 87428 MB
Rank =    6  Free Memory = 87427 MB
Rank =    7  Free Memory = 87427 MB
Rank =    8  Free Memory = 87427 MB
Rank =    9  Free Memory = 87427 MB
Rank =   10  Free Memory = 87427 MB
Rank =   11  Free Memory = 87427 MB
Rank =   12  Free Memory = 87427 MB
Rank =   13  Free Memory = 87427 MB
Rank =   14  Free Memory = 87426 MB
Rank =   15  Free Memory = 87412 MB
Rank =   16  Free Memory = 87412 MB
Rank =   17  Free Memory = 87412 MB
Rank =   18  Free Memory = 87412 MB
Rank =   19  Free Memory = 87412 MB
Rank =   20  Free Memory = 87412 MB
Rank =   21  Free Memory = 87412 MB
Rank =   22  Free Memory = 87412 MB
Rank =   23  Free Memory = 87412 MB
Rank =   24  Free Memory = 87412 MB
Rank =   25  Free Memory = 87412 MB
Rank =   26  Free Memory = 87412 MB
Rank =   27  Free Memory = 87412 MB
Rank =   28  Free Memory = 87412 MB
Rank =   29  Free Memory = 87412 MB
Rank =   30  Free Memory = 87412 MB
Rank =   31  Free Memory = 87412 MB
Rank =   32  Free Memory = 89213 MB
Rank =   33  Free Memory = 89213 MB
Rank =   34  Free Memory = 89213 MB
Rank =   35  Free Memory = 89213 MB
Rank =   36  Free Memory = 89213 MB
Rank =   37  Free Memory = 89213 MB
Rank =   38  Free Memory = 89213 MB
Rank =   39  Free Memory = 89213 MB
Rank =   40  Free Memory = 89213 MB
Rank =   41  Free Memory = 89213 MB
Rank =   42  Free Memory = 89213 MB
Rank =   43  Free Memory = 89213 MB
Rank =   44  Free Memory = 89213 MB
Rank =   45  Free Memory = 89213 MB
Rank =   46  Free Memory = 89213 MB
Rank =   47  Free Memory = 89213 MB
Rank =   48  Free Memory = 89213 MB
Rank =   49  Free Memory = 89213 MB
Rank =   50  Free Memory = 89213 MB
Rank =   51  Free Memory = 89213 MB
Rank =   52  Free Memory = 89213 MB
Rank =   53  Free Memory = 89213 MB
Rank =   54  Free Memory = 89213 MB
Rank =   55  Free Memory = 89213 MB
Rank =   56  Free Memory = 89213 MB
Rank =   57  Free Memory = 89213 MB
Rank =   58  Free Memory = 89213 MB
Rank =   59  Free Memory = 89213 MB
Rank =   60  Free Memory = 89213 MB
Rank =   61  Free Memory = 89213 MB
Rank =   62  Free Memory = 89213 MB
Rank =   63  Free Memory = 89213 MB
Rank =   64  Free Memory = 87537 MB
Rank =   65  Free Memory = 87537 MB
Rank =   66  Free Memory = 87537 MB
Rank =   67  Free Memory = 87537 MB
Rank =   68  Free Memory = 87537 MB
Rank =   69  Free Memory = 87537 MB
Rank =   70  Free Memory = 87537 MB
Rank =   71  Free Memory = 87537 MB
Rank =   72  Free Memory = 87537 MB
Rank =   73  Free Memory = 87537 MB
Rank =   74  Free Memory = 87537 MB
Rank =   75  Free Memory = 87537 MB
Rank =   76  Free Memory = 87537 MB
Rank =   77  Free Memory = 87537 MB
Rank =   78  Free Memory = 87537 MB
Rank =   79  Free Memory = 87537 MB
Rank =   80  Free Memory = 87537 MB
Rank =   81  Free Memory = 87537 MB
Rank =   82  Free Memory = 87537 MB
Rank =   83  Free Memory = 87537 MB
Rank =   84  Free Memory = 87537 MB
Rank =   85  Free Memory = 87537 MB
Rank =   86  Free Memory = 87537 MB
Rank =   87  Free Memory = 87537 MB
Rank =   88  Free Memory = 87537 MB
Rank =   89  Free Memory = 87537 MB
Rank =   90  Free Memory = 87537 MB
Rank =   91  Free Memory = 87537 MB
Rank =   92  Free Memory = 87537 MB
Rank =   93  Free Memory = 87537 MB
Rank =   94  Free Memory = 87537 MB
Rank =   95  Free Memory = 87537 MB
Rank =   96  Free Memory = 86709 MB
Rank =   97  Free Memory = 86709 MB
Rank =   98  Free Memory = 86709 MB
Rank =   99  Free Memory = 86709 MB
Rank =  100  Free Memory = 86709 MB
Rank =  101  Free Memory = 86709 MB
Rank =  102  Free Memory = 86709 MB
Rank =  103  Free Memory = 86709 MB
Rank =  104  Free Memory = 86709 MB
Rank =  105  Free Memory = 86709 MB
Rank =  106  Free Memory = 86709 MB
Rank =  107  Free Memory = 86709 MB
Rank =  108  Free Memory = 86709 MB
Rank =  109  Free Memory = 86709 MB
Rank =  110  Free Memory = 86709 MB
Rank =  111  Free Memory = 86709 MB
Rank =  112  Free Memory = 86709 MB
Rank =  113  Free Memory = 86709 MB
Rank =  114  Free Memory = 86709 MB
Rank =  115  Free Memory = 86709 MB
Rank =  116  Free Memory = 86709 MB
Rank =  117  Free Memory = 86709 MB
Rank =  118  Free Memory = 86709 MB
Rank =  119  Free Memory = 86709 MB
Rank =  120  Free Memory = 86709 MB
Rank =  121  Free Memory = 86709 MB
Rank =  122  Free Memory = 86709 MB
Rank =  123  Free Memory = 86709 MB
Rank =  124  Free Memory = 86709 MB
Rank =  125  Free Memory = 86709 MB
Rank =  126  Free Memory = 86709 MB
Rank =  127  Free Memory = 86709 MB
  Input file(s): opt_form_n2pistar_lmtt_run001a.xml 

=====================================================
                    QMCPACK 3.7.9

       (c) Copyright 2003-  QMCPACK developers

                    Please cite:
 J. Kim et al. J. Phys. Cond. Mat. 30 195901 (2018)
      https://doi.org/10.1088/1361-648X/aab9c3

  Git branch: gvp
  Last git commit: 02b8462cd86e2c45b012131e3a811aee79855b67-dirty
  Last git commit date: Mon Oct 24 16:30:05 2022 -0700
  Last git commit subject: Merge commit 59872d0bcea460ceb08aa7832e89b700ee19b55f into gvp
=====================================================
  Global options 

  Total number of MPI ranks = 128
  Number of MPI groups      = 1
  MPI group ID              = 0
  Number of ranks in group  = 128
  MPI ranks per node        = 32
  OMP 1st level threads     = 1
  OMP nested threading disabled or only 1 thread on the 2nd level

  Precision used in this calculation, see definitions in the manual:
  Base precision      = double
  Full precision      = double

  Structure-of-arrays (SoA) optimization enabled

  Input XML = opt_form_n2pistar_lmtt_run001a.xml

  Project = FORMN2JWARM
  date    = 2023-02-06 13:35:41 PST
  host    = n0064.savio3

 Random Number
 -------------
  Offset for the random number seeds based on time: 685

  Range of prime numbers to use as seeds over processors and threads = 5153-6269


 Particle Set 
 ------------
  Name: e
  All the species have the same mass 1
  Particle set size: 12

 Particle Set 
 ------------
  Name: ion0
  All the species have the same mass 1
  Particle set size: 4

 Wavefunction setup: 
 ------------------- 
  Name: psi0

   Jastrow
   -------
    Name: J2   Type: Two-Body   Function: Bspline

    Radial function for species: u - u
     Number of parameters: 10
     Cusp: -0.25
     Cutoff radius: 10

     Name                        Value Type Recompute Use Index
     ---- ---------------------------- ---- --------- --- -----
     uu_0                 2.949409e-01    1         1 OFF
     uu_1                 1.195613e-01    1         1 OFF
     uu_2                 6.101406e-03    1         1 OFF
     uu_3                -6.065052e-02    1         1 OFF
     uu_4                -1.006773e-01    1         1 OFF
     uu_5                -1.263386e-01    1         1 OFF
     uu_6                -1.424870e-01    1         1 OFF
     uu_7                -1.474970e-01    1         1 OFF
     uu_8                -1.439685e-01    1         1 OFF
     uu_9                -1.245737e-01    1         1 OFF

    Radial function for species: u - d
     Number of parameters: 10
     Cusp: -5.000000e-01
     Cutoff radius: 1.000000e+01

     Name                        Value Type Recompute Use Index
     ---- ---------------------------- ---- --------- --- -----
     ud_0                 3.892816e-01    1         1 OFF
     ud_1                 1.116049e-01    1         1 OFF
     ud_2                -2.827929e-02    1         1 OFF
     ud_3                -1.008992e-01    1         1 OFF
     ud_4                -1.393727e-01    1         1 OFF
     ud_5                -1.605036e-01    1         1 OFF
     ud_6                -1.695725e-01    1         1 OFF
     ud_7                -1.679012e-01    1         1 OFF
     ud_8                -1.529607e-01    1         1 OFF
     ud_9                -1.271010e-01    1         1 OFF


   Jastrow
   -------
    Name: J1   Type: One-Body   Function: Bspline

    Radial function for element: C
     Number of parameters: 10
     Cusp: 0.000000e+00
     Cutoff radius: 1.000000e+01

     Name                        Value Type Recompute Use Index
     ---- ---------------------------- ---- --------- --- -----
     eC_0                -5.549610e-01    1         1 OFF
     eC_1                -4.097799e-01    1         1 OFF
     eC_2                -1.687963e-01    1         1 OFF
     eC_3                -2.272894e-02    1         1 OFF
     eC_4                 4.861398e-02    1         1 OFF
     eC_5                 1.388351e-01    1         1 OFF
     eC_6                 2.384813e-01    1         1 OFF
     eC_7                 3.809007e-01    1         1 OFF
     eC_8                 2.683911e-01    1         1 OFF
     eC_9                 7.455279e-02    1         1 OFF

    Radial function for element: O
     Number of parameters: 10
     Cusp: 0.000000e+00
     Cutoff radius: 1.000000e+01

     Name                        Value Type Recompute Use Index
     ---- ---------------------------- ---- --------- --- -----
     eO_0                -1.151913e+00    1         1 OFF
     eO_1                -7.856470e-01    1         1 OFF
     eO_2                -3.291222e-01    1         1 OFF
     eO_3                 1.643085e-03    1         1 OFF
     eO_4                 2.151175e-01    1         1 OFF
     eO_5                 3.696682e-01    1         1 OFF
     eO_6                 4.085243e-01    1         1 OFF
     eO_7                 4.138030e-01    1         1 OFF
     eO_8                 4.299012e-01    1         1 OFF
     eO_9                 3.006370e-01    1         1 OFF

    Radial function for element: H1
     Number of parameters: 10
     Cusp: 0.000000e+00
     Cutoff radius: 1.000000e+01

      Name                        Value Type Recompute Use Index
     ----- ---------------------------- ---- --------- --- -----
     eH1_0                -1.976343e-01    1         1 OFF
     eH1_1                -1.082406e-01    1         1 OFF
     eH1_2                -7.189495e-02    1         1 OFF
     eH1_3                -5.559476e-02    1         1 OFF
     eH1_4                 1.189862e-02    1         1 OFF
     eH1_5                 5.684541e-02    1         1 OFF
     eH1_6                 8.802783e-02    1         1 OFF
     eH1_7                 6.288523e-02    1         1 OFF
     eH1_8                -2.109080e-02    1         1 OFF
     eH1_9                 7.073231e-02    1         1 OFF

    Radial function for element: H2
     Number of parameters: 10
     Cusp: 0.000000e+00
     Cutoff radius: 1.000000e+01

      Name                        Value Type Recompute Use Index
     ----- ---------------------------- ---- --------- --- -----
     eH2_0                -1.948420e-01    1         1 OFF
     eH2_1                -1.038901e-01    1         1 OFF
     eH2_2                -6.810792e-02    1         1 OFF
     eH2_3                -5.190814e-02    1         1 OFF
     eH2_4                 1.566164e-02    1         1 OFF
     eH2_5                 6.037548e-02    1         1 OFF
     eH2_6                 9.231229e-02    1         1 OFF
     eH2_7                 6.881598e-02    1         1 OFF
     eH2_8                -1.143329e-02    1         1 OFF
     eH2_9                 7.068194e-02    1         1 OFF

  Created SPOSet builder named 'LCAOBSet' of type molecularorbital
  LCAO: SoaAtomicBasisSet<MultiQuintic,0>
  AO BasisSet for C
   Angular momentum expanded in cartesian functions x^lx y^ly z^lz according to Gamess
Using log grid with default values: ri = 1.000000e-06 rf = 1.000000e+02 npts = 1001
   R(n,l,m,s) 0 0 0 0
   R(n,l,m,s) 1 0 0 0
   R(n,l,m,s) 2 1 0 0
   R(n,l,m,s) 3 1 0 0
   R(n,l,m,s) 4 2 0 0
Expanding Ylm (angular function) according to Gamess using cartesian gaussians
Adding 1 cartesian gaussian orbitals for l= 0
Adding 1 cartesian gaussian orbitals for l= 0
Adding 3 cartesian gaussian orbitals for l= 1
Adding 3 cartesian gaussian orbitals for l= 1
Adding 6 cartesian gaussian orbitals for l= 2
  Setting cutoff radius 1.270574e+01

   Maximum Angular Momentum  = 2
   Number of Radial functors = 5
   Basis size                = 14

  AO BasisSet for O
   Angular momentum expanded in cartesian functions x^lx y^ly z^lz according to Gamess
Using log grid with default values: ri = 1.000000e-06 rf = 1.000000e+02 npts = 1001
   R(n,l,m,s) 0 0 0 0
   R(n,l,m,s) 1 0 0 0
   R(n,l,m,s) 2 1 0 0
   R(n,l,m,s) 3 1 0 0
   R(n,l,m,s) 4 2 0 0
Expanding Ylm (angular function) according to Gamess using cartesian gaussians
Adding 1 cartesian gaussian orbitals for l= 0
Adding 1 cartesian gaussian orbitals for l= 0
Adding 3 cartesian gaussian orbitals for l= 1
Adding 3 cartesian gaussian orbitals for l= 1
Adding 6 cartesian gaussian orbitals for l= 2
  Setting cutoff radius 1.018591e+01

   Maximum Angular Momentum  = 2
   Number of Radial functors = 5
   Basis size                = 14

  AO BasisSet for H1
   Angular momentum expanded in cartesian functions x^lx y^ly z^lz according to Gamess
Using log grid with default values: ri = 1.000000e-06 rf = 1.000000e+02 npts = 1001
   R(n,l,m,s) 0 0 0 0
   R(n,l,m,s) 1 0 0 0
   R(n,l,m,s) 2 1 0 0
Expanding Ylm (angular function) according to Gamess using cartesian gaussians
Adding 1 cartesian gaussian orbitals for l= 0
Adding 1 cartesian gaussian orbitals for l= 0
Adding 3 cartesian gaussian orbitals for l= 1
  Setting cutoff radius 1.270574e+01

   Maximum Angular Momentum  = 1
   Number of Radial functors = 3
   Basis size                = 5

  AO BasisSet for H2
   Angular momentum expanded in cartesian functions x^lx y^ly z^lz according to Gamess
Using log grid with default values: ri = 1.000000e-06 rf = 1.000000e+02 npts = 1001
   R(n,l,m,s) 0 0 0 0
   R(n,l,m,s) 1 0 0 0
   R(n,l,m,s) 2 1 0 0
Expanding Ylm (angular function) according to Gamess using cartesian gaussians
Adding 1 cartesian gaussian orbitals for l= 0
Adding 1 cartesian gaussian orbitals for l= 0
Adding 3 cartesian gaussian orbitals for l= 1
  Setting cutoff radius 1.270574e+01

   Maximum Angular Momentum  = 1
   Number of Radial functors = 3
   Basis size                = 5

Creating SPOSet in SlaterDetBuilder::put(xmlNodePtr cur).
spo_name = spo-up
  Building SPOSet 'spo-up' with '' basis set.
Creating SPOSet in SlaterDetBuilder::put(xmlNodePtr cur).
spo_name = spo-dn
  Building SPOSet 'spo-dn' with '' basis set.
Using Bryan's algorithm for MultiSlaterDeterminant expansion. 
Creating base determinant (up) for MSD expansion. 
Creating base determinant (down) for MSD expansion. 
Found determinant list. 
Reading CI expansion.
Found 77 terms in the MSD expansion.
Norm of ci vector (sum of ci^2): 9.999735e-01
Norm of qchem ci vector (sum of qchem_ci^2): 0.000000e+00
Found 24 unique up determinants.
Found 24 unique down determinants.
Number of terms in pairs array: 12
Number of terms in pairs array: 12
CI coefficients are optimizable. 
  FermionWF = MultiSlaterDeterminantFast
  QMCHamiltonian::addOperator Kinetic to H, physical Hamiltonian 
  QMCHamiltonian::addOperator ElecElec to H, physical Hamiltonian 
QMCHamiltonian::addOperatorType added type coulomb named ElecElec

  ECPotential builder for pseudopotential 

  Adding pseudopotential for C
   Linear grid  ri=0.000000e+00 rf=1.000000e+01 npts = 10001
    ECPComponentBuilder::buildSemiLocalAndLocal 
    Assuming Hartree unit
   Number of angular momentum channels 2
   Maximum angular momentum channel 1
   Creating a Linear Grid Rmax=1.405000e+00
  Using global grid with delta = 1.000000e-03
   Making L=1 a local potential with a radial cutoff of 9.999000e+00
    Non-local pseudopotential parameters
    Maximum angular mementum = 0
    Number of non-local channels = 1
       l(0)=0
    Cutoff radius = 1.405000e+00
    Spherical grids and weights: 
         1.0000000000e+00  0.0000000000e+00  0.0000000000e+00    8.3333333333e-02
        -1.0000000000e+00  1.2246467991e-16  0.0000000000e+00    8.3333333333e-02
         4.4721359550e-01  8.9442719100e-01  0.0000000000e+00    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -8.9442719100e-01  1.0953573965e-16    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
    Maximum cutoff radius 1.4050000000e+00

  Adding pseudopotential for O
   Linear grid  ri=0.0000000000e+00 rf=1.0000000000e+01 npts = 10001
    ECPComponentBuilder::buildSemiLocalAndLocal 
    Assuming Hartree unit
   Number of angular momentum channels 2
   Maximum angular momentum channel 1
   Creating a Linear Grid Rmax=1.0750000000e+00
  Using global grid with delta = 1.0000000000e-03
   Making L=1 a local potential with a radial cutoff of 9.9990000000e+00
    Non-local pseudopotential parameters
    Maximum angular mementum = 0
    Number of non-local channels = 1
       l(0)=0
    Cutoff radius = 1.0750000000e+00
    Spherical grids and weights: 
         1.0000000000e+00  0.0000000000e+00  0.0000000000e+00    8.3333333333e-02
        -1.0000000000e+00  1.2246467991e-16  0.0000000000e+00    8.3333333333e-02
         4.4721359550e-01  8.9442719100e-01  0.0000000000e+00    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -8.9442719100e-01  1.0953573965e-16    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
    Maximum cutoff radius 1.0750000000e+00

  Adding pseudopotential for H1
   Linear grid  ri=0.0000000000e+00 rf=1.0000000000e+01 npts = 10001
    ECPComponentBuilder::buildSemiLocalAndLocal 
    Assuming Hartree unit
   Number of angular momentum channels 2
   Maximum angular momentum channel 1
   Creating a Linear Grid Rmax=1.0000000000e-10
  Using global grid with delta = 1.0000000000e-03
   Making L=1 a local potential with a radial cutoff of 9.9990000000e+00
    Non-local pseudopotential parameters
    Maximum angular mementum = 0
    Number of non-local channels = 1
       l(0)=0
    Cutoff radius = 1.0000000000e-03
    Spherical grids and weights: 
         1.0000000000e+00  0.0000000000e+00  0.0000000000e+00    8.3333333333e-02
        -1.0000000000e+00  1.2246467991e-16  0.0000000000e+00    8.3333333333e-02
         4.4721359550e-01  8.9442719100e-01  0.0000000000e+00    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -8.9442719100e-01  1.0953573965e-16    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
    Maximum cutoff radius 1.0000000000e-03

  Adding pseudopotential for H2
   Linear grid  ri=0.0000000000e+00 rf=1.0000000000e+01 npts = 10001
    ECPComponentBuilder::buildSemiLocalAndLocal 
    Assuming Hartree unit
   Number of angular momentum channels 2
   Maximum angular momentum channel 1
   Creating a Linear Grid Rmax=1.0000000000e-10
  Using global grid with delta = 1.0000000000e-03
   Making L=1 a local potential with a radial cutoff of 9.9990000000e+00
    Non-local pseudopotential parameters
    Maximum angular mementum = 0
    Number of non-local channels = 1
       l(0)=0
    Cutoff radius = 1.0000000000e-03
    Spherical grids and weights: 
         1.0000000000e+00  0.0000000000e+00  0.0000000000e+00    8.3333333333e-02
        -1.0000000000e+00  1.2246467991e-16  0.0000000000e+00    8.3333333333e-02
         4.4721359550e-01  8.9442719100e-01  0.0000000000e+00    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -8.9442719100e-01  1.0953573965e-16    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
    Maximum cutoff radius 1.0000000000e-03
  QMCHamiltonian::addOperator LocalECP to H, physical Hamiltonian 

  Using NonLocalECP potential 
    Maximum grid on a sphere for NonLocalECPotential: 12
  QMCHamiltonian::addOperator NonLocalECP to H, physical Hamiltonian 
QMCHamiltonian::addOperatorType added type pseudo named NonLocalECP
  QMCHamiltonian::addOperator IonIon to H, physical Hamiltonian 
QMCHamiltonian::addOperatorType added type coulomb named IonIon

  QMCHamiltonian::add2WalkerProperty added
    5 to P::PropertyList 
    0 to P::Collectables 
    starting Index of the observables in P::PropertyList = 10
ParticleSetPool::randomize 
  Initialization Execution time = 2.7196e-01 secs
=========================================================
 Summary of QMC systems 
=========================================================
ParticleSetPool has: 

  ParticleSet 'e' contains 12 particles :  u(6) d(6)

    u -1.8061669018e+00  2.7837752017e-01 -8.9374600273e-01
    u  6.2204767277e-01 -3.1767951129e-01 -1.6068917470e+00
    u  2.7844543642e-02 -4.6711695757e-01  1.3769739340e+00
    u  5.3613352983e-01 -1.0346031641e-01  1.1931174682e+00
    u  6.6915801034e-01  1.1573235719e+00  1.2719505344e+00
    u  1.8470266426e-02  1.4117662795e+00 -1.6695285925e+00
    d -9.6293909260e-01  1.0337145637e+00 -8.9962839053e-01
    d  1.0744417758e+00  1.1605479134e+00 -1.8930392030e+00
    d  1.2380477230e+00  4.9285421082e-01  8.7082227944e-01
    d  8.1730014770e-01 -3.7289888410e-01  2.8378529985e+00
    (... and 2 more particle positions ...)

  Distance table for similar particles (A-A):
    source/target: e
    Using structure-of-arrays (SoA) data layout
    Distance computations use open boundary conditions in 3D.

  Distance table for dissimilar particles (A-B):
    source: ion0  target: e
    Using structure-of-arrays (SoA) data layout
    Distance computations use open boundary conditions in 3D.


  ParticleSet 'ion0' contains 4 particles :  C(1) O(1) H1(1) H2(1)

    C  0.0000000000e+00  0.0000000000e+00 -1.1394765782e+00
    O  0.0000000000e+00  0.0000000000e+00  1.1440287480e+00
    H1  0.0000000000e+00  1.7662761033e+00 -2.2339863698e+00
    H2  0.0000000000e+00 -1.7662761033e+00 -2.2339863698e+00

  Distance table for similar particles (A-A):
    source/target: ion0
    Using structure-of-arrays (SoA) data layout
    Distance computations use open boundary conditions in 3D.


  Hamiltonian h0
  Kinetic         Kinetic energy
  ElecElec        CoulombAA source/target e

  LocalECP        LocalECPotential: ion0
  NonLocalECP     NonLocalECPotential: ion0
  IonIon          CoulombAA source/target ion0


Loop execution max-interations = 20
Inside LM engine constructor, num_params is: 0 and _total_num_params is: 0

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORMN2JWARM.s000 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15
  Adding 1 walkers to 0 existing sets
  Total number of walkers: 1.2800000000e+02
  Total weight: 1.2800000000e+02

=========================================================
  Start VMC
  File Root FORMN2JWARM.s000 append = no 
=========================================================
Resetting walkers
  Using the current 1 walkers.
  Total number of walkers: 1.2800000000e+02
  Total weight: 1.2800000000e+02
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=0  my_counter=0
  time step      = 5.0000000000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000000000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625000000e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000000000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000000000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000000000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000000000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000000000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000000000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000000000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625000000e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000000000e-02</parameter>
<parameter name="time_step" condition="au">5.0000000000e-02</parameter>
<parameter name="timestep" condition="au">5.0000000000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
  Set drift_modifier UNR parameter a = 1.0000000000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000000000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: 0 and ratio_threshold_: 0.0000000000e+00
Allocating full size _hmat_temp and _smat_temp
Inside LM engine's get_param, num_params is: 76
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 0
    time step          = 0.05
    reference energy   = -22.6657
    reference variance = 0.357073
====================================================
  Execution time = 2.6850e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORMN2JWARM.s000
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5282e+04
  VMC Eavg = -2.2661e+01
  VMC Evar = 5.2350e-01
  Total weights = 1.954733612e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.8103e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.509490854066
                                         uncertainty =       0.002710322663

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.509490854066
                                         uncertainty =       0.002710322663

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000504755084
  error estimate for blocks of size 2^( 2) =       0.000524094752
  error estimate for blocks of size 2^( 3) =       0.000541408387
  error estimate for blocks of size 2^( 4) =       0.000553961873
  error estimate for blocks of size 2^( 5) =       0.000561822207
  error estimate for blocks of size 2^( 6) =       0.000566990516
  error estimate for blocks of size 2^( 7) =       0.000567859917

      target function =                  N/A
              le_mean =     -22.661058015942
             les_mean =     514.047052174583
             stat err =       0.000562658628
             autocorr =       1.242592023995
              std dev =       0.713831485875
             le_variance =       0.509555390226


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy-2.266105801594e+01 
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.5000e-01, overlap shift 2.5000e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.661058016102       residual = 1.47e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.664271414226       residual = 4.13e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.664366880862       residual = 6.72e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.664369676392       residual = 1.81e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.664369732638       residual = 4.54e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          4 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 2.5000e-01 is 1.408800e-02

solving harmonic davidson linear method for identity shift 1.0000e+00, overlap shift 1.0000e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.661058016102       residual = 1.47e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.662296557948       residual = 2.62e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.662317972670       residual = 1.76e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.662318429685       residual = 2.65e-08           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.662318418053       residual = 6.06e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          4 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 1.0000e+00 is 5.607944e-03

solving harmonic davidson linear method for identity shift 4.0000e+00, overlap shift 4.0000e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.661058016102       residual = 1.47e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.661416101108       residual = 2.30e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.661421319366       residual = 3.19e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.661421457254       residual = 3.87e-08           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.661421458831       residual = 7.41e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          4 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 4.0000e+00 is 1.645534e-03

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.004330 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.1670e+01
  </log>
  <optVariables href="FORMN2JWARM.s000.opt.xml">
ci_001 -7.009880e-01                3 1 ON  0
ci_002 -7.008238e-01                3 1 ON  1
ci_003 -6.078118e-02                3 1 ON  2
ci_004 -6.098323e-02                3 1 ON  3
ci_005 3.994303e-02                 3 1 ON  4
ci_006 3.982576e-02                 3 1 ON  5
ci_007 2.895585e-02                 3 1 ON  6
ci_008 2.927616e-02                 3 1 ON  7
ci_009 -2.287831e-02                3 1 ON  8
ci_010 -2.269534e-02                3 1 ON  9
ci_011 -2.061299e-02                3 1 ON  10
ci_012 -2.049030e-02                3 1 ON  11
ci_013 1.863600e-02                 3 1 ON  12
ci_014 1.861740e-02                 3 1 ON  13
ci_015 1.908289e-02                 3 1 ON  14
ci_016 1.918136e-02                 3 1 ON  15
ci_017 1.475622e-02                 3 1 ON  16
ci_018 1.483870e-02                 3 1 ON  17
ci_019 9.075536e-03                 3 1 ON  18
ci_020 9.151810e-03                 3 1 ON  19
ci_021 -9.478877e-03                3 1 ON  20
ci_022 -9.679080e-03                3 1 ON  21
ci_023 8.811605e-03                 3 1 ON  22
ci_024 8.554269e-03                 3 1 ON  23
ci_025 7.270836e-03                 3 1 ON  24
ci_026 7.282607e-03                 3 1 ON  25
ci_027 7.370347e-03                 3 1 ON  26
ci_028 7.553058e-03                 3 1 ON  27
ci_029 -7.520687e-03                3 1 ON  28
ci_030 -7.786286e-03                3 1 ON  29
ci_031 -7.609398e-03                3 1 ON  30
ci_032 -7.566131e-03                3 1 ON  31
ci_033 6.664100e-03                 3 1 ON  32
ci_034 6.560757e-03                 3 1 ON  33
ci_035 5.641126e-03                 3 1 ON  34
ci_036 5.703711e-03                 3 1 ON  35
ci_037 6.527547e-03                 3 1 ON  36
ci_038 6.508391e-03                 3 1 ON  37
ci_039 5.367523e-03                 3 1 ON  38
ci_040 5.405307e-03                 3 1 ON  39
ci_041 5.116436e-03                 3 1 ON  40
ci_042 4.792969e-03                 3 1 ON  41
ci_043 5.126887e-03                 3 1 ON  42
ci_044 5.128646e-03                 3 1 ON  43
ci_045 4.503511e-03                 3 1 ON  44
ci_046 4.384968e-03                 3 1 ON  45
ci_047 -3.724115e-03                3 1 ON  46
ci_048 -3.836648e-03                3 1 ON  47
ci_049 3.066552e-03                 3 1 ON  48
ci_050 3.145882e-03                 3 1 ON  49
ci_051 -3.096156e-03                3 1 ON  50
ci_052 -3.066687e-03                3 1 ON  51
ci_053 -2.556768e-03                3 1 ON  52
ci_054 -2.605657e-03                3 1 ON  53
ci_055 -2.196404e-03                3 1 ON  54
ci_056 -2.029479e-03                3 1 ON  55
ci_057 -2.156853e-03                3 1 ON  56
ci_058 -2.042989e-03                3 1 ON  57
ci_059 -1.296045e-03                3 1 ON  58
ci_060 -1.074800e-03                3 1 ON  59
ci_061 -1.390561e-03                3 1 ON  60
ci_062 -1.461855e-03                3 1 ON  61
ci_063 -9.914797e-04                3 1 ON  62
ci_064 -1.127141e-03                3 1 ON  63
ci_065 -1.591716e-03                3 1 ON  64
ci_066 -1.668684e-03                3 1 ON  65
ci_067 -1.346173e-03                3 1 ON  66
ci_068 -1.448709e-03                3 1 ON  67
ci_069 1.057572e-03                 3 1 ON  68
ci_070 9.536433e-04                 3 1 ON  69
ci_071 -1.504238e-03                3 1 ON  70
ci_072 -1.471293e-03                3 1 ON  71
ci_073 8.836600e-04                 3 1 ON  72
ci_074 1.106608e-03                 3 1 ON  73
ci_075 -6.948202e-04                3 1 ON  74
ci_076 -1.047075e-03                3 1 ON  75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 0
    time step          = 0.05
    reference energy   = -22.7086
    reference variance = 0.59928
====================================================
  Execution time = 2.5703e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORMN2JWARM.s000
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2665e+01
  VMC Evar = 5.1240e-01
  Total weights = 1.9548e+06
  Execution time = 3.6664e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.509973456366
                                         uncertainty =       0.002548768825

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.509973456366
                                         uncertainty =       0.002548768825

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000505098944
  error estimate for blocks of size 2^( 2) =       0.000524099355
  error estimate for blocks of size 2^( 3) =       0.000541171766
  error estimate for blocks of size 2^( 4) =       0.000554113550
  error estimate for blocks of size 2^( 5) =       0.000560955579
  error estimate for blocks of size 2^( 6) =       0.000564240832
  error estimate for blocks of size 2^( 7) =       0.000566915274

      target function =                  N/A
              le_mean =     -22.665147506451
             les_mean =     514.253325295201
             stat err =       0.000561556309
             autocorr =       1.236043342719
              std dev =       0.714317777088
             le_variance =       0.510249886663

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       6.737600348530
                                         uncertainty =       6.207629803363

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       6.737600348530
                                         uncertainty =       6.207629803363

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001831393822
  error estimate for blocks of size 2^( 2) =       0.001836364189
  error estimate for blocks of size 2^( 3) =       0.001841029258
  error estimate for blocks of size 2^( 4) =       0.001844439822
  error estimate for blocks of size 2^( 5) =       0.001848027706
  error estimate for blocks of size 2^( 6) =       0.001844469101
  error estimate for blocks of size 2^( 7) =       0.001845643192

      target function =                  N/A
              le_mean =     -22.663598288629
             les_mean =     976.299469378358
             stat err =       0.001845644955
             autocorr =       1.015623708643
              std dev =       2.589981980599
             le_variance =       6.708006659828

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.492289441367
                                         uncertainty =       0.002218258767

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.492289441367
                                         uncertainty =       0.002218258767

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000496248583
  error estimate for blocks of size 2^( 2) =       0.000514706178
  error estimate for blocks of size 2^( 3) =       0.000531203668
  error estimate for blocks of size 2^( 4) =       0.000543750305
  error estimate for blocks of size 2^( 5) =       0.000550528990
  error estimate for blocks of size 2^( 6) =       0.000553984864
  error estimate for blocks of size 2^( 7) =       0.000556319621

      target function =                  N/A
              le_mean =     -22.665047152237
             les_mean =     514.234231210832
             stat err =       0.000551145945
             autocorr =       1.233487272902
              std dev =       0.701801476857
             le_variance =       0.492525312918

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.507461447395
                                         uncertainty =       0.003041837018

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.507461447395
                                         uncertainty =       0.003041837018

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000503848700
  error estimate for blocks of size 2^( 2) =       0.000522730171
  error estimate for blocks of size 2^( 3) =       0.000539729394
  error estimate for blocks of size 2^( 4) =       0.000552643685
  error estimate for blocks of size 2^( 5) =       0.000559504703
  error estimate for blocks of size 2^( 6) =       0.000562930042
  error estimate for blocks of size 2^( 7) =       0.000565406123

      target function =                  N/A
              le_mean =     -22.665025143313
             les_mean =     514.269222383316
             stat err =       0.000560121138
             autocorr =       1.235843965685
              std dev =       0.712549664246
             le_variance =       0.507727024018


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.665147506451        initial  <--
     2.5000e-01     2.5000e+00             1.4088e-02       -22.663598288629
     1.0000e+00     1.0000e+01             5.6079e-03       -22.665047152237
     4.0000e+00     4.0000e+01             1.6455e-03       -22.665025143313

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 44.0241
  </log>
  <optVariables href="FORMN2JWARM.s000.opt.xml">
ci_001                -7.000338e-01 3 1  ON 0
ci_002                -7.000338e-01 3 1  ON 1
ci_003                -6.200080e-02 3 1  ON 2
ci_004                -6.200080e-02 3 1  ON 3
ci_005                 4.543370e-02 3 1  ON 4
ci_006                 4.543370e-02 3 1  ON 5
ci_007                 3.187170e-02 3 1  ON 6
ci_008                 3.187170e-02 3 1  ON 7
ci_009                -2.491610e-02 3 1  ON 8
ci_010                -2.491610e-02 3 1  ON 9
ci_011                -2.256010e-02 3 1  ON 10
ci_012                -2.256010e-02 3 1  ON 11
ci_013                 2.027620e-02 3 1  ON 12
ci_014                 2.027620e-02 3 1  ON 13
ci_015                 1.994230e-02 3 1  ON 14
ci_016                 1.994230e-02 3 1  ON 15
ci_017                 1.558770e-02 3 1  ON 16
ci_018                 1.558770e-02 3 1  ON 17
ci_019                 1.005290e-02 3 1  ON 18
ci_020                 1.005290e-02 3 1  ON 19
ci_021                -9.889300e-03 3 1  ON 20
ci_022                -9.889300e-03 3 1  ON 21
ci_023                 8.697600e-03 3 1  ON 22
ci_024                 8.697600e-03 3 1  ON 23
ci_025                 7.905100e-03 3 1  ON 24
ci_026                 7.905100e-03 3 1  ON 25
ci_027                 7.889000e-03 3 1  ON 26
ci_028                 7.889000e-03 3 1  ON 27
ci_029                -7.870500e-03 3 1  ON 28
ci_030                -7.870500e-03 3 1  ON 29
ci_031                -7.682600e-03 3 1  ON 30
ci_032                -7.682600e-03 3 1  ON 31
ci_033                 6.955600e-03 3 1  ON 32
ci_034                 6.955600e-03 3 1  ON 33
ci_035                 6.605900e-03 3 1  ON 34
ci_036                 6.605900e-03 3 1  ON 35
ci_037                 6.605400e-03 3 1  ON 36
ci_038                 6.605400e-03 3 1  ON 37
ci_039                 5.598400e-03 3 1  ON 38
ci_040                 5.598400e-03 3 1  ON 39
ci_041                 5.064900e-03 3 1  ON 40
ci_042                 5.064900e-03 3 1  ON 41
ci_043                 5.031900e-03 3 1  ON 42
ci_044                 5.031900e-03 3 1  ON 43
ci_045                 4.995600e-03 3 1  ON 44
ci_046                 4.995600e-03 3 1  ON 45
ci_047                -4.275200e-03 3 1  ON 46
ci_048                -4.275200e-03 3 1  ON 47
ci_049                 3.307200e-03 3 1  ON 48
ci_050                 3.307200e-03 3 1  ON 49
ci_051                -2.875000e-03 3 1  ON 50
ci_052                -2.875000e-03 3 1  ON 51
ci_053                -2.751300e-03 3 1  ON 52
ci_054                -2.751300e-03 3 1  ON 53
ci_055                -2.284000e-03 3 1  ON 54
ci_056                -2.284000e-03 3 1  ON 55
ci_057                -1.974000e-03 3 1  ON 56
ci_058                -1.974000e-03 3 1  ON 57
ci_059                -1.850500e-03 3 1  ON 58
ci_060                -1.850500e-03 3 1  ON 59
ci_061                -1.573500e-03 3 1  ON 60
ci_062                -1.573500e-03 3 1  ON 61
ci_063                -1.435800e-03 3 1  ON 62
ci_064                -1.435800e-03 3 1  ON 63
ci_065                -1.344900e-03 3 1  ON 64
ci_066                -1.344900e-03 3 1  ON 65
ci_067                -1.315500e-03 3 1  ON 66
ci_068                -1.315500e-03 3 1  ON 67
ci_069                 1.200800e-03 3 1  ON 68
ci_070                 1.200800e-03 3 1  ON 69
ci_071                -1.156900e-03 3 1  ON 70
ci_072                -1.156900e-03 3 1  ON 71
ci_073                 1.065300e-03 3 1  ON 72
ci_074                 1.065300e-03 3 1  ON 73
ci_075                -1.008700e-03 3 1  ON 74
ci_076                -1.008700e-03 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.5700e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORMN2JWARM.s001 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORMN2JWARM.s001 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=1  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2687e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 1
    time step          = 0.05
    reference energy   = -22.6736
    reference variance = 0.294438
====================================================
  Execution time = 2.6017e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORMN2JWARM.s001
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5265e+04
  VMC Eavg = -2.2662e+01
  VMC Evar = 5.2226e-01
  Total weights = 1.954601788e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.7844e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.510694971257
                                         uncertainty =       0.002775061574

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.510694971257
                                         uncertainty =       0.002775061574

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000505293058
  error estimate for blocks of size 2^( 2) =       0.000524375678
  error estimate for blocks of size 2^( 3) =       0.000540947531
  error estimate for blocks of size 2^( 4) =       0.000553505926
  error estimate for blocks of size 2^( 5) =       0.000560437445
  error estimate for blocks of size 2^( 6) =       0.000566094460
  error estimate for blocks of size 2^( 7) =       0.000569021582

      target function =                  N/A
              le_mean =     -22.662391725616
             les_mean =     514.106257519355
             stat err =       0.000562264853
             autocorr =       1.238212574482
              std dev =       0.714592296071
             le_variance =       0.510642149603


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266239172562e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.5000e+00, overlap shift 2.5000e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.662391725783       residual = 1.45e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.662960630832       residual = 2.39e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.662971602658       residual = 3.05e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.662971687621       residual = 3.82e-08           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.662971712352       residual = 8.88e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          4 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 2.5000e+00 is 2.546907e-03

solving harmonic davidson linear method for identity shift 1.0000e+01, overlap shift 1.0000e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.662391725783       residual = 1.45e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.662543089882       residual = 2.28e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.662545859364       residual = 4.50e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.662545893573       residual = 4.66e-08           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.662545900475       residual = 1.18e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          4 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 1.0000e+01 is 6.821959e-04

solving harmonic davidson linear method for identity shift 4.0000e+01, overlap shift 4.0000e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.662391725783       residual = 1.45e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.662430184405       residual = 2.26e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.662430879776       residual = 4.97e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.662430889499       residual = 4.98e-08           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.662430891269       residual = 1.30e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          4 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 4.0000e+01 is 1.736476e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.005977 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0807e+01
  </log>
  <optVariables href="FORMN2JWARM.s001.opt.xml">
ci_001                -7.001356e-01 3 1  ON 0
ci_002                -7.001360e-01 3 1  ON 1
ci_003                -6.185484e-02 3 1  ON 2
ci_004                -6.186608e-02 3 1  ON 3
ci_005                 4.477414e-02 3 1  ON 4
ci_006                 4.475150e-02 3 1  ON 5
ci_007                 3.153931e-02 3 1  ON 6
ci_008                 3.154051e-02 3 1  ON 7
ci_009                -2.467923e-02 3 1  ON 8
ci_010                -2.466055e-02 3 1  ON 9
ci_011                -2.233923e-02 3 1  ON 10
ci_012                -2.235554e-02 3 1  ON 11
ci_013                 2.008089e-02 3 1  ON 12
ci_014                 2.010369e-02 3 1  ON 13
ci_015                 1.987011e-02 3 1  ON 14
ci_016                 1.985978e-02 3 1  ON 15
ci_017                 1.548846e-02 3 1  ON 16
ci_018                 1.551083e-02 3 1  ON 17
ci_019                 9.942492e-03 3 1  ON 18
ci_020                 9.951713e-03 3 1  ON 19
ci_021                -9.859842e-03 3 1  ON 20
ci_022                -9.846122e-03 3 1  ON 21
ci_023                 8.683197e-03 3 1  ON 22
ci_024                 8.693007e-03 3 1  ON 23
ci_025                 7.830046e-03 3 1  ON 24
ci_026                 7.825029e-03 3 1  ON 25
ci_027                 7.851921e-03 3 1  ON 26
ci_028                 7.866025e-03 3 1  ON 27
ci_029                -7.831018e-03 3 1  ON 28
ci_030                -7.866208e-03 3 1  ON 29
ci_031                -7.688239e-03 3 1  ON 30
ci_032                -7.660255e-03 3 1  ON 31
ci_033                 6.937337e-03 3 1  ON 32
ci_034                 6.964007e-03 3 1  ON 33
ci_035                 6.482301e-03 3 1  ON 34
ci_036                 6.495636e-03 3 1  ON 35
ci_037                 6.612766e-03 3 1  ON 36
ci_038                 6.592317e-03 3 1  ON 37
ci_039                 5.610105e-03 3 1  ON 38
ci_040                 5.599846e-03 3 1  ON 39
ci_041                 5.048672e-03 3 1  ON 40
ci_042                 5.045613e-03 3 1  ON 41
ci_043                 5.077993e-03 3 1  ON 42
ci_044                 5.066008e-03 3 1  ON 43
ci_045                 4.958559e-03 3 1  ON 44
ci_046                 4.966260e-03 3 1  ON 45
ci_047                -4.198547e-03 3 1  ON 46
ci_048                -4.191844e-03 3 1  ON 47
ci_049                 3.261871e-03 3 1  ON 48
ci_050                 3.261184e-03 3 1  ON 49
ci_051                -2.909318e-03 3 1  ON 50
ci_052                -2.919790e-03 3 1  ON 51
ci_053                -2.696451e-03 3 1  ON 52
ci_054                -2.718896e-03 3 1  ON 53
ci_055                -2.270661e-03 3 1  ON 54
ci_056                -2.283239e-03 3 1  ON 55
ci_057                -1.973021e-03 3 1  ON 56
ci_058                -1.962790e-03 3 1  ON 57
ci_059                -1.796749e-03 3 1  ON 58
ci_060                -1.773415e-03 3 1  ON 59
ci_061                -1.563400e-03 3 1  ON 60
ci_062                -1.540967e-03 3 1  ON 61
ci_063                -1.388760e-03 3 1  ON 62
ci_064                -1.434368e-03 3 1  ON 63
ci_065                -1.384651e-03 3 1  ON 64
ci_066                -1.379053e-03 3 1  ON 65
ci_067                -1.304561e-03 3 1  ON 66
ci_068                -1.324608e-03 3 1  ON 67
ci_069                 1.169223e-03 3 1  ON 68
ci_070                 1.192207e-03 3 1  ON 69
ci_071                -1.200254e-03 3 1  ON 70
ci_072                -1.199487e-03 3 1  ON 71
ci_073                 1.067609e-03 3 1  ON 72
ci_074                 1.055756e-03 3 1  ON 73
ci_075                -9.909345e-04 3 1  ON 74
ci_076                -1.026771e-03 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 1
    time step          = 0.05
    reference energy   = -22.6772
    reference variance = 0.424229
====================================================
  Execution time = 2.5368e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORMN2JWARM.s001
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2661e+01
  VMC Evar = 5.2145e-01
  Total weights = 1.9547e+06
  Execution time = 3.6867e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.511651540741
                                         uncertainty =       0.003416355209

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.511651540741
                                         uncertainty =       0.003416355209

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000505772236
  error estimate for blocks of size 2^( 2) =       0.000525081286
  error estimate for blocks of size 2^( 3) =       0.000542103474
  error estimate for blocks of size 2^( 4) =       0.000554780125
  error estimate for blocks of size 2^( 5) =       0.000562236433
  error estimate for blocks of size 2^( 6) =       0.000564388171
  error estimate for blocks of size 2^( 7) =       0.000565920476

      target function =                  N/A
              le_mean =     -22.661502175247
             les_mean =     514.067160517313
             stat err =       0.000561831301
             autocorr =       1.233962303170
              std dev =       0.715269955336
             le_variance =       0.511611109006

ERROR CostFunction-> Number of Effective Walkers is too small! 
  Number of effective walkers (samples) / total number of samples = 0.0839609
  User specified threshold minwalkers = 0.3
  If this message appears frequently. You might have to be cautious. 
  Find info about parameter "minwalkers" in the user manual!
Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.507399708445
                                         uncertainty =       0.003279777036

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.507399708445
                                         uncertainty =       0.003279777036

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000503665792
  error estimate for blocks of size 2^( 2) =       0.000522834548
  error estimate for blocks of size 2^( 3) =       0.000539727566
  error estimate for blocks of size 2^( 4) =       0.000552308356
  error estimate for blocks of size 2^( 5) =       0.000559733309
  error estimate for blocks of size 2^( 6) =       0.000561879827
  error estimate for blocks of size 2^( 7) =       0.000563417781

      target function =                  N/A
              le_mean =     -22.661524972139
             les_mean =     514.063739792854
             stat err =       0.000559334818
             autocorr =       1.233271795088
              std dev =       0.712290993394
             le_variance =       0.507358459270

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.509294317205
                                         uncertainty =       0.003336999357

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.509294317205
                                         uncertainty =       0.003336999357

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000504605518
  error estimate for blocks of size 2^( 2) =       0.000523838194
  error estimate for blocks of size 2^( 3) =       0.000540792612
  error estimate for blocks of size 2^( 4) =       0.000553421857
  error estimate for blocks of size 2^( 5) =       0.000560861921
  error estimate for blocks of size 2^( 6) =       0.000563010196
  error estimate for blocks of size 2^( 7) =       0.000564550202

      target function =                  N/A
              le_mean =     -22.661500626922
             les_mean =     514.070474618122
             stat err =       0.000560461044
             autocorr =       1.233635538635
              std dev =       0.713619967275
             le_variance =       0.509253457694

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.511337468174
                                         uncertainty =       0.003405548100

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.511337468174
                                         uncertainty =       0.003405548100

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000505616944
  error estimate for blocks of size 2^( 2) =       0.000524916273
  error estimate for blocks of size 2^( 3) =       0.000541929541
  error estimate for blocks of size 2^( 4) =       0.000554601077
  error estimate for blocks of size 2^( 5) =       0.000562054201
  error estimate for blocks of size 2^( 6) =       0.000564203672
  error estimate for blocks of size 2^( 7) =       0.000565737296

      target function =                  N/A
              le_mean =     -22.661500158383
             les_mean =     514.066146570242
             stat err =       0.000561649062
             autocorr =       1.233919526206
              std dev =       0.715050339348
             le_variance =       0.511296987801


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.661502175247        initial
     2.5000e+00     2.5000e+01             2.5469e-03       -22.661524972139  <--
     1.0000e+01     1.0000e+02             6.8220e-04       -22.661500626922
     4.0000e+01     4.0000e+02             1.7365e-04       -22.661500158383

*****************************************************************************
Applying the update for shift_i =   2.5000e+00     and shift_s =   2.5000e+01
*****************************************************************************

  Execution time = 4.3794e+01
  </log>
  <optVariables href="FORMN2JWARM.s001.opt.xml">
ci_001                -7.004196e-01 3 1  ON 0
ci_002                -7.004210e-01 3 1  ON 1
ci_003                -6.142811e-02 3 1  ON 2
ci_004                -6.147248e-02 3 1  ON 3
ci_005                 4.297173e-02 3 1  ON 4
ci_006                 4.288679e-02 3 1  ON 5
ci_007                 3.060876e-02 3 1  ON 6
ci_008                 3.061339e-02 3 1  ON 7
ci_009                -2.401921e-02 3 1  ON 8
ci_010                -2.394800e-02 3 1  ON 9
ci_011                -2.171867e-02 3 1  ON 10
ci_012                -2.178027e-02 3 1  ON 11
ci_013                 1.953322e-02 3 1  ON 12
ci_014                 1.961900e-02 3 1  ON 13
ci_015                 1.966377e-02 3 1  ON 14
ci_016                 1.962301e-02 3 1  ON 15
ci_017                 1.520983e-02 3 1  ON 16
ci_018                 1.529511e-02 3 1  ON 17
ci_019                 9.622044e-03 3 1  ON 18
ci_020                 9.657068e-03 3 1  ON 19
ci_021                -9.777562e-03 3 1  ON 20
ci_022                -9.724957e-03 3 1  ON 21
ci_023                 8.644689e-03 3 1  ON 22
ci_024                 8.682013e-03 3 1  ON 23
ci_025                 7.620092e-03 3 1  ON 24
ci_026                 7.600767e-03 3 1  ON 25
ci_027                 7.755473e-03 3 1  ON 26
ci_028                 7.808398e-03 3 1  ON 27
ci_029                -7.714166e-03 3 1  ON 28
ci_030                -7.847702e-03 3 1  ON 29
ci_031                -7.706089e-03 3 1  ON 30
ci_032                -7.598616e-03 3 1  ON 31
ci_033                 6.886009e-03 3 1  ON 32
ci_034                 6.986532e-03 3 1  ON 33
ci_035                 6.145944e-03 3 1  ON 34
ci_036                 6.196952e-03 3 1  ON 35
ci_037                 6.629438e-03 3 1  ON 36
ci_038                 6.552043e-03 3 1  ON 37
ci_039                 5.644215e-03 3 1  ON 38
ci_040                 5.606580e-03 3 1  ON 39
ci_041                 5.004724e-03 3 1  ON 40
ci_042                 4.993825e-03 3 1  ON 41
ci_043                 5.203232e-03 3 1  ON 42
ci_044                 5.157707e-03 3 1  ON 43
ci_045                 4.856685e-03 3 1  ON 44
ci_046                 4.884052e-03 3 1  ON 45
ci_047                -3.986099e-03 3 1  ON 46
ci_048                -3.961935e-03 3 1  ON 47
ci_049                 3.133240e-03 3 1  ON 48
ci_050                 3.130140e-03 3 1  ON 49
ci_051                -2.996064e-03 3 1  ON 50
ci_052                -3.036940e-03 3 1  ON 51
ci_053                -2.545434e-03 3 1  ON 52
ci_054                -2.631479e-03 3 1  ON 53
ci_055                -2.233583e-03 3 1  ON 54
ci_056                -2.280929e-03 3 1  ON 55
ci_057                -1.969047e-03 3 1  ON 56
ci_058                -1.931390e-03 3 1  ON 57
ci_059                -1.655424e-03 3 1  ON 58
ci_060                -1.567575e-03 3 1  ON 59
ci_061                -1.534917e-03 3 1  ON 60
ci_062                -1.450523e-03 3 1  ON 61
ci_063                -1.259939e-03 3 1  ON 62
ci_064                -1.432878e-03 3 1  ON 63
ci_065                -1.493371e-03 3 1  ON 64
ci_066                -1.470744e-03 3 1  ON 65
ci_067                -1.275034e-03 3 1  ON 66
ci_068                -1.349981e-03 3 1  ON 67
ci_069                 1.080178e-03 3 1  ON 68
ci_070                 1.168959e-03 3 1  ON 69
ci_071                -1.315348e-03 3 1  ON 70
ci_072                -1.312938e-03 3 1  ON 71
ci_073                 1.070719e-03 3 1  ON 72
ci_074                 1.026575e-03 3 1  ON 73
ci_075                -9.409333e-04 3 1  ON 74
ci_076                -1.075912e-03 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.4611e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORMN2JWARM.s002 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORMN2JWARM.s002 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=2  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2681e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 2
    time step          = 0.05
    reference energy   = -22.6222
    reference variance = 0.424219
====================================================
  Execution time = 2.5974e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORMN2JWARM.s002
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5254e+04
  VMC Eavg = -2.2663e+01
  VMC Evar = 5.1401e-01
  Total weights = 1.954609779e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.7913e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.501225253033
                                         uncertainty =       0.002272011169

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.501225253033
                                         uncertainty =       0.002272011169

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000501164119
  error estimate for blocks of size 2^( 2) =       0.000519970896
  error estimate for blocks of size 2^( 3) =       0.000536984392
  error estimate for blocks of size 2^( 4) =       0.000549182739
  error estimate for blocks of size 2^( 5) =       0.000556131909
  error estimate for blocks of size 2^( 6) =       0.000561038138
  error estimate for blocks of size 2^( 7) =       0.000562652838

      target function =                  N/A
              le_mean =     -22.662526409542
             les_mean =     514.104113408513
             stat err =       0.000557251406
             autocorr =       1.236352770339
              std dev =       0.708753093792
             le_variance =       0.502330947959


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266252640954e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.2500e-01, overlap shift 6.2500e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.662526409693       residual = 1.23e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.664056097706       residual = 2.71e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.664100221505       residual = 1.99e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.664099715384       residual = 3.68e-08           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.664099864399       residual = 1.18e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          4 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 6.2500e-01 is 7.366465e-03

solving harmonic davidson linear method for identity shift 2.5000e+00, overlap shift 2.5000e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.662526409693       residual = 1.23e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.663000105229       residual = 2.15e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.663011339581       residual = 3.04e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.663011283045       residual = 3.70e-08           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.663011301544       residual = 8.98e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          4 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 2.5000e+00 is 2.330797e-03

solving harmonic davidson linear method for identity shift 1.0000e+01, overlap shift 1.0000e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.662526409693       residual = 1.23e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.662652343794       residual = 2.05e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.662655205279       residual = 4.25e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.662655210074       residual = 4.05e-08           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.662655213108       residual = 9.87e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          4 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 1.0000e+01 is 6.241024e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.010937 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0777e+01
  </log>
  <optVariables href="FORMN2JWARM.s002.opt.xml">
ci_001                -7.007231e-01 3 1  ON 0
ci_002                -7.008004e-01 3 1  ON 1
ci_003                -6.089793e-02 3 1  ON 2
ci_004                -6.100739e-02 3 1  ON 3
ci_005                 4.076253e-02 3 1  ON 4
ci_006                 4.055600e-02 3 1  ON 5
ci_007                 2.951783e-02 3 1  ON 6
ci_008                 2.954282e-02 3 1  ON 7
ci_009                -2.309103e-02 3 1  ON 8
ci_010                -2.307556e-02 3 1  ON 9
ci_011                -2.094650e-02 3 1  ON 10
ci_012                -2.101235e-02 3 1  ON 11
ci_013                 1.882802e-02 3 1  ON 12
ci_014                 1.897041e-02 3 1  ON 13
ci_015                 1.932666e-02 3 1  ON 14
ci_016                 1.936865e-02 3 1  ON 15
ci_017                 1.481043e-02 3 1  ON 16
ci_018                 1.501902e-02 3 1  ON 17
ci_019                 9.203073e-03 3 1  ON 18
ci_020                 9.262836e-03 3 1  ON 19
ci_021                -9.621749e-03 3 1  ON 20
ci_022                -9.552842e-03 3 1  ON 21
ci_023                 8.733876e-03 3 1  ON 22
ci_024                 8.579153e-03 3 1  ON 23
ci_025                 7.365552e-03 3 1  ON 24
ci_026                 7.374832e-03 3 1  ON 25
ci_027                 7.666553e-03 3 1  ON 26
ci_028                 7.689412e-03 3 1  ON 27
ci_029                -7.551703e-03 3 1  ON 28
ci_030                -7.699620e-03 3 1  ON 29
ci_031                -7.774993e-03 3 1  ON 30
ci_032                -7.623546e-03 3 1  ON 31
ci_033                 6.726423e-03 3 1  ON 32
ci_034                 6.807219e-03 3 1  ON 33
ci_035                 5.727315e-03 3 1  ON 34
ci_036                 5.751873e-03 3 1  ON 35
ci_037                 6.658935e-03 3 1  ON 36
ci_038                 6.626917e-03 3 1  ON 37
ci_039                 5.580115e-03 3 1  ON 38
ci_040                 5.604913e-03 3 1  ON 39
ci_041                 4.894296e-03 3 1  ON 40
ci_042                 4.965971e-03 3 1  ON 41
ci_043                 5.341336e-03 3 1  ON 42
ci_044                 5.172998e-03 3 1  ON 43
ci_045                 4.751224e-03 3 1  ON 44
ci_046                 4.748764e-03 3 1  ON 45
ci_047                -3.741501e-03 3 1  ON 46
ci_048                -3.719988e-03 3 1  ON 47
ci_049                 2.791801e-03 3 1  ON 48
ci_050                 3.007306e-03 3 1  ON 49
ci_051                -2.980615e-03 3 1  ON 50
ci_052                -3.093808e-03 3 1  ON 51
ci_053                -2.534947e-03 3 1  ON 52
ci_054                -2.477444e-03 3 1  ON 53
ci_055                -2.165809e-03 3 1  ON 54
ci_056                -2.243331e-03 3 1  ON 55
ci_057                -1.900597e-03 3 1  ON 56
ci_058                -1.915398e-03 3 1  ON 57
ci_059                -1.483361e-03 3 1  ON 58
ci_060                -1.332457e-03 3 1  ON 59
ci_061                -1.390005e-03 3 1  ON 60
ci_062                -1.415775e-03 3 1  ON 61
ci_063                -1.212743e-03 3 1  ON 62
ci_064                -1.346173e-03 3 1  ON 63
ci_065                -1.619665e-03 3 1  ON 64
ci_066                -1.598045e-03 3 1  ON 65
ci_067                -1.456017e-03 3 1  ON 66
ci_068                -1.357701e-03 3 1  ON 67
ci_069                 1.065761e-03 3 1  ON 68
ci_070                 1.131703e-03 3 1  ON 69
ci_071                -1.467350e-03 3 1  ON 70
ci_072                -1.416360e-03 3 1  ON 71
ci_073                 9.998049e-04 3 1  ON 72
ci_074                 9.839873e-04 3 1  ON 73
ci_075                -9.115179e-04 3 1  ON 74
ci_076                -1.101105e-03 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 2
    time step          = 0.05
    reference energy   = -22.5423
    reference variance = 0.284837
====================================================
  Execution time = 2.5325e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORMN2JWARM.s002
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2664e+01
  VMC Evar = 5.1616e-01
  Total weights = 1.9548e+06
  Execution time = 3.6781e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.507333043062
                                         uncertainty =       0.002928930827

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.507333043062
                                         uncertainty =       0.002928930827

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000503640600
  error estimate for blocks of size 2^( 2) =       0.000522526457
  error estimate for blocks of size 2^( 3) =       0.000539889162
  error estimate for blocks of size 2^( 4) =       0.000551416441
  error estimate for blocks of size 2^( 5) =       0.000559192460
  error estimate for blocks of size 2^( 6) =       0.000564819518
  error estimate for blocks of size 2^( 7) =       0.000567469951

      target function =                  N/A
              le_mean =     -22.663740751392
             les_mean =     514.175869078116
             stat err =       0.000560724593
             autocorr =       1.239531999632
              std dev =       0.712255367079
             le_variance =       0.507307707933

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.498474612305
                                         uncertainty =       0.003042234691

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.498474612305
                                         uncertainty =       0.003042234691

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000499220198
  error estimate for blocks of size 2^( 2) =       0.000517769764
  error estimate for blocks of size 2^( 3) =       0.000534887257
  error estimate for blocks of size 2^( 4) =       0.000546210174
  error estimate for blocks of size 2^( 5) =       0.000553909691
  error estimate for blocks of size 2^( 6) =       0.000559413706
  error estimate for blocks of size 2^( 7) =       0.000562034689

      target function =                  N/A
              le_mean =     -22.663868115227
             les_mean =     514.291722466723
             stat err =       0.000555392065
             autocorr =       1.237699012812
              std dev =       0.706003974769
             le_variance =       0.498441612389

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.500715438678
                                         uncertainty =       0.002961367471

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.500715438678
                                         uncertainty =       0.002961367471

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000500343520
  error estimate for blocks of size 2^( 2) =       0.000519003284
  error estimate for blocks of size 2^( 3) =       0.000536192836
  error estimate for blocks of size 2^( 4) =       0.000547602015
  error estimate for blocks of size 2^( 5) =       0.000555308781
  error estimate for blocks of size 2^( 6) =       0.000560878501
  error estimate for blocks of size 2^( 7) =       0.000563494097

      target function =                  N/A
              le_mean =     -22.663726604859
             les_mean =     514.159678107132
             stat err =       0.000556820849
             autocorr =       1.238495454353
              std dev =       0.707592591449
             le_variance =       0.500687275474

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.506241841956
                                         uncertainty =       0.002933113465

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.506241841956
                                         uncertainty =       0.002933113465

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000503098488
  error estimate for blocks of size 2^( 2) =       0.000521944277
  error estimate for blocks of size 2^( 3) =       0.000539281112
  error estimate for blocks of size 2^( 4) =       0.000550793761
  error estimate for blocks of size 2^( 5) =       0.000558581451
  error estimate for blocks of size 2^( 6) =       0.000564234735
  error estimate for blocks of size 2^( 7) =       0.000566876412

      target function =                  N/A
              le_mean =     -22.663721654148
             les_mean =     514.166674601120
             stat err =       0.000560121590
             autocorr =       1.239534447857
              std dev =       0.711488705405
             le_variance =       0.506216177919


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.663740751392        initial
     6.2500e-01     6.2500e+00             7.3665e-03       -22.663868115227  <--
     2.5000e+00     2.5000e+01             2.3308e-03       -22.663726604859
     1.0000e+01     1.0000e+02             6.2410e-04       -22.663721654148

*****************************************************************************
Applying the update for shift_i =   6.2500e-01     and shift_s =   6.2500e+00
*****************************************************************************

  Execution time = 4.3691e+01
  </log>
  <optVariables href="FORMN2JWARM.s002.opt.xml">
ci_001                -7.014032e-01 3 1  ON 0
ci_002                -7.017064e-01 3 1  ON 1
ci_003                -5.945865e-02 3 1  ON 2
ci_004                -5.974315e-02 3 1  ON 3
ci_005                 3.598867e-02 3 1  ON 4
ci_006                 3.552033e-02 3 1  ON 5
ci_007                 2.696447e-02 3 1  ON 6
ci_008                 2.704662e-02 3 1  ON 7
ci_009                -2.093681e-02 3 1  ON 8
ci_010                -2.105781e-02 3 1  ON 9
ci_011                -1.911557e-02 3 1  ON 10
ci_012                -1.918867e-02 3 1  ON 11
ci_013                 1.716024e-02 3 1  ON 12
ci_014                 1.745186e-02 3 1  ON 13
ci_015                 1.847671e-02 3 1  ON 14
ci_016                 1.873679e-02 3 1  ON 15
ci_017                 1.385855e-02 3 1  ON 16
ci_018                 1.436955e-02 3 1  ON 17
ci_019                 8.103072e-03 3 1  ON 18
ci_020                 8.221132e-03 3 1  ON 19
ci_021                -9.246317e-03 3 1  ON 20
ci_022                -9.137508e-03 3 1  ON 21
ci_023                 8.948132e-03 3 1  ON 22
ci_024                 8.360471e-03 3 1  ON 23
ci_025                 6.780710e-03 3 1  ON 24
ci_026                 6.851785e-03 3 1  ON 25
ci_027                 7.508233e-03 3 1  ON 26
ci_028                 7.478078e-03 3 1  ON 27
ci_029                -7.105034e-03 3 1  ON 28
ci_030                -7.284001e-03 3 1  ON 29
ci_031                -7.957619e-03 3 1  ON 30
ci_032                -7.718197e-03 3 1  ON 31
ci_033                 6.332223e-03 3 1  ON 32
ci_034                 6.379883e-03 3 1  ON 33
ci_035                 4.841966e-03 3 1  ON 34
ci_036                 4.812375e-03 3 1  ON 35
ci_037                 6.687056e-03 3 1  ON 36
ci_038                 6.769333e-03 3 1  ON 37
ci_039                 5.471873e-03 3 1  ON 38
ci_040                 5.628440e-03 3 1  ON 39
ci_041                 4.657970e-03 3 1  ON 40
ci_042                 4.913081e-03 3 1  ON 41
ci_043                 5.617797e-03 3 1  ON 42
ci_044                 5.154894e-03 3 1  ON 43
ci_045                 4.524840e-03 3 1  ON 44
ci_046                 4.458189e-03 3 1  ON 45
ci_047                -3.202093e-03 3 1  ON 46
ci_048                -3.173733e-03 3 1  ON 47
ci_049                 1.975490e-03 3 1  ON 48
ci_050                 2.711397e-03 3 1  ON 49
ci_051                -2.859444e-03 3 1  ON 50
ci_052                -3.146440e-03 3 1  ON 51
ci_053                -2.553828e-03 3 1  ON 52
ci_054                -2.145105e-03 3 1  ON 53
ci_055                -1.987029e-03 3 1  ON 54
ci_056                -2.155981e-03 3 1  ON 55
ci_057                -1.737161e-03 3 1  ON 56
ci_058                -1.876458e-03 3 1  ON 57
ci_059                -1.142935e-03 3 1  ON 58
ci_060                -8.570469e-04 3 1  ON 59
ci_061                -1.037012e-03 3 1  ON 60
ci_062                -1.339559e-03 3 1  ON 61
ci_063                -1.135253e-03 3 1  ON 62
ci_064                -1.173133e-03 3 1  ON 63
ci_065                -1.886696e-03 3 1  ON 64
ci_066                -1.859386e-03 3 1  ON 65
ci_067                -1.898947e-03 3 1  ON 66
ci_068                -1.390913e-03 3 1  ON 67
ci_069                 1.026650e-03 3 1  ON 68
ci_070                 1.044117e-03 3 1  ON 69
ci_071                -1.776696e-03 3 1  ON 70
ci_072                -1.616434e-03 3 1  ON 71
ci_073                 8.297497e-04 3 1  ON 72
ci_074                 8.657253e-04 3 1  ON 73
ci_075                -8.451115e-04 3 1  ON 74
ci_076                -1.155274e-03 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.4484e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORMN2JWARM.s003 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORMN2JWARM.s003 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=3  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2648e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 3
    time step          = 0.05
    reference energy   = -22.6599
    reference variance = 0.412627
====================================================
  Execution time = 2.5967e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORMN2JWARM.s003
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5245e+04
  VMC Eavg = -2.2666e+01
  VMC Evar = 5.1894e-01
  Total weights = 1.954786794e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.7870e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.501591293298
                                         uncertainty =       0.002648681622

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.501591293298
                                         uncertainty =       0.002648681622

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000500827242
  error estimate for blocks of size 2^( 2) =       0.000519437234
  error estimate for blocks of size 2^( 3) =       0.000536298969
  error estimate for blocks of size 2^( 4) =       0.000547790980
  error estimate for blocks of size 2^( 5) =       0.000555426690
  error estimate for blocks of size 2^( 6) =       0.000560680258
  error estimate for blocks of size 2^( 7) =       0.000562608640

      target function =                  N/A
              le_mean =     -22.666079743476
             les_mean =     514.270106486585
             stat err =       0.000556626642
             autocorr =       1.235242117147
              std dev =       0.708276677911
             le_variance =       0.501655852473


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266607974348e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5625e-01, overlap shift 1.5625e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.666079743625       residual = 6.60e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.667977984928       residual = 2.81e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.668070013143       residual = 1.06e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.668071994951       residual = 4.78e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.668072630274       residual = 2.02e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.668072489226       residual = 1.22e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          5 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 1.5625e-01 is 1.121659e-02

solving harmonic davidson linear method for identity shift 6.2500e-01, overlap shift 6.2500e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.666079743625       residual = 6.60e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.666914425467       residual = 1.51e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.666936761200       residual = 9.56e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.666937337490       residual = 1.16e-08           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.666937363741       residual = 2.16e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          4 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 6.2500e-01 is 5.166981e-03

solving harmonic davidson linear method for identity shift 2.5000e+00, overlap shift 2.5000e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.666079743625       residual = 6.60e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.666337239027       residual = 1.18e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.666343019827       residual = 1.18e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.666343254652       residual = 1.57e-08           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.666343265464       residual = 2.03e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          4 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 2.5000e+00 is 1.636589e-03

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.016202 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0766e+01
  </log>
  <optVariables href="FORMN2JWARM.s003.opt.xml">
ci_001                -7.024090e-01 3 1  ON 0
ci_002                -7.022205e-01 3 1  ON 1
ci_003                -5.769553e-02 3 1  ON 2
ci_004                -5.790344e-02 3 1  ON 3
ci_005                 3.096982e-02 3 1  ON 4
ci_006                 3.035335e-02 3 1  ON 5
ci_007                 2.388798e-02 3 1  ON 6
ci_008                 2.433756e-02 3 1  ON 7
ci_009                -1.876002e-02 3 1  ON 8
ci_010                -1.919556e-02 3 1  ON 9
ci_011                -1.707917e-02 3 1  ON 10
ci_012                -1.705448e-02 3 1  ON 11
ci_013                 1.564617e-02 3 1  ON 12
ci_014                 1.584977e-02 3 1  ON 13
ci_015                 1.768074e-02 3 1  ON 14
ci_016                 1.785960e-02 3 1  ON 15
ci_017                 1.343772e-02 3 1  ON 16
ci_018                 1.373937e-02 3 1  ON 17
ci_019                 6.808646e-03 3 1  ON 18
ci_020                 7.017791e-03 3 1  ON 19
ci_021                -8.839553e-03 3 1  ON 20
ci_022                -9.193699e-03 3 1  ON 21
ci_023                 8.557669e-03 3 1  ON 22
ci_024                 8.061907e-03 3 1  ON 23
ci_025                 5.781004e-03 3 1  ON 24
ci_026                 5.735330e-03 3 1  ON 25
ci_027                 6.901935e-03 3 1  ON 26
ci_028                 7.490630e-03 3 1  ON 27
ci_029                -7.028414e-03 3 1  ON 28
ci_030                -6.929557e-03 3 1  ON 29
ci_031                -8.056589e-03 3 1  ON 30
ci_032                -8.001243e-03 3 1  ON 31
ci_033                 6.048977e-03 3 1  ON 32
ci_034                 5.930693e-03 3 1  ON 33
ci_035                 4.287947e-03 3 1  ON 34
ci_036                 3.983865e-03 3 1  ON 35
ci_037                 6.581278e-03 3 1  ON 36
ci_038                 6.928543e-03 3 1  ON 37
ci_039                 4.949386e-03 3 1  ON 38
ci_040                 5.823240e-03 3 1  ON 39
ci_041                 4.704011e-03 3 1  ON 40
ci_042                 5.015878e-03 3 1  ON 41
ci_043                 5.963807e-03 3 1  ON 42
ci_044                 5.473749e-03 3 1  ON 43
ci_045                 4.356898e-03 3 1  ON 44
ci_046                 4.051701e-03 3 1  ON 45
ci_047                -2.551075e-03 3 1  ON 46
ci_048                -2.481437e-03 3 1  ON 47
ci_049                 1.927200e-03 3 1  ON 48
ci_050                 2.513460e-03 3 1  ON 49
ci_051                -2.870562e-03 3 1  ON 50
ci_052                -3.087165e-03 3 1  ON 51
ci_053                -2.453188e-03 3 1  ON 52
ci_054                -2.381688e-03 3 1  ON 53
ci_055                -1.818044e-03 3 1  ON 54
ci_056                -1.763855e-03 3 1  ON 55
ci_057                -1.710378e-03 3 1  ON 56
ci_058                -1.965228e-03 3 1  ON 57
ci_059                -6.295835e-04 3 1  ON 58
ci_060                -4.828986e-04 3 1  ON 59
ci_061                -8.974571e-04 3 1  ON 60
ci_062                -1.167330e-03 3 1  ON 61
ci_063                -6.160785e-04 3 1  ON 62
ci_064                -8.614091e-04 3 1  ON 63
ci_065                -2.137376e-03 3 1  ON 64
ci_066                -2.010316e-03 3 1  ON 65
ci_067                -2.057923e-03 3 1  ON 66
ci_068                -1.672659e-03 3 1  ON 67
ci_069                 6.869755e-04 3 1  ON 68
ci_070                 1.060521e-03 3 1  ON 69
ci_071                -1.964956e-03 3 1  ON 70
ci_072                -1.806899e-03 3 1  ON 71
ci_073                 7.493573e-04 3 1  ON 72
ci_074                 6.835132e-04 3 1  ON 73
ci_075                -7.875740e-04 3 1  ON 74
ci_076                -1.054850e-03 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 3
    time step          = 0.05
    reference energy   = -22.6741
    reference variance = 0.384787
====================================================
  Execution time = 2.5411e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORMN2JWARM.s003
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2666e+01
  VMC Evar = 5.0463e-01
  Total weights = 1.9546e+06
  Execution time = 3.6787e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.503365967608
                                         uncertainty =       0.003667707500

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.503365967608
                                         uncertainty =       0.003667707500

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000501637215
  error estimate for blocks of size 2^( 2) =       0.000519913328
  error estimate for blocks of size 2^( 3) =       0.000536666826
  error estimate for blocks of size 2^( 4) =       0.000548851200
  error estimate for blocks of size 2^( 5) =       0.000556143857
  error estimate for blocks of size 2^( 6) =       0.000557394153
  error estimate for blocks of size 2^( 7) =       0.000561918767

      target function =                  N/A
              le_mean =     -22.666348876546
             les_mean =     514.329928623964
             stat err =       0.000556076994
             autocorr =       1.228825909977
              std dev =       0.709422152726
             le_variance =       0.503279790778

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.492977045771
                                         uncertainty =       0.003621013574

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.492977045771
                                         uncertainty =       0.003621013574

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000496434991
  error estimate for blocks of size 2^( 2) =       0.000514388339
  error estimate for blocks of size 2^( 3) =       0.000530961321
  error estimate for blocks of size 2^( 4) =       0.000542901747
  error estimate for blocks of size 2^( 5) =       0.000550033444
  error estimate for blocks of size 2^( 6) =       0.000550875500
  error estimate for blocks of size 2^( 7) =       0.000555451113

      target function =                  N/A
              le_mean =     -22.666432177171
             les_mean =     514.353968272591
             stat err =       0.000549815451
             autocorr =       1.226617370757
              std dev =       0.702065096868
             le_variance =       0.492895400241

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.493618568364
                                         uncertainty =       0.004088983087

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.493618568364
                                         uncertainty =       0.004088983087

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000496759016
  error estimate for blocks of size 2^( 2) =       0.000514725476
  error estimate for blocks of size 2^( 3) =       0.000531177736
  error estimate for blocks of size 2^( 4) =       0.000543243834
  error estimate for blocks of size 2^( 5) =       0.000550302850
  error estimate for blocks of size 2^( 6) =       0.000551181406
  error estimate for blocks of size 2^( 7) =       0.000555440473

      target function =                  N/A
              le_mean =     -22.666281623785
             les_mean =     516.792043660378
             stat err =       0.000550042141
             autocorr =       1.226028065368
              std dev =       0.702523337201
             le_variance =       0.493539039312

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.499054694358
                                         uncertainty =       0.003264367577

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.499054694358
                                         uncertainty =       0.003264367577

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000499485876
  error estimate for blocks of size 2^( 2) =       0.000517740693
  error estimate for blocks of size 2^( 3) =       0.000534441747
  error estimate for blocks of size 2^( 4) =       0.000546625256
  error estimate for blocks of size 2^( 5) =       0.000553875312
  error estimate for blocks of size 2^( 6) =       0.000554967054
  error estimate for blocks of size 2^( 7) =       0.000559651967

      target function =                  N/A
              le_mean =     -22.666255932152
             les_mean =     514.314994737659
             stat err =       0.000553779897
             autocorr =       1.229215274020
              std dev =       0.706379700573
             le_variance =       0.498972281382


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.666348876546        initial
     1.5625e-01     1.5625e+00             1.1217e-02       -22.666432177171  <--
     6.2500e-01     6.2500e+00             5.1670e-03       -22.666281623785
     2.5000e+00     2.5000e+01             1.6366e-03       -22.666255932152

*****************************************************************************
Applying the update for shift_i =   1.5625e-01     and shift_s =   1.5625e+00
*****************************************************************************

  Execution time = 4.5175e+01
  </log>
  <optVariables href="FORMN2JWARM.s003.opt.xml">
ci_001                -7.042582e-01 3 1  ON 0
ci_002                -7.026501e-01 3 1  ON 1
ci_003                -5.388627e-02 3 1  ON 2
ci_004                -5.389503e-02 3 1  ON 3
ci_005                 2.512787e-02 3 1  ON 4
ci_006                 2.430373e-02 3 1  ON 5
ci_007                 1.950825e-02 3 1  ON 6
ci_008                 2.047508e-02 3 1  ON 7
ci_009                -1.579364e-02 3 1  ON 8
ci_010                -1.666471e-02 3 1  ON 9
ci_011                -1.411388e-02 3 1  ON 10
ci_012                -1.386672e-02 3 1  ON 11
ci_013                 1.350657e-02 3 1  ON 12
ci_014                 1.357869e-02 3 1  ON 13
ci_015                 1.631669e-02 3 1  ON 14
ci_016                 1.633973e-02 3 1  ON 15
ci_017                 1.291758e-02 3 1  ON 16
ci_018                 1.290460e-02 3 1  ON 17
ci_019                 4.518837e-03 3 1  ON 18
ci_020                 4.909408e-03 3 1  ON 19
ci_021                -8.155219e-03 3 1  ON 20
ci_022                -9.290939e-03 3 1  ON 21
ci_023                 8.097693e-03 3 1  ON 22
ci_024                 7.675925e-03 3 1  ON 23
ci_025                 4.370330e-03 3 1  ON 24
ci_026                 4.110445e-03 3 1  ON 25
ci_027                 6.300434e-03 3 1  ON 26
ci_028                 7.549106e-03 3 1  ON 27
ci_029                -6.696524e-03 3 1  ON 28
ci_030                -6.248657e-03 3 1  ON 29
ci_031                -8.291416e-03 3 1  ON 30
ci_032                -8.442267e-03 3 1  ON 31
ci_033                 5.591862e-03 3 1  ON 32
ci_034                 5.248722e-03 3 1  ON 33
ci_035                 3.622436e-03 3 1  ON 34
ci_036                 3.006310e-03 3 1  ON 35
ci_037                 6.287696e-03 3 1  ON 36
ci_038                 7.020405e-03 3 1  ON 37
ci_039                 4.403137e-03 3 1  ON 38
ci_040                 6.102364e-03 3 1  ON 39
ci_041                 4.837400e-03 3 1  ON 40
ci_042                 5.214566e-03 3 1  ON 41
ci_043                 6.269619e-03 3 1  ON 42
ci_044                 5.704902e-03 3 1  ON 43
ci_045                 4.203189e-03 3 1  ON 44
ci_046                 3.536024e-03 3 1  ON 45
ci_047                -1.739632e-03 3 1  ON 46
ci_048                -1.648149e-03 3 1  ON 47
ci_049                 1.813533e-03 3 1  ON 48
ci_050                 2.215138e-03 3 1  ON 49
ci_051                -2.554134e-03 3 1  ON 50
ci_052                -2.700002e-03 3 1  ON 51
ci_053                -2.468668e-03 3 1  ON 52
ci_054                -2.890331e-03 3 1  ON 53
ci_055                -1.551509e-03 3 1  ON 54
ci_056                -1.064050e-03 3 1  ON 55
ci_057                -1.657830e-03 3 1  ON 56
ci_058                -2.065136e-03 3 1  ON 57
ci_059                -1.227443e-04 3 1  ON 58
ci_060                -1.057409e-04 3 1  ON 59
ci_061                -7.519873e-04 3 1  ON 60
ci_062                -9.292719e-04 3 1  ON 61
ci_063                 5.560168e-05 3 1  ON 62
ci_064                -5.314935e-04 3 1  ON 63
ci_065                -2.365963e-03 3 1  ON 64
ci_066                -2.171944e-03 3 1  ON 65
ci_067                -2.344582e-03 3 1  ON 66
ci_068                -2.125353e-03 3 1  ON 67
ci_069                 2.146490e-04 3 1  ON 68
ci_070                 1.088250e-03 3 1  ON 69
ci_071                -2.085878e-03 3 1  ON 70
ci_072                -1.939902e-03 3 1  ON 71
ci_073                 5.890127e-04 3 1  ON 72
ci_074                 4.258330e-04 3 1  ON 73
ci_075                -7.008196e-04 3 1  ON 74
ci_076                -9.092734e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.5956e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORMN2JWARM.s004 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORMN2JWARM.s004 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=4  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2653e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 4
    time step          = 0.05
    reference energy   = -22.7041
    reference variance = 1.19457
====================================================
  Execution time = 2.5980e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORMN2JWARM.s004
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5287e+04
  VMC Eavg = -2.2668e+01
  VMC Evar = 4.9918e-01
  Total weights = 1.955291531e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.7671e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.485255379461
                                         uncertainty =       0.002729326559

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.485255379461
                                         uncertainty =       0.002729326559

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000492598377
  error estimate for blocks of size 2^( 2) =       0.000510674327
  error estimate for blocks of size 2^( 3) =       0.000527321716
  error estimate for blocks of size 2^( 4) =       0.000538977479
  error estimate for blocks of size 2^( 5) =       0.000547047487
  error estimate for blocks of size 2^( 6) =       0.000550954872
  error estimate for blocks of size 2^( 7) =       0.000553006948

      target function =                  N/A
              le_mean =     -22.667671783297
             les_mean =     514.322520037519
             stat err =       0.000547496697
             autocorr =       1.235313117784
              std dev =       0.696639305506
             le_variance =       0.485306321976


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266767178330e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.9062e-02, overlap shift 3.9062e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.667671783397       residual = 1.46e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.668358106489       residual = 1.46e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.668421277277       residual = 1.80e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.668440394839       residual = 2.95e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.668439148467       residual = 1.83e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.668439132015       residual = 1.67e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.668439150132       residual = 5.80e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 3.9062e-02 is 9.467163e-03

solving harmonic davidson linear method for identity shift 1.5625e-01, overlap shift 1.5625e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.667671783397       residual = 1.46e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.668128026173       residual = 7.97e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.668146024272       residual = 2.87e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.668149132032       residual = 1.18e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.668148824724       residual = 3.86e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          4 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 1.5625e-01 is 4.642229e-03

solving harmonic davidson linear method for identity shift 6.2500e-01, overlap shift 6.2500e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.667671783397       residual = 1.46e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.667866666199       residual = 3.60e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.667869385704       residual = 2.13e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.667869734107       residual = 3.04e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 6.2500e-01 is 2.132691e-03

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.022044 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0760e+01
  </log>
  <optVariables href="FORMN2JWARM.s004.opt.xml">
ci_001                -7.049089e-01 3 1  ON 0
ci_002                -7.035860e-01 3 1  ON 1
ci_003                -4.976302e-02 3 1  ON 2
ci_004                -5.042014e-02 3 1  ON 3
ci_005                 2.048564e-02 3 1  ON 4
ci_006                 1.994014e-02 3 1  ON 5
ci_007                 1.584342e-02 3 1  ON 6
ci_008                 1.721503e-02 3 1  ON 7
ci_009                -1.372757e-02 3 1  ON 8
ci_010                -1.431983e-02 3 1  ON 9
ci_011                -1.228426e-02 3 1  ON 10
ci_012                -1.131086e-02 3 1  ON 11
ci_013                 1.147109e-02 3 1  ON 12
ci_014                 1.113118e-02 3 1  ON 13
ci_015                 1.516538e-02 3 1  ON 14
ci_016                 1.485143e-02 3 1  ON 15
ci_017                 1.161130e-02 3 1  ON 16
ci_018                 1.162504e-02 3 1  ON 17
ci_019                 2.738089e-03 3 1  ON 18
ci_020                 3.013811e-03 3 1  ON 19
ci_021                -8.589937e-03 3 1  ON 20
ci_022                -8.450964e-03 3 1  ON 21
ci_023                 8.382810e-03 3 1  ON 22
ci_024                 7.483083e-03 3 1  ON 23
ci_025                 4.052308e-03 3 1  ON 24
ci_026                 3.309814e-03 3 1  ON 25
ci_027                 6.252326e-03 3 1  ON 26
ci_028                 6.737239e-03 3 1  ON 27
ci_029                -5.464958e-03 3 1  ON 28
ci_030                -5.448838e-03 3 1  ON 29
ci_031                -8.565112e-03 3 1  ON 30
ci_032                -8.718712e-03 3 1  ON 31
ci_033                 5.100160e-03 3 1  ON 32
ci_034                 4.632545e-03 3 1  ON 33
ci_035                 2.310659e-03 3 1  ON 34
ci_036                 2.328762e-03 3 1  ON 35
ci_037                 6.440807e-03 3 1  ON 36
ci_038                 6.102330e-03 3 1  ON 37
ci_039                 4.915458e-03 3 1  ON 38
ci_040                 5.451716e-03 3 1  ON 39
ci_041                 5.322135e-03 3 1  ON 40
ci_042                 4.834145e-03 3 1  ON 41
ci_043                 6.216875e-03 3 1  ON 42
ci_044                 5.417285e-03 3 1  ON 43
ci_045                 3.503691e-03 3 1  ON 44
ci_046                 2.850045e-03 3 1  ON 45
ci_047                -8.191441e-04 3 1  ON 46
ci_048                -1.255692e-03 3 1  ON 47
ci_049                 1.435292e-03 3 1  ON 48
ci_050                 2.175162e-03 3 1  ON 49
ci_051                -2.303411e-03 3 1  ON 50
ci_052                -1.322165e-03 3 1  ON 51
ci_053                -2.589650e-03 3 1  ON 52
ci_054                -2.591070e-03 3 1  ON 53
ci_055                -1.441550e-03 3 1  ON 54
ci_056                -1.209391e-03 3 1  ON 55
ci_057                -1.577452e-03 3 1  ON 56
ci_058                -2.035763e-03 3 1  ON 57
ci_059                 2.351034e-04 3 1  ON 58
ci_060                 6.495180e-06 3 1  ON 59
ci_061                -1.409159e-04 3 1  ON 60
ci_062                 1.096729e-04 3 1  ON 61
ci_063                 8.891413e-05 3 1  ON 62
ci_064                -7.061358e-04 3 1  ON 63
ci_065                -2.275586e-03 3 1  ON 64
ci_066                -1.861497e-03 3 1  ON 65
ci_067                -2.201442e-03 3 1  ON 66
ci_068                -2.373139e-03 3 1  ON 67
ci_069                 3.192549e-04 3 1  ON 68
ci_070                 8.341079e-04 3 1  ON 69
ci_071                -2.669294e-03 3 1  ON 70
ci_072                -2.884818e-03 3 1  ON 71
ci_073                 5.445448e-04 3 1  ON 72
ci_074                 5.557384e-04 3 1  ON 73
ci_075                -1.010958e-03 3 1  ON 74
ci_076                -2.377241e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 4
    time step          = 0.05
    reference energy   = -22.6991
    reference variance = 0.347239
====================================================
  Execution time = 2.5298e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORMN2JWARM.s004
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2668e+01
  VMC Evar = 5.0329e-01
  Total weights = 1.9552e+06
  Execution time = 3.6796e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.539476219131
                                         uncertainty =       0.043238568566

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.539476219131
                                         uncertainty =       0.043238568566

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000519266951
  error estimate for blocks of size 2^( 2) =       0.000536390488
  error estimate for blocks of size 2^( 3) =       0.000551668922
  error estimate for blocks of size 2^( 4) =       0.000562904242
  error estimate for blocks of size 2^( 5) =       0.000570129182
  error estimate for blocks of size 2^( 6) =       0.000574178440
  error estimate for blocks of size 2^( 7) =       0.000578314516

      target function =                  N/A
              le_mean =     -22.668716085542
             les_mean =     515.214120288793
             stat err =       0.000571381595
             autocorr =       1.210796421045
              std dev =       0.734354364603
             le_variance =       0.539276332812

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.490135467428
                                         uncertainty =       0.002925664104

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.490135467428
                                         uncertainty =       0.002925664104

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000495003036
  error estimate for blocks of size 2^( 2) =       0.000512898065
  error estimate for blocks of size 2^( 3) =       0.000528996019
  error estimate for blocks of size 2^( 4) =       0.000540531079
  error estimate for blocks of size 2^( 5) =       0.000548236180
  error estimate for blocks of size 2^( 6) =       0.000552626046
  error estimate for blocks of size 2^( 7) =       0.000556537862

      target function =                  N/A
              le_mean =     -22.668476231210
             les_mean =     514.371903221578
             stat err =       0.000549482792
             autocorr =       1.232231954302
              std dev =       0.700040006903
             le_variance =       0.490056011265

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.922656967099
                                         uncertainty =       0.429449998554

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.922656967099
                                         uncertainty =       0.429449998554

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000678650734
  error estimate for blocks of size 2^( 2) =       0.000691805243
  error estimate for blocks of size 2^( 3) =       0.000704240540
  error estimate for blocks of size 2^( 4) =       0.000713002025
  error estimate for blocks of size 2^( 5) =       0.000717797279
  error estimate for blocks of size 2^( 6) =       0.000718732339
  error estimate for blocks of size 2^( 7) =       0.000723483651

      target function =                  N/A
              le_mean =     -22.668174573956
             les_mean =     587.794060963026
             stat err =       0.000718253824
             autocorr =       1.120116634461
              std dev =       0.959757072257
             le_variance =       0.921133637748

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.493140005625
                                         uncertainty =       0.003052221477

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.493140005625
                                         uncertainty =       0.003052221477

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000496515546
  error estimate for blocks of size 2^( 2) =       0.000514326679
  error estimate for blocks of size 2^( 3) =       0.000530388304
  error estimate for blocks of size 2^( 4) =       0.000541928366
  error estimate for blocks of size 2^( 5) =       0.000549725797
  error estimate for blocks of size 2^( 6) =       0.000553960094
  error estimate for blocks of size 2^( 7) =       0.000557778917

      target function =                  N/A
              le_mean =     -22.668441572011
             les_mean =     514.400918690922
             stat err =       0.000550848293
             autocorr =       1.230830683081
              std dev =       0.702179019462
             le_variance =       0.493055375373


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.668716085542        initial  <--
     3.9062e-02     3.9062e-01             9.4672e-03       -22.668476231210
     1.5625e-01     1.5625e+00             4.6422e-03       -22.668174573956
     6.2500e-01     6.2500e+00             2.1327e-03       -22.668441572011

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 43.6832
  </log>
  <optVariables href="FORMN2JWARM.s004.opt.xml">
ci_001                -7.042582e-01 3 1  ON 0
ci_002                -7.026501e-01 3 1  ON 1
ci_003                -5.388627e-02 3 1  ON 2
ci_004                -5.389503e-02 3 1  ON 3
ci_005                 2.512787e-02 3 1  ON 4
ci_006                 2.430373e-02 3 1  ON 5
ci_007                 1.950825e-02 3 1  ON 6
ci_008                 2.047508e-02 3 1  ON 7
ci_009                -1.579364e-02 3 1  ON 8
ci_010                -1.666471e-02 3 1  ON 9
ci_011                -1.411388e-02 3 1  ON 10
ci_012                -1.386672e-02 3 1  ON 11
ci_013                 1.350657e-02 3 1  ON 12
ci_014                 1.357869e-02 3 1  ON 13
ci_015                 1.631669e-02 3 1  ON 14
ci_016                 1.633973e-02 3 1  ON 15
ci_017                 1.291758e-02 3 1  ON 16
ci_018                 1.290460e-02 3 1  ON 17
ci_019                 4.518837e-03 3 1  ON 18
ci_020                 4.909408e-03 3 1  ON 19
ci_021                -8.155219e-03 3 1  ON 20
ci_022                -9.290939e-03 3 1  ON 21
ci_023                 8.097693e-03 3 1  ON 22
ci_024                 7.675925e-03 3 1  ON 23
ci_025                 4.370330e-03 3 1  ON 24
ci_026                 4.110445e-03 3 1  ON 25
ci_027                 6.300434e-03 3 1  ON 26
ci_028                 7.549106e-03 3 1  ON 27
ci_029                -6.696524e-03 3 1  ON 28
ci_030                -6.248657e-03 3 1  ON 29
ci_031                -8.291416e-03 3 1  ON 30
ci_032                -8.442267e-03 3 1  ON 31
ci_033                 5.591862e-03 3 1  ON 32
ci_034                 5.248722e-03 3 1  ON 33
ci_035                 3.622436e-03 3 1  ON 34
ci_036                 3.006310e-03 3 1  ON 35
ci_037                 6.287696e-03 3 1  ON 36
ci_038                 7.020405e-03 3 1  ON 37
ci_039                 4.403137e-03 3 1  ON 38
ci_040                 6.102364e-03 3 1  ON 39
ci_041                 4.837400e-03 3 1  ON 40
ci_042                 5.214566e-03 3 1  ON 41
ci_043                 6.269619e-03 3 1  ON 42
ci_044                 5.704902e-03 3 1  ON 43
ci_045                 4.203189e-03 3 1  ON 44
ci_046                 3.536024e-03 3 1  ON 45
ci_047                -1.739632e-03 3 1  ON 46
ci_048                -1.648149e-03 3 1  ON 47
ci_049                 1.813533e-03 3 1  ON 48
ci_050                 2.215138e-03 3 1  ON 49
ci_051                -2.554134e-03 3 1  ON 50
ci_052                -2.700002e-03 3 1  ON 51
ci_053                -2.468668e-03 3 1  ON 52
ci_054                -2.890331e-03 3 1  ON 53
ci_055                -1.551509e-03 3 1  ON 54
ci_056                -1.064050e-03 3 1  ON 55
ci_057                -1.657830e-03 3 1  ON 56
ci_058                -2.065136e-03 3 1  ON 57
ci_059                -1.227443e-04 3 1  ON 58
ci_060                -1.057409e-04 3 1  ON 59
ci_061                -7.519873e-04 3 1  ON 60
ci_062                -9.292719e-04 3 1  ON 61
ci_063                 5.560168e-05 3 1  ON 62
ci_064                -5.314935e-04 3 1  ON 63
ci_065                -2.365963e-03 3 1  ON 64
ci_066                -2.171944e-03 3 1  ON 65
ci_067                -2.344582e-03 3 1  ON 66
ci_068                -2.125353e-03 3 1  ON 67
ci_069                 2.146490e-04 3 1  ON 68
ci_070                 1.088250e-03 3 1  ON 69
ci_071                -2.085878e-03 3 1  ON 70
ci_072                -1.939902e-03 3 1  ON 71
ci_073                 5.890127e-04 3 1  ON 72
ci_074                 4.258330e-04 3 1  ON 73
ci_075                -7.008196e-04 3 1  ON 74
ci_076                -9.092734e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.4459e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORMN2JWARM.s005 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORMN2JWARM.s005 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=5  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2663e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 5
    time step          = 0.05
    reference energy   = -22.6186
    reference variance = 0.381939
====================================================
  Execution time = 2.6121e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORMN2JWARM.s005
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5268e+04
  VMC Eavg = -2.2668e+01
  VMC Evar = 4.9875e-01
  Total weights = 1.954838780e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.7959e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.487503923289
                                         uncertainty =       0.002406767155

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.487503923289
                                         uncertainty =       0.002406767155

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000493685678
  error estimate for blocks of size 2^( 2) =       0.000512418452
  error estimate for blocks of size 2^( 3) =       0.000529255469
  error estimate for blocks of size 2^( 4) =       0.000541938860
  error estimate for blocks of size 2^( 5) =       0.000548963587
  error estimate for blocks of size 2^( 6) =       0.000552899372
  error estimate for blocks of size 2^( 7) =       0.000554560221

      target function =                  N/A
              le_mean =     -22.668303343730
             les_mean =     514.350727707544
             stat err =       0.000549590510
             autocorr =       1.239302695063
              std dev =       0.698176981100
             le_variance =       0.487451096938


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266830334373e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.9062e-01, overlap shift 3.9062e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.668303343861       residual = 1.79e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.668581840531       residual = 4.97e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.668589321353       residual = 6.51e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.668589802915       residual = 9.08e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 3.9062e-01 is 3.031481e-03

solving harmonic davidson linear method for identity shift 1.5625e+00, overlap shift 1.5625e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.668303343861       residual = 1.79e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.668395360173       residual = 3.16e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.668397611786       residual = 5.08e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.668397498440       residual = 9.04e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 1.5625e+00 is 1.063134e-03

solving harmonic davidson linear method for identity shift 6.2500e+00, overlap shift 6.2500e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.668303343861       residual = 1.79e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.668328359031       residual = 2.94e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.668329005904       residual = 7.33e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.668328963245       residual = 9.56e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 6.2500e+00 is 2.956303e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.026434 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0928e+01
  </log>
  <optVariables href="FORMN2JWARM.s005.opt.xml">
ci_001                -7.043794e-01 3 1  ON 0
ci_002                -7.028134e-01 3 1  ON 1
ci_003                -5.334529e-02 3 1  ON 2
ci_004                -5.347376e-02 3 1  ON 3
ci_005                 2.406473e-02 3 1  ON 4
ci_006                 2.339545e-02 3 1  ON 5
ci_007                 1.877532e-02 3 1  ON 6
ci_008                 1.979252e-02 3 1  ON 7
ci_009                -1.530465e-02 3 1  ON 8
ci_010                -1.604906e-02 3 1  ON 9
ci_011                -1.354842e-02 3 1  ON 10
ci_012                -1.334030e-02 3 1  ON 11
ci_013                 1.318056e-02 3 1  ON 12
ci_014                 1.309477e-02 3 1  ON 13
ci_015                 1.610942e-02 3 1  ON 14
ci_016                 1.620545e-02 3 1  ON 15
ci_017                 1.281516e-02 3 1  ON 16
ci_018                 1.269957e-02 3 1  ON 17
ci_019                 4.169320e-03 3 1  ON 18
ci_020                 4.546070e-03 3 1  ON 19
ci_021                -8.122937e-03 3 1  ON 20
ci_022                -9.138486e-03 3 1  ON 21
ci_023                 8.169810e-03 3 1  ON 22
ci_024                 7.650386e-03 3 1  ON 23
ci_025                 4.199439e-03 3 1  ON 24
ci_026                 3.912866e-03 3 1  ON 25
ci_027                 6.314946e-03 3 1  ON 26
ci_028                 7.425672e-03 3 1  ON 27
ci_029                -6.429923e-03 3 1  ON 28
ci_030                -6.209914e-03 3 1  ON 29
ci_031                -8.239052e-03 3 1  ON 30
ci_032                -8.404343e-03 3 1  ON 31
ci_033                 5.382363e-03 3 1  ON 32
ci_034                 5.168956e-03 3 1  ON 33
ci_035                 3.298470e-03 3 1  ON 34
ci_036                 2.809078e-03 3 1  ON 35
ci_037                 6.239727e-03 3 1  ON 36
ci_038                 6.578102e-03 3 1  ON 37
ci_039                 4.501940e-03 3 1  ON 38
ci_040                 6.174661e-03 3 1  ON 39
ci_041                 4.913722e-03 3 1  ON 40
ci_042                 5.220840e-03 3 1  ON 41
ci_043                 6.255066e-03 3 1  ON 42
ci_044                 5.814048e-03 3 1  ON 43
ci_045                 4.074451e-03 3 1  ON 44
ci_046                 3.579176e-03 3 1  ON 45
ci_047                -1.538180e-03 3 1  ON 46
ci_048                -1.532342e-03 3 1  ON 47
ci_049                 1.741642e-03 3 1  ON 48
ci_050                 2.097573e-03 3 1  ON 49
ci_051                -2.367645e-03 3 1  ON 50
ci_052                -2.670718e-03 3 1  ON 51
ci_053                -2.382928e-03 3 1  ON 52
ci_054                -2.923104e-03 3 1  ON 53
ci_055                -1.496068e-03 3 1  ON 54
ci_056                -1.245463e-03 3 1  ON 55
ci_057                -1.753779e-03 3 1  ON 56
ci_058                -1.980311e-03 3 1  ON 57
ci_059                -1.645381e-04 3 1  ON 58
ci_060                 3.395855e-06 3 1  ON 59
ci_061                -6.330196e-04 3 1  ON 60
ci_062                -9.356295e-04 3 1  ON 61
ci_063                 1.685102e-06 3 1  ON 62
ci_064                -2.666265e-04 3 1  ON 63
ci_065                -2.433107e-03 3 1  ON 64
ci_066                -2.258625e-03 3 1  ON 65
ci_067                -2.340125e-03 3 1  ON 66
ci_068                -2.057392e-03 3 1  ON 67
ci_069                 2.502558e-04 3 1  ON 68
ci_070                 8.710844e-04 3 1  ON 69
ci_071                -1.928543e-03 3 1  ON 70
ci_072                -2.013475e-03 3 1  ON 71
ci_073                 5.054081e-04 3 1  ON 72
ci_074                 4.051559e-04 3 1  ON 73
ci_075                -6.039818e-04 3 1  ON 74
ci_076                -8.458351e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 5
    time step          = 0.05
    reference energy   = -22.7364
    reference variance = 0.423021
====================================================
  Execution time = 2.5437e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORMN2JWARM.s005
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2669e+01
  VMC Evar = 5.1291e-01
  Total weights = 1.9549e+06
  Execution time = 3.6652e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.496342052928
                                         uncertainty =       0.003641133121

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.496342052928
                                         uncertainty =       0.003641133121

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000498110035
  error estimate for blocks of size 2^( 2) =       0.000516261272
  error estimate for blocks of size 2^( 3) =       0.000532312822
  error estimate for blocks of size 2^( 4) =       0.000543780115
  error estimate for blocks of size 2^( 5) =       0.000551101118
  error estimate for blocks of size 2^( 6) =       0.000557248577
  error estimate for blocks of size 2^( 7) =       0.000559972685

      target function =                  N/A
              le_mean =     -22.668972486000
             les_mean =     514.401470552952
             stat err =       0.000553025624
             autocorr =       1.232650414757
              std dev =       0.704433967176
             le_variance =       0.496227214111

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =    6220.867075557892
                                         uncertainty =    6189.194206296720

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =    6220.867075557892
                                         uncertainty =    6189.194206296720

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.055597618638
  error estimate for blocks of size 2^( 2) =       0.055601075370
  error estimate for blocks of size 2^( 3) =       0.055601288006
  error estimate for blocks of size 2^( 4) =       0.055600268560
  error estimate for blocks of size 2^( 5) =       0.055627476569
  error estimate for blocks of size 2^( 6) =       0.055629865228
  error estimate for blocks of size 2^( 7) =       0.055630350630

      target function =                  N/A
              le_mean =     -22.613411777469
             les_mean =   10242.800681881872
             stat err =       0.055621990246
             autocorr =       1.000876906276
              std dev =      78.626906313323
             le_variance =    6182.190396404123

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.505603630702
                                         uncertainty =       0.013092049996

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.505603630702
                                         uncertainty =       0.013092049996

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000502703433
  error estimate for blocks of size 2^( 2) =       0.000520640142
  error estimate for blocks of size 2^( 3) =       0.000536540286
  error estimate for blocks of size 2^( 4) =       0.000547781225
  error estimate for blocks of size 2^( 5) =       0.000554931748
  error estimate for blocks of size 2^( 6) =       0.000561257474
  error estimate for blocks of size 2^( 7) =       0.000563964319

      target function =                  N/A
              le_mean =     -22.668914474073
             les_mean =     514.405400101842
             stat err =       0.000556983692
             autocorr =       1.227612368970
              std dev =       0.710930013427
             le_variance =       0.505421483991

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.496454179214
                                         uncertainty =       0.003854208490

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.496454179214
                                         uncertainty =       0.003854208490

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000498165134
  error estimate for blocks of size 2^( 2) =       0.000516307687
  error estimate for blocks of size 2^( 3) =       0.000532353395
  error estimate for blocks of size 2^( 4) =       0.000543808043
  error estimate for blocks of size 2^( 5) =       0.000551119927
  error estimate for blocks of size 2^( 6) =       0.000557278114
  error estimate for blocks of size 2^( 7) =       0.000559991513

      target function =                  N/A
              le_mean =     -22.668961517837
             les_mean =     514.393603645540
             stat err =       0.000553049399
             autocorr =       1.232483721374
              std dev =       0.704511889387
             le_variance =       0.496337002287


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.668972486000        initial  <--
     3.9062e-01     3.9062e+00             3.0315e-03       -22.613411777469
     1.5625e+00     1.5625e+01             1.0631e-03       -22.668914474073
     6.2500e+00     6.2500e+01             2.9563e-04       -22.668961517837

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 43.7977
  </log>
  <optVariables href="FORMN2JWARM.s005.opt.xml">
ci_001                -7.042582e-01 3 1  ON 0
ci_002                -7.026501e-01 3 1  ON 1
ci_003                -5.388627e-02 3 1  ON 2
ci_004                -5.389503e-02 3 1  ON 3
ci_005                 2.512787e-02 3 1  ON 4
ci_006                 2.430373e-02 3 1  ON 5
ci_007                 1.950825e-02 3 1  ON 6
ci_008                 2.047508e-02 3 1  ON 7
ci_009                -1.579364e-02 3 1  ON 8
ci_010                -1.666471e-02 3 1  ON 9
ci_011                -1.411388e-02 3 1  ON 10
ci_012                -1.386672e-02 3 1  ON 11
ci_013                 1.350657e-02 3 1  ON 12
ci_014                 1.357869e-02 3 1  ON 13
ci_015                 1.631669e-02 3 1  ON 14
ci_016                 1.633973e-02 3 1  ON 15
ci_017                 1.291758e-02 3 1  ON 16
ci_018                 1.290460e-02 3 1  ON 17
ci_019                 4.518837e-03 3 1  ON 18
ci_020                 4.909408e-03 3 1  ON 19
ci_021                -8.155219e-03 3 1  ON 20
ci_022                -9.290939e-03 3 1  ON 21
ci_023                 8.097693e-03 3 1  ON 22
ci_024                 7.675925e-03 3 1  ON 23
ci_025                 4.370330e-03 3 1  ON 24
ci_026                 4.110445e-03 3 1  ON 25
ci_027                 6.300434e-03 3 1  ON 26
ci_028                 7.549106e-03 3 1  ON 27
ci_029                -6.696524e-03 3 1  ON 28
ci_030                -6.248657e-03 3 1  ON 29
ci_031                -8.291416e-03 3 1  ON 30
ci_032                -8.442267e-03 3 1  ON 31
ci_033                 5.591862e-03 3 1  ON 32
ci_034                 5.248722e-03 3 1  ON 33
ci_035                 3.622436e-03 3 1  ON 34
ci_036                 3.006310e-03 3 1  ON 35
ci_037                 6.287696e-03 3 1  ON 36
ci_038                 7.020405e-03 3 1  ON 37
ci_039                 4.403137e-03 3 1  ON 38
ci_040                 6.102364e-03 3 1  ON 39
ci_041                 4.837400e-03 3 1  ON 40
ci_042                 5.214566e-03 3 1  ON 41
ci_043                 6.269619e-03 3 1  ON 42
ci_044                 5.704902e-03 3 1  ON 43
ci_045                 4.203189e-03 3 1  ON 44
ci_046                 3.536024e-03 3 1  ON 45
ci_047                -1.739632e-03 3 1  ON 46
ci_048                -1.648149e-03 3 1  ON 47
ci_049                 1.813533e-03 3 1  ON 48
ci_050                 2.215138e-03 3 1  ON 49
ci_051                -2.554134e-03 3 1  ON 50
ci_052                -2.700002e-03 3 1  ON 51
ci_053                -2.468668e-03 3 1  ON 52
ci_054                -2.890331e-03 3 1  ON 53
ci_055                -1.551509e-03 3 1  ON 54
ci_056                -1.064050e-03 3 1  ON 55
ci_057                -1.657830e-03 3 1  ON 56
ci_058                -2.065136e-03 3 1  ON 57
ci_059                -1.227443e-04 3 1  ON 58
ci_060                -1.057409e-04 3 1  ON 59
ci_061                -7.519873e-04 3 1  ON 60
ci_062                -9.292719e-04 3 1  ON 61
ci_063                 5.560168e-05 3 1  ON 62
ci_064                -5.314935e-04 3 1  ON 63
ci_065                -2.365963e-03 3 1  ON 64
ci_066                -2.171944e-03 3 1  ON 65
ci_067                -2.344582e-03 3 1  ON 66
ci_068                -2.125353e-03 3 1  ON 67
ci_069                 2.146490e-04 3 1  ON 68
ci_070                 1.088250e-03 3 1  ON 69
ci_071                -2.085878e-03 3 1  ON 70
ci_072                -1.939902e-03 3 1  ON 71
ci_073                 5.890127e-04 3 1  ON 72
ci_074                 4.258330e-04 3 1  ON 73
ci_075                -7.008196e-04 3 1  ON 74
ci_076                -9.092734e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.4741e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORMN2JWARM.s006 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORMN2JWARM.s006 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=6  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2665e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 6
    time step          = 0.05
    reference energy   = -22.5779
    reference variance = 0.471346
====================================================
  Execution time = 2.6060e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORMN2JWARM.s006
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5302e+04
  VMC Eavg = -2.2670e+01
  VMC Evar = 4.9606e-01
  Total weights = 1.954938059e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.7977e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.484217957338
                                         uncertainty =       0.002208798528

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.484217957338
                                         uncertainty =       0.002208798528

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000492004892
  error estimate for blocks of size 2^( 2) =       0.000510051675
  error estimate for blocks of size 2^( 3) =       0.000526572123
  error estimate for blocks of size 2^( 4) =       0.000538206951
  error estimate for blocks of size 2^( 5) =       0.000545264410
  error estimate for blocks of size 2^( 6) =       0.000547688216
  error estimate for blocks of size 2^( 7) =       0.000550354853

      target function =                  N/A
              le_mean =     -22.669586483025
             les_mean =     514.406214236194
             stat err =       0.000545378607
             autocorr =       1.228732528295
              std dev =       0.695799990627
             le_variance =       0.484137626957


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266958648303e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.9062e+00, overlap shift 3.9062e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.669586483161       residual = 1.71e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.669623995974       residual = 3.36e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.669625267634       residual = 6.91e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.669625215431       residual = 1.62e-08           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.669625227253       residual = 8.37e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          4 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 3.9062e+00 is 5.154805e-04

solving harmonic davidson linear method for identity shift 1.5625e+01, overlap shift 1.5625e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.669586483161       residual = 1.71e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.669596209760       residual = 3.30e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.669596539334       residual = 8.10e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.669596524351       residual = 1.65e-08           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.669596526947       residual = 8.93e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          4 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 1.5625e+01 is 1.347861e-04

solving harmonic davidson linear method for identity shift 6.2500e+01, overlap shift 6.2500e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.669586483161       residual = 1.71e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.669588937606       residual = 3.30e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.669589020835       residual = 8.46e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.669589016986       residual = 1.67e-08           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.669589017610       residual = 9.11e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          4 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 6.2500e+01 is 3.408765e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.031411 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0870e+01
  </log>
  <optVariables href="FORMN2JWARM.s006.opt.xml">
ci_001                -7.042713e-01 3 1  ON 0
ci_002                -7.026674e-01 3 1  ON 1
ci_003                -5.383793e-02 3 1  ON 2
ci_004                -5.384681e-02 3 1  ON 3
ci_005                 2.499308e-02 3 1  ON 4
ci_006                 2.418981e-02 3 1  ON 5
ci_007                 1.944134e-02 3 1  ON 6
ci_008                 2.038661e-02 3 1  ON 7
ci_009                -1.574578e-02 3 1  ON 8
ci_010                -1.661800e-02 3 1  ON 9
ci_011                -1.407631e-02 3 1  ON 10
ci_012                -1.380803e-02 3 1  ON 11
ci_013                 1.346091e-02 3 1  ON 12
ci_014                 1.352916e-02 3 1  ON 13
ci_015                 1.628254e-02 3 1  ON 14
ci_016                 1.630291e-02 3 1  ON 15
ci_017                 1.290113e-02 3 1  ON 16
ci_018                 1.288764e-02 3 1  ON 17
ci_019                 4.481584e-03 3 1  ON 18
ci_020                 4.875226e-03 3 1  ON 19
ci_021                -8.149462e-03 3 1  ON 20
ci_022                -9.280971e-03 3 1  ON 21
ci_023                 8.098463e-03 3 1  ON 22
ci_024                 7.688781e-03 3 1  ON 23
ci_025                 4.365340e-03 3 1  ON 24
ci_026                 4.090071e-03 3 1  ON 25
ci_027                 6.309171e-03 3 1  ON 26
ci_028                 7.522286e-03 3 1  ON 27
ci_029                -6.679203e-03 3 1  ON 28
ci_030                -6.245227e-03 3 1  ON 29
ci_031                -8.284648e-03 3 1  ON 30
ci_032                -8.440702e-03 3 1  ON 31
ci_033                 5.598415e-03 3 1  ON 32
ci_034                 5.242843e-03 3 1  ON 33
ci_035                 3.593418e-03 3 1  ON 34
ci_036                 2.982630e-03 3 1  ON 35
ci_037                 6.283462e-03 3 1  ON 36
ci_038                 7.009612e-03 3 1  ON 37
ci_039                 4.429356e-03 3 1  ON 38
ci_040                 6.081092e-03 3 1  ON 39
ci_041                 4.858297e-03 3 1  ON 40
ci_042                 5.227041e-03 3 1  ON 41
ci_043                 6.265010e-03 3 1  ON 42
ci_044                 5.705262e-03 3 1  ON 43
ci_045                 4.193482e-03 3 1  ON 44
ci_046                 3.524092e-03 3 1  ON 45
ci_047                -1.724895e-03 3 1  ON 46
ci_048                -1.631936e-03 3 1  ON 47
ci_049                 1.826355e-03 3 1  ON 48
ci_050                 2.206325e-03 3 1  ON 49
ci_051                -2.533706e-03 3 1  ON 50
ci_052                -2.694374e-03 3 1  ON 51
ci_053                -2.471232e-03 3 1  ON 52
ci_054                -2.873421e-03 3 1  ON 53
ci_055                -1.560759e-03 3 1  ON 54
ci_056                -1.069994e-03 3 1  ON 55
ci_057                -1.653043e-03 3 1  ON 56
ci_058                -2.055232e-03 3 1  ON 57
ci_059                -1.237580e-04 3 1  ON 58
ci_060                -1.117805e-04 3 1  ON 59
ci_061                -7.537865e-04 3 1  ON 60
ci_062                -9.085978e-04 3 1  ON 61
ci_063                 3.640446e-05 3 1  ON 62
ci_064                -5.180274e-04 3 1  ON 63
ci_065                -2.374324e-03 3 1  ON 64
ci_066                -2.176440e-03 3 1  ON 65
ci_067                -2.350241e-03 3 1  ON 66
ci_068                -2.126078e-03 3 1  ON 67
ci_069                 2.150157e-04 3 1  ON 68
ci_070                 1.086490e-03 3 1  ON 69
ci_071                -2.092557e-03 3 1  ON 70
ci_072                -1.942983e-03 3 1  ON 71
ci_073                 5.919077e-04 3 1  ON 72
ci_074                 4.374379e-04 3 1  ON 73
ci_075                -6.974616e-04 3 1  ON 74
ci_076                -9.033924e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 6
    time step          = 0.05
    reference energy   = -22.7583
    reference variance = 0.94572
====================================================
  Execution time = 2.5295e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORMN2JWARM.s006
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2668e+01
  VMC Evar = 4.9879e-01
  Total weights = 1.9551e+06
  Execution time = 3.6695e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.487176573918
                                         uncertainty =       0.003055969446

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.487176573918
                                         uncertainty =       0.003055969446

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000493569372
  error estimate for blocks of size 2^( 2) =       0.000511580648
  error estimate for blocks of size 2^( 3) =       0.000528069891
  error estimate for blocks of size 2^( 4) =       0.000539159603
  error estimate for blocks of size 2^( 5) =       0.000546937461
  error estimate for blocks of size 2^( 6) =       0.000550850695
  error estimate for blocks of size 2^( 7) =       0.000555448061

      target function =                  N/A
              le_mean =     -22.667915775983
             les_mean =     514.333311612865
             stat err =       0.000548098955
             autocorr =       1.233166005331
              std dev =       0.698012499835
             le_variance =       0.487221449926

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.486807934334
                                         uncertainty =       0.003049869965

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.486807934334
                                         uncertainty =       0.003049869965

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000493382670
  error estimate for blocks of size 2^( 2) =       0.000511393525
  error estimate for blocks of size 2^( 3) =       0.000527877796
  error estimate for blocks of size 2^( 4) =       0.000538959856
  error estimate for blocks of size 2^( 5) =       0.000546732501
  error estimate for blocks of size 2^( 6) =       0.000550655101
  error estimate for blocks of size 2^( 7) =       0.000555230436

      target function =                  N/A
              le_mean =     -22.667915821614
             les_mean =     514.337696472913
             stat err =       0.000547894474
             autocorr =       1.233178823423
              std dev =       0.697748463126
             le_variance =       0.486852917794

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.486981793785
                                         uncertainty =       0.003052759369

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.486981793785
                                         uncertainty =       0.003052759369

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000493470731
  error estimate for blocks of size 2^( 2) =       0.000511481728
  error estimate for blocks of size 2^( 3) =       0.000527968272
  error estimate for blocks of size 2^( 4) =       0.000539053981
  error estimate for blocks of size 2^( 5) =       0.000546829121
  error estimate for blocks of size 2^( 6) =       0.000550747384
  error estimate for blocks of size 2^( 7) =       0.000555333878

      target function =                  N/A
              le_mean =     -22.667915287695
             les_mean =     514.333604639273
             stat err =       0.000547991091
             autocorr =       1.233173545727
              std dev =       0.697873000062
             le_variance =       0.487026724215

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.487151582547
                                         uncertainty =       0.003055555010

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.487151582547
                                         uncertainty =       0.003055555010

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000493556717
  error estimate for blocks of size 2^( 2) =       0.000511567950
  error estimate for blocks of size 2^( 3) =       0.000528056849
  error estimate for blocks of size 2^( 4) =       0.000539146044
  error estimate for blocks of size 2^( 5) =       0.000546923552
  error estimate for blocks of size 2^( 6) =       0.000550837405
  error estimate for blocks of size 2^( 7) =       0.000555433364

      target function =                  N/A
              le_mean =     -22.667915651722
             les_mean =     514.333268427704
             stat err =       0.000548085091
             autocorr =       1.233166857470
              std dev =       0.697994602848
             le_variance =       0.487196465604


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.667915775983        initial
     3.9062e+00     3.9062e+01             5.1548e-04       -22.667915821614  <--
     1.5625e+01     1.5625e+02             1.3479e-04       -22.667915287695
     6.2500e+01     6.2500e+02             3.4088e-05       -22.667915651722

*****************************************************************************
Applying the update for shift_i =   3.9062e+00     and shift_s =   3.9062e+01
*****************************************************************************

  Execution time = 4.3638e+01
  </log>
  <optVariables href="FORMN2JWARM.s006.opt.xml">
ci_001                -7.043091e-01 3 1  ON 0
ci_002                -7.027174e-01 3 1  ON 1
ci_003                -5.369525e-02 3 1  ON 2
ci_004                -5.370458e-02 3 1  ON 3
ci_005                 2.461239e-02 3 1  ON 4
ci_006                 2.386819e-02 3 1  ON 5
ci_007                 1.924890e-02 3 1  ON 6
ci_008                 2.013232e-02 3 1  ON 7
ci_009                -1.560891e-02 3 1  ON 8
ci_010                -1.648452e-02 3 1  ON 9
ci_011                -1.396820e-02 3 1  ON 10
ci_012                -1.363904e-02 3 1  ON 11
ci_013                 1.332920e-02 3 1  ON 12
ci_014                 1.338666e-02 3 1  ON 13
ci_015                 1.618299e-02 3 1  ON 14
ci_016                 1.619588e-02 3 1  ON 15
ci_017                 1.285423e-02 3 1  ON 16
ci_018                 1.283916e-02 3 1  ON 17
ci_019                 4.372293e-03 3 1  ON 18
ci_020                 4.775269e-03 3 1  ON 19
ci_021                -8.133013e-03 3 1  ON 20
ci_022                -9.252150e-03 3 1  ON 21
ci_023                 8.100686e-03 3 1  ON 22
ci_024                 7.725908e-03 3 1  ON 23
ci_025                 4.351649e-03 3 1  ON 24
ci_026                 4.031490e-03 3 1  ON 25
ci_027                 6.333916e-03 3 1  ON 26
ci_028                 7.447478e-03 3 1  ON 27
ci_029                -6.628532e-03 3 1  ON 28
ci_030                -6.234627e-03 3 1  ON 29
ci_031                -8.265198e-03 3 1  ON 30
ci_032                -8.436527e-03 3 1  ON 31
ci_033                 5.617372e-03 3 1  ON 32
ci_034                 5.225950e-03 3 1  ON 33
ci_035                 3.511848e-03 3 1  ON 34
ci_036                 2.915832e-03 3 1  ON 35
ci_037                 6.270731e-03 3 1  ON 36
ci_038                 6.977624e-03 3 1  ON 37
ci_039                 4.503185e-03 3 1  ON 38
ci_040                 6.021794e-03 3 1  ON 39
ci_041                 4.917739e-03 3 1  ON 40
ci_042                 5.262882e-03 3 1  ON 41
ci_043                 6.250927e-03 3 1  ON 42
ci_044                 5.705235e-03 3 1  ON 43
ci_045                 4.165590e-03 3 1  ON 44
ci_046                 3.490138e-03 3 1  ON 45
ci_047                -1.683163e-03 3 1  ON 46
ci_048                -1.586011e-03 3 1  ON 47
ci_049                 1.863219e-03 3 1  ON 48
ci_050                 2.180624e-03 3 1  ON 49
ci_051                -2.473602e-03 3 1  ON 50
ci_052                -2.676605e-03 3 1  ON 51
ci_053                -2.479114e-03 3 1  ON 52
ci_054                -2.825286e-03 3 1  ON 53
ci_055                -1.587694e-03 3 1  ON 54
ci_056                -1.086950e-03 3 1  ON 55
ci_057                -1.639504e-03 3 1  ON 56
ci_058                -2.026696e-03 3 1  ON 57
ci_059                -1.270275e-04 3 1  ON 58
ci_060                -1.292892e-04 3 1  ON 59
ci_061                -7.590025e-04 3 1  ON 60
ci_062                -8.491302e-04 3 1  ON 61
ci_063                -1.971768e-05 3 1  ON 62
ci_064                -4.796791e-04 3 1  ON 63
ci_065                -2.397970e-03 3 1  ON 64
ci_066                -2.188787e-03 3 1  ON 65
ci_067                -2.366372e-03 3 1  ON 66
ci_068                -2.128453e-03 3 1  ON 67
ci_069                 2.160363e-04 3 1  ON 68
ci_070                 1.081368e-03 3 1  ON 69
ci_071                -2.111276e-03 3 1  ON 70
ci_072                -1.950872e-03 3 1  ON 71
ci_073                 5.998264e-04 3 1  ON 72
ci_074                 4.695901e-04 3 1  ON 73
ci_075                -6.877636e-04 3 1  ON 74
ci_076                -8.864857e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.4523e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORMN2JWARM.s007 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORMN2JWARM.s007 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=7  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2666e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 7
    time step          = 0.05
    reference energy   = -22.6596
    reference variance = 0.542235
====================================================
  Execution time = 2.5976e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORMN2JWARM.s007
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5261e+04
  VMC Eavg = -2.2668e+01
  VMC Evar = 4.9782e-01
  Total weights = 1.954681708e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.7844e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.487156258406
                                         uncertainty =       0.002586564417

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.487156258406
                                         uncertainty =       0.002586564417

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000493547512
  error estimate for blocks of size 2^( 2) =       0.000511763572
  error estimate for blocks of size 2^( 3) =       0.000528307410
  error estimate for blocks of size 2^( 4) =       0.000540144439
  error estimate for blocks of size 2^( 5) =       0.000546590050
  error estimate for blocks of size 2^( 6) =       0.000549609932
  error estimate for blocks of size 2^( 7) =       0.000551001970

      target function =                  N/A
              le_mean =     -22.668110931755
             les_mean =     514.341073848184
             stat err =       0.000546836598
             autocorr =       1.227600935117
              std dev =       0.697981585741
             le_variance =       0.487178294034


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266811093176e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.7656e-01, overlap shift 9.7656e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.668110931884       residual = 1.84e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.668230927620       residual = 4.71e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.668238699071       residual = 1.55e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.668237981167       residual = 1.86e-08           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.668238041894       residual = 5.32e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          4 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 9.7656e-01 is 1.670977e-03

solving harmonic davidson linear method for identity shift 3.9062e+00, overlap shift 3.9062e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.668110931884       residual = 1.84e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.668145200936       residual = 4.28e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.668147318081       residual = 1.60e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.668147143836       residual = 1.45e-08           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.668147157049       residual = 4.86e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          4 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 3.9062e+00 is 4.919791e-04

solving harmonic davidson linear method for identity shift 1.5625e+01, overlap shift 1.5625e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.668110931884       residual = 1.84e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.668119815251       residual = 4.24e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.668120361339       residual = 1.62e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.668120318786       residual = 1.52e-08           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.668120321920       residual = 5.03e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          4 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 1.5625e+01 is 1.287136e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.036287 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0773e+01
  </log>
  <optVariables href="FORMN2JWARM.s007.opt.xml">
ci_001                -7.043802e-01 3 1  ON 0
ci_002                -7.027664e-01 3 1  ON 1
ci_003                -5.346235e-02 3 1  ON 2
ci_004                -5.350737e-02 3 1  ON 3
ci_005                 2.412041e-02 3 1  ON 4
ci_006                 2.342973e-02 3 1  ON 5
ci_007                 1.891843e-02 3 1  ON 6
ci_008                 1.986236e-02 3 1  ON 7
ci_009                -1.536106e-02 3 1  ON 8
ci_010                -1.631126e-02 3 1  ON 9
ci_011                -1.383249e-02 3 1  ON 10
ci_012                -1.342358e-02 3 1  ON 11
ci_013                 1.321416e-02 3 1  ON 12
ci_014                 1.317531e-02 3 1  ON 13
ci_015                 1.606398e-02 3 1  ON 14
ci_016                 1.606506e-02 3 1  ON 15
ci_017                 1.275751e-02 3 1  ON 16
ci_018                 1.279687e-02 3 1  ON 17
ci_019                 4.293793e-03 3 1  ON 18
ci_020                 4.610092e-03 3 1  ON 19
ci_021                -8.105436e-03 3 1  ON 20
ci_022                -9.231423e-03 3 1  ON 21
ci_023                 8.079237e-03 3 1  ON 22
ci_024                 7.724843e-03 3 1  ON 23
ci_025                 4.404204e-03 3 1  ON 24
ci_026                 3.998941e-03 3 1  ON 25
ci_027                 6.302209e-03 3 1  ON 26
ci_028                 7.389644e-03 3 1  ON 27
ci_029                -6.728991e-03 3 1  ON 28
ci_030                -6.103851e-03 3 1  ON 29
ci_031                -8.186105e-03 3 1  ON 30
ci_032                -8.444302e-03 3 1  ON 31
ci_033                 5.605183e-03 3 1  ON 32
ci_034                 5.188600e-03 3 1  ON 33
ci_035                 3.389179e-03 3 1  ON 34
ci_036                 2.853486e-03 3 1  ON 35
ci_037                 6.234548e-03 3 1  ON 36
ci_038                 6.918736e-03 3 1  ON 37
ci_039                 4.495032e-03 3 1  ON 38
ci_040                 5.973243e-03 3 1  ON 39
ci_041                 4.920431e-03 3 1  ON 40
ci_042                 5.208899e-03 3 1  ON 41
ci_043                 6.287688e-03 3 1  ON 42
ci_044                 5.683687e-03 3 1  ON 43
ci_045                 4.178165e-03 3 1  ON 44
ci_046                 3.550840e-03 3 1  ON 45
ci_047                -1.671768e-03 3 1  ON 46
ci_048                -1.509859e-03 3 1  ON 47
ci_049                 1.877375e-03 3 1  ON 48
ci_050                 2.188282e-03 3 1  ON 49
ci_051                -2.497728e-03 3 1  ON 50
ci_052                -2.603685e-03 3 1  ON 51
ci_053                -2.424637e-03 3 1  ON 52
ci_054                -2.748777e-03 3 1  ON 53
ci_055                -1.601252e-03 3 1  ON 54
ci_056                -1.111817e-03 3 1  ON 55
ci_057                -1.613361e-03 3 1  ON 56
ci_058                -2.017303e-03 3 1  ON 57
ci_059                -5.999054e-05 3 1  ON 58
ci_060                -9.035491e-05 3 1  ON 59
ci_061                -7.680471e-04 3 1  ON 60
ci_062                -7.867353e-04 3 1  ON 61
ci_063                -1.303435e-05 3 1  ON 62
ci_064                -4.385270e-04 3 1  ON 63
ci_065                -2.466932e-03 3 1  ON 64
ci_066                -2.168986e-03 3 1  ON 65
ci_067                -2.365581e-03 3 1  ON 66
ci_068                -2.135525e-03 3 1  ON 67
ci_069                 1.714779e-04 3 1  ON 68
ci_070                 1.027744e-03 3 1  ON 69
ci_071                -2.180964e-03 3 1  ON 70
ci_072                -1.926834e-03 3 1  ON 71
ci_073                 6.000766e-04 3 1  ON 72
ci_074                 4.707764e-04 3 1  ON 73
ci_075                -7.141325e-04 3 1  ON 74
ci_076                -8.366430e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 7
    time step          = 0.05
    reference energy   = -22.6369
    reference variance = 0.212202
====================================================
  Execution time = 2.5322e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORMN2JWARM.s007
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2669e+01
  VMC Evar = 5.0918e-01
  Total weights = 1.9547e+06
  Execution time = 3.6788e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.495027841466
                                         uncertainty =       0.003415128163

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.495027841466
                                         uncertainty =       0.003415128163

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000497507522
  error estimate for blocks of size 2^( 2) =       0.000516016778
  error estimate for blocks of size 2^( 3) =       0.000532489590
  error estimate for blocks of size 2^( 4) =       0.000543925671
  error estimate for blocks of size 2^( 5) =       0.000551031103
  error estimate for blocks of size 2^( 6) =       0.000554327943
  error estimate for blocks of size 2^( 7) =       0.000556914331

      target function =                  N/A
              le_mean =     -22.668587735973
             les_mean =     514.391871544442
             stat err =       0.000551549762
             autocorr =       1.229051554352
              std dev =       0.703581884889
             le_variance =       0.495027468743

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.493951160721
                                         uncertainty =       0.003377204435

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.493951160721
                                         uncertainty =       0.003377204435

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000496965890
  error estimate for blocks of size 2^( 2) =       0.000515469757
  error estimate for blocks of size 2^( 3) =       0.000531930693
  error estimate for blocks of size 2^( 4) =       0.000543363720
  error estimate for blocks of size 2^( 5) =       0.000550449063
  error estimate for blocks of size 2^( 6) =       0.000553723114
  error estimate for blocks of size 2^( 7) =       0.000556288506

      target function =                  N/A
              le_mean =     -22.668602551519
             les_mean =     514.374896814600
             stat err =       0.000550956101
             autocorr =       1.229081922600
              std dev =       0.702815900987
             le_variance =       0.493950190680

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.494359230636
                                         uncertainty =       0.003393252627

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.494359230636
                                         uncertainty =       0.003393252627

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000497171312
  error estimate for blocks of size 2^( 2) =       0.000515677181
  error estimate for blocks of size 2^( 3) =       0.000532143016
  error estimate for blocks of size 2^( 4) =       0.000543578069
  error estimate for blocks of size 2^( 5) =       0.000550672620
  error estimate for blocks of size 2^( 6) =       0.000553954098
  error estimate for blocks of size 2^( 7) =       0.000556529662

      target function =                  N/A
              le_mean =     -22.668589309421
             les_mean =     514.375062777981
             stat err =       0.000551183612
             autocorr =       1.229080906504
              std dev =       0.703106411952
             le_variance =       0.494358626527

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.494950714181
                                         uncertainty =       0.003410771020

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.494950714181
                                         uncertainty =       0.003410771020

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000497468732
  error estimate for blocks of size 2^( 2) =       0.000515978860
  error estimate for blocks of size 2^( 3) =       0.000532451802
  error estimate for blocks of size 2^( 4) =       0.000543880988
  error estimate for blocks of size 2^( 5) =       0.000550982308
  error estimate for blocks of size 2^( 6) =       0.000554271619
  error estimate for blocks of size 2^( 7) =       0.000556863988

      target function =                  N/A
              le_mean =     -22.668584347107
             les_mean =     514.492694600426
             stat err =       0.000551499726
             autocorr =       1.229020209482
              std dev =       0.703527027747
             le_variance =       0.494950278770


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.668587735973        initial
     9.7656e-01     9.7656e+00             1.6710e-03       -22.668602551519  <--
     3.9062e+00     3.9062e+01             4.9198e-04       -22.668589309421
     1.5625e+01     1.5625e+02             1.2871e-04       -22.668584347107

*****************************************************************************
Applying the update for shift_i =   9.7656e-01     and shift_s =   9.7656e+00
*****************************************************************************

  Execution time = 4.5795e+01
  </log>
  <optVariables href="FORMN2JWARM.s007.opt.xml">
ci_001                -7.045676e-01 3 1  ON 0
ci_002                -7.028898e-01 3 1  ON 1
ci_003                -5.280348e-02 3 1  ON 2
ci_004                -5.295236e-02 3 1  ON 3
ci_005                 2.294141e-02 3 1  ON 4
ci_006                 2.237780e-02 3 1  ON 5
ci_007                 1.808199e-02 3 1  ON 6
ci_008                 1.916870e-02 3 1  ON 7
ci_009                -1.474584e-02 3 1  ON 8
ci_010                -1.586892e-02 3 1  ON 9
ci_011                -1.348871e-02 3 1  ON 10
ci_012                -1.287006e-02 3 1  ON 11
ci_013                 1.292198e-02 3 1  ON 12
ci_014                 1.263000e-02 3 1  ON 13
ci_015                 1.574497e-02 3 1  ON 14
ci_016                 1.571623e-02 3 1  ON 15
ci_017                 1.251152e-02 3 1  ON 16
ci_018                 1.269372e-02 3 1  ON 17
ci_019                 4.070664e-03 3 1  ON 18
ci_020                 4.161466e-03 3 1  ON 19
ci_021                -8.041566e-03 3 1  ON 20
ci_022                -9.178291e-03 3 1  ON 21
ci_023                 8.028435e-03 3 1  ON 22
ci_024                 7.725832e-03 3 1  ON 23
ci_025                 4.549049e-03 3 1  ON 24
ci_026                 3.922668e-03 3 1  ON 25
ci_027                 6.232840e-03 3 1  ON 26
ci_028                 7.257986e-03 3 1  ON 27
ci_029                -6.973723e-03 3 1  ON 28
ci_030                -5.759338e-03 3 1  ON 29
ci_031                -7.980663e-03 3 1  ON 30
ci_032                -8.469145e-03 3 1  ON 31
ci_033                 5.570839e-03 3 1  ON 32
ci_034                 5.087728e-03 3 1  ON 33
ci_035                 3.096236e-03 3 1  ON 34
ci_036                 2.704162e-03 3 1  ON 35
ci_037                 6.135027e-03 3 1  ON 36
ci_038                 6.757780e-03 3 1  ON 37
ci_039                 4.481085e-03 3 1  ON 38
ci_040                 5.860830e-03 3 1  ON 39
ci_041                 4.928712e-03 3 1  ON 40
ci_042                 5.079133e-03 3 1  ON 41
ci_043                 6.376709e-03 3 1  ON 42
ci_044                 5.617743e-03 3 1  ON 43
ci_045                 4.215708e-03 3 1  ON 44
ci_046                 3.711498e-03 3 1  ON 45
ci_047                -1.636226e-03 3 1  ON 46
ci_048                -1.325081e-03 3 1  ON 47
ci_049                 1.911445e-03 3 1  ON 48
ci_050                 2.207852e-03 3 1  ON 49
ci_051                -2.539017e-03 3 1  ON 50
ci_052                -2.401364e-03 3 1  ON 51
ci_053                -2.288979e-03 3 1  ON 52
ci_054                -2.558684e-03 3 1  ON 53
ci_055                -1.641541e-03 3 1  ON 54
ci_056                -1.176894e-03 3 1  ON 55
ci_057                -1.547956e-03 3 1  ON 56
ci_058                -1.991737e-03 3 1  ON 57
ci_059                 9.330508e-05 3 1  ON 58
ci_060                -1.922372e-06 3 1  ON 59
ci_061                -7.891732e-04 3 1  ON 60
ci_062                -6.261920e-04 3 1  ON 61
ci_063                -8.775360e-07 3 1  ON 62
ci_064                -3.403725e-04 3 1  ON 63
ci_065                -2.628848e-03 3 1  ON 64
ci_066                -2.116936e-03 3 1  ON 65
ci_067                -2.364844e-03 3 1  ON 66
ci_068                -2.155489e-03 3 1  ON 67
ci_069                 6.000381e-05 3 1  ON 68
ci_070                 8.869113e-04 3 1  ON 69
ci_071                -2.345278e-03 3 1  ON 70
ci_072                -1.858764e-03 3 1  ON 71
ci_073                 5.947762e-04 3 1  ON 72
ci_074                 4.687112e-04 3 1  ON 73
ci_075                -7.771867e-04 3 1  ON 74
ci_076                -7.085442e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.6583e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORMN2JWARM.s008 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORMN2JWARM.s008 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=8  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2663e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 8
    time step          = 0.05
    reference energy   = -22.6533
    reference variance = 0.336338
====================================================
  Execution time = 2.5942e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORMN2JWARM.s008
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5281e+04
  VMC Eavg = -2.2668e+01
  VMC Evar = 5.0265e-01
  Total weights = 1.954973659e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.8104e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.490923727730
                                         uncertainty =       0.002597636537

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.490923727730
                                         uncertainty =       0.002597636537

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000495406806
  error estimate for blocks of size 2^( 2) =       0.000513747126
  error estimate for blocks of size 2^( 3) =       0.000530270500
  error estimate for blocks of size 2^( 4) =       0.000542329702
  error estimate for blocks of size 2^( 5) =       0.000548807760
  error estimate for blocks of size 2^( 6) =       0.000552369041
  error estimate for blocks of size 2^( 7) =       0.000556043239

      target function =                  N/A
              le_mean =     -22.667996230247
             les_mean =     514.340705385689
             stat err =       0.000549887435
             autocorr =       1.232036729523
              std dev =       0.700611023963
             le_variance =       0.490855806898


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266799623025e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.4414e-01, overlap shift 2.4414e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.667996230364       residual = 1.11e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.668229207630       residual = 4.22e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.668243907390       residual = 8.84e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.668245322208       residual = 1.87e-08           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.668245415168       residual = 6.63e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          4 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 2.4414e-01 is 3.077347e-03

solving harmonic davidson linear method for identity shift 9.7656e-01, overlap shift 9.7656e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.667996230364       residual = 1.11e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.668083580570       residual = 2.28e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.668086525308       residual = 1.77e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.668086762817       residual = 3.53e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 9.7656e-01 is 1.232780e-03

solving harmonic davidson linear method for identity shift 3.9062e+00, overlap shift 3.9062e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.667996230364       residual = 1.11e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.668021185291       residual = 1.97e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.668021839076       residual = 2.99e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.668021906652       residual = 4.04e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 3.9062e+00 is 3.622216e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.040913 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0764e+01
  </log>
  <optVariables href="FORMN2JWARM.s008.opt.xml">
ci_001                -7.047068e-01 3 1  ON 0
ci_002                -7.030661e-01 3 1  ON 1
ci_003                -5.226455e-02 3 1  ON 2
ci_004                -5.231582e-02 3 1  ON 3
ci_005                 2.174488e-02 3 1  ON 4
ci_006                 2.114502e-02 3 1  ON 5
ci_007                 1.735207e-02 3 1  ON 6
ci_008                 1.813580e-02 3 1  ON 7
ci_009                -1.421366e-02 3 1  ON 8
ci_010                -1.524131e-02 3 1  ON 9
ci_011                -1.283139e-02 3 1  ON 10
ci_012                -1.230966e-02 3 1  ON 11
ci_013                 1.252470e-02 3 1  ON 12
ci_014                 1.215667e-02 3 1  ON 13
ci_015                 1.534012e-02 3 1  ON 14
ci_016                 1.550019e-02 3 1  ON 15
ci_017                 1.208715e-02 3 1  ON 16
ci_018                 1.254669e-02 3 1  ON 17
ci_019                 3.587894e-03 3 1  ON 18
ci_020                 3.844115e-03 3 1  ON 19
ci_021                -8.051216e-03 3 1  ON 20
ci_022                -8.911455e-03 3 1  ON 21
ci_023                 8.192009e-03 3 1  ON 22
ci_024                 7.924477e-03 3 1  ON 23
ci_025                 4.445810e-03 3 1  ON 24
ci_026                 3.898962e-03 3 1  ON 25
ci_027                 6.674400e-03 3 1  ON 26
ci_028                 7.139255e-03 3 1  ON 27
ci_029                -6.607543e-03 3 1  ON 28
ci_030                -5.860628e-03 3 1  ON 29
ci_031                -7.923726e-03 3 1  ON 30
ci_032                -8.463942e-03 3 1  ON 31
ci_033                 5.417228e-03 3 1  ON 32
ci_034                 4.782686e-03 3 1  ON 33
ci_035                 2.863855e-03 3 1  ON 34
ci_036                 2.287688e-03 3 1  ON 35
ci_037                 6.206958e-03 3 1  ON 36
ci_038                 6.633838e-03 3 1  ON 37
ci_039                 4.774884e-03 3 1  ON 38
ci_040                 5.643514e-03 3 1  ON 39
ci_041                 5.053387e-03 3 1  ON 40
ci_042                 5.039277e-03 3 1  ON 41
ci_043                 6.382284e-03 3 1  ON 42
ci_044                 5.685939e-03 3 1  ON 43
ci_045                 4.031725e-03 3 1  ON 44
ci_046                 3.790257e-03 3 1  ON 45
ci_047                -1.505186e-03 3 1  ON 46
ci_048                -1.118941e-03 3 1  ON 47
ci_049                 1.722843e-03 3 1  ON 48
ci_050                 2.082705e-03 3 1  ON 49
ci_051                -2.367851e-03 3 1  ON 50
ci_052                -2.411365e-03 3 1  ON 51
ci_053                -2.259806e-03 3 1  ON 52
ci_054                -2.401280e-03 3 1  ON 53
ci_055                -1.653668e-03 3 1  ON 54
ci_056                -1.294177e-03 3 1  ON 55
ci_057                -1.694824e-03 3 1  ON 56
ci_058                -2.022677e-03 3 1  ON 57
ci_059                 2.527685e-04 3 1  ON 58
ci_060                -5.336480e-05 3 1  ON 59
ci_061                -6.285466e-04 3 1  ON 60
ci_062                -5.587945e-04 3 1  ON 61
ci_063                 7.966864e-05 3 1  ON 62
ci_064                -3.562530e-04 3 1  ON 63
ci_065                -2.635783e-03 3 1  ON 64
ci_066                -2.171025e-03 3 1  ON 65
ci_067                -2.265096e-03 3 1  ON 66
ci_068                -2.263617e-03 3 1  ON 67
ci_069                 1.244671e-04 3 1  ON 68
ci_070                 7.727050e-04 3 1  ON 69
ci_071                -2.255457e-03 3 1  ON 70
ci_072                -2.043150e-03 3 1  ON 71
ci_073                 4.899361e-04 3 1  ON 72
ci_074                 4.915567e-04 3 1  ON 73
ci_075                -8.023518e-04 3 1  ON 74
ci_076                -5.752481e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 8
    time step          = 0.05
    reference energy   = -22.6706
    reference variance = 0.299568
====================================================
  Execution time = 2.5579e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORMN2JWARM.s008
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2667e+01
  VMC Evar = 5.0255e-01
  Total weights = 1.9550e+06
  Execution time = 3.6906e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.490995519925
                                         uncertainty =       0.003393867681

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.490995519925
                                         uncertainty =       0.003393867681

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000495547151
  error estimate for blocks of size 2^( 2) =       0.000514093427
  error estimate for blocks of size 2^( 3) =       0.000531096974
  error estimate for blocks of size 2^( 4) =       0.000543128382
  error estimate for blocks of size 2^( 5) =       0.000551534214
  error estimate for blocks of size 2^( 6) =       0.000554012469
  error estimate for blocks of size 2^( 7) =       0.000556840495

      target function =                  N/A
              le_mean =     -22.667111524334
             les_mean =     514.340820149682
             stat err =       0.000551378890
             autocorr =       1.238027530432
              std dev =       0.700809501847
             le_variance =       0.491133957880

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.489726085690
                                         uncertainty =       0.003479130800

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.489726085690
                                         uncertainty =       0.003479130800

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000494909543
  error estimate for blocks of size 2^( 2) =       0.000513451548
  error estimate for blocks of size 2^( 3) =       0.000530502255
  error estimate for blocks of size 2^( 4) =       0.000542531069
  error estimate for blocks of size 2^( 5) =       0.000550866527
  error estimate for blocks of size 2^( 6) =       0.000553356018
  error estimate for blocks of size 2^( 7) =       0.000556081695

      target function =                  N/A
              le_mean =     -22.667148491978
             les_mean =     514.376204043480
             stat err =       0.000550708827
             autocorr =       1.238204619116
              std dev =       0.699907787560
             le_variance =       0.489870911087

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.489774794430
                                         uncertainty =       0.003457362933

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.489774794430
                                         uncertainty =       0.003457362933

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000494933906
  error estimate for blocks of size 2^( 2) =       0.000513484753
  error estimate for blocks of size 2^( 3) =       0.000530523216
  error estimate for blocks of size 2^( 4) =       0.000542558991
  error estimate for blocks of size 2^( 5) =       0.000550922654
  error estimate for blocks of size 2^( 6) =       0.000553417735
  error estimate for blocks of size 2^( 7) =       0.000556185318

      target function =                  N/A
              le_mean =     -22.667113590540
             les_mean =     514.303091285795
             stat err =       0.000550771175
             autocorr =       1.238363072507
              std dev =       0.699942241768
             le_variance =       0.489919141811

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.490734156861
                                         uncertainty =       0.003401042937

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.490734156861
                                         uncertainty =       0.003401042937

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000495415760
  error estimate for blocks of size 2^( 2) =       0.000513967952
  error estimate for blocks of size 2^( 3) =       0.000530978392
  error estimate for blocks of size 2^( 4) =       0.000543009371
  error estimate for blocks of size 2^( 5) =       0.000551413963
  error estimate for blocks of size 2^( 6) =       0.000553896387
  error estimate for blocks of size 2^( 7) =       0.000556725454

      target function =                  N/A
              le_mean =     -22.667106059654
             les_mean =     514.313763605451
             stat err =       0.000551261294
             autocorr =       1.238155993971
              std dev =       0.700623686249
             le_variance =       0.490873549734


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.667111524334        initial
     2.4414e-01     2.4414e+00             3.0773e-03       -22.667148491978  <--
     9.7656e-01     9.7656e+00             1.2328e-03       -22.667113590540
     3.9062e+00     3.9062e+01             3.6222e-04       -22.667106059654

*****************************************************************************
Applying the update for shift_i =   2.4414e-01     and shift_s =   2.4414e+00
*****************************************************************************

  Execution time = 4.3963e+01
  </log>
  <optVariables href="FORMN2JWARM.s008.opt.xml">
ci_001                -7.049764e-01 3 1  ON 0
ci_002                -7.033990e-01 3 1  ON 1
ci_003                -5.097491e-02 3 1  ON 2
ci_004                -5.075845e-02 3 1  ON 3
ci_005                 1.993095e-02 3 1  ON 4
ci_006                 1.930046e-02 3 1  ON 5
ci_007                 1.605779e-02 3 1  ON 6
ci_008                 1.632294e-02 3 1  ON 7
ci_009                -1.328073e-02 3 1  ON 8
ci_010                -1.418956e-02 3 1  ON 9
ci_011                -1.162077e-02 3 1  ON 10
ci_012                -1.131489e-02 3 1  ON 11
ci_013                 1.184006e-02 3 1  ON 12
ci_014                 1.130050e-02 3 1  ON 13
ci_015                 1.451637e-02 3 1  ON 14
ci_016                 1.509480e-02 3 1  ON 15
ci_017                 1.130574e-02 3 1  ON 16
ci_018                 1.231768e-02 3 1  ON 17
ci_019                 2.584953e-03 3 1  ON 18
ci_020                 3.151181e-03 3 1  ON 19
ci_021                -8.072192e-03 3 1  ON 20
ci_022                -8.389391e-03 3 1  ON 21
ci_023                 8.465271e-03 3 1  ON 22
ci_024                 8.269073e-03 3 1  ON 23
ci_025                 4.331569e-03 3 1  ON 24
ci_026                 3.905124e-03 3 1  ON 25
ci_027                 7.308851e-03 3 1  ON 26
ci_028                 6.982645e-03 3 1  ON 27
ci_029                -5.899794e-03 3 1  ON 28
ci_030                -5.989302e-03 3 1  ON 29
ci_031                -7.816956e-03 3 1  ON 30
ci_032                -8.490282e-03 3 1  ON 31
ci_033                 5.133140e-03 3 1  ON 32
ci_034                 4.205114e-03 3 1  ON 33
ci_035                 2.518517e-03 3 1  ON 34
ci_036                 1.677081e-03 3 1  ON 35
ci_037                 6.298442e-03 3 1  ON 36
ci_038                 6.369170e-03 3 1  ON 37
ci_039                 5.194363e-03 3 1  ON 38
ci_040                 5.347474e-03 3 1  ON 39
ci_041                 5.251523e-03 3 1  ON 40
ci_042                 4.982390e-03 3 1  ON 41
ci_043                 6.316853e-03 3 1  ON 42
ci_044                 5.738927e-03 3 1  ON 43
ci_045                 3.726362e-03 3 1  ON 44
ci_046                 3.987567e-03 3 1  ON 45
ci_047                -1.286230e-03 3 1  ON 46
ci_048                -7.967935e-04 3 1  ON 47
ci_049                 1.378023e-03 3 1  ON 48
ci_050                 1.843853e-03 3 1  ON 49
ci_051                -1.983645e-03 3 1  ON 50
ci_052                -2.306134e-03 3 1  ON 51
ci_053                -2.261304e-03 3 1  ON 52
ci_054                -2.154696e-03 3 1  ON 53
ci_055                -1.693306e-03 3 1  ON 54
ci_056                -1.532304e-03 3 1  ON 55
ci_057                -1.938494e-03 3 1  ON 56
ci_058                -2.078042e-03 3 1  ON 57
ci_059                 4.715359e-04 3 1  ON 58
ci_060                -1.595110e-04 3 1  ON 59
ci_061                -3.147187e-04 3 1  ON 60
ci_062                -4.360729e-04 3 1  ON 61
ci_063                 2.019290e-04 3 1  ON 62
ci_064                -4.265655e-04 3 1  ON 63
ci_065                -2.645470e-03 3 1  ON 64
ci_066                -2.220764e-03 3 1  ON 65
ci_067                -2.078816e-03 3 1  ON 66
ci_068                -2.467013e-03 3 1  ON 67
ci_069                 2.353167e-04 3 1  ON 68
ci_070                 5.703522e-04 3 1  ON 69
ci_071                -2.062117e-03 3 1  ON 70
ci_072                -2.305149e-03 3 1  ON 71
ci_073                 3.198509e-04 3 1  ON 72
ci_074                 5.275527e-04 3 1  ON 73
ci_075                -8.531681e-04 3 1  ON 74
ci_076                -3.390116e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.4743e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORMN2JWARM.s009 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORMN2JWARM.s009 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=9  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2663e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 9
    time step          = 0.05
    reference energy   = -22.6287
    reference variance = 0.269056
====================================================
  Execution time = 2.6034e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORMN2JWARM.s009
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5266e+04
  VMC Eavg = -2.2669e+01
  VMC Evar = 4.9455e-01
  Total weights = 1.954740281e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.7595e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.484132573058
                                         uncertainty =       0.002770100923

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.484132573058
                                         uncertainty =       0.002770100923

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000492112656
  error estimate for blocks of size 2^( 2) =       0.000511031937
  error estimate for blocks of size 2^( 3) =       0.000527612408
  error estimate for blocks of size 2^( 4) =       0.000540000933
  error estimate for blocks of size 2^( 5) =       0.000548060473
  error estimate for blocks of size 2^( 6) =       0.000549459674
  error estimate for blocks of size 2^( 7) =       0.000550926412

      target function =                  N/A
              le_mean =     -22.669376797785
             les_mean =     514.395198607001
             stat err =       0.000547111873
             autocorr =       1.236013491325
              std dev =       0.695952391960
             le_variance =       0.484349731875


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266937679778e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.1035e-02, overlap shift 6.1035e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.669376797891       residual = 4.48e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.669521281899       residual = 4.24e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.669544864982       residual = 4.03e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.669548642190       residual = 4.08e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.669550104302       residual = 5.28e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.669549991388       residual = 1.15e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.669549965589       residual = 3.29e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 6.1035e-02 is 4.307996e-03

solving harmonic davidson linear method for identity shift 2.4414e-01, overlap shift 2.4414e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.669376797891       residual = 4.48e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.669458269500       residual = 1.81e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.669465055085       residual = 4.94e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.669465388003       residual = 5.86e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 2.4414e-01 is 1.620987e-03

solving harmonic davidson linear method for identity shift 9.7656e-01, overlap shift 9.7656e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.669376797891       residual = 4.48e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.669406483044       residual = 8.24e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.669407888056       residual = 9.21e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.669407955911       residual = 1.01e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 9.7656e-01 is 6.434193e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.045862 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0806e+01
  </log>
  <optVariables href="FORMN2JWARM.s009.opt.xml">
ci_001                -7.054793e-01 3 1  ON 0
ci_002                -7.034557e-01 3 1  ON 1
ci_003                -4.966946e-02 3 1  ON 2
ci_004                -4.913746e-02 3 1  ON 3
ci_005                 1.832346e-02 3 1  ON 4
ci_006                 1.812520e-02 3 1  ON 5
ci_007                 1.494264e-02 3 1  ON 6
ci_008                 1.505445e-02 3 1  ON 7
ci_009                -1.254991e-02 3 1  ON 8
ci_010                -1.325756e-02 3 1  ON 9
ci_011                -1.067670e-02 3 1  ON 10
ci_012                -1.062468e-02 3 1  ON 11
ci_013                 1.056293e-02 3 1  ON 12
ci_014                 1.042864e-02 3 1  ON 13
ci_015                 1.344611e-02 3 1  ON 14
ci_016                 1.462414e-02 3 1  ON 15
ci_017                 1.090176e-02 3 1  ON 16
ci_018                 1.166722e-02 3 1  ON 17
ci_019                 1.384302e-03 3 1  ON 18
ci_020                 1.927024e-03 3 1  ON 19
ci_021                -7.577981e-03 3 1  ON 20
ci_022                -7.747872e-03 3 1  ON 21
ci_023                 8.585950e-03 3 1  ON 22
ci_024                 8.286362e-03 3 1  ON 23
ci_025                 4.691809e-03 3 1  ON 24
ci_026                 3.124868e-03 3 1  ON 25
ci_027                 6.834862e-03 3 1  ON 26
ci_028                 6.656083e-03 3 1  ON 27
ci_029                -5.632531e-03 3 1  ON 28
ci_030                -5.253320e-03 3 1  ON 29
ci_031                -7.703813e-03 3 1  ON 30
ci_032                -8.630178e-03 3 1  ON 31
ci_033                 4.438113e-03 3 1  ON 32
ci_034                 3.895945e-03 3 1  ON 33
ci_035                 1.875337e-03 3 1  ON 34
ci_036                 1.313165e-03 3 1  ON 35
ci_037                 5.661166e-03 3 1  ON 36
ci_038                 6.004839e-03 3 1  ON 37
ci_039                 5.632774e-03 3 1  ON 38
ci_040                 4.852553e-03 3 1  ON 39
ci_041                 5.235990e-03 3 1  ON 40
ci_042                 4.927593e-03 3 1  ON 41
ci_043                 6.318454e-03 3 1  ON 42
ci_044                 5.684056e-03 3 1  ON 43
ci_045                 3.461172e-03 3 1  ON 44
ci_046                 3.051850e-03 3 1  ON 45
ci_047                -5.664420e-04 3 1  ON 46
ci_048                -6.303281e-04 3 1  ON 47
ci_049                 1.062546e-03 3 1  ON 48
ci_050                 1.637277e-03 3 1  ON 49
ci_051                -1.909814e-03 3 1  ON 50
ci_052                -2.269038e-03 3 1  ON 51
ci_053                -2.450155e-03 3 1  ON 52
ci_054                -2.595395e-03 3 1  ON 53
ci_055                -1.299496e-03 3 1  ON 54
ci_056                -1.583581e-03 3 1  ON 55
ci_057                -1.942284e-03 3 1  ON 56
ci_058                -1.945656e-03 3 1  ON 57
ci_059                 6.330601e-04 3 1  ON 58
ci_060                 1.608703e-04 3 1  ON 59
ci_061                -3.810842e-04 3 1  ON 60
ci_062                 3.418020e-05 3 1  ON 61
ci_063                 4.842402e-04 3 1  ON 62
ci_064                 1.185028e-04 3 1  ON 63
ci_065                -2.433388e-03 3 1  ON 64
ci_066                -2.369331e-03 3 1  ON 65
ci_067                -1.807318e-03 3 1  ON 66
ci_068                -2.798010e-03 3 1  ON 67
ci_069                 8.599885e-04 3 1  ON 68
ci_070                 3.948902e-04 3 1  ON 69
ci_071                -2.115258e-03 3 1  ON 70
ci_072                -1.850426e-03 3 1  ON 71
ci_073                 5.293376e-04 3 1  ON 72
ci_074                 3.297629e-04 3 1  ON 73
ci_075                -4.785083e-04 3 1  ON 74
ci_076                -4.447570e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 9
    time step          = 0.05
    reference energy   = -22.641
    reference variance = 0.368564
====================================================
  Execution time = 2.5223e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORMN2JWARM.s009
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2670e+01
  VMC Evar = 5.0008e-01
  Total weights = 1.9549e+06
  Execution time = 3.6584e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.485483880600
                                         uncertainty =       0.002820711638

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.485483880600
                                         uncertainty =       0.002820711638

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000492798715
  error estimate for blocks of size 2^( 2) =       0.000511292765
  error estimate for blocks of size 2^( 3) =       0.000527831150
  error estimate for blocks of size 2^( 4) =       0.000539193333
  error estimate for blocks of size 2^( 5) =       0.000546606530
  error estimate for blocks of size 2^( 6) =       0.000551329800
  error estimate for blocks of size 2^( 7) =       0.000554710444

      target function =                  N/A
              le_mean =     -22.670220798551
             les_mean =     514.450498646105
             stat err =       0.000547960027
             autocorr =       1.236398937214
              std dev =       0.696922625995
             le_variance =       0.485701146624

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.490902682582
                                         uncertainty =       0.007113244784

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.490902682582
                                         uncertainty =       0.007113244784

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000495542035
  error estimate for blocks of size 2^( 2) =       0.000513992698
  error estimate for blocks of size 2^( 3) =       0.000530599695
  error estimate for blocks of size 2^( 4) =       0.000541877740
  error estimate for blocks of size 2^( 5) =       0.000549273376
  error estimate for blocks of size 2^( 6) =       0.000554180940
  error estimate for blocks of size 2^( 7) =       0.000557396181

      target function =                  N/A
              le_mean =     -22.670233862001
             les_mean =     516.257236991219
             stat err =       0.000550682059
             autocorr =       1.234925776393
              std dev =       0.700802266446
             le_variance =       0.491123816656

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.484178541746
                                         uncertainty =       0.002767774150

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.484178541746
                                         uncertainty =       0.002767774150

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000492136340
  error estimate for blocks of size 2^( 2) =       0.000510668098
  error estimate for blocks of size 2^( 3) =       0.000527287118
  error estimate for blocks of size 2^( 4) =       0.000538671226
  error estimate for blocks of size 2^( 5) =       0.000546124110
  error estimate for blocks of size 2^( 6) =       0.000550891914
  error estimate for blocks of size 2^( 7) =       0.000554327697

      target function =                  N/A
              le_mean =     -22.670195392798
             les_mean =     514.470678616593
             stat err =       0.000547503737
             autocorr =       1.237665555815
              std dev =       0.695985886810
             le_variance =       0.484396354638

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.485065990691
                                         uncertainty =       0.002800062974

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.485065990691
                                         uncertainty =       0.002800062974

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000492586805
  error estimate for blocks of size 2^( 2) =       0.000511080902
  error estimate for blocks of size 2^( 3) =       0.000527623703
  error estimate for blocks of size 2^( 4) =       0.000538992558
  error estimate for blocks of size 2^( 5) =       0.000546393926
  error estimate for blocks of size 2^( 6) =       0.000551123704
  error estimate for blocks of size 2^( 7) =       0.000554488555

      target function =                  N/A
              le_mean =     -22.670194843975
             les_mean =     514.484493628920
             stat err =       0.000547749686
             autocorr =       1.236513112951
              std dev =       0.696622939860
             le_variance =       0.485283520339


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.670220798551        initial
     6.1035e-02     6.1035e-01             4.3080e-03       -22.670233862001  <--
     2.4414e-01     2.4414e+00             1.6210e-03       -22.670195392798
     9.7656e-01     9.7656e+00             6.4342e-04       -22.670194843975

*****************************************************************************
Applying the update for shift_i =   6.1035e-02     and shift_s =   6.1035e-01
*****************************************************************************

  Execution time = 4.3570e+01
  </log>
  <optVariables href="FORMN2JWARM.s009.opt.xml">
ci_001                -7.064528e-01 3 1  ON 0
ci_002                -7.030967e-01 3 1  ON 1
ci_003                -4.759617e-02 3 1  ON 2
ci_004                -4.645045e-02 3 1  ON 3
ci_005                 1.736967e-02 3 1  ON 4
ci_006                 1.741543e-02 3 1  ON 5
ci_007                 1.407895e-02 3 1  ON 6
ci_008                 1.404717e-02 3 1  ON 7
ci_009                -1.200832e-02 3 1  ON 8
ci_010                -1.251788e-02 3 1  ON 9
ci_011                -9.914910e-03 3 1  ON 10
ci_012                -1.003341e-02 3 1  ON 11
ci_013                 9.428316e-03 3 1  ON 12
ci_014                 9.700310e-03 3 1  ON 13
ci_015                 1.239458e-02 3 1  ON 14
ci_016                 1.415764e-02 3 1  ON 15
ci_017                 1.059764e-02 3 1  ON 16
ci_018                 1.123699e-02 3 1  ON 17
ci_019                 2.316501e-05 3 1  ON 18
ci_020                 6.426324e-04 3 1  ON 19
ci_021                -7.060270e-03 3 1  ON 20
ci_022                -7.030232e-03 3 1  ON 21
ci_023                 8.692647e-03 3 1  ON 22
ci_024                 8.305269e-03 3 1  ON 23
ci_025                 5.218881e-03 3 1  ON 24
ci_026                 2.553391e-03 3 1  ON 25
ci_027                 6.558361e-03 3 1  ON 26
ci_028                 6.473802e-03 3 1  ON 27
ci_029                -5.414337e-03 3 1  ON 28
ci_030                -4.574308e-03 3 1  ON 29
ci_031                -7.659045e-03 3 1  ON 30
ci_032                -8.853543e-03 3 1  ON 31
ci_033                 3.834097e-03 3 1  ON 32
ci_034                 3.687984e-03 3 1  ON 33
ci_035                 1.515633e-03 3 1  ON 34
ci_036                 1.071729e-03 3 1  ON 35
ci_037                 5.037434e-03 3 1  ON 36
ci_038                 5.617072e-03 3 1  ON 37
ci_039                 5.911376e-03 3 1  ON 38
ci_040                 4.568629e-03 3 1  ON 39
ci_041                 5.230102e-03 3 1  ON 40
ci_042                 4.898170e-03 3 1  ON 41
ci_043                 6.249574e-03 3 1  ON 42
ci_044                 5.601334e-03 3 1  ON 43
ci_045                 3.319882e-03 3 1  ON 44
ci_046                 2.311222e-03 3 1  ON 45
ci_047                -1.523690e-04 3 1  ON 46
ci_048                -4.996993e-04 3 1  ON 47
ci_049                 7.770164e-04 3 1  ON 48
ci_050                 1.460315e-03 3 1  ON 49
ci_051                -1.761045e-03 3 1  ON 50
ci_052                -2.156627e-03 3 1  ON 51
ci_053                -2.705876e-03 3 1  ON 52
ci_054                -3.025188e-03 3 1  ON 53
ci_055                -9.628280e-04 3 1  ON 54
ci_056                -1.598153e-03 3 1  ON 55
ci_057                -1.936419e-03 3 1  ON 56
ci_058                -1.834284e-03 3 1  ON 57
ci_059                 7.128536e-04 3 1  ON 58
ci_060                 3.470450e-04 3 1  ON 59
ci_061                -4.315500e-04 3 1  ON 60
ci_062                 3.863043e-04 3 1  ON 61
ci_063                 6.482717e-04 3 1  ON 62
ci_064                 5.700963e-04 3 1  ON 63
ci_065                -2.287966e-03 3 1  ON 64
ci_066                -2.504087e-03 3 1  ON 65
ci_067                -1.589817e-03 3 1  ON 66
ci_068                -3.073553e-03 3 1  ON 67
ci_069                 1.332584e-03 3 1  ON 68
ci_070                 2.491540e-04 3 1  ON 69
ci_071                -2.076289e-03 3 1  ON 70
ci_072                -1.412308e-03 3 1  ON 71
ci_073                 6.300241e-04 3 1  ON 72
ci_074                 1.909005e-04 3 1  ON 73
ci_075                -1.955291e-04 3 1  ON 74
ci_076                -5.133065e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.4391e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORMN2JWARM.s010 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORMN2JWARM.s010 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=10  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2660e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 10
    time step          = 0.05
    reference energy   = -22.6086
    reference variance = 0.431439
====================================================
  Execution time = 2.5942e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORMN2JWARM.s010
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5271e+04
  VMC Eavg = -2.2669e+01
  VMC Evar = 5.0783e-01
  Total weights = 1.954849259e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.7606e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.490211608932
                                         uncertainty =       0.003259631387

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.490211608932
                                         uncertainty =       0.003259631387

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000495008015
  error estimate for blocks of size 2^( 2) =       0.000513293566
  error estimate for blocks of size 2^( 3) =       0.000530080961
  error estimate for blocks of size 2^( 4) =       0.000541365175
  error estimate for blocks of size 2^( 5) =       0.000547215108
  error estimate for blocks of size 2^( 6) =       0.000550647625
  error estimate for blocks of size 2^( 7) =       0.000552880888

      target function =                  N/A
              le_mean =     -22.669119785701
             les_mean =     514.396825035417
             stat err =       0.000548027199
             autocorr =       1.225687523475
              std dev =       0.700047047706
             le_variance =       0.490065869002


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266911978570e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5259e-02, overlap shift 1.5259e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.669119785816       residual = 2.96e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.669230448002       residual = 3.55e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.669238047096       residual = 9.00e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.669252445536       residual = 1.54e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.669254363050       residual = 1.41e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.669253974961       residual = 1.14e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.669254125216       residual = 1.30e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 1.5259e-02 is 7.796629e-03

solving harmonic davidson linear method for identity shift 6.1035e-02, overlap shift 6.1035e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.669119785816       residual = 2.96e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.669207571528       residual = 2.22e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.669210570594       residual = 2.90e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.669215688099       residual = 2.50e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.669216179061       residual = 1.53e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.669216043212       residual = 9.85e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          5 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 6.1035e-02 is 4.559944e-03

solving harmonic davidson linear method for identity shift 2.4414e-01, overlap shift 2.4414e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.669119785816       residual = 2.96e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.669167837156       residual = 7.54e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.669168503106       residual = 2.59e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.669169042494       residual = 5.78e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 2.4414e-01 is 1.731931e-03

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.051259 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0714e+01
  </log>
  <optVariables href="FORMN2JWARM.s010.opt.xml">
ci_001                -7.066914e-01 3 1  ON 0
ci_002                -7.034724e-01 3 1  ON 1
ci_003                -4.428531e-02 3 1  ON 2
ci_004                -4.189051e-02 3 1  ON 3
ci_005                 1.702280e-02 3 1  ON 4
ci_006                 1.728189e-02 3 1  ON 5
ci_007                 1.329782e-02 3 1  ON 6
ci_008                 1.288888e-02 3 1  ON 7
ci_009                -1.238630e-02 3 1  ON 8
ci_010                -1.150432e-02 3 1  ON 9
ci_011                -1.047145e-02 3 1  ON 10
ci_012                -8.387298e-03 3 1  ON 11
ci_013                 9.756624e-03 3 1  ON 12
ci_014                 9.074312e-03 3 1  ON 13
ci_015                 1.335234e-02 3 1  ON 14
ci_016                 1.590139e-02 3 1  ON 15
ci_017                 1.027611e-02 3 1  ON 16
ci_018                 1.050379e-02 3 1  ON 17
ci_019                -3.055243e-04 3 1  ON 18
ci_020                -7.572765e-04 3 1  ON 19
ci_021                -7.953188e-03 3 1  ON 20
ci_022                -7.504928e-03 3 1  ON 21
ci_023                 6.889045e-03 3 1  ON 22
ci_024                 7.078610e-03 3 1  ON 23
ci_025                 4.084365e-03 3 1  ON 24
ci_026                 3.095358e-03 3 1  ON 25
ci_027                 6.378805e-03 3 1  ON 26
ci_028                 6.683072e-03 3 1  ON 27
ci_029                -4.662065e-03 3 1  ON 28
ci_030                -4.221855e-03 3 1  ON 29
ci_031                -9.326136e-03 3 1  ON 30
ci_032                -8.638780e-03 3 1  ON 31
ci_033                 4.137735e-03 3 1  ON 32
ci_034                 5.109389e-03 3 1  ON 33
ci_035                 1.561245e-03 3 1  ON 34
ci_036                 9.471924e-04 3 1  ON 35
ci_037                 5.184083e-03 3 1  ON 36
ci_038                 4.696324e-03 3 1  ON 37
ci_039                 5.623818e-03 3 1  ON 38
ci_040                 6.284361e-03 3 1  ON 39
ci_041                 5.934892e-03 3 1  ON 40
ci_042                 4.407487e-03 3 1  ON 41
ci_043                 6.044429e-03 3 1  ON 42
ci_044                 4.592196e-03 3 1  ON 43
ci_045                 1.657464e-03 3 1  ON 44
ci_046                 2.530799e-03 3 1  ON 45
ci_047                -3.942008e-04 3 1  ON 46
ci_048                -4.052309e-04 3 1  ON 47
ci_049                 8.161697e-04 3 1  ON 48
ci_050                 4.979120e-04 3 1  ON 49
ci_051                -1.061197e-03 3 1  ON 50
ci_052                -1.063570e-03 3 1  ON 51
ci_053                -3.255433e-03 3 1  ON 52
ci_054                -3.825123e-03 3 1  ON 53
ci_055                -5.135870e-04 3 1  ON 54
ci_056                -1.409934e-03 3 1  ON 55
ci_057                -2.060316e-03 3 1  ON 56
ci_058                -2.035073e-03 3 1  ON 57
ci_059                 6.353531e-05 3 1  ON 58
ci_060                -6.945291e-06 3 1  ON 59
ci_061                 6.453360e-04 3 1  ON 60
ci_062                -1.143468e-03 3 1  ON 61
ci_063                -5.289303e-04 3 1  ON 62
ci_064                -3.097316e-04 3 1  ON 63
ci_065                -2.061584e-03 3 1  ON 64
ci_066                -4.032740e-03 3 1  ON 65
ci_067                -9.282213e-04 3 1  ON 66
ci_068                -1.383900e-03 3 1  ON 67
ci_069                 1.316564e-03 3 1  ON 68
ci_070                -3.444524e-05 3 1  ON 69
ci_071                -4.704226e-04 3 1  ON 70
ci_072                -1.233003e-03 3 1  ON 71
ci_073                -6.419700e-04 3 1  ON 72
ci_074                -6.498012e-04 3 1  ON 73
ci_075                 5.160881e-04 3 1  ON 74
ci_076                -1.072105e-03 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 10
    time step          = 0.05
    reference energy   = -22.7686
    reference variance = 0.480452
====================================================
  Execution time = 2.5252e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORMN2JWARM.s010
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2668e+01
  VMC Evar = 5.0145e-01
  Total weights = 1.9552e+06
  Execution time = 3.6759e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.488632974922
                                         uncertainty =       0.002790823890

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.488632974922
                                         uncertainty =       0.002790823890

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000494271700
  error estimate for blocks of size 2^( 2) =       0.000512907101
  error estimate for blocks of size 2^( 3) =       0.000529736422
  error estimate for blocks of size 2^( 4) =       0.000542641714
  error estimate for blocks of size 2^( 5) =       0.000550578679
  error estimate for blocks of size 2^( 6) =       0.000553926310
  error estimate for blocks of size 2^( 7) =       0.000555962971

      target function =                  N/A
              le_mean =     -22.668554417885
             les_mean =     514.385545786801
             stat err =       0.000550777418
             autocorr =       1.241711666514
              std dev =       0.699005741869
             le_variance =       0.488609027165

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.487494621405
                                         uncertainty =       0.002552762187

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.487494621405
                                         uncertainty =       0.002552762187

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000493696196
  error estimate for blocks of size 2^( 2) =       0.000512366103
  error estimate for blocks of size 2^( 3) =       0.000529190094
  error estimate for blocks of size 2^( 4) =       0.000542042806
  error estimate for blocks of size 2^( 5) =       0.000549890079
  error estimate for blocks of size 2^( 6) =       0.000553267068
  error estimate for blocks of size 2^( 7) =       0.000555229719

      target function =                  N/A
              le_mean =     -22.668417252473
             les_mean =     514.414327421497
             stat err =       0.000550107418
             autocorr =       1.241582094050
              std dev =       0.698191856319
             le_variance =       0.487471868230

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.520766466555
                                         uncertainty =       0.029817113387

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.520766466555
                                         uncertainty =       0.029817113387

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000510262896
  error estimate for blocks of size 2^( 2) =       0.000528544478
  error estimate for blocks of size 2^( 3) =       0.000544825480
  error estimate for blocks of size 2^( 4) =       0.000557470104
  error estimate for blocks of size 2^( 5) =       0.000565070399
  error estimate for blocks of size 2^( 6) =       0.000567939083
  error estimate for blocks of size 2^( 7) =       0.000570036186

      target function =                  N/A
              le_mean =     -22.668373511844
             les_mean =     516.498437671708
             stat err =       0.000565128943
             autocorr =       1.226611750825
              std dev =       0.721620708192
             le_variance =       0.520736446491

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.488068974860
                                         uncertainty =       0.002737996482

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.488068974860
                                         uncertainty =       0.002737996482

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000493985997
  error estimate for blocks of size 2^( 2) =       0.000512645050
  error estimate for blocks of size 2^( 3) =       0.000529464755
  error estimate for blocks of size 2^( 4) =       0.000542336129
  error estimate for blocks of size 2^( 5) =       0.000550178761
  error estimate for blocks of size 2^( 6) =       0.000553583750
  error estimate for blocks of size 2^( 7) =       0.000555660095

      target function =                  N/A
              le_mean =     -22.668413684744
             les_mean =     514.377601187208
             stat err =       0.000550439684
             autocorr =       1.241624282476
              std dev =       0.698601696197
             le_variance =       0.488044329929


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.668554417885        initial  <--
     1.5259e-02     1.5259e-01             7.7966e-03       -22.668417252473
     6.1035e-02     6.1035e-01             4.5599e-03       -22.668373511844
     2.4414e-01     2.4414e+00             1.7319e-03       -22.668413684744

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 43.6240
  </log>
  <optVariables href="FORMN2JWARM.s010.opt.xml">
ci_001                -7.064528e-01 3 1  ON 0
ci_002                -7.030967e-01 3 1  ON 1
ci_003                -4.759617e-02 3 1  ON 2
ci_004                -4.645045e-02 3 1  ON 3
ci_005                 1.736967e-02 3 1  ON 4
ci_006                 1.741543e-02 3 1  ON 5
ci_007                 1.407895e-02 3 1  ON 6
ci_008                 1.404717e-02 3 1  ON 7
ci_009                -1.200832e-02 3 1  ON 8
ci_010                -1.251788e-02 3 1  ON 9
ci_011                -9.914910e-03 3 1  ON 10
ci_012                -1.003341e-02 3 1  ON 11
ci_013                 9.428316e-03 3 1  ON 12
ci_014                 9.700310e-03 3 1  ON 13
ci_015                 1.239458e-02 3 1  ON 14
ci_016                 1.415764e-02 3 1  ON 15
ci_017                 1.059764e-02 3 1  ON 16
ci_018                 1.123699e-02 3 1  ON 17
ci_019                 2.316501e-05 3 1  ON 18
ci_020                 6.426324e-04 3 1  ON 19
ci_021                -7.060270e-03 3 1  ON 20
ci_022                -7.030232e-03 3 1  ON 21
ci_023                 8.692647e-03 3 1  ON 22
ci_024                 8.305269e-03 3 1  ON 23
ci_025                 5.218881e-03 3 1  ON 24
ci_026                 2.553391e-03 3 1  ON 25
ci_027                 6.558361e-03 3 1  ON 26
ci_028                 6.473802e-03 3 1  ON 27
ci_029                -5.414337e-03 3 1  ON 28
ci_030                -4.574308e-03 3 1  ON 29
ci_031                -7.659045e-03 3 1  ON 30
ci_032                -8.853543e-03 3 1  ON 31
ci_033                 3.834097e-03 3 1  ON 32
ci_034                 3.687984e-03 3 1  ON 33
ci_035                 1.515633e-03 3 1  ON 34
ci_036                 1.071729e-03 3 1  ON 35
ci_037                 5.037434e-03 3 1  ON 36
ci_038                 5.617072e-03 3 1  ON 37
ci_039                 5.911376e-03 3 1  ON 38
ci_040                 4.568629e-03 3 1  ON 39
ci_041                 5.230102e-03 3 1  ON 40
ci_042                 4.898170e-03 3 1  ON 41
ci_043                 6.249574e-03 3 1  ON 42
ci_044                 5.601334e-03 3 1  ON 43
ci_045                 3.319882e-03 3 1  ON 44
ci_046                 2.311222e-03 3 1  ON 45
ci_047                -1.523690e-04 3 1  ON 46
ci_048                -4.996993e-04 3 1  ON 47
ci_049                 7.770164e-04 3 1  ON 48
ci_050                 1.460315e-03 3 1  ON 49
ci_051                -1.761045e-03 3 1  ON 50
ci_052                -2.156627e-03 3 1  ON 51
ci_053                -2.705876e-03 3 1  ON 52
ci_054                -3.025188e-03 3 1  ON 53
ci_055                -9.628280e-04 3 1  ON 54
ci_056                -1.598153e-03 3 1  ON 55
ci_057                -1.936419e-03 3 1  ON 56
ci_058                -1.834284e-03 3 1  ON 57
ci_059                 7.128536e-04 3 1  ON 58
ci_060                 3.470450e-04 3 1  ON 59
ci_061                -4.315500e-04 3 1  ON 60
ci_062                 3.863043e-04 3 1  ON 61
ci_063                 6.482717e-04 3 1  ON 62
ci_064                 5.700963e-04 3 1  ON 63
ci_065                -2.287966e-03 3 1  ON 64
ci_066                -2.504087e-03 3 1  ON 65
ci_067                -1.589817e-03 3 1  ON 66
ci_068                -3.073553e-03 3 1  ON 67
ci_069                 1.332584e-03 3 1  ON 68
ci_070                 2.491540e-04 3 1  ON 69
ci_071                -2.076289e-03 3 1  ON 70
ci_072                -1.412308e-03 3 1  ON 71
ci_073                 6.300241e-04 3 1  ON 72
ci_074                 1.909005e-04 3 1  ON 73
ci_075                -1.955291e-04 3 1  ON 74
ci_076                -5.133065e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.4354e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORMN2JWARM.s011 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORMN2JWARM.s011 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=11  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2663e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 11
    time step          = 0.05
    reference energy   = -22.5815
    reference variance = 0.407436
====================================================
  Execution time = 2.6039e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORMN2JWARM.s011
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5297e+04
  VMC Eavg = -2.2669e+01
  VMC Evar = 4.9188e-01
  Total weights = 1.954975224e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.7628e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.481358961973
                                         uncertainty =       0.002443279446

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.481358961973
                                         uncertainty =       0.002443279446

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000490589954
  error estimate for blocks of size 2^( 2) =       0.000509250951
  error estimate for blocks of size 2^( 3) =       0.000526590511
  error estimate for blocks of size 2^( 4) =       0.000539141102
  error estimate for blocks of size 2^( 5) =       0.000547325450
  error estimate for blocks of size 2^( 6) =       0.000550565503
  error estimate for blocks of size 2^( 7) =       0.000552713692

      target function =                  N/A
              le_mean =     -22.669304361700
             les_mean =     514.389237278571
             stat err =       0.000547436437
             autocorr =       1.245174161779
              std dev =       0.693798965822
             le_variance =       0.481357004976


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266930436170e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5259e-01, overlap shift 1.5259e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.669304361790       residual = 2.24e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.669338344934       residual = 9.29e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.669343493654       residual = 4.46e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.669343882694       residual = 1.95e-08           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.669343908037       residual = 1.37e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          4 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 1.5259e-01 is 2.923825e-03

solving harmonic davidson linear method for identity shift 6.1035e-01, overlap shift 6.1035e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.669304361790       residual = 2.24e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.669317350536       residual = 2.26e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.669318273530       residual = 2.59e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.669318273719       residual = 4.94e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 6.1035e-01 is 8.850431e-04

solving harmonic davidson linear method for identity shift 2.4414e+00, overlap shift 2.4414e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.669304361790       residual = 2.24e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.669308103690       residual = 1.87e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.669308297427       residual = 2.50e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.669308296151       residual = 2.97e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 2.4414e+00 is 2.333766e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.055783 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0813e+01
  </log>
  <optVariables href="FORMN2JWARM.s011.opt.xml">
ci_001                -7.063748e-01 3 1  ON 0
ci_002                -7.033099e-01 3 1  ON 1
ci_003                -4.671113e-02 3 1  ON 2
ci_004                -4.577910e-02 3 1  ON 3
ci_005                 1.733407e-02 3 1  ON 4
ci_006                 1.735519e-02 3 1  ON 5
ci_007                 1.405769e-02 3 1  ON 6
ci_008                 1.388613e-02 3 1  ON 7
ci_009                -1.199098e-02 3 1  ON 8
ci_010                -1.203507e-02 3 1  ON 9
ci_011                -9.655762e-03 3 1  ON 10
ci_012                -9.672204e-03 3 1  ON 11
ci_013                 9.412184e-03 3 1  ON 12
ci_014                 9.652121e-03 3 1  ON 13
ci_015                 1.242639e-02 3 1  ON 14
ci_016                 1.371014e-02 3 1  ON 15
ci_017                 1.056217e-02 3 1  ON 16
ci_018                 1.126235e-02 3 1  ON 17
ci_019                -2.312268e-04 3 1  ON 18
ci_020                 2.317092e-04 3 1  ON 19
ci_021                -7.067564e-03 3 1  ON 20
ci_022                -7.257055e-03 3 1  ON 21
ci_023                 8.385261e-03 3 1  ON 22
ci_024                 8.358873e-03 3 1  ON 23
ci_025                 5.082996e-03 3 1  ON 24
ci_026                 2.879010e-03 3 1  ON 25
ci_027                 6.574529e-03 3 1  ON 26
ci_028                 6.579188e-03 3 1  ON 27
ci_029                -5.326989e-03 3 1  ON 28
ci_030                -4.616912e-03 3 1  ON 29
ci_031                -7.746262e-03 3 1  ON 30
ci_032                -9.138118e-03 3 1  ON 31
ci_033                 4.186386e-03 3 1  ON 32
ci_034                 3.945128e-03 3 1  ON 33
ci_035                 1.435611e-03 3 1  ON 34
ci_036                 1.156340e-03 3 1  ON 35
ci_037                 4.885506e-03 3 1  ON 36
ci_038                 5.555643e-03 3 1  ON 37
ci_039                 6.008128e-03 3 1  ON 38
ci_040                 4.856234e-03 3 1  ON 39
ci_041                 5.109142e-03 3 1  ON 40
ci_042                 4.947005e-03 3 1  ON 41
ci_043                 5.941430e-03 3 1  ON 42
ci_044                 5.674857e-03 3 1  ON 43
ci_045                 3.144259e-03 3 1  ON 44
ci_046                 2.292335e-03 3 1  ON 45
ci_047                -2.941176e-04 3 1  ON 46
ci_048                -6.547624e-04 3 1  ON 47
ci_049                 1.050481e-03 3 1  ON 48
ci_050                 1.484665e-03 3 1  ON 49
ci_051                -1.706284e-03 3 1  ON 50
ci_052                -1.847050e-03 3 1  ON 51
ci_053                -2.751768e-03 3 1  ON 52
ci_054                -2.986142e-03 3 1  ON 53
ci_055                -9.753597e-04 3 1  ON 54
ci_056                -1.350583e-03 3 1  ON 55
ci_057                -1.925680e-03 3 1  ON 56
ci_058                -1.665429e-03 3 1  ON 57
ci_059                 6.228490e-04 3 1  ON 58
ci_060                 4.158358e-04 3 1  ON 59
ci_061                -2.800415e-04 3 1  ON 60
ci_062                 4.791390e-04 3 1  ON 61
ci_063                 3.840520e-04 3 1  ON 62
ci_064                 6.772083e-04 3 1  ON 63
ci_065                -2.470166e-03 3 1  ON 64
ci_066                -2.483244e-03 3 1  ON 65
ci_067                -1.582689e-03 3 1  ON 66
ci_068                -2.837510e-03 3 1  ON 67
ci_069                 8.481381e-04 3 1  ON 68
ci_070                 8.720770e-05 3 1  ON 69
ci_071                -2.063709e-03 3 1  ON 70
ci_072                -2.012990e-03 3 1  ON 71
ci_073                 4.018844e-04 3 1  ON 72
ci_074                 3.752437e-04 3 1  ON 73
ci_075                -2.835836e-04 3 1  ON 74
ci_076                -5.050415e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 11
    time step          = 0.05
    reference energy   = -22.5403
    reference variance = 0.431825
====================================================
  Execution time = 2.5453e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORMN2JWARM.s011
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2669e+01
  VMC Evar = 5.0044e-01
  Total weights = 1.9551e+06
  Execution time = 3.6436e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.487371727019
                                         uncertainty =       0.002871713763

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.487371727019
                                         uncertainty =       0.002871713763

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000493654304
  error estimate for blocks of size 2^( 2) =       0.000512262194
  error estimate for blocks of size 2^( 3) =       0.000528789360
  error estimate for blocks of size 2^( 4) =       0.000540000065
  error estimate for blocks of size 2^( 5) =       0.000546999724
  error estimate for blocks of size 2^( 6) =       0.000550230688
  error estimate for blocks of size 2^( 7) =       0.000552583497

      target function =                  N/A
              le_mean =     -22.669286631029
             les_mean =     514.398415318114
             stat err =       0.000547453494
             autocorr =       1.229839980167
              std dev =       0.698132612078
             le_variance =       0.487389144046

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.487337982734
                                         uncertainty =       0.002941809378

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.487337982734
                                         uncertainty =       0.002941809378

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000493637921
  error estimate for blocks of size 2^( 2) =       0.000512249005
  error estimate for blocks of size 2^( 3) =       0.000528767576
  error estimate for blocks of size 2^( 4) =       0.000539955629
  error estimate for blocks of size 2^( 5) =       0.000546950852
  error estimate for blocks of size 2^( 6) =       0.000550194555
  error estimate for blocks of size 2^( 7) =       0.000552571515

      target function =                  N/A
              le_mean =     -22.669304975761
             les_mean =     514.409046579480
             stat err =       0.000547418138
             autocorr =       1.229762756032
              std dev =       0.698109443434
             le_variance =       0.487356795012

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.487418146553
                                         uncertainty =       0.002913698822

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.487418146553
                                         uncertainty =       0.002913698822

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000493678196
  error estimate for blocks of size 2^( 2) =       0.000512300296
  error estimate for blocks of size 2^( 3) =       0.000528826122
  error estimate for blocks of size 2^( 4) =       0.000540017116
  error estimate for blocks of size 2^( 5) =       0.000547004270
  error estimate for blocks of size 2^( 6) =       0.000550240283
  error estimate for blocks of size 2^( 7) =       0.000552606881

      target function =                  N/A
              le_mean =     -22.669284415456
             les_mean =     514.605538126389
             stat err =       0.000547467137
             autocorr =       1.229782239043
              std dev =       0.698166400840
             le_variance =       0.487436323262

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.487339423755
                                         uncertainty =       0.002879041495

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.487339423755
                                         uncertainty =       0.002879041495

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000493638028
  error estimate for blocks of size 2^( 2) =       0.000512246198
  error estimate for blocks of size 2^( 3) =       0.000528773275
  error estimate for blocks of size 2^( 4) =       0.000539981746
  error estimate for blocks of size 2^( 5) =       0.000546980059
  error estimate for blocks of size 2^( 6) =       0.000550213400
  error estimate for blocks of size 2^( 7) =       0.000552566597

      target function =                  N/A
              le_mean =     -22.669284617822
             les_mean =     514.397209800787
             stat err =       0.000547435450
             autocorr =       1.229840011051
              std dev =       0.698109594049
             le_variance =       0.487357005304


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.669286631029        initial
     1.5259e-01     1.5259e+00             2.9238e-03       -22.669304975761  <--
     6.1035e-01     6.1035e+00             8.8504e-04       -22.669284415456
     2.4414e+00     2.4414e+01             2.3338e-04       -22.669284617822

*****************************************************************************
Applying the update for shift_i =   1.5259e-01     and shift_s =   1.5259e+00
*****************************************************************************

  Execution time = 4.5727e+01
  </log>
  <optVariables href="FORMN2JWARM.s011.opt.xml">
ci_001                -7.060930e-01 3 1  ON 0
ci_002                -7.038743e-01 3 1  ON 1
ci_003                -4.467235e-02 3 1  ON 2
ci_004                -4.430357e-02 3 1  ON 3
ci_005                 1.728646e-02 3 1  ON 4
ci_006                 1.729397e-02 3 1  ON 5
ci_007                 1.402868e-02 3 1  ON 6
ci_008                 1.369202e-02 3 1  ON 7
ci_009                -1.198887e-02 3 1  ON 8
ci_010                -1.136442e-02 3 1  ON 9
ci_011                -9.218542e-03 3 1  ON 10
ci_012                -9.129068e-03 3 1  ON 11
ci_013                 9.366751e-03 3 1  ON 12
ci_014                 9.607890e-03 3 1  ON 13
ci_015                 1.247962e-02 3 1  ON 14
ci_016                 1.294670e-02 3 1  ON 15
ci_017                 1.058124e-02 3 1  ON 16
ci_018                 1.128301e-02 3 1  ON 17
ci_019                -6.599147e-04 3 1  ON 18
ci_020                -4.885107e-04 3 1  ON 19
ci_021                -7.062582e-03 3 1  ON 20
ci_022                -7.606458e-03 3 1  ON 21
ci_023                 7.973604e-03 3 1  ON 22
ci_024                 8.426729e-03 3 1  ON 23
ci_025                 4.900129e-03 3 1  ON 24
ci_026                 3.451654e-03 3 1  ON 25
ci_027                 6.586563e-03 3 1  ON 26
ci_028                 6.689674e-03 3 1  ON 27
ci_029                -5.181700e-03 3 1  ON 28
ci_030                -4.638471e-03 3 1  ON 29
ci_031                -7.897545e-03 3 1  ON 30
ci_032                -9.582012e-03 3 1  ON 31
ci_033                 4.730270e-03 3 1  ON 32
ci_034                 4.332169e-03 3 1  ON 33
ci_035                 1.325226e-03 3 1  ON 34
ci_036                 1.217601e-03 3 1  ON 35
ci_037                 4.666070e-03 3 1  ON 36
ci_038                 5.474925e-03 3 1  ON 37
ci_039                 6.109807e-03 3 1  ON 38
ci_040                 5.168715e-03 3 1  ON 39
ci_041                 4.960360e-03 3 1  ON 40
ci_042                 5.002605e-03 3 1  ON 41
ci_043                 5.448516e-03 3 1  ON 42
ci_044                 5.752931e-03 3 1  ON 43
ci_045                 2.837972e-03 3 1  ON 44
ci_046                 2.238682e-03 3 1  ON 45
ci_047                -4.495729e-04 3 1  ON 46
ci_048                -8.133745e-04 3 1  ON 47
ci_049                 1.459663e-03 3 1  ON 48
ci_050                 1.533359e-03 3 1  ON 49
ci_051                -1.623110e-03 3 1  ON 50
ci_052                -1.316057e-03 3 1  ON 51
ci_053                -2.813688e-03 3 1  ON 52
ci_054                -2.954179e-03 3 1  ON 53
ci_055                -1.006833e-03 3 1  ON 54
ci_056                -9.997708e-04 3 1  ON 55
ci_057                -1.911533e-03 3 1  ON 56
ci_058                -1.428247e-03 3 1  ON 57
ci_059                 5.328956e-04 3 1  ON 58
ci_060                 4.848884e-04 3 1  ON 59
ci_061                -8.250774e-05 3 1  ON 60
ci_062                 6.168262e-04 3 1  ON 61
ci_063                -3.324416e-06 3 1  ON 62
ci_064                 8.213710e-04 3 1  ON 63
ci_065                -2.710728e-03 3 1  ON 64
ci_066                -2.404633e-03 3 1  ON 65
ci_067                -1.567966e-03 3 1  ON 66
ci_068                -2.488179e-03 3 1  ON 67
ci_069                 1.692427e-04 3 1  ON 68
ci_070                -1.467537e-04 3 1  ON 69
ci_071                -2.060644e-03 3 1  ON 70
ci_072                -2.883861e-03 3 1  ON 71
ci_073                 1.488500e-04 3 1  ON 72
ci_074                 5.760258e-04 3 1  ON 73
ci_075                -3.714127e-04 3 1  ON 74
ci_076                -4.859556e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.6551e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORMN2JWARM.s012 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORMN2JWARM.s012 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=12  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2654e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 12
    time step          = 0.05
    reference energy   = -22.6942
    reference variance = 0.398336
====================================================
  Execution time = 2.5982e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORMN2JWARM.s012
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5280e+04
  VMC Eavg = -2.2669e+01
  VMC Evar = 5.0122e-01
  Total weights = 1.955364558e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.7899e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.488981998074
                                         uncertainty =       0.003739968551

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.488981998074
                                         uncertainty =       0.003739968551

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000494449638
  error estimate for blocks of size 2^( 2) =       0.000513100508
  error estimate for blocks of size 2^( 3) =       0.000529212088
  error estimate for blocks of size 2^( 4) =       0.000540829792
  error estimate for blocks of size 2^( 5) =       0.000548998267
  error estimate for blocks of size 2^( 6) =       0.000553885139
  error estimate for blocks of size 2^( 7) =       0.000556428093

      target function =                  N/A
              le_mean =     -22.669419401039
             les_mean =     514.403799622998
             stat err =       0.000550035323
             autocorr =       1.237476711682
              std dev =       0.699257384073
             le_variance =       0.488960889180


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266941940104e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.8147e-02, overlap shift 3.8147e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.669419401147       residual = 1.71e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.669440000563       residual = 1.52e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.669446579788       residual = 3.35e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.669447915956       residual = 5.25e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.669449684277       residual = 7.55e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.669450156182       residual = 1.29e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.669450166426       residual = 6.02e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 3.8147e-02 is 2.797740e-03

solving harmonic davidson linear method for identity shift 1.5259e-01, overlap shift 1.5259e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.669419401147       residual = 1.71e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.669432675328       residual = 7.12e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.669435243447       residual = 8.62e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.669435445936       residual = 4.50e-08           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.669435662812       residual = 1.70e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          4 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 1.5259e-01 is 1.200518e-03

solving harmonic davidson linear method for identity shift 6.1035e-01, overlap shift 6.1035e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.669419401147       residual = 1.71e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.669424880861       residual = 2.74e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.669425421332       residual = 2.06e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.669425414567       residual = 9.59e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 6.1035e-01 is 5.355444e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.057573 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0778e+01
  </log>
  <optVariables href="FORMN2JWARM.s012.opt.xml">
ci_001                -7.062919e-01 3 1  ON 0
ci_002                -7.038274e-01 3 1  ON 1
ci_003                -4.347183e-02 3 1  ON 2
ci_004                -4.337934e-02 3 1  ON 3
ci_005                 1.710153e-02 3 1  ON 4
ci_006                 1.712338e-02 3 1  ON 5
ci_007                 1.381454e-02 3 1  ON 6
ci_008                 1.364814e-02 3 1  ON 7
ci_009                -1.212967e-02 3 1  ON 8
ci_010                -1.176036e-02 3 1  ON 9
ci_011                -8.876952e-03 3 1  ON 10
ci_012                -8.281004e-03 3 1  ON 11
ci_013                 9.520189e-03 3 1  ON 12
ci_014                 9.766887e-03 3 1  ON 13
ci_015                 1.302710e-02 3 1  ON 14
ci_016                 1.304304e-02 3 1  ON 15
ci_017                 1.102209e-02 3 1  ON 16
ci_018                 1.118443e-02 3 1  ON 17
ci_019                -1.555012e-04 3 1  ON 18
ci_020                 9.026929e-05 3 1  ON 19
ci_021                -6.510414e-03 3 1  ON 20
ci_022                -7.172855e-03 3 1  ON 21
ci_023                 6.931385e-03 3 1  ON 22
ci_024                 8.132527e-03 3 1  ON 23
ci_025                 4.399717e-03 3 1  ON 24
ci_026                 3.048934e-03 3 1  ON 25
ci_027                 7.729321e-03 3 1  ON 26
ci_028                 6.672697e-03 3 1  ON 27
ci_029                -5.401981e-03 3 1  ON 28
ci_030                -4.282213e-03 3 1  ON 29
ci_031                -8.543320e-03 3 1  ON 30
ci_032                -9.185770e-03 3 1  ON 31
ci_033                 4.427387e-03 3 1  ON 32
ci_034                 5.147860e-03 3 1  ON 33
ci_035                 1.353984e-03 3 1  ON 34
ci_036                 1.174878e-03 3 1  ON 35
ci_037                 5.324466e-03 3 1  ON 36
ci_038                 5.985399e-03 3 1  ON 37
ci_039                 5.768848e-03 3 1  ON 38
ci_040                 5.257363e-03 3 1  ON 39
ci_041                 5.288386e-03 3 1  ON 40
ci_042                 5.754407e-03 3 1  ON 41
ci_043                 4.891970e-03 3 1  ON 42
ci_044                 4.761319e-03 3 1  ON 43
ci_045                 2.883182e-03 3 1  ON 44
ci_046                 2.708327e-03 3 1  ON 45
ci_047                -5.547351e-04 3 1  ON 46
ci_048                -6.387879e-04 3 1  ON 47
ci_049                 4.124168e-04 3 1  ON 48
ci_050                 1.602038e-03 3 1  ON 49
ci_051                -1.858393e-03 3 1  ON 50
ci_052                -1.206185e-03 3 1  ON 51
ci_053                -2.380701e-03 3 1  ON 52
ci_054                -2.921894e-03 3 1  ON 53
ci_055                -9.594839e-04 3 1  ON 54
ci_056                -1.540195e-03 3 1  ON 55
ci_057                -2.032833e-03 3 1  ON 56
ci_058                -1.128456e-03 3 1  ON 57
ci_059                 8.985826e-05 3 1  ON 58
ci_060                -6.716081e-05 3 1  ON 59
ci_061                -1.468049e-04 3 1  ON 60
ci_062                 6.933967e-04 3 1  ON 61
ci_063                 2.616849e-04 3 1  ON 62
ci_064                 7.411248e-04 3 1  ON 63
ci_065                -3.193269e-03 3 1  ON 64
ci_066                -2.424405e-03 3 1  ON 65
ci_067                -2.593051e-03 3 1  ON 66
ci_068                -1.750777e-03 3 1  ON 67
ci_069                -5.281251e-04 3 1  ON 68
ci_070                 5.857084e-04 3 1  ON 69
ci_071                -2.572656e-03 3 1  ON 70
ci_072                -2.421772e-03 3 1  ON 71
ci_073                 4.020890e-04 3 1  ON 72
ci_074                 4.865906e-05 3 1  ON 73
ci_075                 6.059157e-04 3 1  ON 74
ci_076                -1.238754e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 12
    time step          = 0.05
    reference energy   = -22.7228
    reference variance = 0.560651
====================================================
  Execution time = 2.5297e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORMN2JWARM.s012
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2670e+01
  VMC Evar = 4.9532e-01
  Total weights = 1.9550e+06
  Execution time = 3.6495e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.485408807485
                                         uncertainty =       0.003099827457

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.485408807485
                                         uncertainty =       0.003099827457

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000492624423
  error estimate for blocks of size 2^( 2) =       0.000511582189
  error estimate for blocks of size 2^( 3) =       0.000528450683
  error estimate for blocks of size 2^( 4) =       0.000539663764
  error estimate for blocks of size 2^( 5) =       0.000546621193
  error estimate for blocks of size 2^( 6) =       0.000550392224
  error estimate for blocks of size 2^( 7) =       0.000552545446

      target function =                  N/A
              le_mean =     -22.669707666316
             les_mean =     514.573654926664
             stat err =       0.000547305657
             autocorr =       1.234320652080
              std dev =       0.696676139954
             le_variance =       0.485357643981

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.483739644715
                                         uncertainty =       0.002492534082

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.483739644715
                                         uncertainty =       0.002492534082

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000491779872
  error estimate for blocks of size 2^( 2) =       0.000510771379
  error estimate for blocks of size 2^( 3) =       0.000527603928
  error estimate for blocks of size 2^( 4) =       0.000538821950
  error estimate for blocks of size 2^( 5) =       0.000545772132
  error estimate for blocks of size 2^( 6) =       0.000549543517
  error estimate for blocks of size 2^( 7) =       0.000551646575

      target function =                  N/A
              le_mean =     -22.669729980756
             les_mean =     514.414308151500
             stat err =       0.000546446044
             autocorr =       1.234676188463
              std dev =       0.695481764916
             le_variance =       0.483694885331

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.483948970798
                                         uncertainty =       0.002484200753

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.483948970798
                                         uncertainty =       0.002484200753

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000491886324
  error estimate for blocks of size 2^( 2) =       0.000510880989
  error estimate for blocks of size 2^( 3) =       0.000527717794
  error estimate for blocks of size 2^( 4) =       0.000538928183
  error estimate for blocks of size 2^( 5) =       0.000545863832
  error estimate for blocks of size 2^( 6) =       0.000549629851
  error estimate for blocks of size 2^( 7) =       0.000551738019

      target function =                  N/A
              le_mean =     -22.669748396956
             les_mean =     514.432570466765
             stat err =       0.000546539971
             autocorr =       1.234566143935
              std dev =       0.695632310867
             le_variance =       0.483904311923

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.483568456826
                                         uncertainty =       0.002513732828

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.483568456826
                                         uncertainty =       0.002513732828

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000491692126
  error estimate for blocks of size 2^( 2) =       0.000510685702
  error estimate for blocks of size 2^( 3) =       0.000527522013
  error estimate for blocks of size 2^( 4) =       0.000538772486
  error estimate for blocks of size 2^( 5) =       0.000545736784
  error estimate for blocks of size 2^( 6) =       0.000549494320
  error estimate for blocks of size 2^( 7) =       0.000551607632

      target function =                  N/A
              le_mean =     -22.669718698595
             les_mean =     514.413571924351
             stat err =       0.000546402805
             autocorr =       1.234921449951
              std dev =       0.695357672814
             le_variance =       0.483522293141


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.669707666316        initial
     3.8147e-02     3.8147e-01             2.7977e-03       -22.669729980756
     1.5259e-01     1.5259e+00             1.2005e-03       -22.669748396956  <--
     6.1035e-01     6.1035e+00             5.3554e-04       -22.669718698595

*****************************************************************************
Applying the update for shift_i =   1.5259e-01     and shift_s =   1.5259e+00
*****************************************************************************

  Execution time = 4.3597e+01
  </log>
  <optVariables href="FORMN2JWARM.s012.opt.xml">
ci_001                -7.062919e-01 3 1  ON 0
ci_002                -7.038274e-01 3 1  ON 1
ci_003                -4.347183e-02 3 1  ON 2
ci_004                -4.337934e-02 3 1  ON 3
ci_005                 1.710153e-02 3 1  ON 4
ci_006                 1.712338e-02 3 1  ON 5
ci_007                 1.381454e-02 3 1  ON 6
ci_008                 1.364814e-02 3 1  ON 7
ci_009                -1.212967e-02 3 1  ON 8
ci_010                -1.176036e-02 3 1  ON 9
ci_011                -8.876952e-03 3 1  ON 10
ci_012                -8.281004e-03 3 1  ON 11
ci_013                 9.520189e-03 3 1  ON 12
ci_014                 9.766887e-03 3 1  ON 13
ci_015                 1.302710e-02 3 1  ON 14
ci_016                 1.304304e-02 3 1  ON 15
ci_017                 1.102209e-02 3 1  ON 16
ci_018                 1.118443e-02 3 1  ON 17
ci_019                -1.555012e-04 3 1  ON 18
ci_020                 9.026929e-05 3 1  ON 19
ci_021                -6.510414e-03 3 1  ON 20
ci_022                -7.172855e-03 3 1  ON 21
ci_023                 6.931385e-03 3 1  ON 22
ci_024                 8.132527e-03 3 1  ON 23
ci_025                 4.399717e-03 3 1  ON 24
ci_026                 3.048934e-03 3 1  ON 25
ci_027                 7.729321e-03 3 1  ON 26
ci_028                 6.672697e-03 3 1  ON 27
ci_029                -5.401981e-03 3 1  ON 28
ci_030                -4.282213e-03 3 1  ON 29
ci_031                -8.543320e-03 3 1  ON 30
ci_032                -9.185770e-03 3 1  ON 31
ci_033                 4.427387e-03 3 1  ON 32
ci_034                 5.147860e-03 3 1  ON 33
ci_035                 1.353984e-03 3 1  ON 34
ci_036                 1.174878e-03 3 1  ON 35
ci_037                 5.324466e-03 3 1  ON 36
ci_038                 5.985399e-03 3 1  ON 37
ci_039                 5.768848e-03 3 1  ON 38
ci_040                 5.257363e-03 3 1  ON 39
ci_041                 5.288386e-03 3 1  ON 40
ci_042                 5.754407e-03 3 1  ON 41
ci_043                 4.891970e-03 3 1  ON 42
ci_044                 4.761319e-03 3 1  ON 43
ci_045                 2.883182e-03 3 1  ON 44
ci_046                 2.708327e-03 3 1  ON 45
ci_047                -5.547351e-04 3 1  ON 46
ci_048                -6.387879e-04 3 1  ON 47
ci_049                 4.124168e-04 3 1  ON 48
ci_050                 1.602038e-03 3 1  ON 49
ci_051                -1.858393e-03 3 1  ON 50
ci_052                -1.206185e-03 3 1  ON 51
ci_053                -2.380701e-03 3 1  ON 52
ci_054                -2.921894e-03 3 1  ON 53
ci_055                -9.594839e-04 3 1  ON 54
ci_056                -1.540195e-03 3 1  ON 55
ci_057                -2.032833e-03 3 1  ON 56
ci_058                -1.128456e-03 3 1  ON 57
ci_059                 8.985826e-05 3 1  ON 58
ci_060                -6.716081e-05 3 1  ON 59
ci_061                -1.468049e-04 3 1  ON 60
ci_062                 6.933967e-04 3 1  ON 61
ci_063                 2.616849e-04 3 1  ON 62
ci_064                 7.411248e-04 3 1  ON 63
ci_065                -3.193269e-03 3 1  ON 64
ci_066                -2.424405e-03 3 1  ON 65
ci_067                -2.593051e-03 3 1  ON 66
ci_068                -1.750777e-03 3 1  ON 67
ci_069                -5.281251e-04 3 1  ON 68
ci_070                 5.857084e-04 3 1  ON 69
ci_071                -2.572656e-03 3 1  ON 70
ci_072                -2.421772e-03 3 1  ON 71
ci_073                 4.020890e-04 3 1  ON 72
ci_074                 4.865906e-05 3 1  ON 73
ci_075                 6.059157e-04 3 1  ON 74
ci_076                -1.238754e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.4380e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORMN2JWARM.s013 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORMN2JWARM.s013 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=13  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2659e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 13
    time step          = 0.05
    reference energy   = -22.7558
    reference variance = 0.393221
====================================================
  Execution time = 2.5985e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORMN2JWARM.s013
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5248e+04
  VMC Eavg = -2.2669e+01
  VMC Evar = 4.9231e-01
  Total weights = 1.955340900e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.7834e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.480459265902
                                         uncertainty =       0.002379742710

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.480459265902
                                         uncertainty =       0.002379742710

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000490157077
  error estimate for blocks of size 2^( 2) =       0.000508546632
  error estimate for blocks of size 2^( 3) =       0.000524207918
  error estimate for blocks of size 2^( 4) =       0.000536736183
  error estimate for blocks of size 2^( 5) =       0.000544074764
  error estimate for blocks of size 2^( 6) =       0.000546618246
  error estimate for blocks of size 2^( 7) =       0.000549689429

      target function =                  N/A
              le_mean =     -22.669285640034
             les_mean =     514.388821179230
             stat err =       0.000544279655
             autocorr =       1.233030009169
              std dev =       0.693186786681
             le_variance =       0.480507921229


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266928564003e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.8147e-02, overlap shift 3.8147e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.669285640116       residual = 2.22e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.669323172338       residual = 2.10e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.669330648396       residual = 3.58e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.669332802999       residual = 5.57e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.669333198771       residual = 4.43e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.669333728415       residual = 1.01e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.669333557782       residual = 5.65e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 3.8147e-02 is 5.281152e-03

solving harmonic davidson linear method for identity shift 1.5259e-01, overlap shift 1.5259e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.669285640116       residual = 2.22e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.669309287945       residual = 9.03e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.669311187603       residual = 5.19e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.669311522402       residual = 2.36e-08           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.669311542785       residual = 6.04e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          4 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 1.5259e-01 is 2.220460e-03

solving harmonic davidson linear method for identity shift 6.1035e-01, overlap shift 6.1035e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.669285640116       residual = 2.22e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.669295176521       residual = 3.70e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.669295208012       residual = 1.14e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.669295218848       residual = 3.70e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 6.1035e-01 is 6.700387e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.059334 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0774e+01
  </log>
  <optVariables href="FORMN2JWARM.s013.opt.xml">
ci_001                -7.062887e-01 3 1  ON 0
ci_002                -7.040638e-01 3 1  ON 1
ci_003                -4.125137e-02 3 1  ON 2
ci_004                -4.262655e-02 3 1  ON 3
ci_005                 1.709322e-02 3 1  ON 4
ci_006                 1.722524e-02 3 1  ON 5
ci_007                 1.404945e-02 3 1  ON 6
ci_008                 1.347446e-02 3 1  ON 7
ci_009                -1.129740e-02 3 1  ON 8
ci_010                -1.154339e-02 3 1  ON 9
ci_011                -9.394023e-03 3 1  ON 10
ci_012                -8.065006e-03 3 1  ON 11
ci_013                 9.611430e-03 3 1  ON 12
ci_014                 1.031480e-02 3 1  ON 13
ci_015                 1.237055e-02 3 1  ON 14
ci_016                 1.185718e-02 3 1  ON 15
ci_017                 1.170855e-02 3 1  ON 16
ci_018                 1.136393e-02 3 1  ON 17
ci_019                 7.907504e-06 3 1  ON 18
ci_020                -6.019336e-04 3 1  ON 19
ci_021                -6.608173e-03 3 1  ON 20
ci_022                -6.882630e-03 3 1  ON 21
ci_023                 8.095838e-03 3 1  ON 22
ci_024                 6.980006e-03 3 1  ON 23
ci_025                 4.412767e-03 3 1  ON 24
ci_026                 3.509795e-03 3 1  ON 25
ci_027                 6.553260e-03 3 1  ON 26
ci_028                 6.756243e-03 3 1  ON 27
ci_029                -4.815147e-03 3 1  ON 28
ci_030                -5.151487e-03 3 1  ON 29
ci_031                -8.361030e-03 3 1  ON 30
ci_032                -8.946687e-03 3 1  ON 31
ci_033                 3.836998e-03 3 1  ON 32
ci_034                 4.081550e-03 3 1  ON 33
ci_035                 9.996272e-04 3 1  ON 34
ci_036                 1.694365e-03 3 1  ON 35
ci_037                 5.889037e-03 3 1  ON 36
ci_038                 6.341561e-03 3 1  ON 37
ci_039                 5.908514e-03 3 1  ON 38
ci_040                 5.545621e-03 3 1  ON 39
ci_041                 5.103413e-03 3 1  ON 40
ci_042                 5.385295e-03 3 1  ON 41
ci_043                 4.666399e-03 3 1  ON 42
ci_044                 4.841430e-03 3 1  ON 43
ci_045                 2.957666e-03 3 1  ON 44
ci_046                 3.324820e-03 3 1  ON 45
ci_047                -1.318477e-03 3 1  ON 46
ci_048                -5.123956e-04 3 1  ON 47
ci_049                 1.311446e-03 3 1  ON 48
ci_050                 1.089619e-03 3 1  ON 49
ci_051                -1.996066e-03 3 1  ON 50
ci_052                -1.140061e-03 3 1  ON 51
ci_053                -1.668352e-03 3 1  ON 52
ci_054                -3.060463e-03 3 1  ON 53
ci_055                -1.251205e-03 3 1  ON 54
ci_056                -1.985901e-03 3 1  ON 55
ci_057                -2.044066e-03 3 1  ON 56
ci_058                -1.599348e-03 3 1  ON 57
ci_059                 3.577130e-04 3 1  ON 58
ci_060                 6.963859e-05 3 1  ON 59
ci_061                 9.870424e-05 3 1  ON 60
ci_062                 5.618534e-04 3 1  ON 61
ci_063                 1.014548e-04 3 1  ON 62
ci_064                 6.493857e-04 3 1  ON 63
ci_065                -2.614778e-03 3 1  ON 64
ci_066                -2.001762e-03 3 1  ON 65
ci_067                -3.349419e-03 3 1  ON 66
ci_068                -2.175781e-03 3 1  ON 67
ci_069                 3.884388e-04 3 1  ON 68
ci_070                -1.867512e-04 3 1  ON 69
ci_071                -2.301137e-03 3 1  ON 70
ci_072                -1.882384e-03 3 1  ON 71
ci_073                 8.449467e-04 3 1  ON 72
ci_074                -6.087681e-05 3 1  ON 73
ci_075                -8.527569e-04 3 1  ON 74
ci_076                -3.963628e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 13
    time step          = 0.05
    reference energy   = -22.7473
    reference variance = 0.428321
====================================================
  Execution time = 2.5331e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORMN2JWARM.s013
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2669e+01
  VMC Evar = 4.9722e-01
  Total weights = 1.9550e+06
  Execution time = 3.6746e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

ERROR CostFunction-> Number of Effective Walkers is too small! 
  Number of effective walkers (samples) / total number of samples = 0.2147
  User specified threshold minwalkers = 0.3
  If this message appears frequently. You might have to be cautious. 
  Find info about parameter "minwalkers" in the user manual!
Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.506489475664
                                         uncertainty =       0.016577938789

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.506489475664
                                         uncertainty =       0.016577938789

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000503262024
  error estimate for blocks of size 2^( 2) =       0.000521626784
  error estimate for blocks of size 2^( 3) =       0.000537544135
  error estimate for blocks of size 2^( 4) =       0.000549463344
  error estimate for blocks of size 2^( 5) =       0.000556321399
  error estimate for blocks of size 2^( 6) =       0.000560343519
  error estimate for blocks of size 2^( 7) =       0.000559057984

      target function =                  N/A
              le_mean =     -22.668804529294
             les_mean =     517.789714960570
             stat err =       0.000556296561
             autocorr =       1.221868395643
              std dev =       0.711719979361
             le_variance =       0.506545329022

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.486579715786
                                         uncertainty =       0.002835243903

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.486579715786
                                         uncertainty =       0.002835243903

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000493263822
  error estimate for blocks of size 2^( 2) =       0.000511953528
  error estimate for blocks of size 2^( 3) =       0.000528379622
  error estimate for blocks of size 2^( 4) =       0.000540431523
  error estimate for blocks of size 2^( 5) =       0.000547063813
  error estimate for blocks of size 2^( 6) =       0.000551073062
  error estimate for blocks of size 2^( 7) =       0.000549884249

      target function =                  N/A
              le_mean =     -22.668671590080
             les_mean =     514.502644737568
             stat err =       0.000547113162
             autocorr =       1.230256870377
              std dev =       0.697580386471
             le_variance =       0.486618395590

ERROR CostFunction-> Number of Effective Walkers is too small! 
  Number of effective walkers (samples) / total number of samples = 0.223953
  User specified threshold minwalkers = 0.3
  If this message appears frequently. You might have to be cautious. 
  Find info about parameter "minwalkers" in the user manual!
Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.486673945921
                                         uncertainty =       0.002801373745

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.486673945921
                                         uncertainty =       0.002801373745

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000493311793
  error estimate for blocks of size 2^( 2) =       0.000512008421
  error estimate for blocks of size 2^( 3) =       0.000528433649
  error estimate for blocks of size 2^( 4) =       0.000540500122
  error estimate for blocks of size 2^( 5) =       0.000547137601
  error estimate for blocks of size 2^( 6) =       0.000551176052
  error estimate for blocks of size 2^( 7) =       0.000549956188

      target function =                  N/A
              le_mean =     -22.668684491525
             les_mean =     514.373304347131
             stat err =       0.000547192491
             autocorr =       1.230374331128
              std dev =       0.697648228061
             le_variance =       0.486713050117

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.486310285455
                                         uncertainty =       0.002817710327

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.486310285455
                                         uncertainty =       0.002817710327

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000493127262
  error estimate for blocks of size 2^( 2) =       0.000511826485
  error estimate for blocks of size 2^( 3) =       0.000528261926
  error estimate for blocks of size 2^( 4) =       0.000540320774
  error estimate for blocks of size 2^( 5) =       0.000546966848
  error estimate for blocks of size 2^( 6) =       0.000550971764
  error estimate for blocks of size 2^( 7) =       0.000549778020

      target function =                  N/A
              le_mean =     -22.668653088176
             les_mean =     514.385113129066
             stat err =       0.000547009351
             autocorr =       1.230471266986
              std dev =       0.697387261621
             le_variance =       0.486348992671


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.668804529294        initial  <--
     3.8147e-02     3.8147e-01             5.2812e-03       -22.668671590080
     1.5259e-01     1.5259e+00             2.2205e-03       -22.668684491525
     6.1035e-01     6.1035e+00             6.7004e-04       -22.668653088176

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 43.7135
  </log>
  <optVariables href="FORMN2JWARM.s013.opt.xml">
ci_001                -7.062919e-01 3 1  ON 0
ci_002                -7.038274e-01 3 1  ON 1
ci_003                -4.347183e-02 3 1  ON 2
ci_004                -4.337934e-02 3 1  ON 3
ci_005                 1.710153e-02 3 1  ON 4
ci_006                 1.712338e-02 3 1  ON 5
ci_007                 1.381454e-02 3 1  ON 6
ci_008                 1.364814e-02 3 1  ON 7
ci_009                -1.212967e-02 3 1  ON 8
ci_010                -1.176036e-02 3 1  ON 9
ci_011                -8.876952e-03 3 1  ON 10
ci_012                -8.281004e-03 3 1  ON 11
ci_013                 9.520189e-03 3 1  ON 12
ci_014                 9.766887e-03 3 1  ON 13
ci_015                 1.302710e-02 3 1  ON 14
ci_016                 1.304304e-02 3 1  ON 15
ci_017                 1.102209e-02 3 1  ON 16
ci_018                 1.118443e-02 3 1  ON 17
ci_019                -1.555012e-04 3 1  ON 18
ci_020                 9.026929e-05 3 1  ON 19
ci_021                -6.510414e-03 3 1  ON 20
ci_022                -7.172855e-03 3 1  ON 21
ci_023                 6.931385e-03 3 1  ON 22
ci_024                 8.132527e-03 3 1  ON 23
ci_025                 4.399717e-03 3 1  ON 24
ci_026                 3.048934e-03 3 1  ON 25
ci_027                 7.729321e-03 3 1  ON 26
ci_028                 6.672697e-03 3 1  ON 27
ci_029                -5.401981e-03 3 1  ON 28
ci_030                -4.282213e-03 3 1  ON 29
ci_031                -8.543320e-03 3 1  ON 30
ci_032                -9.185770e-03 3 1  ON 31
ci_033                 4.427387e-03 3 1  ON 32
ci_034                 5.147860e-03 3 1  ON 33
ci_035                 1.353984e-03 3 1  ON 34
ci_036                 1.174878e-03 3 1  ON 35
ci_037                 5.324466e-03 3 1  ON 36
ci_038                 5.985399e-03 3 1  ON 37
ci_039                 5.768848e-03 3 1  ON 38
ci_040                 5.257363e-03 3 1  ON 39
ci_041                 5.288386e-03 3 1  ON 40
ci_042                 5.754407e-03 3 1  ON 41
ci_043                 4.891970e-03 3 1  ON 42
ci_044                 4.761319e-03 3 1  ON 43
ci_045                 2.883182e-03 3 1  ON 44
ci_046                 2.708327e-03 3 1  ON 45
ci_047                -5.547351e-04 3 1  ON 46
ci_048                -6.387879e-04 3 1  ON 47
ci_049                 4.124168e-04 3 1  ON 48
ci_050                 1.602038e-03 3 1  ON 49
ci_051                -1.858393e-03 3 1  ON 50
ci_052                -1.206185e-03 3 1  ON 51
ci_053                -2.380701e-03 3 1  ON 52
ci_054                -2.921894e-03 3 1  ON 53
ci_055                -9.594839e-04 3 1  ON 54
ci_056                -1.540195e-03 3 1  ON 55
ci_057                -2.032833e-03 3 1  ON 56
ci_058                -1.128456e-03 3 1  ON 57
ci_059                 8.985826e-05 3 1  ON 58
ci_060                -6.716081e-05 3 1  ON 59
ci_061                -1.468049e-04 3 1  ON 60
ci_062                 6.933967e-04 3 1  ON 61
ci_063                 2.616849e-04 3 1  ON 62
ci_064                 7.411248e-04 3 1  ON 63
ci_065                -3.193269e-03 3 1  ON 64
ci_066                -2.424405e-03 3 1  ON 65
ci_067                -2.593051e-03 3 1  ON 66
ci_068                -1.750777e-03 3 1  ON 67
ci_069                -5.281251e-04 3 1  ON 68
ci_070                 5.857084e-04 3 1  ON 69
ci_071                -2.572656e-03 3 1  ON 70
ci_072                -2.421772e-03 3 1  ON 71
ci_073                 4.020890e-04 3 1  ON 72
ci_074                 4.865906e-05 3 1  ON 73
ci_075                 6.059157e-04 3 1  ON 74
ci_076                -1.238754e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.4497e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORMN2JWARM.s014 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORMN2JWARM.s014 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=14  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2665e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 14
    time step          = 0.05
    reference energy   = -22.7091
    reference variance = 0.435279
====================================================
  Execution time = 2.5943e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORMN2JWARM.s014
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5275e+04
  VMC Eavg = -2.2669e+01
  VMC Evar = 5.0672e-01
  Total weights = 1.955084415e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.7847e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.491746147808
                                         uncertainty =       0.004312427521

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.491746147808
                                         uncertainty =       0.004312427521

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000495893482
  error estimate for blocks of size 2^( 2) =       0.000514387598
  error estimate for blocks of size 2^( 3) =       0.000531156332
  error estimate for blocks of size 2^( 4) =       0.000543723705
  error estimate for blocks of size 2^( 5) =       0.000550334038
  error estimate for blocks of size 2^( 6) =       0.000555299351
  error estimate for blocks of size 2^( 7) =       0.000557089856

      target function =                  N/A
              le_mean =     -22.669325927674
             les_mean =     514.405062729530
             stat err =       0.000551611737
             autocorr =       1.237343261392
              std dev =       0.701299287435
             le_variance =       0.491820690556


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266932592767e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.8147e-01, overlap shift 3.8147e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.669325927801       residual = 1.97e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.669341441428       residual = 2.15e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.669342370829       residual = 5.69e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.669342417833       residual = 1.46e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 3.8147e-01 is 8.539123e-04

solving harmonic davidson linear method for identity shift 1.5259e+00, overlap shift 1.5259e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.669325927801       residual = 1.97e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.669330935957       residual = 2.10e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.669331240475       residual = 3.14e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.669331284714       residual = 9.87e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 1.5259e+00 is 2.725282e-04

solving harmonic davidson linear method for identity shift 6.1035e+00, overlap shift 6.1035e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.669325927801       residual = 1.97e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.669327278178       residual = 2.58e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.669327363909       residual = 4.08e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.669327381380       residual = 1.19e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 6.1035e+00 is 7.361643e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.063717 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0739e+01
  </log>
  <optVariables href="FORMN2JWARM.s014.opt.xml">
ci_001                -7.063584e-01 3 1  ON 0
ci_002                -7.037881e-01 3 1  ON 1
ci_003                -4.329405e-02 3 1  ON 2
ci_004                -4.324238e-02 3 1  ON 3
ci_005                 1.701924e-02 3 1  ON 4
ci_006                 1.721238e-02 3 1  ON 5
ci_007                 1.369721e-02 3 1  ON 6
ci_008                 1.367921e-02 3 1  ON 7
ci_009                -1.198670e-02 3 1  ON 8
ci_010                -1.176480e-02 3 1  ON 9
ci_011                -8.807503e-03 3 1  ON 10
ci_012                -8.248691e-03 3 1  ON 11
ci_013                 9.496063e-03 3 1  ON 12
ci_014                 9.853065e-03 3 1  ON 13
ci_015                 1.302855e-02 3 1  ON 14
ci_016                 1.305238e-02 3 1  ON 15
ci_017                 1.103769e-02 3 1  ON 16
ci_018                 1.135540e-02 3 1  ON 17
ci_019                -2.104371e-04 3 1  ON 18
ci_020                 8.752565e-05 3 1  ON 19
ci_021                -6.556314e-03 3 1  ON 20
ci_022                -7.214898e-03 3 1  ON 21
ci_023                 6.956208e-03 3 1  ON 22
ci_024                 8.093762e-03 3 1  ON 23
ci_025                 4.314521e-03 3 1  ON 24
ci_026                 3.037744e-03 3 1  ON 25
ci_027                 7.468588e-03 3 1  ON 26
ci_028                 6.631935e-03 3 1  ON 27
ci_029                -5.484142e-03 3 1  ON 28
ci_030                -4.322948e-03 3 1  ON 29
ci_031                -8.542910e-03 3 1  ON 30
ci_032                -9.044274e-03 3 1  ON 31
ci_033                 4.380962e-03 3 1  ON 32
ci_034                 5.098314e-03 3 1  ON 33
ci_035                 1.410978e-03 3 1  ON 34
ci_036                 1.217449e-03 3 1  ON 35
ci_037                 5.098618e-03 3 1  ON 36
ci_038                 5.977845e-03 3 1  ON 37
ci_039                 5.592927e-03 3 1  ON 38
ci_040                 5.341484e-03 3 1  ON 39
ci_041                 5.185957e-03 3 1  ON 40
ci_042                 5.659547e-03 3 1  ON 41
ci_043                 4.882263e-03 3 1  ON 42
ci_044                 4.839902e-03 3 1  ON 43
ci_045                 3.010690e-03 3 1  ON 44
ci_046                 2.663436e-03 3 1  ON 45
ci_047                -6.098183e-04 3 1  ON 46
ci_048                -7.525902e-04 3 1  ON 47
ci_049                 5.272351e-04 3 1  ON 48
ci_050                 1.601650e-03 3 1  ON 49
ci_051                -1.920734e-03 3 1  ON 50
ci_052                -1.229768e-03 3 1  ON 51
ci_053                -2.344985e-03 3 1  ON 52
ci_054                -3.027537e-03 3 1  ON 53
ci_055                -9.863598e-04 3 1  ON 54
ci_056                -1.420093e-03 3 1  ON 55
ci_057                -1.963925e-03 3 1  ON 56
ci_058                -1.315031e-03 3 1  ON 57
ci_059                 6.184584e-06 3 1  ON 58
ci_060                 3.118902e-05 3 1  ON 59
ci_061                -3.291509e-04 3 1  ON 60
ci_062                 5.517804e-04 3 1  ON 61
ci_063                 2.610939e-04 3 1  ON 62
ci_064                 7.802590e-04 3 1  ON 63
ci_065                -3.210598e-03 3 1  ON 64
ci_066                -2.315647e-03 3 1  ON 65
ci_067                -2.865579e-03 3 1  ON 66
ci_068                -1.935023e-03 3 1  ON 67
ci_069                -4.780613e-04 3 1  ON 68
ci_070                 4.133705e-04 3 1  ON 69
ci_071                -2.467594e-03 3 1  ON 70
ci_072                -2.464470e-03 3 1  ON 71
ci_073                 3.720012e-04 3 1  ON 72
ci_074                -2.581283e-05 3 1  ON 73
ci_075                 4.016137e-04 3 1  ON 74
ci_076                -1.867267e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 14
    time step          = 0.05
    reference energy   = -22.5615
    reference variance = 0.456865
====================================================
  Execution time = 2.5295e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORMN2JWARM.s014
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2669e+01
  VMC Evar = 4.9308e-01
  Total weights = 1.9553e+06
  Execution time = 3.6718e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.482094836673
                                         uncertainty =       0.002980752165

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.482094836673
                                         uncertainty =       0.002980752165

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000490959159
  error estimate for blocks of size 2^( 2) =       0.000509500744
  error estimate for blocks of size 2^( 3) =       0.000526932850
  error estimate for blocks of size 2^( 4) =       0.000539539977
  error estimate for blocks of size 2^( 5) =       0.000546666173
  error estimate for blocks of size 2^( 6) =       0.000548714259
  error estimate for blocks of size 2^( 7) =       0.000552246104

      target function =                  N/A
              le_mean =     -22.669080828463
             les_mean =     514.381361177327
             stat err =       0.000546791628
             autocorr =       1.240374930443
              std dev =       0.694321101674
             le_variance =       0.482081792230

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.482194998597
                                         uncertainty =       0.002977796238

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.482194998597
                                         uncertainty =       0.002977796238

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000491010162
  error estimate for blocks of size 2^( 2) =       0.000509555492
  error estimate for blocks of size 2^( 3) =       0.000526978660
  error estimate for blocks of size 2^( 4) =       0.000539574887
  error estimate for blocks of size 2^( 5) =       0.000546681238
  error estimate for blocks of size 2^( 6) =       0.000548743500
  error estimate for blocks of size 2^( 7) =       0.000552266096

      target function =                  N/A
              le_mean =     -22.669088225549
             les_mean =     514.426014312624
             stat err =       0.000546816430
             autocorr =       1.240229762743
              std dev =       0.694393230703
             le_variance =       0.482181958847

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.482120468764
                                         uncertainty =       0.002978169568

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.482120468764
                                         uncertainty =       0.002978169568

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000490972225
  error estimate for blocks of size 2^( 2) =       0.000509515643
  error estimate for blocks of size 2^( 3) =       0.000526947228
  error estimate for blocks of size 2^( 4) =       0.000539549448
  error estimate for blocks of size 2^( 5) =       0.000546663527
  error estimate for blocks of size 2^( 6) =       0.000548725269
  error estimate for blocks of size 2^( 7) =       0.000552244301

      target function =                  N/A
              le_mean =     -22.669080329005
             les_mean =     514.381714387870
             stat err =       0.000546795636
             autocorr =       1.240327094888
              std dev =       0.694339580041
             le_variance =       0.482107452411

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.482092980307
                                         uncertainty =       0.002980298346

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.482092980307
                                         uncertainty =       0.002980298346

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000490958217
  error estimate for blocks of size 2^( 2) =       0.000509500384
  error estimate for blocks of size 2^( 3) =       0.000526932223
  error estimate for blocks of size 2^( 4) =       0.000539538735
  error estimate for blocks of size 2^( 5) =       0.000546663167
  error estimate for blocks of size 2^( 6) =       0.000548711079
  error estimate for blocks of size 2^( 7) =       0.000552240739

      target function =                  N/A
              le_mean =     -22.669080970214
             les_mean =     514.380282075133
             stat err =       0.000546788430
             autocorr =       1.240365182114
              std dev =       0.694319768843
             le_variance =       0.482079941406


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.669080828463        initial
     3.8147e-01     3.8147e+00             8.5391e-04       -22.669088225549  <--
     1.5259e+00     1.5259e+01             2.7253e-04       -22.669080329005
     6.1035e+00     6.1035e+01             7.3616e-05       -22.669080970214

*****************************************************************************
Applying the update for shift_i =   3.8147e-01     and shift_s =   3.8147e+00
*****************************************************************************

  Execution time = 4.3665e+01
  </log>
  <optVariables href="FORMN2JWARM.s014.opt.xml">
ci_001                -7.065265e-01 3 1  ON 0
ci_002                -7.036847e-01 3 1  ON 1
ci_003                -4.283231e-02 3 1  ON 2
ci_004                -4.287868e-02 3 1  ON 3
ci_005                 1.687833e-02 3 1  ON 4
ci_006                 1.737812e-02 3 1  ON 5
ci_007                 1.346491e-02 3 1  ON 6
ci_008                 1.375610e-02 3 1  ON 7
ci_009                -1.170549e-02 3 1  ON 8
ci_010                -1.177183e-02 3 1  ON 9
ci_011                -8.665006e-03 3 1  ON 10
ci_012                -8.171342e-03 3 1  ON 11
ci_013                 9.433976e-03 3 1  ON 12
ci_014                 1.004736e-02 3 1  ON 13
ci_015                 1.301655e-02 3 1  ON 14
ci_016                 1.307635e-02 3 1  ON 15
ci_017                 1.107096e-02 3 1  ON 16
ci_018                 1.173576e-02 3 1  ON 17
ci_019                -3.324184e-04 3 1  ON 18
ci_020                 8.319050e-05 3 1  ON 19
ci_021                -6.665574e-03 3 1  ON 20
ci_022                -7.330033e-03 3 1  ON 21
ci_023                 7.012590e-03 3 1  ON 22
ci_024                 8.012828e-03 3 1  ON 23
ci_025                 4.125820e-03 3 1  ON 24
ci_026                 3.008439e-03 3 1  ON 25
ci_027                 7.014791e-03 3 1  ON 26
ci_028                 6.559155e-03 3 1  ON 27
ci_029                -5.645331e-03 3 1  ON 28
ci_030                -4.416227e-03 3 1  ON 29
ci_031                -8.538071e-03 3 1  ON 30
ci_032                -8.712748e-03 3 1  ON 31
ci_033                 4.266961e-03 3 1  ON 32
ci_034                 4.995047e-03 3 1  ON 33
ci_035                 1.499621e-03 3 1  ON 34
ci_036                 1.291214e-03 3 1  ON 35
ci_037                 4.614310e-03 3 1  ON 36
ci_038                 5.963933e-03 3 1  ON 37
ci_039                 5.289147e-03 3 1  ON 38
ci_040                 5.493060e-03 3 1  ON 39
ci_041                 4.996096e-03 3 1  ON 40
ci_042                 5.471041e-03 3 1  ON 41
ci_043                 4.867043e-03 3 1  ON 42
ci_044                 5.008289e-03 3 1  ON 43
ci_045                 3.288585e-03 3 1  ON 44
ci_046                 2.571988e-03 3 1  ON 45
ci_047                -6.957860e-04 3 1  ON 46
ci_048                -9.518621e-04 3 1  ON 47
ci_049                 7.642032e-04 3 1  ON 48
ci_050                 1.600027e-03 3 1  ON 49
ci_051                -2.050372e-03 3 1  ON 50
ci_052                -1.279999e-03 3 1  ON 51
ci_053                -2.269362e-03 3 1  ON 52
ci_054                -3.256819e-03 3 1  ON 53
ci_055                -1.009742e-03 3 1  ON 54
ci_056                -1.122478e-03 3 1  ON 55
ci_057                -1.826090e-03 3 1  ON 56
ci_058                -1.691725e-03 3 1  ON 57
ci_059                -1.454207e-04 3 1  ON 58
ci_060                 2.134553e-04 3 1  ON 59
ci_061                -7.310660e-04 3 1  ON 60
ci_062                 2.536116e-04 3 1  ON 61
ci_063                 2.609963e-04 3 1  ON 62
ci_064                 8.687069e-04 3 1  ON 63
ci_065                -3.230946e-03 3 1  ON 64
ci_066                -2.074882e-03 3 1  ON 65
ci_067                -3.446963e-03 3 1  ON 66
ci_068                -2.342707e-03 3 1  ON 67
ci_069                -3.656129e-04 3 1  ON 68
ci_070                 6.160331e-05 3 1  ON 69
ci_071                -2.239759e-03 3 1  ON 70
ci_072                -2.557048e-03 3 1  ON 71
ci_073                 3.194347e-04 3 1  ON 72
ci_074                -1.649747e-04 3 1  ON 73
ci_075                -1.494275e-05 3 1  ON 74
ci_076                -3.158516e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.4419e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORMN2JWARM.s015 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORMN2JWARM.s015 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=15  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2663e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 15
    time step          = 0.05
    reference energy   = -22.5771
    reference variance = 0.40003
====================================================
  Execution time = 2.5869e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORMN2JWARM.s015
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5280e+04
  VMC Eavg = -2.2669e+01
  VMC Evar = 4.9693e-01
  Total weights = 1.954999235e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.7924e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.482481264279
                                         uncertainty =       0.002517210490

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.482481264279
                                         uncertainty =       0.002517210490

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000491165624
  error estimate for blocks of size 2^( 2) =       0.000509383839
  error estimate for blocks of size 2^( 3) =       0.000526454242
  error estimate for blocks of size 2^( 4) =       0.000538335531
  error estimate for blocks of size 2^( 5) =       0.000546008598
  error estimate for blocks of size 2^( 6) =       0.000551064878
  error estimate for blocks of size 2^( 7) =       0.000552373374

      target function =                  N/A
              le_mean =     -22.669237425105
             les_mean =     514.391255357806
             stat err =       0.000546945595
             autocorr =       1.240030395940
              std dev =       0.694613087283
             le_variance =       0.482487341025


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266923742510e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.5367e-02, overlap shift 9.5367e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.669237425187       residual = 1.66e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.669248640634       residual = 5.56e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.669251797527       residual = 6.12e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.669252478355       residual = 6.36e-08           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.669252609885       residual = 9.29e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          4 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 9.5367e-02 is 1.732406e-03

solving harmonic davidson linear method for identity shift 3.8147e-01, overlap shift 3.8147e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.669237425187       residual = 1.66e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.669242717093       residual = 1.87e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.669243490779       residual = 4.31e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.669243579166       residual = 1.18e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 3.8147e-01 is 8.022640e-04

solving harmonic davidson linear method for identity shift 1.5259e+00, overlap shift 1.5259e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.669237425187       residual = 1.66e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.669239125321       residual = 1.57e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.669239290208       residual = 2.35e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.669239301248       residual = 5.07e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 1.5259e+00 is 2.546314e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.068316 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0673e+01
  </log>
  <optVariables href="FORMN2JWARM.s015.opt.xml">
ci_001                -7.067360e-01 3 1  ON 0
ci_002                -7.035622e-01 3 1  ON 1
ci_003                -4.237067e-02 3 1  ON 2
ci_004                -4.237499e-02 3 1  ON 3
ci_005                 1.709457e-02 3 1  ON 4
ci_006                 1.704898e-02 3 1  ON 5
ci_007                 1.364747e-02 3 1  ON 6
ci_008                 1.352981e-02 3 1  ON 7
ci_009                -1.201653e-02 3 1  ON 8
ci_010                -1.160640e-02 3 1  ON 9
ci_011                -8.975020e-03 3 1  ON 10
ci_012                -8.158382e-03 3 1  ON 11
ci_013                 9.545976e-03 3 1  ON 12
ci_014                 1.000621e-02 3 1  ON 13
ci_015                 1.261920e-02 3 1  ON 14
ci_016                 1.281198e-02 3 1  ON 15
ci_017                 1.107217e-02 3 1  ON 16
ci_018                 1.166415e-02 3 1  ON 17
ci_019                -2.178890e-04 3 1  ON 18
ci_020                 4.370495e-05 3 1  ON 19
ci_021                -6.597528e-03 3 1  ON 20
ci_022                -7.262163e-03 3 1  ON 21
ci_023                 7.489340e-03 3 1  ON 22
ci_024                 8.064490e-03 3 1  ON 23
ci_025                 4.058083e-03 3 1  ON 24
ci_026                 3.388538e-03 3 1  ON 25
ci_027                 6.720209e-03 3 1  ON 26
ci_028                 7.028187e-03 3 1  ON 27
ci_029                -5.519434e-03 3 1  ON 28
ci_030                -4.805399e-03 3 1  ON 29
ci_031                -8.490196e-03 3 1  ON 30
ci_032                -8.175755e-03 3 1  ON 31
ci_033                 4.128109e-03 3 1  ON 32
ci_034                 4.549728e-03 3 1  ON 33
ci_035                 1.483868e-03 3 1  ON 34
ci_036                 1.307886e-03 3 1  ON 35
ci_037                 4.376570e-03 3 1  ON 36
ci_038                 5.877380e-03 3 1  ON 37
ci_039                 5.172394e-03 3 1  ON 38
ci_040                 5.506955e-03 3 1  ON 39
ci_041                 4.906492e-03 3 1  ON 40
ci_042                 5.029587e-03 3 1  ON 41
ci_043                 4.619579e-03 3 1  ON 42
ci_044                 4.738619e-03 3 1  ON 43
ci_045                 3.483678e-03 3 1  ON 44
ci_046                 2.059937e-03 3 1  ON 45
ci_047                -6.531736e-04 3 1  ON 46
ci_048                -1.019878e-03 3 1  ON 47
ci_049                 1.422277e-03 3 1  ON 48
ci_050                 1.710245e-03 3 1  ON 49
ci_051                -1.583843e-03 3 1  ON 50
ci_052                -1.524075e-03 3 1  ON 51
ci_053                -2.556110e-03 3 1  ON 52
ci_054                -3.328943e-03 3 1  ON 53
ci_055                -1.337263e-03 3 1  ON 54
ci_056                -1.343413e-03 3 1  ON 55
ci_057                -1.471557e-03 3 1  ON 56
ci_058                -1.697381e-03 3 1  ON 57
ci_059                 7.352704e-05 3 1  ON 58
ci_060                 2.073209e-04 3 1  ON 59
ci_061                -4.583737e-04 3 1  ON 60
ci_062                 4.119255e-04 3 1  ON 61
ci_063                 3.998781e-04 3 1  ON 62
ci_064                 5.565419e-04 3 1  ON 63
ci_065                -2.760019e-03 3 1  ON 64
ci_066                -2.700182e-03 3 1  ON 65
ci_067                -3.087080e-03 3 1  ON 66
ci_068                -2.625658e-03 3 1  ON 67
ci_069                -4.624585e-04 3 1  ON 68
ci_070                -4.479226e-05 3 1  ON 69
ci_071                -2.141580e-03 3 1  ON 70
ci_072                -1.754784e-03 3 1  ON 71
ci_073                 2.789643e-04 3 1  ON 72
ci_074                -2.410454e-04 3 1  ON 73
ci_075                -2.479427e-04 3 1  ON 74
ci_076                -2.281740e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 15
    time step          = 0.05
    reference energy   = -22.7734
    reference variance = 0.664268
====================================================
  Execution time = 2.5444e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORMN2JWARM.s015
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2669e+01
  VMC Evar = 4.9687e-01
  Total weights = 1.9549e+06
  Execution time = 3.6632e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.485485841186
                                         uncertainty =       0.002448470621

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.485485841186
                                         uncertainty =       0.002448470621

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000492705238
  error estimate for blocks of size 2^( 2) =       0.000511404849
  error estimate for blocks of size 2^( 3) =       0.000528151199
  error estimate for blocks of size 2^( 4) =       0.000540754724
  error estimate for blocks of size 2^( 5) =       0.000547708462
  error estimate for blocks of size 2^( 6) =       0.000551356316
  error estimate for blocks of size 2^( 7) =       0.000554261528

      target function =                  N/A
              le_mean =     -22.669478921854
             les_mean =     514.408952671725
             stat err =       0.000548520257
             autocorr =       1.239398547804
              std dev =       0.696790430238
             le_variance =       0.485516903671

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.485281766256
                                         uncertainty =       0.002429984152

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.485281766256
                                         uncertainty =       0.002429984152

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000492603139
  error estimate for blocks of size 2^( 2) =       0.000511324384
  error estimate for blocks of size 2^( 3) =       0.000528076576
  error estimate for blocks of size 2^( 4) =       0.000540680410
  error estimate for blocks of size 2^( 5) =       0.000547641348
  error estimate for blocks of size 2^( 6) =       0.000551304112
  error estimate for blocks of size 2^( 7) =       0.000554173435

      target function =                  N/A
              le_mean =     -22.669463955316
             les_mean =     514.412963196791
             stat err =       0.000548449826
             autocorr =       1.239593972338
              std dev =       0.696646040624
             le_variance =       0.485315705917

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.485265447313
                                         uncertainty =       0.002431166077

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.485265447313
                                         uncertainty =       0.002431166077

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000492594339
  error estimate for blocks of size 2^( 2) =       0.000511315833
  error estimate for blocks of size 2^( 3) =       0.000528072722
  error estimate for blocks of size 2^( 4) =       0.000540684134
  error estimate for blocks of size 2^( 5) =       0.000547638987
  error estimate for blocks of size 2^( 6) =       0.000551303268
  error estimate for blocks of size 2^( 7) =       0.000554194676

      target function =                  N/A
              le_mean =     -22.669464348960
             les_mean =     514.402819024051
             stat err =       0.000548455266
             autocorr =       1.239662856228
              std dev =       0.696633594799
             le_variance =       0.485298365402

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.485413164475
                                         uncertainty =       0.002444663412

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.485413164475
                                         uncertainty =       0.002444663412

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000492668482
  error estimate for blocks of size 2^( 2) =       0.000511373449
  error estimate for blocks of size 2^( 3) =       0.000528124908
  error estimate for blocks of size 2^( 4) =       0.000540730874
  error estimate for blocks of size 2^( 5) =       0.000547687581
  error estimate for blocks of size 2^( 6) =       0.000551326732
  error estimate for blocks of size 2^( 7) =       0.000554223631

      target function =                  N/A
              le_mean =     -22.669469326512
             les_mean =     514.419096555489
             stat err =       0.000548492204
             autocorr =       1.239456702981
              std dev =       0.696738448344
             le_variance =       0.485444465401


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.669478921854        initial  <--
     9.5367e-02     9.5367e-01             1.7324e-03       -22.669463955316
     3.8147e-01     3.8147e+00             8.0226e-04       -22.669464348960
     1.5259e+00     1.5259e+01             2.5463e-04       -22.669469326512

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 45.8949
  </log>
  <optVariables href="FORMN2JWARM.s015.opt.xml">
ci_001                -7.065265e-01 3 1  ON 0
ci_002                -7.036847e-01 3 1  ON 1
ci_003                -4.283231e-02 3 1  ON 2
ci_004                -4.287868e-02 3 1  ON 3
ci_005                 1.687833e-02 3 1  ON 4
ci_006                 1.737812e-02 3 1  ON 5
ci_007                 1.346491e-02 3 1  ON 6
ci_008                 1.375610e-02 3 1  ON 7
ci_009                -1.170549e-02 3 1  ON 8
ci_010                -1.177183e-02 3 1  ON 9
ci_011                -8.665006e-03 3 1  ON 10
ci_012                -8.171342e-03 3 1  ON 11
ci_013                 9.433976e-03 3 1  ON 12
ci_014                 1.004736e-02 3 1  ON 13
ci_015                 1.301655e-02 3 1  ON 14
ci_016                 1.307635e-02 3 1  ON 15
ci_017                 1.107096e-02 3 1  ON 16
ci_018                 1.173576e-02 3 1  ON 17
ci_019                -3.324184e-04 3 1  ON 18
ci_020                 8.319050e-05 3 1  ON 19
ci_021                -6.665574e-03 3 1  ON 20
ci_022                -7.330033e-03 3 1  ON 21
ci_023                 7.012590e-03 3 1  ON 22
ci_024                 8.012828e-03 3 1  ON 23
ci_025                 4.125820e-03 3 1  ON 24
ci_026                 3.008439e-03 3 1  ON 25
ci_027                 7.014791e-03 3 1  ON 26
ci_028                 6.559155e-03 3 1  ON 27
ci_029                -5.645331e-03 3 1  ON 28
ci_030                -4.416227e-03 3 1  ON 29
ci_031                -8.538071e-03 3 1  ON 30
ci_032                -8.712748e-03 3 1  ON 31
ci_033                 4.266961e-03 3 1  ON 32
ci_034                 4.995047e-03 3 1  ON 33
ci_035                 1.499621e-03 3 1  ON 34
ci_036                 1.291214e-03 3 1  ON 35
ci_037                 4.614310e-03 3 1  ON 36
ci_038                 5.963933e-03 3 1  ON 37
ci_039                 5.289147e-03 3 1  ON 38
ci_040                 5.493060e-03 3 1  ON 39
ci_041                 4.996096e-03 3 1  ON 40
ci_042                 5.471041e-03 3 1  ON 41
ci_043                 4.867043e-03 3 1  ON 42
ci_044                 5.008289e-03 3 1  ON 43
ci_045                 3.288585e-03 3 1  ON 44
ci_046                 2.571988e-03 3 1  ON 45
ci_047                -6.957860e-04 3 1  ON 46
ci_048                -9.518621e-04 3 1  ON 47
ci_049                 7.642032e-04 3 1  ON 48
ci_050                 1.600027e-03 3 1  ON 49
ci_051                -2.050372e-03 3 1  ON 50
ci_052                -1.279999e-03 3 1  ON 51
ci_053                -2.269362e-03 3 1  ON 52
ci_054                -3.256819e-03 3 1  ON 53
ci_055                -1.009742e-03 3 1  ON 54
ci_056                -1.122478e-03 3 1  ON 55
ci_057                -1.826090e-03 3 1  ON 56
ci_058                -1.691725e-03 3 1  ON 57
ci_059                -1.454207e-04 3 1  ON 58
ci_060                 2.134553e-04 3 1  ON 59
ci_061                -7.310660e-04 3 1  ON 60
ci_062                 2.536116e-04 3 1  ON 61
ci_063                 2.609963e-04 3 1  ON 62
ci_064                 8.687069e-04 3 1  ON 63
ci_065                -3.230946e-03 3 1  ON 64
ci_066                -2.074882e-03 3 1  ON 65
ci_067                -3.446963e-03 3 1  ON 66
ci_068                -2.342707e-03 3 1  ON 67
ci_069                -3.656129e-04 3 1  ON 68
ci_070                 6.160331e-05 3 1  ON 69
ci_071                -2.239759e-03 3 1  ON 70
ci_072                -2.557048e-03 3 1  ON 71
ci_073                 3.194347e-04 3 1  ON 72
ci_074                -1.649747e-04 3 1  ON 73
ci_075                -1.494275e-05 3 1  ON 74
ci_076                -3.158516e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.6583e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORMN2JWARM.s016 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORMN2JWARM.s016 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=16  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2664e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 16
    time step          = 0.05
    reference energy   = -22.7033
    reference variance = 0.417742
====================================================
  Execution time = 2.6081e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORMN2JWARM.s016
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5278e+04
  VMC Eavg = -2.2669e+01
  VMC Evar = 4.9909e-01
  Total weights = 1.955160772e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.7413e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.484608094952
                                         uncertainty =       0.003141404827

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.484608094952
                                         uncertainty =       0.003141404827

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000492239784
  error estimate for blocks of size 2^( 2) =       0.000511012799
  error estimate for blocks of size 2^( 3) =       0.000528057525
  error estimate for blocks of size 2^( 4) =       0.000540209992
  error estimate for blocks of size 2^( 5) =       0.000546584023
  error estimate for blocks of size 2^( 6) =       0.000551120059
  error estimate for blocks of size 2^( 7) =       0.000556421136

      target function =                  N/A
              le_mean =     -22.669344487864
             les_mean =     514.398270156105
             stat err =       0.000548583802
             autocorr =       1.242031294456
              std dev =       0.696132177897
             le_variance =       0.484600009104


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266934448786e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.5367e-01, overlap shift 9.5367e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.669344487969       residual = 1.95e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.669346978506       residual = 2.31e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.669347191361       residual = 5.05e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.669347255706       residual = 1.16e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 9.5367e-01 is 3.697919e-04

solving harmonic davidson linear method for identity shift 3.8147e+00, overlap shift 3.8147e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.669344487969       residual = 1.95e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.669345189588       residual = 2.27e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.669345248872       residual = 4.25e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.669345265474       residual = 1.04e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 3.8147e+00 is 1.056033e-04

solving harmonic davidson linear method for identity shift 1.5259e+01, overlap shift 1.5259e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.669344487969       residual = 1.95e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.669344669119       residual = 2.36e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.669344684388       residual = 4.41e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.669344688784       residual = 1.20e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 1.5259e+01 is 2.737917e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.072710 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0834e+01
  </log>
  <optVariables href="FORMN2JWARM.s016.opt.xml">
ci_001                -7.065444e-01 3 1  ON 0
ci_002                -7.036761e-01 3 1  ON 1
ci_003                -4.274424e-02 3 1  ON 2
ci_004                -4.284723e-02 3 1  ON 3
ci_005                 1.694368e-02 3 1  ON 4
ci_006                 1.730678e-02 3 1  ON 5
ci_007                 1.344510e-02 3 1  ON 6
ci_008                 1.379187e-02 3 1  ON 7
ci_009                -1.172317e-02 3 1  ON 8
ci_010                -1.180236e-02 3 1  ON 9
ci_011                -8.658902e-03 3 1  ON 10
ci_012                -8.180099e-03 3 1  ON 11
ci_013                 9.372865e-03 3 1  ON 12
ci_014                 1.000695e-02 3 1  ON 13
ci_015                 1.296311e-02 3 1  ON 14
ci_016                 1.305352e-02 3 1  ON 15
ci_017                 1.106463e-02 3 1  ON 16
ci_018                 1.168621e-02 3 1  ON 17
ci_019                -3.155007e-04 3 1  ON 18
ci_020                 1.000354e-04 3 1  ON 19
ci_021                -6.644151e-03 3 1  ON 20
ci_022                -7.337899e-03 3 1  ON 21
ci_023                 7.043261e-03 3 1  ON 22
ci_024                 8.078596e-03 3 1  ON 23
ci_025                 4.136593e-03 3 1  ON 24
ci_026                 3.062023e-03 3 1  ON 25
ci_027                 7.107364e-03 3 1  ON 26
ci_028                 6.588836e-03 3 1  ON 27
ci_029                -5.545441e-03 3 1  ON 28
ci_030                -4.458848e-03 3 1  ON 29
ci_031                -8.546817e-03 3 1  ON 30
ci_032                -8.688295e-03 3 1  ON 31
ci_033                 4.273170e-03 3 1  ON 32
ci_034                 5.001059e-03 3 1  ON 33
ci_035                 1.476602e-03 3 1  ON 34
ci_036                 1.339303e-03 3 1  ON 35
ci_037                 4.649060e-03 3 1  ON 36
ci_038                 5.996741e-03 3 1  ON 37
ci_039                 5.304589e-03 3 1  ON 38
ci_040                 5.510452e-03 3 1  ON 39
ci_041                 4.992763e-03 3 1  ON 40
ci_042                 5.443315e-03 3 1  ON 41
ci_043                 4.848032e-03 3 1  ON 42
ci_044                 4.977233e-03 3 1  ON 43
ci_045                 3.204523e-03 3 1  ON 44
ci_046                 2.581904e-03 3 1  ON 45
ci_047                -7.079589e-04 3 1  ON 46
ci_048                -9.198968e-04 3 1  ON 47
ci_049                 7.772565e-04 3 1  ON 48
ci_050                 1.573602e-03 3 1  ON 49
ci_051                -2.143640e-03 3 1  ON 50
ci_052                -1.329193e-03 3 1  ON 51
ci_053                -2.283057e-03 3 1  ON 52
ci_054                -3.212600e-03 3 1  ON 53
ci_055                -1.073507e-03 3 1  ON 54
ci_056                -1.134065e-03 3 1  ON 55
ci_057                -1.802702e-03 3 1  ON 56
ci_058                -1.669873e-03 3 1  ON 57
ci_059                -9.602763e-05 3 1  ON 58
ci_060                 2.195401e-04 3 1  ON 59
ci_061                -6.855769e-04 3 1  ON 60
ci_062                 1.855412e-04 3 1  ON 61
ci_063                 2.443527e-04 3 1  ON 62
ci_064                 8.816128e-04 3 1  ON 63
ci_065                -3.125343e-03 3 1  ON 64
ci_066                -2.053250e-03 3 1  ON 65
ci_067                -3.406753e-03 3 1  ON 66
ci_068                -2.361116e-03 3 1  ON 67
ci_069                -3.787119e-04 3 1  ON 68
ci_070                 7.019980e-05 3 1  ON 69
ci_071                -2.242908e-03 3 1  ON 70
ci_072                -2.492168e-03 3 1  ON 71
ci_073                 2.821354e-04 3 1  ON 72
ci_074                -1.340084e-04 3 1  ON 73
ci_075                -4.899172e-05 3 1  ON 74
ci_076                -2.699951e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 16
    time step          = 0.05
    reference energy   = -22.6483
    reference variance = 0.491167
====================================================
  Execution time = 2.5238e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORMN2JWARM.s016
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2669e+01
  VMC Evar = 5.5039e-01
  Total weights = 1.9549e+06
  Execution time = 3.6678e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.512843430215
                                         uncertainty =       0.022629950484

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.512843430215
                                         uncertainty =       0.022629950484

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000506339959
  error estimate for blocks of size 2^( 2) =       0.000524481762
  error estimate for blocks of size 2^( 3) =       0.000540912140
  error estimate for blocks of size 2^( 4) =       0.000553532948
  error estimate for blocks of size 2^( 5) =       0.000560266062
  error estimate for blocks of size 2^( 6) =       0.000565831169
  error estimate for blocks of size 2^( 7) =       0.000569606240

      target function =                  N/A
              le_mean =     -22.668663527070
             les_mean =     514.421497104340
             stat err =       0.000562309105
             autocorr =       1.233291748685
              std dev =       0.716072837829
             le_variance =       0.512760309076

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.512718424897
                                         uncertainty =       0.022499662892

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.512718424897
                                         uncertainty =       0.022499662892

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000506278517
  error estimate for blocks of size 2^( 2) =       0.000524418020
  error estimate for blocks of size 2^( 3) =       0.000540851293
  error estimate for blocks of size 2^( 4) =       0.000553476489
  error estimate for blocks of size 2^( 5) =       0.000560209024
  error estimate for blocks of size 2^( 6) =       0.000565775100
  error estimate for blocks of size 2^( 7) =       0.000569552400

      target function =                  N/A
              le_mean =     -22.668669628155
             les_mean =     514.418731534535
             stat err =       0.000562253253
             autocorr =       1.233346072200
              std dev =       0.715985945133
             le_variance =       0.512635873628

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.512757785105
                                         uncertainty =       0.022545747431

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.512757785105
                                         uncertainty =       0.022545747431

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000506297818
  error estimate for blocks of size 2^( 2) =       0.000524438544
  error estimate for blocks of size 2^( 3) =       0.000540870814
  error estimate for blocks of size 2^( 4) =       0.000553494298
  error estimate for blocks of size 2^( 5) =       0.000560226637
  error estimate for blocks of size 2^( 6) =       0.000565791989
  error estimate for blocks of size 2^( 7) =       0.000569568769

      target function =                  N/A
              le_mean =     -22.668666179345
             les_mean =     514.418412979274
             stat err =       0.000562270423
             autocorr =       1.233327363612
              std dev =       0.716013240831
             le_variance =       0.512674961045

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.512833075647
                                         uncertainty =       0.022618663415

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.512833075647
                                         uncertainty =       0.022618663415

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000506334863
  error estimate for blocks of size 2^( 2) =       0.000524477091
  error estimate for blocks of size 2^( 3) =       0.000540908797
  error estimate for blocks of size 2^( 4) =       0.000553531010
  error estimate for blocks of size 2^( 5) =       0.000560265018
  error estimate for blocks of size 2^( 6) =       0.000565830180
  error estimate for blocks of size 2^( 7) =       0.000569611779

      target function =                  N/A
              le_mean =     -22.668662603916
             les_mean =     514.499415635129
             stat err =       0.000562309497
             autocorr =       1.233318296807
              std dev =       0.716065630417
             le_variance =       0.512749987064


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.668663527070        initial
     9.5367e-01     9.5367e+00             3.6979e-04       -22.668669628155  <--
     3.8147e+00     3.8147e+01             1.0560e-04       -22.668666179345
     1.5259e+01     1.5259e+02             2.7379e-05       -22.668662603916

*****************************************************************************
Applying the update for shift_i =   9.5367e-01     and shift_s =   9.5367e+00
*****************************************************************************

  Execution time = 4.3580e+01
  </log>
  <optVariables href="FORMN2JWARM.s016.opt.xml">
ci_001                -7.065984e-01 3 1  ON 0
ci_002                -7.036481e-01 3 1  ON 1
ci_003                -4.249138e-02 3 1  ON 2
ci_004                -4.276092e-02 3 1  ON 3
ci_005                 1.710031e-02 3 1  ON 4
ci_006                 1.713386e-02 3 1  ON 5
ci_007                 1.339840e-02 3 1  ON 6
ci_008                 1.388459e-02 3 1  ON 7
ci_009                -1.176158e-02 3 1  ON 8
ci_010                -1.188250e-02 3 1  ON 9
ci_011                -8.642241e-03 3 1  ON 10
ci_012                -8.204883e-03 3 1  ON 11
ci_013                 9.212949e-03 3 1  ON 12
ci_014                 9.904742e-03 3 1  ON 13
ci_015                 1.282117e-02 3 1  ON 14
ci_016                 1.299244e-02 3 1  ON 15
ci_017                 1.105063e-02 3 1  ON 16
ci_018                 1.155948e-02 3 1  ON 17
ci_019                -2.709166e-04 3 1  ON 18
ci_020                 1.419924e-04 3 1  ON 19
ci_021                -6.587372e-03 3 1  ON 20
ci_022                -7.360603e-03 3 1  ON 21
ci_023                 7.118438e-03 3 1  ON 22
ci_024                 8.243628e-03 3 1  ON 23
ci_025                 4.165648e-03 3 1  ON 24
ci_026                 3.205060e-03 3 1  ON 25
ci_027                 7.323884e-03 3 1  ON 26
ci_028                 6.657549e-03 3 1  ON 27
ci_029                -5.292412e-03 3 1  ON 28
ci_030                -4.572022e-03 3 1  ON 29
ci_031                -8.572799e-03 3 1  ON 30
ci_032                -8.623500e-03 3 1  ON 31
ci_033                 4.294708e-03 3 1  ON 32
ci_034                 5.016719e-03 3 1  ON 33
ci_035                 1.421724e-03 3 1  ON 34
ci_036                 1.451216e-03 3 1  ON 35
ci_037                 4.734897e-03 3 1  ON 36
ci_038                 6.079388e-03 3 1  ON 37
ci_039                 5.338495e-03 3 1  ON 38
ci_040                 5.551832e-03 3 1  ON 39
ci_041                 4.984182e-03 3 1  ON 40
ci_042                 5.374742e-03 3 1  ON 41
ci_043                 4.800614e-03 3 1  ON 42
ci_044                 4.897531e-03 3 1  ON 43
ci_045                 2.987517e-03 3 1  ON 44
ci_046                 2.609228e-03 3 1  ON 45
ci_047                -7.367042e-04 3 1  ON 46
ci_048                -8.449916e-04 3 1  ON 47
ci_049                 8.108283e-04 3 1  ON 48
ci_050                 1.505040e-03 3 1  ON 49
ci_051                -2.383584e-03 3 1  ON 50
ci_052                -1.460154e-03 3 1  ON 51
ci_053                -2.318186e-03 3 1  ON 52
ci_054                -3.097439e-03 3 1  ON 53
ci_055                -1.240175e-03 3 1  ON 54
ci_056                -1.165482e-03 3 1  ON 55
ci_057                -1.743505e-03 3 1  ON 56
ci_058                -1.615293e-03 3 1  ON 57
ci_059                 2.341879e-05 3 1  ON 58
ci_060                 2.322423e-04 3 1  ON 59
ci_061                -5.665368e-04 3 1  ON 60
ci_062                 1.518035e-05 3 1  ON 61
ci_063                 1.985476e-04 3 1  ON 62
ci_064                 9.136899e-04 3 1  ON 63
ci_065                -2.861155e-03 3 1  ON 64
ci_066                -1.998296e-03 3 1  ON 65
ci_067                -3.300805e-03 3 1  ON 66
ci_068                -2.409929e-03 3 1  ON 67
ci_069                -4.149792e-04 3 1  ON 68
ci_070                 8.978305e-05 3 1  ON 69
ci_071                -2.246330e-03 3 1  ON 70
ci_072                -2.326921e-03 3 1  ON 71
ci_073                 1.924778e-04 3 1  ON 72
ci_074                -6.233557e-05 3 1  ON 73
ci_075                -1.367491e-04 3 1  ON 74
ci_076                -1.514021e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.4430e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORMN2JWARM.s017 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORMN2JWARM.s017 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=17  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2665e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 17
    time step          = 0.05
    reference energy   = -22.6707
    reference variance = 0.335428
====================================================
  Execution time = 2.5953e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORMN2JWARM.s017
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5281e+04
  VMC Eavg = -2.2668e+01
  VMC Evar = 4.9550e-01
  Total weights = 1.955120078e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.7771e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.484961180333
                                         uncertainty =       0.002913981030

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.484961180333
                                         uncertainty =       0.002913981030

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000492425677
  error estimate for blocks of size 2^( 2) =       0.000511066822
  error estimate for blocks of size 2^( 3) =       0.000527655907
  error estimate for blocks of size 2^( 4) =       0.000539615105
  error estimate for blocks of size 2^( 5) =       0.000546474012
  error estimate for blocks of size 2^( 6) =       0.000550804059
  error estimate for blocks of size 2^( 7) =       0.000554147561

      target function =                  N/A
              le_mean =     -22.668276706326
             les_mean =     514.346271620465
             stat err =       0.000547760184
             autocorr =       1.237369880136
              std dev =       0.696395071049
             le_variance =       0.484966094981


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266827670633e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3842e-01, overlap shift 2.3842e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.668276706389       residual = 1.69e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.668294211459       residual = 3.18e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.668294108063       residual = 1.36e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.668294381328       residual = 4.57e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 2.3842e-01 is 1.053785e-03

solving harmonic davidson linear method for identity shift 9.5367e-01, overlap shift 9.5367e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.668276706389       residual = 1.69e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.668282786820       residual = 1.43e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.668282819639       residual = 3.53e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.668282792080       residual = 6.65e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 9.5367e-01 is 3.447725e-04

solving harmonic davidson linear method for identity shift 3.8147e+00, overlap shift 3.8147e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.668276706389       residual = 1.69e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.668278390442       residual = 1.54e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.668278416726       residual = 4.17e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.668278402919       residual = 1.00e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 3.8147e+00 is 9.353120e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.077145 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0742e+01
  </log>
  <optVariables href="FORMN2JWARM.s017.opt.xml">
ci_001                -7.065177e-01 3 1  ON 0
ci_002                -7.037693e-01 3 1  ON 1
ci_003                -4.227543e-02 3 1  ON 2
ci_004                -4.251649e-02 3 1  ON 3
ci_005                 1.707130e-02 3 1  ON 4
ci_006                 1.710809e-02 3 1  ON 5
ci_007                 1.341121e-02 3 1  ON 6
ci_008                 1.377766e-02 3 1  ON 7
ci_009                -1.157513e-02 3 1  ON 8
ci_010                -1.179706e-02 3 1  ON 9
ci_011                -8.789486e-03 3 1  ON 10
ci_012                -8.210408e-03 3 1  ON 11
ci_013                 9.069118e-03 3 1  ON 12
ci_014                 9.941372e-03 3 1  ON 13
ci_015                 1.281716e-02 3 1  ON 14
ci_016                 1.324310e-02 3 1  ON 15
ci_017                 1.097232e-02 3 1  ON 16
ci_018                 1.148098e-02 3 1  ON 17
ci_019                -3.078412e-04 3 1  ON 18
ci_020                 2.762303e-04 3 1  ON 19
ci_021                -6.932145e-03 3 1  ON 20
ci_022                -7.464518e-03 3 1  ON 21
ci_023                 7.150686e-03 3 1  ON 22
ci_024                 8.208074e-03 3 1  ON 23
ci_025                 4.084370e-03 3 1  ON 24
ci_026                 3.428428e-03 3 1  ON 25
ci_027                 7.295171e-03 3 1  ON 26
ci_028                 6.779951e-03 3 1  ON 27
ci_029                -5.098246e-03 3 1  ON 28
ci_030                -4.554720e-03 3 1  ON 29
ci_031                -8.324547e-03 3 1  ON 30
ci_032                -8.460927e-03 3 1  ON 31
ci_033                 4.378476e-03 3 1  ON 32
ci_034                 4.825865e-03 3 1  ON 33
ci_035                 1.331934e-03 3 1  ON 34
ci_036                 1.401403e-03 3 1  ON 35
ci_037                 4.663371e-03 3 1  ON 36
ci_038                 5.832702e-03 3 1  ON 37
ci_039                 5.456964e-03 3 1  ON 38
ci_040                 5.379017e-03 3 1  ON 39
ci_041                 5.088273e-03 3 1  ON 40
ci_042                 5.346553e-03 3 1  ON 41
ci_043                 4.702996e-03 3 1  ON 42
ci_044                 4.809050e-03 3 1  ON 43
ci_045                 2.983137e-03 3 1  ON 44
ci_046                 2.846401e-03 3 1  ON 45
ci_047                -6.230789e-04 3 1  ON 46
ci_048                -6.944404e-04 3 1  ON 47
ci_049                 1.100311e-03 3 1  ON 48
ci_050                 1.202347e-03 3 1  ON 49
ci_051                -2.424241e-03 3 1  ON 50
ci_052                -1.400760e-03 3 1  ON 51
ci_053                -2.230191e-03 3 1  ON 52
ci_054                -3.095022e-03 3 1  ON 53
ci_055                -1.231904e-03 3 1  ON 54
ci_056                -1.354467e-03 3 1  ON 55
ci_057                -1.766849e-03 3 1  ON 56
ci_058                -1.593267e-03 3 1  ON 57
ci_059                -4.256986e-05 3 1  ON 58
ci_060                 3.265398e-04 3 1  ON 59
ci_061                -3.609259e-04 3 1  ON 60
ci_062                 9.643091e-05 3 1  ON 61
ci_063                 2.329199e-04 3 1  ON 62
ci_064                 6.618269e-04 3 1  ON 63
ci_065                -3.071770e-03 3 1  ON 64
ci_066                -2.055068e-03 3 1  ON 65
ci_067                -3.064402e-03 3 1  ON 66
ci_068                -2.379140e-03 3 1  ON 67
ci_069                -1.900399e-04 3 1  ON 68
ci_070                 4.540009e-05 3 1  ON 69
ci_071                -2.246234e-03 3 1  ON 70
ci_072                -2.170148e-03 3 1  ON 71
ci_073                 2.286153e-04 3 1  ON 72
ci_074                 5.868363e-05 3 1  ON 73
ci_075                -1.078741e-04 3 1  ON 74
ci_076                -1.905333e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 17
    time step          = 0.05
    reference energy   = -22.6915
    reference variance = 0.473076
====================================================
  Execution time = 2.5546e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORMN2JWARM.s017
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2669e+01
  VMC Evar = 5.0824e-01
  Total weights = 1.9552e+06
  Execution time = 3.6663e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.494974588270
                                         uncertainty =       0.005424847219

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.494974588270
                                         uncertainty =       0.005424847219

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000497783500
  error estimate for blocks of size 2^( 2) =       0.000516004188
  error estimate for blocks of size 2^( 3) =       0.000533328672
  error estimate for blocks of size 2^( 4) =       0.000545461721
  error estimate for blocks of size 2^( 5) =       0.000552216476
  error estimate for blocks of size 2^( 6) =       0.000555949158
  error estimate for blocks of size 2^( 7) =       0.000558367290

      target function =                  N/A
              le_mean =     -22.669338801487
             les_mean =     514.409954749147
             stat err =       0.000552998661
             autocorr =       1.234147776880
              std dev =       0.703972177161
             le_variance =       0.495576826217

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.494658970871
                                         uncertainty =       0.005405670316

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.494658970871
                                         uncertainty =       0.005405670316

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000497623446
  error estimate for blocks of size 2^( 2) =       0.000515868575
  error estimate for blocks of size 2^( 3) =       0.000533218453
  error estimate for blocks of size 2^( 4) =       0.000545374063
  error estimate for blocks of size 2^( 5) =       0.000552130934
  error estimate for blocks of size 2^( 6) =       0.000555861386
  error estimate for blocks of size 2^( 7) =       0.000558306749

      target function =                  N/A
              le_mean =     -22.669327709310
             les_mean =     514.434053263791
             stat err =       0.000552918283
             autocorr =       1.234582830080
              std dev =       0.703745826372
             le_variance =       0.495258188136

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.494687922877
                                         uncertainty =       0.005408592438

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.494687922877
                                         uncertainty =       0.005408592438

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000497638689
  error estimate for blocks of size 2^( 2) =       0.000515877352
  error estimate for blocks of size 2^( 3) =       0.000533215693
  error estimate for blocks of size 2^( 4) =       0.000545360271
  error estimate for blocks of size 2^( 5) =       0.000552115005
  error estimate for blocks of size 2^( 6) =       0.000555847592
  error estimate for blocks of size 2^( 7) =       0.000558281618

      target function =                  N/A
              le_mean =     -22.669331345989
             les_mean =     514.407170241628
             stat err =       0.000552901122
             autocorr =       1.234430567025
              std dev =       0.703767383306
             le_variance =       0.495288529805

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.494919692062
                                         uncertainty =       0.005422020402

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.494919692062
                                         uncertainty =       0.005422020402

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000497755834
  error estimate for blocks of size 2^( 2) =       0.000515979985
  error estimate for blocks of size 2^( 3) =       0.000533307055
  error estimate for blocks of size 2^( 4) =       0.000545441704
  error estimate for blocks of size 2^( 5) =       0.000552196205
  error estimate for blocks of size 2^( 6) =       0.000555933915
  error estimate for blocks of size 2^( 7) =       0.000558356738

      target function =                  N/A
              le_mean =     -22.669335316341
             les_mean =     514.407378471825
             stat err =       0.000552982141
             autocorr =       1.234211227750
              std dev =       0.703933050993
             le_variance =       0.495521740280


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.669338801487        initial  <--
     2.3842e-01     2.3842e+00             1.0538e-03       -22.669327709310
     9.5367e-01     9.5367e+00             3.4477e-04       -22.669331345989
     3.8147e+00     3.8147e+01             9.3531e-05       -22.669335316341

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 43.8612
  </log>
  <optVariables href="FORMN2JWARM.s017.opt.xml">
ci_001                -7.065984e-01 3 1  ON 0
ci_002                -7.036481e-01 3 1  ON 1
ci_003                -4.249138e-02 3 1  ON 2
ci_004                -4.276092e-02 3 1  ON 3
ci_005                 1.710031e-02 3 1  ON 4
ci_006                 1.713386e-02 3 1  ON 5
ci_007                 1.339840e-02 3 1  ON 6
ci_008                 1.388459e-02 3 1  ON 7
ci_009                -1.176158e-02 3 1  ON 8
ci_010                -1.188250e-02 3 1  ON 9
ci_011                -8.642241e-03 3 1  ON 10
ci_012                -8.204883e-03 3 1  ON 11
ci_013                 9.212949e-03 3 1  ON 12
ci_014                 9.904742e-03 3 1  ON 13
ci_015                 1.282117e-02 3 1  ON 14
ci_016                 1.299244e-02 3 1  ON 15
ci_017                 1.105063e-02 3 1  ON 16
ci_018                 1.155948e-02 3 1  ON 17
ci_019                -2.709166e-04 3 1  ON 18
ci_020                 1.419924e-04 3 1  ON 19
ci_021                -6.587372e-03 3 1  ON 20
ci_022                -7.360603e-03 3 1  ON 21
ci_023                 7.118438e-03 3 1  ON 22
ci_024                 8.243628e-03 3 1  ON 23
ci_025                 4.165648e-03 3 1  ON 24
ci_026                 3.205060e-03 3 1  ON 25
ci_027                 7.323884e-03 3 1  ON 26
ci_028                 6.657549e-03 3 1  ON 27
ci_029                -5.292412e-03 3 1  ON 28
ci_030                -4.572022e-03 3 1  ON 29
ci_031                -8.572799e-03 3 1  ON 30
ci_032                -8.623500e-03 3 1  ON 31
ci_033                 4.294708e-03 3 1  ON 32
ci_034                 5.016719e-03 3 1  ON 33
ci_035                 1.421724e-03 3 1  ON 34
ci_036                 1.451216e-03 3 1  ON 35
ci_037                 4.734897e-03 3 1  ON 36
ci_038                 6.079388e-03 3 1  ON 37
ci_039                 5.338495e-03 3 1  ON 38
ci_040                 5.551832e-03 3 1  ON 39
ci_041                 4.984182e-03 3 1  ON 40
ci_042                 5.374742e-03 3 1  ON 41
ci_043                 4.800614e-03 3 1  ON 42
ci_044                 4.897531e-03 3 1  ON 43
ci_045                 2.987517e-03 3 1  ON 44
ci_046                 2.609228e-03 3 1  ON 45
ci_047                -7.367042e-04 3 1  ON 46
ci_048                -8.449916e-04 3 1  ON 47
ci_049                 8.108283e-04 3 1  ON 48
ci_050                 1.505040e-03 3 1  ON 49
ci_051                -2.383584e-03 3 1  ON 50
ci_052                -1.460154e-03 3 1  ON 51
ci_053                -2.318186e-03 3 1  ON 52
ci_054                -3.097439e-03 3 1  ON 53
ci_055                -1.240175e-03 3 1  ON 54
ci_056                -1.165482e-03 3 1  ON 55
ci_057                -1.743505e-03 3 1  ON 56
ci_058                -1.615293e-03 3 1  ON 57
ci_059                 2.341879e-05 3 1  ON 58
ci_060                 2.322423e-04 3 1  ON 59
ci_061                -5.665368e-04 3 1  ON 60
ci_062                 1.518035e-05 3 1  ON 61
ci_063                 1.985476e-04 3 1  ON 62
ci_064                 9.136899e-04 3 1  ON 63
ci_065                -2.861155e-03 3 1  ON 64
ci_066                -1.998296e-03 3 1  ON 65
ci_067                -3.300805e-03 3 1  ON 66
ci_068                -2.409929e-03 3 1  ON 67
ci_069                -4.149792e-04 3 1  ON 68
ci_070                 8.978305e-05 3 1  ON 69
ci_071                -2.246330e-03 3 1  ON 70
ci_072                -2.326921e-03 3 1  ON 71
ci_073                 1.924778e-04 3 1  ON 72
ci_074                -6.233557e-05 3 1  ON 73
ci_075                -1.367491e-04 3 1  ON 74
ci_076                -1.514021e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.4618e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORMN2JWARM.s018 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORMN2JWARM.s018 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=18  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2666e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 18
    time step          = 0.05
    reference energy   = -22.6081
    reference variance = 0.262365
====================================================
  Execution time = 2.5885e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORMN2JWARM.s018
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5268e+04
  VMC Eavg = -2.2669e+01
  VMC Evar = 5.0057e-01
  Total weights = 1.955268138e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.7496e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.486990916132
                                         uncertainty =       0.002725276510

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.486990916132
                                         uncertainty =       0.002725276510

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000493513729
  error estimate for blocks of size 2^( 2) =       0.000512089938
  error estimate for blocks of size 2^( 3) =       0.000528510762
  error estimate for blocks of size 2^( 4) =       0.000540310663
  error estimate for blocks of size 2^( 5) =       0.000547081074
  error estimate for blocks of size 2^( 6) =       0.000549026173
  error estimate for blocks of size 2^( 7) =       0.000550031895

      target function =                  N/A
              le_mean =     -22.668859110790
             les_mean =     514.377740458478
             stat err =       0.000546612451
             autocorr =       1.226762700132
              std dev =       0.697933809167
             le_variance =       0.487111601978


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266885911079e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3842e+00, overlap shift 2.3842e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.668859110868       residual = 1.53e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.668859742290       residual = 1.10e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.668859747650       residual = 1.37e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.668859748720       residual = 2.50e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 2.3842e+00 is 1.692192e-04

solving harmonic davidson linear method for identity shift 9.5367e+00, overlap shift 9.5367e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.668859110868       residual = 1.53e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.668859275701       residual = 1.28e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.668859269893       residual = 1.52e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.668859271096       residual = 2.93e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 9.5367e+00 is 4.448014e-05

solving harmonic davidson linear method for identity shift 3.8147e+01, overlap shift 3.8147e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.668859110868       residual = 1.53e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.668859152536       residual = 1.35e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.668859150592       residual = 1.61e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.668859150952       residual = 3.14e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 3.8147e+01 is 1.126515e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.081469 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0646e+01
  </log>
  <optVariables href="FORMN2JWARM.s018.opt.xml">
ci_001                -7.066029e-01 3 1  ON 0
ci_002                -7.036466e-01 3 1  ON 1
ci_003                -4.246847e-02 3 1  ON 2
ci_004                -4.272807e-02 3 1  ON 3
ci_005                 1.710591e-02 3 1  ON 4
ci_006                 1.714904e-02 3 1  ON 5
ci_007                 1.338693e-02 3 1  ON 6
ci_008                 1.386908e-02 3 1  ON 7
ci_009                -1.176259e-02 3 1  ON 8
ci_010                -1.188570e-02 3 1  ON 9
ci_011                -8.631408e-03 3 1  ON 10
ci_012                -8.231772e-03 3 1  ON 11
ci_013                 9.228130e-03 3 1  ON 12
ci_014                 9.909231e-03 3 1  ON 13
ci_015                 1.279658e-02 3 1  ON 14
ci_016                 1.300002e-02 3 1  ON 15
ci_017                 1.105645e-02 3 1  ON 16
ci_018                 1.156233e-02 3 1  ON 17
ci_019                -2.853431e-04 3 1  ON 18
ci_020                 1.416214e-04 3 1  ON 19
ci_021                -6.619914e-03 3 1  ON 20
ci_022                -7.358241e-03 3 1  ON 21
ci_023                 7.147872e-03 3 1  ON 22
ci_024                 8.253003e-03 3 1  ON 23
ci_025                 4.167433e-03 3 1  ON 24
ci_026                 3.231981e-03 3 1  ON 25
ci_027                 7.326451e-03 3 1  ON 26
ci_028                 6.685048e-03 3 1  ON 27
ci_029                -5.299642e-03 3 1  ON 28
ci_030                -4.571758e-03 3 1  ON 29
ci_031                -8.560089e-03 3 1  ON 30
ci_032                -8.615518e-03 3 1  ON 31
ci_033                 4.294298e-03 3 1  ON 32
ci_034                 5.020240e-03 3 1  ON 33
ci_035                 1.418815e-03 3 1  ON 34
ci_036                 1.449168e-03 3 1  ON 35
ci_037                 4.748164e-03 3 1  ON 36
ci_038                 6.064965e-03 3 1  ON 37
ci_039                 5.325135e-03 3 1  ON 38
ci_040                 5.542829e-03 3 1  ON 39
ci_041                 4.989811e-03 3 1  ON 40
ci_042                 5.375309e-03 3 1  ON 41
ci_043                 4.790070e-03 3 1  ON 42
ci_044                 4.898032e-03 3 1  ON 43
ci_045                 2.973295e-03 3 1  ON 44
ci_046                 2.613073e-03 3 1  ON 45
ci_047                -7.389683e-04 3 1  ON 46
ci_048                -8.463384e-04 3 1  ON 47
ci_049                 8.318206e-04 3 1  ON 48
ci_050                 1.486531e-03 3 1  ON 49
ci_051                -2.349035e-03 3 1  ON 50
ci_052                -1.460226e-03 3 1  ON 51
ci_053                -2.313714e-03 3 1  ON 52
ci_054                -3.088833e-03 3 1  ON 53
ci_055                -1.253196e-03 3 1  ON 54
ci_056                -1.166846e-03 3 1  ON 55
ci_057                -1.704051e-03 3 1  ON 56
ci_058                -1.602114e-03 3 1  ON 57
ci_059                 2.565058e-05 3 1  ON 58
ci_060                 2.415349e-04 3 1  ON 59
ci_061                -5.477957e-04 3 1  ON 60
ci_062                 1.358183e-05 3 1  ON 61
ci_063                 1.813606e-04 3 1  ON 62
ci_064                 9.080984e-04 3 1  ON 63
ci_065                -2.816674e-03 3 1  ON 64
ci_066                -1.994188e-03 3 1  ON 65
ci_067                -3.294523e-03 3 1  ON 66
ci_068                -2.403569e-03 3 1  ON 67
ci_069                -3.957297e-04 3 1  ON 68
ci_070                 7.207093e-05 3 1  ON 69
ci_071                -2.245865e-03 3 1  ON 70
ci_072                -2.345374e-03 3 1  ON 71
ci_073                 1.760071e-04 3 1  ON 72
ci_074                -6.055597e-05 3 1  ON 73
ci_075                -1.332015e-04 3 1  ON 74
ci_076                -1.607058e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 18
    time step          = 0.05
    reference energy   = -22.6478
    reference variance = 0.276604
====================================================
  Execution time = 2.5407e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORMN2JWARM.s018
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2670e+01
  VMC Evar = 4.9576e-01
  Total weights = 1.9550e+06
  Execution time = 3.6609e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.484522733316
                                         uncertainty =       0.002419930829

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.484522733316
                                         uncertainty =       0.002419930829

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000492194784
  error estimate for blocks of size 2^( 2) =       0.000510733127
  error estimate for blocks of size 2^( 3) =       0.000527501478
  error estimate for blocks of size 2^( 4) =       0.000539923651
  error estimate for blocks of size 2^( 5) =       0.000547956144
  error estimate for blocks of size 2^( 6) =       0.000553083551
  error estimate for blocks of size 2^( 7) =       0.000555499191

      target function =                  N/A
              le_mean =     -22.669569369904
             les_mean =     514.405201457498
             stat err =       0.000549115634
             autocorr =       1.244668228891
              std dev =       0.696068539037
             le_variance =       0.484511411037

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.484495104972
                                         uncertainty =       0.002420095212

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.484495104972
                                         uncertainty =       0.002420095212

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000492180238
  error estimate for blocks of size 2^( 2) =       0.000510717936
  error estimate for blocks of size 2^( 3) =       0.000527486232
  error estimate for blocks of size 2^( 4) =       0.000539906436
  error estimate for blocks of size 2^( 5) =       0.000547936931
  error estimate for blocks of size 2^( 6) =       0.000553065093
  error estimate for blocks of size 2^( 7) =       0.000555480728

      target function =                  N/A
              le_mean =     -22.669570575127
             les_mean =     514.405248434664
             stat err =       0.000549097297
             autocorr =       1.244658670122
              std dev =       0.696047967021
             le_variance =       0.484482772394

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.484507808661
                                         uncertainty =       0.002420030654

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.484507808661
                                         uncertainty =       0.002420030654

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000492186935
  error estimate for blocks of size 2^( 2) =       0.000510724895
  error estimate for blocks of size 2^( 3) =       0.000527493222
  error estimate for blocks of size 2^( 4) =       0.000539914430
  error estimate for blocks of size 2^( 5) =       0.000547945709
  error estimate for blocks of size 2^( 6) =       0.000553073589
  error estimate for blocks of size 2^( 7) =       0.000555488972

      target function =                  N/A
              le_mean =     -22.669569997045
             les_mean =     514.406609774174
             stat err =       0.000549105675
             autocorr =       1.244662778156
              std dev =       0.696057438572
             le_variance =       0.484495957792

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.484520758913
                                         uncertainty =       0.002419941732

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.484520758913
                                         uncertainty =       0.002419941732

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000492193747
  error estimate for blocks of size 2^( 2) =       0.000510732042
  error estimate for blocks of size 2^( 3) =       0.000527500390
  error estimate for blocks of size 2^( 4) =       0.000539922432
  error estimate for blocks of size 2^( 5) =       0.000547954788
  error estimate for blocks of size 2^( 6) =       0.000553082251
  error estimate for blocks of size 2^( 7) =       0.000555497861

      target function =                  N/A
              le_mean =     -22.669569435723
             les_mean =     514.405241124339
             stat err =       0.000549114333
             autocorr =       1.244667575358
              std dev =       0.696067072509
             le_variance =       0.484509369431


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.669569369904        initial
     2.3842e+00     2.3842e+01             1.6922e-04       -22.669570575127  <--
     9.5367e+00     9.5367e+01             4.4480e-05       -22.669569997045
     3.8147e+01     3.8147e+02             1.1265e-05       -22.669569435723

*****************************************************************************
Applying the update for shift_i =   2.3842e+00     and shift_s =   2.3842e+01
*****************************************************************************

  Execution time = 4.3714e+01
  </log>
  <optVariables href="FORMN2JWARM.s018.opt.xml">
ci_001                -7.066161e-01 3 1  ON 0
ci_002                -7.036421e-01 3 1  ON 1
ci_003                -4.240094e-02 3 1  ON 2
ci_004                -4.263149e-02 3 1  ON 3
ci_005                 1.712097e-02 3 1  ON 4
ci_006                 1.719038e-02 3 1  ON 5
ci_007                 1.335380e-02 3 1  ON 6
ci_008                 1.382559e-02 3 1  ON 7
ci_009                -1.176538e-02 3 1  ON 8
ci_010                -1.189472e-02 3 1  ON 9
ci_011                -8.600248e-03 3 1  ON 10
ci_012                -8.307798e-03 3 1  ON 11
ci_013                 9.271033e-03 3 1  ON 12
ci_014                 9.921251e-03 3 1  ON 13
ci_015                 1.272580e-02 3 1  ON 14
ci_016                 1.302155e-02 3 1  ON 15
ci_017                 1.107283e-02 3 1  ON 16
ci_018                 1.157103e-02 3 1  ON 17
ci_019                -3.262700e-04 3 1  ON 18
ci_020                 1.401210e-04 3 1  ON 19
ci_021                -6.713319e-03 3 1  ON 20
ci_022                -7.351538e-03 3 1  ON 21
ci_023                 7.229709e-03 3 1  ON 22
ci_024                 8.278813e-03 3 1  ON 23
ci_025                 4.172715e-03 3 1  ON 24
ci_026                 3.308534e-03 3 1  ON 25
ci_027                 7.333079e-03 3 1  ON 26
ci_028                 6.759256e-03 3 1  ON 27
ci_029                -5.321239e-03 3 1  ON 28
ci_030                -4.571329e-03 3 1  ON 29
ci_031                -8.522890e-03 3 1  ON 30
ci_032                -8.592847e-03 3 1  ON 31
ci_033                 4.293522e-03 3 1  ON 32
ci_034                 5.030309e-03 3 1  ON 33
ci_035                 1.410812e-03 3 1  ON 34
ci_036                 1.443583e-03 3 1  ON 35
ci_037                 4.786254e-03 3 1  ON 36
ci_038                 6.024379e-03 3 1  ON 37
ci_039                 5.288633e-03 3 1  ON 38
ci_040                 5.518444e-03 3 1  ON 39
ci_041                 5.005718e-03 3 1  ON 40
ci_042                 5.376840e-03 3 1  ON 41
ci_043                 4.759954e-03 3 1  ON 42
ci_044                 4.900054e-03 3 1  ON 43
ci_045                 2.933133e-03 3 1  ON 44
ci_046                 2.623975e-03 3 1  ON 45
ci_047                -7.451740e-04 3 1  ON 46
ci_048                -8.498817e-04 3 1  ON 47
ci_049                 8.911193e-04 3 1  ON 48
ci_050                 1.434322e-03 3 1  ON 49
ci_051                -2.251437e-03 3 1  ON 50
ci_052                -1.459801e-03 3 1  ON 51
ci_053                -2.301155e-03 3 1  ON 52
ci_054                -3.063744e-03 3 1  ON 53
ci_055                -1.290362e-03 3 1  ON 54
ci_056                -1.171303e-03 3 1  ON 55
ci_057                -1.594111e-03 3 1  ON 56
ci_058                -1.565446e-03 3 1  ON 57
ci_059                 3.218195e-05 3 1  ON 58
ci_060                 2.667332e-04 3 1  ON 59
ci_061                -4.949394e-04 3 1  ON 60
ci_062                 9.547891e-06 3 1  ON 61
ci_063                 1.330117e-04 3 1  ON 62
ci_064                 8.925282e-04 3 1  ON 63
ci_065                -2.691935e-03 3 1  ON 64
ci_066                -1.982344e-03 3 1  ON 65
ci_067                -3.276714e-03 3 1  ON 66
ci_068                -2.385774e-03 3 1  ON 67
ci_069                -3.422264e-04 3 1  ON 68
ci_070                 2.220756e-05 3 1  ON 69
ci_071                -2.245099e-03 3 1  ON 70
ci_072                -2.396882e-03 3 1  ON 71
ci_073                 1.313959e-04 3 1  ON 72
ci_074                -5.597884e-05 3 1  ON 73
ci_075                -1.235235e-04 3 1  ON 74
ci_076                -1.865965e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.4376e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORMN2JWARM.s019 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORMN2JWARM.s019 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=19  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2664e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 19
    time step          = 0.05
    reference energy   = -22.6592
    reference variance = 0.322749
====================================================
  Execution time = 2.6019e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORMN2JWARM.s019
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5290e+04
  VMC Eavg = -2.2669e+01
  VMC Evar = 5.0556e-01
  Total weights = 1.954927358e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.7425e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.488059509217
                                         uncertainty =       0.003164878934

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.488059509217
                                         uncertainty =       0.003164878934

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000494068803
  error estimate for blocks of size 2^( 2) =       0.000512923810
  error estimate for blocks of size 2^( 3) =       0.000529069240
  error estimate for blocks of size 2^( 4) =       0.000541201613
  error estimate for blocks of size 2^( 5) =       0.000548156905
  error estimate for blocks of size 2^( 6) =       0.000550499047
  error estimate for blocks of size 2^( 7) =       0.000551836322

      target function =                  N/A
              le_mean =     -22.668605208212
             les_mean =     514.371220624498
             stat err =       0.000547923472
             autocorr =       1.229886252009
              std dev =       0.698718801300
             le_variance =       0.488207963291


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266860520821e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.9605e-01, overlap shift 5.9605e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.668605208304       residual = 1.57e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.668607975914       residual = 2.14e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.668608324272       residual = 7.10e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.668608370592       residual = 2.07e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 5.9605e-01 is 6.944820e-04

solving harmonic davidson linear method for identity shift 2.3842e+00, overlap shift 2.3842e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.668605208304       residual = 1.57e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.668606025684       residual = 1.76e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.668606105996       residual = 7.78e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.668606117991       residual = 1.78e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 2.3842e+00 is 2.030416e-04

solving harmonic davidson linear method for identity shift 9.5367e+00, overlap shift 9.5367e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.668605208304       residual = 1.57e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.668605422354       residual = 1.81e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.668605441568       residual = 8.58e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.668605445638       residual = 2.08e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 9.5367e+00 is 5.301271e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.085884 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0773e+01
  </log>
  <optVariables href="FORMN2JWARM.s019.opt.xml">
ci_001                -7.066103e-01 3 1  ON 0
ci_002                -7.036581e-01 3 1  ON 1
ci_003                -4.237287e-02 3 1  ON 2
ci_004                -4.248513e-02 3 1  ON 3
ci_005                 1.709195e-02 3 1  ON 4
ci_006                 1.715465e-02 3 1  ON 5
ci_007                 1.339308e-02 3 1  ON 6
ci_008                 1.380524e-02 3 1  ON 7
ci_009                -1.177703e-02 3 1  ON 8
ci_010                -1.190704e-02 3 1  ON 9
ci_011                -8.633939e-03 3 1  ON 10
ci_012                -8.334499e-03 3 1  ON 11
ci_013                 9.222330e-03 3 1  ON 12
ci_014                 9.897907e-03 3 1  ON 13
ci_015                 1.271516e-02 3 1  ON 14
ci_016                 1.299697e-02 3 1  ON 15
ci_017                 1.112779e-02 3 1  ON 16
ci_018                 1.157062e-02 3 1  ON 17
ci_019                -2.748199e-04 3 1  ON 18
ci_020                 6.490794e-05 3 1  ON 19
ci_021                -6.772045e-03 3 1  ON 20
ci_022                -7.402223e-03 3 1  ON 21
ci_023                 7.314786e-03 3 1  ON 22
ci_024                 8.182710e-03 3 1  ON 23
ci_025                 4.173477e-03 3 1  ON 24
ci_026                 3.437304e-03 3 1  ON 25
ci_027                 7.276742e-03 3 1  ON 26
ci_028                 6.742969e-03 3 1  ON 27
ci_029                -5.253019e-03 3 1  ON 28
ci_030                -4.617020e-03 3 1  ON 29
ci_031                -8.559632e-03 3 1  ON 30
ci_032                -8.519291e-03 3 1  ON 31
ci_033                 4.334353e-03 3 1  ON 32
ci_034                 5.108278e-03 3 1  ON 33
ci_035                 1.432525e-03 3 1  ON 34
ci_036                 1.379537e-03 3 1  ON 35
ci_037                 4.789733e-03 3 1  ON 36
ci_038                 5.967066e-03 3 1  ON 37
ci_039                 5.377430e-03 3 1  ON 38
ci_040                 5.492671e-03 3 1  ON 39
ci_041                 5.012800e-03 3 1  ON 40
ci_042                 5.417273e-03 3 1  ON 41
ci_043                 4.708127e-03 3 1  ON 42
ci_044                 4.800787e-03 3 1  ON 43
ci_045                 2.923082e-03 3 1  ON 44
ci_046                 2.671808e-03 3 1  ON 45
ci_047                -7.490045e-04 3 1  ON 46
ci_048                -8.533600e-04 3 1  ON 47
ci_049                 8.034569e-04 3 1  ON 48
ci_050                 1.484007e-03 3 1  ON 49
ci_051                -2.273677e-03 3 1  ON 50
ci_052                -1.439408e-03 3 1  ON 51
ci_053                -2.273215e-03 3 1  ON 52
ci_054                -3.102957e-03 3 1  ON 53
ci_055                -1.332087e-03 3 1  ON 54
ci_056                -1.252093e-03 3 1  ON 55
ci_057                -1.691004e-03 3 1  ON 56
ci_058                -1.693825e-03 3 1  ON 57
ci_059                 1.423340e-05 3 1  ON 58
ci_060                 2.983394e-04 3 1  ON 59
ci_061                -5.126683e-04 3 1  ON 60
ci_062                -2.554252e-05 3 1  ON 61
ci_063                 1.702558e-04 3 1  ON 62
ci_064                 6.894866e-04 3 1  ON 63
ci_065                -2.724424e-03 3 1  ON 64
ci_066                -1.993648e-03 3 1  ON 65
ci_067                -3.233512e-03 3 1  ON 66
ci_068                -2.406986e-03 3 1  ON 67
ci_069                -3.223159e-04 3 1  ON 68
ci_070                -2.187190e-05 3 1  ON 69
ci_071                -2.256373e-03 3 1  ON 70
ci_072                -2.516770e-03 3 1  ON 71
ci_073                 1.790030e-04 3 1  ON 72
ci_074                 2.173281e-05 3 1  ON 73
ci_075                -1.627440e-04 3 1  ON 74
ci_076                -2.105105e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 19
    time step          = 0.05
    reference energy   = -22.6478
    reference variance = 0.546948
====================================================
  Execution time = 2.5330e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORMN2JWARM.s019
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2669e+01
  VMC Evar = 4.9782e-01
  Total weights = 1.9548e+06
  Execution time = 3.6493e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.485149804011
                                         uncertainty =       0.003604803721

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.485149804011
                                         uncertainty =       0.003604803721

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000492438886
  error estimate for blocks of size 2^( 2) =       0.000511168480
  error estimate for blocks of size 2^( 3) =       0.000527782478
  error estimate for blocks of size 2^( 4) =       0.000539734891
  error estimate for blocks of size 2^( 5) =       0.000547656699
  error estimate for blocks of size 2^( 6) =       0.000553410383
  error estimate for blocks of size 2^( 7) =       0.000558316272

      target function =                  N/A
              le_mean =     -22.669186496812
             les_mean =     514.389763138467
             stat err =       0.000549779561
             autocorr =       1.246443223185
              std dev =       0.696413751263
             le_variance =       0.484992112948

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.485109977654
                                         uncertainty =       0.003586760662

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.485109977654
                                         uncertainty =       0.003586760662

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000492418722
  error estimate for blocks of size 2^( 2) =       0.000511149102
  error estimate for blocks of size 2^( 3) =       0.000527761848
  error estimate for blocks of size 2^( 4) =       0.000539715301
  error estimate for blocks of size 2^( 5) =       0.000547640997
  error estimate for blocks of size 2^( 6) =       0.000553391515
  error estimate for blocks of size 2^( 7) =       0.000558296932

      target function =                  N/A
              le_mean =     -22.669182976211
             les_mean =     514.389950605765
             stat err =       0.000549761186
             autocorr =       1.246461978552
              std dev =       0.696385235585
             le_variance =       0.484952396341

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.485121547019
                                         uncertainty =       0.003594861232

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.485121547019
                                         uncertainty =       0.003594861232

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000492424574
  error estimate for blocks of size 2^( 2) =       0.000511154604
  error estimate for blocks of size 2^( 3) =       0.000527767851
  error estimate for blocks of size 2^( 4) =       0.000539720344
  error estimate for blocks of size 2^( 5) =       0.000547644306
  error estimate for blocks of size 2^( 6) =       0.000553395041
  error estimate for blocks of size 2^( 7) =       0.000558302013

      target function =                  N/A
              le_mean =     -22.669182741076
             les_mean =     514.391363831874
             stat err =       0.000549765426
             autocorr =       1.246451579542
              std dev =       0.696393510895
             le_variance =       0.484963922017

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.485144598778
                                         uncertainty =       0.003603501544

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.485144598778
                                         uncertainty =       0.003603501544

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000492436248
  error estimate for blocks of size 2^( 2) =       0.000511165948
  error estimate for blocks of size 2^( 3) =       0.000527779852
  error estimate for blocks of size 2^( 4) =       0.000539732348
  error estimate for blocks of size 2^( 5) =       0.000547654567
  error estimate for blocks of size 2^( 6) =       0.000553407907
  error estimate for blocks of size 2^( 7) =       0.000558313879

      target function =                  N/A
              le_mean =     -22.669185880891
             les_mean =     514.389743522391
             stat err =       0.000549777175
             autocorr =       1.246445757176
              std dev =       0.696410020981
             le_variance =       0.484986917322


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.669186496812        initial  <--
     5.9605e-01     5.9605e+00             6.9448e-04       -22.669182976211
     2.3842e+00     2.3842e+01             2.0304e-04       -22.669182741076
     9.5367e+00     9.5367e+01             5.3013e-05       -22.669185880891

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 45.5076
  </log>
  <optVariables href="FORMN2JWARM.s019.opt.xml">
ci_001                -7.066161e-01 3 1  ON 0
ci_002                -7.036421e-01 3 1  ON 1
ci_003                -4.240094e-02 3 1  ON 2
ci_004                -4.263149e-02 3 1  ON 3
ci_005                 1.712097e-02 3 1  ON 4
ci_006                 1.719038e-02 3 1  ON 5
ci_007                 1.335380e-02 3 1  ON 6
ci_008                 1.382559e-02 3 1  ON 7
ci_009                -1.176538e-02 3 1  ON 8
ci_010                -1.189472e-02 3 1  ON 9
ci_011                -8.600248e-03 3 1  ON 10
ci_012                -8.307798e-03 3 1  ON 11
ci_013                 9.271033e-03 3 1  ON 12
ci_014                 9.921251e-03 3 1  ON 13
ci_015                 1.272580e-02 3 1  ON 14
ci_016                 1.302155e-02 3 1  ON 15
ci_017                 1.107283e-02 3 1  ON 16
ci_018                 1.157103e-02 3 1  ON 17
ci_019                -3.262700e-04 3 1  ON 18
ci_020                 1.401210e-04 3 1  ON 19
ci_021                -6.713319e-03 3 1  ON 20
ci_022                -7.351538e-03 3 1  ON 21
ci_023                 7.229709e-03 3 1  ON 22
ci_024                 8.278813e-03 3 1  ON 23
ci_025                 4.172715e-03 3 1  ON 24
ci_026                 3.308534e-03 3 1  ON 25
ci_027                 7.333079e-03 3 1  ON 26
ci_028                 6.759256e-03 3 1  ON 27
ci_029                -5.321239e-03 3 1  ON 28
ci_030                -4.571329e-03 3 1  ON 29
ci_031                -8.522890e-03 3 1  ON 30
ci_032                -8.592847e-03 3 1  ON 31
ci_033                 4.293522e-03 3 1  ON 32
ci_034                 5.030309e-03 3 1  ON 33
ci_035                 1.410812e-03 3 1  ON 34
ci_036                 1.443583e-03 3 1  ON 35
ci_037                 4.786254e-03 3 1  ON 36
ci_038                 6.024379e-03 3 1  ON 37
ci_039                 5.288633e-03 3 1  ON 38
ci_040                 5.518444e-03 3 1  ON 39
ci_041                 5.005718e-03 3 1  ON 40
ci_042                 5.376840e-03 3 1  ON 41
ci_043                 4.759954e-03 3 1  ON 42
ci_044                 4.900054e-03 3 1  ON 43
ci_045                 2.933133e-03 3 1  ON 44
ci_046                 2.623975e-03 3 1  ON 45
ci_047                -7.451740e-04 3 1  ON 46
ci_048                -8.498817e-04 3 1  ON 47
ci_049                 8.911193e-04 3 1  ON 48
ci_050                 1.434322e-03 3 1  ON 49
ci_051                -2.251437e-03 3 1  ON 50
ci_052                -1.459801e-03 3 1  ON 51
ci_053                -2.301155e-03 3 1  ON 52
ci_054                -3.063744e-03 3 1  ON 53
ci_055                -1.290362e-03 3 1  ON 54
ci_056                -1.171303e-03 3 1  ON 55
ci_057                -1.594111e-03 3 1  ON 56
ci_058                -1.565446e-03 3 1  ON 57
ci_059                 3.218195e-05 3 1  ON 58
ci_060                 2.667332e-04 3 1  ON 59
ci_061                -4.949394e-04 3 1  ON 60
ci_062                 9.547891e-06 3 1  ON 61
ci_063                 1.330117e-04 3 1  ON 62
ci_064                 8.925282e-04 3 1  ON 63
ci_065                -2.691935e-03 3 1  ON 64
ci_066                -1.982344e-03 3 1  ON 65
ci_067                -3.276714e-03 3 1  ON 66
ci_068                -2.385774e-03 3 1  ON 67
ci_069                -3.422264e-04 3 1  ON 68
ci_070                 2.220756e-05 3 1  ON 69
ci_071                -2.245099e-03 3 1  ON 70
ci_072                -2.396882e-03 3 1  ON 71
ci_073                 1.313959e-04 3 1  ON 72
ci_074                -5.597884e-05 3 1  ON 73
ci_075                -1.235235e-04 3 1  ON 74
ci_076                -1.865965e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.6291e+01 secs
  Total Execution time = 1.5009e+03 secs

=========================================================
  A new xml input file : FORMN2JWARM.s019.cont.xml
