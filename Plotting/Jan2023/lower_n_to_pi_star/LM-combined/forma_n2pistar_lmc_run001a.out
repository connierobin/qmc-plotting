Rank =    0  Free Memory = 85942 MB
Rank =    1  Free Memory = 85942 MB
Rank =    2  Free Memory = 85942 MB
Rank =    3  Free Memory = 85942 MB
Rank =    4  Free Memory = 85942 MB
Rank =    5  Free Memory = 85942 MB
Rank =    6  Free Memory = 85941 MB
Rank =    7  Free Memory = 85941 MB
Rank =    8  Free Memory = 85941 MB
Rank =    9  Free Memory = 85941 MB
Rank =   10  Free Memory = 85941 MB
Rank =   11  Free Memory = 85941 MB
Rank =   12  Free Memory = 85941 MB
Rank =   13  Free Memory = 85940 MB
Rank =   14  Free Memory = 85939 MB
Rank =   15  Free Memory = 85925 MB
Rank =   16  Free Memory = 85925 MB
Rank =   17  Free Memory = 85925 MB
Rank =   18  Free Memory = 85925 MB
Rank =   19  Free Memory = 85925 MB
Rank =   20  Free Memory = 85925 MB
Rank =   21  Free Memory = 85925 MB
Rank =   22  Free Memory = 85925 MB
Rank =   23  Free Memory = 85925 MB
Rank =   24  Free Memory = 85925 MB
Rank =   25  Free Memory = 85925 MB
Rank =   26  Free Memory = 85925 MB
Rank =   27  Free Memory = 85925 MB
Rank =   28  Free Memory = 85925 MB
Rank =   29  Free Memory = 85925 MB
Rank =   30  Free Memory = 85925 MB
Rank =   31  Free Memory = 85925 MB
Rank =   32  Free Memory = 80001 MB
Rank =   33  Free Memory = 80001 MB
Rank =   34  Free Memory = 80001 MB
Rank =   35  Free Memory = 80001 MB
Rank =   36  Free Memory = 80001 MB
Rank =   37  Free Memory = 80001 MB
Rank =   38  Free Memory = 80001 MB
Rank =   39  Free Memory = 80001 MB
Rank =   40  Free Memory = 80001 MB
Rank =   41  Free Memory = 80001 MB
Rank =   42  Free Memory = 80001 MB
Rank =   43  Free Memory = 80001 MB
Rank =   44  Free Memory = 80001 MB
Rank =   45  Free Memory = 80001 MB
Rank =   46  Free Memory = 80001 MB
Rank =   47  Free Memory = 80001 MB
Rank =   48  Free Memory = 80001 MB
Rank =   49  Free Memory = 80001 MB
Rank =   50  Free Memory = 80000 MB
Rank =   51  Free Memory = 80000 MB
Rank =   52  Free Memory = 80000 MB
Rank =   53  Free Memory = 80000 MB
Rank =   54  Free Memory = 80000 MB
Rank =   55  Free Memory = 80000 MB
Rank =   56  Free Memory = 80000 MB
Rank =   57  Free Memory = 80000 MB
Rank =   58  Free Memory = 80000 MB
Rank =   59  Free Memory = 80000 MB
Rank =   60  Free Memory = 80000 MB
Rank =   61  Free Memory = 80000 MB
Rank =   62  Free Memory = 80000 MB
Rank =   63  Free Memory = 80000 MB
Rank =   64  Free Memory = 89190 MB
Rank =   65  Free Memory = 89190 MB
Rank =   66  Free Memory = 89190 MB
Rank =   67  Free Memory = 89190 MB
Rank =   68  Free Memory = 89190 MB
Rank =   69  Free Memory = 89190 MB
Rank =   70  Free Memory = 89190 MB
Rank =   71  Free Memory = 89190 MB
Rank =   72  Free Memory = 89190 MB
Rank =   73  Free Memory = 89190 MB
Rank =   74  Free Memory = 89190 MB
Rank =   75  Free Memory = 89190 MB
Rank =   76  Free Memory = 89190 MB
Rank =   77  Free Memory = 89190 MB
Rank =   78  Free Memory = 89190 MB
Rank =   79  Free Memory = 89190 MB
Rank =   80  Free Memory = 89190 MB
Rank =   81  Free Memory = 89190 MB
Rank =   82  Free Memory = 89190 MB
Rank =   83  Free Memory = 89190 MB
Rank =   84  Free Memory = 89190 MB
Rank =   85  Free Memory = 89190 MB
Rank =   86  Free Memory = 89190 MB
Rank =   87  Free Memory = 89190 MB
Rank =   88  Free Memory = 89190 MB
Rank =   89  Free Memory = 89190 MB
Rank =   90  Free Memory = 89190 MB
Rank =   91  Free Memory = 89190 MB
Rank =   92  Free Memory = 89190 MB
Rank =   93  Free Memory = 89190 MB
Rank =   94  Free Memory = 89190 MB
Rank =   95  Free Memory = 89190 MB
Rank =   96  Free Memory = 89188 MB
Rank =   97  Free Memory = 89188 MB
Rank =   98  Free Memory = 89188 MB
Rank =   99  Free Memory = 89188 MB
Rank =  100  Free Memory = 89188 MB
Rank =  101  Free Memory = 89188 MB
Rank =  102  Free Memory = 89188 MB
Rank =  103  Free Memory = 89188 MB
Rank =  104  Free Memory = 89188 MB
Rank =  105  Free Memory = 89188 MB
Rank =  106  Free Memory = 89188 MB
Rank =  107  Free Memory = 89188 MB
Rank =  108  Free Memory = 89188 MB
Rank =  109  Free Memory = 89188 MB
Rank =  110  Free Memory = 89188 MB
Rank =  111  Free Memory = 89188 MB
Rank =  112  Free Memory = 89188 MB
Rank =  113  Free Memory = 89188 MB
Rank =  114  Free Memory = 89188 MB
Rank =  115  Free Memory = 89188 MB
Rank =  116  Free Memory = 89188 MB
Rank =  117  Free Memory = 89188 MB
Rank =  118  Free Memory = 89188 MB
Rank =  119  Free Memory = 89188 MB
Rank =  120  Free Memory = 89188 MB
Rank =  121  Free Memory = 89188 MB
Rank =  122  Free Memory = 89188 MB
Rank =  123  Free Memory = 89188 MB
Rank =  124  Free Memory = 89188 MB
Rank =  125  Free Memory = 89188 MB
Rank =  126  Free Memory = 89188 MB
Rank =  127  Free Memory = 89188 MB
  Input file(s): opt_form_n2pistar_lmc_run001a.xml 

=====================================================
                    QMCPACK 3.7.9

       (c) Copyright 2003-  QMCPACK developers

                    Please cite:
 J. Kim et al. J. Phys. Cond. Mat. 30 195901 (2018)
      https://doi.org/10.1088/1361-648X/aab9c3

  Git branch: gvp
  Last git commit: 02b8462cd86e2c45b012131e3a811aee79855b67-dirty
  Last git commit date: Mon Oct 24 16:30:05 2022 -0700
  Last git commit subject: Merge commit 59872d0bcea460ceb08aa7832e89b700ee19b55f into gvp
=====================================================
  Global options 

  Total number of MPI ranks = 128
  Number of MPI groups      = 1
  MPI group ID              = 0
  Number of ranks in group  = 128
  MPI ranks per node        = 32
  OMP 1st level threads     = 1
  OMP nested threading disabled or only 1 thread on the 2nd level

  Precision used in this calculation, see definitions in the manual:
  Base precision      = double
  Full precision      = double

  Structure-of-arrays (SoA) optimization enabled

  Input XML = opt_form_n2pistar_lmc_run001a.xml

  Project = FORMN2LMC
  date    = 2023-02-06 13:39:26 PST
  host    = n0012.savio3

 Random Number
 -------------
  Offset for the random number seeds based on time: 910

  Range of prime numbers to use as seeds over processors and threads = 7121-8291


 Particle Set 
 ------------
  Name: e
  All the species have the same mass 1
  Particle set size: 12

 Particle Set 
 ------------
  Name: ion0
  All the species have the same mass 1
  Particle set size: 4

 Wavefunction setup: 
 ------------------- 
  Name: psi0

   Jastrow
   -------
    Name: J2   Type: Two-Body   Function: Bspline

    Radial function for species: u - u
     Number of parameters: 10
     Cusp: -0.25
     Cutoff radius: 10

     Name                        Value Type Recompute Use Index
     ---- ---------------------------- ---- --------- --- -----
     uu_0                 2.949409e-01    1         1 OFF
     uu_1                 1.195613e-01    1         1 OFF
     uu_2                 6.101406e-03    1         1 OFF
     uu_3                -6.065052e-02    1         1 OFF
     uu_4                -1.006773e-01    1         1 OFF
     uu_5                -1.263386e-01    1         1 OFF
     uu_6                -1.424870e-01    1         1 OFF
     uu_7                -1.474970e-01    1         1 OFF
     uu_8                -1.439685e-01    1         1 OFF
     uu_9                -1.245737e-01    1         1 OFF

    Radial function for species: u - d
     Number of parameters: 10
     Cusp: -5.000000e-01
     Cutoff radius: 1.000000e+01

     Name                        Value Type Recompute Use Index
     ---- ---------------------------- ---- --------- --- -----
     ud_0                 3.892816e-01    1         1 OFF
     ud_1                 1.116049e-01    1         1 OFF
     ud_2                -2.827929e-02    1         1 OFF
     ud_3                -1.008992e-01    1         1 OFF
     ud_4                -1.393727e-01    1         1 OFF
     ud_5                -1.605036e-01    1         1 OFF
     ud_6                -1.695725e-01    1         1 OFF
     ud_7                -1.679012e-01    1         1 OFF
     ud_8                -1.529607e-01    1         1 OFF
     ud_9                -1.271010e-01    1         1 OFF


   Jastrow
   -------
    Name: J1   Type: One-Body   Function: Bspline

    Radial function for element: C
     Number of parameters: 10
     Cusp: 0.000000e+00
     Cutoff radius: 1.000000e+01

     Name                        Value Type Recompute Use Index
     ---- ---------------------------- ---- --------- --- -----
     eC_0                -5.549610e-01    1         1 OFF
     eC_1                -4.097799e-01    1         1 OFF
     eC_2                -1.687963e-01    1         1 OFF
     eC_3                -2.272894e-02    1         1 OFF
     eC_4                 4.861398e-02    1         1 OFF
     eC_5                 1.388351e-01    1         1 OFF
     eC_6                 2.384813e-01    1         1 OFF
     eC_7                 3.809007e-01    1         1 OFF
     eC_8                 2.683911e-01    1         1 OFF
     eC_9                 7.455279e-02    1         1 OFF

    Radial function for element: O
     Number of parameters: 10
     Cusp: 0.000000e+00
     Cutoff radius: 1.000000e+01

     Name                        Value Type Recompute Use Index
     ---- ---------------------------- ---- --------- --- -----
     eO_0                -1.151913e+00    1         1 OFF
     eO_1                -7.856470e-01    1         1 OFF
     eO_2                -3.291222e-01    1         1 OFF
     eO_3                 1.643085e-03    1         1 OFF
     eO_4                 2.151175e-01    1         1 OFF
     eO_5                 3.696682e-01    1         1 OFF
     eO_6                 4.085243e-01    1         1 OFF
     eO_7                 4.138030e-01    1         1 OFF
     eO_8                 4.299012e-01    1         1 OFF
     eO_9                 3.006370e-01    1         1 OFF

    Radial function for element: H1
     Number of parameters: 10
     Cusp: 0.000000e+00
     Cutoff radius: 1.000000e+01

      Name                        Value Type Recompute Use Index
     ----- ---------------------------- ---- --------- --- -----
     eH1_0                -1.976343e-01    1         1 OFF
     eH1_1                -1.082406e-01    1         1 OFF
     eH1_2                -7.189495e-02    1         1 OFF
     eH1_3                -5.559476e-02    1         1 OFF
     eH1_4                 1.189862e-02    1         1 OFF
     eH1_5                 5.684541e-02    1         1 OFF
     eH1_6                 8.802783e-02    1         1 OFF
     eH1_7                 6.288523e-02    1         1 OFF
     eH1_8                -2.109080e-02    1         1 OFF
     eH1_9                 7.073231e-02    1         1 OFF

    Radial function for element: H2
     Number of parameters: 10
     Cusp: 0.000000e+00
     Cutoff radius: 1.000000e+01

      Name                        Value Type Recompute Use Index
     ----- ---------------------------- ---- --------- --- -----
     eH2_0                -1.948420e-01    1         1 OFF
     eH2_1                -1.038901e-01    1         1 OFF
     eH2_2                -6.810792e-02    1         1 OFF
     eH2_3                -5.190814e-02    1         1 OFF
     eH2_4                 1.566164e-02    1         1 OFF
     eH2_5                 6.037548e-02    1         1 OFF
     eH2_6                 9.231229e-02    1         1 OFF
     eH2_7                 6.881598e-02    1         1 OFF
     eH2_8                -1.143329e-02    1         1 OFF
     eH2_9                 7.068194e-02    1         1 OFF

  Created SPOSet builder named 'LCAOBSet' of type molecularorbital
  LCAO: SoaAtomicBasisSet<MultiQuintic,0>
  AO BasisSet for C
   Angular momentum expanded in cartesian functions x^lx y^ly z^lz according to Gamess
Using log grid with default values: ri = 1.000000e-06 rf = 1.000000e+02 npts = 1001
   R(n,l,m,s) 0 0 0 0
   R(n,l,m,s) 1 0 0 0
   R(n,l,m,s) 2 1 0 0
   R(n,l,m,s) 3 1 0 0
   R(n,l,m,s) 4 2 0 0
Expanding Ylm (angular function) according to Gamess using cartesian gaussians
Adding 1 cartesian gaussian orbitals for l= 0
Adding 1 cartesian gaussian orbitals for l= 0
Adding 3 cartesian gaussian orbitals for l= 1
Adding 3 cartesian gaussian orbitals for l= 1
Adding 6 cartesian gaussian orbitals for l= 2
  Setting cutoff radius 1.270574e+01

   Maximum Angular Momentum  = 2
   Number of Radial functors = 5
   Basis size                = 14

  AO BasisSet for O
   Angular momentum expanded in cartesian functions x^lx y^ly z^lz according to Gamess
Using log grid with default values: ri = 1.000000e-06 rf = 1.000000e+02 npts = 1001
   R(n,l,m,s) 0 0 0 0
   R(n,l,m,s) 1 0 0 0
   R(n,l,m,s) 2 1 0 0
   R(n,l,m,s) 3 1 0 0
   R(n,l,m,s) 4 2 0 0
Expanding Ylm (angular function) according to Gamess using cartesian gaussians
Adding 1 cartesian gaussian orbitals for l= 0
Adding 1 cartesian gaussian orbitals for l= 0
Adding 3 cartesian gaussian orbitals for l= 1
Adding 3 cartesian gaussian orbitals for l= 1
Adding 6 cartesian gaussian orbitals for l= 2
  Setting cutoff radius 1.018591e+01

   Maximum Angular Momentum  = 2
   Number of Radial functors = 5
   Basis size                = 14

  AO BasisSet for H1
   Angular momentum expanded in cartesian functions x^lx y^ly z^lz according to Gamess
Using log grid with default values: ri = 1.000000e-06 rf = 1.000000e+02 npts = 1001
   R(n,l,m,s) 0 0 0 0
   R(n,l,m,s) 1 0 0 0
   R(n,l,m,s) 2 1 0 0
Expanding Ylm (angular function) according to Gamess using cartesian gaussians
Adding 1 cartesian gaussian orbitals for l= 0
Adding 1 cartesian gaussian orbitals for l= 0
Adding 3 cartesian gaussian orbitals for l= 1
  Setting cutoff radius 1.270574e+01

   Maximum Angular Momentum  = 1
   Number of Radial functors = 3
   Basis size                = 5

  AO BasisSet for H2
   Angular momentum expanded in cartesian functions x^lx y^ly z^lz according to Gamess
Using log grid with default values: ri = 1.000000e-06 rf = 1.000000e+02 npts = 1001
   R(n,l,m,s) 0 0 0 0
   R(n,l,m,s) 1 0 0 0
   R(n,l,m,s) 2 1 0 0
Expanding Ylm (angular function) according to Gamess using cartesian gaussians
Adding 1 cartesian gaussian orbitals for l= 0
Adding 1 cartesian gaussian orbitals for l= 0
Adding 3 cartesian gaussian orbitals for l= 1
  Setting cutoff radius 1.270574e+01

   Maximum Angular Momentum  = 1
   Number of Radial functors = 3
   Basis size                = 5

Creating SPOSet in SlaterDetBuilder::put(xmlNodePtr cur).
spo_name = spo-up
  Building SPOSet 'spo-up' with '' basis set.
Creating SPOSet in SlaterDetBuilder::put(xmlNodePtr cur).
spo_name = spo-dn
  Building SPOSet 'spo-dn' with '' basis set.
Using Bryan's algorithm for MultiSlaterDeterminant expansion. 
Creating base determinant (up) for MSD expansion. 
Creating base determinant (down) for MSD expansion. 
Found determinant list. 
Reading CI expansion.
Found 77 terms in the MSD expansion.
Norm of ci vector (sum of ci^2): 9.999735e-01
Norm of qchem ci vector (sum of qchem_ci^2): 0.000000e+00
Found 24 unique up determinants.
Found 24 unique down determinants.
Number of terms in pairs array: 12
Number of terms in pairs array: 12
CI coefficients are optimizable. 
  FermionWF = MultiSlaterDeterminantFast
  QMCHamiltonian::addOperator Kinetic to H, physical Hamiltonian 
  QMCHamiltonian::addOperator ElecElec to H, physical Hamiltonian 
QMCHamiltonian::addOperatorType added type coulomb named ElecElec

  ECPotential builder for pseudopotential 

  Adding pseudopotential for C
   Linear grid  ri=0.000000e+00 rf=1.000000e+01 npts = 10001
    ECPComponentBuilder::buildSemiLocalAndLocal 
    Assuming Hartree unit
   Number of angular momentum channels 2
   Maximum angular momentum channel 1
   Creating a Linear Grid Rmax=1.405000e+00
  Using global grid with delta = 1.000000e-03
   Making L=1 a local potential with a radial cutoff of 9.999000e+00
    Non-local pseudopotential parameters
    Maximum angular mementum = 0
    Number of non-local channels = 1
       l(0)=0
    Cutoff radius = 1.405000e+00
    Spherical grids and weights: 
         1.0000000000e+00  0.0000000000e+00  0.0000000000e+00    8.3333333333e-02
        -1.0000000000e+00  1.2246467991e-16  0.0000000000e+00    8.3333333333e-02
         4.4721359550e-01  8.9442719100e-01  0.0000000000e+00    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -8.9442719100e-01  1.0953573965e-16    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
    Maximum cutoff radius 1.4050000000e+00

  Adding pseudopotential for O
   Linear grid  ri=0.0000000000e+00 rf=1.0000000000e+01 npts = 10001
    ECPComponentBuilder::buildSemiLocalAndLocal 
    Assuming Hartree unit
   Number of angular momentum channels 2
   Maximum angular momentum channel 1
   Creating a Linear Grid Rmax=1.0750000000e+00
  Using global grid with delta = 1.0000000000e-03
   Making L=1 a local potential with a radial cutoff of 9.9990000000e+00
    Non-local pseudopotential parameters
    Maximum angular mementum = 0
    Number of non-local channels = 1
       l(0)=0
    Cutoff radius = 1.0750000000e+00
    Spherical grids and weights: 
         1.0000000000e+00  0.0000000000e+00  0.0000000000e+00    8.3333333333e-02
        -1.0000000000e+00  1.2246467991e-16  0.0000000000e+00    8.3333333333e-02
         4.4721359550e-01  8.9442719100e-01  0.0000000000e+00    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -8.9442719100e-01  1.0953573965e-16    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
    Maximum cutoff radius 1.0750000000e+00

  Adding pseudopotential for H1
   Linear grid  ri=0.0000000000e+00 rf=1.0000000000e+01 npts = 10001
    ECPComponentBuilder::buildSemiLocalAndLocal 
    Assuming Hartree unit
   Number of angular momentum channels 2
   Maximum angular momentum channel 1
   Creating a Linear Grid Rmax=1.0000000000e-10
  Using global grid with delta = 1.0000000000e-03
   Making L=1 a local potential with a radial cutoff of 9.9990000000e+00
    Non-local pseudopotential parameters
    Maximum angular mementum = 0
    Number of non-local channels = 1
       l(0)=0
    Cutoff radius = 1.0000000000e-03
    Spherical grids and weights: 
         1.0000000000e+00  0.0000000000e+00  0.0000000000e+00    8.3333333333e-02
        -1.0000000000e+00  1.2246467991e-16  0.0000000000e+00    8.3333333333e-02
         4.4721359550e-01  8.9442719100e-01  0.0000000000e+00    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -8.9442719100e-01  1.0953573965e-16    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
    Maximum cutoff radius 1.0000000000e-03

  Adding pseudopotential for H2
   Linear grid  ri=0.0000000000e+00 rf=1.0000000000e+01 npts = 10001
    ECPComponentBuilder::buildSemiLocalAndLocal 
    Assuming Hartree unit
   Number of angular momentum channels 2
   Maximum angular momentum channel 1
   Creating a Linear Grid Rmax=1.0000000000e-10
  Using global grid with delta = 1.0000000000e-03
   Making L=1 a local potential with a radial cutoff of 9.9990000000e+00
    Non-local pseudopotential parameters
    Maximum angular mementum = 0
    Number of non-local channels = 1
       l(0)=0
    Cutoff radius = 1.0000000000e-03
    Spherical grids and weights: 
         1.0000000000e+00  0.0000000000e+00  0.0000000000e+00    8.3333333333e-02
        -1.0000000000e+00  1.2246467991e-16  0.0000000000e+00    8.3333333333e-02
         4.4721359550e-01  8.9442719100e-01  0.0000000000e+00    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -8.9442719100e-01  1.0953573965e-16    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
    Maximum cutoff radius 1.0000000000e-03
  QMCHamiltonian::addOperator LocalECP to H, physical Hamiltonian 

  Using NonLocalECP potential 
    Maximum grid on a sphere for NonLocalECPotential: 12
  QMCHamiltonian::addOperator NonLocalECP to H, physical Hamiltonian 
QMCHamiltonian::addOperatorType added type pseudo named NonLocalECP
  QMCHamiltonian::addOperator IonIon to H, physical Hamiltonian 
QMCHamiltonian::addOperatorType added type coulomb named IonIon

  QMCHamiltonian::add2WalkerProperty added
    5 to P::PropertyList 
    0 to P::Collectables 
    starting Index of the observables in P::PropertyList = 10
ParticleSetPool::randomize 
  Initialization Execution time = 2.7278e-01 secs
=========================================================
 Summary of QMC systems 
=========================================================
ParticleSetPool has: 

  ParticleSet 'e' contains 12 particles :  u(6) d(6)

    u -1.8061669018e+00  2.7837752017e-01 -8.9374600273e-01
    u  6.2204767277e-01 -3.1767951129e-01 -1.6068917470e+00
    u  2.7844543642e-02 -4.6711695757e-01  1.3769739340e+00
    u  5.3613352983e-01 -1.0346031641e-01  1.1931174682e+00
    u  6.6915801034e-01  1.1573235719e+00  1.2719505344e+00
    u  1.8470266426e-02  1.4117662795e+00 -1.6695285925e+00
    d -9.6293909260e-01  1.0337145637e+00 -8.9962839053e-01
    d  1.0744417758e+00  1.1605479134e+00 -1.8930392030e+00
    d  1.2380477230e+00  4.9285421082e-01  8.7082227944e-01
    d  8.1730014770e-01 -3.7289888410e-01  2.8378529985e+00
    (... and 2 more particle positions ...)

  Distance table for similar particles (A-A):
    source/target: e
    Using structure-of-arrays (SoA) data layout
    Distance computations use open boundary conditions in 3D.

  Distance table for dissimilar particles (A-B):
    source: ion0  target: e
    Using structure-of-arrays (SoA) data layout
    Distance computations use open boundary conditions in 3D.


  ParticleSet 'ion0' contains 4 particles :  C(1) O(1) H1(1) H2(1)

    C  0.0000000000e+00  0.0000000000e+00 -1.1394765782e+00
    O  0.0000000000e+00  0.0000000000e+00  1.1440287480e+00
    H1  0.0000000000e+00  1.7662761033e+00 -2.2339863698e+00
    H2  0.0000000000e+00 -1.7662761033e+00 -2.2339863698e+00

  Distance table for similar particles (A-A):
    source/target: ion0
    Using structure-of-arrays (SoA) data layout
    Distance computations use open boundary conditions in 3D.


  Hamiltonian h0
  Kinetic         Kinetic energy
  ElecElec        CoulombAA source/target e

  LocalECP        LocalECPotential: ion0
  NonLocalECP     NonLocalECPotential: ion0
  IonIon          CoulombAA source/target ion0


Loop execution max-interations = 20
Inside LM engine constructor, num_params is: 0 and _total_num_params is: 0

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORMN2LMC.s000 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15
  Adding 1 walkers to 0 existing sets
  Total number of walkers: 1.2800000000e+02
  Total weight: 1.2800000000e+02

=========================================================
  Start VMC
  File Root FORMN2LMC.s000 append = no 
=========================================================
Resetting walkers
  Using the current 1 walkers.
  Total number of walkers: 1.2800000000e+02
  Total weight: 1.2800000000e+02
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=0  my_counter=0
  time step      = 5.0000000000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000000000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625000000e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000000000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000000000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000000000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000000000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000000000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000000000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000000000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625000000e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000000000e-02</parameter>
<parameter name="time_step" condition="au">5.0000000000e-02</parameter>
<parameter name="timestep" condition="au">5.0000000000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
  Set drift_modifier UNR parameter a = 1.0000000000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000000000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: 0 and ratio_threshold_: 0.0000000000e+00
Allocating full size _hmat_temp and _smat_temp
Inside LM engine's get_param, num_params is: 76
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 0
    time step          = 0.05
    reference energy   = -22.7825
    reference variance = 1.19929
====================================================
  Execution time = 2.6880e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORMN2LMC.s000
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5273e+04
  VMC Eavg = -2.2661e+01
  VMC Evar = 5.2878e-01
  Total weights = 1.954736993e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.7892e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.511227755944
                                         uncertainty =       0.002673271722

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.511227755944
                                         uncertainty =       0.002673271722

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000505660691
  error estimate for blocks of size 2^( 2) =       0.000524357140
  error estimate for blocks of size 2^( 3) =       0.000542274561
  error estimate for blocks of size 2^( 4) =       0.000554104199
  error estimate for blocks of size 2^( 5) =       0.000561616514
  error estimate for blocks of size 2^( 6) =       0.000565170630
  error estimate for blocks of size 2^( 7) =       0.000565998724

      target function =                  N/A
              le_mean =     -22.660732079636
             les_mean =     514.037560144136
             stat err =       0.000561722517
             autocorr =       1.234028752473
              std dev =       0.715112206971
             le_variance =       0.511385468559


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy-2.266073207964e+01 
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.5000e-01, overlap shift 2.5000e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.660732079768       residual = 1.51e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.664008702336       residual = 4.16e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.664110022747       residual = 6.88e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.664112999008       residual = 2.10e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.664113024701       residual = 5.70e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          4 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 2.5000e-01 is 1.426961e-02

solving harmonic davidson linear method for identity shift 1.0000e+00, overlap shift 1.0000e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.660732079768       residual = 1.51e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.661995610911       residual = 2.64e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.662019732450       residual = 1.37e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.662019995413       residual = 1.93e-08           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.662020019541       residual = 7.06e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          4 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 1.0000e+00 is 5.686938e-03

solving harmonic davidson linear method for identity shift 4.0000e+00, overlap shift 4.0000e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.660732079768       residual = 1.51e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.661097468613       residual = 2.32e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.661103588430       residual = 2.82e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.661103663987       residual = 2.59e-08           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.661103667515       residual = 8.00e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          4 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 4.0000e+00 is 1.669286e-03

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.100424 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.1779e+01
  </log>
  <optVariables href="FORMN2LMC.s000.opt.xml">
ci_001 -7.008567e-01                3 1 ON  0
ci_002 -7.009768e-01                3 1 ON  1
ci_003 -6.067867e-02                3 1 ON  2
ci_004 -6.082002e-02                3 1 ON  3
ci_005 3.976169e-02                 3 1 ON  4
ci_006 3.974676e-02                 3 1 ON  5
ci_007 2.910398e-02                 3 1 ON  6
ci_008 2.906079e-02                 3 1 ON  7
ci_009 -2.285624e-02                3 1 ON  8
ci_010 -2.291978e-02                3 1 ON  9
ci_011 -2.073946e-02                3 1 ON  10
ci_012 -2.078499e-02                3 1 ON  11
ci_013 1.872414e-02                 3 1 ON  12
ci_014 1.863550e-02                 3 1 ON  13
ci_015 1.919634e-02                 3 1 ON  14
ci_016 1.909809e-02                 3 1 ON  15
ci_017 1.479581e-02                 3 1 ON  16
ci_018 1.478192e-02                 3 1 ON  17
ci_019 9.256128e-03                 3 1 ON  18
ci_020 8.916896e-03                 3 1 ON  19
ci_021 -9.545428e-03                3 1 ON  20
ci_022 -9.610434e-03                3 1 ON  21
ci_023 8.564676e-03                 3 1 ON  22
ci_024 8.714935e-03                 3 1 ON  23
ci_025 7.308241e-03                 3 1 ON  24
ci_026 7.136323e-03                 3 1 ON  25
ci_027 7.349017e-03                 3 1 ON  26
ci_028 7.400753e-03                 3 1 ON  27
ci_029 -7.712672e-03                3 1 ON  28
ci_030 -7.402148e-03                3 1 ON  29
ci_031 -7.626995e-03                3 1 ON  30
ci_032 -7.661919e-03                3 1 ON  31
ci_033 6.612412e-03                 3 1 ON  32
ci_034 6.745365e-03                 3 1 ON  33
ci_035 5.607110e-03                 3 1 ON  34
ci_036 5.673554e-03                 3 1 ON  35
ci_037 6.520588e-03                 3 1 ON  36
ci_038 6.600041e-03                 3 1 ON  37
ci_039 5.296706e-03                 3 1 ON  38
ci_040 5.571213e-03                 3 1 ON  39
ci_041 5.273760e-03                 3 1 ON  40
ci_042 4.905468e-03                 3 1 ON  41
ci_043 5.375677e-03                 3 1 ON  42
ci_044 5.344106e-03                 3 1 ON  43
ci_045 4.464751e-03                 3 1 ON  44
ci_046 4.522205e-03                 3 1 ON  45
ci_047 -3.502674e-03                3 1 ON  46
ci_048 -3.713699e-03                3 1 ON  47
ci_049 3.004095e-03                 3 1 ON  48
ci_050 2.960960e-03                 3 1 ON  49
ci_051 -3.223853e-03                3 1 ON  50
ci_052 -3.097944e-03                3 1 ON  51
ci_053 -2.630593e-03                3 1 ON  52
ci_054 -2.371108e-03                3 1 ON  53
ci_055 -1.936545e-03                3 1 ON  54
ci_056 -2.047575e-03                3 1 ON  55
ci_057 -1.625402e-03                3 1 ON  56
ci_058 -2.003874e-03                3 1 ON  57
ci_059 -1.493923e-03                3 1 ON  58
ci_060 -1.231805e-03                3 1 ON  59
ci_061 -1.465024e-03                3 1 ON  60
ci_062 -1.298752e-03                3 1 ON  61
ci_063 -1.260589e-03                3 1 ON  62
ci_064 -1.350148e-03                3 1 ON  63
ci_065 -1.400506e-03                3 1 ON  64
ci_066 -1.507559e-03                3 1 ON  65
ci_067 -1.407811e-03                3 1 ON  66
ci_068 -1.477865e-03                3 1 ON  67
ci_069 9.439830e-04                 3 1 ON  68
ci_070 1.015464e-03                 3 1 ON  69
ci_071 -1.510282e-03                3 1 ON  70
ci_072 -1.267550e-03                3 1 ON  71
ci_073 9.429549e-04                 3 1 ON  72
ci_074 1.079099e-03                 3 1 ON  73
ci_075 -1.019349e-03                3 1 ON  74
ci_076 -7.509277e-04                3 1 ON  75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 0
    time step          = 0.05
    reference energy   = -22.6714
    reference variance = 0.719467
====================================================
  Execution time = 2.6005e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORMN2LMC.s000
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2664e+01
  VMC Evar = 5.1503e-01
  Total weights = 1.9547e+06
  Execution time = 3.6671e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.626456461710
                                         uncertainty =       0.114824546636

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.626456461710
                                         uncertainty =       0.114824546636

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000559656608
  error estimate for blocks of size 2^( 2) =       0.000576597759
  error estimate for blocks of size 2^( 3) =       0.000592284623
  error estimate for blocks of size 2^( 4) =       0.000603343239
  error estimate for blocks of size 2^( 5) =       0.000608892673
  error estimate for blocks of size 2^( 6) =       0.000612816687
  error estimate for blocks of size 2^( 7) =       0.000616861988

      target function =                  N/A
              le_mean =     -22.664081488628
             les_mean =     519.085533244347
             stat err =       0.000610478647
             autocorr =       1.189864984589
              std dev =       0.791473964992
             le_variance =       0.626431037260

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.496959503003
                                         uncertainty =       0.003387563113

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.496959503003
                                         uncertainty =       0.003387563113

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000498477966
  error estimate for blocks of size 2^( 2) =       0.000516542142
  error estimate for blocks of size 2^( 3) =       0.000532818589
  error estimate for blocks of size 2^( 4) =       0.000544473630
  error estimate for blocks of size 2^( 5) =       0.000550646066
  error estimate for blocks of size 2^( 6) =       0.000553718438
  error estimate for blocks of size 2^( 7) =       0.000556868674

      target function =                  N/A
              le_mean =     -22.664293829964
             les_mean =     514.241357570350
             stat err =       0.000551426702
             autocorr =       1.223724491549
              std dev =       0.704954300337
             le_variance =       0.496960565563

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.538043118644
                                         uncertainty =       0.037292811894

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.538043118644
                                         uncertainty =       0.037292811894

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000518686391
  error estimate for blocks of size 2^( 2) =       0.000536185647
  error estimate for blocks of size 2^( 3) =       0.000551992684
  error estimate for blocks of size 2^( 4) =       0.000563546110
  error estimate for blocks of size 2^( 5) =       0.000569056352
  error estimate for blocks of size 2^( 6) =       0.000571790758
  error estimate for blocks of size 2^( 7) =       0.000574622222

      target function =                  N/A
              le_mean =     -22.664009460207
             les_mean =     515.726266809581
             stat err =       0.000569753861
             autocorr =       1.206604238511
              std dev =       0.733533328829
             le_variance =       0.538071144504

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.507786964010
                                         uncertainty =       0.002968517549

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.507786964010
                                         uncertainty =       0.002968517549

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000503877665
  error estimate for blocks of size 2^( 2) =       0.000522570278
  error estimate for blocks of size 2^( 3) =       0.000539361774
  error estimate for blocks of size 2^( 4) =       0.000551527260
  error estimate for blocks of size 2^( 5) =       0.000558157717
  error estimate for blocks of size 2^( 6) =       0.000561541050
  error estimate for blocks of size 2^( 7) =       0.000564958097

      target function =                  N/A
              le_mean =     -22.663709345190
             les_mean =     514.189647574445
             stat err =       0.000559046031
             autocorr =       1.230962778129
              std dev =       0.712590627210
             le_variance =       0.507785401988


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.664081488628        initial
     2.5000e-01     2.5000e+00             1.4270e-02       -22.664293829964  <--
     1.0000e+00     1.0000e+01             5.6869e-03       -22.664009460207
     4.0000e+00     4.0000e+01             1.6693e-03       -22.663709345190

*****************************************************************************
Applying the update for shift_i =   2.5000e-01     and shift_s =   2.5000e+00
*****************************************************************************

  Execution time = 4.7607e+01
  </log>
  <optVariables href="FORMN2LMC.s000.opt.xml">
ci_001                -7.022221e-01 3 1  ON 0
ci_002                -7.026924e-01 3 1  ON 1
ci_003                -5.752329e-02 3 1  ON 2
ci_004                -5.799701e-02 3 1  ON 3
ci_005                 3.116564e-02 3 1  ON 4
ci_006                 3.116409e-02 3 1  ON 5
ci_007                 2.426797e-02 3 1  ON 6
ci_008                 2.409829e-02 3 1  ON 7
ci_009                -1.932634e-02 3 1  ON 8
ci_010                -1.949579e-02 3 1  ON 9
ci_011                -1.747119e-02 3 1  ON 10
ci_012                -1.762534e-02 3 1  ON 11
ci_013                 1.595785e-02 3 1  ON 12
ci_014                 1.567639e-02 3 1  ON 13
ci_015                 1.773838e-02 3 1  ON 14
ci_016                 1.739769e-02 3 1  ON 15
ci_017                 1.341257e-02 3 1  ON 16
ci_018                 1.335676e-02 3 1  ON 17
ci_019                 7.464967e-03 3 1  ON 18
ci_020                 6.457797e-03 3 1  ON 19
ci_021                -8.906172e-03 3 1  ON 20
ci_022                -9.084941e-03 3 1  ON 21
ci_023                 8.389100e-03 3 1  ON 22
ci_024                 8.807819e-03 3 1  ON 23
ci_025                 6.285199e-03 3 1  ON 24
ci_026                 5.818911e-03 3 1  ON 25
ci_027                 6.666537e-03 3 1  ON 26
ci_028                 6.757607e-03 3 1  ON 27
ci_029                -7.240664e-03 3 1  ON 28
ci_030                -6.327812e-03 3 1  ON 29
ci_031                -7.582966e-03 3 1  ON 30
ci_032                -7.679778e-03 3 1  ON 31
ci_033                 5.992499e-03 3 1  ON 32
ci_034                 6.361086e-03 3 1  ON 33
ci_035                 4.113941e-03 3 1  ON 34
ci_036                 4.284791e-03 3 1  ON 35
ci_037                 6.230973e-03 3 1  ON 36
ci_038                 6.428519e-03 3 1  ON 37
ci_039                 4.923480e-03 3 1  ON 38
ci_040                 5.584187e-03 3 1  ON 39
ci_041                 5.647291e-03 3 1  ON 40
ci_042                 4.695303e-03 3 1  ON 41
ci_043                 5.804612e-03 3 1  ON 42
ci_044                 5.720547e-03 3 1  ON 43
ci_045                 3.584053e-03 3 1  ON 44
ci_046                 3.739711e-03 3 1  ON 45
ci_047                -2.292552e-03 3 1  ON 46
ci_048                -2.763421e-03 3 1  ON 47
ci_049                 2.415185e-03 3 1  ON 48
ci_050                 2.288503e-03 3 1  ON 49
ci_051                -3.550843e-03 3 1  ON 50
ci_052                -3.210557e-03 3 1  ON 51
ci_053                -2.517462e-03 3 1  ON 52
ci_054                -1.803569e-03 3 1  ON 53
ci_055                -1.313321e-03 3 1  ON 54
ci_056                -1.573541e-03 3 1  ON 55
ci_057                -1.012978e-03 3 1  ON 56
ci_058                -2.031789e-03 3 1  ON 57
ci_059                -1.039322e-03 3 1  ON 58
ci_060                -3.993084e-04 3 1  ON 59
ci_061                -1.307718e-03 3 1  ON 60
ci_062                -8.369290e-04 3 1  ON 61
ci_063                -1.056075e-03 3 1  ON 62
ci_064                -1.319706e-03 3 1  ON 63
ci_065                -1.379327e-03 3 1  ON 64
ci_066                -1.704390e-03 3 1  ON 65
ci_067                -1.656361e-03 3 1  ON 66
ci_068                -1.856100e-03 3 1  ON 67
ci_069                 5.181829e-04 3 1  ON 68
ci_070                 6.581581e-04 3 1  ON 69
ci_071                -1.947752e-03 3 1  ON 70
ci_072                -1.302046e-03 3 1  ON 71
ci_073                 7.108443e-04 3 1  ON 72
ci_074                 1.025415e-03 3 1  ON 73
ci_075                -1.047075e-03 3 1  ON 74
ci_076                -2.723334e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.9392e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORMN2LMC.s001 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORMN2LMC.s001 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=1  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2727e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 1
    time step          = 0.05
    reference energy   = -22.7237
    reference variance = 0.236539
====================================================
  Execution time = 2.6237e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORMN2LMC.s001
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5253e+04
  VMC Eavg = -2.2666e+01
  VMC Evar = 5.0932e-01
  Total weights = 1.954940572e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.7641e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.494565265879
                                         uncertainty =       0.002085548981

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.494565265879
                                         uncertainty =       0.002085548981

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000497342786
  error estimate for blocks of size 2^( 2) =       0.000515672585
  error estimate for blocks of size 2^( 3) =       0.000532368345
  error estimate for blocks of size 2^( 4) =       0.000545085294
  error estimate for blocks of size 2^( 5) =       0.000551956215
  error estimate for blocks of size 2^( 6) =       0.000555397516
  error estimate for blocks of size 2^( 7) =       0.000558786559

      target function =                  N/A
              le_mean =     -22.666291748388
             les_mean =     514.270106178637
             stat err =       0.000552806396
             autocorr =       1.235476452034
              std dev =       0.703348913312
             le_variance =       0.494699693857


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266629174839e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.2500e-02, overlap shift 6.2500e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.666291748508       residual = 4.25e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.667870304645       residual = 2.90e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.668016111418       residual = 2.25e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.668036285671       residual = 2.91e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.668036531609       residual = 1.76e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.668036264988       residual = 1.88e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.668036284975       residual = 6.79e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 6.2500e-02 is 1.131037e-02

solving harmonic davidson linear method for identity shift 2.5000e-01, overlap shift 2.5000e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.666291748508       residual = 4.25e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.667224053462       residual = 1.54e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.667267126163       residual = 2.79e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.667269653662       residual = 6.53e-08           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.667269374262       residual = 3.14e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          4 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 2.5000e-01 is 7.039826e-03

solving harmonic davidson linear method for identity shift 1.0000e+00, overlap shift 1.0000e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.666291748508       residual = 4.25e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.666645166366       residual = 8.69e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.666654486988       residual = 5.41e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.666654762664       residual = 1.80e-08           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.666654690547       residual = 6.41e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          4 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 1.0000e+00 is 2.797649e-03

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.102989 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.1013e+01
  </log>
  <optVariables href="FORMN2LMC.s001.opt.xml">
ci_001                -7.035889e-01 3 1  ON 0
ci_002                -7.035455e-01 3 1  ON 1
ci_003                -5.403627e-02 3 1  ON 2
ci_004                -5.469385e-02 3 1  ON 3
ci_005                 2.412582e-02 3 1  ON 4
ci_006                 2.430374e-02 3 1  ON 5
ci_007                 1.947861e-02 3 1  ON 6
ci_008                 1.989135e-02 3 1  ON 7
ci_009                -1.586829e-02 3 1  ON 8
ci_010                -1.641888e-02 3 1  ON 9
ci_011                -1.403150e-02 3 1  ON 10
ci_012                -1.441805e-02 3 1  ON 11
ci_013                 1.348987e-02 3 1  ON 12
ci_014                 1.336523e-02 3 1  ON 13
ci_015                 1.590944e-02 3 1  ON 14
ci_016                 1.538271e-02 3 1  ON 15
ci_017                 1.203431e-02 3 1  ON 16
ci_018                 1.259178e-02 3 1  ON 17
ci_019                 5.507977e-03 3 1  ON 18
ci_020                 4.935208e-03 3 1  ON 19
ci_021                -9.007972e-03 3 1  ON 20
ci_022                -8.394581e-03 3 1  ON 21
ci_023                 8.150476e-03 3 1  ON 22
ci_024                 8.503179e-03 3 1  ON 23
ci_025                 5.586587e-03 3 1  ON 24
ci_026                 5.207857e-03 3 1  ON 25
ci_027                 5.951680e-03 3 1  ON 26
ci_028                 6.208300e-03 3 1  ON 27
ci_029                -6.102395e-03 3 1  ON 28
ci_030                -5.992491e-03 3 1  ON 29
ci_031                -7.055871e-03 3 1  ON 30
ci_032                -7.738383e-03 3 1  ON 31
ci_033                 5.157627e-03 3 1  ON 32
ci_034                 5.481426e-03 3 1  ON 33
ci_035                 2.812727e-03 3 1  ON 34
ci_036                 2.945278e-03 3 1  ON 35
ci_037                 5.990050e-03 3 1  ON 36
ci_038                 6.259648e-03 3 1  ON 37
ci_039                 5.002620e-03 3 1  ON 38
ci_040                 5.743551e-03 3 1  ON 39
ci_041                 5.344783e-03 3 1  ON 40
ci_042                 4.592263e-03 3 1  ON 41
ci_043                 5.580244e-03 3 1  ON 42
ci_044                 5.713033e-03 3 1  ON 43
ci_045                 3.621790e-03 3 1  ON 44
ci_046                 3.571989e-03 3 1  ON 45
ci_047                -1.672701e-03 3 1  ON 46
ci_048                -1.947213e-03 3 1  ON 47
ci_049                 1.587725e-03 3 1  ON 48
ci_050                 2.020591e-03 3 1  ON 49
ci_051                -3.316398e-03 3 1  ON 50
ci_052                -2.775493e-03 3 1  ON 51
ci_053                -2.053595e-03 3 1  ON 52
ci_054                -2.456633e-03 3 1  ON 53
ci_055                -1.680088e-03 3 1  ON 54
ci_056                -1.263068e-03 3 1  ON 55
ci_057                -1.398803e-03 3 1  ON 56
ci_058                -1.564469e-03 3 1  ON 57
ci_059                -6.604255e-04 3 1  ON 58
ci_060                 3.649193e-04 3 1  ON 59
ci_061                -1.058420e-03 3 1  ON 60
ci_062                -5.323636e-04 3 1  ON 61
ci_063                -5.903861e-04 3 1  ON 62
ci_064                -2.317584e-04 3 1  ON 63
ci_065                -2.067034e-03 3 1  ON 64
ci_066                -1.852263e-03 3 1  ON 65
ci_067                -2.192523e-03 3 1  ON 66
ci_068                -2.399235e-03 3 1  ON 67
ci_069                 3.510160e-04 3 1  ON 68
ci_070                 4.136480e-04 3 1  ON 69
ci_071                -1.717469e-03 3 1  ON 70
ci_072                -2.042168e-03 3 1  ON 71
ci_073                 7.323124e-04 3 1  ON 72
ci_074                 7.025477e-04 3 1  ON 73
ci_075                -1.214634e-03 3 1  ON 74
ci_076                -6.836952e-05 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 1
    time step          = 0.05
    reference energy   = -22.6598
    reference variance = 0.536494
====================================================
  Execution time = 2.5597e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORMN2LMC.s001
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2668e+01
  VMC Evar = 5.0932e-01
  Total weights = 1.9554e+06
  Execution time = 3.6643e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.631365223210
                                         uncertainty =       0.119794601137

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.631365223210
                                         uncertainty =       0.119794601137

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000561682752
  error estimate for blocks of size 2^( 2) =       0.000577934639
  error estimate for blocks of size 2^( 3) =       0.000593061826
  error estimate for blocks of size 2^( 4) =       0.000604159662
  error estimate for blocks of size 2^( 5) =       0.000610980609
  error estimate for blocks of size 2^( 6) =       0.000615689283
  error estimate for blocks of size 2^( 7) =       0.000617678777

      target function =                  N/A
              le_mean =     -22.668440588620
             les_mean =     515.698722718042
             stat err =       0.000612127083
             autocorr =       1.187684293976
              std dev =       0.794339366263
             le_variance =       0.630975028794

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.496884435664
                                         uncertainty =       0.006091542880

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.496884435664
                                         uncertainty =       0.006091542880

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000498400935
  error estimate for blocks of size 2^( 2) =       0.000516435571
  error estimate for blocks of size 2^( 3) =       0.000532923200
  error estimate for blocks of size 2^( 4) =       0.000545048462
  error estimate for blocks of size 2^( 5) =       0.000552748727
  error estimate for blocks of size 2^( 6) =       0.000557450444
  error estimate for blocks of size 2^( 7) =       0.000560175626

      target function =                  N/A
              le_mean =     -22.668649408438
             les_mean =     514.673790884542
             stat err =       0.000553855815
             autocorr =       1.234911235724
              std dev =       0.704845362069
             le_variance =       0.496806984430

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       1.290214869176
                                         uncertainty =       0.796024119384

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       1.290214869176
                                         uncertainty =       0.796024119384

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000803640837
  error estimate for blocks of size 2^( 2) =       0.000815298507
  error estimate for blocks of size 2^( 3) =       0.000825685152
  error estimate for blocks of size 2^( 4) =       0.000833513025
  error estimate for blocks of size 2^( 5) =       0.000838494981
  error estimate for blocks of size 2^( 6) =       0.000840616506
  error estimate for blocks of size 2^( 7) =       0.000840432848

      target function =                  N/A
              le_mean =     -22.668054985080
             les_mean =     522.970907685005
             stat err =       0.000838264340
             autocorr =       1.088022779662
              std dev =       1.136519771227
             le_variance =       1.291677190390

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.497101476404
                                         uncertainty =       0.003809386803

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.497101476404
                                         uncertainty =       0.003809386803

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000498511174
  error estimate for blocks of size 2^( 2) =       0.000516722994
  error estimate for blocks of size 2^( 3) =       0.000533420386
  error estimate for blocks of size 2^( 4) =       0.000545774175
  error estimate for blocks of size 2^( 5) =       0.000553271439
  error estimate for blocks of size 2^( 6) =       0.000558089385
  error estimate for blocks of size 2^( 7) =       0.000560908734

      target function =                  N/A
              le_mean =     -22.668431290421
             les_mean =     514.635644286757
             stat err =       0.000554510933
             autocorr =       1.237286951872
              std dev =       0.705001262823
             le_variance =       0.497026780582


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.668440588620        initial
     6.2500e-02     6.2500e-01             1.1310e-02       -22.668649408438  <--
     2.5000e-01     2.5000e+00             7.0398e-03       -22.668054985080
     1.0000e+00     1.0000e+01             2.7976e-03       -22.668431290421

*****************************************************************************
Applying the update for shift_i =   6.2500e-02     and shift_s =   6.2500e-01
*****************************************************************************

  Execution time = 4.3941e+01
  </log>
  <optVariables href="FORMN2LMC.s001.opt.xml">
ci_001                -7.052657e-01 3 1  ON 0
ci_002                -7.040073e-01 3 1  ON 1
ci_003                -4.847396e-02 3 1  ON 2
ci_004                -4.943264e-02 3 1  ON 3
ci_005                 1.985528e-02 3 1  ON 4
ci_006                 2.011839e-02 3 1  ON 5
ci_007                 1.558607e-02 3 1  ON 6
ci_008                 1.655117e-02 3 1  ON 7
ci_009                -1.325676e-02 3 1  ON 8
ci_010                -1.408381e-02 3 1  ON 9
ci_011                -1.110667e-02 3 1  ON 10
ci_012                -1.159162e-02 3 1  ON 11
ci_013                 1.155342e-02 3 1  ON 12
ci_014                 1.158466e-02 3 1  ON 13
ci_015                 1.397604e-02 3 1  ON 14
ci_016                 1.329107e-02 3 1  ON 15
ci_017                 1.101792e-02 3 1  ON 16
ci_018                 1.211459e-02 3 1  ON 17
ci_019                 3.330649e-03 3 1  ON 18
ci_020                 3.173231e-03 3 1  ON 19
ci_021                -9.194181e-03 3 1  ON 20
ci_022                -7.771782e-03 3 1  ON 21
ci_023                 8.002767e-03 3 1  ON 22
ci_024                 8.316063e-03 3 1  ON 23
ci_025                 5.259039e-03 3 1  ON 24
ci_026                 4.851937e-03 3 1  ON 25
ci_027                 5.580229e-03 3 1  ON 26
ci_028                 5.986786e-03 3 1  ON 27
ci_029                -4.907083e-03 3 1  ON 28
ci_030                -5.525029e-03 3 1  ON 29
ci_031                -6.572936e-03 3 1  ON 30
ci_032                -7.836746e-03 3 1  ON 31
ci_033                 4.314978e-03 3 1  ON 32
ci_034                 4.660000e-03 3 1  ON 33
ci_035                 1.975554e-03 3 1  ON 34
ci_036                 2.092061e-03 3 1  ON 35
ci_037                 5.589477e-03 3 1  ON 36
ci_038                 5.959898e-03 3 1  ON 37
ci_039                 5.120557e-03 3 1  ON 38
ci_040                 5.899774e-03 3 1  ON 39
ci_041                 5.173667e-03 3 1  ON 40
ci_042                 4.531428e-03 3 1  ON 41
ci_043                 5.093156e-03 3 1  ON 42
ci_044                 5.442490e-03 3 1  ON 43
ci_045                 3.821594e-03 3 1  ON 44
ci_046                 3.592990e-03 3 1  ON 45
ci_047                -1.217511e-03 3 1  ON 46
ci_048                -1.398065e-03 3 1  ON 47
ci_049                 8.859056e-04 3 1  ON 48
ci_050                 1.735511e-03 3 1  ON 49
ci_051                -2.730549e-03 3 1  ON 50
ci_052                -2.014441e-03 3 1  ON 51
ci_053                -1.849184e-03 3 1  ON 52
ci_054                -3.248523e-03 3 1  ON 53
ci_055                -1.999240e-03 3 1  ON 54
ci_056                -8.949797e-04 3 1  ON 55
ci_057                -1.645570e-03 3 1  ON 56
ci_058                -1.200671e-03 3 1  ON 57
ci_059                -5.143983e-04 3 1  ON 58
ci_060                 7.550478e-04 3 1  ON 59
ci_061                -8.441954e-04 3 1  ON 60
ci_062                -2.449665e-04 3 1  ON 61
ci_063                -3.045054e-04 3 1  ON 62
ci_064                 6.121590e-04 3 1  ON 63
ci_065                -2.532307e-03 3 1  ON 64
ci_066                -1.865111e-03 3 1  ON 65
ci_067                -2.621947e-03 3 1  ON 66
ci_068                -2.901075e-03 3 1  ON 67
ci_069                 2.090386e-04 3 1  ON 68
ci_070                 2.395367e-04 3 1  ON 69
ci_071                -1.326556e-03 3 1  ON 70
ci_072                -2.495717e-03 3 1  ON 71
ci_073                 6.867615e-04 3 1  ON 72
ci_074                 4.869935e-04 3 1  ON 73
ci_075                -1.325640e-03 3 1  ON 74
ci_076                 9.437783e-05 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.4960e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORMN2LMC.s002 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORMN2LMC.s002 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=2  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2709e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 2
    time step          = 0.05
    reference energy   = -22.6071
    reference variance = 0.841497
====================================================
  Execution time = 2.6175e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORMN2LMC.s002
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5267e+04
  VMC Eavg = -2.2670e+01
  VMC Evar = 4.9948e-01
  Total weights = 1.954927255e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.7847e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.486842272414
                                         uncertainty =       0.002603571985

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.486842272414
                                         uncertainty =       0.002603571985

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000493375608
  error estimate for blocks of size 2^( 2) =       0.000511615173
  error estimate for blocks of size 2^( 3) =       0.000528205459
  error estimate for blocks of size 2^( 4) =       0.000540207629
  error estimate for blocks of size 2^( 5) =       0.000547820712
  error estimate for blocks of size 2^( 6) =       0.000552857099
  error estimate for blocks of size 2^( 7) =       0.000552300147

      target function =                  N/A
              le_mean =     -22.669518640764
             les_mean =     514.406553621154
             stat err =       0.000548296396
             autocorr =       1.235024103262
              std dev =       0.697738476491
             le_variance =       0.486838981577


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266951864076e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5625e-02, overlap shift 1.5625e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.669518640880       residual = 4.96e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.669687468505       residual = 6.21e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.669710287126       residual = 1.22e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.669724570341       residual = 3.10e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.669728671487       residual = 3.63e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.669727836270       residual = 5.45e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.669728249496       residual = 3.87e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.669728377195       residual = 4.48e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.669727835775       residual = 8.94e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 1.5625e-02 is 8.482581e-03

solving harmonic davidson linear method for identity shift 6.2500e-02, overlap shift 6.2500e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.669518640880       residual = 4.96e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.669654260647       residual = 4.44e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.669666649063       residual = 4.98e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.669671869203       residual = 6.42e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.669672967047       residual = 4.38e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.669672711189       residual = 3.32e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          5 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 6.2500e-02 is 4.895356e-03

solving harmonic davidson linear method for identity shift 2.5000e-01, overlap shift 2.5000e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.669518640880       residual = 4.96e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.669594541165       residual = 2.24e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.669598076042       residual = 9.11e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.669598579089       residual = 3.39e-08           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.669598721067       residual = 8.60e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          4 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 2.5000e-01 is 1.841624e-03

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.106068 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0972e+01
  </log>
  <optVariables href="FORMN2LMC.s002.opt.xml">
ci_001                -7.055369e-01 3 1  ON 0
ci_002                -7.048006e-01 3 1  ON 1
ci_003                -4.357860e-02 3 1  ON 2
ci_004                -4.685206e-02 3 1  ON 3
ci_005                 1.787203e-02 3 1  ON 4
ci_006                 1.734697e-02 3 1  ON 5
ci_007                 1.438788e-02 3 1  ON 6
ci_008                 1.429019e-02 3 1  ON 7
ci_009                -1.230594e-02 3 1  ON 8
ci_010                -1.094070e-02 3 1  ON 9
ci_011                -9.323703e-03 3 1  ON 10
ci_012                -9.982688e-03 3 1  ON 11
ci_013                 9.958696e-03 3 1  ON 12
ci_014                 1.046253e-02 3 1  ON 13
ci_015                 1.188763e-02 3 1  ON 14
ci_016                 1.407396e-02 3 1  ON 15
ci_017                 9.916812e-03 3 1  ON 16
ci_018                 1.156193e-02 3 1  ON 17
ci_019                 9.338373e-04 3 1  ON 18
ci_020                 1.548984e-03 3 1  ON 19
ci_021                -7.041384e-03 3 1  ON 20
ci_022                -6.967478e-03 3 1  ON 21
ci_023                 8.050673e-03 3 1  ON 22
ci_024                 7.248255e-03 3 1  ON 23
ci_025                 4.593956e-03 3 1  ON 24
ci_026                 4.166677e-03 3 1  ON 25
ci_027                 6.605122e-03 3 1  ON 26
ci_028                 6.834534e-03 3 1  ON 27
ci_029                -5.265292e-03 3 1  ON 28
ci_030                -5.086496e-03 3 1  ON 29
ci_031                -6.295883e-03 3 1  ON 30
ci_032                -7.621775e-03 3 1  ON 31
ci_033                 3.780494e-03 3 1  ON 32
ci_034                 4.895790e-03 3 1  ON 33
ci_035                 1.476823e-03 3 1  ON 34
ci_036                 1.346861e-03 3 1  ON 35
ci_037                 4.641552e-03 3 1  ON 36
ci_038                 5.668534e-03 3 1  ON 37
ci_039                 4.952834e-03 3 1  ON 38
ci_040                 5.565676e-03 3 1  ON 39
ci_041                 5.562534e-03 3 1  ON 40
ci_042                 5.079826e-03 3 1  ON 41
ci_043                 4.568294e-03 3 1  ON 42
ci_044                 5.300412e-03 3 1  ON 43
ci_045                 5.366762e-03 3 1  ON 44
ci_046                 3.656264e-03 3 1  ON 45
ci_047                -9.209050e-04 3 1  ON 46
ci_048                -1.385400e-03 3 1  ON 47
ci_049                 1.483091e-03 3 1  ON 48
ci_050                 1.141589e-03 3 1  ON 49
ci_051                -2.113910e-03 3 1  ON 50
ci_052                -1.884766e-03 3 1  ON 51
ci_053                -7.010807e-04 3 1  ON 52
ci_054                -3.533167e-03 3 1  ON 53
ci_055                -1.656136e-03 3 1  ON 54
ci_056                -1.188982e-03 3 1  ON 55
ci_057                -1.367680e-03 3 1  ON 56
ci_058                -5.862396e-04 3 1  ON 57
ci_059                -3.652331e-04 3 1  ON 58
ci_060                 2.872126e-05 3 1  ON 59
ci_061                 6.660849e-04 3 1  ON 60
ci_062                -9.205837e-04 3 1  ON 61
ci_063                 4.305655e-04 3 1  ON 62
ci_064                 2.222666e-05 3 1  ON 63
ci_065                -2.320860e-03 3 1  ON 64
ci_066                -3.823876e-03 3 1  ON 65
ci_067                -1.192142e-03 3 1  ON 66
ci_068                -1.980533e-03 3 1  ON 67
ci_069                -8.754683e-05 3 1  ON 68
ci_070                 1.094941e-03 3 1  ON 69
ci_071                -1.488370e-03 3 1  ON 70
ci_072                -1.660051e-03 3 1  ON 71
ci_073                 4.652480e-04 3 1  ON 72
ci_074                 1.682271e-04 3 1  ON 73
ci_075                -1.775112e-05 3 1  ON 74
ci_076                 2.113326e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 2
    time step          = 0.05
    reference energy   = -22.7183
    reference variance = 0.346562
====================================================
  Execution time = 2.5664e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORMN2LMC.s002
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2670e+01
  VMC Evar = 4.9390e-01
  Total weights = 1.9552e+06
  Execution time = 3.6665e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

ERROR CostFunction-> Number of Effective Walkers is too small! 
  Number of effective walkers (samples) / total number of samples = 0.00016435
  User specified threshold minwalkers = 0.3
  If this message appears frequently. You might have to be cautious. 
  Find info about parameter "minwalkers" in the user manual!
Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.487707198228
                                         uncertainty =       0.003729495948

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.487707198228
                                         uncertainty =       0.003729495948

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000493799067
  error estimate for blocks of size 2^( 2) =       0.000512625908
  error estimate for blocks of size 2^( 3) =       0.000529264031
  error estimate for blocks of size 2^( 4) =       0.000540797585
  error estimate for blocks of size 2^( 5) =       0.000547381519
  error estimate for blocks of size 2^( 6) =       0.000549939419
  error estimate for blocks of size 2^( 7) =       0.000550573295

      target function =                  N/A
              le_mean =     -22.669666689502
             les_mean =     514.600288426839
             stat err =       0.000547172954
             autocorr =       1.227859617800
              std dev =       0.698337337368
             le_variance =       0.487675036762

ERROR CostFunction-> Number of Effective Walkers is too small! 
  Number of effective walkers (samples) / total number of samples = 0.00546967
  User specified threshold minwalkers = 0.3
  If this message appears frequently. You might have to be cautious. 
  Find info about parameter "minwalkers" in the user manual!
Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.482674945905
                                         uncertainty =       0.002178295655

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.482674945905
                                         uncertainty =       0.002178295655

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000491246785
  error estimate for blocks of size 2^( 2) =       0.000510158939
  error estimate for blocks of size 2^( 3) =       0.000526906629
  error estimate for blocks of size 2^( 4) =       0.000538481904
  error estimate for blocks of size 2^( 5) =       0.000545067073
  error estimate for blocks of size 2^( 6) =       0.000547663885
  error estimate for blocks of size 2^( 7) =       0.000548205429

      target function =                  N/A
              le_mean =     -22.669578810545
             les_mean =     514.477729110738
             stat err =       0.000544854573
             autocorr =       1.230160444012
              std dev =       0.694727865890
             le_variance =       0.482646807644

ERROR CostFunction-> Number of Effective Walkers is too small! 
  Number of effective walkers (samples) / total number of samples = 0.00016435
  User specified threshold minwalkers = 0.3
  If this message appears frequently. You might have to be cautious. 
  Find info about parameter "minwalkers" in the user manual!
Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.484071274028
                                         uncertainty =       0.002295377661

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.484071274028
                                         uncertainty =       0.002295377661

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000491953409
  error estimate for blocks of size 2^( 2) =       0.000510893455
  error estimate for blocks of size 2^( 3) =       0.000527703082
  error estimate for blocks of size 2^( 4) =       0.000539379741
  error estimate for blocks of size 2^( 5) =       0.000545942796
  error estimate for blocks of size 2^( 6) =       0.000548426546
  error estimate for blocks of size 2^( 7) =       0.000548908093

      target function =                  N/A
              le_mean =     -22.669704310601
             les_mean =     514.483346915026
             stat err =       0.000545664294
             autocorr =       1.230277621127
              std dev =       0.695727182617
             le_variance =       0.484036312632

ERROR CostFunction-> Number of Effective Walkers is too small! 
  Number of effective walkers (samples) / total number of samples = 0.000974117
  User specified threshold minwalkers = 0.3
  If this message appears frequently. You might have to be cautious. 
  Find info about parameter "minwalkers" in the user manual!
Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.482968054150
                                         uncertainty =       0.002131813485

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.482968054150
                                         uncertainty =       0.002131813485

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000491396380
  error estimate for blocks of size 2^( 2) =       0.000510310843
  error estimate for blocks of size 2^( 3) =       0.000527030811
  error estimate for blocks of size 2^( 4) =       0.000538612476
  error estimate for blocks of size 2^( 5) =       0.000545229991
  error estimate for blocks of size 2^( 6) =       0.000547855539
  error estimate for blocks of size 2^( 7) =       0.000548438824

      target function =                  N/A
              le_mean =     -22.669568352050
             les_mean =     514.411207810128
             stat err =       0.000545034208
             autocorr =       1.230222355371
              std dev =       0.694939425525
             le_variance =       0.482940805149


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.669666689502        initial
     1.5625e-02     1.5625e-01             8.4826e-03       -22.669578810545
     6.2500e-02     6.2500e-01             4.8954e-03       -22.669704310601  <--
     2.5000e-01     2.5000e+00             1.8416e-03       -22.669568352050

*****************************************************************************
Applying the update for shift_i =   6.2500e-02     and shift_s =   6.2500e-01
*****************************************************************************

  Execution time = 4.4017e+01
  </log>
  <optVariables href="FORMN2LMC.s002.opt.xml">
ci_001                -7.055369e-01 3 1  ON 0
ci_002                -7.048006e-01 3 1  ON 1
ci_003                -4.357860e-02 3 1  ON 2
ci_004                -4.685206e-02 3 1  ON 3
ci_005                 1.787203e-02 3 1  ON 4
ci_006                 1.734697e-02 3 1  ON 5
ci_007                 1.438788e-02 3 1  ON 6
ci_008                 1.429019e-02 3 1  ON 7
ci_009                -1.230594e-02 3 1  ON 8
ci_010                -1.094070e-02 3 1  ON 9
ci_011                -9.323703e-03 3 1  ON 10
ci_012                -9.982688e-03 3 1  ON 11
ci_013                 9.958696e-03 3 1  ON 12
ci_014                 1.046253e-02 3 1  ON 13
ci_015                 1.188763e-02 3 1  ON 14
ci_016                 1.407396e-02 3 1  ON 15
ci_017                 9.916812e-03 3 1  ON 16
ci_018                 1.156193e-02 3 1  ON 17
ci_019                 9.338373e-04 3 1  ON 18
ci_020                 1.548984e-03 3 1  ON 19
ci_021                -7.041384e-03 3 1  ON 20
ci_022                -6.967478e-03 3 1  ON 21
ci_023                 8.050673e-03 3 1  ON 22
ci_024                 7.248255e-03 3 1  ON 23
ci_025                 4.593956e-03 3 1  ON 24
ci_026                 4.166677e-03 3 1  ON 25
ci_027                 6.605122e-03 3 1  ON 26
ci_028                 6.834534e-03 3 1  ON 27
ci_029                -5.265292e-03 3 1  ON 28
ci_030                -5.086496e-03 3 1  ON 29
ci_031                -6.295883e-03 3 1  ON 30
ci_032                -7.621775e-03 3 1  ON 31
ci_033                 3.780494e-03 3 1  ON 32
ci_034                 4.895790e-03 3 1  ON 33
ci_035                 1.476823e-03 3 1  ON 34
ci_036                 1.346861e-03 3 1  ON 35
ci_037                 4.641552e-03 3 1  ON 36
ci_038                 5.668534e-03 3 1  ON 37
ci_039                 4.952834e-03 3 1  ON 38
ci_040                 5.565676e-03 3 1  ON 39
ci_041                 5.562534e-03 3 1  ON 40
ci_042                 5.079826e-03 3 1  ON 41
ci_043                 4.568294e-03 3 1  ON 42
ci_044                 5.300412e-03 3 1  ON 43
ci_045                 5.366762e-03 3 1  ON 44
ci_046                 3.656264e-03 3 1  ON 45
ci_047                -9.209050e-04 3 1  ON 46
ci_048                -1.385400e-03 3 1  ON 47
ci_049                 1.483091e-03 3 1  ON 48
ci_050                 1.141589e-03 3 1  ON 49
ci_051                -2.113910e-03 3 1  ON 50
ci_052                -1.884766e-03 3 1  ON 51
ci_053                -7.010807e-04 3 1  ON 52
ci_054                -3.533167e-03 3 1  ON 53
ci_055                -1.656136e-03 3 1  ON 54
ci_056                -1.188982e-03 3 1  ON 55
ci_057                -1.367680e-03 3 1  ON 56
ci_058                -5.862396e-04 3 1  ON 57
ci_059                -3.652331e-04 3 1  ON 58
ci_060                 2.872126e-05 3 1  ON 59
ci_061                 6.660849e-04 3 1  ON 60
ci_062                -9.205837e-04 3 1  ON 61
ci_063                 4.305655e-04 3 1  ON 62
ci_064                 2.222666e-05 3 1  ON 63
ci_065                -2.320860e-03 3 1  ON 64
ci_066                -3.823876e-03 3 1  ON 65
ci_067                -1.192142e-03 3 1  ON 66
ci_068                -1.980533e-03 3 1  ON 67
ci_069                -8.754683e-05 3 1  ON 68
ci_070                 1.094941e-03 3 1  ON 69
ci_071                -1.488370e-03 3 1  ON 70
ci_072                -1.660051e-03 3 1  ON 71
ci_073                 4.652480e-04 3 1  ON 72
ci_074                 1.682271e-04 3 1  ON 73
ci_075                -1.775112e-05 3 1  ON 74
ci_076                 2.113326e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.4995e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORMN2LMC.s003 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORMN2LMC.s003 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=3  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2694e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 3
    time step          = 0.05
    reference energy   = -22.6298
    reference variance = 0.508311
====================================================
  Execution time = 2.6267e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORMN2LMC.s003
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5264e+04
  VMC Eavg = -2.2670e+01
  VMC Evar = 4.9479e-01
  Total weights = 1.955169868e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.7742e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.484049416043
                                         uncertainty =       0.003102218622

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.484049416043
                                         uncertainty =       0.003102218622

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000491955754
  error estimate for blocks of size 2^( 2) =       0.000510082311
  error estimate for blocks of size 2^( 3) =       0.000526919713
  error estimate for blocks of size 2^( 4) =       0.000539778940
  error estimate for blocks of size 2^( 5) =       0.000546778698
  error estimate for blocks of size 2^( 6) =       0.000550679827
  error estimate for blocks of size 2^( 7) =       0.000553135002

      target function =                  N/A
              le_mean =     -22.669524580562
             les_mean =     514.402129955214
             stat err =       0.000547593117
             autocorr =       1.238978787639
              std dev =       0.695730500005
             le_variance =       0.484040928638


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266952458056e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5625e-02, overlap shift 1.5625e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.669524580664       residual = 2.48e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.669625164476       residual = 3.23e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.669642230075       residual = 1.08e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.669660096125       residual = 3.50e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.669660047384       residual = 2.16e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.669661927490       residual = 2.24e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.669660846559       residual = 3.68e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.669660590333       residual = 4.40e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.669660680857       residual = 3.47e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 1.5625e-02 is 8.210847e-03

solving harmonic davidson linear method for identity shift 6.2500e-02, overlap shift 6.2500e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.669524580664       residual = 2.48e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.669603356185       residual = 2.00e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.669610465263       residual = 3.31e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.669615975033       residual = 4.40e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.669615283245       residual = 8.97e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.669615344062       residual = 2.24e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.669615211826       residual = 1.28e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 6.2500e-02 is 3.602039e-03

solving harmonic davidson linear method for identity shift 2.5000e-01, overlap shift 2.5000e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.669524580664       residual = 2.48e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.669566767761       residual = 6.59e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.669567362352       residual = 2.41e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.669567925030       residual = 5.47e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 2.5000e-01 is 1.383086e-03

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.108468 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.1053e+01
  </log>
  <optVariables href="FORMN2LMC.s003.opt.xml">
ci_001                -7.077199e-01 3 1  ON 0
ci_002                -7.032198e-01 3 1  ON 1
ci_003                -3.997656e-02 3 1  ON 2
ci_004                -4.333800e-02 3 1  ON 3
ci_005                 1.642267e-02 3 1  ON 4
ci_006                 1.746526e-02 3 1  ON 5
ci_007                 1.297451e-02 3 1  ON 6
ci_008                 1.352270e-02 3 1  ON 7
ci_009                -1.217671e-02 3 1  ON 8
ci_010                -1.144797e-02 3 1  ON 9
ci_011                -8.576424e-03 3 1  ON 10
ci_012                -8.631640e-03 3 1  ON 11
ci_013                 8.858694e-03 3 1  ON 12
ci_014                 1.073452e-02 3 1  ON 13
ci_015                 1.142461e-02 3 1  ON 14
ci_016                 1.264471e-02 3 1  ON 15
ci_017                 1.127928e-02 3 1  ON 16
ci_018                 1.145435e-02 3 1  ON 17
ci_019                 1.526877e-04 3 1  ON 18
ci_020                 1.025885e-03 3 1  ON 19
ci_021                -7.530985e-03 3 1  ON 20
ci_022                -6.960223e-03 3 1  ON 21
ci_023                 8.067317e-03 3 1  ON 22
ci_024                 8.120183e-03 3 1  ON 23
ci_025                 4.171013e-03 3 1  ON 24
ci_026                 2.665804e-03 3 1  ON 25
ci_027                 6.341916e-03 3 1  ON 26
ci_028                 6.559881e-03 3 1  ON 27
ci_029                -5.855604e-03 3 1  ON 28
ci_030                -4.333045e-03 3 1  ON 29
ci_031                -7.857149e-03 3 1  ON 30
ci_032                -6.929684e-03 3 1  ON 31
ci_033                 4.248647e-03 3 1  ON 32
ci_034                 5.358038e-03 3 1  ON 33
ci_035                 1.537015e-03 3 1  ON 34
ci_036                 1.131211e-03 3 1  ON 35
ci_037                 4.905979e-03 3 1  ON 36
ci_038                 5.731222e-03 3 1  ON 37
ci_039                 6.342072e-03 3 1  ON 38
ci_040                 5.952318e-03 3 1  ON 39
ci_041                 4.640666e-03 3 1  ON 40
ci_042                 4.833750e-03 3 1  ON 41
ci_043                 3.960650e-03 3 1  ON 42
ci_044                 5.206189e-03 3 1  ON 43
ci_045                 3.882424e-03 3 1  ON 44
ci_046                 3.618499e-03 3 1  ON 45
ci_047                -1.801254e-04 3 1  ON 46
ci_048                -1.378279e-03 3 1  ON 47
ci_049                 1.919610e-03 3 1  ON 48
ci_050                 1.050649e-03 3 1  ON 49
ci_051                -8.198858e-04 3 1  ON 50
ci_052                -1.872900e-03 3 1  ON 51
ci_053                -2.560001e-03 3 1  ON 52
ci_054                -2.352452e-03 3 1  ON 53
ci_055                -1.234372e-03 3 1  ON 54
ci_056                -2.566581e-03 3 1  ON 55
ci_057                -2.002583e-03 3 1  ON 56
ci_058                -1.248030e-03 3 1  ON 57
ci_059                -4.953941e-04 3 1  ON 58
ci_060                 5.806540e-04 3 1  ON 59
ci_061                -1.968641e-05 3 1  ON 60
ci_062                -1.201334e-03 3 1  ON 61
ci_063                -1.155769e-03 3 1  ON 62
ci_064                -5.496661e-04 3 1  ON 63
ci_065                -2.988235e-03 3 1  ON 64
ci_066                -2.832172e-03 3 1  ON 65
ci_067                -1.174917e-03 3 1  ON 66
ci_068                -2.137433e-03 3 1  ON 67
ci_069                -1.249604e-03 3 1  ON 68
ci_070                 4.253503e-04 3 1  ON 69
ci_071                -6.237140e-04 3 1  ON 70
ci_072                -1.770244e-03 3 1  ON 71
ci_073                 3.320945e-04 3 1  ON 72
ci_074                -2.010494e-04 3 1  ON 73
ci_075                -4.932164e-04 3 1  ON 74
ci_076                -5.353529e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 3
    time step          = 0.05
    reference energy   = -22.6667
    reference variance = 0.557963
====================================================
  Execution time = 2.5815e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORMN2LMC.s003
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2669e+01
  VMC Evar = 4.9655e-01
  Total weights = 1.9547e+06
  Execution time = 3.6674e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

ERROR CostFunction-> Number of Effective Walkers is too small! 
  Number of effective walkers (samples) / total number of samples = 0.0371198
  User specified threshold minwalkers = 0.3
  If this message appears frequently. You might have to be cautious. 
  Find info about parameter "minwalkers" in the user manual!
Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.502875377272
                                         uncertainty =       0.017143560910

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.502875377272
                                         uncertainty =       0.017143560910

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000501397113
  error estimate for blocks of size 2^( 2) =       0.000519989186
  error estimate for blocks of size 2^( 3) =       0.000536330624
  error estimate for blocks of size 2^( 4) =       0.000548059486
  error estimate for blocks of size 2^( 5) =       0.000554242611
  error estimate for blocks of size 2^( 6) =       0.000557029399
  error estimate for blocks of size 2^( 7) =       0.000560860284

      target function =                  N/A
              le_mean =     -22.669293557296
             les_mean =     516.509009242309
             stat err =       0.000555047945
             autocorr =       1.225454919750
              std dev =       0.709082597498
             le_variance =       0.502798130075

ERROR CostFunction-> Number of Effective Walkers is too small! 
  Number of effective walkers (samples) / total number of samples = 0.211169
  User specified threshold minwalkers = 0.3
  If this message appears frequently. You might have to be cautious. 
  Find info about parameter "minwalkers" in the user manual!
Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.485002487965
                                         uncertainty =       0.003072860696

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.485002487965
                                         uncertainty =       0.003072860696

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000492423866
  error estimate for blocks of size 2^( 2) =       0.000511324853
  error estimate for blocks of size 2^( 3) =       0.000528049086
  error estimate for blocks of size 2^( 4) =       0.000539798815
  error estimate for blocks of size 2^( 5) =       0.000546292840
  error estimate for blocks of size 2^( 6) =       0.000549179890
  error estimate for blocks of size 2^( 7) =       0.000552860737

      target function =                  N/A
              le_mean =     -22.669163238087
             les_mean =     514.393144939775
             stat err =       0.000547033071
             autocorr =       1.234096094166
              std dev =       0.696392509337
             le_variance =       0.484962527060

ERROR CostFunction-> Number of Effective Walkers is too small! 
  Number of effective walkers (samples) / total number of samples = 0.0362069
  User specified threshold minwalkers = 0.3
  If this message appears frequently. You might have to be cautious. 
  Find info about parameter "minwalkers" in the user manual!
Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.485659993606
                                         uncertainty =       0.003094922261

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.485659993606
                                         uncertainty =       0.003094922261

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000492757332
  error estimate for blocks of size 2^( 2) =       0.000511655860
  error estimate for blocks of size 2^( 3) =       0.000528419538
  error estimate for blocks of size 2^( 4) =       0.000540167570
  error estimate for blocks of size 2^( 5) =       0.000546648549
  error estimate for blocks of size 2^( 6) =       0.000549583733
  error estimate for blocks of size 2^( 7) =       0.000553256581

      target function =                  N/A
              le_mean =     -22.669229403558
             les_mean =     514.405201476134
             stat err =       0.000547414108
             autocorr =       1.234143844672
              std dev =       0.696864102224
             le_variance =       0.485619576968

ERROR CostFunction-> Number of Effective Walkers is too small! 
  Number of effective walkers (samples) / total number of samples = 0.254494
  User specified threshold minwalkers = 0.3
  If this message appears frequently. You might have to be cautious. 
  Find info about parameter "minwalkers" in the user manual!
Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.484564328589
                                         uncertainty =       0.002984392880

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.484564328589
                                         uncertainty =       0.002984392880

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000492201851
  error estimate for blocks of size 2^( 2) =       0.000511110337
  error estimate for blocks of size 2^( 3) =       0.000527827805
  error estimate for blocks of size 2^( 4) =       0.000539615540
  error estimate for blocks of size 2^( 5) =       0.000546109248
  error estimate for blocks of size 2^( 6) =       0.000548968201
  error estimate for blocks of size 2^( 7) =       0.000552707313

      target function =                  N/A
              le_mean =     -22.669164925679
             les_mean =     514.394089946358
             stat err =       0.000546850075
             autocorr =       1.234383383321
              std dev =       0.696078533651
             le_variance =       0.484525325010


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.669293557296        initial  <--
     1.5625e-02     1.5625e-01             8.2108e-03       -22.669163238087
     6.2500e-02     6.2500e-01             3.6020e-03       -22.669229403558
     2.5000e-01     2.5000e+00             1.3831e-03       -22.669164925679

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 44.1774
  </log>
  <optVariables href="FORMN2LMC.s003.opt.xml">
ci_001                -7.055369e-01 3 1  ON 0
ci_002                -7.048006e-01 3 1  ON 1
ci_003                -4.357860e-02 3 1  ON 2
ci_004                -4.685206e-02 3 1  ON 3
ci_005                 1.787203e-02 3 1  ON 4
ci_006                 1.734697e-02 3 1  ON 5
ci_007                 1.438788e-02 3 1  ON 6
ci_008                 1.429019e-02 3 1  ON 7
ci_009                -1.230594e-02 3 1  ON 8
ci_010                -1.094070e-02 3 1  ON 9
ci_011                -9.323703e-03 3 1  ON 10
ci_012                -9.982688e-03 3 1  ON 11
ci_013                 9.958696e-03 3 1  ON 12
ci_014                 1.046253e-02 3 1  ON 13
ci_015                 1.188763e-02 3 1  ON 14
ci_016                 1.407396e-02 3 1  ON 15
ci_017                 9.916812e-03 3 1  ON 16
ci_018                 1.156193e-02 3 1  ON 17
ci_019                 9.338373e-04 3 1  ON 18
ci_020                 1.548984e-03 3 1  ON 19
ci_021                -7.041384e-03 3 1  ON 20
ci_022                -6.967478e-03 3 1  ON 21
ci_023                 8.050673e-03 3 1  ON 22
ci_024                 7.248255e-03 3 1  ON 23
ci_025                 4.593956e-03 3 1  ON 24
ci_026                 4.166677e-03 3 1  ON 25
ci_027                 6.605122e-03 3 1  ON 26
ci_028                 6.834534e-03 3 1  ON 27
ci_029                -5.265292e-03 3 1  ON 28
ci_030                -5.086496e-03 3 1  ON 29
ci_031                -6.295883e-03 3 1  ON 30
ci_032                -7.621775e-03 3 1  ON 31
ci_033                 3.780494e-03 3 1  ON 32
ci_034                 4.895790e-03 3 1  ON 33
ci_035                 1.476823e-03 3 1  ON 34
ci_036                 1.346861e-03 3 1  ON 35
ci_037                 4.641552e-03 3 1  ON 36
ci_038                 5.668534e-03 3 1  ON 37
ci_039                 4.952834e-03 3 1  ON 38
ci_040                 5.565676e-03 3 1  ON 39
ci_041                 5.562534e-03 3 1  ON 40
ci_042                 5.079826e-03 3 1  ON 41
ci_043                 4.568294e-03 3 1  ON 42
ci_044                 5.300412e-03 3 1  ON 43
ci_045                 5.366762e-03 3 1  ON 44
ci_046                 3.656264e-03 3 1  ON 45
ci_047                -9.209050e-04 3 1  ON 46
ci_048                -1.385400e-03 3 1  ON 47
ci_049                 1.483091e-03 3 1  ON 48
ci_050                 1.141589e-03 3 1  ON 49
ci_051                -2.113910e-03 3 1  ON 50
ci_052                -1.884766e-03 3 1  ON 51
ci_053                -7.010807e-04 3 1  ON 52
ci_054                -3.533167e-03 3 1  ON 53
ci_055                -1.656136e-03 3 1  ON 54
ci_056                -1.188982e-03 3 1  ON 55
ci_057                -1.367680e-03 3 1  ON 56
ci_058                -5.862396e-04 3 1  ON 57
ci_059                -3.652331e-04 3 1  ON 58
ci_060                 2.872126e-05 3 1  ON 59
ci_061                 6.660849e-04 3 1  ON 60
ci_062                -9.205837e-04 3 1  ON 61
ci_063                 4.305655e-04 3 1  ON 62
ci_064                 2.222666e-05 3 1  ON 63
ci_065                -2.320860e-03 3 1  ON 64
ci_066                -3.823876e-03 3 1  ON 65
ci_067                -1.192142e-03 3 1  ON 66
ci_068                -1.980533e-03 3 1  ON 67
ci_069                -8.754683e-05 3 1  ON 68
ci_070                 1.094941e-03 3 1  ON 69
ci_071                -1.488370e-03 3 1  ON 70
ci_072                -1.660051e-03 3 1  ON 71
ci_073                 4.652480e-04 3 1  ON 72
ci_074                 1.682271e-04 3 1  ON 73
ci_075                -1.775112e-05 3 1  ON 74
ci_076                 2.113326e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.5240e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORMN2LMC.s004 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORMN2LMC.s004 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=4  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2682e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 4
    time step          = 0.05
    reference energy   = -22.7461
    reference variance = 0.722456
====================================================
  Execution time = 2.6168e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORMN2LMC.s004
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5279e+04
  VMC Eavg = -2.2670e+01
  VMC Evar = 5.0032e-01
  Total weights = 1.954794498e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.7745e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.486776189203
                                         uncertainty =       0.003136268694

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.486776189203
                                         uncertainty =       0.003136268694

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000493385613
  error estimate for blocks of size 2^( 2) =       0.000511589336
  error estimate for blocks of size 2^( 3) =       0.000528336877
  error estimate for blocks of size 2^( 4) =       0.000541514055
  error estimate for blocks of size 2^( 5) =       0.000547457692
  error estimate for blocks of size 2^( 6) =       0.000551399017
  error estimate for blocks of size 2^( 7) =       0.000552545642

      target function =                  N/A
              le_mean =     -22.669819831142
             les_mean =     514.421054130687
             stat err =       0.000548229102
             autocorr =       1.234670887001
              std dev =       0.697752625494
             le_variance =       0.486858726384


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266981983114e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5625e-01, overlap shift 1.5625e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.669819831227       residual = 2.78e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.669873821326       residual = 9.26e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.669876148676       residual = 5.54e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.669876412510       residual = 2.21e-08           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.669876498029       residual = 5.15e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          4 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 1.5625e-01 is 1.932981e-03

solving harmonic davidson linear method for identity shift 6.2500e-01, overlap shift 6.2500e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.669819831227       residual = 2.78e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.669841642070       residual = 3.89e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.669841821952       residual = 1.31e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.669841789102       residual = 3.95e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 6.2500e-01 is 7.009633e-04

solving harmonic davidson linear method for identity shift 2.5000e+00, overlap shift 2.5000e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.669819831227       residual = 2.78e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.669826276324       residual = 3.60e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.669826266949       residual = 1.02e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.669826254588       residual = 2.85e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 2.5000e+00 is 2.054515e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.113106 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0959e+01
  </log>
  <optVariables href="FORMN2LMC.s004.opt.xml">
ci_001                -7.055661e-01 3 1  ON 0
ci_002                -7.048376e-01 3 1  ON 1
ci_003                -4.345146e-02 3 1  ON 2
ci_004                -4.626344e-02 3 1  ON 3
ci_005                 1.765911e-02 3 1  ON 4
ci_006                 1.729769e-02 3 1  ON 5
ci_007                 1.413697e-02 3 1  ON 6
ci_008                 1.386813e-02 3 1  ON 7
ci_009                -1.216274e-02 3 1  ON 8
ci_010                -1.131631e-02 3 1  ON 9
ci_011                -9.234333e-03 3 1  ON 10
ci_012                -9.756011e-03 3 1  ON 11
ci_013                 9.558609e-03 3 1  ON 12
ci_014                 1.032782e-02 3 1  ON 13
ci_015                 1.203963e-02 3 1  ON 14
ci_016                 1.386766e-02 3 1  ON 15
ci_017                 1.035185e-02 3 1  ON 16
ci_018                 1.185597e-02 3 1  ON 17
ci_019                 5.808680e-04 3 1  ON 18
ci_020                 1.123273e-03 3 1  ON 19
ci_021                -7.342478e-03 3 1  ON 20
ci_022                -7.438391e-03 3 1  ON 21
ci_023                 8.164361e-03 3 1  ON 22
ci_024                 7.301769e-03 3 1  ON 23
ci_025                 4.463820e-03 3 1  ON 24
ci_026                 4.151708e-03 3 1  ON 25
ci_027                 6.218505e-03 3 1  ON 26
ci_028                 6.566745e-03 3 1  ON 27
ci_029                -5.504710e-03 3 1  ON 28
ci_030                -4.988070e-03 3 1  ON 29
ci_031                -6.633120e-03 3 1  ON 30
ci_032                -7.697317e-03 3 1  ON 31
ci_033                 3.838189e-03 3 1  ON 32
ci_034                 4.851073e-03 3 1  ON 33
ci_035                 1.761944e-03 3 1  ON 34
ci_036                 1.327127e-03 3 1  ON 35
ci_037                 5.002524e-03 3 1  ON 36
ci_038                 5.312493e-03 3 1  ON 37
ci_039                 5.124762e-03 3 1  ON 38
ci_040                 5.612866e-03 3 1  ON 39
ci_041                 5.328068e-03 3 1  ON 40
ci_042                 5.184637e-03 3 1  ON 41
ci_043                 4.676333e-03 3 1  ON 42
ci_044                 5.306402e-03 3 1  ON 43
ci_045                 4.665799e-03 3 1  ON 44
ci_046                 3.820416e-03 3 1  ON 45
ci_047                -7.542135e-04 3 1  ON 46
ci_048                -1.081786e-03 3 1  ON 47
ci_049                 1.781742e-03 3 1  ON 48
ci_050                 9.926791e-04 3 1  ON 49
ci_051                -2.109016e-03 3 1  ON 50
ci_052                -1.825480e-03 3 1  ON 51
ci_053                -8.165487e-04 3 1  ON 52
ci_054                -3.293682e-03 3 1  ON 53
ci_055                -1.687766e-03 3 1  ON 54
ci_056                -1.305178e-03 3 1  ON 55
ci_057                -1.345115e-03 3 1  ON 56
ci_058                -5.613015e-04 3 1  ON 57
ci_059                -1.653183e-04 3 1  ON 58
ci_060                -5.005819e-05 3 1  ON 59
ci_061                 6.085036e-04 3 1  ON 60
ci_062                -6.029337e-04 3 1  ON 61
ci_063                 2.819497e-04 3 1  ON 62
ci_064                -2.321563e-04 3 1  ON 63
ci_065                -2.612939e-03 3 1  ON 64
ci_066                -3.292761e-03 3 1  ON 65
ci_067                -1.693328e-03 3 1  ON 66
ci_068                -2.274291e-03 3 1  ON 67
ci_069                -4.068152e-04 3 1  ON 68
ci_070                 8.014873e-04 3 1  ON 69
ci_071                -1.634735e-03 3 1  ON 70
ci_072                -1.661664e-03 3 1  ON 71
ci_073                 6.587629e-04 3 1  ON 72
ci_074                 2.840925e-04 3 1  ON 73
ci_075                 2.793812e-04 3 1  ON 74
ci_076                 1.655096e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 4
    time step          = 0.05
    reference energy   = -22.7253
    reference variance = 0.302888
====================================================
  Execution time = 2.5664e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORMN2LMC.s004
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2669e+01
  VMC Evar = 5.0277e-01
  Total weights = 1.9549e+06
  Execution time = 3.6646e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.488244135036
                                         uncertainty =       0.003137092776

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.488244135036
                                         uncertainty =       0.003137092776

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000494036460
  error estimate for blocks of size 2^( 2) =       0.000512652407
  error estimate for blocks of size 2^( 3) =       0.000529853046
  error estimate for blocks of size 2^( 4) =       0.000543393761
  error estimate for blocks of size 2^( 5) =       0.000552579952
  error estimate for blocks of size 2^( 6) =       0.000554719721
  error estimate for blocks of size 2^( 7) =       0.000557897255

      target function =                  N/A
              le_mean =     -22.668626053534
             les_mean =     514.379582639817
             stat err =       0.000552147672
             autocorr =       1.249086427692
              std dev =       0.698673061369
             le_variance =       0.488144046683

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.488252056998
                                         uncertainty =       0.003185353368

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.488252056998
                                         uncertainty =       0.003185353368

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000494041010
  error estimate for blocks of size 2^( 2) =       0.000512647721
  error estimate for blocks of size 2^( 3) =       0.000529843827
  error estimate for blocks of size 2^( 4) =       0.000543385208
  error estimate for blocks of size 2^( 5) =       0.000552578137
  error estimate for blocks of size 2^( 6) =       0.000554733522
  error estimate for blocks of size 2^( 7) =       0.000557952124

      target function =                  N/A
              le_mean =     -22.668622022889
             les_mean =     514.371164133202
             stat err =       0.000552162248
             autocorr =       1.249129364662
              std dev =       0.698679496846
             le_variance =       0.488153039313

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.488206714540
                                         uncertainty =       0.003176981929

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.488206714540
                                         uncertainty =       0.003176981929

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000494017956
  error estimate for blocks of size 2^( 2) =       0.000512627031
  error estimate for blocks of size 2^( 3) =       0.000529820871
  error estimate for blocks of size 2^( 4) =       0.000543362923
  error estimate for blocks of size 2^( 5) =       0.000552551032
  error estimate for blocks of size 2^( 6) =       0.000554706501
  error estimate for blocks of size 2^( 7) =       0.000557915224

      target function =                  N/A
              le_mean =     -22.668612261763
             les_mean =     514.376466265694
             stat err =       0.000552133920
             autocorr =       1.249117776333
              std dev =       0.698646892796
             le_variance =       0.488107480813

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.488199692362
                                         uncertainty =       0.003141040201

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.488199692362
                                         uncertainty =       0.003141040201

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000494014049
  error estimate for blocks of size 2^( 2) =       0.000512630653
  error estimate for blocks of size 2^( 3) =       0.000529832416
  error estimate for blocks of size 2^( 4) =       0.000543373310
  error estimate for blocks of size 2^( 5) =       0.000552562827
  error estimate for blocks of size 2^( 6) =       0.000554707752
  error estimate for blocks of size 2^( 7) =       0.000557895131

      target function =                  N/A
              le_mean =     -22.668620055794
             les_mean =     514.370183935727
             stat err =       0.000552134755
             autocorr =       1.249141308403
              std dev =       0.698641368672
             le_variance =       0.488099762020


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.668626053534        initial  <--
     1.5625e-01     1.5625e+00             1.9330e-03       -22.668622022889
     6.2500e-01     6.2500e+00             7.0096e-04       -22.668612261763
     2.5000e+00     2.5000e+01             2.0545e-04       -22.668620055794

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 47.4030
  </log>
  <optVariables href="FORMN2LMC.s004.opt.xml">
ci_001                -7.055369e-01 3 1  ON 0
ci_002                -7.048006e-01 3 1  ON 1
ci_003                -4.357860e-02 3 1  ON 2
ci_004                -4.685206e-02 3 1  ON 3
ci_005                 1.787203e-02 3 1  ON 4
ci_006                 1.734697e-02 3 1  ON 5
ci_007                 1.438788e-02 3 1  ON 6
ci_008                 1.429019e-02 3 1  ON 7
ci_009                -1.230594e-02 3 1  ON 8
ci_010                -1.094070e-02 3 1  ON 9
ci_011                -9.323703e-03 3 1  ON 10
ci_012                -9.982688e-03 3 1  ON 11
ci_013                 9.958696e-03 3 1  ON 12
ci_014                 1.046253e-02 3 1  ON 13
ci_015                 1.188763e-02 3 1  ON 14
ci_016                 1.407396e-02 3 1  ON 15
ci_017                 9.916812e-03 3 1  ON 16
ci_018                 1.156193e-02 3 1  ON 17
ci_019                 9.338373e-04 3 1  ON 18
ci_020                 1.548984e-03 3 1  ON 19
ci_021                -7.041384e-03 3 1  ON 20
ci_022                -6.967478e-03 3 1  ON 21
ci_023                 8.050673e-03 3 1  ON 22
ci_024                 7.248255e-03 3 1  ON 23
ci_025                 4.593956e-03 3 1  ON 24
ci_026                 4.166677e-03 3 1  ON 25
ci_027                 6.605122e-03 3 1  ON 26
ci_028                 6.834534e-03 3 1  ON 27
ci_029                -5.265292e-03 3 1  ON 28
ci_030                -5.086496e-03 3 1  ON 29
ci_031                -6.295883e-03 3 1  ON 30
ci_032                -7.621775e-03 3 1  ON 31
ci_033                 3.780494e-03 3 1  ON 32
ci_034                 4.895790e-03 3 1  ON 33
ci_035                 1.476823e-03 3 1  ON 34
ci_036                 1.346861e-03 3 1  ON 35
ci_037                 4.641552e-03 3 1  ON 36
ci_038                 5.668534e-03 3 1  ON 37
ci_039                 4.952834e-03 3 1  ON 38
ci_040                 5.565676e-03 3 1  ON 39
ci_041                 5.562534e-03 3 1  ON 40
ci_042                 5.079826e-03 3 1  ON 41
ci_043                 4.568294e-03 3 1  ON 42
ci_044                 5.300412e-03 3 1  ON 43
ci_045                 5.366762e-03 3 1  ON 44
ci_046                 3.656264e-03 3 1  ON 45
ci_047                -9.209050e-04 3 1  ON 46
ci_048                -1.385400e-03 3 1  ON 47
ci_049                 1.483091e-03 3 1  ON 48
ci_050                 1.141589e-03 3 1  ON 49
ci_051                -2.113910e-03 3 1  ON 50
ci_052                -1.884766e-03 3 1  ON 51
ci_053                -7.010807e-04 3 1  ON 52
ci_054                -3.533167e-03 3 1  ON 53
ci_055                -1.656136e-03 3 1  ON 54
ci_056                -1.188982e-03 3 1  ON 55
ci_057                -1.367680e-03 3 1  ON 56
ci_058                -5.862396e-04 3 1  ON 57
ci_059                -3.652331e-04 3 1  ON 58
ci_060                 2.872126e-05 3 1  ON 59
ci_061                 6.660849e-04 3 1  ON 60
ci_062                -9.205837e-04 3 1  ON 61
ci_063                 4.305655e-04 3 1  ON 62
ci_064                 2.222666e-05 3 1  ON 63
ci_065                -2.320860e-03 3 1  ON 64
ci_066                -3.823876e-03 3 1  ON 65
ci_067                -1.192142e-03 3 1  ON 66
ci_068                -1.980533e-03 3 1  ON 67
ci_069                -8.754683e-05 3 1  ON 68
ci_070                 1.094941e-03 3 1  ON 69
ci_071                -1.488370e-03 3 1  ON 70
ci_072                -1.660051e-03 3 1  ON 71
ci_073                 4.652480e-04 3 1  ON 72
ci_074                 1.682271e-04 3 1  ON 73
ci_075                -1.775112e-05 3 1  ON 74
ci_076                 2.113326e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.8376e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORMN2LMC.s005 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORMN2LMC.s005 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=5  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2693e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 5
    time step          = 0.05
    reference energy   = -22.6604
    reference variance = 0.287402
====================================================
  Execution time = 2.6302e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORMN2LMC.s005
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5275e+04
  VMC Eavg = -2.2669e+01
  VMC Evar = 5.1720e-01
  Total weights = 1.954636954e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.7752e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.499479119258
                                         uncertainty =       0.008160296514

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.499479119258
                                         uncertainty =       0.008160296514

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000499673251
  error estimate for blocks of size 2^( 2) =       0.000517822635
  error estimate for blocks of size 2^( 3) =       0.000534044934
  error estimate for blocks of size 2^( 4) =       0.000546384448
  error estimate for blocks of size 2^( 5) =       0.000553832056
  error estimate for blocks of size 2^( 6) =       0.000556231226
  error estimate for blocks of size 2^( 7) =       0.000557241826

      target function =                  N/A
              le_mean =     -22.669278637012
             les_mean =     514.413391816100
             stat err =       0.000553422389
             autocorr =       1.226708140912
              std dev =       0.706644688636
             le_variance =       0.499346715977


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266927863701e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5625e+00, overlap shift 1.5625e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.669278637064       residual = 2.80e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.669287741380       residual = 3.06e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.669288086584       residual = 1.07e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.669288096073       residual = 2.82e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 1.5625e+00 is 2.549162e-04

solving harmonic davidson linear method for identity shift 6.2500e+00, overlap shift 6.2500e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.669278637064       residual = 2.80e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.669281077663       residual = 3.30e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.669281168634       residual = 1.12e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.669281169917       residual = 2.94e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 6.2500e+00 is 6.857523e-05

solving harmonic davidson linear method for identity shift 2.5000e+01, overlap shift 2.5000e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.669278637064       residual = 2.80e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.669279258443       residual = 3.41e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.669279281574       residual = 1.16e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.669279281900       residual = 3.10e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 2.5000e+01 is 1.747642e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.114437 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.1088e+01
  </log>
  <optVariables href="FORMN2LMC.s005.opt.xml">
ci_001                -7.055327e-01 3 1  ON 0
ci_002                -7.048097e-01 3 1  ON 1
ci_003                -4.353277e-02 3 1  ON 2
ci_004                -4.680020e-02 3 1  ON 3
ci_005                 1.784321e-02 3 1  ON 4
ci_006                 1.734968e-02 3 1  ON 5
ci_007                 1.438248e-02 3 1  ON 6
ci_008                 1.432656e-02 3 1  ON 7
ci_009                -1.229318e-02 3 1  ON 8
ci_010                -1.096179e-02 3 1  ON 9
ci_011                -9.351550e-03 3 1  ON 10
ci_012                -9.929923e-03 3 1  ON 11
ci_013                 9.950207e-03 3 1  ON 12
ci_014                 1.043986e-02 3 1  ON 13
ci_015                 1.194561e-02 3 1  ON 14
ci_016                 1.407097e-02 3 1  ON 15
ci_017                 9.943053e-03 3 1  ON 16
ci_018                 1.157328e-02 3 1  ON 17
ci_019                 9.065786e-04 3 1  ON 18
ci_020                 1.495805e-03 3 1  ON 19
ci_021                -7.102706e-03 3 1  ON 20
ci_022                -7.001544e-03 3 1  ON 21
ci_023                 8.047041e-03 3 1  ON 22
ci_024                 7.299319e-03 3 1  ON 23
ci_025                 4.584343e-03 3 1  ON 24
ci_026                 4.167134e-03 3 1  ON 25
ci_027                 6.614779e-03 3 1  ON 26
ci_028                 6.795576e-03 3 1  ON 27
ci_029                -5.267991e-03 3 1  ON 28
ci_030                -5.077173e-03 3 1  ON 29
ci_031                -6.354327e-03 3 1  ON 30
ci_032                -7.605491e-03 3 1  ON 31
ci_033                 3.830761e-03 3 1  ON 32
ci_034                 4.927241e-03 3 1  ON 33
ci_035                 1.481403e-03 3 1  ON 34
ci_036                 1.321891e-03 3 1  ON 35
ci_037                 4.657920e-03 3 1  ON 36
ci_038                 5.660503e-03 3 1  ON 37
ci_039                 4.951289e-03 3 1  ON 38
ci_040                 5.520073e-03 3 1  ON 39
ci_041                 5.549229e-03 3 1  ON 40
ci_042                 5.093303e-03 3 1  ON 41
ci_043                 4.592013e-03 3 1  ON 42
ci_044                 5.286673e-03 3 1  ON 43
ci_045                 5.310905e-03 3 1  ON 44
ci_046                 3.685450e-03 3 1  ON 45
ci_047                -9.368597e-04 3 1  ON 46
ci_048                -1.338865e-03 3 1  ON 47
ci_049                 1.448465e-03 3 1  ON 48
ci_050                 1.164996e-03 3 1  ON 49
ci_051                -2.105406e-03 3 1  ON 50
ci_052                -1.875409e-03 3 1  ON 51
ci_053                -7.665742e-04 3 1  ON 52
ci_054                -3.481425e-03 3 1  ON 53
ci_055                -1.674526e-03 3 1  ON 54
ci_056                -1.201476e-03 3 1  ON 55
ci_057                -1.384561e-03 3 1  ON 56
ci_058                -5.995457e-04 3 1  ON 57
ci_059                -3.526745e-04 3 1  ON 58
ci_060                 3.548996e-05 3 1  ON 59
ci_061                 6.521331e-04 3 1  ON 60
ci_062                -8.956554e-04 3 1  ON 61
ci_063                 3.975173e-04 3 1  ON 62
ci_064                 6.781068e-06 3 1  ON 63
ci_065                -2.332651e-03 3 1  ON 64
ci_066                -3.755300e-03 3 1  ON 65
ci_067                -1.222005e-03 3 1  ON 66
ci_068                -1.981583e-03 3 1  ON 67
ci_069                -6.355917e-05 3 1  ON 68
ci_070                 1.035058e-03 3 1  ON 69
ci_071                -1.525578e-03 3 1  ON 70
ci_072                -1.697302e-03 3 1  ON 71
ci_073                 4.268796e-04 3 1  ON 72
ci_074                 1.264548e-04 3 1  ON 73
ci_075                -4.887832e-05 3 1  ON 74
ci_076                 2.110221e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 5
    time step          = 0.05
    reference energy   = -22.6427
    reference variance = 0.480698
====================================================
  Execution time = 2.5688e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORMN2LMC.s005
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2669e+01
  VMC Evar = 5.1354e-01
  Total weights = 1.9553e+06
  Execution time = 3.6665e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.494172303681
                                         uncertainty =       0.003803886929

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.494172303681
                                         uncertainty =       0.003803886929

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000497001997
  error estimate for blocks of size 2^( 2) =       0.000515680791
  error estimate for blocks of size 2^( 3) =       0.000532751567
  error estimate for blocks of size 2^( 4) =       0.000544820883
  error estimate for blocks of size 2^( 5) =       0.000552030819
  error estimate for blocks of size 2^( 6) =       0.000556160514
  error estimate for blocks of size 2^( 7) =       0.000553792124

      target function =                  N/A
              le_mean =     -22.669182232499
             les_mean =     514.405475912147
             stat err =       0.000551701085
             autocorr =       1.232228954230
              std dev =       0.702866964317
             le_variance =       0.494021969528

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.494162357636
                                         uncertainty =       0.003793625081

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.494162357636
                                         uncertainty =       0.003793625081

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000496996849
  error estimate for blocks of size 2^( 2) =       0.000515675255
  error estimate for blocks of size 2^( 3) =       0.000532740706
  error estimate for blocks of size 2^( 4) =       0.000544802283
  error estimate for blocks of size 2^( 5) =       0.000552006493
  error estimate for blocks of size 2^( 6) =       0.000556127935
  error estimate for blocks of size 2^( 7) =       0.000553755620

      target function =                  N/A
              le_mean =     -22.669181942859
             les_mean =     514.411487666840
             stat err =       0.000551673083
             autocorr =       1.232129393247
              std dev =       0.702859684570
             le_variance =       0.494011736194

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.494170973307
                                         uncertainty =       0.003797858419

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.494170973307
                                         uncertainty =       0.003797858419

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000497001247
  error estimate for blocks of size 2^( 2) =       0.000515679786
  error estimate for blocks of size 2^( 3) =       0.000532747592
  error estimate for blocks of size 2^( 4) =       0.000544811577
  error estimate for blocks of size 2^( 5) =       0.000552018059
  error estimate for blocks of size 2^( 6) =       0.000556148562
  error estimate for blocks of size 2^( 7) =       0.000553787571

      target function =                  N/A
              le_mean =     -22.669184288411
             les_mean =     515.023200954759
             stat err =       0.000551691442
             autocorr =       1.232189594910
              std dev =       0.702865904459
             le_variance =       0.494020479651

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.494170492927
                                         uncertainty =       0.003803062408

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.494170492927
                                         uncertainty =       0.003803062408

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000497001077
  error estimate for blocks of size 2^( 2) =       0.000515679834
  error estimate for blocks of size 2^( 3) =       0.000532750410
  error estimate for blocks of size 2^( 4) =       0.000544819299
  error estimate for blocks of size 2^( 5) =       0.000552028932
  error estimate for blocks of size 2^( 6) =       0.000556158011
  error estimate for blocks of size 2^( 7) =       0.000553789614

      target function =                  N/A
              le_mean =     -22.669182181519
             les_mean =     514.405406954590
             stat err =       0.000551698964
             autocorr =       1.232224036616
              std dev =       0.702865664236
             le_variance =       0.494020141961


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.669182232499        initial
     1.5625e+00     1.5625e+01             2.5492e-04       -22.669181942859
     6.2500e+00     6.2500e+01             6.8575e-05       -22.669184288411  <--
     2.5000e+01     2.5000e+02             1.7476e-05       -22.669182181519

*****************************************************************************
Applying the update for shift_i =   6.2500e+00     and shift_s =   6.2500e+01
*****************************************************************************

  Execution time = 4.4066e+01
  </log>
  <optVariables href="FORMN2LMC.s005.opt.xml">
ci_001                -7.055327e-01 3 1  ON 0
ci_002                -7.048097e-01 3 1  ON 1
ci_003                -4.353277e-02 3 1  ON 2
ci_004                -4.680020e-02 3 1  ON 3
ci_005                 1.784321e-02 3 1  ON 4
ci_006                 1.734968e-02 3 1  ON 5
ci_007                 1.438248e-02 3 1  ON 6
ci_008                 1.432656e-02 3 1  ON 7
ci_009                -1.229318e-02 3 1  ON 8
ci_010                -1.096179e-02 3 1  ON 9
ci_011                -9.351550e-03 3 1  ON 10
ci_012                -9.929923e-03 3 1  ON 11
ci_013                 9.950207e-03 3 1  ON 12
ci_014                 1.043986e-02 3 1  ON 13
ci_015                 1.194561e-02 3 1  ON 14
ci_016                 1.407097e-02 3 1  ON 15
ci_017                 9.943053e-03 3 1  ON 16
ci_018                 1.157328e-02 3 1  ON 17
ci_019                 9.065786e-04 3 1  ON 18
ci_020                 1.495805e-03 3 1  ON 19
ci_021                -7.102706e-03 3 1  ON 20
ci_022                -7.001544e-03 3 1  ON 21
ci_023                 8.047041e-03 3 1  ON 22
ci_024                 7.299319e-03 3 1  ON 23
ci_025                 4.584343e-03 3 1  ON 24
ci_026                 4.167134e-03 3 1  ON 25
ci_027                 6.614779e-03 3 1  ON 26
ci_028                 6.795576e-03 3 1  ON 27
ci_029                -5.267991e-03 3 1  ON 28
ci_030                -5.077173e-03 3 1  ON 29
ci_031                -6.354327e-03 3 1  ON 30
ci_032                -7.605491e-03 3 1  ON 31
ci_033                 3.830761e-03 3 1  ON 32
ci_034                 4.927241e-03 3 1  ON 33
ci_035                 1.481403e-03 3 1  ON 34
ci_036                 1.321891e-03 3 1  ON 35
ci_037                 4.657920e-03 3 1  ON 36
ci_038                 5.660503e-03 3 1  ON 37
ci_039                 4.951289e-03 3 1  ON 38
ci_040                 5.520073e-03 3 1  ON 39
ci_041                 5.549229e-03 3 1  ON 40
ci_042                 5.093303e-03 3 1  ON 41
ci_043                 4.592013e-03 3 1  ON 42
ci_044                 5.286673e-03 3 1  ON 43
ci_045                 5.310905e-03 3 1  ON 44
ci_046                 3.685450e-03 3 1  ON 45
ci_047                -9.368597e-04 3 1  ON 46
ci_048                -1.338865e-03 3 1  ON 47
ci_049                 1.448465e-03 3 1  ON 48
ci_050                 1.164996e-03 3 1  ON 49
ci_051                -2.105406e-03 3 1  ON 50
ci_052                -1.875409e-03 3 1  ON 51
ci_053                -7.665742e-04 3 1  ON 52
ci_054                -3.481425e-03 3 1  ON 53
ci_055                -1.674526e-03 3 1  ON 54
ci_056                -1.201476e-03 3 1  ON 55
ci_057                -1.384561e-03 3 1  ON 56
ci_058                -5.995457e-04 3 1  ON 57
ci_059                -3.526745e-04 3 1  ON 58
ci_060                 3.548996e-05 3 1  ON 59
ci_061                 6.521331e-04 3 1  ON 60
ci_062                -8.956554e-04 3 1  ON 61
ci_063                 3.975173e-04 3 1  ON 62
ci_064                 6.781068e-06 3 1  ON 63
ci_065                -2.332651e-03 3 1  ON 64
ci_066                -3.755300e-03 3 1  ON 65
ci_067                -1.222005e-03 3 1  ON 66
ci_068                -1.981583e-03 3 1  ON 67
ci_069                -6.355917e-05 3 1  ON 68
ci_070                 1.035058e-03 3 1  ON 69
ci_071                -1.525578e-03 3 1  ON 70
ci_072                -1.697302e-03 3 1  ON 71
ci_073                 4.268796e-04 3 1  ON 72
ci_074                 1.264548e-04 3 1  ON 73
ci_075                -4.887832e-05 3 1  ON 74
ci_076                 2.110221e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.5168e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORMN2LMC.s006 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORMN2LMC.s006 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=6  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2686e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 6
    time step          = 0.05
    reference energy   = -22.6248
    reference variance = 0.382398
====================================================
  Execution time = 2.6179e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORMN2LMC.s006
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5253e+04
  VMC Eavg = -2.2669e+01
  VMC Evar = 4.9608e-01
  Total weights = 1.955339170e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.7421e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.483046482094
                                         uncertainty =       0.002106296811

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.483046482094
                                         uncertainty =       0.002106296811

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000491429164
  error estimate for blocks of size 2^( 2) =       0.000510001967
  error estimate for blocks of size 2^( 3) =       0.000527328449
  error estimate for blocks of size 2^( 4) =       0.000539558445
  error estimate for blocks of size 2^( 5) =       0.000545791188
  error estimate for blocks of size 2^( 6) =       0.000548356467
  error estimate for blocks of size 2^( 7) =       0.000552585986

      target function =                  N/A
              le_mean =     -22.669314276324
             les_mean =     514.393893690212
             stat err =       0.000546573021
             autocorr =       1.237013758324
              std dev =       0.694985788749
             le_variance =       0.483005246563


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266931427632e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5625e+00, overlap shift 1.5625e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.669314276421       residual = 2.40e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.669322495433       residual = 3.00e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.669322477308       residual = 7.05e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.669322514502       residual = 2.02e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 1.5625e+00 is 2.574221e-04

solving harmonic davidson linear method for identity shift 6.2500e+00, overlap shift 6.2500e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.669314276421       residual = 2.40e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.669316475796       residual = 3.02e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.669316459865       residual = 7.51e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.669316472043       residual = 2.17e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 6.2500e+00 is 6.792420e-05

solving harmonic davidson linear method for identity shift 2.5000e+01, overlap shift 2.5000e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.669314276421       residual = 2.40e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.669314836113       residual = 3.08e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.669314831434       residual = 7.99e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.669314834665       residual = 2.35e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 2.5000e+01 is 1.722015e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.115754 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0931e+01
  </log>
  <optVariables href="FORMN2LMC.s006.opt.xml">
ci_001                -7.055347e-01 3 1  ON 0
ci_002                -7.048195e-01 3 1  ON 1
ci_003                -4.348083e-02 3 1  ON 2
ci_004                -4.673662e-02 3 1  ON 3
ci_005                 1.780245e-02 3 1  ON 4
ci_006                 1.736515e-02 3 1  ON 5
ci_007                 1.435939e-02 3 1  ON 6
ci_008                 1.429726e-02 3 1  ON 7
ci_009                -1.223463e-02 3 1  ON 8
ci_010                -1.095012e-02 3 1  ON 9
ci_011                -9.323792e-03 3 1  ON 10
ci_012                -9.907885e-03 3 1  ON 11
ci_013                 9.944332e-03 3 1  ON 12
ci_014                 1.041168e-02 3 1  ON 13
ci_015                 1.192046e-02 3 1  ON 14
ci_016                 1.404019e-02 3 1  ON 15
ci_017                 9.966983e-03 3 1  ON 16
ci_018                 1.158015e-02 3 1  ON 17
ci_019                 8.780881e-04 3 1  ON 18
ci_020                 1.427881e-03 3 1  ON 19
ci_021                -7.117264e-03 3 1  ON 20
ci_022                -7.023570e-03 3 1  ON 21
ci_023                 8.076359e-03 3 1  ON 22
ci_024                 7.326497e-03 3 1  ON 23
ci_025                 4.568555e-03 3 1  ON 24
ci_026                 4.199943e-03 3 1  ON 25
ci_027                 6.605615e-03 3 1  ON 26
ci_028                 6.813193e-03 3 1  ON 27
ci_029                -5.280643e-03 3 1  ON 28
ci_030                -5.087202e-03 3 1  ON 29
ci_031                -6.416738e-03 3 1  ON 30
ci_032                -7.630677e-03 3 1  ON 31
ci_033                 3.817151e-03 3 1  ON 32
ci_034                 4.955029e-03 3 1  ON 33
ci_035                 1.450991e-03 3 1  ON 34
ci_036                 1.348897e-03 3 1  ON 35
ci_037                 4.669472e-03 3 1  ON 36
ci_038                 5.643220e-03 3 1  ON 37
ci_039                 4.954521e-03 3 1  ON 38
ci_040                 5.497904e-03 3 1  ON 39
ci_041                 5.522972e-03 3 1  ON 40
ci_042                 5.080967e-03 3 1  ON 41
ci_043                 4.577597e-03 3 1  ON 42
ci_044                 5.256773e-03 3 1  ON 43
ci_045                 5.267055e-03 3 1  ON 44
ci_046                 3.692440e-03 3 1  ON 45
ci_047                -9.234093e-04 3 1  ON 46
ci_048                -1.336410e-03 3 1  ON 47
ci_049                 1.463448e-03 3 1  ON 48
ci_050                 1.150965e-03 3 1  ON 49
ci_051                -2.068177e-03 3 1  ON 50
ci_052                -1.890414e-03 3 1  ON 51
ci_053                -8.050660e-04 3 1  ON 52
ci_054                -3.443376e-03 3 1  ON 53
ci_055                -1.683254e-03 3 1  ON 54
ci_056                -1.200280e-03 3 1  ON 55
ci_057                -1.364310e-03 3 1  ON 56
ci_058                -6.477632e-04 3 1  ON 57
ci_059                -3.516311e-04 3 1  ON 58
ci_060                 2.506056e-05 3 1  ON 59
ci_061                 6.260964e-04 3 1  ON 60
ci_062                -8.538157e-04 3 1  ON 61
ci_063                 3.546201e-04 3 1  ON 62
ci_064                 2.196363e-05 3 1  ON 63
ci_065                -2.346557e-03 3 1  ON 64
ci_066                -3.697177e-03 3 1  ON 65
ci_067                -1.238519e-03 3 1  ON 66
ci_068                -1.988949e-03 3 1  ON 67
ci_069                -1.036366e-04 3 1  ON 68
ci_070                 9.998746e-04 3 1  ON 69
ci_071                -1.532043e-03 3 1  ON 70
ci_072                -1.717530e-03 3 1  ON 71
ci_073                 4.158150e-04 3 1  ON 72
ci_074                 1.226711e-04 3 1  ON 73
ci_075                -5.177130e-05 3 1  ON 74
ci_076                 1.470322e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 6
    time step          = 0.05
    reference energy   = -22.667
    reference variance = 0.371611
====================================================
  Execution time = 2.5897e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORMN2LMC.s006
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2670e+01
  VMC Evar = 4.9518e-01
  Total weights = 1.9553e+06
  Execution time = 3.6577e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.482836976921
                                         uncertainty =       0.002592628251

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.482836976921
                                         uncertainty =       0.002592628251

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000491359212
  error estimate for blocks of size 2^( 2) =       0.000509689586
  error estimate for blocks of size 2^( 3) =       0.000526711168
  error estimate for blocks of size 2^( 4) =       0.000539201868
  error estimate for blocks of size 2^( 5) =       0.000545120520
  error estimate for blocks of size 2^( 6) =       0.000550422270
  error estimate for blocks of size 2^( 7) =       0.000554201504

      target function =                  N/A
              le_mean =     -22.669585026105
             les_mean =     514.405273158254
             stat err =       0.000547236541
             autocorr =       1.240372054439
              std dev =       0.694886861089
             le_variance =       0.482867749714

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.482834580627
                                         uncertainty =       0.002601725776

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.482834580627
                                         uncertainty =       0.002601725776

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000491357813
  error estimate for blocks of size 2^( 2) =       0.000509687865
  error estimate for blocks of size 2^( 3) =       0.000526708313
  error estimate for blocks of size 2^( 4) =       0.000539198765
  error estimate for blocks of size 2^( 5) =       0.000545118494
  error estimate for blocks of size 2^( 6) =       0.000550415857
  error estimate for blocks of size 2^( 7) =       0.000554195612

      target function =                  N/A
              le_mean =     -22.669584709050
             les_mean =     514.405534944512
             stat err =       0.000547232182
             autocorr =       1.240359358639
              std dev =       0.694884882540
             le_variance =       0.482864999983

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.482833320882
                                         uncertainty =       0.002597391903

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.482833320882
                                         uncertainty =       0.002597391903

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000491357258
  error estimate for blocks of size 2^( 2) =       0.000509687519
  error estimate for blocks of size 2^( 3) =       0.000526708579
  error estimate for blocks of size 2^( 4) =       0.000539199291
  error estimate for blocks of size 2^( 5) =       0.000545118662
  error estimate for blocks of size 2^( 6) =       0.000550418356
  error estimate for blocks of size 2^( 7) =       0.000554197724

      target function =                  N/A
              le_mean =     -22.669584624496
             les_mean =     514.405997972632
             stat err =       0.000547233508
             autocorr =       1.240368171749
              std dev =       0.694884097883
             le_variance =       0.482863909490

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.482836139242
                                         uncertainty =       0.002593210561

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.482836139242
                                         uncertainty =       0.002593210561

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000491358774
  error estimate for blocks of size 2^( 2) =       0.000509689136
  error estimate for blocks of size 2^( 3) =       0.000526710653
  error estimate for blocks of size 2^( 4) =       0.000539201371
  error estimate for blocks of size 2^( 5) =       0.000545120105
  error estimate for blocks of size 2^( 6) =       0.000550421550
  error estimate for blocks of size 2^( 7) =       0.000554200794

      target function =                  N/A
              le_mean =     -22.669584930867
             les_mean =     514.405257935814
             stat err =       0.000547235955
             autocorr =       1.240371610244
              std dev =       0.694886241803
             le_variance =       0.482866889047


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.669585026105        initial  <--
     1.5625e+00     1.5625e+01             2.5742e-04       -22.669584709050
     6.2500e+00     6.2500e+01             6.7924e-05       -22.669584624496
     2.5000e+01     2.5000e+02             1.7220e-05       -22.669584930867

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 44.2145
  </log>
  <optVariables href="FORMN2LMC.s006.opt.xml">
ci_001                -7.055327e-01 3 1  ON 0
ci_002                -7.048097e-01 3 1  ON 1
ci_003                -4.353277e-02 3 1  ON 2
ci_004                -4.680020e-02 3 1  ON 3
ci_005                 1.784321e-02 3 1  ON 4
ci_006                 1.734968e-02 3 1  ON 5
ci_007                 1.438248e-02 3 1  ON 6
ci_008                 1.432656e-02 3 1  ON 7
ci_009                -1.229318e-02 3 1  ON 8
ci_010                -1.096179e-02 3 1  ON 9
ci_011                -9.351550e-03 3 1  ON 10
ci_012                -9.929923e-03 3 1  ON 11
ci_013                 9.950207e-03 3 1  ON 12
ci_014                 1.043986e-02 3 1  ON 13
ci_015                 1.194561e-02 3 1  ON 14
ci_016                 1.407097e-02 3 1  ON 15
ci_017                 9.943053e-03 3 1  ON 16
ci_018                 1.157328e-02 3 1  ON 17
ci_019                 9.065786e-04 3 1  ON 18
ci_020                 1.495805e-03 3 1  ON 19
ci_021                -7.102706e-03 3 1  ON 20
ci_022                -7.001544e-03 3 1  ON 21
ci_023                 8.047041e-03 3 1  ON 22
ci_024                 7.299319e-03 3 1  ON 23
ci_025                 4.584343e-03 3 1  ON 24
ci_026                 4.167134e-03 3 1  ON 25
ci_027                 6.614779e-03 3 1  ON 26
ci_028                 6.795576e-03 3 1  ON 27
ci_029                -5.267991e-03 3 1  ON 28
ci_030                -5.077173e-03 3 1  ON 29
ci_031                -6.354327e-03 3 1  ON 30
ci_032                -7.605491e-03 3 1  ON 31
ci_033                 3.830761e-03 3 1  ON 32
ci_034                 4.927241e-03 3 1  ON 33
ci_035                 1.481403e-03 3 1  ON 34
ci_036                 1.321891e-03 3 1  ON 35
ci_037                 4.657920e-03 3 1  ON 36
ci_038                 5.660503e-03 3 1  ON 37
ci_039                 4.951289e-03 3 1  ON 38
ci_040                 5.520073e-03 3 1  ON 39
ci_041                 5.549229e-03 3 1  ON 40
ci_042                 5.093303e-03 3 1  ON 41
ci_043                 4.592013e-03 3 1  ON 42
ci_044                 5.286673e-03 3 1  ON 43
ci_045                 5.310905e-03 3 1  ON 44
ci_046                 3.685450e-03 3 1  ON 45
ci_047                -9.368597e-04 3 1  ON 46
ci_048                -1.338865e-03 3 1  ON 47
ci_049                 1.448465e-03 3 1  ON 48
ci_050                 1.164996e-03 3 1  ON 49
ci_051                -2.105406e-03 3 1  ON 50
ci_052                -1.875409e-03 3 1  ON 51
ci_053                -7.665742e-04 3 1  ON 52
ci_054                -3.481425e-03 3 1  ON 53
ci_055                -1.674526e-03 3 1  ON 54
ci_056                -1.201476e-03 3 1  ON 55
ci_057                -1.384561e-03 3 1  ON 56
ci_058                -5.995457e-04 3 1  ON 57
ci_059                -3.526745e-04 3 1  ON 58
ci_060                 3.548996e-05 3 1  ON 59
ci_061                 6.521331e-04 3 1  ON 60
ci_062                -8.956554e-04 3 1  ON 61
ci_063                 3.975173e-04 3 1  ON 62
ci_064                 6.781068e-06 3 1  ON 63
ci_065                -2.332651e-03 3 1  ON 64
ci_066                -3.755300e-03 3 1  ON 65
ci_067                -1.222005e-03 3 1  ON 66
ci_068                -1.981583e-03 3 1  ON 67
ci_069                -6.355917e-05 3 1  ON 68
ci_070                 1.035058e-03 3 1  ON 69
ci_071                -1.525578e-03 3 1  ON 70
ci_072                -1.697302e-03 3 1  ON 71
ci_073                 4.268796e-04 3 1  ON 72
ci_074                 1.264548e-04 3 1  ON 73
ci_075                -4.887832e-05 3 1  ON 74
ci_076                 2.110221e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.5151e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORMN2LMC.s007 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORMN2LMC.s007 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=7  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2680e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 7
    time step          = 0.05
    reference energy   = -22.6487
    reference variance = 0.35234
====================================================
  Execution time = 2.6320e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORMN2LMC.s007
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5292e+04
  VMC Eavg = -2.2669e+01
  VMC Evar = 5.0070e-01
  Total weights = 1.954665559e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.7941e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.488193728807
                                         uncertainty =       0.003103067134

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.488193728807
                                         uncertainty =       0.003103067134

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000493982171
  error estimate for blocks of size 2^( 2) =       0.000512753904
  error estimate for blocks of size 2^( 3) =       0.000529186310
  error estimate for blocks of size 2^( 4) =       0.000541192144
  error estimate for blocks of size 2^( 5) =       0.000549033693
  error estimate for blocks of size 2^( 6) =       0.000554329419
  error estimate for blocks of size 2^( 7) =       0.000555880368

      target function =                  N/A
              le_mean =     -22.668836308376
             les_mean =     514.376835055125
             stat err =       0.000550108906
             autocorr =       1.240151671669
              std dev =       0.698596286105
             le_variance =       0.488036770960


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266883630838e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5625e+01, overlap shift 1.5625e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.668836308457       residual = 2.13e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.668836874805       residual = 2.53e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.668836878512       residual = 7.77e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.668836884527       residual = 2.08e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 1.5625e+01 is 2.915273e-05

solving harmonic davidson linear method for identity shift 6.2500e+01, overlap shift 6.2500e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.668836308457       residual = 2.13e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.668836451051       residual = 2.59e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.668836451848       residual = 7.97e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.668836453414       residual = 2.15e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 6.2500e+01 is 7.308386e-06

solving harmonic davidson linear method for identity shift 2.5000e+02, overlap shift 2.5000e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.668836308457       residual = 2.13e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.668836344169       residual = 2.61e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.668836344360       residual = 8.03e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.668836344755       residual = 2.17e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 2.5000e+02 is 1.828367e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.117088 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.1124e+01
  </log>
  <optVariables href="FORMN2LMC.s007.opt.xml">
ci_001                -7.055339e-01 3 1  ON 0
ci_002                -7.048096e-01 3 1  ON 1
ci_003                -4.352637e-02 3 1  ON 2
ci_004                -4.679289e-02 3 1  ON 3
ci_005                 1.784201e-02 3 1  ON 4
ci_006                 1.734992e-02 3 1  ON 5
ci_007                 1.437874e-02 3 1  ON 6
ci_008                 1.432591e-02 3 1  ON 7
ci_009                -1.229289e-02 3 1  ON 8
ci_010                -1.096281e-02 3 1  ON 9
ci_011                -9.355452e-03 3 1  ON 10
ci_012                -9.925207e-03 3 1  ON 11
ci_013                 9.952234e-03 3 1  ON 12
ci_014                 1.043785e-02 3 1  ON 13
ci_015                 1.194234e-02 3 1  ON 14
ci_016                 1.407020e-02 3 1  ON 15
ci_017                 9.942081e-03 3 1  ON 16
ci_018                 1.157337e-02 3 1  ON 17
ci_019                 9.039540e-04 3 1  ON 18
ci_020                 1.492358e-03 3 1  ON 19
ci_021                -7.103789e-03 3 1  ON 20
ci_022                -7.006560e-03 3 1  ON 21
ci_023                 8.047544e-03 3 1  ON 22
ci_024                 7.299633e-03 3 1  ON 23
ci_025                 4.584152e-03 3 1  ON 24
ci_026                 4.164391e-03 3 1  ON 25
ci_027                 6.619217e-03 3 1  ON 26
ci_028                 6.796611e-03 3 1  ON 27
ci_029                -5.265725e-03 3 1  ON 28
ci_030                -5.074795e-03 3 1  ON 29
ci_031                -6.354523e-03 3 1  ON 30
ci_032                -7.602015e-03 3 1  ON 31
ci_033                 3.830899e-03 3 1  ON 32
ci_034                 4.924060e-03 3 1  ON 33
ci_035                 1.477909e-03 3 1  ON 34
ci_036                 1.322789e-03 3 1  ON 35
ci_037                 4.658951e-03 3 1  ON 36
ci_038                 5.659776e-03 3 1  ON 37
ci_039                 4.951952e-03 3 1  ON 38
ci_040                 5.523879e-03 3 1  ON 39
ci_041                 5.549463e-03 3 1  ON 40
ci_042                 5.093370e-03 3 1  ON 41
ci_043                 4.595266e-03 3 1  ON 42
ci_044                 5.290577e-03 3 1  ON 43
ci_045                 5.308982e-03 3 1  ON 44
ci_046                 3.684632e-03 3 1  ON 45
ci_047                -9.350226e-04 3 1  ON 46
ci_048                -1.333960e-03 3 1  ON 47
ci_049                 1.444987e-03 3 1  ON 48
ci_050                 1.165259e-03 3 1  ON 49
ci_051                -2.105674e-03 3 1  ON 50
ci_052                -1.875598e-03 3 1  ON 51
ci_053                -7.715732e-04 3 1  ON 52
ci_054                -3.475975e-03 3 1  ON 53
ci_055                -1.676634e-03 3 1  ON 54
ci_056                -1.199958e-03 3 1  ON 55
ci_057                -1.382344e-03 3 1  ON 56
ci_058                -6.028003e-04 3 1  ON 57
ci_059                -3.501797e-04 3 1  ON 58
ci_060                 3.508260e-05 3 1  ON 59
ci_061                 6.504323e-04 3 1  ON 60
ci_062                -8.937705e-04 3 1  ON 61
ci_063                 3.955034e-04 3 1  ON 62
ci_064                 4.265723e-06 3 1  ON 63
ci_065                -2.331608e-03 3 1  ON 64
ci_066                -3.749547e-03 3 1  ON 65
ci_067                -1.226591e-03 3 1  ON 66
ci_068                -1.983012e-03 3 1  ON 67
ci_069                -6.747937e-05 3 1  ON 68
ci_070                 1.035691e-03 3 1  ON 69
ci_071                -1.527220e-03 3 1  ON 70
ci_072                -1.701592e-03 3 1  ON 71
ci_073                 4.261644e-04 3 1  ON 72
ci_074                 1.293830e-04 3 1  ON 73
ci_075                -5.193913e-05 3 1  ON 74
ci_076                 2.105654e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 7
    time step          = 0.05
    reference energy   = -22.7079
    reference variance = 0.359944
====================================================
  Execution time = 2.5680e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORMN2LMC.s007
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2669e+01
  VMC Evar = 4.9874e-01
  Total weights = 1.9551e+06
  Execution time = 3.6370e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.488858000512
                                         uncertainty =       0.003742983598

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.488858000512
                                         uncertainty =       0.003742983598

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000494385364
  error estimate for blocks of size 2^( 2) =       0.000512682517
  error estimate for blocks of size 2^( 3) =       0.000529359492
  error estimate for blocks of size 2^( 4) =       0.000541746566
  error estimate for blocks of size 2^( 5) =       0.000547993334
  error estimate for blocks of size 2^( 6) =       0.000550203636
  error estimate for blocks of size 2^( 7) =       0.000552463407

      target function =                  N/A
              le_mean =     -22.669139481491
             les_mean =     514.388614584969
             stat err =       0.000548101736
             autocorr =       1.229111112273
              std dev =       0.699166486152
             le_variance =       0.488833775358

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.488859464931
                                         uncertainty =       0.003746582952

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.488859464931
                                         uncertainty =       0.003746582952

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000494386094
  error estimate for blocks of size 2^( 2) =       0.000512683127
  error estimate for blocks of size 2^( 3) =       0.000529360152
  error estimate for blocks of size 2^( 4) =       0.000541746674
  error estimate for blocks of size 2^( 5) =       0.000547993718
  error estimate for blocks of size 2^( 6) =       0.000550204264
  error estimate for blocks of size 2^( 7) =       0.000552463743

      target function =                  N/A
              le_mean =     -22.669139439623
             les_mean =     514.388645195869
             stat err =       0.000548102100
             autocorr =       1.229109114896
              std dev =       0.699167518547
             le_variance =       0.488835218991

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.488858715149
                                         uncertainty =       0.003744797647

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.488858715149
                                         uncertainty =       0.003744797647

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000494385720
  error estimate for blocks of size 2^( 2) =       0.000512682813
  error estimate for blocks of size 2^( 3) =       0.000529359813
  error estimate for blocks of size 2^( 4) =       0.000541746608
  error estimate for blocks of size 2^( 5) =       0.000547993515
  error estimate for blocks of size 2^( 6) =       0.000550203945
  error estimate for blocks of size 2^( 7) =       0.000552463567

      target function =                  N/A
              le_mean =     -22.669139456389
             les_mean =     514.388627451475
             stat err =       0.000548101909
             autocorr =       1.229110118912
              std dev =       0.699166989723
             le_variance =       0.488834479519

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.488858087119
                                         uncertainty =       0.003743210690

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.488858087119
                                         uncertainty =       0.003743210690

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000494385407
  error estimate for blocks of size 2^( 2) =       0.000512682553
  error estimate for blocks of size 2^( 3) =       0.000529359531
  error estimate for blocks of size 2^( 4) =       0.000541746570
  error estimate for blocks of size 2^( 5) =       0.000547993355
  error estimate for blocks of size 2^( 6) =       0.000550203674
  error estimate for blocks of size 2^( 7) =       0.000552463425

      target function =                  N/A
              le_mean =     -22.669139477930
             les_mean =     514.388615994753
             stat err =       0.000548101756
             autocorr =       1.229110989309
              std dev =       0.699166547150
             le_variance =       0.488833860653


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.669139481491        initial  <--
     1.5625e+01     1.5625e+02             2.9153e-05       -22.669139439623
     6.2500e+01     6.2500e+02             7.3084e-06       -22.669139456389
     2.5000e+02     2.5000e+03             1.8284e-06       -22.669139477930

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 43.9436
  </log>
  <optVariables href="FORMN2LMC.s007.opt.xml">
ci_001                -7.055327e-01 3 1  ON 0
ci_002                -7.048097e-01 3 1  ON 1
ci_003                -4.353277e-02 3 1  ON 2
ci_004                -4.680020e-02 3 1  ON 3
ci_005                 1.784321e-02 3 1  ON 4
ci_006                 1.734968e-02 3 1  ON 5
ci_007                 1.438248e-02 3 1  ON 6
ci_008                 1.432656e-02 3 1  ON 7
ci_009                -1.229318e-02 3 1  ON 8
ci_010                -1.096179e-02 3 1  ON 9
ci_011                -9.351550e-03 3 1  ON 10
ci_012                -9.929923e-03 3 1  ON 11
ci_013                 9.950207e-03 3 1  ON 12
ci_014                 1.043986e-02 3 1  ON 13
ci_015                 1.194561e-02 3 1  ON 14
ci_016                 1.407097e-02 3 1  ON 15
ci_017                 9.943053e-03 3 1  ON 16
ci_018                 1.157328e-02 3 1  ON 17
ci_019                 9.065786e-04 3 1  ON 18
ci_020                 1.495805e-03 3 1  ON 19
ci_021                -7.102706e-03 3 1  ON 20
ci_022                -7.001544e-03 3 1  ON 21
ci_023                 8.047041e-03 3 1  ON 22
ci_024                 7.299319e-03 3 1  ON 23
ci_025                 4.584343e-03 3 1  ON 24
ci_026                 4.167134e-03 3 1  ON 25
ci_027                 6.614779e-03 3 1  ON 26
ci_028                 6.795576e-03 3 1  ON 27
ci_029                -5.267991e-03 3 1  ON 28
ci_030                -5.077173e-03 3 1  ON 29
ci_031                -6.354327e-03 3 1  ON 30
ci_032                -7.605491e-03 3 1  ON 31
ci_033                 3.830761e-03 3 1  ON 32
ci_034                 4.927241e-03 3 1  ON 33
ci_035                 1.481403e-03 3 1  ON 34
ci_036                 1.321891e-03 3 1  ON 35
ci_037                 4.657920e-03 3 1  ON 36
ci_038                 5.660503e-03 3 1  ON 37
ci_039                 4.951289e-03 3 1  ON 38
ci_040                 5.520073e-03 3 1  ON 39
ci_041                 5.549229e-03 3 1  ON 40
ci_042                 5.093303e-03 3 1  ON 41
ci_043                 4.592013e-03 3 1  ON 42
ci_044                 5.286673e-03 3 1  ON 43
ci_045                 5.310905e-03 3 1  ON 44
ci_046                 3.685450e-03 3 1  ON 45
ci_047                -9.368597e-04 3 1  ON 46
ci_048                -1.338865e-03 3 1  ON 47
ci_049                 1.448465e-03 3 1  ON 48
ci_050                 1.164996e-03 3 1  ON 49
ci_051                -2.105406e-03 3 1  ON 50
ci_052                -1.875409e-03 3 1  ON 51
ci_053                -7.665742e-04 3 1  ON 52
ci_054                -3.481425e-03 3 1  ON 53
ci_055                -1.674526e-03 3 1  ON 54
ci_056                -1.201476e-03 3 1  ON 55
ci_057                -1.384561e-03 3 1  ON 56
ci_058                -5.995457e-04 3 1  ON 57
ci_059                -3.526745e-04 3 1  ON 58
ci_060                 3.548996e-05 3 1  ON 59
ci_061                 6.521331e-04 3 1  ON 60
ci_062                -8.956554e-04 3 1  ON 61
ci_063                 3.975173e-04 3 1  ON 62
ci_064                 6.781068e-06 3 1  ON 63
ci_065                -2.332651e-03 3 1  ON 64
ci_066                -3.755300e-03 3 1  ON 65
ci_067                -1.222005e-03 3 1  ON 66
ci_068                -1.981583e-03 3 1  ON 67
ci_069                -6.355917e-05 3 1  ON 68
ci_070                 1.035058e-03 3 1  ON 69
ci_071                -1.525578e-03 3 1  ON 70
ci_072                -1.697302e-03 3 1  ON 71
ci_073                 4.268796e-04 3 1  ON 72
ci_074                 1.264548e-04 3 1  ON 73
ci_075                -4.887832e-05 3 1  ON 74
ci_076                 2.110221e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.5073e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORMN2LMC.s008 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORMN2LMC.s008 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=8  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2680e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 8
    time step          = 0.05
    reference energy   = -22.6203
    reference variance = 0.453326
====================================================
  Execution time = 2.6260e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORMN2LMC.s008
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5261e+04
  VMC Eavg = -2.2669e+01
  VMC Evar = 4.9769e-01
  Total weights = 1.954648805e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.7720e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.485131777609
                                         uncertainty =       0.003070534960

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.485131777609
                                         uncertainty =       0.003070534960

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000492517032
  error estimate for blocks of size 2^( 2) =       0.000511577412
  error estimate for blocks of size 2^( 3) =       0.000528408548
  error estimate for blocks of size 2^( 4) =       0.000540865929
  error estimate for blocks of size 2^( 5) =       0.000547364351
  error estimate for blocks of size 2^( 6) =       0.000549875362
  error estimate for blocks of size 2^( 7) =       0.000551227094

      target function =                  N/A
              le_mean =     -22.668707463918
             les_mean =     514.367987448042
             stat err =       0.000547333184
             autocorr =       1.234983203958
              std dev =       0.696524266769
             le_variance =       0.485146054198


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266870746392e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5625e+02, overlap shift 1.5625e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.668707463994       residual = 2.75e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.668707562226       residual = 3.83e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.668707561012       residual = 9.46e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.668707560508       residual = 2.95e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 1.5625e+02 is 3.150377e-06

solving harmonic davidson linear method for identity shift 6.2500e+02, overlap shift 6.2500e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.668707463994       residual = 2.75e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.668707488571       residual = 3.83e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.668707488268       residual = 9.49e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.668707488142       residual = 2.96e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 6.2500e+02 is 7.882742e-07

solving harmonic davidson linear method for identity shift 2.5000e+03, overlap shift 2.5000e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.668707463994       residual = 2.75e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.668707470139       residual = 3.83e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.668707470063       residual = 9.50e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.668707470031       residual = 2.96e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 2.5000e+03 is 1.971111e-07

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.118429 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.1042e+01
  </log>
  <optVariables href="FORMN2LMC.s008.opt.xml">
ci_001                -7.055325e-01 3 1  ON 0
ci_002                -7.048101e-01 3 1  ON 1
ci_003                -4.353252e-02 3 1  ON 2
ci_004                -4.679959e-02 3 1  ON 3
ci_005                 1.784256e-02 3 1  ON 4
ci_006                 1.734970e-02 3 1  ON 5
ci_007                 1.438236e-02 3 1  ON 6
ci_008                 1.432611e-02 3 1  ON 7
ci_009                -1.229282e-02 3 1  ON 8
ci_010                -1.096198e-02 3 1  ON 9
ci_011                -9.351623e-03 3 1  ON 10
ci_012                -9.929782e-03 3 1  ON 11
ci_013                 9.949760e-03 3 1  ON 12
ci_014                 1.043952e-02 3 1  ON 13
ci_015                 1.194602e-02 3 1  ON 14
ci_016                 1.407078e-02 3 1  ON 15
ci_017                 9.942964e-03 3 1  ON 16
ci_018                 1.157330e-02 3 1  ON 17
ci_019                 9.064372e-04 3 1  ON 18
ci_020                 1.495233e-03 3 1  ON 19
ci_021                -7.102765e-03 3 1  ON 20
ci_022                -7.001445e-03 3 1  ON 21
ci_023                 8.046675e-03 3 1  ON 22
ci_024                 7.299692e-03 3 1  ON 23
ci_025                 4.584133e-03 3 1  ON 24
ci_026                 4.167044e-03 3 1  ON 25
ci_027                 6.614981e-03 3 1  ON 26
ci_028                 6.795374e-03 3 1  ON 27
ci_029                -5.267869e-03 3 1  ON 28
ci_030                -5.076925e-03 3 1  ON 29
ci_031                -6.354604e-03 3 1  ON 30
ci_032                -7.605313e-03 3 1  ON 31
ci_033                 3.830874e-03 3 1  ON 32
ci_034                 4.926999e-03 3 1  ON 33
ci_035                 1.481360e-03 3 1  ON 34
ci_036                 1.321840e-03 3 1  ON 35
ci_037                 4.658617e-03 3 1  ON 36
ci_038                 5.660136e-03 3 1  ON 37
ci_039                 4.951858e-03 3 1  ON 38
ci_040                 5.519804e-03 3 1  ON 39
ci_041                 5.549000e-03 3 1  ON 40
ci_042                 5.093236e-03 3 1  ON 41
ci_043                 4.591773e-03 3 1  ON 42
ci_044                 5.286466e-03 3 1  ON 43
ci_045                 5.310367e-03 3 1  ON 44
ci_046                 3.685325e-03 3 1  ON 45
ci_047                -9.367385e-04 3 1  ON 46
ci_048                -1.338436e-03 3 1  ON 47
ci_049                 1.448335e-03 3 1  ON 48
ci_050                 1.165003e-03 3 1  ON 49
ci_051                -2.105409e-03 3 1  ON 50
ci_052                -1.875542e-03 3 1  ON 51
ci_053                -7.669490e-04 3 1  ON 52
ci_054                -3.481002e-03 3 1  ON 53
ci_055                -1.674595e-03 3 1  ON 54
ci_056                -1.201996e-03 3 1  ON 55
ci_057                -1.384739e-03 3 1  ON 56
ci_058                -6.003340e-04 3 1  ON 57
ci_059                -3.521696e-04 3 1  ON 58
ci_060                 3.518425e-05 3 1  ON 59
ci_061                 6.513942e-04 3 1  ON 60
ci_062                -8.953828e-04 3 1  ON 61
ci_063                 3.970800e-04 3 1  ON 62
ci_064                 6.585997e-06 3 1  ON 63
ci_065                -2.332666e-03 3 1  ON 64
ci_066                -3.754960e-03 3 1  ON 65
ci_067                -1.222548e-03 3 1  ON 66
ci_068                -1.981869e-03 3 1  ON 67
ci_069                -6.342925e-05 3 1  ON 68
ci_070                 1.035117e-03 3 1  ON 69
ci_071                -1.525955e-03 3 1  ON 70
ci_072                -1.697369e-03 3 1  ON 71
ci_073                 4.267416e-04 3 1  ON 72
ci_074                 1.262062e-04 3 1  ON 73
ci_075                -4.898490e-05 3 1  ON 74
ci_076                 2.109474e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 8
    time step          = 0.05
    reference energy   = -22.5687
    reference variance = 0.370086
====================================================
  Execution time = 2.5613e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORMN2LMC.s008
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2669e+01
  VMC Evar = 4.9649e-01
  Total weights = 1.9553e+06
  Execution time = 3.8372e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.485307346127
                                         uncertainty =       0.002965132754

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.485307346127
                                         uncertainty =       0.002965132754

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000492607933
  error estimate for blocks of size 2^( 2) =       0.000511077787
  error estimate for blocks of size 2^( 3) =       0.000527348395
  error estimate for blocks of size 2^( 4) =       0.000539530765
  error estimate for blocks of size 2^( 5) =       0.000546294111
  error estimate for blocks of size 2^( 6) =       0.000550289842
  error estimate for blocks of size 2^( 7) =       0.000551560381

      target function =                  N/A
              le_mean =     -22.669416941261
             les_mean =     514.398955743647
             stat err =       0.000546918775
             autocorr =       1.232658746635
              std dev =       0.696652819378
             le_variance =       0.485325150747

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.485306426828
                                         uncertainty =       0.002965063992

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.485306426828
                                         uncertainty =       0.002965063992

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000492607468
  error estimate for blocks of size 2^( 2) =       0.000511077360
  error estimate for blocks of size 2^( 3) =       0.000527348004
  error estimate for blocks of size 2^( 4) =       0.000539530383
  error estimate for blocks of size 2^( 5) =       0.000546293749
  error estimate for blocks of size 2^( 6) =       0.000550289571
  error estimate for blocks of size 2^( 7) =       0.000551560182

      target function =                  N/A
              le_mean =     -22.669416920990
             les_mean =     514.398953254840
             stat err =       0.000546918471
             autocorr =       1.232659704212
              std dev =       0.696652162577
             le_variance =       0.485324235623

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.485306885682
                                         uncertainty =       0.002965098319

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.485306885682
                                         uncertainty =       0.002965098319

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000492607700
  error estimate for blocks of size 2^( 2) =       0.000511077573
  error estimate for blocks of size 2^( 3) =       0.000527348199
  error estimate for blocks of size 2^( 4) =       0.000539530574
  error estimate for blocks of size 2^( 5) =       0.000546293929
  error estimate for blocks of size 2^( 6) =       0.000550289706
  error estimate for blocks of size 2^( 7) =       0.000551560281

      target function =                  N/A
              le_mean =     -22.669416931068
             les_mean =     514.398954486655
             stat err =       0.000546918623
             autocorr =       1.232659226066
              std dev =       0.696652490408
             le_variance =       0.485324692392

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.485307288516
                                         uncertainty =       0.002965128447

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.485307288516
                                         uncertainty =       0.002965128447

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000492607904
  error estimate for blocks of size 2^( 2) =       0.000511077760
  error estimate for blocks of size 2^( 3) =       0.000527348371
  error estimate for blocks of size 2^( 4) =       0.000539530741
  error estimate for blocks of size 2^( 5) =       0.000546294088
  error estimate for blocks of size 2^( 6) =       0.000550289825
  error estimate for blocks of size 2^( 7) =       0.000551560368

      target function =                  N/A
              le_mean =     -22.669416939981
             les_mean =     514.398955585187
             stat err =       0.000546918756
             autocorr =       1.232658806594
              std dev =       0.696652778218
             le_variance =       0.485325093398


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.669416941261        initial  <--
     1.5625e+02     1.5625e+03             3.1504e-06       -22.669416920990
     6.2500e+02     6.2500e+03             7.8827e-07       -22.669416931068
     2.5000e+03     2.5000e+04             1.9711e-07       -22.669416939981

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 44.5676
  </log>
  <optVariables href="FORMN2LMC.s008.opt.xml">
ci_001                -7.055327e-01 3 1  ON 0
ci_002                -7.048097e-01 3 1  ON 1
ci_003                -4.353277e-02 3 1  ON 2
ci_004                -4.680020e-02 3 1  ON 3
ci_005                 1.784321e-02 3 1  ON 4
ci_006                 1.734968e-02 3 1  ON 5
ci_007                 1.438248e-02 3 1  ON 6
ci_008                 1.432656e-02 3 1  ON 7
ci_009                -1.229318e-02 3 1  ON 8
ci_010                -1.096179e-02 3 1  ON 9
ci_011                -9.351550e-03 3 1  ON 10
ci_012                -9.929923e-03 3 1  ON 11
ci_013                 9.950207e-03 3 1  ON 12
ci_014                 1.043986e-02 3 1  ON 13
ci_015                 1.194561e-02 3 1  ON 14
ci_016                 1.407097e-02 3 1  ON 15
ci_017                 9.943053e-03 3 1  ON 16
ci_018                 1.157328e-02 3 1  ON 17
ci_019                 9.065786e-04 3 1  ON 18
ci_020                 1.495805e-03 3 1  ON 19
ci_021                -7.102706e-03 3 1  ON 20
ci_022                -7.001544e-03 3 1  ON 21
ci_023                 8.047041e-03 3 1  ON 22
ci_024                 7.299319e-03 3 1  ON 23
ci_025                 4.584343e-03 3 1  ON 24
ci_026                 4.167134e-03 3 1  ON 25
ci_027                 6.614779e-03 3 1  ON 26
ci_028                 6.795576e-03 3 1  ON 27
ci_029                -5.267991e-03 3 1  ON 28
ci_030                -5.077173e-03 3 1  ON 29
ci_031                -6.354327e-03 3 1  ON 30
ci_032                -7.605491e-03 3 1  ON 31
ci_033                 3.830761e-03 3 1  ON 32
ci_034                 4.927241e-03 3 1  ON 33
ci_035                 1.481403e-03 3 1  ON 34
ci_036                 1.321891e-03 3 1  ON 35
ci_037                 4.657920e-03 3 1  ON 36
ci_038                 5.660503e-03 3 1  ON 37
ci_039                 4.951289e-03 3 1  ON 38
ci_040                 5.520073e-03 3 1  ON 39
ci_041                 5.549229e-03 3 1  ON 40
ci_042                 5.093303e-03 3 1  ON 41
ci_043                 4.592013e-03 3 1  ON 42
ci_044                 5.286673e-03 3 1  ON 43
ci_045                 5.310905e-03 3 1  ON 44
ci_046                 3.685450e-03 3 1  ON 45
ci_047                -9.368597e-04 3 1  ON 46
ci_048                -1.338865e-03 3 1  ON 47
ci_049                 1.448465e-03 3 1  ON 48
ci_050                 1.164996e-03 3 1  ON 49
ci_051                -2.105406e-03 3 1  ON 50
ci_052                -1.875409e-03 3 1  ON 51
ci_053                -7.665742e-04 3 1  ON 52
ci_054                -3.481425e-03 3 1  ON 53
ci_055                -1.674526e-03 3 1  ON 54
ci_056                -1.201476e-03 3 1  ON 55
ci_057                -1.384561e-03 3 1  ON 56
ci_058                -5.995457e-04 3 1  ON 57
ci_059                -3.526745e-04 3 1  ON 58
ci_060                 3.548996e-05 3 1  ON 59
ci_061                 6.521331e-04 3 1  ON 60
ci_062                -8.956554e-04 3 1  ON 61
ci_063                 3.975173e-04 3 1  ON 62
ci_064                 6.781068e-06 3 1  ON 63
ci_065                -2.332651e-03 3 1  ON 64
ci_066                -3.755300e-03 3 1  ON 65
ci_067                -1.222005e-03 3 1  ON 66
ci_068                -1.981583e-03 3 1  ON 67
ci_069                -6.355917e-05 3 1  ON 68
ci_070                 1.035058e-03 3 1  ON 69
ci_071                -1.525578e-03 3 1  ON 70
ci_072                -1.697302e-03 3 1  ON 71
ci_073                 4.268796e-04 3 1  ON 72
ci_074                 1.264548e-04 3 1  ON 73
ci_075                -4.887832e-05 3 1  ON 74
ci_076                 2.110221e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.5638e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORMN2LMC.s009 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORMN2LMC.s009 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=9  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2671e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 9
    time step          = 0.05
    reference energy   = -22.6072
    reference variance = 0.312767
====================================================
  Execution time = 2.6300e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORMN2LMC.s009
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5304e+04
  VMC Eavg = -2.2669e+01
  VMC Evar = 4.9559e-01
  Total weights = 1.954683496e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.7866e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.481586344468
                                         uncertainty =       0.002424262315

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.481586344468
                                         uncertainty =       0.002424262315

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000490702027
  error estimate for blocks of size 2^( 2) =       0.000509427975
  error estimate for blocks of size 2^( 3) =       0.000526125901
  error estimate for blocks of size 2^( 4) =       0.000537782809
  error estimate for blocks of size 2^( 5) =       0.000545054924
  error estimate for blocks of size 2^( 6) =       0.000547429483
  error estimate for blocks of size 2^( 7) =       0.000550185984

      target function =                  N/A
              le_mean =     -22.668768351644
             les_mean =     514.368645302448
             stat err =       0.000545113300
             autocorr =       1.234064480431
              std dev =       0.693957461975
             le_variance =       0.481576959030


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266876835164e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5625e+03, overlap shift 1.5625e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.668768351748       residual = 6.03e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.668768362270       residual = 1.20e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.668768363203       residual = 3.84e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.668768363152       residual = 1.28e-08           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.668768363137       residual = 2.12e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          4 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 1.5625e+03 is 4.282108e-07

solving harmonic davidson linear method for identity shift 6.2500e+03, overlap shift 6.2500e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.668768351748       residual = 6.03e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.668768354379       residual = 1.20e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.668768354612       residual = 3.84e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.668768354597       residual = 1.28e-08           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.668768354595       residual = 2.12e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          4 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 6.2500e+03 is 1.070622e-07

solving harmonic davidson linear method for identity shift 2.5000e+04, overlap shift 2.5000e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.668768351748       residual = 6.03e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.668768352406       residual = 1.20e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.668768352464       residual = 3.84e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.668768352457       residual = 1.28e-08           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.668768352464       residual = 2.12e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          4 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 2.5000e+04 is 2.676613e-08

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.120045 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.1097e+01
  </log>
  <optVariables href="FORMN2LMC.s009.opt.xml">
ci_001                -7.055327e-01 3 1  ON 0
ci_002                -7.048098e-01 3 1  ON 1
ci_003                -4.353273e-02 3 1  ON 2
ci_004                -4.680012e-02 3 1  ON 3
ci_005                 1.784315e-02 3 1  ON 4
ci_006                 1.734963e-02 3 1  ON 5
ci_007                 1.438243e-02 3 1  ON 6
ci_008                 1.432653e-02 3 1  ON 7
ci_009                -1.229312e-02 3 1  ON 8
ci_010                -1.096181e-02 3 1  ON 9
ci_011                -9.351517e-03 3 1  ON 10
ci_012                -9.929891e-03 3 1  ON 11
ci_013                 9.950189e-03 3 1  ON 12
ci_014                 1.043984e-02 3 1  ON 13
ci_015                 1.194566e-02 3 1  ON 14
ci_016                 1.407094e-02 3 1  ON 15
ci_017                 9.943096e-03 3 1  ON 16
ci_018                 1.157331e-02 3 1  ON 17
ci_019                 9.065418e-04 3 1  ON 18
ci_020                 1.495734e-03 3 1  ON 19
ci_021                -7.102770e-03 3 1  ON 20
ci_022                -7.001586e-03 3 1  ON 21
ci_023                 8.046964e-03 3 1  ON 22
ci_024                 7.299299e-03 3 1  ON 23
ci_025                 4.584304e-03 3 1  ON 24
ci_026                 4.167130e-03 3 1  ON 25
ci_027                 6.614784e-03 3 1  ON 26
ci_028                 6.795590e-03 3 1  ON 27
ci_029                -5.267942e-03 3 1  ON 28
ci_030                -5.077166e-03 3 1  ON 29
ci_031                -6.354351e-03 3 1  ON 30
ci_032                -7.605533e-03 3 1  ON 31
ci_033                 3.830786e-03 3 1  ON 32
ci_034                 4.927286e-03 3 1  ON 33
ci_035                 1.481380e-03 3 1  ON 34
ci_036                 1.321900e-03 3 1  ON 35
ci_037                 4.657986e-03 3 1  ON 36
ci_038                 5.660510e-03 3 1  ON 37
ci_039                 4.951380e-03 3 1  ON 38
ci_040                 5.520080e-03 3 1  ON 39
ci_041                 5.549170e-03 3 1  ON 40
ci_042                 5.093268e-03 3 1  ON 41
ci_043                 4.592110e-03 3 1  ON 42
ci_044                 5.286679e-03 3 1  ON 43
ci_045                 5.310876e-03 3 1  ON 44
ci_046                 3.685444e-03 3 1  ON 45
ci_047                -9.367749e-04 3 1  ON 46
ci_048                -1.338800e-03 3 1  ON 47
ci_049                 1.448358e-03 3 1  ON 48
ci_050                 1.164943e-03 3 1  ON 49
ci_051                -2.105446e-03 3 1  ON 50
ci_052                -1.875417e-03 3 1  ON 51
ci_053                -7.666546e-04 3 1  ON 52
ci_054                -3.481415e-03 3 1  ON 53
ci_055                -1.674530e-03 3 1  ON 54
ci_056                -1.201437e-03 3 1  ON 55
ci_057                -1.384542e-03 3 1  ON 56
ci_058                -5.995873e-04 3 1  ON 57
ci_059                -3.526905e-04 3 1  ON 58
ci_060                 3.548409e-05 3 1  ON 59
ci_061                 6.521424e-04 3 1  ON 60
ci_062                -8.956216e-04 3 1  ON 61
ci_063                 3.975048e-04 3 1  ON 62
ci_064                 6.785638e-06 3 1  ON 63
ci_065                -2.332601e-03 3 1  ON 64
ci_066                -3.755273e-03 3 1  ON 65
ci_067                -1.222044e-03 3 1  ON 66
ci_068                -1.981623e-03 3 1  ON 67
ci_069                -6.348508e-05 3 1  ON 68
ci_070                 1.035012e-03 3 1  ON 69
ci_071                -1.525588e-03 3 1  ON 70
ci_072                -1.697298e-03 3 1  ON 71
ci_073                 4.267814e-04 3 1  ON 72
ci_074                 1.264364e-04 3 1  ON 73
ci_075                -4.889448e-05 3 1  ON 74
ci_076                 2.109985e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 9
    time step          = 0.05
    reference energy   = -22.6324
    reference variance = 0.701308
====================================================
  Execution time = 2.5762e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORMN2LMC.s009
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2669e+01
  VMC Evar = 4.9923e-01
  Total weights = 1.9551e+06
  Execution time = 3.6738e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.487381346657
                                         uncertainty =       0.003326318375

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.487381346657
                                         uncertainty =       0.003326318375

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000493613806
  error estimate for blocks of size 2^( 2) =       0.000512535808
  error estimate for blocks of size 2^( 3) =       0.000529513331
  error estimate for blocks of size 2^( 4) =       0.000541757065
  error estimate for blocks of size 2^( 5) =       0.000548990921
  error estimate for blocks of size 2^( 6) =       0.000552035204
  error estimate for blocks of size 2^( 7) =       0.000554792131

      target function =                  N/A
              le_mean =     -22.668533239179
             les_mean =     514.361628152065
             stat err =       0.000549393830
             autocorr =       1.238776504836
              std dev =       0.698075338886
             le_variance =       0.487309178761

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.487381246257
                                         uncertainty =       0.003326319074

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.487381246257
                                         uncertainty =       0.003326319074

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000493613756
  error estimate for blocks of size 2^( 2) =       0.000512535760
  error estimate for blocks of size 2^( 3) =       0.000529513283
  error estimate for blocks of size 2^( 4) =       0.000541757014
  error estimate for blocks of size 2^( 5) =       0.000548990872
  error estimate for blocks of size 2^( 6) =       0.000552035160
  error estimate for blocks of size 2^( 7) =       0.000554792107

      target function =                  N/A
              le_mean =     -22.668533233423
             les_mean =     514.361627524996
             stat err =       0.000549393788
             autocorr =       1.238776569442
              std dev =       0.698075267618
             le_variance =       0.487309079260

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.487381296444
                                         uncertainty =       0.003326318724

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.487381296444
                                         uncertainty =       0.003326318724

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000493613781
  error estimate for blocks of size 2^( 2) =       0.000512535784
  error estimate for blocks of size 2^( 3) =       0.000529513307
  error estimate for blocks of size 2^( 4) =       0.000541757040
  error estimate for blocks of size 2^( 5) =       0.000548990897
  error estimate for blocks of size 2^( 6) =       0.000552035182
  error estimate for blocks of size 2^( 7) =       0.000554792119

      target function =                  N/A
              le_mean =     -22.668533236300
             les_mean =     514.361627836447
             stat err =       0.000549393809
             autocorr =       1.238776537149
              std dev =       0.698075303243
             le_variance =       0.487309128997

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.487381340379
                                         uncertainty =       0.003326318419

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.487381340379
                                         uncertainty =       0.003326318419

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000493613803
  error estimate for blocks of size 2^( 2) =       0.000512535805
  error estimate for blocks of size 2^( 3) =       0.000529513328
  error estimate for blocks of size 2^( 4) =       0.000541757062
  error estimate for blocks of size 2^( 5) =       0.000548990918
  error estimate for blocks of size 2^( 6) =       0.000552035201
  error estimate for blocks of size 2^( 7) =       0.000554792130

      target function =                  N/A
              le_mean =     -22.668533238819
             les_mean =     514.361628112383
             stat err =       0.000549393828
             autocorr =       1.238776508883
              std dev =       0.698075334430
             le_variance =       0.487309172539


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.668533239179        initial  <--
     1.5625e+03     1.5625e+04             4.2821e-07       -22.668533233423
     6.2500e+03     6.2500e+04             1.0706e-07       -22.668533236300
     2.5000e+04     2.5000e+05             2.6766e-08       -22.668533238819

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 44.1793
  </log>
  <optVariables href="FORMN2LMC.s009.opt.xml">
ci_001                -7.055327e-01 3 1  ON 0
ci_002                -7.048097e-01 3 1  ON 1
ci_003                -4.353277e-02 3 1  ON 2
ci_004                -4.680020e-02 3 1  ON 3
ci_005                 1.784321e-02 3 1  ON 4
ci_006                 1.734968e-02 3 1  ON 5
ci_007                 1.438248e-02 3 1  ON 6
ci_008                 1.432656e-02 3 1  ON 7
ci_009                -1.229318e-02 3 1  ON 8
ci_010                -1.096179e-02 3 1  ON 9
ci_011                -9.351550e-03 3 1  ON 10
ci_012                -9.929923e-03 3 1  ON 11
ci_013                 9.950207e-03 3 1  ON 12
ci_014                 1.043986e-02 3 1  ON 13
ci_015                 1.194561e-02 3 1  ON 14
ci_016                 1.407097e-02 3 1  ON 15
ci_017                 9.943053e-03 3 1  ON 16
ci_018                 1.157328e-02 3 1  ON 17
ci_019                 9.065786e-04 3 1  ON 18
ci_020                 1.495805e-03 3 1  ON 19
ci_021                -7.102706e-03 3 1  ON 20
ci_022                -7.001544e-03 3 1  ON 21
ci_023                 8.047041e-03 3 1  ON 22
ci_024                 7.299319e-03 3 1  ON 23
ci_025                 4.584343e-03 3 1  ON 24
ci_026                 4.167134e-03 3 1  ON 25
ci_027                 6.614779e-03 3 1  ON 26
ci_028                 6.795576e-03 3 1  ON 27
ci_029                -5.267991e-03 3 1  ON 28
ci_030                -5.077173e-03 3 1  ON 29
ci_031                -6.354327e-03 3 1  ON 30
ci_032                -7.605491e-03 3 1  ON 31
ci_033                 3.830761e-03 3 1  ON 32
ci_034                 4.927241e-03 3 1  ON 33
ci_035                 1.481403e-03 3 1  ON 34
ci_036                 1.321891e-03 3 1  ON 35
ci_037                 4.657920e-03 3 1  ON 36
ci_038                 5.660503e-03 3 1  ON 37
ci_039                 4.951289e-03 3 1  ON 38
ci_040                 5.520073e-03 3 1  ON 39
ci_041                 5.549229e-03 3 1  ON 40
ci_042                 5.093303e-03 3 1  ON 41
ci_043                 4.592013e-03 3 1  ON 42
ci_044                 5.286673e-03 3 1  ON 43
ci_045                 5.310905e-03 3 1  ON 44
ci_046                 3.685450e-03 3 1  ON 45
ci_047                -9.368597e-04 3 1  ON 46
ci_048                -1.338865e-03 3 1  ON 47
ci_049                 1.448465e-03 3 1  ON 48
ci_050                 1.164996e-03 3 1  ON 49
ci_051                -2.105406e-03 3 1  ON 50
ci_052                -1.875409e-03 3 1  ON 51
ci_053                -7.665742e-04 3 1  ON 52
ci_054                -3.481425e-03 3 1  ON 53
ci_055                -1.674526e-03 3 1  ON 54
ci_056                -1.201476e-03 3 1  ON 55
ci_057                -1.384561e-03 3 1  ON 56
ci_058                -5.995457e-04 3 1  ON 57
ci_059                -3.526745e-04 3 1  ON 58
ci_060                 3.548996e-05 3 1  ON 59
ci_061                 6.521331e-04 3 1  ON 60
ci_062                -8.956554e-04 3 1  ON 61
ci_063                 3.975173e-04 3 1  ON 62
ci_064                 6.781068e-06 3 1  ON 63
ci_065                -2.332651e-03 3 1  ON 64
ci_066                -3.755300e-03 3 1  ON 65
ci_067                -1.222005e-03 3 1  ON 66
ci_068                -1.981583e-03 3 1  ON 67
ci_069                -6.355917e-05 3 1  ON 68
ci_070                 1.035058e-03 3 1  ON 69
ci_071                -1.525578e-03 3 1  ON 70
ci_072                -1.697302e-03 3 1  ON 71
ci_073                 4.268796e-04 3 1  ON 72
ci_074                 1.264548e-04 3 1  ON 73
ci_075                -4.887832e-05 3 1  ON 74
ci_076                 2.110221e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.5283e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORMN2LMC.s010 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORMN2LMC.s010 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=10  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2666e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 10
    time step          = 0.05
    reference energy   = -22.7487
    reference variance = 0.477256
====================================================
  Execution time = 2.6186e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORMN2LMC.s010
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5253e+04
  VMC Eavg = -2.2669e+01
  VMC Evar = 4.9709e-01
  Total weights = 1.954978637e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.8349e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.484667630682
                                         uncertainty =       0.002402686677

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.484667630682
                                         uncertainty =       0.002402686677

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000492290584
  error estimate for blocks of size 2^( 2) =       0.000510730971
  error estimate for blocks of size 2^( 3) =       0.000528210179
  error estimate for blocks of size 2^( 4) =       0.000541081432
  error estimate for blocks of size 2^( 5) =       0.000549239365
  error estimate for blocks of size 2^( 6) =       0.000553872359
  error estimate for blocks of size 2^( 7) =       0.000556492346

      target function =                  N/A
              le_mean =     -22.669096792242
             les_mean =     514.385043813638
             stat err =       0.000550171376
             autocorr =       1.248972636335
              std dev =       0.696204020717
             le_variance =       0.484700038462


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266909679224e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5625e+04, overlap shift 1.5625e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.669096792349       residual = 2.27e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.669096793341       residual = 3.01e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.669096793305       residual = 6.16e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.669096793304       residual = 1.85e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 1.5625e+04 is 3.113617e-08

solving harmonic davidson linear method for identity shift 6.2500e+04, overlap shift 6.2500e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.669096792349       residual = 2.27e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.669096792597       residual = 3.01e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.669096792588       residual = 6.16e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.669096792582       residual = 1.85e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 6.2500e+04 is 7.784110e-09

solving harmonic davidson linear method for identity shift 2.5000e+05, overlap shift 2.5000e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.669096792349       residual = 2.27e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.669096792411       residual = 3.01e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.669096792409       residual = 6.16e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.669096792397       residual = 1.85e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 2.5000e+05 is 1.946031e-09

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.121418 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.1031e+01
  </log>
  <optVariables href="FORMN2LMC.s010.opt.xml">
ci_001                -7.055327e-01 3 1  ON 0
ci_002                -7.048097e-01 3 1  ON 1
ci_003                -4.353276e-02 3 1  ON 2
ci_004                -4.680019e-02 3 1  ON 3
ci_005                 1.784320e-02 3 1  ON 4
ci_006                 1.734968e-02 3 1  ON 5
ci_007                 1.438248e-02 3 1  ON 6
ci_008                 1.432656e-02 3 1  ON 7
ci_009                -1.229318e-02 3 1  ON 8
ci_010                -1.096179e-02 3 1  ON 9
ci_011                -9.351550e-03 3 1  ON 10
ci_012                -9.929918e-03 3 1  ON 11
ci_013                 9.950206e-03 3 1  ON 12
ci_014                 1.043986e-02 3 1  ON 13
ci_015                 1.194561e-02 3 1  ON 14
ci_016                 1.407097e-02 3 1  ON 15
ci_017                 9.943057e-03 3 1  ON 16
ci_018                 1.157328e-02 3 1  ON 17
ci_019                 9.065756e-04 3 1  ON 18
ci_020                 1.495804e-03 3 1  ON 19
ci_021                -7.102707e-03 3 1  ON 20
ci_022                -7.001543e-03 3 1  ON 21
ci_023                 8.047044e-03 3 1  ON 22
ci_024                 7.299323e-03 3 1  ON 23
ci_025                 4.584342e-03 3 1  ON 24
ci_026                 4.167134e-03 3 1  ON 25
ci_027                 6.614775e-03 3 1  ON 26
ci_028                 6.795571e-03 3 1  ON 27
ci_029                -5.267987e-03 3 1  ON 28
ci_030                -5.077170e-03 3 1  ON 29
ci_031                -6.354332e-03 3 1  ON 30
ci_032                -7.605489e-03 3 1  ON 31
ci_033                 3.830762e-03 3 1  ON 32
ci_034                 4.927242e-03 3 1  ON 33
ci_035                 1.481402e-03 3 1  ON 34
ci_036                 1.321894e-03 3 1  ON 35
ci_037                 4.657924e-03 3 1  ON 36
ci_038                 5.660504e-03 3 1  ON 37
ci_039                 4.951288e-03 3 1  ON 38
ci_040                 5.520070e-03 3 1  ON 39
ci_041                 5.549228e-03 3 1  ON 40
ci_042                 5.093303e-03 3 1  ON 41
ci_043                 4.592017e-03 3 1  ON 42
ci_044                 5.286673e-03 3 1  ON 43
ci_045                 5.310900e-03 3 1  ON 44
ci_046                 3.685452e-03 3 1  ON 45
ci_047                -9.368591e-04 3 1  ON 46
ci_048                -1.338864e-03 3 1  ON 47
ci_049                 1.448465e-03 3 1  ON 48
ci_050                 1.164999e-03 3 1  ON 49
ci_051                -2.105403e-03 3 1  ON 50
ci_052                -1.875406e-03 3 1  ON 51
ci_053                -7.665770e-04 3 1  ON 52
ci_054                -3.481425e-03 3 1  ON 53
ci_055                -1.674520e-03 3 1  ON 54
ci_056                -1.201480e-03 3 1  ON 55
ci_057                -1.384561e-03 3 1  ON 56
ci_058                -5.995453e-04 3 1  ON 57
ci_059                -3.526702e-04 3 1  ON 58
ci_060                 3.548501e-05 3 1  ON 59
ci_061                 6.521298e-04 3 1  ON 60
ci_062                -8.956583e-04 3 1  ON 61
ci_063                 3.975148e-04 3 1  ON 62
ci_064                 6.782308e-06 3 1  ON 63
ci_065                -2.332649e-03 3 1  ON 64
ci_066                -3.755293e-03 3 1  ON 65
ci_067                -1.222003e-03 3 1  ON 66
ci_068                -1.981586e-03 3 1  ON 67
ci_069                -6.356188e-05 3 1  ON 68
ci_070                 1.035055e-03 3 1  ON 69
ci_071                -1.525580e-03 3 1  ON 70
ci_072                -1.697301e-03 3 1  ON 71
ci_073                 4.268774e-04 3 1  ON 72
ci_074                 1.264549e-04 3 1  ON 73
ci_075                -4.888017e-05 3 1  ON 74
ci_076                 2.110234e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 10
    time step          = 0.05
    reference energy   = -22.7549
    reference variance = 0.443152
====================================================
  Execution time = 2.5560e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORMN2LMC.s010
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2669e+01
  VMC Evar = 5.0292e-01
  Total weights = 1.9553e+06
  Execution time = 3.6465e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.491969765855
                                         uncertainty =       0.006646535721

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.491969765855
                                         uncertainty =       0.006646535721

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000495921439
  error estimate for blocks of size 2^( 2) =       0.000514331475
  error estimate for blocks of size 2^( 3) =       0.000531103585
  error estimate for blocks of size 2^( 4) =       0.000543159403
  error estimate for blocks of size 2^( 5) =       0.000549790358
  error estimate for blocks of size 2^( 6) =       0.000551809595
  error estimate for blocks of size 2^( 7) =       0.000549362437

      target function =                  N/A
              le_mean =     -22.669128264231
             les_mean =     514.392296942597
             stat err =       0.000548530448
             autocorr =       1.223420382278
              std dev =       0.701338825525
             le_variance =       0.491876148189

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.491969764606
                                         uncertainty =       0.006646536713

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.491969764606
                                         uncertainty =       0.006646536713

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000495921439
  error estimate for blocks of size 2^( 2) =       0.000514331475
  error estimate for blocks of size 2^( 3) =       0.000531103585
  error estimate for blocks of size 2^( 4) =       0.000543159403
  error estimate for blocks of size 2^( 5) =       0.000549790357
  error estimate for blocks of size 2^( 6) =       0.000551809594
  error estimate for blocks of size 2^( 7) =       0.000549362437

      target function =                  N/A
              le_mean =     -22.669128264127
             les_mean =     514.392296955673
             stat err =       0.000548530448
             autocorr =       1.223420382866
              std dev =       0.701338824616
             le_variance =       0.491876146914

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.491969765231
                                         uncertainty =       0.006646536217

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.491969765231
                                         uncertainty =       0.006646536217

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000495921439
  error estimate for blocks of size 2^( 2) =       0.000514331475
  error estimate for blocks of size 2^( 3) =       0.000531103585
  error estimate for blocks of size 2^( 4) =       0.000543159403
  error estimate for blocks of size 2^( 5) =       0.000549790357
  error estimate for blocks of size 2^( 6) =       0.000551809594
  error estimate for blocks of size 2^( 7) =       0.000549362437

      target function =                  N/A
              le_mean =     -22.669128264179
             les_mean =     514.392296949125
             stat err =       0.000548530448
             autocorr =       1.223420382565
              std dev =       0.701338825071
             le_variance =       0.491876147551

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.491969765777
                                         uncertainty =       0.006646535783

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.491969765777
                                         uncertainty =       0.006646535783

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000495921439
  error estimate for blocks of size 2^( 2) =       0.000514331475
  error estimate for blocks of size 2^( 3) =       0.000531103585
  error estimate for blocks of size 2^( 4) =       0.000543159403
  error estimate for blocks of size 2^( 5) =       0.000549790358
  error estimate for blocks of size 2^( 6) =       0.000551809595
  error estimate for blocks of size 2^( 7) =       0.000549362437

      target function =                  N/A
              le_mean =     -22.669128264225
             les_mean =     514.392296943412
             stat err =       0.000548530448
             autocorr =       1.223420382306
              std dev =       0.701338825468
             le_variance =       0.491876148109


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.669128264231        initial  <--
     1.5625e+04     1.5625e+05             3.1136e-08       -22.669128264127
     6.2500e+04     6.2500e+05             7.7841e-09       -22.669128264179
     2.5000e+05     2.5000e+06             1.9460e-09       -22.669128264225

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 43.9176
  </log>
  <optVariables href="FORMN2LMC.s010.opt.xml">
ci_001                -7.055327e-01 3 1  ON 0
ci_002                -7.048097e-01 3 1  ON 1
ci_003                -4.353277e-02 3 1  ON 2
ci_004                -4.680020e-02 3 1  ON 3
ci_005                 1.784321e-02 3 1  ON 4
ci_006                 1.734968e-02 3 1  ON 5
ci_007                 1.438248e-02 3 1  ON 6
ci_008                 1.432656e-02 3 1  ON 7
ci_009                -1.229318e-02 3 1  ON 8
ci_010                -1.096179e-02 3 1  ON 9
ci_011                -9.351550e-03 3 1  ON 10
ci_012                -9.929923e-03 3 1  ON 11
ci_013                 9.950207e-03 3 1  ON 12
ci_014                 1.043986e-02 3 1  ON 13
ci_015                 1.194561e-02 3 1  ON 14
ci_016                 1.407097e-02 3 1  ON 15
ci_017                 9.943053e-03 3 1  ON 16
ci_018                 1.157328e-02 3 1  ON 17
ci_019                 9.065786e-04 3 1  ON 18
ci_020                 1.495805e-03 3 1  ON 19
ci_021                -7.102706e-03 3 1  ON 20
ci_022                -7.001544e-03 3 1  ON 21
ci_023                 8.047041e-03 3 1  ON 22
ci_024                 7.299319e-03 3 1  ON 23
ci_025                 4.584343e-03 3 1  ON 24
ci_026                 4.167134e-03 3 1  ON 25
ci_027                 6.614779e-03 3 1  ON 26
ci_028                 6.795576e-03 3 1  ON 27
ci_029                -5.267991e-03 3 1  ON 28
ci_030                -5.077173e-03 3 1  ON 29
ci_031                -6.354327e-03 3 1  ON 30
ci_032                -7.605491e-03 3 1  ON 31
ci_033                 3.830761e-03 3 1  ON 32
ci_034                 4.927241e-03 3 1  ON 33
ci_035                 1.481403e-03 3 1  ON 34
ci_036                 1.321891e-03 3 1  ON 35
ci_037                 4.657920e-03 3 1  ON 36
ci_038                 5.660503e-03 3 1  ON 37
ci_039                 4.951289e-03 3 1  ON 38
ci_040                 5.520073e-03 3 1  ON 39
ci_041                 5.549229e-03 3 1  ON 40
ci_042                 5.093303e-03 3 1  ON 41
ci_043                 4.592013e-03 3 1  ON 42
ci_044                 5.286673e-03 3 1  ON 43
ci_045                 5.310905e-03 3 1  ON 44
ci_046                 3.685450e-03 3 1  ON 45
ci_047                -9.368597e-04 3 1  ON 46
ci_048                -1.338865e-03 3 1  ON 47
ci_049                 1.448465e-03 3 1  ON 48
ci_050                 1.164996e-03 3 1  ON 49
ci_051                -2.105406e-03 3 1  ON 50
ci_052                -1.875409e-03 3 1  ON 51
ci_053                -7.665742e-04 3 1  ON 52
ci_054                -3.481425e-03 3 1  ON 53
ci_055                -1.674526e-03 3 1  ON 54
ci_056                -1.201476e-03 3 1  ON 55
ci_057                -1.384561e-03 3 1  ON 56
ci_058                -5.995457e-04 3 1  ON 57
ci_059                -3.526745e-04 3 1  ON 58
ci_060                 3.548996e-05 3 1  ON 59
ci_061                 6.521331e-04 3 1  ON 60
ci_062                -8.956554e-04 3 1  ON 61
ci_063                 3.975173e-04 3 1  ON 62
ci_064                 6.781068e-06 3 1  ON 63
ci_065                -2.332651e-03 3 1  ON 64
ci_066                -3.755300e-03 3 1  ON 65
ci_067                -1.222005e-03 3 1  ON 66
ci_068                -1.981583e-03 3 1  ON 67
ci_069                -6.355917e-05 3 1  ON 68
ci_070                 1.035058e-03 3 1  ON 69
ci_071                -1.525578e-03 3 1  ON 70
ci_072                -1.697302e-03 3 1  ON 71
ci_073                 4.268796e-04 3 1  ON 72
ci_074                 1.264548e-04 3 1  ON 73
ci_075                -4.887832e-05 3 1  ON 74
ci_076                 2.110221e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.4954e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORMN2LMC.s011 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORMN2LMC.s011 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=11  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2673e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 11
    time step          = 0.05
    reference energy   = -22.6076
    reference variance = 0.359357
====================================================
  Execution time = 2.6240e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORMN2LMC.s011
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5272e+04
  VMC Eavg = -2.2668e+01
  VMC Evar = 5.0307e-01
  Total weights = 1.955019970e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.7563e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.486596086787
                                         uncertainty =       0.003337911186

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.486596086787
                                         uncertainty =       0.003337911186

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000493311150
  error estimate for blocks of size 2^( 2) =       0.000511580239
  error estimate for blocks of size 2^( 3) =       0.000528032271
  error estimate for blocks of size 2^( 4) =       0.000540373383
  error estimate for blocks of size 2^( 5) =       0.000546559140
  error estimate for blocks of size 2^( 6) =       0.000550661945
  error estimate for blocks of size 2^( 7) =       0.000555708168

      target function =                  N/A
              le_mean =     -22.668394957989
             les_mean =     514.359204178139
             stat err =       0.000548325659
             autocorr =       1.235478734447
              std dev =       0.697647319176
             le_variance =       0.486711781954


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266839495799e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5625e+05, overlap shift 1.5625e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.668394958054       residual = 4.78e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.668394958182       residual = 6.83e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.668394958187       residual = 2.29e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.668394958186       residual = 5.53e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 1.5625e+05 is 4.334902e-09

solving harmonic davidson linear method for identity shift 6.2500e+05, overlap shift 6.2500e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.668394958054       residual = 4.78e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.668394958086       residual = 6.83e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.668394958087       residual = 2.29e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.668394958087       residual = 5.53e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 6.2500e+05 is 1.083726e-09

solving harmonic davidson linear method for identity shift 2.5000e+06, overlap shift 2.5000e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.668394958054       residual = 4.78e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.668394958062       residual = 6.83e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.668394958062       residual = 2.29e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.668394958250       residual = 5.53e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 2.5000e+06 is 2.709316e-10

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.122812 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.1006e+01
  </log>
  <optVariables href="FORMN2LMC.s011.opt.xml">
ci_001                -7.055327e-01 3 1  ON 0
ci_002                -7.048097e-01 3 1  ON 1
ci_003                -4.353276e-02 3 1  ON 2
ci_004                -4.680020e-02 3 1  ON 3
ci_005                 1.784321e-02 3 1  ON 4
ci_006                 1.734968e-02 3 1  ON 5
ci_007                 1.438248e-02 3 1  ON 6
ci_008                 1.432656e-02 3 1  ON 7
ci_009                -1.229318e-02 3 1  ON 8
ci_010                -1.096179e-02 3 1  ON 9
ci_011                -9.351551e-03 3 1  ON 10
ci_012                -9.929922e-03 3 1  ON 11
ci_013                 9.950207e-03 3 1  ON 12
ci_014                 1.043986e-02 3 1  ON 13
ci_015                 1.194561e-02 3 1  ON 14
ci_016                 1.407097e-02 3 1  ON 15
ci_017                 9.943053e-03 3 1  ON 16
ci_018                 1.157328e-02 3 1  ON 17
ci_019                 9.065780e-04 3 1  ON 18
ci_020                 1.495804e-03 3 1  ON 19
ci_021                -7.102706e-03 3 1  ON 20
ci_022                -7.001544e-03 3 1  ON 21
ci_023                 8.047040e-03 3 1  ON 22
ci_024                 7.299320e-03 3 1  ON 23
ci_025                 4.584342e-03 3 1  ON 24
ci_026                 4.167134e-03 3 1  ON 25
ci_027                 6.614778e-03 3 1  ON 26
ci_028                 6.795576e-03 3 1  ON 27
ci_029                -5.267990e-03 3 1  ON 28
ci_030                -5.077173e-03 3 1  ON 29
ci_031                -6.354327e-03 3 1  ON 30
ci_032                -7.605491e-03 3 1  ON 31
ci_033                 3.830760e-03 3 1  ON 32
ci_034                 4.927241e-03 3 1  ON 33
ci_035                 1.481403e-03 3 1  ON 34
ci_036                 1.321891e-03 3 1  ON 35
ci_037                 4.657920e-03 3 1  ON 36
ci_038                 5.660503e-03 3 1  ON 37
ci_039                 4.951289e-03 3 1  ON 38
ci_040                 5.520072e-03 3 1  ON 39
ci_041                 5.549230e-03 3 1  ON 40
ci_042                 5.093303e-03 3 1  ON 41
ci_043                 4.592013e-03 3 1  ON 42
ci_044                 5.286673e-03 3 1  ON 43
ci_045                 5.310905e-03 3 1  ON 44
ci_046                 3.685450e-03 3 1  ON 45
ci_047                -9.368595e-04 3 1  ON 46
ci_048                -1.338865e-03 3 1  ON 47
ci_049                 1.448464e-03 3 1  ON 48
ci_050                 1.164996e-03 3 1  ON 49
ci_051                -2.105406e-03 3 1  ON 50
ci_052                -1.875409e-03 3 1  ON 51
ci_053                -7.665748e-04 3 1  ON 52
ci_054                -3.481425e-03 3 1  ON 53
ci_055                -1.674526e-03 3 1  ON 54
ci_056                -1.201477e-03 3 1  ON 55
ci_057                -1.384561e-03 3 1  ON 56
ci_058                -5.995459e-04 3 1  ON 57
ci_059                -3.526742e-04 3 1  ON 58
ci_060                 3.549053e-05 3 1  ON 59
ci_061                 6.521327e-04 3 1  ON 60
ci_062                -8.956552e-04 3 1  ON 61
ci_063                 3.975171e-04 3 1  ON 62
ci_064                 6.780873e-06 3 1  ON 63
ci_065                -2.332652e-03 3 1  ON 64
ci_066                -3.755300e-03 3 1  ON 65
ci_067                -1.222006e-03 3 1  ON 66
ci_068                -1.981583e-03 3 1  ON 67
ci_069                -6.355904e-05 3 1  ON 68
ci_070                 1.035058e-03 3 1  ON 69
ci_071                -1.525578e-03 3 1  ON 70
ci_072                -1.697302e-03 3 1  ON 71
ci_073                 4.268792e-04 3 1  ON 72
ci_074                 1.264545e-04 3 1  ON 73
ci_075                -4.887841e-05 3 1  ON 74
ci_076                 2.110218e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 11
    time step          = 0.05
    reference energy   = -22.6662
    reference variance = 0.417023
====================================================
  Execution time = 2.5614e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORMN2LMC.s011
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2669e+01
  VMC Evar = 4.9467e-01
  Total weights = 1.9552e+06
  Execution time = 3.6471e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.483289576882
                                         uncertainty =       0.002811028505

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.483289576882
                                         uncertainty =       0.002811028505

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000491548769
  error estimate for blocks of size 2^( 2) =       0.000509956554
  error estimate for blocks of size 2^( 3) =       0.000526610648
  error estimate for blocks of size 2^( 4) =       0.000538027103
  error estimate for blocks of size 2^( 5) =       0.000543471466
  error estimate for blocks of size 2^( 6) =       0.000546467305
  error estimate for blocks of size 2^( 7) =       0.000548303898

      target function =                  N/A
              le_mean =     -22.669102582360
             les_mean =     514.382879001141
             stat err =       0.000544067443
             autocorr =       1.225102006256
              std dev =       0.695154935838
             le_variance =       0.483240384820

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.483289576948
                                         uncertainty =       0.002811028465

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.483289576948
                                         uncertainty =       0.002811028465

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000491548769
  error estimate for blocks of size 2^( 2) =       0.000509956554
  error estimate for blocks of size 2^( 3) =       0.000526610648
  error estimate for blocks of size 2^( 4) =       0.000538027103
  error estimate for blocks of size 2^( 5) =       0.000543471466
  error estimate for blocks of size 2^( 6) =       0.000546467305
  error estimate for blocks of size 2^( 7) =       0.000548303898

      target function =                  N/A
              le_mean =     -22.669102582355
             les_mean =     514.382878979564
             stat err =       0.000544067443
             autocorr =       1.225102006469
              std dev =       0.695154935880
             le_variance =       0.483240384878

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.483289576915
                                         uncertainty =       0.002811028485

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.483289576915
                                         uncertainty =       0.002811028485

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000491548769
  error estimate for blocks of size 2^( 2) =       0.000509956554
  error estimate for blocks of size 2^( 3) =       0.000526610648
  error estimate for blocks of size 2^( 4) =       0.000538027103
  error estimate for blocks of size 2^( 5) =       0.000543471466
  error estimate for blocks of size 2^( 6) =       0.000546467305
  error estimate for blocks of size 2^( 7) =       0.000548303898

      target function =                  N/A
              le_mean =     -22.669102582357
             les_mean =     514.382878990352
             stat err =       0.000544067443
             autocorr =       1.225102006354
              std dev =       0.695154935859
             le_variance =       0.483240384849

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.483289576886
                                         uncertainty =       0.002811028502

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.483289576886
                                         uncertainty =       0.002811028502

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000491548769
  error estimate for blocks of size 2^( 2) =       0.000509956554
  error estimate for blocks of size 2^( 3) =       0.000526610648
  error estimate for blocks of size 2^( 4) =       0.000538027103
  error estimate for blocks of size 2^( 5) =       0.000543471466
  error estimate for blocks of size 2^( 6) =       0.000546467305
  error estimate for blocks of size 2^( 7) =       0.000548303898

      target function =                  N/A
              le_mean =     -22.669102582360
             les_mean =     514.382878999792
             stat err =       0.000544067443
             autocorr =       1.225102006272
              std dev =       0.695154935841
             le_variance =       0.483240384824


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.669102582360        initial  <--
     1.5625e+05     1.5625e+06             4.3349e-09       -22.669102582355
     6.2500e+05     6.2500e+06             1.0837e-09       -22.669102582357
     2.5000e+06     2.5000e+07             2.7093e-10       -22.669102582360

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 43.9058
  </log>
  <optVariables href="FORMN2LMC.s011.opt.xml">
ci_001                -7.055327e-01 3 1  ON 0
ci_002                -7.048097e-01 3 1  ON 1
ci_003                -4.353277e-02 3 1  ON 2
ci_004                -4.680020e-02 3 1  ON 3
ci_005                 1.784321e-02 3 1  ON 4
ci_006                 1.734968e-02 3 1  ON 5
ci_007                 1.438248e-02 3 1  ON 6
ci_008                 1.432656e-02 3 1  ON 7
ci_009                -1.229318e-02 3 1  ON 8
ci_010                -1.096179e-02 3 1  ON 9
ci_011                -9.351550e-03 3 1  ON 10
ci_012                -9.929923e-03 3 1  ON 11
ci_013                 9.950207e-03 3 1  ON 12
ci_014                 1.043986e-02 3 1  ON 13
ci_015                 1.194561e-02 3 1  ON 14
ci_016                 1.407097e-02 3 1  ON 15
ci_017                 9.943053e-03 3 1  ON 16
ci_018                 1.157328e-02 3 1  ON 17
ci_019                 9.065786e-04 3 1  ON 18
ci_020                 1.495805e-03 3 1  ON 19
ci_021                -7.102706e-03 3 1  ON 20
ci_022                -7.001544e-03 3 1  ON 21
ci_023                 8.047041e-03 3 1  ON 22
ci_024                 7.299319e-03 3 1  ON 23
ci_025                 4.584343e-03 3 1  ON 24
ci_026                 4.167134e-03 3 1  ON 25
ci_027                 6.614779e-03 3 1  ON 26
ci_028                 6.795576e-03 3 1  ON 27
ci_029                -5.267991e-03 3 1  ON 28
ci_030                -5.077173e-03 3 1  ON 29
ci_031                -6.354327e-03 3 1  ON 30
ci_032                -7.605491e-03 3 1  ON 31
ci_033                 3.830761e-03 3 1  ON 32
ci_034                 4.927241e-03 3 1  ON 33
ci_035                 1.481403e-03 3 1  ON 34
ci_036                 1.321891e-03 3 1  ON 35
ci_037                 4.657920e-03 3 1  ON 36
ci_038                 5.660503e-03 3 1  ON 37
ci_039                 4.951289e-03 3 1  ON 38
ci_040                 5.520073e-03 3 1  ON 39
ci_041                 5.549229e-03 3 1  ON 40
ci_042                 5.093303e-03 3 1  ON 41
ci_043                 4.592013e-03 3 1  ON 42
ci_044                 5.286673e-03 3 1  ON 43
ci_045                 5.310905e-03 3 1  ON 44
ci_046                 3.685450e-03 3 1  ON 45
ci_047                -9.368597e-04 3 1  ON 46
ci_048                -1.338865e-03 3 1  ON 47
ci_049                 1.448465e-03 3 1  ON 48
ci_050                 1.164996e-03 3 1  ON 49
ci_051                -2.105406e-03 3 1  ON 50
ci_052                -1.875409e-03 3 1  ON 51
ci_053                -7.665742e-04 3 1  ON 52
ci_054                -3.481425e-03 3 1  ON 53
ci_055                -1.674526e-03 3 1  ON 54
ci_056                -1.201476e-03 3 1  ON 55
ci_057                -1.384561e-03 3 1  ON 56
ci_058                -5.995457e-04 3 1  ON 57
ci_059                -3.526745e-04 3 1  ON 58
ci_060                 3.548996e-05 3 1  ON 59
ci_061                 6.521331e-04 3 1  ON 60
ci_062                -8.956554e-04 3 1  ON 61
ci_063                 3.975173e-04 3 1  ON 62
ci_064                 6.781068e-06 3 1  ON 63
ci_065                -2.332651e-03 3 1  ON 64
ci_066                -3.755300e-03 3 1  ON 65
ci_067                -1.222005e-03 3 1  ON 66
ci_068                -1.981583e-03 3 1  ON 67
ci_069                -6.355917e-05 3 1  ON 68
ci_070                 1.035058e-03 3 1  ON 69
ci_071                -1.525578e-03 3 1  ON 70
ci_072                -1.697302e-03 3 1  ON 71
ci_073                 4.268796e-04 3 1  ON 72
ci_074                 1.264548e-04 3 1  ON 73
ci_075                -4.887832e-05 3 1  ON 74
ci_076                 2.110221e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.4918e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORMN2LMC.s012 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORMN2LMC.s012 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=12  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2670e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 12
    time step          = 0.05
    reference energy   = -22.6028
    reference variance = 0.51764
====================================================
  Execution time = 2.6322e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORMN2LMC.s012
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5253e+04
  VMC Eavg = -2.2670e+01
  VMC Evar = 4.9797e-01
  Total weights = 1.954893228e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.7427e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.486068316631
                                         uncertainty =       0.003169226882

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.486068316631
                                         uncertainty =       0.003169226882

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000492991487
  error estimate for blocks of size 2^( 2) =       0.000511545650
  error estimate for blocks of size 2^( 3) =       0.000528215816
  error estimate for blocks of size 2^( 4) =       0.000540870307
  error estimate for blocks of size 2^( 5) =       0.000549843958
  error estimate for blocks of size 2^( 6) =       0.000552275041
  error estimate for blocks of size 2^( 7) =       0.000555151585

      target function =                  N/A
              le_mean =     -22.669810463860
             les_mean =     514.418272057712
             stat err =       0.000549535223
             autocorr =       1.242545292121
              std dev =       0.697195246920
             le_variance =       0.486081212327


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266981046386e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5625e+06, overlap shift 1.5625e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.669810463971       residual = 1.78e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.669810463978       residual = 2.23e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.669810463978       residual = 5.02e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.669810463978       residual = 1.25e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 1.5625e+06 is 3.342921e-10

solving harmonic davidson linear method for identity shift 6.2500e+06, overlap shift 6.2500e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.669810463971       residual = 1.78e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.669810463972       residual = 2.23e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.669810463972       residual = 5.02e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.669810463886       residual = 1.25e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 6.2500e+06 is 8.357302e-11

solving harmonic davidson linear method for identity shift 2.5000e+07, overlap shift 2.5000e+08 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.669810463971       residual = 1.78e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.669810463971       residual = 2.23e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.669810463971       residual = 5.02e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.669810448107       residual = 1.25e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 2.5000e+07 is 2.089323e-11

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.124154 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.1074e+01
  </log>
  <optVariables href="FORMN2LMC.s012.opt.xml">
ci_001                -7.055327e-01 3 1  ON 0
ci_002                -7.048097e-01 3 1  ON 1
ci_003                -4.353277e-02 3 1  ON 2
ci_004                -4.680020e-02 3 1  ON 3
ci_005                 1.784321e-02 3 1  ON 4
ci_006                 1.734968e-02 3 1  ON 5
ci_007                 1.438248e-02 3 1  ON 6
ci_008                 1.432656e-02 3 1  ON 7
ci_009                -1.229318e-02 3 1  ON 8
ci_010                -1.096179e-02 3 1  ON 9
ci_011                -9.351550e-03 3 1  ON 10
ci_012                -9.929922e-03 3 1  ON 11
ci_013                 9.950207e-03 3 1  ON 12
ci_014                 1.043986e-02 3 1  ON 13
ci_015                 1.194561e-02 3 1  ON 14
ci_016                 1.407097e-02 3 1  ON 15
ci_017                 9.943053e-03 3 1  ON 16
ci_018                 1.157328e-02 3 1  ON 17
ci_019                 9.065786e-04 3 1  ON 18
ci_020                 1.495805e-03 3 1  ON 19
ci_021                -7.102706e-03 3 1  ON 20
ci_022                -7.001544e-03 3 1  ON 21
ci_023                 8.047041e-03 3 1  ON 22
ci_024                 7.299319e-03 3 1  ON 23
ci_025                 4.584343e-03 3 1  ON 24
ci_026                 4.167134e-03 3 1  ON 25
ci_027                 6.614779e-03 3 1  ON 26
ci_028                 6.795576e-03 3 1  ON 27
ci_029                -5.267990e-03 3 1  ON 28
ci_030                -5.077173e-03 3 1  ON 29
ci_031                -6.354327e-03 3 1  ON 30
ci_032                -7.605491e-03 3 1  ON 31
ci_033                 3.830761e-03 3 1  ON 32
ci_034                 4.927241e-03 3 1  ON 33
ci_035                 1.481403e-03 3 1  ON 34
ci_036                 1.321891e-03 3 1  ON 35
ci_037                 4.657920e-03 3 1  ON 36
ci_038                 5.660503e-03 3 1  ON 37
ci_039                 4.951289e-03 3 1  ON 38
ci_040                 5.520073e-03 3 1  ON 39
ci_041                 5.549229e-03 3 1  ON 40
ci_042                 5.093303e-03 3 1  ON 41
ci_043                 4.592013e-03 3 1  ON 42
ci_044                 5.286673e-03 3 1  ON 43
ci_045                 5.310905e-03 3 1  ON 44
ci_046                 3.685450e-03 3 1  ON 45
ci_047                -9.368597e-04 3 1  ON 46
ci_048                -1.338865e-03 3 1  ON 47
ci_049                 1.448465e-03 3 1  ON 48
ci_050                 1.164996e-03 3 1  ON 49
ci_051                -2.105406e-03 3 1  ON 50
ci_052                -1.875409e-03 3 1  ON 51
ci_053                -7.665742e-04 3 1  ON 52
ci_054                -3.481425e-03 3 1  ON 53
ci_055                -1.674526e-03 3 1  ON 54
ci_056                -1.201476e-03 3 1  ON 55
ci_057                -1.384561e-03 3 1  ON 56
ci_058                -5.995457e-04 3 1  ON 57
ci_059                -3.526744e-04 3 1  ON 58
ci_060                 3.548998e-05 3 1  ON 59
ci_061                 6.521331e-04 3 1  ON 60
ci_062                -8.956553e-04 3 1  ON 61
ci_063                 3.975173e-04 3 1  ON 62
ci_064                 6.781078e-06 3 1  ON 63
ci_065                -2.332651e-03 3 1  ON 64
ci_066                -3.755300e-03 3 1  ON 65
ci_067                -1.222005e-03 3 1  ON 66
ci_068                -1.981583e-03 3 1  ON 67
ci_069                -6.355916e-05 3 1  ON 68
ci_070                 1.035058e-03 3 1  ON 69
ci_071                -1.525578e-03 3 1  ON 70
ci_072                -1.697302e-03 3 1  ON 71
ci_073                 4.268796e-04 3 1  ON 72
ci_074                 1.264548e-04 3 1  ON 73
ci_075                -4.887833e-05 3 1  ON 74
ci_076                 2.110220e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 12
    time step          = 0.05
    reference energy   = -22.6298
    reference variance = 0.354499
====================================================
  Execution time = 2.5480e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORMN2LMC.s012
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2670e+01
  VMC Evar = 4.9940e-01
  Total weights = 1.9552e+06
  Execution time = 4.1110e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.483029202442
                                         uncertainty =       0.002821096461

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.483029202442
                                         uncertainty =       0.002821096461

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000491458522
  error estimate for blocks of size 2^( 2) =       0.000509834956
  error estimate for blocks of size 2^( 3) =       0.000526710027
  error estimate for blocks of size 2^( 4) =       0.000537797288
  error estimate for blocks of size 2^( 5) =       0.000544804171
  error estimate for blocks of size 2^( 6) =       0.000549106786
  error estimate for blocks of size 2^( 7) =       0.000552167371

      target function =                  N/A
              le_mean =     -22.669806623696
             les_mean =     514.419528723018
             stat err =       0.000545968904
             autocorr =       1.234133316135
              std dev =       0.695027306526
             le_variance =       0.483062956817

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.483029202370
                                         uncertainty =       0.002821096444

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.483029202370
                                         uncertainty =       0.002821096444

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000491458522
  error estimate for blocks of size 2^( 2) =       0.000509834956
  error estimate for blocks of size 2^( 3) =       0.000526710027
  error estimate for blocks of size 2^( 4) =       0.000537797288
  error estimate for blocks of size 2^( 5) =       0.000544804171
  error estimate for blocks of size 2^( 6) =       0.000549106786
  error estimate for blocks of size 2^( 7) =       0.000552167371

      target function =                  N/A
              le_mean =     -22.669806623692
             les_mean =     514.419528719052
             stat err =       0.000545968904
             autocorr =       1.234133316189
              std dev =       0.695027306475
             le_variance =       0.483062956746

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.483029202406
                                         uncertainty =       0.002821096453

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.483029202406
                                         uncertainty =       0.002821096453

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000491458522
  error estimate for blocks of size 2^( 2) =       0.000509834956
  error estimate for blocks of size 2^( 3) =       0.000526710027
  error estimate for blocks of size 2^( 4) =       0.000537797288
  error estimate for blocks of size 2^( 5) =       0.000544804171
  error estimate for blocks of size 2^( 6) =       0.000549106786
  error estimate for blocks of size 2^( 7) =       0.000552167371

      target function =                  N/A
              le_mean =     -22.669806623694
             les_mean =     514.419528721035
             stat err =       0.000545968904
             autocorr =       1.234133316172
              std dev =       0.695027306501
             le_variance =       0.483062956782

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.483029202437
                                         uncertainty =       0.002821096460

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.483029202437
                                         uncertainty =       0.002821096460

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000491458522
  error estimate for blocks of size 2^( 2) =       0.000509834956
  error estimate for blocks of size 2^( 3) =       0.000526710027
  error estimate for blocks of size 2^( 4) =       0.000537797288
  error estimate for blocks of size 2^( 5) =       0.000544804171
  error estimate for blocks of size 2^( 6) =       0.000549106786
  error estimate for blocks of size 2^( 7) =       0.000552167371

      target function =                  N/A
              le_mean =     -22.669806623696
             les_mean =     514.419528722770
             stat err =       0.000545968904
             autocorr =       1.234133316134
              std dev =       0.695027306523
             le_variance =       0.483062956813


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.669806623696        initial  <--
     1.5625e+06     1.5625e+07             3.3429e-10       -22.669806623692
     6.2500e+06     6.2500e+07             8.3573e-11       -22.669806623694
     2.5000e+07     2.5000e+08             2.0893e-11       -22.669806623696

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 44.5580
  </log>
  <optVariables href="FORMN2LMC.s012.opt.xml">
ci_001                -7.055327e-01 3 1  ON 0
ci_002                -7.048097e-01 3 1  ON 1
ci_003                -4.353277e-02 3 1  ON 2
ci_004                -4.680020e-02 3 1  ON 3
ci_005                 1.784321e-02 3 1  ON 4
ci_006                 1.734968e-02 3 1  ON 5
ci_007                 1.438248e-02 3 1  ON 6
ci_008                 1.432656e-02 3 1  ON 7
ci_009                -1.229318e-02 3 1  ON 8
ci_010                -1.096179e-02 3 1  ON 9
ci_011                -9.351550e-03 3 1  ON 10
ci_012                -9.929923e-03 3 1  ON 11
ci_013                 9.950207e-03 3 1  ON 12
ci_014                 1.043986e-02 3 1  ON 13
ci_015                 1.194561e-02 3 1  ON 14
ci_016                 1.407097e-02 3 1  ON 15
ci_017                 9.943053e-03 3 1  ON 16
ci_018                 1.157328e-02 3 1  ON 17
ci_019                 9.065786e-04 3 1  ON 18
ci_020                 1.495805e-03 3 1  ON 19
ci_021                -7.102706e-03 3 1  ON 20
ci_022                -7.001544e-03 3 1  ON 21
ci_023                 8.047041e-03 3 1  ON 22
ci_024                 7.299319e-03 3 1  ON 23
ci_025                 4.584343e-03 3 1  ON 24
ci_026                 4.167134e-03 3 1  ON 25
ci_027                 6.614779e-03 3 1  ON 26
ci_028                 6.795576e-03 3 1  ON 27
ci_029                -5.267991e-03 3 1  ON 28
ci_030                -5.077173e-03 3 1  ON 29
ci_031                -6.354327e-03 3 1  ON 30
ci_032                -7.605491e-03 3 1  ON 31
ci_033                 3.830761e-03 3 1  ON 32
ci_034                 4.927241e-03 3 1  ON 33
ci_035                 1.481403e-03 3 1  ON 34
ci_036                 1.321891e-03 3 1  ON 35
ci_037                 4.657920e-03 3 1  ON 36
ci_038                 5.660503e-03 3 1  ON 37
ci_039                 4.951289e-03 3 1  ON 38
ci_040                 5.520073e-03 3 1  ON 39
ci_041                 5.549229e-03 3 1  ON 40
ci_042                 5.093303e-03 3 1  ON 41
ci_043                 4.592013e-03 3 1  ON 42
ci_044                 5.286673e-03 3 1  ON 43
ci_045                 5.310905e-03 3 1  ON 44
ci_046                 3.685450e-03 3 1  ON 45
ci_047                -9.368597e-04 3 1  ON 46
ci_048                -1.338865e-03 3 1  ON 47
ci_049                 1.448465e-03 3 1  ON 48
ci_050                 1.164996e-03 3 1  ON 49
ci_051                -2.105406e-03 3 1  ON 50
ci_052                -1.875409e-03 3 1  ON 51
ci_053                -7.665742e-04 3 1  ON 52
ci_054                -3.481425e-03 3 1  ON 53
ci_055                -1.674526e-03 3 1  ON 54
ci_056                -1.201476e-03 3 1  ON 55
ci_057                -1.384561e-03 3 1  ON 56
ci_058                -5.995457e-04 3 1  ON 57
ci_059                -3.526745e-04 3 1  ON 58
ci_060                 3.548996e-05 3 1  ON 59
ci_061                 6.521331e-04 3 1  ON 60
ci_062                -8.956554e-04 3 1  ON 61
ci_063                 3.975173e-04 3 1  ON 62
ci_064                 6.781068e-06 3 1  ON 63
ci_065                -2.332651e-03 3 1  ON 64
ci_066                -3.755300e-03 3 1  ON 65
ci_067                -1.222005e-03 3 1  ON 66
ci_068                -1.981583e-03 3 1  ON 67
ci_069                -6.355917e-05 3 1  ON 68
ci_070                 1.035058e-03 3 1  ON 69
ci_071                -1.525578e-03 3 1  ON 70
ci_072                -1.697302e-03 3 1  ON 71
ci_073                 4.268796e-04 3 1  ON 72
ci_074                 1.264548e-04 3 1  ON 73
ci_075                -4.887832e-05 3 1  ON 74
ci_076                 2.110221e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.5638e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORMN2LMC.s013 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORMN2LMC.s013 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=13  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2666e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 13
    time step          = 0.05
    reference energy   = -22.7043
    reference variance = 0.289257
====================================================
  Execution time = 2.6147e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORMN2LMC.s013
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5283e+04
  VMC Eavg = -2.2670e+01
  VMC Evar = 4.9904e-01
  Total weights = 1.955338185e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.7029e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.486953976476
                                         uncertainty =       0.003024323931

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.486953976476
                                         uncertainty =       0.003024323931

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000493394678
  error estimate for blocks of size 2^( 2) =       0.000511547860
  error estimate for blocks of size 2^( 3) =       0.000528391222
  error estimate for blocks of size 2^( 4) =       0.000539512916
  error estimate for blocks of size 2^( 5) =       0.000547244984
  error estimate for blocks of size 2^( 6) =       0.000551194748
  error estimate for blocks of size 2^( 7) =       0.000552325400

      target function =                  N/A
              le_mean =     -22.669553999025
             les_mean =     514.407719528918
             stat err =       0.000547569512
             autocorr =       1.231656484570
              std dev =       0.697765444901
             le_variance =       0.486876616098


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266955399902e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5625e+07, overlap shift 1.5625e+08 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.669553999154       residual = 2.35e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.669553999155       residual = 2.94e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.669553999155       residual = 6.31e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.669553999155       residual = 2.08e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 1.5625e+07 is 2.975520e-11

solving harmonic davidson linear method for identity shift 6.2500e+07, overlap shift 6.2500e+08 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.669553999154       residual = 2.35e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.669553999154       residual = 2.94e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.669553999154       residual = 6.31e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.669553999154       residual = 2.08e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 6.2500e+07 is 7.438806e-12

solving harmonic davidson linear method for identity shift 2.5000e+08, overlap shift 2.5000e+09 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.669553999154       residual = 2.35e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.669553999154       residual = 2.94e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.669553999154       residual = 6.31e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.669553892297       residual = 2.08e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 2.5000e+08 is 1.859731e-12

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.125528 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0860e+01
  </log>
  <optVariables href="FORMN2LMC.s013.opt.xml">
ci_001                -7.055327e-01 3 1  ON 0
ci_002                -7.048097e-01 3 1  ON 1
ci_003                -4.353277e-02 3 1  ON 2
ci_004                -4.680020e-02 3 1  ON 3
ci_005                 1.784321e-02 3 1  ON 4
ci_006                 1.734968e-02 3 1  ON 5
ci_007                 1.438248e-02 3 1  ON 6
ci_008                 1.432656e-02 3 1  ON 7
ci_009                -1.229318e-02 3 1  ON 8
ci_010                -1.096179e-02 3 1  ON 9
ci_011                -9.351550e-03 3 1  ON 10
ci_012                -9.929923e-03 3 1  ON 11
ci_013                 9.950207e-03 3 1  ON 12
ci_014                 1.043986e-02 3 1  ON 13
ci_015                 1.194561e-02 3 1  ON 14
ci_016                 1.407097e-02 3 1  ON 15
ci_017                 9.943053e-03 3 1  ON 16
ci_018                 1.157328e-02 3 1  ON 17
ci_019                 9.065786e-04 3 1  ON 18
ci_020                 1.495805e-03 3 1  ON 19
ci_021                -7.102706e-03 3 1  ON 20
ci_022                -7.001544e-03 3 1  ON 21
ci_023                 8.047041e-03 3 1  ON 22
ci_024                 7.299319e-03 3 1  ON 23
ci_025                 4.584343e-03 3 1  ON 24
ci_026                 4.167134e-03 3 1  ON 25
ci_027                 6.614779e-03 3 1  ON 26
ci_028                 6.795576e-03 3 1  ON 27
ci_029                -5.267991e-03 3 1  ON 28
ci_030                -5.077173e-03 3 1  ON 29
ci_031                -6.354327e-03 3 1  ON 30
ci_032                -7.605491e-03 3 1  ON 31
ci_033                 3.830761e-03 3 1  ON 32
ci_034                 4.927241e-03 3 1  ON 33
ci_035                 1.481403e-03 3 1  ON 34
ci_036                 1.321891e-03 3 1  ON 35
ci_037                 4.657920e-03 3 1  ON 36
ci_038                 5.660503e-03 3 1  ON 37
ci_039                 4.951289e-03 3 1  ON 38
ci_040                 5.520073e-03 3 1  ON 39
ci_041                 5.549229e-03 3 1  ON 40
ci_042                 5.093303e-03 3 1  ON 41
ci_043                 4.592013e-03 3 1  ON 42
ci_044                 5.286673e-03 3 1  ON 43
ci_045                 5.310905e-03 3 1  ON 44
ci_046                 3.685450e-03 3 1  ON 45
ci_047                -9.368597e-04 3 1  ON 46
ci_048                -1.338865e-03 3 1  ON 47
ci_049                 1.448465e-03 3 1  ON 48
ci_050                 1.164996e-03 3 1  ON 49
ci_051                -2.105406e-03 3 1  ON 50
ci_052                -1.875409e-03 3 1  ON 51
ci_053                -7.665742e-04 3 1  ON 52
ci_054                -3.481425e-03 3 1  ON 53
ci_055                -1.674526e-03 3 1  ON 54
ci_056                -1.201476e-03 3 1  ON 55
ci_057                -1.384561e-03 3 1  ON 56
ci_058                -5.995457e-04 3 1  ON 57
ci_059                -3.526745e-04 3 1  ON 58
ci_060                 3.548996e-05 3 1  ON 59
ci_061                 6.521331e-04 3 1  ON 60
ci_062                -8.956554e-04 3 1  ON 61
ci_063                 3.975173e-04 3 1  ON 62
ci_064                 6.781066e-06 3 1  ON 63
ci_065                -2.332651e-03 3 1  ON 64
ci_066                -3.755300e-03 3 1  ON 65
ci_067                -1.222005e-03 3 1  ON 66
ci_068                -1.981583e-03 3 1  ON 67
ci_069                -6.355917e-05 3 1  ON 68
ci_070                 1.035058e-03 3 1  ON 69
ci_071                -1.525578e-03 3 1  ON 70
ci_072                -1.697302e-03 3 1  ON 71
ci_073                 4.268796e-04 3 1  ON 72
ci_074                 1.264548e-04 3 1  ON 73
ci_075                -4.887832e-05 3 1  ON 74
ci_076                 2.110221e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 13
    time step          = 0.05
    reference energy   = -22.5178
    reference variance = 0.923049
====================================================
  Execution time = 2.5616e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORMN2LMC.s013
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2669e+01
  VMC Evar = 4.9412e-01
  Total weights = 1.9553e+06
  Execution time = 3.6277e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.482367241006
                                         uncertainty =       0.002624753443

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.482367241006
                                         uncertainty =       0.002624753443

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000491121894
  error estimate for blocks of size 2^( 2) =       0.000509989367
  error estimate for blocks of size 2^( 3) =       0.000526814657
  error estimate for blocks of size 2^( 4) =       0.000538362449
  error estimate for blocks of size 2^( 5) =       0.000545164904
  error estimate for blocks of size 2^( 6) =       0.000547724019
  error estimate for blocks of size 2^( 7) =       0.000549049713

      target function =                  N/A
              le_mean =     -22.668961509268
             les_mean =     514.375936436635
             stat err =       0.000545075271
             autocorr =       1.231783459924
              std dev =       0.694551243482
             le_variance =       0.482401429822

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.482367241000
                                         uncertainty =       0.002624753443

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.482367241000
                                         uncertainty =       0.002624753443

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000491121894
  error estimate for blocks of size 2^( 2) =       0.000509989367
  error estimate for blocks of size 2^( 3) =       0.000526814657
  error estimate for blocks of size 2^( 4) =       0.000538362449
  error estimate for blocks of size 2^( 5) =       0.000545164904
  error estimate for blocks of size 2^( 6) =       0.000547724019
  error estimate for blocks of size 2^( 7) =       0.000549049713

      target function =                  N/A
              le_mean =     -22.668961509268
             les_mean =     514.375936436638
             stat err =       0.000545075271
             autocorr =       1.231783459926
              std dev =       0.694551243478
             le_variance =       0.482401429816

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.482367241003
                                         uncertainty =       0.002624753443

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.482367241003
                                         uncertainty =       0.002624753443

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000491121894
  error estimate for blocks of size 2^( 2) =       0.000509989367
  error estimate for blocks of size 2^( 3) =       0.000526814657
  error estimate for blocks of size 2^( 4) =       0.000538362449
  error estimate for blocks of size 2^( 5) =       0.000545164904
  error estimate for blocks of size 2^( 6) =       0.000547724019
  error estimate for blocks of size 2^( 7) =       0.000549049713

      target function =                  N/A
              le_mean =     -22.668961509268
             les_mean =     514.375936436636
             stat err =       0.000545075271
             autocorr =       1.231783459924
              std dev =       0.694551243480
             le_variance =       0.482401429819

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.482367241006
                                         uncertainty =       0.002624753443

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.482367241006
                                         uncertainty =       0.002624753443

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000491121894
  error estimate for blocks of size 2^( 2) =       0.000509989367
  error estimate for blocks of size 2^( 3) =       0.000526814657
  error estimate for blocks of size 2^( 4) =       0.000538362449
  error estimate for blocks of size 2^( 5) =       0.000545164904
  error estimate for blocks of size 2^( 6) =       0.000547724019
  error estimate for blocks of size 2^( 7) =       0.000549049713

      target function =                  N/A
              le_mean =     -22.668961509268
             les_mean =     514.375936436635
             stat err =       0.000545075271
             autocorr =       1.231783459920
              std dev =       0.694551243481
             le_variance =       0.482401429822


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.668961509268        initial
     1.5625e+07     1.5625e+08             2.9755e-11       -22.668961509268  <--
     6.2500e+07     6.2500e+08             7.4388e-12       -22.668961509268
     2.5000e+08     2.5000e+09             1.8597e-12       -22.668961509268

*****************************************************************************
Applying the update for shift_i =   1.5625e+07     and shift_s =   1.5625e+08
*****************************************************************************

  Execution time = 4.3817e+01
  </log>
  <optVariables href="FORMN2LMC.s013.opt.xml">
ci_001                -7.055327e-01 3 1  ON 0
ci_002                -7.048097e-01 3 1  ON 1
ci_003                -4.353277e-02 3 1  ON 2
ci_004                -4.680020e-02 3 1  ON 3
ci_005                 1.784321e-02 3 1  ON 4
ci_006                 1.734968e-02 3 1  ON 5
ci_007                 1.438248e-02 3 1  ON 6
ci_008                 1.432656e-02 3 1  ON 7
ci_009                -1.229318e-02 3 1  ON 8
ci_010                -1.096179e-02 3 1  ON 9
ci_011                -9.351550e-03 3 1  ON 10
ci_012                -9.929923e-03 3 1  ON 11
ci_013                 9.950207e-03 3 1  ON 12
ci_014                 1.043986e-02 3 1  ON 13
ci_015                 1.194561e-02 3 1  ON 14
ci_016                 1.407097e-02 3 1  ON 15
ci_017                 9.943053e-03 3 1  ON 16
ci_018                 1.157328e-02 3 1  ON 17
ci_019                 9.065786e-04 3 1  ON 18
ci_020                 1.495805e-03 3 1  ON 19
ci_021                -7.102706e-03 3 1  ON 20
ci_022                -7.001544e-03 3 1  ON 21
ci_023                 8.047041e-03 3 1  ON 22
ci_024                 7.299319e-03 3 1  ON 23
ci_025                 4.584343e-03 3 1  ON 24
ci_026                 4.167134e-03 3 1  ON 25
ci_027                 6.614779e-03 3 1  ON 26
ci_028                 6.795576e-03 3 1  ON 27
ci_029                -5.267990e-03 3 1  ON 28
ci_030                -5.077173e-03 3 1  ON 29
ci_031                -6.354327e-03 3 1  ON 30
ci_032                -7.605491e-03 3 1  ON 31
ci_033                 3.830761e-03 3 1  ON 32
ci_034                 4.927241e-03 3 1  ON 33
ci_035                 1.481403e-03 3 1  ON 34
ci_036                 1.321891e-03 3 1  ON 35
ci_037                 4.657920e-03 3 1  ON 36
ci_038                 5.660503e-03 3 1  ON 37
ci_039                 4.951289e-03 3 1  ON 38
ci_040                 5.520073e-03 3 1  ON 39
ci_041                 5.549229e-03 3 1  ON 40
ci_042                 5.093303e-03 3 1  ON 41
ci_043                 4.592013e-03 3 1  ON 42
ci_044                 5.286673e-03 3 1  ON 43
ci_045                 5.310905e-03 3 1  ON 44
ci_046                 3.685450e-03 3 1  ON 45
ci_047                -9.368597e-04 3 1  ON 46
ci_048                -1.338865e-03 3 1  ON 47
ci_049                 1.448465e-03 3 1  ON 48
ci_050                 1.164996e-03 3 1  ON 49
ci_051                -2.105406e-03 3 1  ON 50
ci_052                -1.875409e-03 3 1  ON 51
ci_053                -7.665742e-04 3 1  ON 52
ci_054                -3.481425e-03 3 1  ON 53
ci_055                -1.674526e-03 3 1  ON 54
ci_056                -1.201476e-03 3 1  ON 55
ci_057                -1.384561e-03 3 1  ON 56
ci_058                -5.995457e-04 3 1  ON 57
ci_059                -3.526745e-04 3 1  ON 58
ci_060                 3.548996e-05 3 1  ON 59
ci_061                 6.521331e-04 3 1  ON 60
ci_062                -8.956553e-04 3 1  ON 61
ci_063                 3.975173e-04 3 1  ON 62
ci_064                 6.781061e-06 3 1  ON 63
ci_065                -2.332651e-03 3 1  ON 64
ci_066                -3.755300e-03 3 1  ON 65
ci_067                -1.222005e-03 3 1  ON 66
ci_068                -1.981583e-03 3 1  ON 67
ci_069                -6.355916e-05 3 1  ON 68
ci_070                 1.035058e-03 3 1  ON 69
ci_071                -1.525578e-03 3 1  ON 70
ci_072                -1.697302e-03 3 1  ON 71
ci_073                 4.268796e-04 3 1  ON 72
ci_074                 1.264548e-04 3 1  ON 73
ci_075                -4.887833e-05 3 1  ON 74
ci_076                 2.110221e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.4682e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORMN2LMC.s014 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORMN2LMC.s014 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=14  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2662e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 14
    time step          = 0.05
    reference energy   = -22.7399
    reference variance = 0.443208
====================================================
  Execution time = 2.6170e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORMN2LMC.s014
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5271e+04
  VMC Eavg = -2.2669e+01
  VMC Evar = 5.0095e-01
  Total weights = 1.954882248e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.7140e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.488708607214
                                         uncertainty =       0.003960156987

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.488708607214
                                         uncertainty =       0.003960156987

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000494362066
  error estimate for blocks of size 2^( 2) =       0.000513075867
  error estimate for blocks of size 2^( 3) =       0.000530269447
  error estimate for blocks of size 2^( 4) =       0.000542867545
  error estimate for blocks of size 2^( 5) =       0.000548825061
  error estimate for blocks of size 2^( 6) =       0.000552187270
  error estimate for blocks of size 2^( 7) =       0.000553753025

      target function =                  N/A
              le_mean =     -22.668686966844
             les_mean =     514.370320023750
             stat err =       0.000549408225
             autocorr =       1.235094071572
              std dev =       0.699133538221
             le_variance =       0.488787704265


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266868696684e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.9062e+06, overlap shift 3.9062e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.668686966947       residual = 2.31e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.668686966951       residual = 2.84e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.668686966951       residual = 7.78e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.668686966793       residual = 1.65e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 3.9062e+06 is 1.503180e-10

solving harmonic davidson linear method for identity shift 1.5625e+07, overlap shift 1.5625e+08 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.668686966947       residual = 2.31e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.668686966948       residual = 2.84e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.668686966948       residual = 7.78e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.668686966948       residual = 1.65e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 1.5625e+07 is 3.757957e-11

solving harmonic davidson linear method for identity shift 6.2500e+07, overlap shift 6.2500e+08 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.668686966947       residual = 2.31e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.668686966947       residual = 2.84e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.668686966947       residual = 7.78e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.668686966947       residual = 1.65e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 6.2500e+07 is 9.394892e-12

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.126842 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0894e+01
  </log>
  <optVariables href="FORMN2LMC.s014.opt.xml">
ci_001                -7.055327e-01 3 1  ON 0
ci_002                -7.048097e-01 3 1  ON 1
ci_003                -4.353277e-02 3 1  ON 2
ci_004                -4.680020e-02 3 1  ON 3
ci_005                 1.784321e-02 3 1  ON 4
ci_006                 1.734968e-02 3 1  ON 5
ci_007                 1.438248e-02 3 1  ON 6
ci_008                 1.432656e-02 3 1  ON 7
ci_009                -1.229318e-02 3 1  ON 8
ci_010                -1.096179e-02 3 1  ON 9
ci_011                -9.351550e-03 3 1  ON 10
ci_012                -9.929923e-03 3 1  ON 11
ci_013                 9.950207e-03 3 1  ON 12
ci_014                 1.043986e-02 3 1  ON 13
ci_015                 1.194561e-02 3 1  ON 14
ci_016                 1.407097e-02 3 1  ON 15
ci_017                 9.943053e-03 3 1  ON 16
ci_018                 1.157328e-02 3 1  ON 17
ci_019                 9.065786e-04 3 1  ON 18
ci_020                 1.495805e-03 3 1  ON 19
ci_021                -7.102706e-03 3 1  ON 20
ci_022                -7.001544e-03 3 1  ON 21
ci_023                 8.047041e-03 3 1  ON 22
ci_024                 7.299319e-03 3 1  ON 23
ci_025                 4.584343e-03 3 1  ON 24
ci_026                 4.167134e-03 3 1  ON 25
ci_027                 6.614779e-03 3 1  ON 26
ci_028                 6.795576e-03 3 1  ON 27
ci_029                -5.267990e-03 3 1  ON 28
ci_030                -5.077173e-03 3 1  ON 29
ci_031                -6.354327e-03 3 1  ON 30
ci_032                -7.605491e-03 3 1  ON 31
ci_033                 3.830761e-03 3 1  ON 32
ci_034                 4.927241e-03 3 1  ON 33
ci_035                 1.481403e-03 3 1  ON 34
ci_036                 1.321891e-03 3 1  ON 35
ci_037                 4.657920e-03 3 1  ON 36
ci_038                 5.660503e-03 3 1  ON 37
ci_039                 4.951289e-03 3 1  ON 38
ci_040                 5.520073e-03 3 1  ON 39
ci_041                 5.549229e-03 3 1  ON 40
ci_042                 5.093303e-03 3 1  ON 41
ci_043                 4.592013e-03 3 1  ON 42
ci_044                 5.286673e-03 3 1  ON 43
ci_045                 5.310905e-03 3 1  ON 44
ci_046                 3.685450e-03 3 1  ON 45
ci_047                -9.368597e-04 3 1  ON 46
ci_048                -1.338865e-03 3 1  ON 47
ci_049                 1.448465e-03 3 1  ON 48
ci_050                 1.164996e-03 3 1  ON 49
ci_051                -2.105406e-03 3 1  ON 50
ci_052                -1.875409e-03 3 1  ON 51
ci_053                -7.665742e-04 3 1  ON 52
ci_054                -3.481425e-03 3 1  ON 53
ci_055                -1.674526e-03 3 1  ON 54
ci_056                -1.201476e-03 3 1  ON 55
ci_057                -1.384561e-03 3 1  ON 56
ci_058                -5.995457e-04 3 1  ON 57
ci_059                -3.526744e-04 3 1  ON 58
ci_060                 3.548995e-05 3 1  ON 59
ci_061                 6.521331e-04 3 1  ON 60
ci_062                -8.956553e-04 3 1  ON 61
ci_063                 3.975173e-04 3 1  ON 62
ci_064                 6.781058e-06 3 1  ON 63
ci_065                -2.332651e-03 3 1  ON 64
ci_066                -3.755300e-03 3 1  ON 65
ci_067                -1.222005e-03 3 1  ON 66
ci_068                -1.981583e-03 3 1  ON 67
ci_069                -6.355916e-05 3 1  ON 68
ci_070                 1.035058e-03 3 1  ON 69
ci_071                -1.525578e-03 3 1  ON 70
ci_072                -1.697302e-03 3 1  ON 71
ci_073                 4.268796e-04 3 1  ON 72
ci_074                 1.264548e-04 3 1  ON 73
ci_075                -4.887834e-05 3 1  ON 74
ci_076                 2.110221e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 14
    time step          = 0.05
    reference energy   = -22.5731
    reference variance = 0.389592
====================================================
  Execution time = 2.5510e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORMN2LMC.s014
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2669e+01
  VMC Evar = 4.9931e-01
  Total weights = 1.9552e+06
  Execution time = 3.6294e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.485630806035
                                         uncertainty =       0.002434179400

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.485630806035
                                         uncertainty =       0.002434179400

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000492758569
  error estimate for blocks of size 2^( 2) =       0.000511668371
  error estimate for blocks of size 2^( 3) =       0.000528276577
  error estimate for blocks of size 2^( 4) =       0.000540110263
  error estimate for blocks of size 2^( 5) =       0.000547780866
  error estimate for blocks of size 2^( 6) =       0.000551187478
  error estimate for blocks of size 2^( 7) =       0.000554477064

      target function =                  N/A
              le_mean =     -22.668537539128
             les_mean =     514.361899244530
             stat err =       0.000548388918
             autocorr =       1.238536952642
              std dev =       0.696865851167
             le_variance =       0.485622014522

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.485630805998
                                         uncertainty =       0.002434179398

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.485630805998
                                         uncertainty =       0.002434179398

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000492758569
  error estimate for blocks of size 2^( 2) =       0.000511668371
  error estimate for blocks of size 2^( 3) =       0.000528276577
  error estimate for blocks of size 2^( 4) =       0.000540110263
  error estimate for blocks of size 2^( 5) =       0.000547780866
  error estimate for blocks of size 2^( 6) =       0.000551187478
  error estimate for blocks of size 2^( 7) =       0.000554477064

      target function =                  N/A
              le_mean =     -22.668537539127
             les_mean =     514.361899244475
             stat err =       0.000548388918
             autocorr =       1.238536952673
              std dev =       0.696865851140
             le_variance =       0.485622014485

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.485630806016
                                         uncertainty =       0.002434179399

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.485630806016
                                         uncertainty =       0.002434179399

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000492758569
  error estimate for blocks of size 2^( 2) =       0.000511668371
  error estimate for blocks of size 2^( 3) =       0.000528276577
  error estimate for blocks of size 2^( 4) =       0.000540110263
  error estimate for blocks of size 2^( 5) =       0.000547780866
  error estimate for blocks of size 2^( 6) =       0.000551187478
  error estimate for blocks of size 2^( 7) =       0.000554477064

      target function =                  N/A
              le_mean =     -22.668537539128
             les_mean =     514.361899244502
             stat err =       0.000548388918
             autocorr =       1.238536952664
              std dev =       0.696865851153
             le_variance =       0.485622014503

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.485630806033
                                         uncertainty =       0.002434179400

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.485630806033
                                         uncertainty =       0.002434179400

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000492758569
  error estimate for blocks of size 2^( 2) =       0.000511668371
  error estimate for blocks of size 2^( 3) =       0.000528276577
  error estimate for blocks of size 2^( 4) =       0.000540110263
  error estimate for blocks of size 2^( 5) =       0.000547780866
  error estimate for blocks of size 2^( 6) =       0.000551187478
  error estimate for blocks of size 2^( 7) =       0.000554477064

      target function =                  N/A
              le_mean =     -22.668537539128
             les_mean =     514.361899244527
             stat err =       0.000548388918
             autocorr =       1.238536952647
              std dev =       0.696865851165
             le_variance =       0.485622014520


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.668537539128        initial  <--
     3.9062e+06     3.9062e+07             1.5032e-10       -22.668537539127
     1.5625e+07     1.5625e+08             3.7580e-11       -22.668537539128
     6.2500e+07     6.2500e+08             9.3949e-12       -22.668537539128

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 43.7146
  </log>
  <optVariables href="FORMN2LMC.s014.opt.xml">
ci_001                -7.055327e-01 3 1  ON 0
ci_002                -7.048097e-01 3 1  ON 1
ci_003                -4.353277e-02 3 1  ON 2
ci_004                -4.680020e-02 3 1  ON 3
ci_005                 1.784321e-02 3 1  ON 4
ci_006                 1.734968e-02 3 1  ON 5
ci_007                 1.438248e-02 3 1  ON 6
ci_008                 1.432656e-02 3 1  ON 7
ci_009                -1.229318e-02 3 1  ON 8
ci_010                -1.096179e-02 3 1  ON 9
ci_011                -9.351550e-03 3 1  ON 10
ci_012                -9.929923e-03 3 1  ON 11
ci_013                 9.950207e-03 3 1  ON 12
ci_014                 1.043986e-02 3 1  ON 13
ci_015                 1.194561e-02 3 1  ON 14
ci_016                 1.407097e-02 3 1  ON 15
ci_017                 9.943053e-03 3 1  ON 16
ci_018                 1.157328e-02 3 1  ON 17
ci_019                 9.065786e-04 3 1  ON 18
ci_020                 1.495805e-03 3 1  ON 19
ci_021                -7.102706e-03 3 1  ON 20
ci_022                -7.001544e-03 3 1  ON 21
ci_023                 8.047041e-03 3 1  ON 22
ci_024                 7.299319e-03 3 1  ON 23
ci_025                 4.584343e-03 3 1  ON 24
ci_026                 4.167134e-03 3 1  ON 25
ci_027                 6.614779e-03 3 1  ON 26
ci_028                 6.795576e-03 3 1  ON 27
ci_029                -5.267990e-03 3 1  ON 28
ci_030                -5.077173e-03 3 1  ON 29
ci_031                -6.354327e-03 3 1  ON 30
ci_032                -7.605491e-03 3 1  ON 31
ci_033                 3.830761e-03 3 1  ON 32
ci_034                 4.927241e-03 3 1  ON 33
ci_035                 1.481403e-03 3 1  ON 34
ci_036                 1.321891e-03 3 1  ON 35
ci_037                 4.657920e-03 3 1  ON 36
ci_038                 5.660503e-03 3 1  ON 37
ci_039                 4.951289e-03 3 1  ON 38
ci_040                 5.520073e-03 3 1  ON 39
ci_041                 5.549229e-03 3 1  ON 40
ci_042                 5.093303e-03 3 1  ON 41
ci_043                 4.592013e-03 3 1  ON 42
ci_044                 5.286673e-03 3 1  ON 43
ci_045                 5.310905e-03 3 1  ON 44
ci_046                 3.685450e-03 3 1  ON 45
ci_047                -9.368597e-04 3 1  ON 46
ci_048                -1.338865e-03 3 1  ON 47
ci_049                 1.448465e-03 3 1  ON 48
ci_050                 1.164996e-03 3 1  ON 49
ci_051                -2.105406e-03 3 1  ON 50
ci_052                -1.875409e-03 3 1  ON 51
ci_053                -7.665742e-04 3 1  ON 52
ci_054                -3.481425e-03 3 1  ON 53
ci_055                -1.674526e-03 3 1  ON 54
ci_056                -1.201476e-03 3 1  ON 55
ci_057                -1.384561e-03 3 1  ON 56
ci_058                -5.995457e-04 3 1  ON 57
ci_059                -3.526745e-04 3 1  ON 58
ci_060                 3.548996e-05 3 1  ON 59
ci_061                 6.521331e-04 3 1  ON 60
ci_062                -8.956553e-04 3 1  ON 61
ci_063                 3.975173e-04 3 1  ON 62
ci_064                 6.781061e-06 3 1  ON 63
ci_065                -2.332651e-03 3 1  ON 64
ci_066                -3.755300e-03 3 1  ON 65
ci_067                -1.222005e-03 3 1  ON 66
ci_068                -1.981583e-03 3 1  ON 67
ci_069                -6.355916e-05 3 1  ON 68
ci_070                 1.035058e-03 3 1  ON 69
ci_071                -1.525578e-03 3 1  ON 70
ci_072                -1.697302e-03 3 1  ON 71
ci_073                 4.268796e-04 3 1  ON 72
ci_074                 1.264548e-04 3 1  ON 73
ci_075                -4.887833e-05 3 1  ON 74
ci_076                 2.110221e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.4615e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORMN2LMC.s015 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORMN2LMC.s015 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=15  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2662e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 15
    time step          = 0.05
    reference energy   = -22.6586
    reference variance = 0.391574
====================================================
  Execution time = 2.6114e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORMN2LMC.s015
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5265e+04
  VMC Eavg = -2.2669e+01
  VMC Evar = 5.0255e-01
  Total weights = 1.955068798e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.7450e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.489911697957
                                         uncertainty =       0.002869004898

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.489911697957
                                         uncertainty =       0.002869004898

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000494997408
  error estimate for blocks of size 2^( 2) =       0.000513268449
  error estimate for blocks of size 2^( 3) =       0.000530669978
  error estimate for blocks of size 2^( 4) =       0.000542442616
  error estimate for blocks of size 2^( 5) =       0.000548776042
  error estimate for blocks of size 2^( 6) =       0.000551490788
  error estimate for blocks of size 2^( 7) =       0.000552891786

      target function =                  N/A
              le_mean =     -22.668814850179
             les_mean =     514.377712038629
             stat err =       0.000548900308
             autocorr =       1.229648827694
              std dev =       0.700032047118
             le_variance =       0.490044866992


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266881485018e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.9062e+07, overlap shift 3.9062e+08 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.668814850301       residual = 2.85e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.668814850301       residual = 3.94e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.668814850301       residual = 9.13e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.668814850301       residual = 2.71e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 3.9062e+07 is 1.623404e-11

solving harmonic davidson linear method for identity shift 1.5625e+08, overlap shift 1.5625e+09 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.668814850301       residual = 2.85e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.668814850301       residual = 3.94e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.668814850301       residual = 9.13e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.668814850301       residual = 2.71e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 1.5625e+08 is 4.058509e-12

solving harmonic davidson linear method for identity shift 6.2500e+08, overlap shift 6.2500e+09 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.668814850301       residual = 2.85e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.668814850301       residual = 3.94e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.668814850301       residual = 9.13e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.668814850301       residual = 2.73e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 6.2500e+08 is 1.014495e-12

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.128179 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0869e+01
  </log>
  <optVariables href="FORMN2LMC.s015.opt.xml">
ci_001                -7.055327e-01 3 1  ON 0
ci_002                -7.048097e-01 3 1  ON 1
ci_003                -4.353277e-02 3 1  ON 2
ci_004                -4.680020e-02 3 1  ON 3
ci_005                 1.784321e-02 3 1  ON 4
ci_006                 1.734968e-02 3 1  ON 5
ci_007                 1.438248e-02 3 1  ON 6
ci_008                 1.432656e-02 3 1  ON 7
ci_009                -1.229318e-02 3 1  ON 8
ci_010                -1.096179e-02 3 1  ON 9
ci_011                -9.351550e-03 3 1  ON 10
ci_012                -9.929923e-03 3 1  ON 11
ci_013                 9.950207e-03 3 1  ON 12
ci_014                 1.043986e-02 3 1  ON 13
ci_015                 1.194561e-02 3 1  ON 14
ci_016                 1.407097e-02 3 1  ON 15
ci_017                 9.943053e-03 3 1  ON 16
ci_018                 1.157328e-02 3 1  ON 17
ci_019                 9.065786e-04 3 1  ON 18
ci_020                 1.495805e-03 3 1  ON 19
ci_021                -7.102706e-03 3 1  ON 20
ci_022                -7.001544e-03 3 1  ON 21
ci_023                 8.047041e-03 3 1  ON 22
ci_024                 7.299319e-03 3 1  ON 23
ci_025                 4.584343e-03 3 1  ON 24
ci_026                 4.167134e-03 3 1  ON 25
ci_027                 6.614779e-03 3 1  ON 26
ci_028                 6.795576e-03 3 1  ON 27
ci_029                -5.267990e-03 3 1  ON 28
ci_030                -5.077173e-03 3 1  ON 29
ci_031                -6.354327e-03 3 1  ON 30
ci_032                -7.605491e-03 3 1  ON 31
ci_033                 3.830761e-03 3 1  ON 32
ci_034                 4.927241e-03 3 1  ON 33
ci_035                 1.481403e-03 3 1  ON 34
ci_036                 1.321891e-03 3 1  ON 35
ci_037                 4.657920e-03 3 1  ON 36
ci_038                 5.660503e-03 3 1  ON 37
ci_039                 4.951289e-03 3 1  ON 38
ci_040                 5.520073e-03 3 1  ON 39
ci_041                 5.549229e-03 3 1  ON 40
ci_042                 5.093303e-03 3 1  ON 41
ci_043                 4.592013e-03 3 1  ON 42
ci_044                 5.286673e-03 3 1  ON 43
ci_045                 5.310905e-03 3 1  ON 44
ci_046                 3.685450e-03 3 1  ON 45
ci_047                -9.368597e-04 3 1  ON 46
ci_048                -1.338865e-03 3 1  ON 47
ci_049                 1.448465e-03 3 1  ON 48
ci_050                 1.164996e-03 3 1  ON 49
ci_051                -2.105406e-03 3 1  ON 50
ci_052                -1.875409e-03 3 1  ON 51
ci_053                -7.665742e-04 3 1  ON 52
ci_054                -3.481425e-03 3 1  ON 53
ci_055                -1.674526e-03 3 1  ON 54
ci_056                -1.201476e-03 3 1  ON 55
ci_057                -1.384561e-03 3 1  ON 56
ci_058                -5.995457e-04 3 1  ON 57
ci_059                -3.526745e-04 3 1  ON 58
ci_060                 3.548996e-05 3 1  ON 59
ci_061                 6.521331e-04 3 1  ON 60
ci_062                -8.956553e-04 3 1  ON 61
ci_063                 3.975173e-04 3 1  ON 62
ci_064                 6.781062e-06 3 1  ON 63
ci_065                -2.332651e-03 3 1  ON 64
ci_066                -3.755300e-03 3 1  ON 65
ci_067                -1.222005e-03 3 1  ON 66
ci_068                -1.981583e-03 3 1  ON 67
ci_069                -6.355916e-05 3 1  ON 68
ci_070                 1.035058e-03 3 1  ON 69
ci_071                -1.525578e-03 3 1  ON 70
ci_072                -1.697302e-03 3 1  ON 71
ci_073                 4.268796e-04 3 1  ON 72
ci_074                 1.264548e-04 3 1  ON 73
ci_075                -4.887833e-05 3 1  ON 74
ci_076                 2.110221e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 15
    time step          = 0.05
    reference energy   = -22.6427
    reference variance = 0.755229
====================================================
  Execution time = 2.5617e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORMN2LMC.s015
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2669e+01
  VMC Evar = 4.9855e-01
  Total weights = 1.9551e+06
  Execution time = 3.6363e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.484627185380
                                         uncertainty =       0.002368454300

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.484627185380
                                         uncertainty =       0.002368454300

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000492330389
  error estimate for blocks of size 2^( 2) =       0.000510670543
  error estimate for blocks of size 2^( 3) =       0.000527660313
  error estimate for blocks of size 2^( 4) =       0.000539222134
  error estimate for blocks of size 2^( 5) =       0.000546997406
  error estimate for blocks of size 2^( 6) =       0.000552146293
  error estimate for blocks of size 2^( 7) =       0.000556132337

      target function =                  N/A
              le_mean =     -22.669319284566
             les_mean =     514.396582504267
             stat err =       0.000548624543
             autocorr =       1.241758603615
              std dev =       0.696260312678
             le_variance =       0.484778423011

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.484627185379
                                         uncertainty =       0.002368454300

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.484627185379
                                         uncertainty =       0.002368454300

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000492330389
  error estimate for blocks of size 2^( 2) =       0.000510670543
  error estimate for blocks of size 2^( 3) =       0.000527660313
  error estimate for blocks of size 2^( 4) =       0.000539222134
  error estimate for blocks of size 2^( 5) =       0.000546997406
  error estimate for blocks of size 2^( 6) =       0.000552146293
  error estimate for blocks of size 2^( 7) =       0.000556132337

      target function =                  N/A
              le_mean =     -22.669319284566
             les_mean =     514.396582504055
             stat err =       0.000548624543
             autocorr =       1.241758603614
              std dev =       0.696260312678
             le_variance =       0.484778423010

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.484627185379
                                         uncertainty =       0.002368454300

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.484627185379
                                         uncertainty =       0.002368454300

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000492330389
  error estimate for blocks of size 2^( 2) =       0.000510670543
  error estimate for blocks of size 2^( 3) =       0.000527660313
  error estimate for blocks of size 2^( 4) =       0.000539222134
  error estimate for blocks of size 2^( 5) =       0.000546997406
  error estimate for blocks of size 2^( 6) =       0.000552146293
  error estimate for blocks of size 2^( 7) =       0.000556132337

      target function =                  N/A
              le_mean =     -22.669319284566
             les_mean =     514.396582504161
             stat err =       0.000548624543
             autocorr =       1.241758603611
              std dev =       0.696260312678
             le_variance =       0.484778423010

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.484627185380
                                         uncertainty =       0.002368454300

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.484627185380
                                         uncertainty =       0.002368454300

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000492330389
  error estimate for blocks of size 2^( 2) =       0.000510670543
  error estimate for blocks of size 2^( 3) =       0.000527660313
  error estimate for blocks of size 2^( 4) =       0.000539222134
  error estimate for blocks of size 2^( 5) =       0.000546997406
  error estimate for blocks of size 2^( 6) =       0.000552146293
  error estimate for blocks of size 2^( 7) =       0.000556132337

      target function =                  N/A
              le_mean =     -22.669319284566
             les_mean =     514.396582504253
             stat err =       0.000548624543
             autocorr =       1.241758603611
              std dev =       0.696260312678
             le_variance =       0.484778423011


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.669319284566        initial
     3.9062e+07     3.9062e+08             1.6234e-11       -22.669319284566  <--
     1.5625e+08     1.5625e+09             4.0585e-12       -22.669319284566
     6.2500e+08     6.2500e+09             1.0145e-12       -22.669319284566

*****************************************************************************
Applying the update for shift_i =   3.9062e+07     and shift_s =   3.9062e+08
*****************************************************************************

  Execution time = 4.3850e+01
  </log>
  <optVariables href="FORMN2LMC.s015.opt.xml">
ci_001                -7.055327e-01 3 1  ON 0
ci_002                -7.048097e-01 3 1  ON 1
ci_003                -4.353277e-02 3 1  ON 2
ci_004                -4.680020e-02 3 1  ON 3
ci_005                 1.784321e-02 3 1  ON 4
ci_006                 1.734968e-02 3 1  ON 5
ci_007                 1.438248e-02 3 1  ON 6
ci_008                 1.432656e-02 3 1  ON 7
ci_009                -1.229318e-02 3 1  ON 8
ci_010                -1.096179e-02 3 1  ON 9
ci_011                -9.351550e-03 3 1  ON 10
ci_012                -9.929923e-03 3 1  ON 11
ci_013                 9.950207e-03 3 1  ON 12
ci_014                 1.043986e-02 3 1  ON 13
ci_015                 1.194561e-02 3 1  ON 14
ci_016                 1.407097e-02 3 1  ON 15
ci_017                 9.943053e-03 3 1  ON 16
ci_018                 1.157328e-02 3 1  ON 17
ci_019                 9.065786e-04 3 1  ON 18
ci_020                 1.495805e-03 3 1  ON 19
ci_021                -7.102706e-03 3 1  ON 20
ci_022                -7.001544e-03 3 1  ON 21
ci_023                 8.047041e-03 3 1  ON 22
ci_024                 7.299319e-03 3 1  ON 23
ci_025                 4.584343e-03 3 1  ON 24
ci_026                 4.167134e-03 3 1  ON 25
ci_027                 6.614779e-03 3 1  ON 26
ci_028                 6.795576e-03 3 1  ON 27
ci_029                -5.267990e-03 3 1  ON 28
ci_030                -5.077173e-03 3 1  ON 29
ci_031                -6.354327e-03 3 1  ON 30
ci_032                -7.605491e-03 3 1  ON 31
ci_033                 3.830761e-03 3 1  ON 32
ci_034                 4.927241e-03 3 1  ON 33
ci_035                 1.481403e-03 3 1  ON 34
ci_036                 1.321891e-03 3 1  ON 35
ci_037                 4.657920e-03 3 1  ON 36
ci_038                 5.660503e-03 3 1  ON 37
ci_039                 4.951289e-03 3 1  ON 38
ci_040                 5.520073e-03 3 1  ON 39
ci_041                 5.549229e-03 3 1  ON 40
ci_042                 5.093303e-03 3 1  ON 41
ci_043                 4.592013e-03 3 1  ON 42
ci_044                 5.286673e-03 3 1  ON 43
ci_045                 5.310905e-03 3 1  ON 44
ci_046                 3.685450e-03 3 1  ON 45
ci_047                -9.368597e-04 3 1  ON 46
ci_048                -1.338865e-03 3 1  ON 47
ci_049                 1.448465e-03 3 1  ON 48
ci_050                 1.164996e-03 3 1  ON 49
ci_051                -2.105406e-03 3 1  ON 50
ci_052                -1.875409e-03 3 1  ON 51
ci_053                -7.665742e-04 3 1  ON 52
ci_054                -3.481425e-03 3 1  ON 53
ci_055                -1.674526e-03 3 1  ON 54
ci_056                -1.201476e-03 3 1  ON 55
ci_057                -1.384561e-03 3 1  ON 56
ci_058                -5.995457e-04 3 1  ON 57
ci_059                -3.526745e-04 3 1  ON 58
ci_060                 3.548995e-05 3 1  ON 59
ci_061                 6.521331e-04 3 1  ON 60
ci_062                -8.956553e-04 3 1  ON 61
ci_063                 3.975173e-04 3 1  ON 62
ci_064                 6.781066e-06 3 1  ON 63
ci_065                -2.332651e-03 3 1  ON 64
ci_066                -3.755300e-03 3 1  ON 65
ci_067                -1.222005e-03 3 1  ON 66
ci_068                -1.981583e-03 3 1  ON 67
ci_069                -6.355916e-05 3 1  ON 68
ci_070                 1.035058e-03 3 1  ON 69
ci_071                -1.525578e-03 3 1  ON 70
ci_072                -1.697302e-03 3 1  ON 71
ci_073                 4.268796e-04 3 1  ON 72
ci_074                 1.264549e-04 3 1  ON 73
ci_075                -4.887833e-05 3 1  ON 74
ci_076                 2.110221e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.4725e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORMN2LMC.s016 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORMN2LMC.s016 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=16  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2661e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 16
    time step          = 0.05
    reference energy   = -22.7008
    reference variance = 0.294683
====================================================
  Execution time = 2.6197e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORMN2LMC.s016
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5257e+04
  VMC Eavg = -2.2669e+01
  VMC Evar = 4.9903e-01
  Total weights = 1.955104838e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.7711e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.487379873353
                                         uncertainty =       0.002822841492

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.487379873353
                                         uncertainty =       0.002822841492

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000493676208
  error estimate for blocks of size 2^( 2) =       0.000512444617
  error estimate for blocks of size 2^( 3) =       0.000528553627
  error estimate for blocks of size 2^( 4) =       0.000541255276
  error estimate for blocks of size 2^( 5) =       0.000547166920
  error estimate for blocks of size 2^( 6) =       0.000552259792
  error estimate for blocks of size 2^( 7) =       0.000553739011

      target function =                  N/A
              le_mean =     -22.669088391315
             les_mean =     514.386601593302
             stat err =       0.000548605250
             autocorr =       1.234910615580
              std dev =       0.698163588427
             le_variance =       0.487432396205


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266908839132e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.7656e+06, overlap shift 9.7656e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.669088391431       residual = 2.01e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.669088391432       residual = 2.57e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.669088391432       residual = 1.07e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.669088387211       residual = 3.63e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 9.7656e+06 is 4.390146e-11

solving harmonic davidson linear method for identity shift 3.9062e+07, overlap shift 3.9062e+08 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.669088391431       residual = 2.01e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.669088391432       residual = 2.57e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.669088391432       residual = 1.07e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.669088391432       residual = 3.63e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 3.9062e+07 is 1.097540e-11

solving harmonic davidson linear method for identity shift 1.5625e+08, overlap shift 1.5625e+09 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.669088391431       residual = 2.01e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.669088391432       residual = 2.57e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.669088391432       residual = 1.07e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.669088363408       residual = 3.63e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 1.5625e+08 is 2.743844e-12

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.129506 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0979e+01
  </log>
  <optVariables href="FORMN2LMC.s016.opt.xml">
ci_001                -7.055327e-01 3 1  ON 0
ci_002                -7.048097e-01 3 1  ON 1
ci_003                -4.353277e-02 3 1  ON 2
ci_004                -4.680020e-02 3 1  ON 3
ci_005                 1.784321e-02 3 1  ON 4
ci_006                 1.734968e-02 3 1  ON 5
ci_007                 1.438248e-02 3 1  ON 6
ci_008                 1.432656e-02 3 1  ON 7
ci_009                -1.229318e-02 3 1  ON 8
ci_010                -1.096179e-02 3 1  ON 9
ci_011                -9.351550e-03 3 1  ON 10
ci_012                -9.929923e-03 3 1  ON 11
ci_013                 9.950207e-03 3 1  ON 12
ci_014                 1.043986e-02 3 1  ON 13
ci_015                 1.194561e-02 3 1  ON 14
ci_016                 1.407097e-02 3 1  ON 15
ci_017                 9.943053e-03 3 1  ON 16
ci_018                 1.157328e-02 3 1  ON 17
ci_019                 9.065786e-04 3 1  ON 18
ci_020                 1.495805e-03 3 1  ON 19
ci_021                -7.102706e-03 3 1  ON 20
ci_022                -7.001544e-03 3 1  ON 21
ci_023                 8.047041e-03 3 1  ON 22
ci_024                 7.299319e-03 3 1  ON 23
ci_025                 4.584343e-03 3 1  ON 24
ci_026                 4.167134e-03 3 1  ON 25
ci_027                 6.614779e-03 3 1  ON 26
ci_028                 6.795576e-03 3 1  ON 27
ci_029                -5.267990e-03 3 1  ON 28
ci_030                -5.077173e-03 3 1  ON 29
ci_031                -6.354327e-03 3 1  ON 30
ci_032                -7.605491e-03 3 1  ON 31
ci_033                 3.830761e-03 3 1  ON 32
ci_034                 4.927241e-03 3 1  ON 33
ci_035                 1.481403e-03 3 1  ON 34
ci_036                 1.321891e-03 3 1  ON 35
ci_037                 4.657920e-03 3 1  ON 36
ci_038                 5.660503e-03 3 1  ON 37
ci_039                 4.951289e-03 3 1  ON 38
ci_040                 5.520073e-03 3 1  ON 39
ci_041                 5.549229e-03 3 1  ON 40
ci_042                 5.093303e-03 3 1  ON 41
ci_043                 4.592013e-03 3 1  ON 42
ci_044                 5.286673e-03 3 1  ON 43
ci_045                 5.310905e-03 3 1  ON 44
ci_046                 3.685450e-03 3 1  ON 45
ci_047                -9.368597e-04 3 1  ON 46
ci_048                -1.338865e-03 3 1  ON 47
ci_049                 1.448465e-03 3 1  ON 48
ci_050                 1.164996e-03 3 1  ON 49
ci_051                -2.105406e-03 3 1  ON 50
ci_052                -1.875409e-03 3 1  ON 51
ci_053                -7.665742e-04 3 1  ON 52
ci_054                -3.481425e-03 3 1  ON 53
ci_055                -1.674526e-03 3 1  ON 54
ci_056                -1.201476e-03 3 1  ON 55
ci_057                -1.384561e-03 3 1  ON 56
ci_058                -5.995457e-04 3 1  ON 57
ci_059                -3.526745e-04 3 1  ON 58
ci_060                 3.548996e-05 3 1  ON 59
ci_061                 6.521331e-04 3 1  ON 60
ci_062                -8.956553e-04 3 1  ON 61
ci_063                 3.975173e-04 3 1  ON 62
ci_064                 6.781064e-06 3 1  ON 63
ci_065                -2.332651e-03 3 1  ON 64
ci_066                -3.755300e-03 3 1  ON 65
ci_067                -1.222005e-03 3 1  ON 66
ci_068                -1.981583e-03 3 1  ON 67
ci_069                -6.355917e-05 3 1  ON 68
ci_070                 1.035058e-03 3 1  ON 69
ci_071                -1.525578e-03 3 1  ON 70
ci_072                -1.697302e-03 3 1  ON 71
ci_073                 4.268795e-04 3 1  ON 72
ci_074                 1.264548e-04 3 1  ON 73
ci_075                -4.887833e-05 3 1  ON 74
ci_076                 2.110221e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 16
    time step          = 0.05
    reference energy   = -22.6848
    reference variance = 0.418103
====================================================
  Execution time = 2.5656e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORMN2LMC.s016
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2669e+01
  VMC Evar = 4.9570e-01
  Total weights = 1.9553e+06
  Execution time = 4.0860e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.484201811565
                                         uncertainty =       0.002473656778

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.484201811565
                                         uncertainty =       0.002473656778

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000492043431
  error estimate for blocks of size 2^( 2) =       0.000510550337
  error estimate for blocks of size 2^( 3) =       0.000526978195
  error estimate for blocks of size 2^( 4) =       0.000538451369
  error estimate for blocks of size 2^( 5) =       0.000546556776
  error estimate for blocks of size 2^( 6) =       0.000550450096
  error estimate for blocks of size 2^( 7) =       0.000551506369

      target function =                  N/A
              le_mean =     -22.669463904914
             les_mean =     514.400288917705
             stat err =       0.000546741153
             autocorr =       1.234686365546
              std dev =       0.695854492861
             le_variance =       0.484213475235

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.484201811561
                                         uncertainty =       0.002473656777

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.484201811561
                                         uncertainty =       0.002473656777

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000492043431
  error estimate for blocks of size 2^( 2) =       0.000510550337
  error estimate for blocks of size 2^( 3) =       0.000526978195
  error estimate for blocks of size 2^( 4) =       0.000538451369
  error estimate for blocks of size 2^( 5) =       0.000546556776
  error estimate for blocks of size 2^( 6) =       0.000550450096
  error estimate for blocks of size 2^( 7) =       0.000551506369

      target function =                  N/A
              le_mean =     -22.669463904913
             les_mean =     514.400288917716
             stat err =       0.000546741153
             autocorr =       1.234686365562
              std dev =       0.695854492858
             le_variance =       0.484213475231

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.484201811563
                                         uncertainty =       0.002473656778

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.484201811563
                                         uncertainty =       0.002473656778

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000492043431
  error estimate for blocks of size 2^( 2) =       0.000510550337
  error estimate for blocks of size 2^( 3) =       0.000526978195
  error estimate for blocks of size 2^( 4) =       0.000538451369
  error estimate for blocks of size 2^( 5) =       0.000546556776
  error estimate for blocks of size 2^( 6) =       0.000550450096
  error estimate for blocks of size 2^( 7) =       0.000551506369

      target function =                  N/A
              le_mean =     -22.669463904913
             les_mean =     514.400288917711
             stat err =       0.000546741153
             autocorr =       1.234686365561
              std dev =       0.695854492860
             le_variance =       0.484213475233

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.484201811565
                                         uncertainty =       0.002473656778

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.484201811565
                                         uncertainty =       0.002473656778

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000492043431
  error estimate for blocks of size 2^( 2) =       0.000510550337
  error estimate for blocks of size 2^( 3) =       0.000526978195
  error estimate for blocks of size 2^( 4) =       0.000538451369
  error estimate for blocks of size 2^( 5) =       0.000546556776
  error estimate for blocks of size 2^( 6) =       0.000550450096
  error estimate for blocks of size 2^( 7) =       0.000551506369

      target function =                  N/A
              le_mean =     -22.669463904914
             les_mean =     514.400288917706
             stat err =       0.000546741153
             autocorr =       1.234686365553
              std dev =       0.695854492861
             le_variance =       0.484213475235


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.669463904914        initial  <--
     9.7656e+06     9.7656e+07             4.3901e-11       -22.669463904913
     3.9062e+07     3.9062e+08             1.0975e-11       -22.669463904913
     1.5625e+08     1.5625e+09             2.7438e-12       -22.669463904914

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 44.6220
  </log>
  <optVariables href="FORMN2LMC.s016.opt.xml">
ci_001                -7.055327e-01 3 1  ON 0
ci_002                -7.048097e-01 3 1  ON 1
ci_003                -4.353277e-02 3 1  ON 2
ci_004                -4.680020e-02 3 1  ON 3
ci_005                 1.784321e-02 3 1  ON 4
ci_006                 1.734968e-02 3 1  ON 5
ci_007                 1.438248e-02 3 1  ON 6
ci_008                 1.432656e-02 3 1  ON 7
ci_009                -1.229318e-02 3 1  ON 8
ci_010                -1.096179e-02 3 1  ON 9
ci_011                -9.351550e-03 3 1  ON 10
ci_012                -9.929923e-03 3 1  ON 11
ci_013                 9.950207e-03 3 1  ON 12
ci_014                 1.043986e-02 3 1  ON 13
ci_015                 1.194561e-02 3 1  ON 14
ci_016                 1.407097e-02 3 1  ON 15
ci_017                 9.943053e-03 3 1  ON 16
ci_018                 1.157328e-02 3 1  ON 17
ci_019                 9.065786e-04 3 1  ON 18
ci_020                 1.495805e-03 3 1  ON 19
ci_021                -7.102706e-03 3 1  ON 20
ci_022                -7.001544e-03 3 1  ON 21
ci_023                 8.047041e-03 3 1  ON 22
ci_024                 7.299319e-03 3 1  ON 23
ci_025                 4.584343e-03 3 1  ON 24
ci_026                 4.167134e-03 3 1  ON 25
ci_027                 6.614779e-03 3 1  ON 26
ci_028                 6.795576e-03 3 1  ON 27
ci_029                -5.267990e-03 3 1  ON 28
ci_030                -5.077173e-03 3 1  ON 29
ci_031                -6.354327e-03 3 1  ON 30
ci_032                -7.605491e-03 3 1  ON 31
ci_033                 3.830761e-03 3 1  ON 32
ci_034                 4.927241e-03 3 1  ON 33
ci_035                 1.481403e-03 3 1  ON 34
ci_036                 1.321891e-03 3 1  ON 35
ci_037                 4.657920e-03 3 1  ON 36
ci_038                 5.660503e-03 3 1  ON 37
ci_039                 4.951289e-03 3 1  ON 38
ci_040                 5.520073e-03 3 1  ON 39
ci_041                 5.549229e-03 3 1  ON 40
ci_042                 5.093303e-03 3 1  ON 41
ci_043                 4.592013e-03 3 1  ON 42
ci_044                 5.286673e-03 3 1  ON 43
ci_045                 5.310905e-03 3 1  ON 44
ci_046                 3.685450e-03 3 1  ON 45
ci_047                -9.368597e-04 3 1  ON 46
ci_048                -1.338865e-03 3 1  ON 47
ci_049                 1.448465e-03 3 1  ON 48
ci_050                 1.164996e-03 3 1  ON 49
ci_051                -2.105406e-03 3 1  ON 50
ci_052                -1.875409e-03 3 1  ON 51
ci_053                -7.665742e-04 3 1  ON 52
ci_054                -3.481425e-03 3 1  ON 53
ci_055                -1.674526e-03 3 1  ON 54
ci_056                -1.201476e-03 3 1  ON 55
ci_057                -1.384561e-03 3 1  ON 56
ci_058                -5.995457e-04 3 1  ON 57
ci_059                -3.526745e-04 3 1  ON 58
ci_060                 3.548995e-05 3 1  ON 59
ci_061                 6.521331e-04 3 1  ON 60
ci_062                -8.956553e-04 3 1  ON 61
ci_063                 3.975173e-04 3 1  ON 62
ci_064                 6.781066e-06 3 1  ON 63
ci_065                -2.332651e-03 3 1  ON 64
ci_066                -3.755300e-03 3 1  ON 65
ci_067                -1.222005e-03 3 1  ON 66
ci_068                -1.981583e-03 3 1  ON 67
ci_069                -6.355916e-05 3 1  ON 68
ci_070                 1.035058e-03 3 1  ON 69
ci_071                -1.525578e-03 3 1  ON 70
ci_072                -1.697302e-03 3 1  ON 71
ci_073                 4.268796e-04 3 1  ON 72
ci_074                 1.264549e-04 3 1  ON 73
ci_075                -4.887833e-05 3 1  ON 74
ci_076                 2.110221e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.5606e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORMN2LMC.s017 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORMN2LMC.s017 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=17  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2663e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 17
    time step          = 0.05
    reference energy   = -22.7334
    reference variance = 0.446447
====================================================
  Execution time = 2.6240e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORMN2LMC.s017
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5273e+04
  VMC Eavg = -2.2669e+01
  VMC Evar = 4.9387e-01
  Total weights = 1.954977659e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.7341e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.482441311717
                                         uncertainty =       0.002482022057

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.482441311717
                                         uncertainty =       0.002482022057

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000491119308
  error estimate for blocks of size 2^( 2) =       0.000510017606
  error estimate for blocks of size 2^( 3) =       0.000527203360
  error estimate for blocks of size 2^( 4) =       0.000539131163
  error estimate for blocks of size 2^( 5) =       0.000545519701
  error estimate for blocks of size 2^( 6) =       0.000551521923
  error estimate for blocks of size 2^( 7) =       0.000552566263

      target function =                  N/A
              le_mean =     -22.668576690098
             les_mean =     514.358238580121
             stat err =       0.000547184762
             autocorr =       1.241349213466
              std dev =       0.694547585666
             le_variance =       0.482396348755


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266857669010e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.7656e+07, overlap shift 9.7656e+08 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.668576690183       residual = 2.13e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.668576690183       residual = 3.40e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.668576690183       residual = 1.04e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.668576690183       residual = 3.41e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 9.7656e+07 is 6.019476e-12

solving harmonic davidson linear method for identity shift 3.9062e+08, overlap shift 3.9062e+09 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.668576690183       residual = 2.13e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.668576690183       residual = 3.40e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.668576690183       residual = 1.04e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.668576690183       residual = 3.40e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 3.9062e+08 is 1.504888e-12

solving harmonic davidson linear method for identity shift 1.5625e+09, overlap shift 1.5625e+10 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.668576690183       residual = 2.13e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.668576690183       residual = 3.40e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.668576690183       residual = 1.04e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.668576690183       residual = 3.45e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 1.5625e+09 is 3.761327e-13

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.130860 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0984e+01
  </log>
  <optVariables href="FORMN2LMC.s017.opt.xml">
ci_001                -7.055327e-01 3 1  ON 0
ci_002                -7.048097e-01 3 1  ON 1
ci_003                -4.353277e-02 3 1  ON 2
ci_004                -4.680020e-02 3 1  ON 3
ci_005                 1.784321e-02 3 1  ON 4
ci_006                 1.734968e-02 3 1  ON 5
ci_007                 1.438248e-02 3 1  ON 6
ci_008                 1.432656e-02 3 1  ON 7
ci_009                -1.229318e-02 3 1  ON 8
ci_010                -1.096179e-02 3 1  ON 9
ci_011                -9.351550e-03 3 1  ON 10
ci_012                -9.929923e-03 3 1  ON 11
ci_013                 9.950207e-03 3 1  ON 12
ci_014                 1.043986e-02 3 1  ON 13
ci_015                 1.194561e-02 3 1  ON 14
ci_016                 1.407097e-02 3 1  ON 15
ci_017                 9.943053e-03 3 1  ON 16
ci_018                 1.157328e-02 3 1  ON 17
ci_019                 9.065786e-04 3 1  ON 18
ci_020                 1.495805e-03 3 1  ON 19
ci_021                -7.102706e-03 3 1  ON 20
ci_022                -7.001544e-03 3 1  ON 21
ci_023                 8.047041e-03 3 1  ON 22
ci_024                 7.299319e-03 3 1  ON 23
ci_025                 4.584343e-03 3 1  ON 24
ci_026                 4.167134e-03 3 1  ON 25
ci_027                 6.614779e-03 3 1  ON 26
ci_028                 6.795576e-03 3 1  ON 27
ci_029                -5.267990e-03 3 1  ON 28
ci_030                -5.077173e-03 3 1  ON 29
ci_031                -6.354327e-03 3 1  ON 30
ci_032                -7.605491e-03 3 1  ON 31
ci_033                 3.830761e-03 3 1  ON 32
ci_034                 4.927241e-03 3 1  ON 33
ci_035                 1.481403e-03 3 1  ON 34
ci_036                 1.321891e-03 3 1  ON 35
ci_037                 4.657920e-03 3 1  ON 36
ci_038                 5.660503e-03 3 1  ON 37
ci_039                 4.951289e-03 3 1  ON 38
ci_040                 5.520073e-03 3 1  ON 39
ci_041                 5.549229e-03 3 1  ON 40
ci_042                 5.093303e-03 3 1  ON 41
ci_043                 4.592013e-03 3 1  ON 42
ci_044                 5.286673e-03 3 1  ON 43
ci_045                 5.310905e-03 3 1  ON 44
ci_046                 3.685450e-03 3 1  ON 45
ci_047                -9.368597e-04 3 1  ON 46
ci_048                -1.338865e-03 3 1  ON 47
ci_049                 1.448465e-03 3 1  ON 48
ci_050                 1.164996e-03 3 1  ON 49
ci_051                -2.105406e-03 3 1  ON 50
ci_052                -1.875409e-03 3 1  ON 51
ci_053                -7.665742e-04 3 1  ON 52
ci_054                -3.481425e-03 3 1  ON 53
ci_055                -1.674526e-03 3 1  ON 54
ci_056                -1.201476e-03 3 1  ON 55
ci_057                -1.384561e-03 3 1  ON 56
ci_058                -5.995457e-04 3 1  ON 57
ci_059                -3.526745e-04 3 1  ON 58
ci_060                 3.548995e-05 3 1  ON 59
ci_061                 6.521331e-04 3 1  ON 60
ci_062                -8.956553e-04 3 1  ON 61
ci_063                 3.975173e-04 3 1  ON 62
ci_064                 6.781066e-06 3 1  ON 63
ci_065                -2.332651e-03 3 1  ON 64
ci_066                -3.755300e-03 3 1  ON 65
ci_067                -1.222005e-03 3 1  ON 66
ci_068                -1.981583e-03 3 1  ON 67
ci_069                -6.355916e-05 3 1  ON 68
ci_070                 1.035058e-03 3 1  ON 69
ci_071                -1.525578e-03 3 1  ON 70
ci_072                -1.697302e-03 3 1  ON 71
ci_073                 4.268796e-04 3 1  ON 72
ci_074                 1.264549e-04 3 1  ON 73
ci_075                -4.887833e-05 3 1  ON 74
ci_076                 2.110221e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 17
    time step          = 0.05
    reference energy   = -22.6262
    reference variance = 0.25627
====================================================
  Execution time = 2.5596e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORMN2LMC.s017
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2669e+01
  VMC Evar = 4.9480e-01
  Total weights = 1.9552e+06
  Execution time = 3.6360e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.482208726699
                                         uncertainty =       0.002348927335

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.482208726699
                                         uncertainty =       0.002348927335

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000491011349
  error estimate for blocks of size 2^( 2) =       0.000509726736
  error estimate for blocks of size 2^( 3) =       0.000526262042
  error estimate for blocks of size 2^( 4) =       0.000538814494
  error estimate for blocks of size 2^( 5) =       0.000545150593
  error estimate for blocks of size 2^( 6) =       0.000547755930
  error estimate for blocks of size 2^( 7) =       0.000550214003

      target function =                  N/A
              le_mean =     -22.669348638884
             les_mean =     514.394168727116
             stat err =       0.000545483755
             autocorr =       1.234185903776
              std dev =       0.694394909322
             le_variance =       0.482184290093

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.482208726698
                                         uncertainty =       0.002348927335

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.482208726698
                                         uncertainty =       0.002348927335

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000491011349
  error estimate for blocks of size 2^( 2) =       0.000509726736
  error estimate for blocks of size 2^( 3) =       0.000526262042
  error estimate for blocks of size 2^( 4) =       0.000538814494
  error estimate for blocks of size 2^( 5) =       0.000545150593
  error estimate for blocks of size 2^( 6) =       0.000547755930
  error estimate for blocks of size 2^( 7) =       0.000550214003

      target function =                  N/A
              le_mean =     -22.669348638884
             les_mean =     514.394168727116
             stat err =       0.000545483755
             autocorr =       1.234185903785
              std dev =       0.694394909322
             le_variance =       0.482184290092

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.482208726698
                                         uncertainty =       0.002348927335

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.482208726698
                                         uncertainty =       0.002348927335

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000491011349
  error estimate for blocks of size 2^( 2) =       0.000509726736
  error estimate for blocks of size 2^( 3) =       0.000526262042
  error estimate for blocks of size 2^( 4) =       0.000538814494
  error estimate for blocks of size 2^( 5) =       0.000545150593
  error estimate for blocks of size 2^( 6) =       0.000547755930
  error estimate for blocks of size 2^( 7) =       0.000550214003

      target function =                  N/A
              le_mean =     -22.669348638884
             les_mean =     514.394168727116
             stat err =       0.000545483755
             autocorr =       1.234185903778
              std dev =       0.694394909322
             le_variance =       0.482184290093

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.482208726699
                                         uncertainty =       0.002348927335

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.482208726699
                                         uncertainty =       0.002348927335

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000491011349
  error estimate for blocks of size 2^( 2) =       0.000509726736
  error estimate for blocks of size 2^( 3) =       0.000526262042
  error estimate for blocks of size 2^( 4) =       0.000538814494
  error estimate for blocks of size 2^( 5) =       0.000545150593
  error estimate for blocks of size 2^( 6) =       0.000547755930
  error estimate for blocks of size 2^( 7) =       0.000550214003

      target function =                  N/A
              le_mean =     -22.669348638884
             les_mean =     514.394168727116
             stat err =       0.000545483755
             autocorr =       1.234185903782
              std dev =       0.694394909322
             le_variance =       0.482184290093


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.669348638884        initial
     9.7656e+07     9.7656e+08             6.0195e-12       -22.669348638884  <--
     3.9062e+08     3.9062e+09             1.5049e-12       -22.669348638884
     1.5625e+09     1.5625e+10             3.7613e-13       -22.669348638884

*****************************************************************************
Applying the update for shift_i =   9.7656e+07     and shift_s =   9.7656e+08
*****************************************************************************

  Execution time = 4.3824e+01
  </log>
  <optVariables href="FORMN2LMC.s017.opt.xml">
ci_001                -7.055327e-01 3 1  ON 0
ci_002                -7.048097e-01 3 1  ON 1
ci_003                -4.353277e-02 3 1  ON 2
ci_004                -4.680020e-02 3 1  ON 3
ci_005                 1.784321e-02 3 1  ON 4
ci_006                 1.734968e-02 3 1  ON 5
ci_007                 1.438248e-02 3 1  ON 6
ci_008                 1.432656e-02 3 1  ON 7
ci_009                -1.229318e-02 3 1  ON 8
ci_010                -1.096179e-02 3 1  ON 9
ci_011                -9.351550e-03 3 1  ON 10
ci_012                -9.929923e-03 3 1  ON 11
ci_013                 9.950207e-03 3 1  ON 12
ci_014                 1.043986e-02 3 1  ON 13
ci_015                 1.194561e-02 3 1  ON 14
ci_016                 1.407097e-02 3 1  ON 15
ci_017                 9.943053e-03 3 1  ON 16
ci_018                 1.157328e-02 3 1  ON 17
ci_019                 9.065786e-04 3 1  ON 18
ci_020                 1.495805e-03 3 1  ON 19
ci_021                -7.102706e-03 3 1  ON 20
ci_022                -7.001544e-03 3 1  ON 21
ci_023                 8.047041e-03 3 1  ON 22
ci_024                 7.299319e-03 3 1  ON 23
ci_025                 4.584343e-03 3 1  ON 24
ci_026                 4.167134e-03 3 1  ON 25
ci_027                 6.614779e-03 3 1  ON 26
ci_028                 6.795576e-03 3 1  ON 27
ci_029                -5.267990e-03 3 1  ON 28
ci_030                -5.077173e-03 3 1  ON 29
ci_031                -6.354327e-03 3 1  ON 30
ci_032                -7.605491e-03 3 1  ON 31
ci_033                 3.830761e-03 3 1  ON 32
ci_034                 4.927241e-03 3 1  ON 33
ci_035                 1.481403e-03 3 1  ON 34
ci_036                 1.321891e-03 3 1  ON 35
ci_037                 4.657920e-03 3 1  ON 36
ci_038                 5.660503e-03 3 1  ON 37
ci_039                 4.951289e-03 3 1  ON 38
ci_040                 5.520073e-03 3 1  ON 39
ci_041                 5.549229e-03 3 1  ON 40
ci_042                 5.093303e-03 3 1  ON 41
ci_043                 4.592013e-03 3 1  ON 42
ci_044                 5.286673e-03 3 1  ON 43
ci_045                 5.310905e-03 3 1  ON 44
ci_046                 3.685450e-03 3 1  ON 45
ci_047                -9.368597e-04 3 1  ON 46
ci_048                -1.338865e-03 3 1  ON 47
ci_049                 1.448465e-03 3 1  ON 48
ci_050                 1.164996e-03 3 1  ON 49
ci_051                -2.105406e-03 3 1  ON 50
ci_052                -1.875409e-03 3 1  ON 51
ci_053                -7.665742e-04 3 1  ON 52
ci_054                -3.481425e-03 3 1  ON 53
ci_055                -1.674526e-03 3 1  ON 54
ci_056                -1.201476e-03 3 1  ON 55
ci_057                -1.384561e-03 3 1  ON 56
ci_058                -5.995457e-04 3 1  ON 57
ci_059                -3.526745e-04 3 1  ON 58
ci_060                 3.548996e-05 3 1  ON 59
ci_061                 6.521331e-04 3 1  ON 60
ci_062                -8.956553e-04 3 1  ON 61
ci_063                 3.975173e-04 3 1  ON 62
ci_064                 6.781065e-06 3 1  ON 63
ci_065                -2.332651e-03 3 1  ON 64
ci_066                -3.755300e-03 3 1  ON 65
ci_067                -1.222005e-03 3 1  ON 66
ci_068                -1.981583e-03 3 1  ON 67
ci_069                -6.355916e-05 3 1  ON 68
ci_070                 1.035058e-03 3 1  ON 69
ci_071                -1.525578e-03 3 1  ON 70
ci_072                -1.697302e-03 3 1  ON 71
ci_073                 4.268796e-04 3 1  ON 72
ci_074                 1.264549e-04 3 1  ON 73
ci_075                -4.887833e-05 3 1  ON 74
ci_076                 2.110221e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.4814e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORMN2LMC.s018 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORMN2LMC.s018 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=18  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2664e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 18
    time step          = 0.05
    reference energy   = -22.5945
    reference variance = 0.421327
====================================================
  Execution time = 2.6225e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORMN2LMC.s018
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5240e+04
  VMC Eavg = -2.2670e+01
  VMC Evar = 5.0170e-01
  Total weights = 1.955312022e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.7840e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.490302660037
                                         uncertainty =       0.003075292970

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.490302660037
                                         uncertainty =       0.003075292970

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000495122919
  error estimate for blocks of size 2^( 2) =       0.000513256327
  error estimate for blocks of size 2^( 3) =       0.000530487074
  error estimate for blocks of size 2^( 4) =       0.000542970319
  error estimate for blocks of size 2^( 5) =       0.000550049474
  error estimate for blocks of size 2^( 6) =       0.000555143727
  error estimate for blocks of size 2^( 7) =       0.000556375609

      target function =                  N/A
              le_mean =     -22.669626545129
             les_mean =     514.413665519354
             stat err =       0.000551134782
             autocorr =       1.239052133866
              std dev =       0.700209547190
             le_variance =       0.490293409976


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266962654513e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.4414e+07, overlap shift 2.4414e+08 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.669626545196       residual = 2.43e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.669626545196       residual = 2.44e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.669626545196       residual = 6.78e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.669626538322       residual = 2.00e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 2.4414e+07 is 2.053867e-11

solving harmonic davidson linear method for identity shift 9.7656e+07, overlap shift 9.7656e+08 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.669626545196       residual = 2.43e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.669626545196       residual = 2.44e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.669626545196       residual = 6.78e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.669626568630       residual = 2.00e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 9.7656e+07 is 5.134642e-12

solving harmonic davidson linear method for identity shift 3.9062e+08, overlap shift 3.9062e+09 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.669626545196       residual = 2.43e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.669626545196       residual = 2.44e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.669626545196       residual = 6.77e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.669626588404       residual = 2.00e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 3.9062e+08 is 1.283696e-12

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.132206 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.1020e+01
  </log>
  <optVariables href="FORMN2LMC.s018.opt.xml">
ci_001                -7.055327e-01 3 1  ON 0
ci_002                -7.048097e-01 3 1  ON 1
ci_003                -4.353277e-02 3 1  ON 2
ci_004                -4.680020e-02 3 1  ON 3
ci_005                 1.784321e-02 3 1  ON 4
ci_006                 1.734968e-02 3 1  ON 5
ci_007                 1.438248e-02 3 1  ON 6
ci_008                 1.432656e-02 3 1  ON 7
ci_009                -1.229318e-02 3 1  ON 8
ci_010                -1.096179e-02 3 1  ON 9
ci_011                -9.351550e-03 3 1  ON 10
ci_012                -9.929923e-03 3 1  ON 11
ci_013                 9.950207e-03 3 1  ON 12
ci_014                 1.043986e-02 3 1  ON 13
ci_015                 1.194561e-02 3 1  ON 14
ci_016                 1.407097e-02 3 1  ON 15
ci_017                 9.943053e-03 3 1  ON 16
ci_018                 1.157328e-02 3 1  ON 17
ci_019                 9.065786e-04 3 1  ON 18
ci_020                 1.495805e-03 3 1  ON 19
ci_021                -7.102706e-03 3 1  ON 20
ci_022                -7.001544e-03 3 1  ON 21
ci_023                 8.047041e-03 3 1  ON 22
ci_024                 7.299319e-03 3 1  ON 23
ci_025                 4.584343e-03 3 1  ON 24
ci_026                 4.167134e-03 3 1  ON 25
ci_027                 6.614779e-03 3 1  ON 26
ci_028                 6.795576e-03 3 1  ON 27
ci_029                -5.267990e-03 3 1  ON 28
ci_030                -5.077173e-03 3 1  ON 29
ci_031                -6.354327e-03 3 1  ON 30
ci_032                -7.605491e-03 3 1  ON 31
ci_033                 3.830761e-03 3 1  ON 32
ci_034                 4.927241e-03 3 1  ON 33
ci_035                 1.481403e-03 3 1  ON 34
ci_036                 1.321891e-03 3 1  ON 35
ci_037                 4.657920e-03 3 1  ON 36
ci_038                 5.660503e-03 3 1  ON 37
ci_039                 4.951289e-03 3 1  ON 38
ci_040                 5.520073e-03 3 1  ON 39
ci_041                 5.549229e-03 3 1  ON 40
ci_042                 5.093303e-03 3 1  ON 41
ci_043                 4.592013e-03 3 1  ON 42
ci_044                 5.286673e-03 3 1  ON 43
ci_045                 5.310905e-03 3 1  ON 44
ci_046                 3.685450e-03 3 1  ON 45
ci_047                -9.368597e-04 3 1  ON 46
ci_048                -1.338865e-03 3 1  ON 47
ci_049                 1.448465e-03 3 1  ON 48
ci_050                 1.164996e-03 3 1  ON 49
ci_051                -2.105406e-03 3 1  ON 50
ci_052                -1.875409e-03 3 1  ON 51
ci_053                -7.665742e-04 3 1  ON 52
ci_054                -3.481425e-03 3 1  ON 53
ci_055                -1.674526e-03 3 1  ON 54
ci_056                -1.201476e-03 3 1  ON 55
ci_057                -1.384561e-03 3 1  ON 56
ci_058                -5.995457e-04 3 1  ON 57
ci_059                -3.526745e-04 3 1  ON 58
ci_060                 3.548996e-05 3 1  ON 59
ci_061                 6.521331e-04 3 1  ON 60
ci_062                -8.956553e-04 3 1  ON 61
ci_063                 3.975173e-04 3 1  ON 62
ci_064                 6.781062e-06 3 1  ON 63
ci_065                -2.332651e-03 3 1  ON 64
ci_066                -3.755300e-03 3 1  ON 65
ci_067                -1.222005e-03 3 1  ON 66
ci_068                -1.981583e-03 3 1  ON 67
ci_069                -6.355916e-05 3 1  ON 68
ci_070                 1.035058e-03 3 1  ON 69
ci_071                -1.525578e-03 3 1  ON 70
ci_072                -1.697302e-03 3 1  ON 71
ci_073                 4.268796e-04 3 1  ON 72
ci_074                 1.264549e-04 3 1  ON 73
ci_075                -4.887833e-05 3 1  ON 74
ci_076                 2.110221e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 18
    time step          = 0.05
    reference energy   = -22.6467
    reference variance = 0.381926
====================================================
  Execution time = 2.5873e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORMN2LMC.s018
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2669e+01
  VMC Evar = 4.9311e-01
  Total weights = 1.9549e+06
  Execution time = 3.6312e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.482196716579
                                         uncertainty =       0.002418776238

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.482196716579
                                         uncertainty =       0.002418776238

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000490983103
  error estimate for blocks of size 2^( 2) =       0.000509398449
  error estimate for blocks of size 2^( 3) =       0.000526861097
  error estimate for blocks of size 2^( 4) =       0.000538622869
  error estimate for blocks of size 2^( 5) =       0.000546286897
  error estimate for blocks of size 2^( 6) =       0.000550276527
  error estimate for blocks of size 2^( 7) =       0.000552366132

      target function =                  N/A
              le_mean =     -22.669442131759
             les_mean =     514.396719511609
             stat err =       0.000546888107
             autocorr =       1.240691665589
              std dev =       0.694354963032
             le_variance =       0.482128814688

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.482196716580
                                         uncertainty =       0.002418776239

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.482196716580
                                         uncertainty =       0.002418776239

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000490983103
  error estimate for blocks of size 2^( 2) =       0.000509398449
  error estimate for blocks of size 2^( 3) =       0.000526861097
  error estimate for blocks of size 2^( 4) =       0.000538622869
  error estimate for blocks of size 2^( 5) =       0.000546286897
  error estimate for blocks of size 2^( 6) =       0.000550276527
  error estimate for blocks of size 2^( 7) =       0.000552366132

      target function =                  N/A
              le_mean =     -22.669442131759
             les_mean =     514.396719511808
             stat err =       0.000546888107
             autocorr =       1.240691665578
              std dev =       0.694354963032
             le_variance =       0.482128814688

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.482196716579
                                         uncertainty =       0.002418776238

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.482196716579
                                         uncertainty =       0.002418776238

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000490983103
  error estimate for blocks of size 2^( 2) =       0.000509398449
  error estimate for blocks of size 2^( 3) =       0.000526861097
  error estimate for blocks of size 2^( 4) =       0.000538622869
  error estimate for blocks of size 2^( 5) =       0.000546286897
  error estimate for blocks of size 2^( 6) =       0.000550276527
  error estimate for blocks of size 2^( 7) =       0.000552366132

      target function =                  N/A
              le_mean =     -22.669442131759
             les_mean =     514.396719511708
             stat err =       0.000546888107
             autocorr =       1.240691665588
              std dev =       0.694354963032
             le_variance =       0.482128814688

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.482196716579
                                         uncertainty =       0.002418776238

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.482196716579
                                         uncertainty =       0.002418776238

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000490983103
  error estimate for blocks of size 2^( 2) =       0.000509398449
  error estimate for blocks of size 2^( 3) =       0.000526861097
  error estimate for blocks of size 2^( 4) =       0.000538622869
  error estimate for blocks of size 2^( 5) =       0.000546286897
  error estimate for blocks of size 2^( 6) =       0.000550276527
  error estimate for blocks of size 2^( 7) =       0.000552366132

      target function =                  N/A
              le_mean =     -22.669442131759
             les_mean =     514.396719511621
             stat err =       0.000546888107
             autocorr =       1.240691665591
              std dev =       0.694354963032
             le_variance =       0.482128814687


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.669442131759        initial  <--
     2.4414e+07     2.4414e+08             2.0539e-11       -22.669442131759
     9.7656e+07     9.7656e+08             5.1346e-12       -22.669442131759
     3.9062e+08     3.9062e+09             1.2837e-12       -22.669442131759

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 44.0840
  </log>
  <optVariables href="FORMN2LMC.s018.opt.xml">
ci_001                -7.055327e-01 3 1  ON 0
ci_002                -7.048097e-01 3 1  ON 1
ci_003                -4.353277e-02 3 1  ON 2
ci_004                -4.680020e-02 3 1  ON 3
ci_005                 1.784321e-02 3 1  ON 4
ci_006                 1.734968e-02 3 1  ON 5
ci_007                 1.438248e-02 3 1  ON 6
ci_008                 1.432656e-02 3 1  ON 7
ci_009                -1.229318e-02 3 1  ON 8
ci_010                -1.096179e-02 3 1  ON 9
ci_011                -9.351550e-03 3 1  ON 10
ci_012                -9.929923e-03 3 1  ON 11
ci_013                 9.950207e-03 3 1  ON 12
ci_014                 1.043986e-02 3 1  ON 13
ci_015                 1.194561e-02 3 1  ON 14
ci_016                 1.407097e-02 3 1  ON 15
ci_017                 9.943053e-03 3 1  ON 16
ci_018                 1.157328e-02 3 1  ON 17
ci_019                 9.065786e-04 3 1  ON 18
ci_020                 1.495805e-03 3 1  ON 19
ci_021                -7.102706e-03 3 1  ON 20
ci_022                -7.001544e-03 3 1  ON 21
ci_023                 8.047041e-03 3 1  ON 22
ci_024                 7.299319e-03 3 1  ON 23
ci_025                 4.584343e-03 3 1  ON 24
ci_026                 4.167134e-03 3 1  ON 25
ci_027                 6.614779e-03 3 1  ON 26
ci_028                 6.795576e-03 3 1  ON 27
ci_029                -5.267990e-03 3 1  ON 28
ci_030                -5.077173e-03 3 1  ON 29
ci_031                -6.354327e-03 3 1  ON 30
ci_032                -7.605491e-03 3 1  ON 31
ci_033                 3.830761e-03 3 1  ON 32
ci_034                 4.927241e-03 3 1  ON 33
ci_035                 1.481403e-03 3 1  ON 34
ci_036                 1.321891e-03 3 1  ON 35
ci_037                 4.657920e-03 3 1  ON 36
ci_038                 5.660503e-03 3 1  ON 37
ci_039                 4.951289e-03 3 1  ON 38
ci_040                 5.520073e-03 3 1  ON 39
ci_041                 5.549229e-03 3 1  ON 40
ci_042                 5.093303e-03 3 1  ON 41
ci_043                 4.592013e-03 3 1  ON 42
ci_044                 5.286673e-03 3 1  ON 43
ci_045                 5.310905e-03 3 1  ON 44
ci_046                 3.685450e-03 3 1  ON 45
ci_047                -9.368597e-04 3 1  ON 46
ci_048                -1.338865e-03 3 1  ON 47
ci_049                 1.448465e-03 3 1  ON 48
ci_050                 1.164996e-03 3 1  ON 49
ci_051                -2.105406e-03 3 1  ON 50
ci_052                -1.875409e-03 3 1  ON 51
ci_053                -7.665742e-04 3 1  ON 52
ci_054                -3.481425e-03 3 1  ON 53
ci_055                -1.674526e-03 3 1  ON 54
ci_056                -1.201476e-03 3 1  ON 55
ci_057                -1.384561e-03 3 1  ON 56
ci_058                -5.995457e-04 3 1  ON 57
ci_059                -3.526745e-04 3 1  ON 58
ci_060                 3.548996e-05 3 1  ON 59
ci_061                 6.521331e-04 3 1  ON 60
ci_062                -8.956553e-04 3 1  ON 61
ci_063                 3.975173e-04 3 1  ON 62
ci_064                 6.781065e-06 3 1  ON 63
ci_065                -2.332651e-03 3 1  ON 64
ci_066                -3.755300e-03 3 1  ON 65
ci_067                -1.222005e-03 3 1  ON 66
ci_068                -1.981583e-03 3 1  ON 67
ci_069                -6.355916e-05 3 1  ON 68
ci_070                 1.035058e-03 3 1  ON 69
ci_071                -1.525578e-03 3 1  ON 70
ci_072                -1.697302e-03 3 1  ON 71
ci_073                 4.268796e-04 3 1  ON 72
ci_074                 1.264549e-04 3 1  ON 73
ci_075                -4.887833e-05 3 1  ON 74
ci_076                 2.110221e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.5110e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORMN2LMC.s019 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORMN2LMC.s019 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=19  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2662e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 19
    time step          = 0.05
    reference energy   = -22.6469
    reference variance = 0.3366
====================================================
  Execution time = 2.6177e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORMN2LMC.s019
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5235e+04
  VMC Eavg = -2.2670e+01
  VMC Evar = 4.9990e-01
  Total weights = 1.955193650e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.7825e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.487393252927
                                         uncertainty =       0.002360067223

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.487393252927
                                         uncertainty =       0.002360067223

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000493694997
  error estimate for blocks of size 2^( 2) =       0.000512058500
  error estimate for blocks of size 2^( 3) =       0.000529498946
  error estimate for blocks of size 2^( 4) =       0.000542005960
  error estimate for blocks of size 2^( 5) =       0.000549323099
  error estimate for blocks of size 2^( 6) =       0.000552065166
  error estimate for blocks of size 2^( 7) =       0.000552753421

      target function =                  N/A
              le_mean =     -22.669851522791
             les_mean =     514.422065651527
             stat err =       0.000549036912
             autocorr =       1.236760578569
              std dev =       0.698190160216
             le_variance =       0.487469499822


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266985152279e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.4414e+08, overlap shift 2.4414e+09 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.669851522902       residual = 2.25e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.669851522902       residual = 3.03e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.669851522902       residual = 1.10e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.669851568028       residual = 2.78e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 2.4414e+08 is 1.747087e-12

solving harmonic davidson linear method for identity shift 9.7656e+08, overlap shift 9.7656e+09 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.669851522902       residual = 2.25e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.669851522902       residual = 3.03e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.669851522902       residual = 1.10e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.669851522902       residual = 2.80e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 9.7656e+08 is 4.367691e-13

solving harmonic davidson linear method for identity shift 3.9062e+09, overlap shift 3.9062e+10 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.669851522902       residual = 2.25e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.669851522902       residual = 3.03e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.669851522902       residual = 1.10e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.669851522902       residual = 2.80e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 3.9062e+09 is 1.091923e-13

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.133560 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0970e+01
  </log>
  <optVariables href="FORMN2LMC.s019.opt.xml">
ci_001                -7.055327e-01 3 1  ON 0
ci_002                -7.048097e-01 3 1  ON 1
ci_003                -4.353277e-02 3 1  ON 2
ci_004                -4.680020e-02 3 1  ON 3
ci_005                 1.784321e-02 3 1  ON 4
ci_006                 1.734968e-02 3 1  ON 5
ci_007                 1.438248e-02 3 1  ON 6
ci_008                 1.432656e-02 3 1  ON 7
ci_009                -1.229318e-02 3 1  ON 8
ci_010                -1.096179e-02 3 1  ON 9
ci_011                -9.351550e-03 3 1  ON 10
ci_012                -9.929923e-03 3 1  ON 11
ci_013                 9.950207e-03 3 1  ON 12
ci_014                 1.043986e-02 3 1  ON 13
ci_015                 1.194561e-02 3 1  ON 14
ci_016                 1.407097e-02 3 1  ON 15
ci_017                 9.943053e-03 3 1  ON 16
ci_018                 1.157328e-02 3 1  ON 17
ci_019                 9.065786e-04 3 1  ON 18
ci_020                 1.495805e-03 3 1  ON 19
ci_021                -7.102706e-03 3 1  ON 20
ci_022                -7.001544e-03 3 1  ON 21
ci_023                 8.047041e-03 3 1  ON 22
ci_024                 7.299319e-03 3 1  ON 23
ci_025                 4.584343e-03 3 1  ON 24
ci_026                 4.167134e-03 3 1  ON 25
ci_027                 6.614779e-03 3 1  ON 26
ci_028                 6.795576e-03 3 1  ON 27
ci_029                -5.267990e-03 3 1  ON 28
ci_030                -5.077173e-03 3 1  ON 29
ci_031                -6.354327e-03 3 1  ON 30
ci_032                -7.605491e-03 3 1  ON 31
ci_033                 3.830761e-03 3 1  ON 32
ci_034                 4.927241e-03 3 1  ON 33
ci_035                 1.481403e-03 3 1  ON 34
ci_036                 1.321891e-03 3 1  ON 35
ci_037                 4.657920e-03 3 1  ON 36
ci_038                 5.660503e-03 3 1  ON 37
ci_039                 4.951289e-03 3 1  ON 38
ci_040                 5.520073e-03 3 1  ON 39
ci_041                 5.549229e-03 3 1  ON 40
ci_042                 5.093303e-03 3 1  ON 41
ci_043                 4.592013e-03 3 1  ON 42
ci_044                 5.286673e-03 3 1  ON 43
ci_045                 5.310905e-03 3 1  ON 44
ci_046                 3.685450e-03 3 1  ON 45
ci_047                -9.368597e-04 3 1  ON 46
ci_048                -1.338865e-03 3 1  ON 47
ci_049                 1.448465e-03 3 1  ON 48
ci_050                 1.164996e-03 3 1  ON 49
ci_051                -2.105406e-03 3 1  ON 50
ci_052                -1.875409e-03 3 1  ON 51
ci_053                -7.665742e-04 3 1  ON 52
ci_054                -3.481425e-03 3 1  ON 53
ci_055                -1.674526e-03 3 1  ON 54
ci_056                -1.201476e-03 3 1  ON 55
ci_057                -1.384561e-03 3 1  ON 56
ci_058                -5.995457e-04 3 1  ON 57
ci_059                -3.526745e-04 3 1  ON 58
ci_060                 3.548996e-05 3 1  ON 59
ci_061                 6.521331e-04 3 1  ON 60
ci_062                -8.956553e-04 3 1  ON 61
ci_063                 3.975173e-04 3 1  ON 62
ci_064                 6.781065e-06 3 1  ON 63
ci_065                -2.332651e-03 3 1  ON 64
ci_066                -3.755300e-03 3 1  ON 65
ci_067                -1.222005e-03 3 1  ON 66
ci_068                -1.981583e-03 3 1  ON 67
ci_069                -6.355916e-05 3 1  ON 68
ci_070                 1.035058e-03 3 1  ON 69
ci_071                -1.525578e-03 3 1  ON 70
ci_072                -1.697302e-03 3 1  ON 71
ci_073                 4.268796e-04 3 1  ON 72
ci_074                 1.264549e-04 3 1  ON 73
ci_075                -4.887833e-05 3 1  ON 74
ci_076                 2.110221e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 19
    time step          = 0.05
    reference energy   = -22.6611
    reference variance = 0.507821
====================================================
  Execution time = 2.5777e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORMN2LMC.s019
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2669e+01
  VMC Evar = 5.0313e-01
  Total weights = 1.9551e+06
  Execution time = 3.6425e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.487269224775
                                         uncertainty =       0.002495653580

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.487269224775
                                         uncertainty =       0.002495653580

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000493584985
  error estimate for blocks of size 2^( 2) =       0.000512099645
  error estimate for blocks of size 2^( 3) =       0.000529229727
  error estimate for blocks of size 2^( 4) =       0.000541175792
  error estimate for blocks of size 2^( 5) =       0.000547052046
  error estimate for blocks of size 2^( 6) =       0.000549254257
  error estimate for blocks of size 2^( 7) =       0.000551497530

      target function =                  N/A
              le_mean =     -22.669497124810
             les_mean =     514.409233274357
             stat err =       0.000547244907
             autocorr =       1.229248186808
              std dev =       0.698034580082
             le_variance =       0.487252274991

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.487269224774
                                         uncertainty =       0.002495653580

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.487269224774
                                         uncertainty =       0.002495653580

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000493584985
  error estimate for blocks of size 2^( 2) =       0.000512099645
  error estimate for blocks of size 2^( 3) =       0.000529229727
  error estimate for blocks of size 2^( 4) =       0.000541175792
  error estimate for blocks of size 2^( 5) =       0.000547052046
  error estimate for blocks of size 2^( 6) =       0.000549254257
  error estimate for blocks of size 2^( 7) =       0.000551497530

      target function =                  N/A
              le_mean =     -22.669497124810
             les_mean =     514.409233274372
             stat err =       0.000547244907
             autocorr =       1.229248186815
              std dev =       0.698034580082
             le_variance =       0.487252274990

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.487269224774
                                         uncertainty =       0.002495653580

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.487269224774
                                         uncertainty =       0.002495653580

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000493584985
  error estimate for blocks of size 2^( 2) =       0.000512099645
  error estimate for blocks of size 2^( 3) =       0.000529229727
  error estimate for blocks of size 2^( 4) =       0.000541175792
  error estimate for blocks of size 2^( 5) =       0.000547052046
  error estimate for blocks of size 2^( 6) =       0.000549254257
  error estimate for blocks of size 2^( 7) =       0.000551497530

      target function =                  N/A
              le_mean =     -22.669497124810
             les_mean =     514.409233274365
             stat err =       0.000547244907
             autocorr =       1.229248186815
              std dev =       0.698034580082
             le_variance =       0.487252274991

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.487269224775
                                         uncertainty =       0.002495653580

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.487269224775
                                         uncertainty =       0.002495653580

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000493584985
  error estimate for blocks of size 2^( 2) =       0.000512099645
  error estimate for blocks of size 2^( 3) =       0.000529229727
  error estimate for blocks of size 2^( 4) =       0.000541175792
  error estimate for blocks of size 2^( 5) =       0.000547052046
  error estimate for blocks of size 2^( 6) =       0.000549254257
  error estimate for blocks of size 2^( 7) =       0.000551497530

      target function =                  N/A
              le_mean =     -22.669497124810
             les_mean =     514.409233274358
             stat err =       0.000547244907
             autocorr =       1.229248186813
              std dev =       0.698034580082
             le_variance =       0.487252274991


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.669497124810        initial
     2.4414e+08     2.4414e+09             1.7471e-12       -22.669497124810  <--
     9.7656e+08     9.7656e+09             4.3677e-13       -22.669497124810
     3.9062e+09     3.9062e+10             1.0919e-13       -22.669497124810

*****************************************************************************
Applying the update for shift_i =   2.4414e+08     and shift_s =   2.4414e+09
*****************************************************************************

  Execution time = 4.4050e+01
  </log>
  <optVariables href="FORMN2LMC.s019.opt.xml">
ci_001                -7.055327e-01 3 1  ON 0
ci_002                -7.048097e-01 3 1  ON 1
ci_003                -4.353277e-02 3 1  ON 2
ci_004                -4.680020e-02 3 1  ON 3
ci_005                 1.784321e-02 3 1  ON 4
ci_006                 1.734968e-02 3 1  ON 5
ci_007                 1.438248e-02 3 1  ON 6
ci_008                 1.432656e-02 3 1  ON 7
ci_009                -1.229318e-02 3 1  ON 8
ci_010                -1.096179e-02 3 1  ON 9
ci_011                -9.351550e-03 3 1  ON 10
ci_012                -9.929923e-03 3 1  ON 11
ci_013                 9.950207e-03 3 1  ON 12
ci_014                 1.043986e-02 3 1  ON 13
ci_015                 1.194561e-02 3 1  ON 14
ci_016                 1.407097e-02 3 1  ON 15
ci_017                 9.943053e-03 3 1  ON 16
ci_018                 1.157328e-02 3 1  ON 17
ci_019                 9.065786e-04 3 1  ON 18
ci_020                 1.495805e-03 3 1  ON 19
ci_021                -7.102706e-03 3 1  ON 20
ci_022                -7.001544e-03 3 1  ON 21
ci_023                 8.047041e-03 3 1  ON 22
ci_024                 7.299319e-03 3 1  ON 23
ci_025                 4.584343e-03 3 1  ON 24
ci_026                 4.167134e-03 3 1  ON 25
ci_027                 6.614779e-03 3 1  ON 26
ci_028                 6.795576e-03 3 1  ON 27
ci_029                -5.267990e-03 3 1  ON 28
ci_030                -5.077173e-03 3 1  ON 29
ci_031                -6.354327e-03 3 1  ON 30
ci_032                -7.605491e-03 3 1  ON 31
ci_033                 3.830761e-03 3 1  ON 32
ci_034                 4.927241e-03 3 1  ON 33
ci_035                 1.481403e-03 3 1  ON 34
ci_036                 1.321891e-03 3 1  ON 35
ci_037                 4.657920e-03 3 1  ON 36
ci_038                 5.660503e-03 3 1  ON 37
ci_039                 4.951289e-03 3 1  ON 38
ci_040                 5.520073e-03 3 1  ON 39
ci_041                 5.549229e-03 3 1  ON 40
ci_042                 5.093303e-03 3 1  ON 41
ci_043                 4.592013e-03 3 1  ON 42
ci_044                 5.286673e-03 3 1  ON 43
ci_045                 5.310905e-03 3 1  ON 44
ci_046                 3.685450e-03 3 1  ON 45
ci_047                -9.368597e-04 3 1  ON 46
ci_048                -1.338865e-03 3 1  ON 47
ci_049                 1.448465e-03 3 1  ON 48
ci_050                 1.164996e-03 3 1  ON 49
ci_051                -2.105406e-03 3 1  ON 50
ci_052                -1.875409e-03 3 1  ON 51
ci_053                -7.665742e-04 3 1  ON 52
ci_054                -3.481425e-03 3 1  ON 53
ci_055                -1.674526e-03 3 1  ON 54
ci_056                -1.201476e-03 3 1  ON 55
ci_057                -1.384561e-03 3 1  ON 56
ci_058                -5.995457e-04 3 1  ON 57
ci_059                -3.526745e-04 3 1  ON 58
ci_060                 3.548996e-05 3 1  ON 59
ci_061                 6.521331e-04 3 1  ON 60
ci_062                -8.956553e-04 3 1  ON 61
ci_063                 3.975173e-04 3 1  ON 62
ci_064                 6.781065e-06 3 1  ON 63
ci_065                -2.332651e-03 3 1  ON 64
ci_066                -3.755300e-03 3 1  ON 65
ci_067                -1.222005e-03 3 1  ON 66
ci_068                -1.981583e-03 3 1  ON 67
ci_069                -6.355916e-05 3 1  ON 68
ci_070                 1.035058e-03 3 1  ON 69
ci_071                -1.525578e-03 3 1  ON 70
ci_072                -1.697302e-03 3 1  ON 71
ci_073                 4.268796e-04 3 1  ON 72
ci_074                 1.264549e-04 3 1  ON 73
ci_075                -4.887833e-05 3 1  ON 74
ci_076                 2.110221e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.5025e+01 secs
  Total Execution time = 1.5095e+03 secs

=========================================================
  A new xml input file : FORMN2LMC.s019.cont.xml
