Rank =    0  Free Memory = 87248 MB
Rank =    1  Free Memory = 87247 MB
Rank =    2  Free Memory = 87247 MB
Rank =    3  Free Memory = 87247 MB
Rank =    4  Free Memory = 87247 MB
Rank =    5  Free Memory = 87246 MB
Rank =    6  Free Memory = 87246 MB
Rank =    7  Free Memory = 87246 MB
Rank =    8  Free Memory = 87246 MB
Rank =    9  Free Memory = 87246 MB
Rank =   10  Free Memory = 87245 MB
Rank =   11  Free Memory = 87245 MB
Rank =   12  Free Memory = 87245 MB
Rank =   13  Free Memory = 87245 MB
Rank =   14  Free Memory = 87244 MB
Rank =   15  Free Memory = 87231 MB
Rank =   16  Free Memory = 87231 MB
Rank =   17  Free Memory = 87231 MB
Rank =   18  Free Memory = 87231 MB
Rank =   19  Free Memory = 87231 MB
Rank =   20  Free Memory = 87231 MB
Rank =   21  Free Memory = 87231 MB
Rank =   22  Free Memory = 87231 MB
Rank =   23  Free Memory = 87231 MB
Rank =   24  Free Memory = 87231 MB
Rank =   25  Free Memory = 87231 MB
Rank =   26  Free Memory = 87231 MB
Rank =   27  Free Memory = 87231 MB
Rank =   28  Free Memory = 87231 MB
Rank =   29  Free Memory = 87231 MB
Rank =   30  Free Memory = 87231 MB
Rank =   31  Free Memory = 87231 MB
Rank =   32  Free Memory = 87716 MB
Rank =   33  Free Memory = 87716 MB
Rank =   34  Free Memory = 87716 MB
Rank =   35  Free Memory = 87716 MB
Rank =   36  Free Memory = 87716 MB
Rank =   37  Free Memory = 87716 MB
Rank =   38  Free Memory = 87716 MB
Rank =   39  Free Memory = 87716 MB
Rank =   40  Free Memory = 87716 MB
Rank =   41  Free Memory = 87716 MB
Rank =   42  Free Memory = 87716 MB
Rank =   43  Free Memory = 87716 MB
Rank =   44  Free Memory = 87716 MB
Rank =   45  Free Memory = 87716 MB
Rank =   46  Free Memory = 87716 MB
Rank =   47  Free Memory = 87716 MB
Rank =   48  Free Memory = 87716 MB
Rank =   49  Free Memory = 87716 MB
Rank =   50  Free Memory = 87716 MB
Rank =   51  Free Memory = 87716 MB
Rank =   52  Free Memory = 87716 MB
Rank =   53  Free Memory = 87716 MB
Rank =   54  Free Memory = 87716 MB
Rank =   55  Free Memory = 87716 MB
Rank =   56  Free Memory = 87716 MB
Rank =   57  Free Memory = 87716 MB
Rank =   58  Free Memory = 87716 MB
Rank =   59  Free Memory = 87716 MB
Rank =   60  Free Memory = 87716 MB
Rank =   61  Free Memory = 87716 MB
Rank =   62  Free Memory = 87716 MB
Rank =   63  Free Memory = 87716 MB
Rank =   64  Free Memory = 87299 MB
Rank =   65  Free Memory = 87299 MB
Rank =   66  Free Memory = 87298 MB
Rank =   67  Free Memory = 87298 MB
Rank =   68  Free Memory = 87298 MB
Rank =   69  Free Memory = 87298 MB
Rank =   70  Free Memory = 87298 MB
Rank =   71  Free Memory = 87298 MB
Rank =   72  Free Memory = 87298 MB
Rank =   73  Free Memory = 87298 MB
Rank =   74  Free Memory = 87298 MB
Rank =   75  Free Memory = 87298 MB
Rank =   76  Free Memory = 87298 MB
Rank =   77  Free Memory = 87298 MB
Rank =   78  Free Memory = 87298 MB
Rank =   79  Free Memory = 87298 MB
Rank =   80  Free Memory = 87298 MB
Rank =   81  Free Memory = 87298 MB
Rank =   82  Free Memory = 87298 MB
Rank =   83  Free Memory = 87298 MB
Rank =   84  Free Memory = 87298 MB
Rank =   85  Free Memory = 87298 MB
Rank =   86  Free Memory = 87298 MB
Rank =   87  Free Memory = 87298 MB
Rank =   88  Free Memory = 87298 MB
Rank =   89  Free Memory = 87297 MB
Rank =   90  Free Memory = 87297 MB
Rank =   91  Free Memory = 87297 MB
Rank =   92  Free Memory = 87297 MB
Rank =   93  Free Memory = 87297 MB
Rank =   94  Free Memory = 87297 MB
Rank =   95  Free Memory = 87297 MB
Rank =   96  Free Memory = 74751 MB
Rank =   97  Free Memory = 74751 MB
Rank =   98  Free Memory = 74751 MB
Rank =   99  Free Memory = 74751 MB
Rank =  100  Free Memory = 74751 MB
Rank =  101  Free Memory = 74751 MB
Rank =  102  Free Memory = 74751 MB
Rank =  103  Free Memory = 74751 MB
Rank =  104  Free Memory = 74751 MB
Rank =  105  Free Memory = 74751 MB
Rank =  106  Free Memory = 74751 MB
Rank =  107  Free Memory = 74751 MB
Rank =  108  Free Memory = 74751 MB
Rank =  109  Free Memory = 74751 MB
Rank =  110  Free Memory = 74751 MB
Rank =  111  Free Memory = 74751 MB
Rank =  112  Free Memory = 74751 MB
Rank =  113  Free Memory = 74751 MB
Rank =  114  Free Memory = 74751 MB
Rank =  115  Free Memory = 74751 MB
Rank =  116  Free Memory = 74751 MB
Rank =  117  Free Memory = 74751 MB
Rank =  118  Free Memory = 74751 MB
Rank =  119  Free Memory = 74751 MB
Rank =  120  Free Memory = 74751 MB
Rank =  121  Free Memory = 74751 MB
Rank =  122  Free Memory = 74751 MB
Rank =  123  Free Memory = 74751 MB
Rank =  124  Free Memory = 74751 MB
Rank =  125  Free Memory = 74751 MB
Rank =  126  Free Memory = 74751 MB
Rank =  127  Free Memory = 74751 MB
  Input file(s): opt_forma_pi2pistar_Jwarm_run001.xml 

=====================================================
                    QMCPACK 3.7.9

       (c) Copyright 2003-  QMCPACK developers

                    Please cite:
 J. Kim et al. J. Phys. Cond. Mat. 30 195901 (2018)
      https://doi.org/10.1088/1361-648X/aab9c3

  Git branch: gvp
  Last git commit: 02b8462cd86e2c45b012131e3a811aee79855b67-dirty
  Last git commit date: Mon Oct 24 16:30:05 2022 -0700
  Last git commit subject: Merge commit 59872d0bcea460ceb08aa7832e89b700ee19b55f into gvp
=====================================================
  Global options 

  Total number of MPI ranks = 128
  Number of MPI groups      = 1
  MPI group ID              = 0
  Number of ranks in group  = 128
  MPI ranks per node        = 32
  OMP 1st level threads     = 1
  OMP nested threading disabled or only 1 thread on the 2nd level

  Precision used in this calculation, see definitions in the manual:
  Base precision      = double
  Full precision      = double

  Structure-of-arrays (SoA) optimization enabled

  Input XML = opt_forma_pi2pistar_Jwarm_run001.xml

  Project = FORMP2PJWARM
  date    = 2023-02-03 11:22:27 PST
  host    = n0110.savio3

 Random Number
 -------------
  Offset for the random number seeds based on time: 755

  Range of prime numbers to use as seeds over processors and threads = 5749-6871


 Particle Set 
 ------------
  Name: e
  All the species have the same mass 1
  Particle set size: 12

 Particle Set 
 ------------
  Name: ion0
  All the species have the same mass 1
  Particle set size: 4

 Wavefunction setup: 
 ------------------- 
  Name: psi0

   Jastrow
   -------
    Name: J2   Type: Two-Body   Function: Bspline

    Radial function for species: u - u
     Number of parameters: 10
     Cusp: -0.25
     Cutoff radius: 10

     Name                        Value Type Recompute Use Index
     ---- ---------------------------- ---- --------- --- -----
     uu_0                 0.000000e+00    1         1  ON     0
     uu_1                 0.000000e+00    1         1  ON     1
     uu_2                 0.000000e+00    1         1  ON     2
     uu_3                 0.000000e+00    1         1  ON     3
     uu_4                 0.000000e+00    1         1  ON     4
     uu_5                 0.000000e+00    1         1  ON     5
     uu_6                 0.000000e+00    1         1  ON     6
     uu_7                 0.000000e+00    1         1  ON     7
     uu_8                 0.000000e+00    1         1  ON     8
     uu_9                 0.000000e+00    1         1  ON     9

    Radial function for species: u - d
     Number of parameters: 10
     Cusp: -5.000000e-01
     Cutoff radius: 1.000000e+01

     Name                        Value Type Recompute Use Index
     ---- ---------------------------- ---- --------- --- -----
     ud_0                 0.000000e+00    1         1  ON     0
     ud_1                 0.000000e+00    1         1  ON     1
     ud_2                 0.000000e+00    1         1  ON     2
     ud_3                 0.000000e+00    1         1  ON     3
     ud_4                 0.000000e+00    1         1  ON     4
     ud_5                 0.000000e+00    1         1  ON     5
     ud_6                 0.000000e+00    1         1  ON     6
     ud_7                 0.000000e+00    1         1  ON     7
     ud_8                 0.000000e+00    1         1  ON     8
     ud_9                 0.000000e+00    1         1  ON     9


   Jastrow
   -------
    Name: J1   Type: One-Body   Function: Bspline

    Radial function for element: C
     Number of parameters: 10
     Cusp: 0.000000e+00
     Cutoff radius: 1.000000e+01

     Name                        Value Type Recompute Use Index
     ---- ---------------------------- ---- --------- --- -----
     eC_0                 0.000000e+00    1         1  ON     0
     eC_1                 0.000000e+00    1         1  ON     1
     eC_2                 0.000000e+00    1         1  ON     2
     eC_3                 0.000000e+00    1         1  ON     3
     eC_4                 0.000000e+00    1         1  ON     4
     eC_5                 0.000000e+00    1         1  ON     5
     eC_6                 0.000000e+00    1         1  ON     6
     eC_7                 0.000000e+00    1         1  ON     7
     eC_8                 0.000000e+00    1         1  ON     8
     eC_9                 0.000000e+00    1         1  ON     9

    Radial function for element: O
     Number of parameters: 10
     Cusp: 0.000000e+00
     Cutoff radius: 1.000000e+01

     Name                        Value Type Recompute Use Index
     ---- ---------------------------- ---- --------- --- -----
     eO_0                 0.000000e+00    1         1  ON     0
     eO_1                 0.000000e+00    1         1  ON     1
     eO_2                 0.000000e+00    1         1  ON     2
     eO_3                 0.000000e+00    1         1  ON     3
     eO_4                 0.000000e+00    1         1  ON     4
     eO_5                 0.000000e+00    1         1  ON     5
     eO_6                 0.000000e+00    1         1  ON     6
     eO_7                 0.000000e+00    1         1  ON     7
     eO_8                 0.000000e+00    1         1  ON     8
     eO_9                 0.000000e+00    1         1  ON     9

    Radial function for element: H1
     Number of parameters: 10
     Cusp: 0.000000e+00
     Cutoff radius: 1.000000e+01

      Name                        Value Type Recompute Use Index
     ----- ---------------------------- ---- --------- --- -----
     eH1_0                 0.000000e+00    1         1  ON     0
     eH1_1                 0.000000e+00    1         1  ON     1
     eH1_2                 0.000000e+00    1         1  ON     2
     eH1_3                 0.000000e+00    1         1  ON     3
     eH1_4                 0.000000e+00    1         1  ON     4
     eH1_5                 0.000000e+00    1         1  ON     5
     eH1_6                 0.000000e+00    1         1  ON     6
     eH1_7                 0.000000e+00    1         1  ON     7
     eH1_8                 0.000000e+00    1         1  ON     8
     eH1_9                 0.000000e+00    1         1  ON     9

    Radial function for element: H2
     Number of parameters: 10
     Cusp: 0.000000e+00
     Cutoff radius: 1.000000e+01

      Name                        Value Type Recompute Use Index
     ----- ---------------------------- ---- --------- --- -----
     eH2_0                 0.000000e+00    1         1  ON     0
     eH2_1                 0.000000e+00    1         1  ON     1
     eH2_2                 0.000000e+00    1         1  ON     2
     eH2_3                 0.000000e+00    1         1  ON     3
     eH2_4                 0.000000e+00    1         1  ON     4
     eH2_5                 0.000000e+00    1         1  ON     5
     eH2_6                 0.000000e+00    1         1  ON     6
     eH2_7                 0.000000e+00    1         1  ON     7
     eH2_8                 0.000000e+00    1         1  ON     8
     eH2_9                 0.000000e+00    1         1  ON     9

  Created SPOSet builder named 'LCAOBSet' of type molecularorbital
  LCAO: SoaAtomicBasisSet<MultiQuintic,0>
  AO BasisSet for C
   Angular momentum expanded in cartesian functions x^lx y^ly z^lz according to Gamess
Using log grid with default values: ri = 1.000000e-06 rf = 1.000000e+02 npts = 1001
   R(n,l,m,s) 0 0 0 0
   R(n,l,m,s) 1 0 0 0
   R(n,l,m,s) 2 1 0 0
   R(n,l,m,s) 3 1 0 0
   R(n,l,m,s) 4 2 0 0
Expanding Ylm (angular function) according to Gamess using cartesian gaussians
Adding 1 cartesian gaussian orbitals for l= 0
Adding 1 cartesian gaussian orbitals for l= 0
Adding 3 cartesian gaussian orbitals for l= 1
Adding 3 cartesian gaussian orbitals for l= 1
Adding 6 cartesian gaussian orbitals for l= 2
  Setting cutoff radius 1.270574e+01

   Maximum Angular Momentum  = 2
   Number of Radial functors = 5
   Basis size                = 14

  AO BasisSet for O
   Angular momentum expanded in cartesian functions x^lx y^ly z^lz according to Gamess
Using log grid with default values: ri = 1.000000e-06 rf = 1.000000e+02 npts = 1001
   R(n,l,m,s) 0 0 0 0
   R(n,l,m,s) 1 0 0 0
   R(n,l,m,s) 2 1 0 0
   R(n,l,m,s) 3 1 0 0
   R(n,l,m,s) 4 2 0 0
Expanding Ylm (angular function) according to Gamess using cartesian gaussians
Adding 1 cartesian gaussian orbitals for l= 0
Adding 1 cartesian gaussian orbitals for l= 0
Adding 3 cartesian gaussian orbitals for l= 1
Adding 3 cartesian gaussian orbitals for l= 1
Adding 6 cartesian gaussian orbitals for l= 2
  Setting cutoff radius 1.018591e+01

   Maximum Angular Momentum  = 2
   Number of Radial functors = 5
   Basis size                = 14

  AO BasisSet for H1
   Angular momentum expanded in cartesian functions x^lx y^ly z^lz according to Gamess
Using log grid with default values: ri = 1.000000e-06 rf = 1.000000e+02 npts = 1001
   R(n,l,m,s) 0 0 0 0
   R(n,l,m,s) 1 0 0 0
   R(n,l,m,s) 2 1 0 0
Expanding Ylm (angular function) according to Gamess using cartesian gaussians
Adding 1 cartesian gaussian orbitals for l= 0
Adding 1 cartesian gaussian orbitals for l= 0
Adding 3 cartesian gaussian orbitals for l= 1
  Setting cutoff radius 1.270574e+01

   Maximum Angular Momentum  = 1
   Number of Radial functors = 3
   Basis size                = 5

  AO BasisSet for H2
   Angular momentum expanded in cartesian functions x^lx y^ly z^lz according to Gamess
Using log grid with default values: ri = 1.000000e-06 rf = 1.000000e+02 npts = 1001
   R(n,l,m,s) 0 0 0 0
   R(n,l,m,s) 1 0 0 0
   R(n,l,m,s) 2 1 0 0
Expanding Ylm (angular function) according to Gamess using cartesian gaussians
Adding 1 cartesian gaussian orbitals for l= 0
Adding 1 cartesian gaussian orbitals for l= 0
Adding 3 cartesian gaussian orbitals for l= 1
  Setting cutoff radius 1.270574e+01

   Maximum Angular Momentum  = 1
   Number of Radial functors = 3
   Basis size                = 5

Creating SPOSet in SlaterDetBuilder::put(xmlNodePtr cur).
spo_name = spo-up
  Building SPOSet 'spo-up' with '' basis set.
Creating SPOSet in SlaterDetBuilder::put(xmlNodePtr cur).
spo_name = spo-dn
  Building SPOSet 'spo-dn' with '' basis set.
Using Bryan's algorithm for MultiSlaterDeterminant expansion. 
Creating base determinant (up) for MSD expansion. 
Creating base determinant (down) for MSD expansion. 
Found determinant list. 
Reading CI expansion.
Found 425 terms in the MSD expansion.
Norm of ci vector (sum of ci^2): 9.999916e-01
Norm of qchem ci vector (sum of qchem_ci^2): 0.000000e+00
Found 28 unique up determinants.
Found 28 unique down determinants.
Number of terms in pairs array: 12
Number of terms in pairs array: 12
CI coefficients are not optimizable. 
  FermionWF = MultiSlaterDeterminantFast
  QMCHamiltonian::addOperator Kinetic to H, physical Hamiltonian 
  QMCHamiltonian::addOperator ElecElec to H, physical Hamiltonian 
QMCHamiltonian::addOperatorType added type coulomb named ElecElec

  ECPotential builder for pseudopotential 

  Adding pseudopotential for C
   Linear grid  ri=0.000000e+00 rf=1.000000e+01 npts = 10001
    ECPComponentBuilder::buildSemiLocalAndLocal 
    Assuming Hartree unit
   Number of angular momentum channels 2
   Maximum angular momentum channel 1
   Creating a Linear Grid Rmax=1.405000e+00
  Using global grid with delta = 1.000000e-03
   Making L=1 a local potential with a radial cutoff of 9.999000e+00
    Non-local pseudopotential parameters
    Maximum angular mementum = 0
    Number of non-local channels = 1
       l(0)=0
    Cutoff radius = 1.405000e+00
    Spherical grids and weights: 
         1.0000000000e+00  0.0000000000e+00  0.0000000000e+00    8.3333333333e-02
        -1.0000000000e+00  1.2246467991e-16  0.0000000000e+00    8.3333333333e-02
         4.4721359550e-01  8.9442719100e-01  0.0000000000e+00    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -8.9442719100e-01  1.0953573965e-16    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
    Maximum cutoff radius 1.4050000000e+00

  Adding pseudopotential for O
   Linear grid  ri=0.0000000000e+00 rf=1.0000000000e+01 npts = 10001
    ECPComponentBuilder::buildSemiLocalAndLocal 
    Assuming Hartree unit
   Number of angular momentum channels 2
   Maximum angular momentum channel 1
   Creating a Linear Grid Rmax=1.0750000000e+00
  Using global grid with delta = 1.0000000000e-03
   Making L=1 a local potential with a radial cutoff of 9.9990000000e+00
    Non-local pseudopotential parameters
    Maximum angular mementum = 0
    Number of non-local channels = 1
       l(0)=0
    Cutoff radius = 1.0750000000e+00
    Spherical grids and weights: 
         1.0000000000e+00  0.0000000000e+00  0.0000000000e+00    8.3333333333e-02
        -1.0000000000e+00  1.2246467991e-16  0.0000000000e+00    8.3333333333e-02
         4.4721359550e-01  8.9442719100e-01  0.0000000000e+00    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -8.9442719100e-01  1.0953573965e-16    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
    Maximum cutoff radius 1.0750000000e+00

  Adding pseudopotential for H1
   Linear grid  ri=0.0000000000e+00 rf=1.0000000000e+01 npts = 10001
    ECPComponentBuilder::buildSemiLocalAndLocal 
    Assuming Hartree unit
   Number of angular momentum channels 2
   Maximum angular momentum channel 1
   Creating a Linear Grid Rmax=1.0000000000e-10
  Using global grid with delta = 1.0000000000e-03
   Making L=1 a local potential with a radial cutoff of 9.9990000000e+00
    Non-local pseudopotential parameters
    Maximum angular mementum = 0
    Number of non-local channels = 1
       l(0)=0
    Cutoff radius = 1.0000000000e-03
    Spherical grids and weights: 
         1.0000000000e+00  0.0000000000e+00  0.0000000000e+00    8.3333333333e-02
        -1.0000000000e+00  1.2246467991e-16  0.0000000000e+00    8.3333333333e-02
         4.4721359550e-01  8.9442719100e-01  0.0000000000e+00    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -8.9442719100e-01  1.0953573965e-16    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
    Maximum cutoff radius 1.0000000000e-03

  Adding pseudopotential for H2
   Linear grid  ri=0.0000000000e+00 rf=1.0000000000e+01 npts = 10001
    ECPComponentBuilder::buildSemiLocalAndLocal 
    Assuming Hartree unit
   Number of angular momentum channels 2
   Maximum angular momentum channel 1
   Creating a Linear Grid Rmax=1.0000000000e-10
  Using global grid with delta = 1.0000000000e-03
   Making L=1 a local potential with a radial cutoff of 9.9990000000e+00
    Non-local pseudopotential parameters
    Maximum angular mementum = 0
    Number of non-local channels = 1
       l(0)=0
    Cutoff radius = 1.0000000000e-03
    Spherical grids and weights: 
         1.0000000000e+00  0.0000000000e+00  0.0000000000e+00    8.3333333333e-02
        -1.0000000000e+00  1.2246467991e-16  0.0000000000e+00    8.3333333333e-02
         4.4721359550e-01  8.9442719100e-01  0.0000000000e+00    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -8.9442719100e-01  1.0953573965e-16    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
    Maximum cutoff radius 1.0000000000e-03
  QMCHamiltonian::addOperator LocalECP to H, physical Hamiltonian 

  Using NonLocalECP potential 
    Maximum grid on a sphere for NonLocalECPotential: 12
  QMCHamiltonian::addOperator NonLocalECP to H, physical Hamiltonian 
QMCHamiltonian::addOperatorType added type pseudo named NonLocalECP
  QMCHamiltonian::addOperator IonIon to H, physical Hamiltonian 
QMCHamiltonian::addOperatorType added type coulomb named IonIon

  QMCHamiltonian::add2WalkerProperty added
    5 to P::PropertyList 
    0 to P::Collectables 
    starting Index of the observables in P::PropertyList = 10
ParticleSetPool::randomize 
  Initialization Execution time = 1.7682e-01 secs
=========================================================
 Summary of QMC systems 
=========================================================
ParticleSetPool has: 

  ParticleSet 'e' contains 12 particles :  u(6) d(6)

    u  4.0107225728e-02 -5.0659535091e-01 -4.8356690577e-01
    u -2.0203417087e-01 -1.2691590666e+00 -2.1169263951e+00
    u  2.9913287695e-01 -2.3710879234e-01  2.0101719070e+00
    u  4.8474243406e-02 -5.3051852953e-01  9.5378285444e-01
    u -5.5511775119e-01 -9.8683271286e-02  1.4043240644e+00
    u  6.9646297924e-01  2.5004217823e+00 -2.4744046405e+00
    d -1.1004432466e+00 -7.1118992563e-01 -1.4300801983e+00
    d -3.6824818327e-02  7.5687344105e-01 -1.6708867165e+00
    d -9.4375526199e-01  1.5348935511e-01  1.1974289766e+00
    d -8.9321447322e-02 -6.9596903295e-02  1.4810785623e+00
    (... and 2 more particle positions ...)

  Distance table for similar particles (A-A):
    source/target: e
    Using structure-of-arrays (SoA) data layout
    Distance computations use open boundary conditions in 3D.

  Distance table for dissimilar particles (A-B):
    source: ion0  target: e
    Using structure-of-arrays (SoA) data layout
    Distance computations use open boundary conditions in 3D.


  ParticleSet 'ion0' contains 4 particles :  C(1) O(1) H1(1) H2(1)

    C  0.0000000000e+00  0.0000000000e+00 -1.1394765782e+00
    O  0.0000000000e+00  0.0000000000e+00  1.1440287480e+00
    H1  0.0000000000e+00  1.7662761033e+00 -2.2339863698e+00
    H2  0.0000000000e+00 -1.7662761033e+00 -2.2339863698e+00

  Distance table for similar particles (A-A):
    source/target: ion0
    Using structure-of-arrays (SoA) data layout
    Distance computations use open boundary conditions in 3D.


  Hamiltonian h0
  Kinetic         Kinetic energy
  ElecElec        CoulombAA source/target e

  LocalECP        LocalECPotential: ion0
  NonLocalECP     NonLocalECPotential: ion0
  IonIon          CoulombAA source/target ion0


Loop execution max-interations = 20
Inside LM engine constructor, num_params is: 0 and _total_num_params is: 0

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORMP2PJWARM.s000 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15
  Adding 1 walkers to 0 existing sets
  Total number of walkers: 1.2800000000e+02
  Total weight: 1.2800000000e+02

=========================================================
  Start VMC
  File Root FORMP2PJWARM.s000 append = no 
=========================================================
Resetting walkers
  Using the current 1 walkers.
  Total number of walkers: 1.2800000000e+02
  Total weight: 1.2800000000e+02
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=0  my_counter=0
  time step      = 5.0000000000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000000000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625000000e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000000000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000000000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000000000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000000000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000000000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000000000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000000000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625000000e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000000000e-02</parameter>
<parameter name="time_step" condition="au">5.0000000000e-02</parameter>
<parameter name="timestep" condition="au">5.0000000000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
  Set drift_modifier UNR parameter a = 1.0000000000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000000000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: 0 and ratio_threshold_: 0.0000000000e+00
Allocating full size _hmat_temp and _smat_temp
Inside LM engine's get_param, num_params is: 60
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 30888 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 0
    time step          = 0.05
    reference energy   = -22.1824
    reference variance = 1.72914
====================================================
  Execution time = 5.0608e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORMP2PJWARM.s000
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2125e+01
  VMC Evar = 2.0807e+00
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.5751e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.080730440633
                                         uncertainty =       0.003579441293

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.080730440633
                                         uncertainty =       0.003579441293

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001019970725
  error estimate for blocks of size 2^( 2) =       0.001113199874
  error estimate for blocks of size 2^( 3) =       0.001195855508
  error estimate for blocks of size 2^( 4) =       0.001254303636
  error estimate for blocks of size 2^( 5) =       0.001283717763
  error estimate for blocks of size 2^( 6) =       0.001304023683
  error estimate for blocks of size 2^( 7) =       0.001313343218

      target function =                  N/A
              le_mean =     -22.124653080291
             les_mean =     491.580953444427
             stat err =       0.001288847075
             autocorr =       1.596714857064
              std dev =       1.442456433147
             le_variance =       2.080680561527


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy-2.212465308029e+01 
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.5000e-01, overlap shift 2.5000e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.124653080291       residual = 5.84e-01           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.159419645980       residual = 3.92e-01           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.183187674805       residual = 3.06e-01           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.205155740029       residual = 1.68e-01           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.232354806684       residual = 1.01e-01           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.242597599975       residual = 3.22e-02           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.249741758118       residual = 1.26e-02           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.255329299997       residual = 1.09e-02           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.257423005372       residual = 2.15e-03           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.258129766285       residual = 1.46e-03           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -22.258747397085       residual = 7.73e-04           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -22.258920875002       residual = 3.74e-04           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -22.259035027276       residual = 1.94e-04           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -22.259106284144       residual = 5.31e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -22.259129695498       residual = 3.18e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -22.259142869915       residual = 1.50e-05           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -22.259149557243       residual = 5.79e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   energy =     -22.259149843927       residual = 1.05e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   energy =     -22.259153061549       residual = 2.87e-07           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   energy =     -22.259153935455       residual = 8.04e-08           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   energy =     -22.259153824012       residual = 3.65e-08           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   energy =     -22.259153776885       residual = 9.79e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         21 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 2.5000e-01 is 1.849168e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 1.0000e+00, overlap shift 1.0000e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.124653080291       residual = 5.84e-01           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.139044410491       residual = 5.45e-01           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.150270630613       residual = 4.15e-01           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.161022205061       residual = 1.64e-01           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.173309269311       residual = 1.41e-01           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.179570828873       residual = 3.35e-02           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.182823548400       residual = 6.06e-03           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.183929977800       residual = 4.64e-03           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.184488270189       residual = 1.39e-03           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.184631590053       residual = 4.86e-04           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -22.184718888470       residual = 1.07e-04           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -22.184730746687       residual = 8.35e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -22.184739857561       residual = 1.55e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -22.184745425212       residual = 6.17e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -22.184745852627       residual = 1.94e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -22.184745785998       residual = 1.00e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -22.184745798069       residual = 1.08e-07           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   energy =     -22.184745896816       residual = 1.82e-08           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   energy =     -22.184745897926       residual = 8.61e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         18 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.0000e+00 is 1.426993e-01

solving harmonic davidson linear method for identity shift 4.0000e+00, overlap shift 4.0000e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.124653080291       residual = 5.84e-01           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.128949447124       residual = 6.37e-01           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.132631888034       residual = 5.01e-01           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.136335832760       residual = 1.69e-01           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.140095199213       residual = 1.57e-01           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.142269422119       residual = 3.72e-02           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.143455225659       residual = 6.29e-03           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.143714850540       residual = 2.55e-03           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.143844488111       residual = 9.88e-04           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.143872531300       residual = 3.50e-04           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -22.143893923320       residual = 5.74e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -22.143895804996       residual = 2.86e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -22.143896414832       residual = 5.20e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -22.143896890569       residual = 3.27e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -22.143897043756       residual = 4.99e-07           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -22.143897052425       residual = 1.38e-07           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -22.143897062568       residual = 2.80e-08           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   energy =     -22.143897064853       residual = 4.23e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         17 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 4.0000e+00 is 3.271881e-02

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.016889 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 6.6380e+01
  </log>
  <optVariables href="FORMP2PJWARM.s000.opt.xml">
uu_0  5.830403e-02                 1 1 ON  0
uu_1  1.774841e-02                 1 1 ON  1
uu_2  -1.781146e-02                1 1 ON  2
uu_3  -1.374347e-02                1 1 ON  3
uu_4  -1.322161e-02                1 1 ON  4
uu_5  -8.647043e-03                1 1 ON  5
uu_6  -6.648072e-03                1 1 ON  6
uu_7  -5.318127e-03                1 1 ON  7
uu_8  -4.511953e-03                1 1 ON  8
uu_9  -3.049967e-03                1 1 ON  9
ud_0  1.426993e-01                 1 1 ON  10
ud_1  1.878711e-03                 1 1 ON  11
ud_2  -3.544944e-02                1 1 ON  12
ud_3  -2.791552e-02                1 1 ON  13
ud_4  -2.517135e-02                1 1 ON  14
ud_5  -1.787986e-02                1 1 ON  15
ud_6  -1.367389e-02                1 1 ON  16
ud_7  -9.867465e-03                1 1 ON  17
ud_8  -6.976708e-03                1 1 ON  18
ud_9  -4.014629e-03                1 1 ON  19
eC_0  -2.850203e-02                1 1 ON  20
eC_1  -2.276949e-02                1 1 ON  21
eC_2  2.551113e-02                 1 1 ON  22
eC_3  2.313822e-02                 1 1 ON  23
eC_4  1.094860e-02                 1 1 ON  24
eC_5  -5.227974e-04                1 1 ON  25
eC_6  -4.349327e-03                1 1 ON  26
eC_7  -2.029314e-03                1 1 ON  27
eC_8  -8.482795e-04                1 1 ON  28
eC_9  -3.920902e-04                1 1 ON  29
eO_0  -1.052760e-01                1 1 ON  30
eO_1  -3.918050e-02                1 1 ON  31
eO_2  6.623547e-02                 1 1 ON  32
eO_3  5.074189e-02                 1 1 ON  33
eO_4  3.198287e-02                 1 1 ON  34
eO_5  1.161332e-02                 1 1 ON  35
eO_6  -7.069808e-03                1 1 ON  36
eO_7  -5.214866e-03                1 1 ON  37
eO_8  -2.255247e-03                1 1 ON  38
eO_9  -8.784731e-04                1 1 ON  39
eH1_0 -1.027217e-02                1 1 ON  40
eH1_1 7.090987e-03                 1 1 ON  41
eH1_2 1.037665e-02                 1 1 ON  42
eH1_3 1.157879e-03                 1 1 ON  43
eH1_4 -7.129909e-03                1 1 ON  44
eH1_5 -2.272270e-03                1 1 ON  45
eH1_6 4.418424e-03                 1 1 ON  46
eH1_7 -6.842690e-04                1 1 ON  47
eH1_8 -1.625323e-03                1 1 ON  48
eH1_9 -6.454147e-04                1 1 ON  49
eH2_0 -1.059483e-02                1 1 ON  50
eH2_1 7.387222e-03                 1 1 ON  51
eH2_2 1.069998e-02                 1 1 ON  52
eH2_3 1.063058e-03                 1 1 ON  53
eH2_4 -6.929371e-03                1 1 ON  54
eH2_5 -2.149315e-03                1 1 ON  55
eH2_6 4.002297e-03                 1 1 ON  56
eH2_7 -7.115241e-04                1 1 ON  57
eH2_8 -1.675935e-03                1 1 ON  58
eH2_9 -6.702180e-04                1 1 ON  59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 0
    time step          = 0.05
    reference energy   = -22.4061
    reference variance = 0.883735
====================================================
  Execution time = 4.8683e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORMP2PJWARM.s000
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2276e+01
  VMC Evar = 1.0199e+00
  Total weights = 2.0000e+06
  Execution time = 4.6325e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       1.881969471795
                                         uncertainty =       0.003164876268

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       1.881969471795
                                         uncertainty =       0.003164876268

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000970070483
  error estimate for blocks of size 2^( 2) =       0.001054500811
  error estimate for blocks of size 2^( 3) =       0.001128316020
  error estimate for blocks of size 2^( 4) =       0.001181451840
  error estimate for blocks of size 2^( 5) =       0.001209834565
  error estimate for blocks of size 2^( 6) =       0.001230341973
  error estimate for blocks of size 2^( 7) =       0.001244019376

      target function =                  N/A
              le_mean =     -22.314399049880
             les_mean =     499.814477500539
             stat err =       0.001216411939
             autocorr =       1.572370065823
              std dev =       1.371886833630
             le_variance =       1.882073484286

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =      62.821382966016
                                         uncertainty =       0.269911440880

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =      62.821382966016
                                         uncertainty =       0.269911440880

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.005604969606
  error estimate for blocks of size 2^( 2) =       0.005898037372
  error estimate for blocks of size 2^( 3) =       0.006136807302
  error estimate for blocks of size 2^( 4) =       0.006298461555
  error estimate for blocks of size 2^( 5) =       0.006401644288
  error estimate for blocks of size 2^( 6) =       0.006482657007
  error estimate for blocks of size 2^( 7) =       0.006568953765

      target function =                  N/A
              le_mean =     -27.246462663484
             les_mean =     805.201064828269
             stat err =       0.006437929154
             autocorr =       1.319306987317
              std dev =       7.926624033680
             le_variance =      62.831368571318

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.843420734665
                                         uncertainty =       0.007397264617

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.843420734665
                                         uncertainty =       0.007397264617

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000649449595
  error estimate for blocks of size 2^( 2) =       0.000708833775
  error estimate for blocks of size 2^( 3) =       0.000767048215
  error estimate for blocks of size 2^( 4) =       0.000812905788
  error estimate for blocks of size 2^( 5) =       0.000838346902
  error estimate for blocks of size 2^( 6) =       0.000855774912
  error estimate for blocks of size 2^( 7) =       0.000865104179

      target function =                  N/A
              le_mean =     -22.313773346074
             les_mean =     498.748050071435
             stat err =       0.000843032945
             autocorr =       1.684993357136
              std dev =       0.918460425521
             le_variance =       0.843569553247

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       1.630080941166
                                         uncertainty =       0.003220186235

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       1.630080941166
                                         uncertainty =       0.003220186235

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000902822997
  error estimate for blocks of size 2^( 2) =       0.000986252682
  error estimate for blocks of size 2^( 3) =       0.001059823335
  error estimate for blocks of size 2^( 4) =       0.001113229236
  error estimate for blocks of size 2^( 5) =       0.001141729188
  error estimate for blocks of size 2^( 6) =       0.001162094707
  error estimate for blocks of size 2^( 7) =       0.001175211256

      target function =                  N/A
              le_mean =     -22.298885092057
             les_mean =     498.870454263041
             stat err =       0.001148066097
             autocorr =       1.617069022457
              std dev =       1.276784527378
             le_variance =       1.630178729351


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.314399049880        initial  <--
            N/A            N/A                    N/A                    N/A     bad update
     1.0000e+00     1.0000e+01             1.4270e-01       -22.313773346074
     4.0000e+00     4.0000e+01             3.2719e-02       -22.298885092057

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 71.8036
  </log>
  <optVariables href="FORMP2PJWARM.s000.opt.xml">
 uu_0                 0.000000e+00 1 1  ON 0
 uu_1                 0.000000e+00 1 1  ON 1
 uu_2                 0.000000e+00 1 1  ON 2
 uu_3                 0.000000e+00 1 1  ON 3
 uu_4                 0.000000e+00 1 1  ON 4
 uu_5                 0.000000e+00 1 1  ON 5
 uu_6                 0.000000e+00 1 1  ON 6
 uu_7                 0.000000e+00 1 1  ON 7
 uu_8                 0.000000e+00 1 1  ON 8
 uu_9                 0.000000e+00 1 1  ON 9
 ud_0                 0.000000e+00 1 1  ON 10
 ud_1                 0.000000e+00 1 1  ON 11
 ud_2                 0.000000e+00 1 1  ON 12
 ud_3                 0.000000e+00 1 1  ON 13
 ud_4                 0.000000e+00 1 1  ON 14
 ud_5                 0.000000e+00 1 1  ON 15
 ud_6                 0.000000e+00 1 1  ON 16
 ud_7                 0.000000e+00 1 1  ON 17
 ud_8                 0.000000e+00 1 1  ON 18
 ud_9                 0.000000e+00 1 1  ON 19
 eC_0                 0.000000e+00 1 1  ON 20
 eC_1                 0.000000e+00 1 1  ON 21
 eC_2                 0.000000e+00 1 1  ON 22
 eC_3                 0.000000e+00 1 1  ON 23
 eC_4                 0.000000e+00 1 1  ON 24
 eC_5                 0.000000e+00 1 1  ON 25
 eC_6                 0.000000e+00 1 1  ON 26
 eC_7                 0.000000e+00 1 1  ON 27
 eC_8                 0.000000e+00 1 1  ON 28
 eC_9                 0.000000e+00 1 1  ON 29
 eO_0                 0.000000e+00 1 1  ON 30
 eO_1                 0.000000e+00 1 1  ON 31
 eO_2                 0.000000e+00 1 1  ON 32
 eO_3                 0.000000e+00 1 1  ON 33
 eO_4                 0.000000e+00 1 1  ON 34
 eO_5                 0.000000e+00 1 1  ON 35
 eO_6                 0.000000e+00 1 1  ON 36
 eO_7                 0.000000e+00 1 1  ON 37
 eO_8                 0.000000e+00 1 1  ON 38
 eO_9                 0.000000e+00 1 1  ON 39
eH1_0                 0.000000e+00 1 1  ON 40
eH1_1                 0.000000e+00 1 1  ON 41
eH1_2                 0.000000e+00 1 1  ON 42
eH1_3                 0.000000e+00 1 1  ON 43
eH1_4                 0.000000e+00 1 1  ON 44
eH1_5                 0.000000e+00 1 1  ON 45
eH1_6                 0.000000e+00 1 1  ON 46
eH1_7                 0.000000e+00 1 1  ON 47
eH1_8                 0.000000e+00 1 1  ON 48
eH1_9                 0.000000e+00 1 1  ON 49
eH2_0                 0.000000e+00 1 1  ON 50
eH2_1                 0.000000e+00 1 1  ON 51
eH2_2                 0.000000e+00 1 1  ON 52
eH2_3                 0.000000e+00 1 1  ON 53
eH2_4                 0.000000e+00 1 1  ON 54
eH2_5                 0.000000e+00 1 1  ON 55
eH2_6                 0.000000e+00 1 1  ON 56
eH2_7                 0.000000e+00 1 1  ON 57
eH2_8                 0.000000e+00 1 1  ON 58
eH2_9                 0.000000e+00 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.3819e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORMP2PJWARM.s001 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORMP2PJWARM.s001 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=1  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2294e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 30888 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 1
    time step          = 0.05
    reference energy   = -22.1765
    reference variance = 2.65139
====================================================
  Execution time = 5.0684e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORMP2PJWARM.s001
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2124e+01
  VMC Evar = 2.0890e+00
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.5977e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.088981155665
                                         uncertainty =       0.004377113104

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.088981155665
                                         uncertainty =       0.004377113104

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001022002000
  error estimate for blocks of size 2^( 2) =       0.001114740293
  error estimate for blocks of size 2^( 3) =       0.001197557862
  error estimate for blocks of size 2^( 4) =       0.001255145010
  error estimate for blocks of size 2^( 5) =       0.001292834565
  error estimate for blocks of size 2^( 6) =       0.001310657401
  error estimate for blocks of size 2^( 7) =       0.001323826120

      target function =                  N/A
              le_mean =     -22.124390986943
             les_mean =     491.577651676107
             stat err =       0.001295615774
             autocorr =       1.607122428519
              std dev =       1.445329089682
             le_variance =       2.088976177480


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.212439098694e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.5000e+00, overlap shift 2.5000e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.124390986943       residual = 5.91e-01           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.131171925426       residual = 6.07e-01           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.136756445869       residual = 4.86e-01           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.142241051060       residual = 1.68e-01           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.147897238738       residual = 1.55e-01           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.151215117881       residual = 3.63e-02           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.152947881531       residual = 5.96e-03           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.153358340298       residual = 2.88e-03           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.153545728551       residual = 1.10e-03           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.153595756872       residual = 3.86e-04           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -22.153630322616       residual = 5.67e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -22.153635549305       residual = 3.48e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -22.153637155642       residual = 7.11e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -22.153637713792       residual = 4.22e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -22.153638078564       residual = 5.80e-07           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -22.153638020296       residual = 1.72e-07           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -22.153638133746       residual = 3.60e-08           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   energy =     -22.153638100214       residual = 4.77e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         17 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 2.5000e+00 is 5.309406e-02

solving harmonic davidson linear method for identity shift 1.0000e+01, overlap shift 1.0000e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.124390986943       residual = 5.91e-01           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.126223886987       residual = 6.54e-01           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.127806768151       residual = 5.35e-01           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.129414260697       residual = 1.72e-01           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.130963888300       residual = 1.62e-01           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.131914115427       residual = 3.79e-02           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.132434266735       residual = 6.96e-03           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.132549671454       residual = 2.29e-03           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.132594421703       residual = 8.77e-04           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.132604869829       residual = 2.93e-04           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -22.132612394450       residual = 6.21e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -22.132613733101       residual = 2.54e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -22.132614097992       residual = 3.74e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -22.132614213825       residual = 1.15e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -22.132614236611       residual = 5.19e-07           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -22.132614235298       residual = 1.20e-07           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -22.132614255687       residual = 1.72e-08           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   energy =     -22.132614249419       residual = 2.76e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         17 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.0000e+01 is 1.296671e-02

solving harmonic davidson linear method for identity shift 4.0000e+01, overlap shift 4.0000e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.124390986943       residual = 5.91e-01           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.124858686815       residual = 6.67e-01           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.125268119917       residual = 5.50e-01           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.125688339038       residual = 1.74e-01           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.126085864168       residual = 1.64e-01           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.126331816690       residual = 3.83e-02           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.126468176377       residual = 7.42e-03           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.126498903269       residual = 2.21e-03           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.126510103805       residual = 8.32e-04           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.126512592837       residual = 2.62e-04           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -22.126514337839       residual = 6.62e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -22.126514682654       residual = 2.47e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -22.126514781074       residual = 3.34e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -22.126514808445       residual = 6.18e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -22.126514808774       residual = 1.71e-07           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -22.126514814470       residual = 6.67e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -22.126514815800       residual = 1.51e-08           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   energy =     -22.126514813943       residual = 2.03e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         17 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 4.0000e+01 is 3.227966e-03

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.027805 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 6.6676e+01
  </log>
  <optVariables href="FORMP2PJWARM.s001.opt.xml">
 uu_0                 4.640316e-03 1 1  ON 0
 uu_1                 1.702987e-03 1 1  ON 1
 uu_2                -1.670799e-03 1 1  ON 2
 uu_3                -8.304298e-04 1 1  ON 3
 uu_4                -1.004840e-03 1 1  ON 4
 uu_5                -5.879431e-04 1 1  ON 5
 uu_6                -5.779360e-04 1 1  ON 6
 uu_7                -5.366767e-04 1 1  ON 7
 uu_8                -4.930262e-04 1 1  ON 8
 uu_9                -3.208381e-04 1 1  ON 9
 ud_0                 1.296671e-02 1 1  ON 10
 ud_1                -4.755595e-04 1 1  ON 11
 ud_2                -3.366178e-03 1 1  ON 12
 ud_3                -2.083277e-03 1 1  ON 13
 ud_4                -2.133553e-03 1 1  ON 14
 ud_5                -1.392184e-03 1 1  ON 15
 ud_6                -1.210118e-03 1 1  ON 16
 ud_7                -8.935959e-04 1 1  ON 17
 ud_8                -6.705526e-04 1 1  ON 18
 ud_9                -3.978726e-04 1 1  ON 19
 eC_0                -1.755814e-03 1 1  ON 20
 eC_1                -1.534491e-03 1 1  ON 21
 eC_2                 1.955376e-03 1 1  ON 22
 eC_3                 1.498007e-03 1 1  ON 23
 eC_4                 6.921847e-04 1 1  ON 24
 eC_5                -1.890188e-04 1 1  ON 25
 eC_6                -3.471064e-04 1 1  ON 26
 eC_7                -1.844142e-04 1 1  ON 27
 eC_8                -8.369623e-05 1 1  ON 28
 eC_9                -3.497132e-05 1 1  ON 29
 eO_0                -7.454180e-03 1 1  ON 30
 eO_1                -2.985900e-03 1 1  ON 31
 eO_2                 5.645853e-03 1 1  ON 32
 eO_3                 3.434553e-03 1 1  ON 33
 eO_4                 2.088050e-03 1 1  ON 34
 eO_5                 6.046515e-04 1 1  ON 35
 eO_6                -6.374145e-04 1 1  ON 36
 eO_7                -3.779079e-04 1 1  ON 37
 eO_8                -1.652703e-04 1 1  ON 38
 eO_9                -8.456643e-05 1 1  ON 39
eH1_0                -6.921984e-04 1 1  ON 40
eH1_1                 5.353545e-04 1 1  ON 41
eH1_2                 8.698097e-04 1 1  ON 42
eH1_3                 1.533078e-04 1 1  ON 43
eH1_4                -6.163247e-04 1 1  ON 44
eH1_5                -1.546147e-04 1 1  ON 45
eH1_6                 2.972445e-04 1 1  ON 46
eH1_7                -1.397225e-04 1 1  ON 47
eH1_8                -1.545042e-04 1 1  ON 48
eH1_9                -6.417647e-05 1 1  ON 49
eH2_0                -7.033495e-04 1 1  ON 50
eH2_1                 5.509591e-04 1 1  ON 51
eH2_2                 8.753407e-04 1 1  ON 52
eH2_3                 1.499829e-04 1 1  ON 53
eH2_4                -6.166335e-04 1 1  ON 54
eH2_5                -1.734091e-04 1 1  ON 55
eH2_6                 3.038634e-04 1 1  ON 56
eH2_7                -1.308816e-04 1 1  ON 57
eH2_8                -1.509389e-04 1 1  ON 58
eH2_9                -6.340193e-05 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 1
    time step          = 0.05
    reference energy   = -22.1021
    reference variance = 1.70427
====================================================
  Execution time = 4.8322e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORMP2PJWARM.s001
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2142e+01
  VMC Evar = 1.9399e+00
  Total weights = 2.0000e+06
  Execution time = 4.6242e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.055915864337
                                         uncertainty =       0.003043663837

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.055915864337
                                         uncertainty =       0.003043663837

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001013860094
  error estimate for blocks of size 2^( 2) =       0.001105241412
  error estimate for blocks of size 2^( 3) =       0.001186323932
  error estimate for blocks of size 2^( 4) =       0.001244220108
  error estimate for blocks of size 2^( 5) =       0.001276654795
  error estimate for blocks of size 2^( 6) =       0.001292725547
  error estimate for blocks of size 2^( 7) =       0.001304596502

      target function =                  N/A
              le_mean =     -22.141978289906
             les_mean =     492.323026142932
             stat err =       0.001279549238
             autocorr =       1.592787894952
              std dev =       1.433814695204
             le_variance =       2.055824580183

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       1.617534646236
                                         uncertainty =       0.002721465802

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       1.617534646236
                                         uncertainty =       0.002721465802

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000899295028
  error estimate for blocks of size 2^( 2) =       0.000988201982
  error estimate for blocks of size 2^( 3) =       0.001068369829
  error estimate for blocks of size 2^( 4) =       0.001126478182
  error estimate for blocks of size 2^( 5) =       0.001159287499
  error estimate for blocks of size 2^( 6) =       0.001175817372
  error estimate for blocks of size 2^( 7) =       0.001187520564

      target function =                  N/A
              le_mean =     -22.144944765987
             les_mean =     492.016040975975
             stat err =       0.001162275904
             autocorr =       1.670375393413
              std dev =       1.271795225692
             le_variance =       1.617463096094

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       1.830127517713
                                         uncertainty =       0.002845489059

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       1.830127517713
                                         uncertainty =       0.002845489059

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000956568563
  error estimate for blocks of size 2^( 2) =       0.001046987071
  error estimate for blocks of size 2^( 3) =       0.001127822672
  error estimate for blocks of size 2^( 4) =       0.001185953278
  error estimate for blocks of size 2^( 5) =       0.001218638287
  error estimate for blocks of size 2^( 6) =       0.001234973715
  error estimate for blocks of size 2^( 7) =       0.001246762466

      target function =                  N/A
              le_mean =     -22.142024287876
             les_mean =     492.099285482686
             stat err =       0.001221581936
             autocorr =       1.630846162515
              std dev =       1.352792235652
             le_variance =       1.830046832840

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.026508312648
                                         uncertainty =       0.003015131111

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.026508312648
                                         uncertainty =       0.003015131111

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001006582944
  error estimate for blocks of size 2^( 2) =       0.001097854775
  error estimate for blocks of size 2^( 3) =       0.001178914707
  error estimate for blocks of size 2^( 4) =       0.001236845274
  error estimate for blocks of size 2^( 5) =       0.001269313791
  error estimate for blocks of size 2^( 6) =       0.001285418601
  error estimate for blocks of size 2^( 7) =       0.001297279880

      target function =                  N/A
              le_mean =     -22.141836121785
             les_mean =     492.287324276712
             stat err =       0.001272214387
             autocorr =       1.597428654416
              std dev =       1.423523250923
             le_variance =       2.026418445918


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.141978289906        initial
     2.5000e+00     2.5000e+01             5.3094e-02       -22.144944765987  <--
     1.0000e+01     1.0000e+02             1.2967e-02       -22.142024287876
     4.0000e+01     4.0000e+02             3.2280e-03       -22.141836121785

*****************************************************************************
Applying the update for shift_i =   2.5000e+00     and shift_s =   2.5000e+01
*****************************************************************************

  Execution time = 7.1406e+01
  </log>
  <optVariables href="FORMP2PJWARM.s001.opt.xml">
 uu_0                 2.008762e-02 1 1  ON 0
 uu_1                 6.764010e-03 1 1  ON 1
 uu_2                -6.717539e-03 1 1  ON 2
 uu_3                -4.110639e-03 1 1  ON 3
 uu_4                -4.361328e-03 1 1  ON 4
 uu_5                -2.725836e-03 1 1  ON 5
 uu_6                -2.371583e-03 1 1  ON 6
 uu_7                -2.122183e-03 1 1  ON 7
 uu_8                -1.934950e-03 1 1  ON 8
 uu_9                -1.251846e-03 1 1  ON 9
 ud_0                 5.309406e-02 1 1  ON 10
 ud_1                -8.784131e-04 1 1  ON 11
 ud_2                -1.360181e-02 1 1  ON 12
 ud_3                -9.287925e-03 1 1  ON 13
 ud_4                -8.942659e-03 1 1  ON 14
 ud_5                -6.076120e-03 1 1  ON 15
 ud_6                -4.986919e-03 1 1  ON 16
 ud_7                -3.661332e-03 1 1  ON 17
 ud_8                -2.707907e-03 1 1  ON 18
 ud_9                -1.592951e-03 1 1  ON 19
 eC_0                -8.397457e-03 1 1  ON 20
 eC_1                -7.115268e-03 1 1  ON 21
 eC_2                 8.593493e-03 1 1  ON 22
 eC_3                 7.070166e-03 1 1  ON 23
 eC_4                 3.261775e-03 1 1  ON 24
 eC_5                -5.747943e-04 1 1  ON 25
 eC_6                -1.495081e-03 1 1  ON 26
 eC_7                -7.861729e-04 1 1  ON 27
 eC_8                -3.466733e-04 1 1  ON 28
 eC_9                -1.441266e-04 1 1  ON 29
 eO_0                -3.376658e-02 1 1  ON 30
 eO_1                -1.308676e-02 1 1  ON 31
 eO_2                 2.377199e-02 1 1  ON 32
 eO_3                 1.592579e-02 1 1  ON 33
 eO_4                 9.752869e-03 1 1  ON 34
 eO_5                 3.106994e-03 1 1  ON 35
 eO_6                -2.707447e-03 1 1  ON 36
 eO_7                -1.665181e-03 1 1  ON 37
 eO_8                -7.120142e-04 1 1  ON 38
 eO_9                -3.464718e-04 1 1  ON 39
eH1_0                -3.185282e-03 1 1  ON 40
eH1_1                 2.384027e-03 1 1  ON 41
eH1_2                 3.697733e-03 1 1  ON 42
eH1_3                 5.815600e-04 1 1  ON 43
eH1_4                -2.587230e-03 1 1  ON 44
eH1_5                -6.861824e-04 1 1  ON 45
eH1_6                 1.336220e-03 1 1  ON 46
eH1_7                -4.715252e-04 1 1  ON 47
eH1_8                -6.592759e-04 1 1  ON 48
eH1_9                -2.691826e-04 1 1  ON 49
eH2_0                -3.248463e-03 1 1  ON 50
eH2_1                 2.447260e-03 1 1  ON 51
eH2_2                 3.720020e-03 1 1  ON 52
eH2_3                 5.661187e-04 1 1  ON 53
eH2_4                -2.581407e-03 1 1  ON 54
eH2_5                -7.640033e-04 1 1  ON 55
eH2_6                 1.373541e-03 1 1  ON 56
eH2_7                -4.308161e-04 1 1  ON 57
eH2_8                -6.429729e-04 1 1  ON 58
eH2_9                -2.662614e-04 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.3809e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORMP2PJWARM.s002 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORMP2PJWARM.s002 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=2  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2217e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 30888 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 2
    time step          = 0.05
    reference energy   = -22.3453
    reference variance = 1.1683
====================================================
  Execution time = 4.9201e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORMP2PJWARM.s002
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2192e+01
  VMC Evar = 1.5821e+00
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.5855e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       1.582136018994
                                         uncertainty =       0.005175029359

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       1.582136018994
                                         uncertainty =       0.005175029359

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000889409960
  error estimate for blocks of size 2^( 2) =       0.000976184261
  error estimate for blocks of size 2^( 3) =       0.001054611354
  error estimate for blocks of size 2^( 4) =       0.001108453152
  error estimate for blocks of size 2^( 5) =       0.001142132462
  error estimate for blocks of size 2^( 6) =       0.001162538039
  error estimate for blocks of size 2^( 7) =       0.001172425347

      target function =                  N/A
              le_mean =     -22.192233476793
             les_mean =     494.077326051379
             stat err =       0.001146387250
             autocorr =       1.661340748388
              std dev =       1.257815627962
             le_variance =       1.582100153946


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.219223347679e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.2500e-01, overlap shift 6.2500e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.192233476793       residual = 3.73e-01           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.205048498673       residual = 3.06e-01           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.214877655120       residual = 2.65e-01           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.225216794430       residual = 1.11e-01           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.238019991551       residual = 8.58e-02           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.243246761262       residual = 2.39e-02           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.246284491257       residual = 5.74e-03           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.247883780023       residual = 5.06e-03           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.248566742275       residual = 1.15e-03           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.248780651803       residual = 4.67e-04           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -22.248897755358       residual = 1.95e-04           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -22.248928886486       residual = 1.03e-04           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -22.248937271023       residual = 2.88e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -22.248945639023       residual = 1.26e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -22.248947263398       residual = 4.38e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -22.248948746888       residual = 1.66e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -22.248948844375       residual = 2.66e-07           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   energy =     -22.248949526690       residual = 6.30e-08           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   energy =     -22.248949466249       residual = 1.75e-08           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   energy =     -22.248949507554       residual = 2.84e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         19 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 6.2500e-01 is 1.749678e-01

solving harmonic davidson linear method for identity shift 2.5000e+00, overlap shift 2.5000e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.192233476793       residual = 3.73e-01           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.196337584959       residual = 3.70e-01           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.199808498565       residual = 3.26e-01           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.203716847224       residual = 1.09e-01           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.207865441405       residual = 1.00e-01           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.209912705779       residual = 2.52e-02           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.211060509678       residual = 4.35e-03           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.211363219336       residual = 2.22e-03           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.211512482436       residual = 9.12e-04           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.211559423975       residual = 2.62e-04           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -22.211587185147       residual = 5.31e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -22.211590665924       residual = 2.88e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -22.211590628388       residual = 5.46e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -22.211591155909       residual = 3.45e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -22.211591544084       residual = 5.04e-07           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -22.211591340122       residual = 1.51e-07           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -22.211591514533       residual = 2.52e-08           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   energy =     -22.211591482438       residual = 3.06e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         17 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 2.5000e+00 is 4.057514e-02

solving harmonic davidson linear method for identity shift 1.0000e+01, overlap shift 1.0000e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.192233476793       residual = 3.73e-01           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.193336705203       residual = 3.94e-01           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.194308048050       residual = 3.54e-01           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.195440843693       residual = 1.10e-01           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.196561368425       residual = 1.05e-01           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.197140878920       residual = 2.57e-02           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.197474750490       residual = 4.78e-03           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.197554978402       residual = 1.71e-03           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.197589532829       residual = 7.47e-04           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.197599439115       residual = 1.97e-04           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -22.197605725465       residual = 4.90e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -22.197606703650       residual = 1.88e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -22.197606709438       residual = 3.14e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -22.197606849928       residual = 2.27e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -22.197606914148       residual = 3.10e-07           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -22.197606876628       residual = 8.34e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -22.197606901478       residual = 1.22e-08           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   energy =     -22.197606895204       residual = 2.08e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         17 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.0000e+01 is 1.013163e-02

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.039887 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 6.5072e+01
  </log>
  <optVariables href="FORMP2PJWARM.s002.opt.xml">
 uu_0                 3.700893e-02 1 1  ON 0
 uu_1                 1.169304e-02 1 1  ON 1
 uu_2                -1.179665e-02 1 1  ON 2
 uu_3                -8.221669e-03 1 1  ON 3
 uu_4                -8.078078e-03 1 1  ON 4
 uu_5                -5.311293e-03 1 1  ON 5
 uu_6                -4.239649e-03 1 1  ON 6
 uu_7                -3.660238e-03 1 1  ON 7
 uu_8                -3.314346e-03 1 1  ON 8
 uu_9                -2.107028e-03 1 1  ON 9
 ud_0                 9.366920e-02 1 1  ON 10
 ud_1                -1.218736e-04 1 1  ON 11
 ud_2                -2.374943e-02 1 1  ON 12
 ud_3                -1.752837e-02 1 1  ON 13
 ud_4                -1.611491e-02 1 1  ON 14
 ud_5                -1.129842e-02 1 1  ON 15
 ud_6                -8.871590e-03 1 1  ON 16
 ud_7                -6.492908e-03 1 1  ON 17
 ud_8                -4.692401e-03 1 1  ON 18
 ud_9                -2.623438e-03 1 1  ON 19
 eC_0                -1.656246e-02 1 1  ON 20
 eC_1                -1.366119e-02 1 1  ON 21
 eC_2                 1.592463e-02 1 1  ON 22
 eC_3                 1.376845e-02 1 1  ON 23
 eC_4                 6.401949e-03 1 1  ON 24
 eC_5                -8.102514e-04 1 1  ON 25
 eC_6                -2.786312e-03 1 1  ON 26
 eC_7                -1.363789e-03 1 1  ON 27
 eC_8                -5.757602e-04 1 1  ON 28
 eC_9                -2.345054e-04 1 1  ON 29
 eO_0                -6.404679e-02 1 1  ON 30
 eO_1                -2.431886e-02 1 1  ON 31
 eO_2                 4.278502e-02 1 1  ON 32
 eO_3                 3.064931e-02 1 1  ON 33
 eO_4                 1.886265e-02 1 1  ON 34
 eO_5                 6.317213e-03 1 1  ON 35
 eO_6                -4.763865e-03 1 1  ON 36
 eO_7                -3.116406e-03 1 1  ON 37
 eO_8                -1.326649e-03 1 1  ON 38
 eO_9                -5.914351e-04 1 1  ON 39
eH1_0                -6.198206e-03 1 1  ON 40
eH1_1                 4.441675e-03 1 1  ON 41
eH1_2                 6.686131e-03 1 1  ON 42
eH1_3                 9.546087e-04 1 1  ON 43
eH1_4                -4.570569e-03 1 1  ON 44
eH1_5                -1.380995e-03 1 1  ON 45
eH1_6                 2.573775e-03 1 1  ON 46
eH1_7                -7.088737e-04 1 1  ON 47
eH1_8                -1.153873e-03 1 1  ON 48
eH1_9                -4.242426e-04 1 1  ON 49
eH2_0                -6.278985e-03 1 1  ON 50
eH2_1                 4.509305e-03 1 1  ON 51
eH2_2                 6.774974e-03 1 1  ON 52
eH2_3                 9.952430e-04 1 1  ON 53
eH2_4                -4.608345e-03 1 1  ON 54
eH2_5                -1.341464e-03 1 1  ON 55
eH2_6                 2.523742e-03 1 1  ON 56
eH2_7                -6.572604e-04 1 1  ON 57
eH2_8                -1.170885e-03 1 1  ON 58
eH2_9                -4.736062e-04 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 2
    time step          = 0.05
    reference energy   = -22.1325
    reference variance = 1.02491
====================================================
  Execution time = 4.8278e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORMP2PJWARM.s002
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2233e+01
  VMC Evar = 1.2800e+00
  Total weights = 2.0000e+06
  Execution time = 4.6488e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       1.532541707440
                                         uncertainty =       0.002640543824

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       1.532541707440
                                         uncertainty =       0.002640543824

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000875368963
  error estimate for blocks of size 2^( 2) =       0.000960264880
  error estimate for blocks of size 2^( 3) =       0.001036013539
  error estimate for blocks of size 2^( 4) =       0.001089080626
  error estimate for blocks of size 2^( 5) =       0.001124239347
  error estimate for blocks of size 2^( 6) =       0.001140808477
  error estimate for blocks of size 2^( 7) =       0.001153330855

      target function =                  N/A
              le_mean =     -22.236629525861
             les_mean =     496.000233545961
             stat err =       0.001126864826
             autocorr =       1.657148232952
              std dev =       1.237958659175
             le_variance =       1.532541641826

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.791917057500
                                         uncertainty =       0.003185605822

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.791917057500
                                         uncertainty =       0.003185605822

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000629251184
  error estimate for blocks of size 2^( 2) =       0.000695516480
  error estimate for blocks of size 2^( 3) =       0.000760042546
  error estimate for blocks of size 2^( 4) =       0.000807621519
  error estimate for blocks of size 2^( 5) =       0.000838666798
  error estimate for blocks of size 2^( 6) =       0.000855964174
  error estimate for blocks of size 2^( 7) =       0.000866709718

      target function =                  N/A
              le_mean =     -22.268139984693
             les_mean =     496.661972087587
             stat err =       0.000842240552
             autocorr =       1.791530527913
              std dev =       0.889895558853
             le_variance =       0.791914105666

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       1.082443302609
                                         uncertainty =       0.002589307638

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       1.082443302609
                                         uncertainty =       0.002589307638

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000735677083
  error estimate for blocks of size 2^( 2) =       0.000815143220
  error estimate for blocks of size 2^( 3) =       0.000888365818
  error estimate for blocks of size 2^( 4) =       0.000940610413
  error estimate for blocks of size 2^( 5) =       0.000974809636
  error estimate for blocks of size 2^( 6) =       0.000992259233
  error estimate for blocks of size 2^( 7) =       0.001004341583

      target function =                  N/A
              le_mean =     -22.236628666849
             les_mean =     495.550095468412
             stat err =       0.000978005216
             autocorr =       1.767290270267
              std dev =       1.040404508974
             le_variance =       1.082441542294

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       1.464981217162
                                         uncertainty =       0.002595517477

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       1.464981217162
                                         uncertainty =       0.002595517477

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000855856465
  error estimate for blocks of size 2^( 2) =       0.000940248976
  error estimate for blocks of size 2^( 3) =       0.001015815745
  error estimate for blocks of size 2^( 4) =       0.001068864277
  error estimate for blocks of size 2^( 5) =       0.001103950283
  error estimate for blocks of size 2^( 6) =       0.001120648276
  error estimate for blocks of size 2^( 7) =       0.001133139246

      target function =                  N/A
              le_mean =     -22.235250113325
             les_mean =     495.871327448447
             stat err =       0.001106650520
             autocorr =       1.671933938217
              std dev =       1.210363820847
             le_variance =       1.464980578816


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.236629525861        initial
     6.2500e-01     6.2500e+00             1.7497e-01       -22.268139984693  <--
     2.5000e+00     2.5000e+01             4.0575e-02       -22.236628666849
     1.0000e+01     1.0000e+02             1.0132e-02       -22.235250113325

*****************************************************************************
Applying the update for shift_i =   6.2500e-01     and shift_s =   6.2500e+00
*****************************************************************************

  Execution time = 7.1501e+01
  </log>
  <optVariables href="FORMP2PJWARM.s002.opt.xml">
 uu_0                 1.032066e-01 1 1  ON 0
 uu_1                 2.733425e-02 1 1  ON 1
 uu_2                -2.798671e-02 1 1  ON 2
 uu_3                -2.781885e-02 1 1  ON 3
 uu_4                -2.450471e-02 1 1  ON 4
 uu_5                -1.739877e-02 1 1  ON 5
 uu_6                -1.137112e-02 1 1  ON 6
 uu_7                -7.723624e-03 1 1  ON 7
 uu_8                -6.537941e-03 1 1  ON 8
 uu_9                -3.883690e-03 1 1  ON 9
 ud_0                 2.280619e-01 1 1  ON 10
 ud_1                 1.186706e-02 1 1  ON 11
 ud_2                -5.426270e-02 1 1  ON 12
 ud_3                -5.074993e-02 1 1  ON 13
 ud_4                -4.377908e-02 1 1  ON 14
 ud_5                -3.259488e-02 1 1  ON 15
 ud_6                -2.311603e-02 1 1  ON 16
 ud_7                -1.572931e-02 1 1  ON 17
 ud_8                -1.048583e-02 1 1  ON 18
 ud_9                -5.227537e-03 1 1  ON 19
 eC_0                -5.957503e-02 1 1  ON 20
 eC_1                -4.441232e-02 1 1  ON 21
 eC_2                 4.519878e-02 1 1  ON 22
 eC_3                 4.708981e-02 1 1  ON 23
 eC_4                 2.338261e-02 1 1  ON 24
 eC_5                 1.701939e-03 1 1  ON 25
 eC_6                -7.858043e-03 1 1  ON 26
 eC_7                -3.492175e-03 1 1  ON 27
 eC_8                -1.312865e-03 1 1  ON 28
 eC_9                -5.142735e-04 1 1  ON 29
 eO_0                -1.989034e-01 1 1  ON 30
 eO_1                -7.214474e-02 1 1  ON 31
 eO_2                 1.090163e-01 1 1  ON 32
 eO_3                 9.793394e-02 1 1  ON 33
 eO_4                 6.446914e-02 1 1  ON 34
 eO_5                 2.618865e-02 1 1  ON 35
 eO_6                -1.118820e-02 1 1  ON 36
 eO_7                -9.169613e-03 1 1  ON 37
 eO_8                -3.873102e-03 1 1  ON 38
 eO_9                -1.380540e-03 1 1  ON 39
eH1_0                -2.051128e-02 1 1  ON 40
eH1_1                 1.305101e-02 1 1  ON 41
eH1_2                 1.734441e-02 1 1  ON 42
eH1_3                 1.197412e-03 1 1  ON 43
eH1_4                -1.082095e-02 1 1  ON 44
eH1_5                -4.257118e-03 1 1  ON 45
eH1_6                 8.242575e-03 1 1  ON 46
eH1_7                 7.394329e-05 1 1  ON 47
eH1_8                -2.963289e-03 1 1  ON 48
eH1_9                -9.005829e-04 1 1  ON 49
eH2_0                -2.058905e-02 1 1  ON 50
eH2_1                 1.302707e-02 1 1  ON 51
eH2_2                 1.759721e-02 1 1  ON 52
eH2_3                 1.454211e-03 1 1  ON 53
eH2_4                -1.089313e-02 1 1  ON 54
eH2_5                -3.708957e-03 1 1  ON 55
eH2_6                 7.859709e-03 1 1  ON 56
eH2_7                 1.392340e-04 1 1  ON 57
eH2_8                -3.130912e-03 1 1  ON 58
eH2_9                -1.183983e-03 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.3658e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORMP2PJWARM.s003 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORMP2PJWARM.s003 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=3  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2224e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 30888 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 3
    time step          = 0.05
    reference energy   = -22.4252
    reference variance = 0.486224
====================================================
  Execution time = 4.9382e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORMP2PJWARM.s003
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2334e+01
  VMC Evar = 7.4490e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.6108e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.744892928502
                                         uncertainty =       0.006111819579

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.744892928502
                                         uncertainty =       0.006111819579

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000610288053
  error estimate for blocks of size 2^( 2) =       0.000671911709
  error estimate for blocks of size 2^( 3) =       0.000732329053
  error estimate for blocks of size 2^( 4) =       0.000776342982
  error estimate for blocks of size 2^( 5) =       0.000804284839
  error estimate for blocks of size 2^( 6) =       0.000819169330
  error estimate for blocks of size 2^( 7) =       0.000829035466

      target function =                  N/A
              le_mean =     -22.334314218153
             les_mean =     499.566494237162
             stat err =       0.000807208154
             autocorr =       1.749449234091
              std dev =       0.863077641005
             le_variance =       0.744903014402


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.233431421815e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5625e-01, overlap shift 1.5625e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.334314218153       residual = 4.66e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.338291661523       residual = 2.35e-02           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.346526537767       residual = 5.13e-02           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.349887493025       residual = 4.05e-02           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.357083735416       residual = 1.24e-02           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.359958900761       residual = 7.85e-03           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.361331648793       residual = 4.81e-03           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.362973874145       residual = 2.05e-03           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.363559003964       residual = 1.32e-03           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.364064204344       residual = 5.61e-04           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -22.364380428216       residual = 2.91e-04           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -22.364462531719       residual = 1.85e-04           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -22.364518958913       residual = 1.20e-04           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -22.364609296007       residual = 3.47e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -22.364647135262       residual = 2.84e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -22.364649834902       residual = 6.01e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -22.364649560365       residual = 3.62e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   energy =     -22.364650499462       residual = 9.17e-07           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   energy =     -22.364652721246       residual = 3.09e-07           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   energy =     -22.364653481907       residual = 2.00e-07           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   energy =     -22.364653752128       residual = 4.39e-08           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   energy =     -22.364653959138       residual = 1.72e-08           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   energy =     -22.364653704349       residual = 4.79e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         22 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.5625e-01 is 3.345726e-01

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 6.2500e-01, overlap shift 6.2500e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.334314218153       residual = 4.66e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.336074943904       residual = 2.41e-02           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.339405336425       residual = 7.43e-02           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.340905760524       residual = 2.54e-02           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.344103890788       residual = 8.18e-03           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.345018349733       residual = 5.23e-03           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.345399170476       residual = 1.70e-03           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.345713407217       residual = 7.51e-04           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.345832432191       residual = 3.66e-04           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.345893063556       residual = 9.25e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -22.345918410473       residual = 4.33e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -22.345925512384       residual = 2.07e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -22.345928338644       residual = 1.10e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -22.345935052414       residual = 3.09e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -22.345935677455       residual = 1.86e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -22.345935489654       residual = 2.82e-07           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -22.345935298725       residual = 4.10e-08           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   energy =     -22.345935225962       residual = 2.00e-08           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   energy =     -22.345935370724       residual = 4.27e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         18 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 6.2500e-01 is 7.349948e-02

solving harmonic davidson linear method for identity shift 2.5000e+00, overlap shift 2.5000e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.334314218153       residual = 4.66e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.334859305776       residual = 2.49e-02           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.335823677411       residual = 8.98e-02           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.336346969950       residual = 2.09e-02           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.337319393730       residual = 6.15e-03           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.337541331608       residual = 4.28e-03           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.337640355274       residual = 9.95e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.337699732601       residual = 3.89e-04           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.337722803934       residual = 1.51e-04           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.337730416915       residual = 3.41e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -22.337733887872       residual = 1.63e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -22.337734744748       residual = 7.08e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -22.337734759131       residual = 1.19e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -22.337735662253       residual = 4.11e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -22.337735492538       residual = 1.07e-07           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -22.337735476417       residual = 4.35e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -22.337735438108       residual = 6.47e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         16 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 2.5000e+00 is 1.803669e-02

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.053879 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 6.5508e+01
  </log>
  <optVariables href="FORMP2PJWARM.s003.opt.xml">
 uu_0                 1.319382e-01 1 1  ON 0
 uu_1                 3.137487e-02 1 1  ON 1
 uu_2                -3.191717e-02 1 1  ON 2
 uu_3                -3.949764e-02 1 1  ON 3
 uu_4                -3.428784e-02 1 1  ON 4
 uu_5                -2.498388e-02 1 1  ON 5
 uu_6                -1.510519e-02 1 1  ON 6
 uu_7                -7.752926e-03 1 1  ON 7
 uu_8                -5.154201e-03 1 1  ON 8
 uu_9                -2.684297e-03 1 1  ON 9
 ud_0                 2.609947e-01 1 1  ON 10
 ud_1                 2.491771e-02 1 1  ON 11
 ud_2                -5.728353e-02 1 1  ON 12
 ud_3                -6.504988e-02 1 1  ON 13
 ud_4                -5.589270e-02 1 1  ON 14
 ud_5                -4.302976e-02 1 1  ON 15
 ud_6                -2.925607e-02 1 1  ON 16
 ud_7                -1.803506e-02 1 1  ON 17
 ud_8                -1.041730e-02 1 1  ON 18
 ud_9                -4.327988e-03 1 1  ON 19
 eC_0                -9.089864e-02 1 1  ON 20
 eC_1                -6.281406e-02 1 1  ON 21
 eC_2                 5.714677e-02 1 1  ON 22
 eC_3                 6.898313e-02 1 1  ON 23
 eC_4                 3.635235e-02 1 1  ON 24
 eC_5                 7.322324e-03 1 1  ON 25
 eC_6                -9.832661e-03 1 1  ON 26
 eC_7                -4.193255e-03 1 1  ON 27
 eC_8                -1.365172e-03 1 1  ON 28
 eC_9                -4.929497e-04 1 1  ON 29
 eO_0                -2.724029e-01 1 1  ON 30
 eO_1                -9.807009e-02 1 1  ON 31
 eO_2                 1.263406e-01 1 1  ON 32
 eO_3                 1.353819e-01 1 1  ON 33
 eO_4                 9.543896e-02 1 1  ON 34
 eO_5                 4.407276e-02 1 1  ON 35
 eO_6                -1.151873e-02 1 1  ON 36
 eO_7                -1.211820e-02 1 1  ON 37
 eO_8                -4.880896e-03 1 1  ON 38
 eO_9                -1.405528e-03 1 1  ON 39
eH1_0                -2.937002e-02 1 1  ON 40
eH1_1                 1.647738e-02 1 1  ON 41
eH1_2                 2.036416e-02 1 1  ON 42
eH1_3                 2.347812e-04 1 1  ON 43
eH1_4                -1.131760e-02 1 1  ON 44
eH1_5                -5.477497e-03 1 1  ON 45
eH1_6                 1.157410e-02 1 1  ON 46
eH1_7                 2.439781e-03 1 1  ON 47
eH1_8                -3.542868e-03 1 1  ON 48
eH1_9                -9.660546e-04 1 1  ON 49
eH2_0                -2.945908e-02 1 1  ON 50
eH2_1                 1.669365e-02 1 1  ON 51
eH2_2                 2.077832e-02 1 1  ON 52
eH2_3                 2.012400e-04 1 1  ON 53
eH2_4                -1.127513e-02 1 1  ON 54
eH2_5                -4.986001e-03 1 1  ON 55
eH2_6                 1.119687e-02 1 1  ON 56
eH2_7                 2.559685e-03 1 1  ON 57
eH2_8                -3.836289e-03 1 1  ON 58
eH2_9                -1.311344e-03 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 3
    time step          = 0.05
    reference energy   = -22.3528
    reference variance = 0.787162
====================================================
  Execution time = 4.8544e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORMP2PJWARM.s003
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2360e+01
  VMC Evar = 6.5779e-01
  Total weights = 2.0000e+06
  Execution time = 4.6379e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.726668776331
                                         uncertainty =       0.003337982442

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.726668776331
                                         uncertainty =       0.003337982442

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000602761213
  error estimate for blocks of size 2^( 2) =       0.000661518417
  error estimate for blocks of size 2^( 3) =       0.000718638759
  error estimate for blocks of size 2^( 4) =       0.000760468197
  error estimate for blocks of size 2^( 5) =       0.000783965756
  error estimate for blocks of size 2^( 6) =       0.000794273583
  error estimate for blocks of size 2^( 7) =       0.000803573592

      target function =                  N/A
              le_mean =     -22.363252792148
             les_mean =     500.841717242083
             stat err =       0.000785570282
             autocorr =       1.698554534987
              std dev =       0.852433082350
             le_variance =       0.726642159885

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.635663570655
                                         uncertainty =       0.005101542683

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.635663570655
                                         uncertainty =       0.005101542683

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000563718925
  error estimate for blocks of size 2^( 2) =       0.000595519583
  error estimate for blocks of size 2^( 3) =       0.000630012020
  error estimate for blocks of size 2^( 4) =       0.000656177788
  error estimate for blocks of size 2^( 5) =       0.000672329202
  error estimate for blocks of size 2^( 6) =       0.000680289399
  error estimate for blocks of size 2^( 7) =       0.000685947477

      target function =                  N/A
              le_mean =     -22.386935032288
             les_mean =     501.810417875545
             stat err =       0.000673685966
             autocorr =       1.428202439074
              std dev =       0.797218949504
             le_variance =       0.635558053448

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.627224987746
                                         uncertainty =       0.004133790653

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.627224987746
                                         uncertainty =       0.004133790653

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000559981731
  error estimate for blocks of size 2^( 2) =       0.000604815332
  error estimate for blocks of size 2^( 3) =       0.000651221452
  error estimate for blocks of size 2^( 4) =       0.000686243581
  error estimate for blocks of size 2^( 5) =       0.000706893639
  error estimate for blocks of size 2^( 6) =       0.000716352415
  error estimate for blocks of size 2^( 7) =       0.000724062377

      target function =                  N/A
              le_mean =     -22.363311402491
             les_mean =     500.744855649782
             stat err =       0.000708388003
             autocorr =       1.600275209730
              std dev =       0.791933758956
             le_variance =       0.627159078575

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.705921638718
                                         uncertainty =       0.003431019604

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.705921638718
                                         uncertainty =       0.003431019604

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000594091803
  error estimate for blocks of size 2^( 2) =       0.000651081342
  error estimate for blocks of size 2^( 3) =       0.000706917565
  error estimate for blocks of size 2^( 4) =       0.000747984153
  error estimate for blocks of size 2^( 5) =       0.000771190089
  error estimate for blocks of size 2^( 6) =       0.000781407687
  error estimate for blocks of size 2^( 7) =       0.000790520928

      target function =                  N/A
              le_mean =     -22.361849438611
             les_mean =     500.758200102086
             stat err =       0.000772775714
             autocorr =       1.691997862807
              std dev =       0.840172684589
             le_variance =       0.705890139930


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.363252792148        initial
            N/A            N/A                    N/A                    N/A     bad update
     6.2500e-01     6.2500e+00             7.3499e-02       -22.363311402491  <--
     2.5000e+00     2.5000e+01             1.8037e-02       -22.361849438611

*****************************************************************************
Applying the update for shift_i =   6.2500e-01     and shift_s =   6.2500e+00
*****************************************************************************

  Execution time = 7.1658e+01
  </log>
  <optVariables href="FORMP2PJWARM.s003.opt.xml">
 uu_0                 1.319382e-01 1 1  ON 0
 uu_1                 3.137487e-02 1 1  ON 1
 uu_2                -3.191717e-02 1 1  ON 2
 uu_3                -3.949764e-02 1 1  ON 3
 uu_4                -3.428784e-02 1 1  ON 4
 uu_5                -2.498388e-02 1 1  ON 5
 uu_6                -1.510519e-02 1 1  ON 6
 uu_7                -7.752926e-03 1 1  ON 7
 uu_8                -5.154201e-03 1 1  ON 8
 uu_9                -2.684297e-03 1 1  ON 9
 ud_0                 2.609947e-01 1 1  ON 10
 ud_1                 2.491771e-02 1 1  ON 11
 ud_2                -5.728353e-02 1 1  ON 12
 ud_3                -6.504988e-02 1 1  ON 13
 ud_4                -5.589270e-02 1 1  ON 14
 ud_5                -4.302976e-02 1 1  ON 15
 ud_6                -2.925607e-02 1 1  ON 16
 ud_7                -1.803506e-02 1 1  ON 17
 ud_8                -1.041730e-02 1 1  ON 18
 ud_9                -4.327988e-03 1 1  ON 19
 eC_0                -9.089864e-02 1 1  ON 20
 eC_1                -6.281406e-02 1 1  ON 21
 eC_2                 5.714677e-02 1 1  ON 22
 eC_3                 6.898313e-02 1 1  ON 23
 eC_4                 3.635235e-02 1 1  ON 24
 eC_5                 7.322324e-03 1 1  ON 25
 eC_6                -9.832661e-03 1 1  ON 26
 eC_7                -4.193255e-03 1 1  ON 27
 eC_8                -1.365172e-03 1 1  ON 28
 eC_9                -4.929497e-04 1 1  ON 29
 eO_0                -2.724029e-01 1 1  ON 30
 eO_1                -9.807009e-02 1 1  ON 31
 eO_2                 1.263406e-01 1 1  ON 32
 eO_3                 1.353819e-01 1 1  ON 33
 eO_4                 9.543896e-02 1 1  ON 34
 eO_5                 4.407276e-02 1 1  ON 35
 eO_6                -1.151873e-02 1 1  ON 36
 eO_7                -1.211820e-02 1 1  ON 37
 eO_8                -4.880896e-03 1 1  ON 38
 eO_9                -1.405528e-03 1 1  ON 39
eH1_0                -2.937002e-02 1 1  ON 40
eH1_1                 1.647738e-02 1 1  ON 41
eH1_2                 2.036416e-02 1 1  ON 42
eH1_3                 2.347812e-04 1 1  ON 43
eH1_4                -1.131760e-02 1 1  ON 44
eH1_5                -5.477497e-03 1 1  ON 45
eH1_6                 1.157410e-02 1 1  ON 46
eH1_7                 2.439781e-03 1 1  ON 47
eH1_8                -3.542868e-03 1 1  ON 48
eH1_9                -9.660546e-04 1 1  ON 49
eH2_0                -2.945908e-02 1 1  ON 50
eH2_1                 1.669365e-02 1 1  ON 51
eH2_2                 2.077832e-02 1 1  ON 52
eH2_3                 2.012400e-04 1 1  ON 53
eH2_4                -1.127513e-02 1 1  ON 54
eH2_5                -4.986001e-03 1 1  ON 55
eH2_6                 1.119687e-02 1 1  ON 56
eH2_7                 2.559685e-03 1 1  ON 57
eH2_8                -3.836289e-03 1 1  ON 58
eH2_9                -1.311344e-03 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.3717e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORMP2PJWARM.s004 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORMP2PJWARM.s004 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=4  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2265e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 30888 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 4
    time step          = 0.05
    reference energy   = -22.3124
    reference variance = 1.12476
====================================================
  Execution time = 5.0160e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORMP2PJWARM.s004
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2360e+01
  VMC Evar = 6.5866e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.6159e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.658526635401
                                         uncertainty =       0.004095937137

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.658526635401
                                         uncertainty =       0.004095937137

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000573870832
  error estimate for blocks of size 2^( 2) =       0.000626841387
  error estimate for blocks of size 2^( 3) =       0.000678477961
  error estimate for blocks of size 2^( 4) =       0.000718410689
  error estimate for blocks of size 2^( 5) =       0.000742528752
  error estimate for blocks of size 2^( 6) =       0.000753916812
  error estimate for blocks of size 2^( 7) =       0.000759164089

      target function =                  N/A
              le_mean =     -22.360038388014
             les_mean =     500.629971847991
             stat err =       0.000743505086
             autocorr =       1.678570490713
              std dev =       0.811575913787
             le_variance =       0.658655463838


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.236003838801e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5625e-01, overlap shift 1.5625e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.360038388014       residual = 2.14e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.361938082199       residual = 1.39e-02           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.366074940852       residual = 5.37e-02           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.370075488874       residual = 1.77e-02           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.374112606234       residual = 8.31e-03           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.375631615553       residual = 5.63e-03           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.376822086464       residual = 2.66e-03           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.377844560521       residual = 1.34e-03           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.378212127162       residual = 9.31e-04           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.378630068233       residual = 3.83e-04           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -22.378757072825       residual = 2.47e-04           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -22.378807601964       residual = 1.02e-04           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -22.378880964871       residual = 7.30e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -22.378894815756       residual = 2.31e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -22.378920906584       residual = 1.78e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -22.378919201648       residual = 3.34e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -22.378927295326       residual = 7.75e-07           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   energy =     -22.378929927681       residual = 3.37e-07           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   energy =     -22.378930672244       residual = 1.83e-07           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   energy =     -22.378930755557       residual = 1.18e-07           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   energy =     -22.378930665746       residual = 2.32e-08           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   energy =     -22.378930476772       residual = 1.04e-08           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   energy =     -22.378930445968       residual = 2.84e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         22 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.5625e-01 is 2.270154e-01

solving harmonic davidson linear method for identity shift 6.2500e-01, overlap shift 6.2500e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.360038388014       residual = 2.14e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.360863306481       residual = 1.40e-02           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.362210015335       residual = 5.69e-02           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.364218744296       residual = 1.28e-02           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.365786356378       residual = 6.32e-03           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.366242104430       residual = 3.08e-03           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.366557540366       residual = 9.13e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.366765814547       residual = 4.31e-04           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.366832751242       residual = 2.29e-04           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.366878957833       residual = 5.54e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -22.366881573340       residual = 3.53e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -22.366885675871       residual = 1.54e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -22.366892859467       residual = 4.81e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -22.366891059285       residual = 1.51e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -22.366891996219       residual = 4.12e-07           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -22.366891211504       residual = 1.84e-07           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -22.366891696650       residual = 3.63e-08           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   energy =     -22.366891849094       residual = 1.30e-08           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   energy =     -22.366891925934       residual = 3.73e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         18 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 6.2500e-01 is 5.540527e-02

solving harmonic davidson linear method for identity shift 2.5000e+00, overlap shift 2.5000e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.360038388014       residual = 2.14e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.360291160256       residual = 1.42e-02           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.360650269229       residual = 5.64e-02           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.361295344608       residual = 1.10e-02           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.361752485156       residual = 5.27e-03           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.361864761697       residual = 2.16e-03           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.361943000976       residual = 5.17e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.361981750658       residual = 2.16e-04           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.361994903423       residual = 8.19e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.362000807648       residual = 1.98e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -22.362001534100       residual = 9.29e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -22.362001924795       residual = 4.07e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -22.362002771224       residual = 9.66e-07           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -22.362002885598       residual = 4.16e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -22.362002426428       residual = 1.32e-07           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -22.362002589412       residual = 2.02e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -22.362002539476       residual = 3.60e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         16 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 2.5000e+00 is 1.404651e-02

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.067911 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 6.6338e+01
  </log>
  <optVariables href="FORMP2PJWARM.s004.opt.xml">
 uu_0                 1.512555e-01 1 1  ON 0
 uu_1                 3.498633e-02 1 1  ON 1
 uu_2                -3.435495e-02 1 1  ON 2
 uu_3                -4.766764e-02 1 1  ON 3
 uu_4                -4.232636e-02 1 1  ON 4
 uu_5                -3.115138e-02 1 1  ON 5
 uu_6                -1.840254e-02 1 1  ON 6
 uu_7                -7.760980e-03 1 1  ON 7
 uu_8                -3.475209e-03 1 1  ON 8
 uu_9                -9.030285e-04 1 1  ON 9
 ud_0                 2.819146e-01 1 1  ON 10
 ud_1                 3.491558e-02 1 1  ON 11
 ud_2                -5.768756e-02 1 1  ON 12
 ud_3                -7.382165e-02 1 1  ON 13
 ud_4                -6.529505e-02 1 1  ON 14
 ud_5                -5.120161e-02 1 1  ON 15
 ud_6                -3.474187e-02 1 1  ON 16
 ud_7                -2.017288e-02 1 1  ON 17
 ud_8                -1.002822e-02 1 1  ON 18
 ud_9                -2.956256e-03 1 1  ON 19
 eC_0                -1.177724e-01 1 1  ON 20
 eC_1                -7.743088e-02 1 1  ON 21
 eC_2                 6.445377e-02 1 1  ON 22
 eC_3                 8.637508e-02 1 1  ON 23
 eC_4                 4.876321e-02 1 1  ON 24
 eC_5                 1.341529e-02 1 1  ON 25
 eC_6                -1.110911e-02 1 1  ON 26
 eC_7                -4.676621e-03 1 1  ON 27
 eC_8                -1.355467e-03 1 1  ON 28
 eC_9                -4.688001e-04 1 1  ON 29
 eO_0                -3.278082e-01 1 1  ON 30
 eO_1                -1.194733e-01 1 1  ON 31
 eO_2                 1.347459e-01 1 1  ON 32
 eO_3                 1.624271e-01 1 1  ON 33
 eO_4                 1.208772e-01 1 1  ON 34
 eO_5                 6.073602e-02 1 1  ON 35
 eO_6                -9.560425e-03 1 1  ON 36
 eO_7                -1.423216e-02 1 1  ON 37
 eO_8                -5.698728e-03 1 1  ON 38
 eO_9                -1.336109e-03 1 1  ON 39
eH1_0                -3.660701e-02 1 1  ON 40
eH1_1                 1.863388e-02 1 1  ON 41
eH1_2                 2.184809e-02 1 1  ON 42
eH1_3                -9.637326e-04 1 1  ON 43
eH1_4                -1.078932e-02 1 1  ON 44
eH1_5                -6.006793e-03 1 1  ON 45
eH1_6                 1.419830e-02 1 1  ON 46
eH1_7                 4.978917e-03 1 1  ON 47
eH1_8                -3.891525e-03 1 1  ON 48
eH1_9                -9.879308e-04 1 1  ON 49
eH2_0                -3.651266e-02 1 1  ON 50
eH2_1                 1.896334e-02 1 1  ON 51
eH2_2                 2.209092e-02 1 1  ON 52
eH2_3                -9.089281e-04 1 1  ON 53
eH2_4                -1.081688e-02 1 1  ON 54
eH2_5                -5.728744e-03 1 1  ON 55
eH2_6                 1.383782e-02 1 1  ON 56
eH2_7                 5.024633e-03 1 1  ON 57
eH2_8                -4.069442e-03 1 1  ON 58
eH2_9                -1.358216e-03 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 4
    time step          = 0.05
    reference energy   = -22.3691
    reference variance = 0.59679
====================================================
  Execution time = 4.8886e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORMP2PJWARM.s004
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2375e+01
  VMC Evar = 6.1683e-01
  Total weights = 2.0000e+06
  Execution time = 4.6572e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.648006765332
                                         uncertainty =       0.004645147495

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.648006765332
                                         uncertainty =       0.004645147495

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000569186597
  error estimate for blocks of size 2^( 2) =       0.000620467281
  error estimate for blocks of size 2^( 3) =       0.000671308455
  error estimate for blocks of size 2^( 4) =       0.000710095902
  error estimate for blocks of size 2^( 5) =       0.000733917261
  error estimate for blocks of size 2^( 6) =       0.000742302645
  error estimate for blocks of size 2^( 7) =       0.000751866384

      target function =                  N/A
              le_mean =     -22.375938094676
             les_mean =     501.330552057322
             stat err =       0.000734545548
             autocorr =       1.665436704523
              std dev =       0.804951405076
             le_variance =       0.647946764534

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.590656849020
                                         uncertainty =       0.005646827704

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.590656849020
                                         uncertainty =       0.005646827704

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000543409852
  error estimate for blocks of size 2^( 2) =       0.000577673818
  error estimate for blocks of size 2^( 3) =       0.000613386388
  error estimate for blocks of size 2^( 4) =       0.000642201042
  error estimate for blocks of size 2^( 5) =       0.000661711660
  error estimate for blocks of size 2^( 6) =       0.000668852859
  error estimate for blocks of size 2^( 7) =       0.000676861381

      target function =                  N/A
              le_mean =     -22.384523946169
             les_mean =     501.657500536729
             stat err =       0.000662406735
             autocorr =       1.485916697259
              std dev =       0.768497583224
             le_variance =       0.590588535421

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.601577313958
                                         uncertainty =       0.005196889005

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.601577313958
                                         uncertainty =       0.005196889005

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000548412350
  error estimate for blocks of size 2^( 2) =       0.000590382352
  error estimate for blocks of size 2^( 3) =       0.000633464897
  error estimate for blocks of size 2^( 4) =       0.000667443402
  error estimate for blocks of size 2^( 5) =       0.000689468125
  error estimate for blocks of size 2^( 6) =       0.000697299190
  error estimate for blocks of size 2^( 7) =       0.000706223422

      target function =                  N/A
              le_mean =     -22.376118390160
             les_mean =     501.292186120593
             stat err =       0.000690108535
             autocorr =       1.583508300787
              std dev =       0.775572182914
             le_variance =       0.601512210910

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.638799114998
                                         uncertainty =       0.004718252102

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.638799114998
                                         uncertainty =       0.004718252102

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000565127591
  error estimate for blocks of size 2^( 2) =       0.000615158780
  error estimate for blocks of size 2^( 3) =       0.000665010053
  error estimate for blocks of size 2^( 4) =       0.000703210570
  error estimate for blocks of size 2^( 5) =       0.000726834818
  error estimate for blocks of size 2^( 6) =       0.000735147359
  error estimate for blocks of size 2^( 7) =       0.000744644447

      target function =                  N/A
              le_mean =     -22.375334764991
             les_mean =     501.294343913262
             stat err =       0.000727459299
             autocorr =       1.657007130473
              std dev =       0.799211103034
             le_variance =       0.638738387213


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.375938094676        initial
     1.5625e-01     1.5625e+00             2.2702e-01       -22.384523946169  <--
     6.2500e-01     6.2500e+00             5.5405e-02       -22.376118390160
     2.5000e+00     2.5000e+01             1.4047e-02       -22.375334764991

*****************************************************************************
Applying the update for shift_i =   1.5625e-01     and shift_s =   1.5625e+00
*****************************************************************************

  Execution time = 7.2181e+01
  </log>
  <optVariables href="FORMP2PJWARM.s004.opt.xml">
 uu_0                 2.027708e-01 1 1  ON 0
 uu_1                 4.875610e-02 1 1  ON 1
 uu_2                -3.798488e-02 1 1  ON 2
 uu_3                -6.902868e-02 1 1  ON 3
 uu_4                -6.813467e-02 1 1  ON 4
 uu_5                -5.432952e-02 1 1  ON 5
 uu_6                -3.369564e-02 1 1  ON 6
 uu_7                -1.077170e-02 1 1  ON 7
 uu_8                 3.815650e-03 1 1  ON 8
 uu_9                 8.819367e-03 1 1  ON 9
 ud_0                 3.358049e-01 1 1  ON 10
 ud_1                 6.553652e-02 1 1  ON 11
 ud_2                -5.306727e-02 1 1  ON 12
 ud_3                -9.333771e-02 1 1  ON 13
 ud_4                -9.320154e-02 1 1  ON 14
 ud_5                -7.921285e-02 1 1  ON 15
 ud_6                -5.666196e-02 1 1  ON 16
 ud_7                -3.056831e-02 1 1  ON 17
 ud_8                -8.658735e-03 1 1  ON 18
 ud_9                 4.419317e-03 1 1  ON 19
 eC_0                -2.152197e-01 1 1  ON 20
 eC_1                -1.287688e-01 1 1  ON 21
 eC_2                 7.503811e-02 1 1  ON 22
 eC_3                 1.403141e-01 1 1  ON 23
 eC_4                 1.015154e-01 1 1  ON 24
 eC_5                 4.629551e-02 1 1  ON 25
 eC_6                -1.230498e-02 1 1  ON 26
 eC_7                -5.578833e-03 1 1  ON 27
 eC_8                -9.870182e-04 1 1  ON 28
 eC_9                -2.249629e-04 1 1  ON 29
 eO_0                -4.994183e-01 1 1  ON 30
 eO_1                -2.010297e-01 1 1  ON 31
 eO_2                 1.384140e-01 1 1  ON 32
 eO_3                 2.350363e-01 1 1  ON 33
 eO_4                 2.089194e-01 1 1  ON 34
 eO_5                 1.324966e-01 1 1  ON 35
 eO_6                 1.291419e-02 1 1  ON 36
 eO_7                -1.852140e-02 1 1  ON 37
 eO_8                -8.491393e-03 1 1  ON 38
 eO_9                -6.530276e-04 1 1  ON 39
eH1_0                -6.105013e-02 1 1  ON 40
eH1_1                 1.972394e-02 1 1  ON 41
eH1_2                 2.260981e-02 1 1  ON 42
eH1_3                -4.501538e-03 1 1  ON 43
eH1_4                -5.820849e-03 1 1  ON 44
eH1_5                -6.577616e-03 1 1  ON 45
eH1_6                 2.240139e-02 1 1  ON 46
eH1_7                 1.755988e-02 1 1  ON 47
eH1_8                -3.525551e-03 1 1  ON 48
eH1_9                -5.991729e-04 1 1  ON 49
eH2_0                -6.045312e-02 1 1  ON 50
eH2_1                 2.045791e-02 1 1  ON 51
eH2_2                 2.253648e-02 1 1  ON 52
eH2_3                -4.307932e-03 1 1  ON 53
eH2_4                -6.103106e-03 1 1  ON 54
eH2_5                -6.925150e-03 1 1  ON 55
eH2_6                 2.199096e-02 1 1  ON 56
eH2_7                 1.730245e-02 1 1  ON 57
eH2_8                -3.221510e-03 1 1  ON 58
eH2_9                -1.092344e-03 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.3853e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORMP2PJWARM.s005 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORMP2PJWARM.s005 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=5  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2280e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 30888 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 5
    time step          = 0.05
    reference energy   = -22.4117
    reference variance = 0.341736
====================================================
  Execution time = 4.9085e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORMP2PJWARM.s005
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2401e+01
  VMC Evar = 5.7024e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.5961e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.570147251214
                                         uncertainty =       0.004032251209

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.570147251214
                                         uncertainty =       0.004032251209

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000533967257
  error estimate for blocks of size 2^( 2) =       0.000566946988
  error estimate for blocks of size 2^( 3) =       0.000600564931
  error estimate for blocks of size 2^( 4) =       0.000628496040
  error estimate for blocks of size 2^( 5) =       0.000645229994
  error estimate for blocks of size 2^( 6) =       0.000655873482
  error estimate for blocks of size 2^( 7) =       0.000660378686

      target function =                  N/A
              le_mean =     -22.400911647624
             les_mean =     502.371084423624
             stat err =       0.000647494550
             autocorr =       1.470425347423
              std dev =       0.755143737372
             le_variance =       0.570242064092


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.240091164762e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.9062e-02, overlap shift 3.9062e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.400911647624       residual = 2.17e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.401192730549       residual = 1.91e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.402896505179       residual = 7.12e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.404982138361       residual = 5.70e-03           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.406577437996       residual = 4.23e-03           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.407519802675       residual = 2.10e-03           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.408007559978       residual = 1.47e-03           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.408749509075       residual = 5.41e-04           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.409027961271       residual = 5.02e-04           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.409250045324       residual = 5.19e-04           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -22.409541199315       residual = 4.17e-04           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -22.409674091385       residual = 1.46e-04           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -22.409813801058       residual = 1.72e-04           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -22.409954697190       residual = 5.49e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -22.409993428101       residual = 3.97e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -22.410016797228       residual = 1.47e-05           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -22.410040470697       residual = 1.34e-05           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   energy =     -22.410070192082       residual = 9.44e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   energy =     -22.410076191788       residual = 5.73e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   energy =     -22.410084771961       residual = 1.95e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   energy =     -22.410087480195       residual = 4.89e-07           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   energy =     -22.410089828167       residual = 2.85e-07           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   energy =     -22.410088737190       residual = 1.46e-07           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   energy =     -22.410088782426       residual = 7.72e-08           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   energy =     -22.410088622050       residual = 3.08e-08           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   energy =     -22.410088773621       residual = 1.55e-08           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   energy =     -22.410088647944       residual = 1.19e-08           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   energy =     -22.410088802729       residual = 7.19e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         27 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 3.9062e-02 is 4.523395e-01

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 1.5625e-01, overlap shift 1.5625e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.400911647624       residual = 2.17e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.401077911497       residual = 1.84e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.402204971274       residual = 5.59e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.403100424998       residual = 3.93e-03           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.403770699456       residual = 1.77e-03           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.404090878325       residual = 8.40e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.404225008676       residual = 4.25e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.404409053691       residual = 1.14e-04           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.404459458881       residual = 1.07e-04           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.404481550865       residual = 8.71e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -22.404521504168       residual = 3.22e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -22.404535995022       residual = 2.24e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -22.404539007026       residual = 1.31e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -22.404546700188       residual = 2.64e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -22.404550414017       residual = 1.26e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -22.404550275599       residual = 6.24e-07           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -22.404549960074       residual = 4.23e-07           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   energy =     -22.404551821303       residual = 1.74e-07           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   energy =     -22.404551159604       residual = 5.04e-08           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   energy =     -22.404551193992       residual = 1.05e-08           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   energy =     -22.404550951582       residual = 3.69e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         20 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.5625e-01 is 7.350568e-02

solving harmonic davidson linear method for identity shift 6.2500e-01, overlap shift 6.2500e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.400911647624       residual = 2.17e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.400974768035       residual = 1.82e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.401427168602       residual = 4.15e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.401667019408       residual = 2.56e-03           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.401891667794       residual = 5.93e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.401950900374       residual = 2.66e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.401971788132       residual = 1.37e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.402002280141       residual = 2.93e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.402005264288       residual = 1.40e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.402008654537       residual = 1.03e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -22.402011939247       residual = 3.23e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -22.402012324933       residual = 1.34e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -22.402011575459       residual = 5.33e-07           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -22.402011984166       residual = 1.91e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -22.402012224194       residual = 3.46e-08           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -22.402012176102       residual = 1.17e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -22.402012244087       residual = 4.95e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         16 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 6.2500e-01 is 1.854205e-02

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.087168 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 6.5069e+01
  </log>
  <optVariables href="FORMP2PJWARM.s005.opt.xml">
 uu_0                 2.170164e-01 1 1  ON 0
 uu_1                 5.803043e-02 1 1  ON 1
 uu_2                -3.541170e-02 1 1  ON 2
 uu_3                -7.406218e-02 1 1  ON 3
 uu_4                -7.943726e-02 1 1  ON 4
 uu_5                -6.844103e-02 1 1  ON 5
 uu_6                -4.649867e-02 1 1  ON 6
 uu_7                -1.723169e-02 1 1  ON 7
 uu_8                 7.806971e-03 1 1  ON 8
 uu_9                 1.832788e-02 1 1  ON 9
 ud_0                 3.504572e-01 1 1  ON 10
 ud_1                 7.843632e-02 1 1  ON 11
 ud_2                -4.600628e-02 1 1  ON 12
 ud_3                -9.437289e-02 1 1  ON 13
 ud_4                -1.026646e-01 1 1  ON 14
 ud_5                -9.296962e-02 1 1  ON 15
 ud_6                -7.148043e-02 1 1  ON 16
 ud_7                -4.093669e-02 1 1  ON 17
 ud_8                -9.916729e-03 1 1  ON 18
 ud_9                 1.106117e-02 1 1  ON 19
 eC_0                -2.692345e-01 1 1  ON 20
 eC_1                -1.583446e-01 1 1  ON 21
 eC_2                 6.545414e-02 1 1  ON 22
 eC_3                 1.593728e-01 1 1  ON 23
 eC_4                 1.374783e-01 1 1  ON 24
 eC_5                 7.829952e-02 1 1  ON 25
 eC_6                -8.238876e-03 1 1  ON 26
 eC_7                -4.797905e-03 1 1  ON 27
 eC_8                -2.278386e-04 1 1  ON 28
 eC_9                 1.842831e-04 1 1  ON 29
 eO_0                -5.729240e-01 1 1  ON 30
 eO_1                -2.534223e-01 1 1  ON 31
 eO_2                 1.152363e-01 1 1  ON 32
 eO_3                 2.512202e-01 1 1  ON 33
 eO_4                 2.529502e-01 1 1  ON 34
 eO_5                 1.849516e-01 1 1  ON 35
 eO_6                 4.513184e-02 1 1  ON 36
 eO_7                -1.531655e-02 1 1  ON 37
 eO_8                -9.436391e-03 1 1  ON 38
 eO_9                 2.753156e-04 1 1  ON 39
eH1_0                -7.212824e-02 1 1  ON 40
eH1_1                 1.422492e-02 1 1  ON 41
eH1_2                 1.915295e-02 1 1  ON 42
eH1_3                -5.606152e-03 1 1  ON 43
eH1_4                -1.462446e-03 1 1  ON 44
eH1_5                -5.715611e-03 1 1  ON 45
eH1_6                 2.375602e-02 1 1  ON 46
eH1_7                 2.814326e-02 1 1  ON 47
eH1_8                -7.163290e-04 1 1  ON 48
eH1_9                 1.678768e-04 1 1  ON 49
eH2_0                -7.250328e-02 1 1  ON 50
eH2_1                 1.363577e-02 1 1  ON 51
eH2_2                 1.989507e-02 1 1  ON 52
eH2_3                -5.400312e-03 1 1  ON 53
eH2_4                -1.345851e-03 1 1  ON 54
eH2_5                -5.723561e-03 1 1  ON 55
eH2_6                 2.409500e-02 1 1  ON 56
eH2_7                 2.750167e-02 1 1  ON 57
eH2_8                -5.431382e-04 1 1  ON 58
eH2_9                -6.852625e-05 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 5
    time step          = 0.05
    reference energy   = -22.3534
    reference variance = 0.345387
====================================================
  Execution time = 5.0572e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORMP2PJWARM.s005
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2409e+01
  VMC Evar = 5.6702e-01
  Total weights = 2.0000e+06
  Execution time = 4.6502e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.571806431327
                                         uncertainty =       0.005362165705

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.571806431327
                                         uncertainty =       0.005362165705

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000534640345
  error estimate for blocks of size 2^( 2) =       0.000567094369
  error estimate for blocks of size 2^( 3) =       0.000599472287
  error estimate for blocks of size 2^( 4) =       0.000625319941
  error estimate for blocks of size 2^( 5) =       0.000641755612
  error estimate for blocks of size 2^( 6) =       0.000652219122
  error estimate for blocks of size 2^( 7) =       0.000658233837

      target function =                  N/A
              le_mean =     -22.410006665347
             les_mean =     502.780079051792
             stat err =       0.000644382128
             autocorr =       1.452658457888
              std dev =       0.756095626705
             le_variance =       0.571680596722

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.643276211933
                                         uncertainty =       0.006005707645

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.643276211933
                                         uncertainty =       0.006005707645

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000567053170
  error estimate for blocks of size 2^( 2) =       0.000590336084
  error estimate for blocks of size 2^( 3) =       0.000611485756
  error estimate for blocks of size 2^( 4) =       0.000626829072
  error estimate for blocks of size 2^( 5) =       0.000637932428
  error estimate for blocks of size 2^( 6) =       0.000645342285
  error estimate for blocks of size 2^( 7) =       0.000650486921

      target function =                  N/A
              le_mean =     -22.431063789085
             les_mean =     503.795720984271
             stat err =       0.000640147677
             autocorr =       1.274420596030
              std dev =       0.801934283968
             le_variance =       0.643098595803

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.571183616380
                                         uncertainty =       0.005539990858

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.571183616380
                                         uncertainty =       0.005539990858

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000534339441
  error estimate for blocks of size 2^( 2) =       0.000561309406
  error estimate for blocks of size 2^( 3) =       0.000587878670
  error estimate for blocks of size 2^( 4) =       0.000608983476
  error estimate for blocks of size 2^( 5) =       0.000623049240
  error estimate for blocks of size 2^( 6) =       0.000632502175
  error estimate for blocks of size 2^( 7) =       0.000638370339

      target function =                  N/A
              le_mean =     -22.409999022045
             les_mean =     502.779093157931
             stat err =       0.000625726308
             autocorr =       1.371305968997
              std dev =       0.755670083690
             le_variance =       0.571037275384

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.569473246385
                                         uncertainty =       0.005377669561

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.569473246385
                                         uncertainty =       0.005377669561

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000533546998
  error estimate for blocks of size 2^( 2) =       0.000565175623
  error estimate for blocks of size 2^( 3) =       0.000596727792
  error estimate for blocks of size 2^( 4) =       0.000621937667
  error estimate for blocks of size 2^( 5) =       0.000638057447
  error estimate for blocks of size 2^( 6) =       0.000648415601
  error estimate for blocks of size 2^( 7) =       0.000654429877

      target function =                  N/A
              le_mean =     -22.409477351940
             les_mean =     502.754019701018
             stat err =       0.000640710148
             autocorr =       1.442041780658
              std dev =       0.754549401017
             le_variance =       0.569344798575


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.410006665347        initial  <--
            N/A            N/A                    N/A                    N/A     bad update
     1.5625e-01     1.5625e+00             7.3506e-02       -22.409999022045
     6.2500e-01     6.2500e+00             1.8542e-02       -22.409477351940

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 73.8078
  </log>
  <optVariables href="FORMP2PJWARM.s005.opt.xml">
 uu_0                 2.027708e-01 1 1  ON 0
 uu_1                 4.875610e-02 1 1  ON 1
 uu_2                -3.798488e-02 1 1  ON 2
 uu_3                -6.902868e-02 1 1  ON 3
 uu_4                -6.813467e-02 1 1  ON 4
 uu_5                -5.432952e-02 1 1  ON 5
 uu_6                -3.369564e-02 1 1  ON 6
 uu_7                -1.077170e-02 1 1  ON 7
 uu_8                 3.815650e-03 1 1  ON 8
 uu_9                 8.819367e-03 1 1  ON 9
 ud_0                 3.358049e-01 1 1  ON 10
 ud_1                 6.553652e-02 1 1  ON 11
 ud_2                -5.306727e-02 1 1  ON 12
 ud_3                -9.333771e-02 1 1  ON 13
 ud_4                -9.320154e-02 1 1  ON 14
 ud_5                -7.921285e-02 1 1  ON 15
 ud_6                -5.666196e-02 1 1  ON 16
 ud_7                -3.056831e-02 1 1  ON 17
 ud_8                -8.658735e-03 1 1  ON 18
 ud_9                 4.419317e-03 1 1  ON 19
 eC_0                -2.152197e-01 1 1  ON 20
 eC_1                -1.287688e-01 1 1  ON 21
 eC_2                 7.503811e-02 1 1  ON 22
 eC_3                 1.403141e-01 1 1  ON 23
 eC_4                 1.015154e-01 1 1  ON 24
 eC_5                 4.629551e-02 1 1  ON 25
 eC_6                -1.230498e-02 1 1  ON 26
 eC_7                -5.578833e-03 1 1  ON 27
 eC_8                -9.870182e-04 1 1  ON 28
 eC_9                -2.249629e-04 1 1  ON 29
 eO_0                -4.994183e-01 1 1  ON 30
 eO_1                -2.010297e-01 1 1  ON 31
 eO_2                 1.384140e-01 1 1  ON 32
 eO_3                 2.350363e-01 1 1  ON 33
 eO_4                 2.089194e-01 1 1  ON 34
 eO_5                 1.324966e-01 1 1  ON 35
 eO_6                 1.291419e-02 1 1  ON 36
 eO_7                -1.852140e-02 1 1  ON 37
 eO_8                -8.491393e-03 1 1  ON 38
 eO_9                -6.530276e-04 1 1  ON 39
eH1_0                -6.105013e-02 1 1  ON 40
eH1_1                 1.972394e-02 1 1  ON 41
eH1_2                 2.260981e-02 1 1  ON 42
eH1_3                -4.501538e-03 1 1  ON 43
eH1_4                -5.820849e-03 1 1  ON 44
eH1_5                -6.577616e-03 1 1  ON 45
eH1_6                 2.240139e-02 1 1  ON 46
eH1_7                 1.755988e-02 1 1  ON 47
eH1_8                -3.525551e-03 1 1  ON 48
eH1_9                -5.991729e-04 1 1  ON 49
eH2_0                -6.045312e-02 1 1  ON 50
eH2_1                 2.045791e-02 1 1  ON 51
eH2_2                 2.253648e-02 1 1  ON 52
eH2_3                -4.307932e-03 1 1  ON 53
eH2_4                -6.103106e-03 1 1  ON 54
eH2_5                -6.925150e-03 1 1  ON 55
eH2_6                 2.199096e-02 1 1  ON 56
eH2_7                 1.730245e-02 1 1  ON 57
eH2_8                -3.221510e-03 1 1  ON 58
eH2_9                -1.092344e-03 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.3888e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORMP2PJWARM.s006 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORMP2PJWARM.s006 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=6  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2297e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 30888 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 6
    time step          = 0.05
    reference energy   = -22.4211
    reference variance = 0.574537
====================================================
  Execution time = 4.9479e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORMP2PJWARM.s006
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2403e+01
  VMC Evar = 5.7351e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.5905e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.573423230383
                                         uncertainty =       0.003501674315

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.573423230383
                                         uncertainty =       0.003501674315

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000535494099
  error estimate for blocks of size 2^( 2) =       0.000568092600
  error estimate for blocks of size 2^( 3) =       0.000601352061
  error estimate for blocks of size 2^( 4) =       0.000628703146
  error estimate for blocks of size 2^( 5) =       0.000645864182
  error estimate for blocks of size 2^( 6) =       0.000654431829
  error estimate for blocks of size 2^( 7) =       0.000662786614

      target function =                  N/A
              le_mean =     -22.402525534418
             les_mean =     502.446657893638
             stat err =       0.000647946443
             autocorr =       1.464093597670
              std dev =       0.757303017392
             le_variance =       0.573507860151


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.240252553442e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.9062e-01, overlap shift 3.9062e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.402525534418       residual = 2.16e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.402599856239       residual = 1.90e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.403210187026       residual = 4.68e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.403578260630       residual = 2.95e-03           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.403985164002       residual = 1.02e-03           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.404091537680       residual = 4.29e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.404125004358       residual = 1.73e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.404172769094       residual = 4.18e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.404183625754       residual = 2.73e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.404189734040       residual = 2.06e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -22.404193217713       residual = 5.87e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -22.404197426082       residual = 3.06e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -22.404197969918       residual = 5.70e-07           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -22.404197498871       residual = 6.36e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -22.404197155619       residual = 8.56e-08           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -22.404197027963       residual = 5.72e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -22.404197062262       residual = 2.07e-08           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   energy =     -22.404197061719       residual = 9.47e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         17 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 3.9062e-01 is 2.911141e-02

solving harmonic davidson linear method for identity shift 1.5625e+00, overlap shift 1.5625e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.402525534418       residual = 2.16e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.402548386292       residual = 1.89e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.402742414109       residual = 3.89e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.402834226638       residual = 2.20e-03           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.402951243090       residual = 4.21e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.402967845269       residual = 1.91e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.402972474724       residual = 7.80e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.402980518555       residual = 1.82e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.402981650526       residual = 6.61e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.402982585035       residual = 4.02e-06           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -22.402982889123       residual = 1.17e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -22.402983321566       residual = 3.80e-07           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -22.402983368267       residual = 1.12e-07           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -22.402983257558       residual = 5.11e-08           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -22.402983217021       residual = 1.58e-08           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -22.402983199801       residual = 4.99e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         15 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.5625e+00 is 7.431057e-03

solving harmonic davidson linear method for identity shift 6.2500e+00, overlap shift 6.2500e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.402525534418       residual = 2.16e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.402531595725       residual = 1.90e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.402583753496       residual = 3.64e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.402606340029       residual = 1.97e-03           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.402636358869       residual = 2.93e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.402639858907       residual = 1.26e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.402640778679       residual = 6.22e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.402642439916       residual = 1.30e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.402642607299       residual = 4.13e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.402642820794       residual = 2.31e-06           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -22.402642889588       residual = 6.64e-07           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -22.402642936028       residual = 2.27e-07           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -22.402642955945       residual = 5.55e-08           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -22.402642940850       residual = 3.24e-08           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -22.402642931411       residual = 4.42e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         14 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 6.2500e+00 is 1.875358e-03

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.096549 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 6.5397e+01
  </log>
  <optVariables href="FORMP2PJWARM.s006.opt.xml">
 uu_0                 2.042280e-01 1 1  ON 0
 uu_1                 4.982740e-02 1 1  ON 1
 uu_2                -3.783100e-02 1 1  ON 2
 uu_3                -6.962415e-02 1 1  ON 3
 uu_4                -6.941978e-02 1 1  ON 4
 uu_5                -5.582544e-02 1 1  ON 5
 uu_6                -3.477766e-02 1 1  ON 6
 uu_7                -1.113654e-02 1 1  ON 7
 uu_8                 4.199725e-03 1 1  ON 8
 uu_9                 9.655432e-03 1 1  ON 9
 ud_0                 3.370496e-01 1 1  ON 10
 ud_1                 6.686664e-02 1 1  ON 11
 ud_2                -5.237269e-02 1 1  ON 12
 ud_3                -9.346909e-02 1 1  ON 13
 ud_4                -9.433350e-02 1 1  ON 14
 ud_5                -8.063169e-02 1 1  ON 15
 ud_6                -5.796834e-02 1 1  ON 16
 ud_7                -3.133726e-02 1 1  ON 17
 ud_8                -8.640641e-03 1 1  ON 18
 ud_9                 4.979604e-03 1 1  ON 19
 eC_0                -2.209057e-01 1 1  ON 20
 eC_1                -1.315331e-01 1 1  ON 21
 eC_2                 7.451847e-02 1 1  ON 22
 eC_3                 1.427925e-01 1 1  ON 23
 eC_4                 1.051057e-01 1 1  ON 24
 eC_5                 4.892877e-02 1 1  ON 25
 eC_6                -1.216565e-02 1 1  ON 26
 eC_7                -5.542191e-03 1 1  ON 27
 eC_8                -9.386436e-04 1 1  ON 28
 eC_9                -2.003111e-04 1 1  ON 29
 eO_0                -5.068494e-01 1 1  ON 30
 eO_1                -2.061168e-01 1 1  ON 31
 eO_2                 1.365026e-01 1 1  ON 32
 eO_3                 2.372923e-01 1 1  ON 33
 eO_4                 2.136815e-01 1 1  ON 34
 eO_5                 1.374591e-01 1 1  ON 35
 eO_6                 1.531783e-02 1 1  ON 36
 eO_7                -1.854284e-02 1 1  ON 37
 eO_8                -8.627221e-03 1 1  ON 38
 eO_9                -5.560219e-04 1 1  ON 39
eH1_0                -6.222320e-02 1 1  ON 40
eH1_1                 1.929247e-02 1 1  ON 41
eH1_2                 2.231826e-02 1 1  ON 42
eH1_3                -4.616156e-03 1 1  ON 43
eH1_4                -5.339593e-03 1 1  ON 44
eH1_5                -6.458663e-03 1 1  ON 45
eH1_6                 2.270435e-02 1 1  ON 46
eH1_7                 1.848541e-02 1 1  ON 47
eH1_8                -3.416064e-03 1 1  ON 48
eH1_9                -5.585546e-04 1 1  ON 49
eH2_0                -6.167528e-02 1 1  ON 50
eH2_1                 1.998363e-02 1 1  ON 51
eH2_2                 2.223089e-02 1 1  ON 52
eH2_3                -4.568456e-03 1 1  ON 53
eH2_4                -5.553275e-03 1 1  ON 54
eH2_5                -6.885625e-03 1 1  ON 55
eH2_6                 2.240490e-02 1 1  ON 56
eH2_7                 1.832493e-02 1 1  ON 57
eH2_8                -3.055246e-03 1 1  ON 58
eH2_9                -1.051357e-03 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 6
    time step          = 0.05
    reference energy   = -22.4098
    reference variance = 0.3298
====================================================
  Execution time = 4.8700e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORMP2PJWARM.s006
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2403e+01
  VMC Evar = 5.6254e-01
  Total weights = 2.0000e+06
  Execution time = 4.6269e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.563642083659
                                         uncertainty =       0.002515978466

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.563642083659
                                         uncertainty =       0.002515978466

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000530922681
  error estimate for blocks of size 2^( 2) =       0.000564579989
  error estimate for blocks of size 2^( 3) =       0.000598744418
  error estimate for blocks of size 2^( 4) =       0.000626256201
  error estimate for blocks of size 2^( 5) =       0.000642979492
  error estimate for blocks of size 2^( 6) =       0.000652869910
  error estimate for blocks of size 2^( 7) =       0.000657868870

      target function =                  N/A
              le_mean =     -22.403211733041
             les_mean =     502.467653459465
             stat err =       0.000644993618
             autocorr =       1.475870588646
              std dev =       0.750838055698
             le_variance =       0.563757785885

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.560141412014
                                         uncertainty =       0.002530373959

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.560141412014
                                         uncertainty =       0.002530373959

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000529272535
  error estimate for blocks of size 2^( 2) =       0.000561525011
  error estimate for blocks of size 2^( 3) =       0.000594280636
  error estimate for blocks of size 2^( 4) =       0.000620729198
  error estimate for blocks of size 2^( 5) =       0.000636843443
  error estimate for blocks of size 2^( 6) =       0.000646519474
  error estimate for blocks of size 2^( 7) =       0.000651462595

      target function =                  N/A
              le_mean =     -22.403284187702
             les_mean =     502.467400946952
             stat err =       0.000638888678
             autocorr =       1.457107747800
              std dev =       0.748504396878
             le_variance =       0.560258832145

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.561330070575
                                         uncertainty =       0.002520471855

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.561330070575
                                         uncertainty =       0.002520471855

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000529833332
  error estimate for blocks of size 2^( 2) =       0.000562769406
  error estimate for blocks of size 2^( 3) =       0.000596217950
  error estimate for blocks of size 2^( 4) =       0.000623197675
  error estimate for blocks of size 2^( 5) =       0.000639621169
  error estimate for blocks of size 2^( 6) =       0.000649400305
  error estimate for blocks of size 2^( 7) =       0.000654364582

      target function =                  N/A
              le_mean =     -22.403199921788
             les_mean =     502.464813175242
             stat err =       0.000641645933
             autocorr =       1.466602219641
              std dev =       0.749297484548
             le_variance =       0.561446720350

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.563300236339
                                         uncertainty =       0.002516302018

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.563300236339
                                         uncertainty =       0.002516302018

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000530761745
  error estimate for blocks of size 2^( 2) =       0.000564327188
  error estimate for blocks of size 2^( 3) =       0.000598401072
  error estimate for blocks of size 2^( 4) =       0.000625846102
  error estimate for blocks of size 2^( 5) =       0.000642532108
  error estimate for blocks of size 2^( 6) =       0.000652408242
  error estimate for blocks of size 2^( 7) =       0.000657402333

      target function =                  N/A
              le_mean =     -22.403203645888
             les_mean =     502.466949376574
             stat err =       0.000644547196
             autocorr =       1.474722211575
              std dev =       0.750610457659
             le_variance =       0.563416059147


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.403211733041        initial
     3.9062e-01     3.9062e+00             2.9111e-02       -22.403284187702  <--
     1.5625e+00     1.5625e+01             7.4311e-03       -22.403199921788
     6.2500e+00     6.2500e+01             1.8754e-03       -22.403203645888

*****************************************************************************
Applying the update for shift_i =   3.9062e-01     and shift_s =   3.9062e+00
*****************************************************************************

  Execution time = 7.1832e+01
  </log>
  <optVariables href="FORMP2PJWARM.s006.opt.xml">
 uu_0                 2.085869e-01 1 1  ON 0
 uu_1                 5.274506e-02 1 1  ON 1
 uu_2                -3.712615e-02 1 1  ON 2
 uu_3                -7.121930e-02 1 1  ON 3
 uu_4                -7.293356e-02 1 1  ON 4
 uu_5                -6.011270e-02 1 1  ON 5
 uu_6                -3.835658e-02 1 1  ON 6
 uu_7                -1.272957e-02 1 1  ON 7
 uu_8                 5.115137e-03 1 1  ON 8
 uu_9                 1.227807e-02 1 1  ON 9
 ud_0                 3.412360e-01 1 1  ON 10
 ud_1                 7.065685e-02 1 1  ON 11
 ud_2                -5.036585e-02 1 1  ON 12
 ud_3                -9.389715e-02 1 1  ON 13
 ud_4                -9.732039e-02 1 1  ON 14
 ud_5                -8.480427e-02 1 1  ON 15
 ud_6                -6.210062e-02 1 1  ON 16
 ud_7                -3.405160e-02 1 1  ON 17
 ud_8                -8.904892e-03 1 1  ON 18
 ud_9                 6.688509e-03 1 1  ON 19
 eC_0                -2.372360e-01 1 1  ON 20
 eC_1                -1.400459e-01 1 1  ON 21
 eC_2                 7.224658e-02 1 1  ON 22
 eC_3                 1.491936e-01 1 1  ON 23
 eC_4                 1.159419e-01 1 1  ON 24
 eC_5                 5.757886e-02 1 1  ON 25
 eC_6                -1.139789e-02 1 1  ON 26
 eC_7                -5.380035e-03 1 1  ON 27
 eC_8                -7.848541e-04 1 1  ON 28
 eC_9                -1.193324e-04 1 1  ON 29
 eO_0                -5.285297e-01 1 1  ON 30
 eO_1                -2.214240e-01 1 1  ON 31
 eO_2                 1.302628e-01 1 1  ON 32
 eO_3                 2.429660e-01 1 1  ON 33
 eO_4                 2.271695e-01 1 1  ON 34
 eO_5                 1.525619e-01 1 1  ON 35
 eO_6                 2.369410e-02 1 1  ON 36
 eO_7                -1.820909e-02 1 1  ON 37
 eO_8                -9.032850e-03 1 1  ON 38
 eO_9                -2.448843e-04 1 1  ON 39
eH1_0                -6.567339e-02 1 1  ON 40
eH1_1                 1.767303e-02 1 1  ON 41
eH1_2                 2.141136e-02 1 1  ON 42
eH1_3                -4.769591e-03 1 1  ON 43
eH1_4                -3.930105e-03 1 1  ON 44
eH1_5                -6.058226e-03 1 1  ON 45
eH1_6                 2.339595e-02 1 1  ON 46
eH1_7                 2.139173e-02 1 1  ON 47
eH1_8                -2.944013e-03 1 1  ON 48
eH1_9                -4.135653e-04 1 1  ON 49
eH2_0                -6.528149e-02 1 1  ON 50
eH2_1                 1.821745e-02 1 1  ON 51
eH2_2                 2.124233e-02 1 1  ON 52
eH2_3                -5.047067e-03 1 1  ON 53
eH2_4                -4.060203e-03 1 1  ON 54
eH2_5                -6.635570e-03 1 1  ON 55
eH2_6                 2.336472e-02 1 1  ON 56
eH2_7                 2.154503e-02 1 1  ON 57
eH2_8                -2.385399e-03 1 1  ON 58
eH2_9                -9.009826e-04 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.3724e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORMP2PJWARM.s007 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORMP2PJWARM.s007 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=7  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2314e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 30888 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 7
    time step          = 0.05
    reference energy   = -22.4941
    reference variance = 0.587959
====================================================
  Execution time = 4.8766e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORMP2PJWARM.s007
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2406e+01
  VMC Evar = 5.7724e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.5826e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.577063729940
                                         uncertainty =       0.011279790257

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.577063729940
                                         uncertainty =       0.011279790257

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000537234803
  error estimate for blocks of size 2^( 2) =       0.000568138247
  error estimate for blocks of size 2^( 3) =       0.000600288803
  error estimate for blocks of size 2^( 4) =       0.000625535134
  error estimate for blocks of size 2^( 5) =       0.000639476183
  error estimate for blocks of size 2^( 6) =       0.000648932746
  error estimate for blocks of size 2^( 7) =       0.000654859930

      target function =                  N/A
              le_mean =     -22.406405908555
             les_mean =     502.624267917778
             stat err =       0.000642200998
             autocorr =       1.428938948248
              std dev =       0.759764744807
             le_variance =       0.577242467451


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.240640590856e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.7656e-02, overlap shift 9.7656e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.406405908555       residual = 1.77e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.406539135296       residual = 1.35e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.407303625776       residual = 4.72e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.408596050190       residual = 3.63e-03           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.409425999387       residual = 2.63e-03           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.409889854534       residual = 9.95e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.410097847729       residual = 3.91e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.410257669694       residual = 1.66e-04           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.410307679523       residual = 1.34e-04           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.410366565314       residual = 1.31e-04           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -22.410403602860       residual = 9.15e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -22.410426833418       residual = 2.77e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -22.410454061233       residual = 2.40e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -22.410480699940       residual = 3.81e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -22.410482636721       residual = 3.72e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -22.410483525629       residual = 1.74e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -22.410485678529       residual = 1.25e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   energy =     -22.410485370915       residual = 7.02e-07           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   energy =     -22.410487393729       residual = 1.32e-07           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   energy =     -22.410488114059       residual = 2.79e-08           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   energy =     -22.410487350853       residual = 1.43e-08           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   energy =     -22.410487600604       residual = 5.58e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         21 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 9.7656e-02 is 1.039548e-01

solving harmonic davidson linear method for identity shift 3.9062e-01, overlap shift 3.9062e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.406405908555       residual = 1.77e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.406462957539       residual = 1.29e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.406858488406       residual = 3.93e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.407292600888       residual = 2.34e-03           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.407509066118       residual = 1.22e-03           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.407627568066       residual = 2.94e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.407673854446       residual = 8.67e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.407692517975       residual = 2.88e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.407700084890       residual = 2.29e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.407702602191       residual = 1.30e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -22.407702795561       residual = 4.89e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -22.407704733349       residual = 2.95e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -22.407706575918       residual = 1.08e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -22.407707282337       residual = 2.65e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -22.407707773379       residual = 9.64e-08           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -22.407708069677       residual = 3.60e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -22.407707909752       residual = 2.53e-08           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   energy =     -22.407707801648       residual = 6.07e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         17 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 3.9062e-01 is 2.548402e-02

solving harmonic davidson linear method for identity shift 1.5625e+00, overlap shift 1.5625e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.406405908555       residual = 1.77e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.406423263379       residual = 1.26e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.406555545545       residual = 3.37e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.406663645263       residual = 1.77e-03           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.406720382530       residual = 7.81e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.406746063493       residual = 1.27e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.406754956064       residual = 3.72e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.406757282514       residual = 1.19e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.406758409635       residual = 3.83e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.406758338309       residual = 2.95e-06           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -22.406758159472       residual = 6.65e-07           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -22.406758530822       residual = 1.87e-07           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -22.406758599297       residual = 9.13e-08           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -22.406758662184       residual = 2.90e-08           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -22.406758700338       residual = 8.63e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         14 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.5625e+00 is 6.502787e-03

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.108927 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 6.4609e+01
  </log>
  <optVariables href="FORMP2PJWARM.s007.opt.xml">
 uu_0                 2.137395e-01 1 1  ON 0
 uu_1                 5.586177e-02 1 1  ON 1
 uu_2                -3.631482e-02 1 1  ON 2
 uu_3                -7.285812e-02 1 1  ON 3
 uu_4                -7.665296e-02 1 1  ON 4
 uu_5                -6.486850e-02 1 1  ON 5
 uu_6                -4.279057e-02 1 1  ON 6
 uu_7                -1.506885e-02 1 1  ON 7
 uu_8                 6.485707e-03 1 1  ON 8
 uu_9                 1.529453e-02 1 1  ON 9
 ud_0                 3.466439e-01 1 1  ON 10
 ud_1                 7.528075e-02 1 1  ON 11
 ud_2                -4.790878e-02 1 1  ON 12
 ud_3                -9.437999e-02 1 1  ON 13
 ud_4                -1.007341e-01 1 1  ON 14
 ud_5                -8.996447e-02 1 1  ON 15
 ud_6                -6.730425e-02 1 1  ON 16
 ud_7                -3.751845e-02 1 1  ON 17
 ud_8                -9.391859e-03 1 1  ON 18
 ud_9                 9.034895e-03 1 1  ON 19
 eC_0                -2.561112e-01 1 1  ON 20
 eC_1                -1.501935e-01 1 1  ON 21
 eC_2                 6.875647e-02 1 1  ON 22
 eC_3                 1.559582e-01 1 1  ON 23
 eC_4                 1.287841e-01 1 1  ON 24
 eC_5                 6.854584e-02 1 1  ON 25
 eC_6                -1.006330e-02 1 1  ON 26
 eC_7                -5.175166e-03 1 1  ON 27
 eC_8                -5.450174e-04 1 1  ON 28
 eC_9                 5.693657e-06 1 1  ON 29
 eO_0                -5.540138e-01 1 1  ON 30
 eO_1                -2.395101e-01 1 1  ON 31
 eO_2                 1.223468e-01 1 1  ON 32
 eO_3                 2.485515e-01 1 1  ON 33
 eO_4                 2.427213e-01 1 1  ON 34
 eO_5                 1.705124e-01 1 1  ON 35
 eO_6                 3.484465e-02 1 1  ON 36
 eO_7                -1.726580e-02 1 1  ON 37
 eO_8                -9.482575e-03 1 1  ON 38
 eO_9                 1.116717e-04 1 1  ON 39
eH1_0                -6.984312e-02 1 1  ON 40
eH1_1                 1.536905e-02 1 1  ON 41
eH1_2                 2.040945e-02 1 1  ON 42
eH1_3                -5.040240e-03 1 1  ON 43
eH1_4                -2.053077e-03 1 1  ON 44
eH1_5                -5.762789e-03 1 1  ON 45
eH1_6                 2.389778e-02 1 1  ON 46
eH1_7                 2.529876e-02 1 1  ON 47
eH1_8                -2.136228e-03 1 1  ON 48
eH1_9                -2.109378e-04 1 1  ON 49
eH2_0                -6.975365e-02 1 1  ON 50
eH2_1                 1.587210e-02 1 1  ON 51
eH2_2                 2.009905e-02 1 1  ON 52
eH2_3                -5.106267e-03 1 1  ON 53
eH2_4                -2.226974e-03 1 1  ON 54
eH2_5                -5.916789e-03 1 1  ON 55
eH2_6                 2.412171e-02 1 1  ON 56
eH2_7                 2.515135e-02 1 1  ON 57
eH2_8                -1.668643e-03 1 1  ON 58
eH2_9                -6.244549e-04 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 7
    time step          = 0.05
    reference energy   = -22.3559
    reference variance = 0.708046
====================================================
  Execution time = 4.9758e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORMP2PJWARM.s007
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2409e+01
  VMC Evar = 5.6498e-01
  Total weights = 2.0000e+06
  Execution time = 4.6348e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.565981789062
                                         uncertainty =       0.004806503964

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.565981789062
                                         uncertainty =       0.004806503964

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000532048440
  error estimate for blocks of size 2^( 2) =       0.000563116999
  error estimate for blocks of size 2^( 3) =       0.000594491606
  error estimate for blocks of size 2^( 4) =       0.000618444151
  error estimate for blocks of size 2^( 5) =       0.000634389614
  error estimate for blocks of size 2^( 6) =       0.000643208875
  error estimate for blocks of size 2^( 7) =       0.000645648000

      target function =                  N/A
              le_mean =     -22.409126543679
             les_mean =     502.735103251561
             stat err =       0.000635422660
             autocorr =       1.426339958695
              std dev =       0.752430119027
             le_variance =       0.566151084019

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.566087729636
                                         uncertainty =       0.004892723713

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.566087729636
                                         uncertainty =       0.004892723713

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000532099568
  error estimate for blocks of size 2^( 2) =       0.000559248313
  error estimate for blocks of size 2^( 3) =       0.000586323204
  error estimate for blocks of size 2^( 4) =       0.000606832117
  error estimate for blocks of size 2^( 5) =       0.000621117388
  error estimate for blocks of size 2^( 6) =       0.000628694164
  error estimate for blocks of size 2^( 7) =       0.000630722044

      target function =                  N/A
              le_mean =     -22.410065082517
             les_mean =     502.777276619765
             stat err =       0.000621841428
             autocorr =       1.365757179220
              std dev =       0.752502425395
             le_variance =       0.566259900226

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.564723270605
                                         uncertainty =       0.004842794091

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.564723270605
                                         uncertainty =       0.004842794091

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000531457426
  error estimate for blocks of size 2^( 2) =       0.000560440362
  error estimate for blocks of size 2^( 3) =       0.000589580474
  error estimate for blocks of size 2^( 4) =       0.000611800812
  error estimate for blocks of size 2^( 5) =       0.000626915222
  error estimate for blocks of size 2^( 6) =       0.000635132445
  error estimate for blocks of size 2^( 7) =       0.000637381278

      target function =                  N/A
              le_mean =     -22.409122169843
             les_mean =     502.733650131807
             stat err =       0.000627807439
             autocorr =       1.395455384079
              std dev =       0.751594299662
             le_variance =       0.564893991285

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.565537690286
                                         uncertainty =       0.004809236247

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.565537690286
                                         uncertainty =       0.004809236247

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000531839804
  error estimate for blocks of size 2^( 2) =       0.000562625770
  error estimate for blocks of size 2^( 3) =       0.000593704203
  error estimate for blocks of size 2^( 4) =       0.000617431713
  error estimate for blocks of size 2^( 5) =       0.000633268901
  error estimate for blocks of size 2^( 6) =       0.000642010926
  error estimate for blocks of size 2^( 7) =       0.000644426378

      target function =                  N/A
              le_mean =     -22.409060822100
             les_mean =     502.731713799521
             stat err =       0.000634284480
             autocorr =       1.422350056658
              std dev =       0.752135063533
             le_variance =       0.565707153796


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.409126543679        initial
     9.7656e-02     9.7656e-01             1.0395e-01       -22.410065082517  <--
     3.9062e-01     3.9062e+00             2.5484e-02       -22.409122169843
     1.5625e+00     1.5625e+01             6.5028e-03       -22.409060822100

*****************************************************************************
Applying the update for shift_i =   9.7656e-02     and shift_s =   9.7656e-01
*****************************************************************************

  Execution time = 7.2930e+01
  </log>
  <optVariables href="FORMP2PJWARM.s007.opt.xml">
 uu_0                 2.289226e-01 1 1  ON 0
 uu_1                 6.572064e-02 1 1  ON 1
 uu_2                -3.227910e-02 1 1  ON 2
 uu_3                -7.609134e-02 1 1  ON 3
 uu_4                -8.651034e-02 1 1  ON 4
 uu_5                -7.905917e-02 1 1  ON 5
 uu_6                -5.807415e-02 1 1  ON 6
 uu_7                -2.623010e-02 1 1  ON 7
 uu_8                 6.600613e-03 1 1  ON 8
 uu_9                 2.533387e-02 1 1  ON 9
 ud_0                 3.632162e-01 1 1  ON 10
 ud_1                 8.907273e-02 1 1  ON 11
 ud_2                -4.000023e-02 1 1  ON 12
 ud_3                -9.458156e-02 1 1  ON 13
 ud_4                -1.091508e-01 1 1  ON 14
 ud_5                -1.043256e-01 1 1  ON 15
 ud_6                -8.415758e-02 1 1  ON 16
 ud_7                -5.146587e-02 1 1  ON 17
 ud_8                -1.488401e-02 1 1  ON 18
 ud_9                 1.597553e-02 1 1  ON 19
 eC_0                -3.117267e-01 1 1  ON 20
 eC_1                -1.846365e-01 1 1  ON 21
 eC_2                 5.238311e-02 1 1  ON 22
 eC_3                 1.690720e-01 1 1  ON 23
 eC_4                 1.673743e-01 1 1  ON 24
 eC_5                 1.101283e-01 1 1  ON 25
 eC_6                -1.940258e-04 1 1  ON 26
 eC_7                -3.450747e-03 1 1  ON 27
 eC_8                 3.678434e-04 1 1  ON 28
 eC_9                 5.011528e-04 1 1  ON 29
 eO_0                -6.324845e-01 1 1  ON 30
 eO_1                -2.988988e-01 1 1  ON 31
 eO_2                 9.181342e-02 1 1  ON 32
 eO_3                 2.575892e-01 1 1  ON 33
 eO_4                 2.860689e-01 1 1  ON 34
 eO_5                 2.286823e-01 1 1  ON 35
 eO_6                 8.098220e-02 1 1  ON 36
 eO_7                -7.612259e-03 1 1  ON 37
 eO_8                -1.041800e-02 1 1  ON 38
 eO_9                 1.471303e-03 1 1  ON 39
eH1_0                -8.315441e-02 1 1  ON 40
eH1_1                 6.462088e-03 1 1  ON 41
eH1_2                 1.622727e-02 1 1  ON 42
eH1_3                -5.312388e-03 1 1  ON 43
eH1_4                 3.464116e-03 1 1  ON 44
eH1_5                -3.424784e-03 1 1  ON 45
eH1_6                 2.400752e-02 1 1  ON 46
eH1_7                 3.733409e-02 1 1  ON 47
eH1_8                 2.760339e-03 1 1  ON 48
eH1_9                 9.275858e-04 1 1  ON 49
eH2_0                -8.379062e-02 1 1  ON 50
eH2_1                 6.813133e-03 1 1  ON 51
eH2_2                 1.570321e-02 1 1  ON 52
eH2_3                -5.042152e-03 1 1  ON 53
eH2_4                 3.470326e-03 1 1  ON 54
eH2_5                -2.834745e-03 1 1  ON 55
eH2_6                 2.494201e-02 1 1  ON 56
eH2_7                 3.655257e-02 1 1  ON 57
eH2_8                 2.897321e-03 1 1  ON 58
eH2_9                 8.010836e-04 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.3755e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORMP2PJWARM.s008 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORMP2PJWARM.s008 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=8  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2328e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 30888 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 8
    time step          = 0.05
    reference energy   = -22.4063
    reference variance = 0.354173
====================================================
  Execution time = 4.9330e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORMP2PJWARM.s008
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2414e+01
  VMC Evar = 5.6823e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.5756e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.568277766679
                                         uncertainty =       0.005325043098

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.568277766679
                                         uncertainty =       0.005325043098

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000533023729
  error estimate for blocks of size 2^( 2) =       0.000559810234
  error estimate for blocks of size 2^( 3) =       0.000587359451
  error estimate for blocks of size 2^( 4) =       0.000608261027
  error estimate for blocks of size 2^( 5) =       0.000621269946
  error estimate for blocks of size 2^( 6) =       0.000629871112
  error estimate for blocks of size 2^( 7) =       0.000636022724

      target function =                  N/A
              le_mean =     -22.414147361044
             les_mean =     502.962230230859
             stat err =       0.000623856202
             autocorr =       1.369859124971
              std dev =       0.753809387290
             le_variance =       0.568228592367


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.241414736104e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.4414e-02, overlap shift 2.4414e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.414147361044       residual = 3.51e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.414232590328       residual = 1.14e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.414579117580       residual = 1.68e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.415309506338       residual = 3.15e-03           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.416409038551       residual = 2.16e-03           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.416935716323       residual = 1.20e-03           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.417180612459       residual = 8.06e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.417548936998       residual = 3.45e-04           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.417649732463       residual = 1.73e-04           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.417728754087       residual = 9.25e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -22.417901036179       residual = 1.78e-04           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -22.417965143957       residual = 1.46e-04           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -22.418008297002       residual = 5.20e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -22.418075947831       residual = 4.87e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -22.418110679490       residual = 3.89e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -22.418160303092       residual = 1.02e-05           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -22.418176253445       residual = 1.83e-05           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   energy =     -22.418201414102       residual = 9.51e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   energy =     -22.418216920450       residual = 4.06e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   energy =     -22.418222292401       residual = 1.26e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   energy =     -22.418222713911       residual = 5.23e-07           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   energy =     -22.418225069339       residual = 4.65e-07           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   energy =     -22.418225855662       residual = 2.41e-07           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   energy =     -22.418228086006       residual = 1.88e-07           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   energy =     -22.418226134002       residual = 8.01e-08           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   energy =     -22.418226663219       residual = 9.85e-08           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   energy =     -22.418227585960       residual = 5.69e-08           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   energy =     -22.418227893782       residual = 2.43e-08           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   energy =     -22.418228144772       residual = 1.57e-08           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   energy =     -22.418228271202       residual = 2.70e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         29 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 2.4414e-02 is 4.814264e-01

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 9.7656e-02, overlap shift 9.7656e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.414147361044       residual = 3.51e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.414200962028       residual = 1.05e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.414438308427       residual = 1.45e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.414857266964       residual = 2.05e-03           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.415312358559       residual = 1.03e-03           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.415478407889       residual = 4.35e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.415553448326       residual = 1.58e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.415618761907       residual = 7.62e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.415639073189       residual = 3.22e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.415657981841       residual = 1.89e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -22.415683615933       residual = 2.22e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -22.415687640071       residual = 1.21e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -22.415688740979       residual = 4.23e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -22.415698006760       residual = 3.00e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -22.415697875742       residual = 2.08e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -22.415699317063       residual = 5.43e-07           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -22.415697956291       residual = 4.52e-07           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   energy =     -22.415698354590       residual = 1.89e-07           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   energy =     -22.415698998865       residual = 5.27e-08           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   energy =     -22.415699394808       residual = 8.83e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         19 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 9.7656e-02 is 5.998361e-02

solving harmonic davidson linear method for identity shift 3.9062e-01, overlap shift 3.9062e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.414147361044       residual = 3.51e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.414168935785       residual = 9.67e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.414274733502       residual = 1.24e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.414420783837       residual = 1.16e-03           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.414533671424       residual = 5.09e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.414575467716       residual = 9.99e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.414590805253       residual = 2.38e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.414596517463       residual = 1.42e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.414600419670       residual = 5.30e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.414603574495       residual = 2.45e-06           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -22.414604695972       residual = 1.16e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -22.414604631897       residual = 5.10e-07           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -22.414604714673       residual = 2.32e-07           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -22.414605173936       residual = 9.65e-08           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -22.414605267041       residual = 2.65e-08           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -22.414605003049       residual = 1.06e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -22.414604985769       residual = 3.57e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         16 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 3.9062e-01 is 1.467447e-02

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.128965 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 6.5110e+01
  </log>
  <optVariables href="FORMP2PJWARM.s008.opt.xml">
 uu_0                 2.392788e-01 1 1  ON 0
 uu_1                 7.361229e-02 1 1  ON 1
 uu_2                -2.792987e-02 1 1  ON 2
 uu_3                -7.697713e-02 1 1  ON 3
 uu_4                -9.280826e-02 1 1  ON 4
 uu_5                -8.908486e-02 1 1  ON 5
 uu_6                -7.074109e-02 1 1  ON 6
 uu_7                -3.807495e-02 1 1  ON 7
 uu_8                 2.098124e-03 1 1  ON 8
 uu_9                 3.267964e-02 1 1  ON 9
 ud_0                 3.756649e-01 1 1  ON 10
 ud_1                 9.963826e-02 1 1  ON 11
 ud_2                -3.299261e-02 1 1  ON 12
 ud_3                -9.283096e-02 1 1  ON 13
 ud_4                -1.130736e-01 1 1  ON 14
 ud_5                -1.129006e-01 1 1  ON 15
 ud_6                -9.689846e-02 1 1  ON 16
 ud_7                -6.591218e-02 1 1  ON 17
 ud_8                -2.476970e-02 1 1  ON 18
 ud_9                 1.863157e-02 1 1  ON 19
 eC_0                -3.512065e-01 1 1  ON 20
 eC_1                -2.140356e-01 1 1  ON 21
 eC_2                 3.457425e-02 1 1  ON 22
 eC_3                 1.707491e-01 1 1  ON 23
 eC_4                 1.930991e-01 1 1  ON 24
 eC_5                 1.498284e-01 1 1  ON 25
 eC_6                 1.583913e-02 1 1  ON 26
 eC_7                -1.326140e-03 1 1  ON 27
 eC_8                 1.111891e-03 1 1  ON 28
 eC_9                 9.810990e-04 1 1  ON 29
 eO_0                -6.924681e-01 1 1  ON 30
 eO_1                -3.478455e-01 1 1  ON 31
 eO_2                 6.194257e-02 1 1  ON 32
 eO_3                 2.550897e-01 1 1  ON 33
 eO_4                 3.123810e-01 1 1  ON 34
 eO_5                 2.745415e-01 1 1  ON 35
 eO_6                 1.280249e-01 1 1  ON 36
 eO_7                 1.078473e-02 1 1  ON 37
 eO_8                -9.753649e-03 1 1  ON 38
 eO_9                 2.815179e-03 1 1  ON 39
eH1_0                -9.338474e-02 1 1  ON 40
eH1_1                -7.134061e-04 1 1  ON 41
eH1_2                 1.190317e-02 1 1  ON 42
eH1_3                -6.473847e-03 1 1  ON 43
eH1_4                 7.360134e-03 1 1  ON 44
eH1_5                -8.363852e-05 1 1  ON 45
eH1_6                 2.367041e-02 1 1  ON 46
eH1_7                 4.532426e-02 1 1  ON 47
eH1_8                 9.062973e-03 1 1  ON 48
eH1_9                 2.081341e-03 1 1  ON 49
eH2_0                -9.395361e-02 1 1  ON 50
eH2_1                -5.437582e-04 1 1  ON 51
eH2_2                 1.214441e-02 1 1  ON 52
eH2_3                -5.830166e-03 1 1  ON 53
eH2_4                 7.395671e-03 1 1  ON 54
eH2_5                 2.761850e-04 1 1  ON 55
eH2_6                 2.303297e-02 1 1  ON 56
eH2_7                 4.356270e-02 1 1  ON 57
eH2_8                 1.036291e-02 1 1  ON 58
eH2_9                 2.533709e-03 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 8
    time step          = 0.05
    reference energy   = -22.4581
    reference variance = 0.493205
====================================================
  Execution time = 4.8858e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORMP2PJWARM.s008
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2419e+01
  VMC Evar = 5.5657e-01
  Total weights = 2.0000e+06
  Execution time = 4.6429e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.553276096256
                                         uncertainty =       0.004443171631

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.553276096256
                                         uncertainty =       0.004443171631

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000525983185
  error estimate for blocks of size 2^( 2) =       0.000552798640
  error estimate for blocks of size 2^( 3) =       0.000579401481
  error estimate for blocks of size 2^( 4) =       0.000600750865
  error estimate for blocks of size 2^( 5) =       0.000614269731
  error estimate for blocks of size 2^( 6) =       0.000621982671
  error estimate for blocks of size 2^( 7) =       0.000627024952

      target function =                  N/A
              le_mean =     -22.419513629031
             les_mean =     503.187907706530
             stat err =       0.000616007055
             autocorr =       1.371600552249
              std dev =       0.743852553187
             le_variance =       0.553316620882

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.635824866115
                                         uncertainty =       0.004563114285

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.635824866115
                                         uncertainty =       0.004563114285

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000563869097
  error estimate for blocks of size 2^( 2) =       0.000586040839
  error estimate for blocks of size 2^( 3) =       0.000606137943
  error estimate for blocks of size 2^( 4) =       0.000621246740
  error estimate for blocks of size 2^( 5) =       0.000631033745
  error estimate for blocks of size 2^( 6) =       0.000637387640
  error estimate for blocks of size 2^( 7) =       0.000641532086

      target function =                  N/A
              le_mean =     -22.436875198518
             les_mean =     504.049265072713
             stat err =       0.000632800053
             autocorr =       1.259436938147
              std dev =       0.797431324177
             le_variance =       0.635896716779

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.562966896286
                                         uncertainty =       0.004457710286

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.562966896286
                                         uncertainty =       0.004457710286

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000530571361
  error estimate for blocks of size 2^( 2) =       0.000554497712
  error estimate for blocks of size 2^( 3) =       0.000577774675
  error estimate for blocks of size 2^( 4) =       0.000596355537
  error estimate for blocks of size 2^( 5) =       0.000608332717
  error estimate for blocks of size 2^( 6) =       0.000615501443
  error estimate for blocks of size 2^( 7) =       0.000620269211

      target function =                  N/A
              le_mean =     -22.419410293657
             les_mean =     503.192969571214
             stat err =       0.000610114727
             autocorr =       1.322316474538
              std dev =       0.750341213966
             le_variance =       0.563011937376

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.554037445435
                                         uncertainty =       0.004446392999

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.554037445435
                                         uncertainty =       0.004446392999

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000526344999
  error estimate for blocks of size 2^( 2) =       0.000552730130
  error estimate for blocks of size 2^( 3) =       0.000578854166
  error estimate for blocks of size 2^( 4) =       0.000599817397
  error estimate for blocks of size 2^( 5) =       0.000613127617
  error estimate for blocks of size 2^( 6) =       0.000620767223
  error estimate for blocks of size 2^( 7) =       0.000625775077

      target function =                  N/A
              le_mean =     -22.419280592739
             les_mean =     503.178220135676
             stat err =       0.000614871829
             autocorr =       1.364671709920
              std dev =       0.744364236617
             le_variance =       0.554078116755


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.419513629031        initial  <--
            N/A            N/A                    N/A                    N/A     bad update
     9.7656e-02     9.7656e-01             5.9984e-02       -22.419410293657
     3.9062e-01     3.9062e+00             1.4674e-02       -22.419280592739

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 72.0653
  </log>
  <optVariables href="FORMP2PJWARM.s008.opt.xml">
 uu_0                 2.289226e-01 1 1  ON 0
 uu_1                 6.572064e-02 1 1  ON 1
 uu_2                -3.227910e-02 1 1  ON 2
 uu_3                -7.609134e-02 1 1  ON 3
 uu_4                -8.651034e-02 1 1  ON 4
 uu_5                -7.905917e-02 1 1  ON 5
 uu_6                -5.807415e-02 1 1  ON 6
 uu_7                -2.623010e-02 1 1  ON 7
 uu_8                 6.600613e-03 1 1  ON 8
 uu_9                 2.533387e-02 1 1  ON 9
 ud_0                 3.632162e-01 1 1  ON 10
 ud_1                 8.907273e-02 1 1  ON 11
 ud_2                -4.000023e-02 1 1  ON 12
 ud_3                -9.458156e-02 1 1  ON 13
 ud_4                -1.091508e-01 1 1  ON 14
 ud_5                -1.043256e-01 1 1  ON 15
 ud_6                -8.415758e-02 1 1  ON 16
 ud_7                -5.146587e-02 1 1  ON 17
 ud_8                -1.488401e-02 1 1  ON 18
 ud_9                 1.597553e-02 1 1  ON 19
 eC_0                -3.117267e-01 1 1  ON 20
 eC_1                -1.846365e-01 1 1  ON 21
 eC_2                 5.238311e-02 1 1  ON 22
 eC_3                 1.690720e-01 1 1  ON 23
 eC_4                 1.673743e-01 1 1  ON 24
 eC_5                 1.101283e-01 1 1  ON 25
 eC_6                -1.940258e-04 1 1  ON 26
 eC_7                -3.450747e-03 1 1  ON 27
 eC_8                 3.678434e-04 1 1  ON 28
 eC_9                 5.011528e-04 1 1  ON 29
 eO_0                -6.324845e-01 1 1  ON 30
 eO_1                -2.988988e-01 1 1  ON 31
 eO_2                 9.181342e-02 1 1  ON 32
 eO_3                 2.575892e-01 1 1  ON 33
 eO_4                 2.860689e-01 1 1  ON 34
 eO_5                 2.286823e-01 1 1  ON 35
 eO_6                 8.098220e-02 1 1  ON 36
 eO_7                -7.612259e-03 1 1  ON 37
 eO_8                -1.041800e-02 1 1  ON 38
 eO_9                 1.471303e-03 1 1  ON 39
eH1_0                -8.315441e-02 1 1  ON 40
eH1_1                 6.462088e-03 1 1  ON 41
eH1_2                 1.622727e-02 1 1  ON 42
eH1_3                -5.312388e-03 1 1  ON 43
eH1_4                 3.464116e-03 1 1  ON 44
eH1_5                -3.424784e-03 1 1  ON 45
eH1_6                 2.400752e-02 1 1  ON 46
eH1_7                 3.733409e-02 1 1  ON 47
eH1_8                 2.760339e-03 1 1  ON 48
eH1_9                 9.275858e-04 1 1  ON 49
eH2_0                -8.379062e-02 1 1  ON 50
eH2_1                 6.813133e-03 1 1  ON 51
eH2_2                 1.570321e-02 1 1  ON 52
eH2_3                -5.042152e-03 1 1  ON 53
eH2_4                 3.470326e-03 1 1  ON 54
eH2_5                -2.834745e-03 1 1  ON 55
eH2_6                 2.494201e-02 1 1  ON 56
eH2_7                 3.655257e-02 1 1  ON 57
eH2_8                 2.897321e-03 1 1  ON 58
eH2_9                 8.010836e-04 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.3718e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORMP2PJWARM.s009 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORMP2PJWARM.s009 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=9  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2340e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 30888 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 9
    time step          = 0.05
    reference energy   = -22.3757
    reference variance = 0.547221
====================================================
  Execution time = 4.9298e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORMP2PJWARM.s009
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2414e+01
  VMC Evar = 5.6218e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.6025e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.562104921072
                                         uncertainty =       0.006359418561

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.562104921072
                                         uncertainty =       0.006359418561

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000530178977
  error estimate for blocks of size 2^( 2) =       0.000556740593
  error estimate for blocks of size 2^( 3) =       0.000583926744
  error estimate for blocks of size 2^( 4) =       0.000605365271
  error estimate for blocks of size 2^( 5) =       0.000618220904
  error estimate for blocks of size 2^( 6) =       0.000625816807
  error estimate for blocks of size 2^( 7) =       0.000633187743

      target function =                  N/A
              le_mean =     -22.413924181896
             les_mean =     502.946176446007
             stat err =       0.000620647681
             autocorr =       1.370393433024
              std dev =       0.749786299768
             le_variance =       0.562179495319


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.241392418190e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.4414e-01, overlap shift 2.4414e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.413924181896       residual = 3.28e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.413970872543       residual = 1.12e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.414112104919       residual = 1.72e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.414397677835       residual = 1.25e-03           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.414546203059       residual = 6.54e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.414619604459       residual = 1.37e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.414652492526       residual = 3.90e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.414659119418       residual = 1.78e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.414667204062       residual = 1.16e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.414669409998       residual = 4.84e-06           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -22.414671414820       residual = 1.87e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -22.414673144191       residual = 1.03e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -22.414673282610       residual = 1.14e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -22.414673235027       residual = 2.90e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -22.414673153071       residual = 9.00e-08           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -22.414673144131       residual = 3.59e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -22.414673215900       residual = 1.31e-08           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   energy =     -22.414673228504       residual = 6.90e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         17 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 2.4414e-01 is 2.347492e-02

solving harmonic davidson linear method for identity shift 9.7656e-01, overlap shift 9.7656e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.413924181896       residual = 3.28e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.413939169332       residual = 1.09e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.413984410730       residual = 1.47e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.414072562204       residual = 8.16e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.414102280712       residual = 3.31e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.414119119539       residual = 4.06e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.414125431622       residual = 8.21e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.414125252717       residual = 5.25e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.414126716942       residual = 2.02e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.414126724076       residual = 7.72e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -22.414126569607       residual = 2.03e-07           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -22.414126646991       residual = 1.40e-07           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -22.414126747670       residual = 4.71e-08           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -22.414126710635       residual = 1.51e-08           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -22.414126676140       residual = 3.04e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         14 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 9.7656e-01 is 5.859064e-03

solving harmonic davidson linear method for identity shift 3.9062e+00, overlap shift 3.9062e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.413924181896       residual = 3.28e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.413928215078       residual = 1.08e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.413940413981       residual = 1.38e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.413963732657       residual = 7.00e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.413970558914       residual = 2.42e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.413974477796       residual = 2.34e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.413975815583       residual = 4.15e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.413975745207       residual = 3.52e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.413975985048       residual = 6.25e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.413975967878       residual = 2.85e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -22.413975917104       residual = 8.41e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -22.413975906994       residual = 5.38e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -22.413975945052       residual = 8.79e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         12 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 3.9062e+00 is 1.466355e-03

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.137330 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 6.5336e+01
  </log>
  <optVariables href="FORMP2PJWARM.s009.opt.xml">
 uu_0                 2.300968e-01 1 1  ON 0
 uu_1                 6.656356e-02 1 1  ON 1
 uu_2                -3.180935e-02 1 1  ON 2
 uu_3                -7.630404e-02 1 1  ON 3
 uu_4                -8.726156e-02 1 1  ON 4
 uu_5                -8.015910e-02 1 1  ON 5
 uu_6                -5.931743e-02 1 1  ON 6
 uu_7                -2.729209e-02 1 1  ON 7
 uu_8                 6.278791e-03 1 1  ON 8
 uu_9                 2.611823e-02 1 1  ON 9
 ud_0                 3.644414e-01 1 1  ON 10
 ud_1                 9.009788e-02 1 1  ON 11
 ud_2                -3.940959e-02 1 1  ON 12
 ud_3                -9.450279e-02 1 1  ON 13
 ud_4                -1.096344e-01 1 1  ON 14
 ud_5                -1.051166e-01 1 1  ON 15
 ud_6                -8.546429e-02 1 1  ON 16
 ud_7                -5.273491e-02 1 1  ON 17
 ud_8                -1.556945e-02 1 1  ON 18
 ud_9                 1.634204e-02 1 1  ON 19
 eC_0                -3.157561e-01 1 1  ON 20
 eC_1                -1.875785e-01 1 1  ON 21
 eC_2                 5.093807e-02 1 1  ON 22
 eC_3                 1.696686e-01 1 1  ON 23
 eC_4                 1.702075e-01 1 1  ON 24
 eC_5                 1.137097e-01 1 1  ON 25
 eC_6                 8.191859e-04 1 1  ON 26
 eC_7                -3.233687e-03 1 1  ON 27
 eC_8                 4.728629e-04 1 1  ON 28
 eC_9                 5.505615e-04 1 1  ON 29
 eO_0                -6.383436e-01 1 1  ON 30
 eO_1                -3.036782e-01 1 1  ON 31
 eO_2                 8.915846e-02 1 1  ON 32
 eO_3                 2.579337e-01 1 1  ON 33
 eO_4                 2.889969e-01 1 1  ON 34
 eO_5                 2.332312e-01 1 1  ON 35
 eO_6                 8.515365e-02 1 1  ON 36
 eO_7                -6.468116e-03 1 1  ON 37
 eO_8                -1.050862e-02 1 1  ON 38
 eO_9                 1.574128e-03 1 1  ON 39
eH1_0                -8.414901e-02 1 1  ON 40
eH1_1                 5.652077e-03 1 1  ON 41
eH1_2                 1.581642e-02 1 1  ON 42
eH1_3                -5.307803e-03 1 1  ON 43
eH1_4                 3.803563e-03 1 1  ON 44
eH1_5                -3.151391e-03 1 1  ON 45
eH1_6                 2.388775e-02 1 1  ON 46
eH1_7                 3.828321e-02 1 1  ON 47
eH1_8                 3.321995e-03 1 1  ON 48
eH1_9                 1.084693e-03 1 1  ON 49
eH2_0                -8.478196e-02 1 1  ON 50
eH2_1                 5.997048e-03 1 1  ON 51
eH2_2                 1.547929e-02 1 1  ON 52
eH2_3                -5.217723e-03 1 1  ON 53
eH2_4                 3.927105e-03 1 1  ON 54
eH2_5                -2.650986e-03 1 1  ON 55
eH2_6                 2.488978e-02 1 1  ON 56
eH2_7                 3.746400e-02 1 1  ON 57
eH2_8                 3.335761e-03 1 1  ON 58
eH2_9                 9.893103e-04 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 9
    time step          = 0.05
    reference energy   = -22.3746
    reference variance = 0.680956
====================================================
  Execution time = 4.8077e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORMP2PJWARM.s009
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2413e+01
  VMC Evar = 5.5794e-01
  Total weights = 2.0000e+06
  Execution time = 4.6390e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.557423474102
                                         uncertainty =       0.004309373398

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.557423474102
                                         uncertainty =       0.004309373398

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000528008939
  error estimate for blocks of size 2^( 2) =       0.000553993306
  error estimate for blocks of size 2^( 3) =       0.000581030012
  error estimate for blocks of size 2^( 4) =       0.000604244419
  error estimate for blocks of size 2^( 5) =       0.000619859621
  error estimate for blocks of size 2^( 6) =       0.000630921379
  error estimate for blocks of size 2^( 7) =       0.000639277699

      target function =                  N/A
              le_mean =     -22.413369303001
             les_mean =     502.916710112232
             stat err =       0.000623575779
             autocorr =       1.394748577672
              std dev =       0.746717401901
             le_variance =       0.557586878302

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.558727785740
                                         uncertainty =       0.004353437765

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.558727785740
                                         uncertainty =       0.004353437765

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000528626344
  error estimate for blocks of size 2^( 2) =       0.000553891982
  error estimate for blocks of size 2^( 3) =       0.000580122210
  error estimate for blocks of size 2^( 4) =       0.000602734980
  error estimate for blocks of size 2^( 5) =       0.000617996986
  error estimate for blocks of size 2^( 6) =       0.000628905175
  error estimate for blocks of size 2^( 7) =       0.000637177435

      target function =                  N/A
              le_mean =     -22.413383232531
             les_mean =     502.918639271723
             stat err =       0.000621703644
             autocorr =       1.383149810262
              std dev =       0.747590544943
             le_variance =       0.558891622888

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.558174366523
                                         uncertainty =       0.004333088468

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.558174366523
                                         uncertainty =       0.004333088468

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000528364515
  error estimate for blocks of size 2^( 2) =       0.000553976102
  error estimate for blocks of size 2^( 3) =       0.000580597978
  error estimate for blocks of size 2^( 4) =       0.000603506112
  error estimate for blocks of size 2^( 5) =       0.000618942896
  error estimate for blocks of size 2^( 6) =       0.000629923804
  error estimate for blocks of size 2^( 7) =       0.000638235573

      target function =                  N/A
              le_mean =     -22.413353831968
             les_mean =     502.916767839699
             stat err =       0.000622652096
             autocorr =       1.388748564145
              std dev =       0.747220263304
             le_variance =       0.558338121892

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.557515875895
                                         uncertainty =       0.004312413678

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.557515875895
                                         uncertainty =       0.004312413678

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000528052709
  error estimate for blocks of size 2^( 2) =       0.000553989216
  error estimate for blocks of size 2^( 3) =       0.000580973030
  error estimate for blocks of size 2^( 4) =       0.000604148598
  error estimate for blocks of size 2^( 5) =       0.000619741302
  error estimate for blocks of size 2^( 6) =       0.000630792609
  error estimate for blocks of size 2^( 7) =       0.000639143296

      target function =                  N/A
              le_mean =     -22.413364634820
             les_mean =     502.916593300492
             stat err =       0.000623456451
             autocorr =       1.393983705307
              std dev =       0.746779302024
             le_variance =       0.557679325932


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.413369303001        initial
     2.4414e-01     2.4414e+00             2.3475e-02       -22.413383232531  <--
     9.7656e-01     9.7656e+00             5.8591e-03       -22.413353831968
     3.9062e+00     3.9062e+01             1.4664e-03       -22.413364634820

*****************************************************************************
Applying the update for shift_i =   2.4414e-01     and shift_s =   2.4414e+00
*****************************************************************************

  Execution time = 7.3731e+01
  </log>
  <optVariables href="FORMP2PJWARM.s009.opt.xml">
 uu_0                 2.334649e-01 1 1  ON 0
 uu_1                 6.902696e-02 1 1  ON 1
 uu_2                -3.047133e-02 1 1  ON 2
 uu_3                -7.668828e-02 1 1  ON 3
 uu_4                -8.926811e-02 1 1  ON 4
 uu_5                -8.333772e-02 1 1  ON 5
 uu_6                -6.312716e-02 1 1  ON 6
 uu_7                -3.069381e-02 1 1  ON 7
 uu_8                 4.880909e-03 1 1  ON 8
 uu_9                 2.839205e-02 1 1  ON 9
 ud_0                 3.680225e-01 1 1  ON 10
 ud_1                 9.311332e-02 1 1  ON 11
 ud_2                -3.751629e-02 1 1  ON 12
 ud_3                -9.414000e-02 1 1  ON 13
 ud_4                -1.108770e-01 1 1  ON 14
 ud_5                -1.076446e-01 1 1  ON 15
 ud_6                -8.922596e-02 1 1  ON 16
 ud_7                -5.664900e-02 1 1  ON 17
 ud_8                -1.801597e-02 1 1  ON 18
 ud_9                 1.725085e-02 1 1  ON 19
 eC_0                -3.276496e-01 1 1  ON 20
 eC_1                -1.963589e-01 1 1  ON 21
 eC_2                 4.603390e-02 1 1  ON 22
 eC_3                 1.707595e-01 1 1  ON 23
 eC_4                 1.782834e-01 1 1  ON 24
 eC_5                 1.249261e-01 1 1  ON 25
 eC_6                 4.618694e-03 1 1  ON 26
 eC_7                -2.407554e-03 1 1  ON 27
 eC_8                 8.116717e-04 1 1  ON 28
 eC_9                 7.120513e-04 1 1  ON 29
 eO_0                -6.559594e-01 1 1  ON 30
 eO_1                -3.180128e-01 1 1  ON 31
 eO_2                 8.068576e-02 1 1  ON 32
 eO_3                 2.580086e-01 1 1  ON 33
 eO_4                 2.972755e-01 1 1  ON 34
 eO_5                 2.468346e-01 1 1  ON 35
 eO_6                 9.860085e-02 1 1  ON 36
 eO_7                -2.084935e-03 1 1  ON 37
 eO_8                -1.067543e-02 1 1  ON 38
 eO_9                 1.900541e-03 1 1  ON 39
eH1_0                -8.717349e-02 1 1  ON 40
eH1_1                 3.238522e-03 1 1  ON 41
eH1_2                 1.447544e-02 1 1  ON 42
eH1_3                -5.368452e-03 1 1  ON 43
eH1_4                 4.840443e-03 1 1  ON 44
eH1_5                -2.307262e-03 1 1  ON 45
eH1_6                 2.349953e-02 1 1  ON 46
eH1_7                 4.091536e-02 1 1  ON 47
eH1_8                 5.314688e-03 1 1  ON 48
eH1_9                 1.642283e-03 1 1  ON 49
eH2_0                -8.777868e-02 1 1  ON 50
eH2_1                 3.579051e-03 1 1  ON 51
eH2_2                 1.444792e-02 1 1  ON 52
eH2_3                -5.544134e-03 1 1  ON 53
eH2_4                 5.122281e-03 1 1  ON 54
eH2_5                -1.911012e-03 1 1  ON 55
eH2_6                 2.463876e-02 1 1  ON 56
eH2_7                 4.002605e-02 1 1  ON 57
eH2_8                 4.938190e-03 1 1  ON 58
eH2_9                 1.647903e-03 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.3907e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORMP2PJWARM.s010 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORMP2PJWARM.s010 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=10  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2343e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 30888 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 10
    time step          = 0.05
    reference energy   = -22.4798
    reference variance = 0.483756
====================================================
  Execution time = 5.0048e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORMP2PJWARM.s010
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2416e+01
  VMC Evar = 5.8002e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.6064e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.580076773064
                                         uncertainty =       0.021551592627

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.580076773064
                                         uncertainty =       0.021551592627

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000538527323
  error estimate for blocks of size 2^( 2) =       0.000563930256
  error estimate for blocks of size 2^( 3) =       0.000589226196
  error estimate for blocks of size 2^( 4) =       0.000609501104
  error estimate for blocks of size 2^( 5) =       0.000623879721
  error estimate for blocks of size 2^( 6) =       0.000630181620
  error estimate for blocks of size 2^( 7) =       0.000632586509

      target function =                  N/A
              le_mean =     -22.416344161827
             les_mean =     503.072508646085
             stat err =       0.000624037238
             autocorr =       1.342782050778
              std dev =       0.761592643492
             le_variance =       0.580023354621


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.241634416183e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.1035e-02, overlap shift 6.1035e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.416344161827       residual = 2.83e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.416411996991       residual = 7.21e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.416617373635       residual = 1.36e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.417042824480       residual = 1.93e-03           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.417587856036       residual = 1.21e-03           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.417826167254       residual = 6.04e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.417955757864       residual = 2.72e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.418086395274       residual = 1.22e-04           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.418108585011       residual = 3.75e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.418129343182       residual = 2.65e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -22.418163532658       residual = 3.51e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -22.418168726199       residual = 2.44e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -22.418174377862       residual = 1.05e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -22.418176669539       residual = 7.31e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -22.418183262556       residual = 6.24e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -22.418193301049       residual = 1.37e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -22.418195161552       residual = 1.65e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   energy =     -22.418198701059       residual = 3.69e-07           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   energy =     -22.418202697425       residual = 1.56e-07           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   energy =     -22.418202195477       residual = 4.90e-08           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   energy =     -22.418202341783       residual = 1.65e-08           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   energy =     -22.418202557765       residual = 1.26e-08           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   energy =     -22.418202499844       residual = 6.56e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         22 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 6.1035e-02 is 8.812771e-02

solving harmonic davidson linear method for identity shift 2.4414e-01, overlap shift 2.4414e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.416344161827       residual = 2.83e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.416376447534       residual = 6.69e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.416476286960       residual = 1.14e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.416663251088       residual = 1.13e-03           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.416833554909       residual = 5.14e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.416885950255       residual = 1.13e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.416902962950       residual = 4.06e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.416915199275       residual = 1.81e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.416916794868       residual = 4.98e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.416919042923       residual = 3.72e-06           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -22.416921647873       residual = 2.23e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -22.416921380456       residual = 1.31e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -22.416921198113       residual = 5.88e-07           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -22.416921025248       residual = 1.89e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -22.416922070089       residual = 4.89e-08           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -22.416921994923       residual = 3.12e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -22.416922056473       residual = 7.74e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         16 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 2.4414e-01 is 2.044571e-02

solving harmonic davidson linear method for identity shift 9.7656e-01, overlap shift 9.7656e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.416344161827       residual = 2.83e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.416354589155       residual = 6.45e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.416387399607       residual = 1.01e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.416445647957       residual = 7.31e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.416483596090       residual = 2.98e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.416496339305       residual = 2.44e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.416497408272       residual = 9.31e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.416498821730       residual = 3.80e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.416499045351       residual = 1.12e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.416499149938       residual = 5.80e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -22.416499412122       residual = 2.14e-07           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -22.416499390565       residual = 1.21e-07           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -22.416499356470       residual = 2.58e-08           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -22.416499363311       residual = 9.12e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         13 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 9.7656e-01 is 5.166997e-03

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.149329 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 6.6127e+01
  </log>
  <optVariables href="FORMP2PJWARM.s010.opt.xml">
 uu_0                 2.368286e-01 1 1  ON 0
 uu_1                 7.173443e-02 1 1  ON 1
 uu_2                -2.892943e-02 1 1  ON 2
 uu_3                -7.687296e-02 1 1  ON 3
 uu_4                -9.120328e-02 1 1  ON 4
 uu_5                -8.659941e-02 1 1  ON 5
 uu_6                -6.738335e-02 1 1  ON 6
 uu_7                -3.489243e-02 1 1  ON 7
 uu_8                 2.552775e-03 1 1  ON 8
 uu_9                 3.118633e-02 1 1  ON 9
 ud_0                 3.726367e-01 1 1  ON 10
 ud_1                 9.663220e-02 1 1  ON 11
 ud_2                -3.514649e-02 1 1  ON 12
 ud_3                -9.357515e-02 1 1  ON 13
 ud_4                -1.121003e-01 1 1  ON 14
 ud_5                -1.107092e-01 1 1  ON 15
 ud_6                -9.355026e-02 1 1  ON 16
 ud_7                -6.156751e-02 1 1  ON 17
 ud_8                -2.088987e-02 1 1  ON 18
 ud_9                 1.819935e-02 1 1  ON 19
 eC_0                -3.416007e-01 1 1  ON 20
 eC_1                -2.062497e-01 1 1  ON 21
 eC_2                 4.038430e-02 1 1  ON 22
 eC_3                 1.711801e-01 1 1  ON 23
 eC_4                 1.869639e-01 1 1  ON 24
 eC_5                 1.382640e-01 1 1  ON 25
 eC_6                 9.848575e-03 1 1  ON 26
 eC_7                -1.246641e-03 1 1  ON 27
 eC_8                 1.238302e-03 1 1  ON 28
 eC_9                 8.969714e-04 1 1  ON 29
 eO_0                -6.764051e-01 1 1  ON 30
 eO_1                -3.345911e-01 1 1  ON 31
 eO_2                 7.063845e-02 1 1  ON 32
 eO_3                 2.570088e-01 1 1  ON 33
 eO_4                 3.057566e-01 1 1  ON 34
 eO_5                 2.623242e-01 1 1  ON 35
 eO_6                 1.152387e-01 1 1  ON 36
 eO_7                 4.190892e-03 1 1  ON 37
 eO_8                -1.040705e-02 1 1  ON 38
 eO_9                 2.385895e-03 1 1  ON 39
eH1_0                -9.054904e-02 1 1  ON 40
eH1_1                 1.068177e-03 1 1  ON 41
eH1_2                 1.274636e-02 1 1  ON 42
eH1_3                -5.628611e-03 1 1  ON 43
eH1_4                 6.009958e-03 1 1  ON 44
eH1_5                -1.113280e-03 1 1  ON 45
eH1_6                 2.329430e-02 1 1  ON 46
eH1_7                 4.284044e-02 1 1  ON 47
eH1_8                 7.633329e-03 1 1  ON 48
eH1_9                 2.433987e-03 1 1  ON 49
eH2_0                -9.175679e-02 1 1  ON 50
eH2_1                 7.152356e-04 1 1  ON 51
eH2_2                 1.333353e-02 1 1  ON 52
eH2_3                -5.889832e-03 1 1  ON 53
eH2_4                 6.291063e-03 1 1  ON 54
eH2_5                -4.382247e-04 1 1  ON 55
eH2_6                 2.441491e-02 1 1  ON 56
eH2_7                 4.265466e-02 1 1  ON 57
eH2_8                 7.132342e-03 1 1  ON 58
eH2_9                 2.366851e-03 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 10
    time step          = 0.05
    reference energy   = -22.4463
    reference variance = 0.824809
====================================================
  Execution time = 4.8545e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORMP2PJWARM.s010
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2417e+01
  VMC Evar = 5.5613e-01
  Total weights = 2.0000e+06
  Execution time = 4.6188e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.554441054164
                                         uncertainty =       0.003254440049

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.554441054164
                                         uncertainty =       0.003254440049

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000526567666
  error estimate for blocks of size 2^( 2) =       0.000552475509
  error estimate for blocks of size 2^( 3) =       0.000578549608
  error estimate for blocks of size 2^( 4) =       0.000598580629
  error estimate for blocks of size 2^( 5) =       0.000611283327
  error estimate for blocks of size 2^( 6) =       0.000619230247
  error estimate for blocks of size 2^( 7) =       0.000624827242

      target function =                  N/A
              le_mean =     -22.417087637220
             les_mean =     503.080364870429
             stat err =       0.000613480361
             autocorr =       1.357353460769
              std dev =       0.744679134193
             le_variance =       0.554547012902

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.560793777809
                                         uncertainty =       0.003412302545

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.560793777809
                                         uncertainty =       0.003412302545

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000529574731
  error estimate for blocks of size 2^( 2) =       0.000553453080
  error estimate for blocks of size 2^( 3) =       0.000577080949
  error estimate for blocks of size 2^( 4) =       0.000595142440
  error estimate for blocks of size 2^( 5) =       0.000606626399
  error estimate for blocks of size 2^( 6) =       0.000614022890
  error estimate for blocks of size 2^( 7) =       0.000619238046

      target function =                  N/A
              le_mean =     -22.417572156439
             les_mean =     503.108439899328
             stat err =       0.000608757444
             autocorr =       1.321399265642
              std dev =       0.748931766343
             le_variance =       0.560898790638

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.557996718915
                                         uncertainty =       0.003341623713

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.557996718915
                                         uncertainty =       0.003341623713

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000528252640
  error estimate for blocks of size 2^( 2) =       0.000553105129
  error estimate for blocks of size 2^( 3) =       0.000577933251
  error estimate for blocks of size 2^( 4) =       0.000596986499
  error estimate for blocks of size 2^( 5) =       0.000609094467
  error estimate for blocks of size 2^( 6) =       0.000616792253
  error estimate for blocks of size 2^( 7) =       0.000622233554

      target function =                  N/A
              le_mean =     -22.417099124990
             les_mean =     503.084434604951
             stat err =       0.000611276693
             autocorr =       1.339036209471
              std dev =       0.747062048529
             le_variance =       0.558101704352

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.554958362232
                                         uncertainty =       0.003267024953

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.554958362232
                                         uncertainty =       0.003267024953

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000526813118
  error estimate for blocks of size 2^( 2) =       0.000552575435
  error estimate for blocks of size 2^( 3) =       0.000578480955
  error estimate for blocks of size 2^( 4) =       0.000598381747
  error estimate for blocks of size 2^( 5) =       0.000611007298
  error estimate for blocks of size 2^( 6) =       0.000618922252
  error estimate for blocks of size 2^( 7) =       0.000624501658

      target function =                  N/A
              le_mean =     -22.417063797886
             les_mean =     503.079813163453
             stat err =       0.000613203239
             autocorr =       1.354864048298
              std dev =       0.745026256241
             le_variance =       0.555064122488


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.417087637220        initial
     6.1035e-02     6.1035e-01             8.8128e-02       -22.417572156439  <--
     2.4414e-01     2.4414e+00             2.0446e-02       -22.417099124990
     9.7656e-01     9.7656e+00             5.1670e-03       -22.417063797886

*****************************************************************************
Applying the update for shift_i =   6.1035e-02     and shift_s =   6.1035e-01
*****************************************************************************

  Execution time = 7.1644e+01
  </log>
  <optVariables href="FORMP2PJWARM.s010.opt.xml">
 uu_0                 2.479857e-01 1 1  ON 0
 uu_1                 8.037622e-02 1 1  ON 1
 uu_2                -2.366408e-02 1 1  ON 2
 uu_3                -7.657502e-02 1 1  ON 3
 uu_4                -9.650010e-02 1 1  ON 4
 uu_5                -9.688547e-02 1 1  ON 5
 uu_6                -8.183996e-02 1 1  ON 6
 uu_7                -5.025670e-02 1 1  ON 7
 uu_8                -8.529462e-03 1 1  ON 8
 uu_9                 3.790211e-02 1 1  ON 9
 ud_0                 3.863448e-01 1 1  ON 10
 ud_1                 1.082771e-01 1 1  ON 11
 ud_2                -2.696519e-02 1 1  ON 12
 ud_3                -9.059692e-02 1 1  ON 13
 ud_4                -1.150463e-01 1 1  ON 14
 ud_5                -1.195305e-01 1 1  ON 15
 ud_6                -1.073840e-01 1 1  ON 16
 ud_7                -7.771130e-02 1 1  ON 17
 ud_8                -3.364826e-02 1 1  ON 18
 ud_9                 1.818444e-02 1 1  ON 19
 eC_0                -3.852756e-01 1 1  ON 20
 eC_1                -2.400334e-01 1 1  ON 21
 eC_2                 1.774239e-02 1 1  ON 22
 eC_3                 1.671838e-01 1 1  ON 23
 eC_4                 2.095240e-01 1 1  ON 24
 eC_5                 1.835469e-01 1 1  ON 25
 eC_6                 3.682685e-02 1 1  ON 26
 eC_7                 5.346260e-03 1 1  ON 27
 eC_8                 2.989583e-03 1 1  ON 28
 eC_9                 1.626005e-03 1 1  ON 29
 eO_0                -7.440871e-01 1 1  ON 30
 eO_1                -3.915294e-01 1 1  ON 31
 eO_2                 3.310460e-02 1 1  ON 32
 eO_3                 2.475789e-01 1 1  ON 33
 eO_4                 3.287694e-01 1 1  ON 34
 eO_5                 3.110365e-01 1 1  ON 35
 eO_6                 1.751755e-01 1 1  ON 36
 eO_7                 3.681590e-02 1 1  ON 37
 eO_8                -6.860054e-03 1 1  ON 38
 eO_9                 4.378936e-03 1 1  ON 39
eH1_0                -1.017416e-01 1 1  ON 40
eH1_1                -7.470602e-03 1 1  ON 41
eH1_2                 6.586013e-03 1 1  ON 42
eH1_3                -7.122253e-03 1 1  ON 43
eH1_4                 9.606795e-03 1 1  ON 44
eH1_5                 3.417902e-03 1 1  ON 45
eH1_6                 2.310835e-02 1 1  ON 46
eH1_7                 4.637190e-02 1 1  ON 47
eH1_8                 1.826541e-02 1 1  ON 48
eH1_9                 6.252828e-03 1 1  ON 49
eH2_0                -1.043904e-01 1 1  ON 50
eH2_1                -8.948662e-03 1 1  ON 51
eH2_2                 7.705673e-03 1 1  ON 52
eH2_3                -7.516775e-03 1 1  ON 53
eH2_4                 9.943142e-03 1 1  ON 54
eH2_5                 4.548645e-03 1 1  ON 55
eH2_6                 2.438285e-02 1 1  ON 56
eH2_7                 4.817874e-02 1 1  ON 57
eH2_8                 1.746373e-02 1 1  ON 58
eH2_9                 5.964073e-03 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.3778e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORMP2PJWARM.s011 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORMP2PJWARM.s011 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=11  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2354e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 30888 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 11
    time step          = 0.05
    reference energy   = -22.3746
    reference variance = 0.580447
====================================================
  Execution time = 4.9739e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORMP2PJWARM.s011
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2420e+01
  VMC Evar = 5.6216e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.5870e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.562267600993
                                         uncertainty =       0.004724235062

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.562267600993
                                         uncertainty =       0.004724235062

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000530170640
  error estimate for blocks of size 2^( 2) =       0.000553416474
  error estimate for blocks of size 2^( 3) =       0.000575877749
  error estimate for blocks of size 2^( 4) =       0.000593807761
  error estimate for blocks of size 2^( 5) =       0.000605893734
  error estimate for blocks of size 2^( 6) =       0.000614192237
  error estimate for blocks of size 2^( 7) =       0.000617958499

      target function =                  N/A
              le_mean =     -22.420100349614
             les_mean =     503.223061220903
             stat err =       0.000607963058
             autocorr =       1.314991767065
              std dev =       0.749774509596
             le_variance =       0.562161815239


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.242010034961e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5259e-02, overlap shift 1.5259e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.420100349614       residual = 9.06e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.420176133610       residual = 3.48e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.420503455651       residual = 9.66e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.420804265498       residual = 1.11e-03           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.421095416965       residual = 1.12e-03           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.421327230574       residual = 9.26e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.421529159387       residual = 7.00e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.421797893291       residual = 1.37e-04           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.421846532928       residual = 9.91e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.421909214211       residual = 1.06e-04           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -22.421975105363       residual = 4.43e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -22.422012612054       residual = 4.77e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -22.422020106255       residual = 4.04e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -22.422065386172       residual = 3.80e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -22.422080784683       residual = 4.05e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -22.422125505615       residual = 1.57e-05           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -22.422156155489       residual = 1.15e-05           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   energy =     -22.422171292006       residual = 5.91e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   energy =     -22.422171460736       residual = 2.27e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   energy =     -22.422178539688       residual = 1.42e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   energy =     -22.422186288099       residual = 8.67e-07           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   energy =     -22.422190531968       residual = 9.56e-07           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   energy =     -22.422188356438       residual = 8.87e-07           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   energy =     -22.422188923868       residual = 3.18e-07           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   energy =     -22.422190807604       residual = 4.08e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   energy =     -22.422191318078       residual = 2.59e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   energy =     -22.422191935039       residual = 8.91e-08           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   energy =     -22.422193247695       residual = 5.25e-08           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   energy =     -22.422194525868       residual = 1.59e-08           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   energy =     -22.422194829360       residual = 8.97e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         29 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.5259e-02 is 1.203313e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 6.1035e-02, overlap shift 6.1035e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.420100349614       residual = 9.06e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.420161647298       residual = 3.25e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.420379938020       residual = 9.99e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.420473257867       residual = 6.47e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.420617254979       residual = 5.35e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.420703232745       residual = 2.84e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.420786355859       residual = 1.60e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.420836333714       residual = 2.89e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.420844050126       residual = 2.02e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.420859503092       residual = 1.83e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -22.420869098346       residual = 6.30e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -22.420876625328       residual = 6.62e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -22.420872262683       residual = 4.98e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -22.420879597009       residual = 2.98e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -22.420877622598       residual = 2.88e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -22.420882773015       residual = 1.02e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -22.420882416711       residual = 4.03e-07           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   energy =     -22.420883604186       residual = 1.81e-07           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   energy =     -22.420882862360       residual = 4.32e-08           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   energy =     -22.420883194590       residual = 2.91e-08           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   energy =     -22.420883472186       residual = 1.56e-08           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   energy =     -22.420883636293       residual = 8.33e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         21 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 6.1035e-02 is 5.370112e-02

solving harmonic davidson linear method for identity shift 2.4414e-01, overlap shift 2.4414e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.420100349614       residual = 9.06e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.420135086615       residual = 3.15e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.420195654894       residual = 9.78e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.420255217098       residual = 2.20e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.420288323077       residual = 1.94e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.420307422163       residual = 7.14e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.420323404399       residual = 2.11e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.420326585224       residual = 4.88e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.420328558274       residual = 2.52e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.420330533766       residual = 1.70e-06           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -22.420330925209       residual = 5.52e-07           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -22.420332567858       residual = 5.75e-07           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -22.420331287282       residual = 1.88e-07           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -22.420331408950       residual = 1.22e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -22.420331879907       residual = 3.90e-08           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -22.420331440569       residual = 1.66e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -22.420331697503       residual = 4.55e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         16 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 2.4414e-01 is 1.227366e-02

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.170514 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 6.5636e+01
  </log>
  <optVariables href="FORMP2PJWARM.s011.opt.xml">
 uu_0                 2.572791e-01 1 1  ON 0
 uu_1                 8.764305e-02 1 1  ON 1
 uu_2                -1.894683e-02 1 1  ON 2
 uu_3                -7.538928e-02 1 1  ON 3
 uu_4                -9.957379e-02 1 1  ON 4
 uu_5                -1.044740e-01 1 1  ON 5
 uu_6                -9.362896e-02 1 1  ON 6
 uu_7                -6.431591e-02 1 1  ON 7
 uu_8                -2.093934e-02 1 1  ON 8
 uu_9                 3.801696e-02 1 1  ON 9
 ud_0                 3.947727e-01 1 1  ON 10
 ud_1                 1.167887e-01 1 1  ON 11
 ud_2                -2.098991e-02 1 1  ON 12
 ud_3                -8.793022e-02 1 1  ON 13
 ud_4                -1.167284e-01 1 1  ON 14
 ud_5                -1.253677e-01 1 1  ON 15
 ud_6                -1.172496e-01 1 1  ON 16
 ud_7                -9.107711e-02 1 1  ON 17
 ud_8                -4.768019e-02 1 1  ON 18
 ud_9                 1.516640e-02 1 1  ON 19
 eC_0                -4.172964e-01 1 1  ON 20
 eC_1                -2.682194e-01 1 1  ON 21
 eC_2                -4.319725e-03 1 1  ON 22
 eC_3                 1.591037e-01 1 1  ON 23
 eC_4                 2.203504e-01 1 1  ON 24
 eC_5                 2.180746e-01 1 1  ON 25
 eC_6                 6.984666e-02 1 1  ON 26
 eC_7                 1.494449e-02 1 1  ON 27
 eC_8                 4.142684e-03 1 1  ON 28
 eC_9                 2.491684e-03 1 1  ON 29
 eO_0                -7.977883e-01 1 1  ON 30
 eO_1                -4.383235e-01 1 1  ON 31
 eO_2                -1.719504e-03 1 1  ON 32
 eO_3                 2.335967e-01 1 1  ON 33
 eO_4                 3.404191e-01 1 1  ON 34
 eO_5                 3.445484e-01 1 1  ON 35
 eO_6                 2.257408e-01 1 1  ON 36
 eO_7                 7.772400e-02 1 1  ON 37
 eO_8                 5.141956e-04 1 1  ON 38
 eO_9                 7.162966e-03 1 1  ON 39
eH1_0                -1.117813e-01 1 1  ON 40
eH1_1                -1.555957e-02 1 1  ON 41
eH1_2                 1.168628e-03 1 1  ON 42
eH1_3                -9.018953e-03 1 1  ON 43
eH1_4                 1.220879e-02 1 1  ON 44
eH1_5                 7.169052e-03 1 1  ON 45
eH1_6                 2.353084e-02 1 1  ON 46
eH1_7                 4.822007e-02 1 1  ON 47
eH1_8                 2.957372e-02 1 1  ON 48
eH1_9                 1.014281e-02 1 1  ON 49
eH2_0                -1.120236e-01 1 1  ON 50
eH2_1                -1.481954e-02 1 1  ON 51
eH2_2                 1.502559e-03 1 1  ON 52
eH2_3                -9.756173e-03 1 1  ON 53
eH2_4                 1.125425e-02 1 1  ON 54
eH2_5                 7.473788e-03 1 1  ON 55
eH2_6                 2.482258e-02 1 1  ON 56
eH2_7                 4.845470e-02 1 1  ON 57
eH2_8                 2.953164e-02 1 1  ON 58
eH2_9                 1.019441e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 11
    time step          = 0.05
    reference energy   = -22.4325
    reference variance = 0.502109
====================================================
  Execution time = 4.8623e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORMP2PJWARM.s011
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2421e+01
  VMC Evar = 5.7147e-01
  Total weights = 2.0000e+06
  Execution time = 4.6604e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.568044240144
                                         uncertainty =       0.007527602420

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.568044240144
                                         uncertainty =       0.007527602420

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000532971359
  error estimate for blocks of size 2^( 2) =       0.000555885346
  error estimate for blocks of size 2^( 3) =       0.000578416872
  error estimate for blocks of size 2^( 4) =       0.000596431017
  error estimate for blocks of size 2^( 5) =       0.000608546661
  error estimate for blocks of size 2^( 6) =       0.000615811484
  error estimate for blocks of size 2^( 7) =       0.000622919165

      target function =                  N/A
              le_mean =     -22.421576227079
             les_mean =     503.295197162539
             stat err =       0.000610927082
             autocorr =       1.313926317056
              std dev =       0.753735324833
             le_variance =       0.568116939901

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.958501238816
                                         uncertainty =       0.009551450069

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.958501238816
                                         uncertainty =       0.009551450069

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000692306557
  error estimate for blocks of size 2^( 2) =       0.000734103334
  error estimate for blocks of size 2^( 3) =       0.000772646804
  error estimate for blocks of size 2^( 4) =       0.000801631949
  error estimate for blocks of size 2^( 5) =       0.000818676293
  error estimate for blocks of size 2^( 6) =       0.000828002141
  error estimate for blocks of size 2^( 7) =       0.000833840853

      target function =                  N/A
              le_mean =     -22.514284493359
             les_mean =     507.851582507185
             stat err =       0.000820537809
             autocorr =       1.404754087618
              std dev =       0.979069322649
             le_variance =       0.958576738552

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.576394628073
                                         uncertainty =       0.007620182327

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.576394628073
                                         uncertainty =       0.007620182327

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000536872626
  error estimate for blocks of size 2^( 2) =       0.000558407300
  error estimate for blocks of size 2^( 3) =       0.000579193483
  error estimate for blocks of size 2^( 4) =       0.000595598740
  error estimate for blocks of size 2^( 5) =       0.000606721003
  error estimate for blocks of size 2^( 6) =       0.000613408385
  error estimate for blocks of size 2^( 7) =       0.000620060279

      target function =                  N/A
              le_mean =     -22.421611759632
             les_mean =     503.305138043482
             stat err =       0.000608947101
             autocorr =       1.286520214453
              std dev =       0.759252548277
             le_variance =       0.576464432065

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.568580901440
                                         uncertainty =       0.007532669600

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.568580901440
                                         uncertainty =       0.007532669600

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000533222777
  error estimate for blocks of size 2^( 2) =       0.000555945273
  error estimate for blocks of size 2^( 3) =       0.000578241528
  error estimate for blocks of size 2^( 4) =       0.000596044959
  error estimate for blocks of size 2^( 5) =       0.000608034392
  error estimate for blocks of size 2^( 6) =       0.000615220928
  error estimate for blocks of size 2^( 7) =       0.000622274053

      target function =                  N/A
              le_mean =     -22.421469242166
             les_mean =     503.290935752199
             stat err =       0.000610393583
             autocorr =       1.310395927019
              std dev =       0.754090882534
             le_variance =       0.568653059121


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.421576227079        initial
            N/A            N/A                    N/A                    N/A     bad update
     6.1035e-02     6.1035e-01             5.3701e-02       -22.421611759632  <--
     2.4414e-01     2.4414e+00             1.2274e-02       -22.421469242166

*****************************************************************************
Applying the update for shift_i =   6.1035e-02     and shift_s =   6.1035e-01
*****************************************************************************

  Execution time = 7.1933e+01
  </log>
  <optVariables href="FORMP2PJWARM.s011.opt.xml">
 uu_0                 2.572791e-01 1 1  ON 0
 uu_1                 8.764305e-02 1 1  ON 1
 uu_2                -1.894683e-02 1 1  ON 2
 uu_3                -7.538928e-02 1 1  ON 3
 uu_4                -9.957379e-02 1 1  ON 4
 uu_5                -1.044740e-01 1 1  ON 5
 uu_6                -9.362896e-02 1 1  ON 6
 uu_7                -6.431591e-02 1 1  ON 7
 uu_8                -2.093934e-02 1 1  ON 8
 uu_9                 3.801696e-02 1 1  ON 9
 ud_0                 3.947727e-01 1 1  ON 10
 ud_1                 1.167887e-01 1 1  ON 11
 ud_2                -2.098991e-02 1 1  ON 12
 ud_3                -8.793022e-02 1 1  ON 13
 ud_4                -1.167284e-01 1 1  ON 14
 ud_5                -1.253677e-01 1 1  ON 15
 ud_6                -1.172496e-01 1 1  ON 16
 ud_7                -9.107711e-02 1 1  ON 17
 ud_8                -4.768019e-02 1 1  ON 18
 ud_9                 1.516640e-02 1 1  ON 19
 eC_0                -4.172964e-01 1 1  ON 20
 eC_1                -2.682194e-01 1 1  ON 21
 eC_2                -4.319725e-03 1 1  ON 22
 eC_3                 1.591037e-01 1 1  ON 23
 eC_4                 2.203504e-01 1 1  ON 24
 eC_5                 2.180746e-01 1 1  ON 25
 eC_6                 6.984666e-02 1 1  ON 26
 eC_7                 1.494449e-02 1 1  ON 27
 eC_8                 4.142684e-03 1 1  ON 28
 eC_9                 2.491684e-03 1 1  ON 29
 eO_0                -7.977883e-01 1 1  ON 30
 eO_1                -4.383235e-01 1 1  ON 31
 eO_2                -1.719504e-03 1 1  ON 32
 eO_3                 2.335967e-01 1 1  ON 33
 eO_4                 3.404191e-01 1 1  ON 34
 eO_5                 3.445484e-01 1 1  ON 35
 eO_6                 2.257408e-01 1 1  ON 36
 eO_7                 7.772400e-02 1 1  ON 37
 eO_8                 5.141956e-04 1 1  ON 38
 eO_9                 7.162966e-03 1 1  ON 39
eH1_0                -1.117813e-01 1 1  ON 40
eH1_1                -1.555957e-02 1 1  ON 41
eH1_2                 1.168628e-03 1 1  ON 42
eH1_3                -9.018953e-03 1 1  ON 43
eH1_4                 1.220879e-02 1 1  ON 44
eH1_5                 7.169052e-03 1 1  ON 45
eH1_6                 2.353084e-02 1 1  ON 46
eH1_7                 4.822007e-02 1 1  ON 47
eH1_8                 2.957372e-02 1 1  ON 48
eH1_9                 1.014281e-02 1 1  ON 49
eH2_0                -1.120236e-01 1 1  ON 50
eH2_1                -1.481954e-02 1 1  ON 51
eH2_2                 1.502559e-03 1 1  ON 52
eH2_3                -9.756173e-03 1 1  ON 53
eH2_4                 1.125425e-02 1 1  ON 54
eH2_5                 7.473788e-03 1 1  ON 55
eH2_6                 2.482258e-02 1 1  ON 56
eH2_7                 4.845470e-02 1 1  ON 57
eH2_8                 2.953164e-02 1 1  ON 58
eH2_9                 1.019441e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.3757e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORMP2PJWARM.s012 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORMP2PJWARM.s012 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=12  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2358e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 30888 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 12
    time step          = 0.05
    reference energy   = -22.3727
    reference variance = 0.417046
====================================================
  Execution time = 5.1229e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORMP2PJWARM.s012
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2422e+01
  VMC Evar = 5.6523e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.5773e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.565242717438
                                         uncertainty =       0.004443433363

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.565242717438
                                         uncertainty =       0.004443433363

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000531615590
  error estimate for blocks of size 2^( 2) =       0.000554526233
  error estimate for blocks of size 2^( 3) =       0.000576310148
  error estimate for blocks of size 2^( 4) =       0.000593037109
  error estimate for blocks of size 2^( 5) =       0.000603001959
  error estimate for blocks of size 2^( 6) =       0.000606486688
  error estimate for blocks of size 2^( 7) =       0.000610854475

      target function =                  N/A
              le_mean =     -22.422099987912
             les_mean =     503.315797855906
             stat err =       0.000603345058
             autocorr =       1.288060027191
              std dev =       0.751817977028
             le_variance =       0.565230270583


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.242209998791e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5259e-02, overlap shift 1.5259e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.422099987912       residual = 4.84e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.422158385989       residual = 1.76e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.422199252072       residual = 3.34e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.422346371021       residual = 8.68e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.422597157368       residual = 7.52e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.422858020224       residual = 3.87e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.423074079197       residual = 3.43e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.423162294377       residual = 1.16e-04           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.423217303788       residual = 1.19e-04           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.423247162199       residual = 4.03e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -22.423276997703       residual = 3.10e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -22.423284165362       residual = 1.50e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -22.423299375719       residual = 1.98e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -22.423322503918       residual = 1.14e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -22.423331754038       residual = 1.35e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -22.423333940902       residual = 5.64e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -22.423344838282       residual = 6.37e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   energy =     -22.423340154438       residual = 2.34e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   energy =     -22.423346492772       residual = 1.21e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   energy =     -22.423348055808       residual = 1.04e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   energy =     -22.423354306118       residual = 7.52e-07           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   energy =     -22.423354597659       residual = 4.97e-07           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   energy =     -22.423359161341       residual = 3.45e-07           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   energy =     -22.423359867619       residual = 2.67e-07           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   energy =     -22.423361271321       residual = 2.05e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   energy =     -22.423361052728       residual = 7.80e-08           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   energy =     -22.423361335123       residual = 4.64e-08           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   energy =     -22.423362423845       residual = 2.35e-08           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   energy =     -22.423362338168       residual = 7.14e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         28 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.5259e-02 is 4.098690e-01

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 6.1035e-02, overlap shift 6.1035e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.422099987912       residual = 4.84e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.422147146095       residual = 1.73e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.422175729746       residual = 2.86e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.422261380174       residual = 5.22e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.422378810421       residual = 3.22e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.422466278155       residual = 1.21e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.422513309395       residual = 8.57e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.422526010773       residual = 2.80e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.422532217549       residual = 1.97e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.422539516124       residual = 5.27e-06           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -22.422542998881       residual = 4.69e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -22.422543499843       residual = 1.58e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -22.422546303792       residual = 1.73e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -22.422548947659       residual = 7.61e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -22.422547002217       residual = 9.69e-07           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -22.422545715884       residual = 2.88e-07           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -22.422545602567       residual = 1.05e-07           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   energy =     -22.422545399259       residual = 6.79e-08           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   energy =     -22.422546166109       residual = 3.90e-08           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   energy =     -22.422545786032       residual = 1.61e-08           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   energy =     -22.422546224747       residual = 7.02e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         20 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 6.1035e-02 is 3.642226e-02

solving harmonic davidson linear method for identity shift 2.4414e-01, overlap shift 2.4414e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.422099987912       residual = 4.84e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.422126632612       residual = 1.89e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.422140691739       residual = 1.97e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.422173696292       residual = 2.53e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.422206313107       residual = 1.03e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.422216735283       residual = 6.09e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.422227333060       residual = 1.46e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.422229714798       residual = 4.93e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.422229531090       residual = 1.98e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.422229955601       residual = 5.88e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -22.422230190238       residual = 3.85e-07           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -22.422230250577       residual = 1.68e-07           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -22.422230589210       residual = 1.23e-07           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -22.422230617507       residual = 3.47e-08           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -22.422230477309       residual = 1.87e-08           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -22.422230100837       residual = 5.73e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         15 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 2.4414e-01 is 8.522261e-03

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.189786 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 6.7024e+01
  </log>
  <optVariables href="FORMP2PJWARM.s012.opt.xml">
 uu_0                 2.616443e-01 1 1  ON 0
 uu_1                 9.083281e-02 1 1  ON 1
 uu_2                -1.675085e-02 1 1  ON 2
 uu_3                -7.508378e-02 1 1  ON 3
 uu_4                -1.017508e-01 1 1  ON 4
 uu_5                -1.087760e-01 1 1  ON 5
 uu_6                -1.007085e-01 1 1  ON 6
 uu_7                -7.334684e-02 1 1  ON 7
 uu_8                -2.905862e-02 1 1  ON 8
 uu_9                 3.476694e-02 1 1  ON 9
 ud_0                 4.014181e-01 1 1  ON 10
 ud_1                 1.221086e-01 1 1  ON 11
 ud_2                -1.628574e-02 1 1  ON 12
 ud_3                -8.540343e-02 1 1  ON 13
 ud_4                -1.169713e-01 1 1  ON 14
 ud_5                -1.283772e-01 1 1  ON 15
 ud_6                -1.248149e-01 1 1  ON 16
 ud_7                -1.006934e-01 1 1  ON 17
 ud_8                -5.914379e-02 1 1  ON 18
 ud_9                 8.699079e-03 1 1  ON 19
 eC_0                -4.378184e-01 1 1  ON 20
 eC_1                -2.859937e-01 1 1  ON 21
 eC_2                -1.924919e-02 1 1  ON 22
 eC_3                 1.493960e-01 1 1  ON 23
 eC_4                 2.218548e-01 1 1  ON 24
 eC_5                 2.381556e-01 1 1  ON 25
 eC_6                 9.859697e-02 1 1  ON 26
 eC_7                 2.526540e-02 1 1  ON 27
 eC_8                 5.527950e-03 1 1  ON 28
 eC_9                 3.050899e-03 1 1  ON 29
 eO_0                -8.342105e-01 1 1  ON 30
 eO_1                -4.704318e-01 1 1  ON 31
 eO_2                -2.693443e-02 1 1  ON 32
 eO_3                 2.201617e-01 1 1  ON 33
 eO_4                 3.434198e-01 1 1  ON 34
 eO_5                 3.638932e-01 1 1  ON 35
 eO_6                 2.591210e-01 1 1  ON 36
 eO_7                 1.135374e-01 1 1  ON 37
 eO_8                 1.124220e-02 1 1  ON 38
 eO_9                 1.002096e-02 1 1  ON 39
eH1_0                -1.173517e-01 1 1  ON 40
eH1_1                -2.097317e-02 1 1  ON 41
eH1_2                -2.323264e-03 1 1  ON 42
eH1_3                -1.180467e-02 1 1  ON 43
eH1_4                 1.359535e-02 1 1  ON 44
eH1_5                 1.122740e-02 1 1  ON 45
eH1_6                 2.614335e-02 1 1  ON 46
eH1_7                 4.477554e-02 1 1  ON 47
eH1_8                 3.749979e-02 1 1  ON 48
eH1_9                 1.386967e-02 1 1  ON 49
eH2_0                -1.178551e-01 1 1  ON 50
eH2_1                -2.102755e-02 1 1  ON 51
eH2_2                -2.537946e-03 1 1  ON 52
eH2_3                -1.153573e-02 1 1  ON 53
eH2_4                 1.335875e-02 1 1  ON 54
eH2_5                 1.130586e-02 1 1  ON 55
eH2_6                 2.618631e-02 1 1  ON 56
eH2_7                 4.457121e-02 1 1  ON 57
eH2_8                 3.823636e-02 1 1  ON 58
eH2_9                 1.438603e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 12
    time step          = 0.05
    reference energy   = -22.4134
    reference variance = 0.327625
====================================================
  Execution time = 4.8159e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORMP2PJWARM.s012
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2423e+01
  VMC Evar = 5.6836e-01
  Total weights = 2.0000e+06
  Execution time = 4.6247e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.566004632332
                                         uncertainty =       0.004272003289

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.566004632332
                                         uncertainty =       0.004272003289

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000531939385
  error estimate for blocks of size 2^( 2) =       0.000554203592
  error estimate for blocks of size 2^( 3) =       0.000575296178
  error estimate for blocks of size 2^( 4) =       0.000591735170
  error estimate for blocks of size 2^( 5) =       0.000603075601
  error estimate for blocks of size 2^( 6) =       0.000607115785
  error estimate for blocks of size 2^( 7) =       0.000613501756

      target function =                  N/A
              le_mean =     -22.423007255455
             les_mean =     503.357173114326
             stat err =       0.000603857078
             autocorr =       1.288676854599
              std dev =       0.752275892948
             le_variance =       0.565919019110

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.606884866960
                                         uncertainty =       0.004892625635

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.606884866960
                                         uncertainty =       0.004892625635

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000550805266
  error estimate for blocks of size 2^( 2) =       0.000571545411
  error estimate for blocks of size 2^( 3) =       0.000589853838
  error estimate for blocks of size 2^( 4) =       0.000603542917
  error estimate for blocks of size 2^( 5) =       0.000612982528
  error estimate for blocks of size 2^( 6) =       0.000616555849
  error estimate for blocks of size 2^( 7) =       0.000622644719

      target function =                  N/A
              le_mean =     -22.429932739454
             les_mean =     503.708655275835
             stat err =       0.000613931503
             autocorr =       1.242349160943
              std dev =       0.778956277838
             le_variance =       0.606772882784

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.571536270762
                                         uncertainty =       0.004399073746

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.571536270762
                                         uncertainty =       0.004399073746

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000534529960
  error estimate for blocks of size 2^( 2) =       0.000556004227
  error estimate for blocks of size 2^( 3) =       0.000576039993
  error estimate for blocks of size 2^( 4) =       0.000591541582
  error estimate for blocks of size 2^( 5) =       0.000602335610
  error estimate for blocks of size 2^( 6) =       0.000606179735
  error estimate for blocks of size 2^( 7) =       0.000612524657

      target function =                  N/A
              le_mean =     -22.423028842547
             les_mean =     503.363666743873
             stat err =       0.000603145396
             autocorr =       1.273209674565
              std dev =       0.755939518682
             le_variance =       0.571444555906

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.566740427455
                                         uncertainty =       0.004289658195

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.566740427455
                                         uncertainty =       0.004289658195

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000532284701
  error estimate for blocks of size 2^( 2) =       0.000554439942
  error estimate for blocks of size 2^( 3) =       0.000575392781
  error estimate for blocks of size 2^( 4) =       0.000591703572
  error estimate for blocks of size 2^( 5) =       0.000602978148
  error estimate for blocks of size 2^( 6) =       0.000606996821
  error estimate for blocks of size 2^( 7) =       0.000613380465

      target function =                  N/A
              le_mean =     -22.422962263180
             les_mean =     503.355890378306
             stat err =       0.000603764751
             autocorr =       1.286611834824
              std dev =       0.752764243072
             le_variance =       0.566654005648


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.423007255455        initial
            N/A            N/A                    N/A                    N/A     bad update
     6.1035e-02     6.1035e-01             3.6422e-02       -22.423028842547  <--
     2.4414e-01     2.4414e+00             8.5223e-03       -22.422962263180

*****************************************************************************
Applying the update for shift_i =   6.1035e-02     and shift_s =   6.1035e-01
*****************************************************************************

  Execution time = 7.1279e+01
  </log>
  <optVariables href="FORMP2PJWARM.s012.opt.xml">
 uu_0                 2.616443e-01 1 1  ON 0
 uu_1                 9.083281e-02 1 1  ON 1
 uu_2                -1.675085e-02 1 1  ON 2
 uu_3                -7.508378e-02 1 1  ON 3
 uu_4                -1.017508e-01 1 1  ON 4
 uu_5                -1.087760e-01 1 1  ON 5
 uu_6                -1.007085e-01 1 1  ON 6
 uu_7                -7.334684e-02 1 1  ON 7
 uu_8                -2.905862e-02 1 1  ON 8
 uu_9                 3.476694e-02 1 1  ON 9
 ud_0                 4.014181e-01 1 1  ON 10
 ud_1                 1.221086e-01 1 1  ON 11
 ud_2                -1.628574e-02 1 1  ON 12
 ud_3                -8.540343e-02 1 1  ON 13
 ud_4                -1.169713e-01 1 1  ON 14
 ud_5                -1.283772e-01 1 1  ON 15
 ud_6                -1.248149e-01 1 1  ON 16
 ud_7                -1.006934e-01 1 1  ON 17
 ud_8                -5.914379e-02 1 1  ON 18
 ud_9                 8.699079e-03 1 1  ON 19
 eC_0                -4.378184e-01 1 1  ON 20
 eC_1                -2.859937e-01 1 1  ON 21
 eC_2                -1.924919e-02 1 1  ON 22
 eC_3                 1.493960e-01 1 1  ON 23
 eC_4                 2.218548e-01 1 1  ON 24
 eC_5                 2.381556e-01 1 1  ON 25
 eC_6                 9.859697e-02 1 1  ON 26
 eC_7                 2.526540e-02 1 1  ON 27
 eC_8                 5.527950e-03 1 1  ON 28
 eC_9                 3.050899e-03 1 1  ON 29
 eO_0                -8.342105e-01 1 1  ON 30
 eO_1                -4.704318e-01 1 1  ON 31
 eO_2                -2.693443e-02 1 1  ON 32
 eO_3                 2.201617e-01 1 1  ON 33
 eO_4                 3.434198e-01 1 1  ON 34
 eO_5                 3.638932e-01 1 1  ON 35
 eO_6                 2.591210e-01 1 1  ON 36
 eO_7                 1.135374e-01 1 1  ON 37
 eO_8                 1.124220e-02 1 1  ON 38
 eO_9                 1.002096e-02 1 1  ON 39
eH1_0                -1.173517e-01 1 1  ON 40
eH1_1                -2.097317e-02 1 1  ON 41
eH1_2                -2.323264e-03 1 1  ON 42
eH1_3                -1.180467e-02 1 1  ON 43
eH1_4                 1.359535e-02 1 1  ON 44
eH1_5                 1.122740e-02 1 1  ON 45
eH1_6                 2.614335e-02 1 1  ON 46
eH1_7                 4.477554e-02 1 1  ON 47
eH1_8                 3.749979e-02 1 1  ON 48
eH1_9                 1.386967e-02 1 1  ON 49
eH2_0                -1.178551e-01 1 1  ON 50
eH2_1                -2.102755e-02 1 1  ON 51
eH2_2                -2.537946e-03 1 1  ON 52
eH2_3                -1.153573e-02 1 1  ON 53
eH2_4                 1.335875e-02 1 1  ON 54
eH2_5                 1.130586e-02 1 1  ON 55
eH2_6                 2.618631e-02 1 1  ON 56
eH2_7                 4.457121e-02 1 1  ON 57
eH2_8                 3.823636e-02 1 1  ON 58
eH2_9                 1.438603e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.3831e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORMP2PJWARM.s013 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORMP2PJWARM.s013 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=13  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2361e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 30888 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 13
    time step          = 0.05
    reference energy   = -22.3967
    reference variance = 0.372484
====================================================
  Execution time = 4.9754e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORMP2PJWARM.s013
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2423e+01
  VMC Evar = 5.5903e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.5698e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.559052390054
                                         uncertainty =       0.003237285401

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.559052390054
                                         uncertainty =       0.003237285401

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000528693231
  error estimate for blocks of size 2^( 2) =       0.000550700266
  error estimate for blocks of size 2^( 3) =       0.000571724352
  error estimate for blocks of size 2^( 4) =       0.000587550962
  error estimate for blocks of size 2^( 5) =       0.000598007735
  error estimate for blocks of size 2^( 6) =       0.000605108543
  error estimate for blocks of size 2^( 7) =       0.000608108748

      target function =                  N/A
              le_mean =     -22.423497464841
             les_mean =     503.372271342168
             stat err =       0.000599693997
             autocorr =       1.286624752161
              std dev =       0.747685138249
             le_variance =       0.559033065958


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.242349746484e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5259e-02, overlap shift 1.5259e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.423497464841       residual = 5.10e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.423504755425       residual = 5.27e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.423555725689       residual = 2.73e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.423631021326       residual = 3.28e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.423797215427       residual = 4.02e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.423949593418       residual = 4.15e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.424095106946       residual = 3.05e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.424256228625       residual = 7.35e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.424328024361       residual = 4.45e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.424334600208       residual = 3.94e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -22.424336020029       residual = 1.37e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -22.424350067140       residual = 1.10e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -22.424361858147       residual = 2.01e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -22.424368606973       residual = 5.74e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -22.424384776291       residual = 7.05e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -22.424382544400       residual = 4.48e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -22.424387749701       residual = 3.02e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   energy =     -22.424392084235       residual = 2.01e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   energy =     -22.424394228701       residual = 1.45e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   energy =     -22.424396473053       residual = 5.85e-07           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   energy =     -22.424396239574       residual = 6.16e-07           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   energy =     -22.424397921596       residual = 5.19e-07           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   energy =     -22.424398050281       residual = 3.72e-07           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   energy =     -22.424398544760       residual = 1.15e-07           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   energy =     -22.424398691263       residual = 1.34e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   energy =     -22.424400081416       residual = 4.98e-08           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   energy =     -22.424400668120       residual = 1.96e-08           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   energy =     -22.424401645489       residual = 1.66e-08           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   energy =     -22.424401331884       residual = 2.68e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         28 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.5259e-02 is 3.017370e-01

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 6.1035e-02, overlap shift 6.1035e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.423497464841       residual = 5.10e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.423503379159       residual = 5.25e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.423538286787       residual = 2.50e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.423594281984       residual = 2.03e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.423675225026       residual = 1.59e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.423716373917       residual = 1.11e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.423756660734       residual = 6.85e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.423790680491       residual = 1.00e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.423797859283       residual = 7.80e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.423800497130       residual = 3.78e-06           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -22.423797428313       residual = 1.31e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -22.423798998600       residual = 1.73e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -22.423801298115       residual = 1.23e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -22.423801304992       residual = 5.55e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -22.423804122249       residual = 4.21e-07           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -22.423801988656       residual = 2.36e-07           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -22.423802085233       residual = 1.09e-07           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   energy =     -22.423801512778       residual = 9.04e-08           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   energy =     -22.423801857877       residual = 1.81e-08           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   energy =     -22.423801981314       residual = 9.64e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         19 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 6.1035e-02 is 3.263831e-02

solving harmonic davidson linear method for identity shift 2.4414e-01, overlap shift 2.4414e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.423497464841       residual = 5.10e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.423500834643       residual = 5.39e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.423514408267       residual = 1.93e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.423544182872       residual = 9.13e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.423563653284       residual = 3.42e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.423569638214       residual = 1.99e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.423578433659       residual = 1.31e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.423583025286       residual = 1.25e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.423581764294       residual = 7.24e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.423582031715       residual = 2.92e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -22.423582695486       residual = 1.43e-07           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -22.423582517608       residual = 1.28e-07           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -22.423582262531       residual = 5.47e-08           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -22.423582685160       residual = 2.20e-08           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -22.423582719557       residual = 8.81e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         14 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 2.4414e-01 is 7.228702e-03

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.208231 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 6.5475e+01
  </log>
  <optVariables href="FORMP2PJWARM.s013.opt.xml">
 uu_0                 2.653185e-01 1 1  ON 0
 uu_1                 9.386992e-02 1 1  ON 1
 uu_2                -1.452070e-02 1 1  ON 2
 uu_3                -7.442116e-02 1 1  ON 3
 uu_4                -1.027580e-01 1 1  ON 4
 uu_5                -1.122982e-01 1 1  ON 5
 uu_6                -1.063453e-01 1 1  ON 6
 uu_7                -8.099799e-02 1 1  ON 7
 uu_8                -3.847599e-02 1 1  ON 8
 uu_9                 3.051041e-02 1 1  ON 9
 ud_0                 4.052632e-01 1 1  ON 10
 ud_1                 1.262976e-01 1 1  ON 11
 ud_2                -1.336401e-02 1 1  ON 12
 ud_3                -8.372218e-02 1 1  ON 13
 ud_4                -1.172300e-01 1 1  ON 14
 ud_5                -1.309958e-01 1 1  ON 15
 ud_6                -1.295472e-01 1 1  ON 16
 ud_7                -1.080985e-01 1 1  ON 17
 ud_8                -6.760277e-02 1 1  ON 18
 ud_9                 2.171490e-03 1 1  ON 19
 eC_0                -4.537234e-01 1 1  ON 20
 eC_1                -3.011824e-01 1 1  ON 21
 eC_2                -3.243035e-02 1 1  ON 22
 eC_3                 1.409160e-01 1 1  ON 23
 eC_4                 2.212702e-01 1 1  ON 24
 eC_5                 2.519141e-01 1 1  ON 25
 eC_6                 1.225470e-01 1 1  ON 26
 eC_7                 3.787885e-02 1 1  ON 27
 eC_8                 7.994624e-03 1 1  ON 28
 eC_9                 3.410865e-03 1 1  ON 29
 eO_0                -8.643350e-01 1 1  ON 30
 eO_1                -4.973455e-01 1 1  ON 31
 eO_2                -4.705465e-02 1 1  ON 32
 eO_3                 2.094445e-01 1 1  ON 33
 eO_4                 3.438705e-01 1 1  ON 34
 eO_5                 3.772755e-01 1 1  ON 35
 eO_6                 2.831600e-01 1 1  ON 36
 eO_7                 1.461757e-01 1 1  ON 37
 eO_8                 2.361965e-02 1 1  ON 38
 eO_9                 1.334578e-02 1 1  ON 39
eH1_0                -1.219050e-01 1 1  ON 40
eH1_1                -2.511382e-02 1 1  ON 41
eH1_2                -6.374609e-03 1 1  ON 42
eH1_3                -1.381667e-02 1 1  ON 43
eH1_4                 1.386251e-02 1 1  ON 44
eH1_5                 1.304741e-02 1 1  ON 45
eH1_6                 2.820010e-02 1 1  ON 46
eH1_7                 4.294142e-02 1 1  ON 47
eH1_8                 4.344874e-02 1 1  ON 48
eH1_9                 1.871678e-02 1 1  ON 49
eH2_0                -1.228345e-01 1 1  ON 50
eH2_1                -2.546668e-02 1 1  ON 51
eH2_2                -6.359836e-03 1 1  ON 52
eH2_3                -1.325024e-02 1 1  ON 53
eH2_4                 1.447292e-02 1 1  ON 54
eH2_5                 1.352927e-02 1 1  ON 55
eH2_6                 2.748745e-02 1 1  ON 56
eH2_7                 4.200654e-02 1 1  ON 57
eH2_8                 4.442363e-02 1 1  ON 58
eH2_9                 1.959892e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 13
    time step          = 0.05
    reference energy   = -22.4673
    reference variance = 0.434715
====================================================
  Execution time = 4.8141e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORMP2PJWARM.s013
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2424e+01
  VMC Evar = 6.1393e-01
  Total weights = 2.0000e+06
  Execution time = 4.6393e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.612341980131
                                         uncertainty =       0.031831152121

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.612341980131
                                         uncertainty =       0.031831152121

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000553308079
  error estimate for blocks of size 2^( 2) =       0.000573895850
  error estimate for blocks of size 2^( 3) =       0.000594393990
  error estimate for blocks of size 2^( 4) =       0.000609311445
  error estimate for blocks of size 2^( 5) =       0.000619263513
  error estimate for blocks of size 2^( 6) =       0.000623376651
  error estimate for blocks of size 2^( 7) =       0.000624628119

      target function =                  N/A
              le_mean =     -22.423727158410
             les_mean =     503.435839029738
             stat err =       0.000619144932
             autocorr =       1.252133460427
              std dev =       0.782495789823
             le_variance =       0.612299661091

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.634524282080
                                         uncertainty =       0.033873145494

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.634524282080
                                         uncertainty =       0.033873145494

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000563244282
  error estimate for blocks of size 2^( 2) =       0.000582454956
  error estimate for blocks of size 2^( 3) =       0.000601011691
  error estimate for blocks of size 2^( 4) =       0.000613821442
  error estimate for blocks of size 2^( 5) =       0.000622332410
  error estimate for blocks of size 2^( 6) =       0.000625845947
  error estimate for blocks of size 2^( 7) =       0.000626958950

      target function =                  N/A
              le_mean =     -22.426521386463
             les_mean =     503.583349422463
             stat err =       0.000622239687
             autocorr =       1.220455172597
              std dev =       0.796547702420
             le_variance =       0.634488242231

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.615954543680
                                         uncertainty =       0.032359228466

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.615954543680
                                         uncertainty =       0.032359228466

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000554938950
  error estimate for blocks of size 2^( 2) =       0.000574988755
  error estimate for blocks of size 2^( 3) =       0.000594806831
  error estimate for blocks of size 2^( 4) =       0.000609065964
  error estimate for blocks of size 2^( 5) =       0.000618601604
  error estimate for blocks of size 2^( 6) =       0.000622561125
  error estimate for blocks of size 2^( 7) =       0.000623782626

      target function =                  N/A
              le_mean =     -22.423734952086
             les_mean =     503.439803369067
             stat err =       0.000618502830
             autocorr =       1.242204122609
              std dev =       0.784802188859
             le_variance =       0.615914475638

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.612524789788
                                         uncertainty =       0.031886358916

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.612524789788
                                         uncertainty =       0.031886358916

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000553390883
  error estimate for blocks of size 2^( 2) =       0.000573909518
  error estimate for blocks of size 2^( 3) =       0.000594321982
  error estimate for blocks of size 2^( 4) =       0.000609159092
  error estimate for blocks of size 2^( 5) =       0.000619061729
  error estimate for blocks of size 2^( 6) =       0.000623162064
  error estimate for blocks of size 2^( 7) =       0.000624406012

      target function =                  N/A
              le_mean =     -22.423703066877
             les_mean =     503.434941864543
             stat err =       0.000618947224
             autocorr =       1.250959468452
              std dev =       0.782612892384
             le_variance =       0.612482939325


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.423727158410        initial
            N/A            N/A                    N/A                    N/A     bad update
     6.1035e-02     6.1035e-01             3.2638e-02       -22.423734952086  <--
     2.4414e-01     2.4414e+00             7.2287e-03       -22.423703066877

*****************************************************************************
Applying the update for shift_i =   6.1035e-02     and shift_s =   6.1035e-01
*****************************************************************************

  Execution time = 7.1336e+01
  </log>
  <optVariables href="FORMP2PJWARM.s013.opt.xml">
 uu_0                 2.653185e-01 1 1  ON 0
 uu_1                 9.386992e-02 1 1  ON 1
 uu_2                -1.452070e-02 1 1  ON 2
 uu_3                -7.442116e-02 1 1  ON 3
 uu_4                -1.027580e-01 1 1  ON 4
 uu_5                -1.122982e-01 1 1  ON 5
 uu_6                -1.063453e-01 1 1  ON 6
 uu_7                -8.099799e-02 1 1  ON 7
 uu_8                -3.847599e-02 1 1  ON 8
 uu_9                 3.051041e-02 1 1  ON 9
 ud_0                 4.052632e-01 1 1  ON 10
 ud_1                 1.262976e-01 1 1  ON 11
 ud_2                -1.336401e-02 1 1  ON 12
 ud_3                -8.372218e-02 1 1  ON 13
 ud_4                -1.172300e-01 1 1  ON 14
 ud_5                -1.309958e-01 1 1  ON 15
 ud_6                -1.295472e-01 1 1  ON 16
 ud_7                -1.080985e-01 1 1  ON 17
 ud_8                -6.760277e-02 1 1  ON 18
 ud_9                 2.171490e-03 1 1  ON 19
 eC_0                -4.537234e-01 1 1  ON 20
 eC_1                -3.011824e-01 1 1  ON 21
 eC_2                -3.243035e-02 1 1  ON 22
 eC_3                 1.409160e-01 1 1  ON 23
 eC_4                 2.212702e-01 1 1  ON 24
 eC_5                 2.519141e-01 1 1  ON 25
 eC_6                 1.225470e-01 1 1  ON 26
 eC_7                 3.787885e-02 1 1  ON 27
 eC_8                 7.994624e-03 1 1  ON 28
 eC_9                 3.410865e-03 1 1  ON 29
 eO_0                -8.643350e-01 1 1  ON 30
 eO_1                -4.973455e-01 1 1  ON 31
 eO_2                -4.705465e-02 1 1  ON 32
 eO_3                 2.094445e-01 1 1  ON 33
 eO_4                 3.438705e-01 1 1  ON 34
 eO_5                 3.772755e-01 1 1  ON 35
 eO_6                 2.831600e-01 1 1  ON 36
 eO_7                 1.461757e-01 1 1  ON 37
 eO_8                 2.361965e-02 1 1  ON 38
 eO_9                 1.334578e-02 1 1  ON 39
eH1_0                -1.219050e-01 1 1  ON 40
eH1_1                -2.511382e-02 1 1  ON 41
eH1_2                -6.374609e-03 1 1  ON 42
eH1_3                -1.381667e-02 1 1  ON 43
eH1_4                 1.386251e-02 1 1  ON 44
eH1_5                 1.304741e-02 1 1  ON 45
eH1_6                 2.820010e-02 1 1  ON 46
eH1_7                 4.294142e-02 1 1  ON 47
eH1_8                 4.344874e-02 1 1  ON 48
eH1_9                 1.871678e-02 1 1  ON 49
eH2_0                -1.228345e-01 1 1  ON 50
eH2_1                -2.546668e-02 1 1  ON 51
eH2_2                -6.359836e-03 1 1  ON 52
eH2_3                -1.325024e-02 1 1  ON 53
eH2_4                 1.447292e-02 1 1  ON 54
eH2_5                 1.352927e-02 1 1  ON 55
eH2_6                 2.748745e-02 1 1  ON 56
eH2_7                 4.200654e-02 1 1  ON 57
eH2_8                 4.442363e-02 1 1  ON 58
eH2_9                 1.959892e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.3682e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORMP2PJWARM.s014 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORMP2PJWARM.s014 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=14  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2366e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 30888 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 14
    time step          = 0.05
    reference energy   = -22.5319
    reference variance = 0.351695
====================================================
  Execution time = 5.1140e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORMP2PJWARM.s014
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2424e+01
  VMC Evar = 5.6856e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.6088e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.568667339192
                                         uncertainty =       0.006835896792

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.568667339192
                                         uncertainty =       0.006835896792

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000533180584
  error estimate for blocks of size 2^( 2) =       0.000554388128
  error estimate for blocks of size 2^( 3) =       0.000574315767
  error estimate for blocks of size 2^( 4) =       0.000589361520
  error estimate for blocks of size 2^( 5) =       0.000598788585
  error estimate for blocks of size 2^( 6) =       0.000604636301
  error estimate for blocks of size 2^( 7) =       0.000603680022

      target function =                  N/A
              le_mean =     -22.424286566804
             les_mean =     503.417190815375
             stat err =       0.000599116607
             autocorr =       1.262624072041
              std dev =       0.754031212543
             le_variance =       0.568563069490


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.242428656680e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5259e-02, overlap shift 1.5259e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.424286566804       residual = 2.69e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.424301755615       residual = 5.06e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.424326383563       residual = 2.16e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.424389262598       residual = 2.53e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.424452573157       residual = 2.75e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.424580208180       residual = 2.85e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.424686082669       residual = 2.62e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.424762323951       residual = 1.65e-04           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.424808679039       residual = 9.72e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.424866984919       residual = 4.17e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -22.424874796740       residual = 2.24e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -22.424871550550       residual = 7.17e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -22.424870722945       residual = 6.21e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -22.424882266390       residual = 2.40e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -22.424888918152       residual = 3.92e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -22.424885086233       residual = 2.12e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -22.424891652159       residual = 2.10e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   energy =     -22.424902209405       residual = 3.19e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   energy =     -22.424898985273       residual = 1.06e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   energy =     -22.424900271176       residual = 4.89e-07           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   energy =     -22.424906176269       residual = 4.54e-07           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   energy =     -22.424906946620       residual = 2.09e-07           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   energy =     -22.424910823056       residual = 1.45e-07           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   energy =     -22.424910263270       residual = 8.59e-08           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   energy =     -22.424910903880       residual = 4.17e-08           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   energy =     -22.424911201140       residual = 1.48e-08           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   energy =     -22.424911712503       residual = 7.71e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         26 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.5259e-02 is 2.353317e-01

solving harmonic davidson linear method for identity shift 6.1035e-02, overlap shift 6.1035e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.424286566804       residual = 2.69e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.424299280045       residual = 4.88e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.424316005191       residual = 1.78e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.424359720139       residual = 2.05e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.424388721468       residual = 1.21e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.424445448347       residual = 9.96e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.424474547692       residual = 4.85e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.424483299323       residual = 1.83e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.424489911807       residual = 1.83e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.424495226798       residual = 4.43e-06           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -22.424491033097       residual = 2.36e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -22.424488774082       residual = 5.00e-07           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -22.424489103963       residual = 6.13e-07           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -22.424491041019       residual = 2.32e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -22.424491048609       residual = 2.21e-07           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -22.424489925810       residual = 1.32e-07           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -22.424491366565       residual = 6.48e-08           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   energy =     -22.424491876465       residual = 7.93e-08           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   energy =     -22.424490986569       residual = 1.10e-08           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   energy =     -22.424491363066       residual = 6.90e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         19 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 6.1035e-02 is 2.778684e-02

solving harmonic davidson linear method for identity shift 2.4414e-01, overlap shift 2.4414e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.424286566804       residual = 2.69e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.424294262716       residual = 4.97e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.424301766358       residual = 9.83e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.424321116193       residual = 1.73e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.424330091136       residual = 3.89e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.424340148800       residual = 3.58e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.424345156162       residual = 1.27e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.424346429397       residual = 3.23e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.424346788057       residual = 9.73e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.424346185298       residual = 2.38e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -22.424345168061       residual = 1.34e-07           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -22.424344606142       residual = 5.14e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -22.424345232241       residual = 2.93e-08           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -22.424345257880       residual = 1.50e-08           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -22.424345225692       residual = 5.12e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         14 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 2.4414e-01 is 6.207851e-03

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.225031 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 6.7252e+01
  </log>
  <optVariables href="FORMP2PJWARM.s014.opt.xml">
 uu_0                 2.669367e-01 1 1  ON 0
 uu_1                 9.587709e-02 1 1  ON 1
 uu_2                -1.367722e-02 1 1  ON 2
 uu_3                -7.419742e-02 1 1  ON 3
 uu_4                -1.042454e-01 1 1  ON 4
 uu_5                -1.153799e-01 1 1  ON 5
 uu_6                -1.109878e-01 1 1  ON 6
 uu_7                -8.813407e-02 1 1  ON 7
 uu_8                -4.530681e-02 1 1  ON 8
 uu_9                 2.574632e-02 1 1  ON 9
 ud_0                 4.086064e-01 1 1  ON 10
 ud_1                 1.292088e-01 1 1  ON 11
 ud_2                -1.134183e-02 1 1  ON 12
 ud_3                -8.255671e-02 1 1  ON 13
 ud_4                -1.177498e-01 1 1  ON 14
 ud_5                -1.334265e-01 1 1  ON 15
 ud_6                -1.331068e-01 1 1  ON 16
 ud_7                -1.140120e-01 1 1  ON 17
 ud_8                -7.412706e-02 1 1  ON 18
 ud_9                -4.814465e-03 1 1  ON 19
 eC_0                -4.675460e-01 1 1  ON 20
 eC_1                -3.131269e-01 1 1  ON 21
 eC_2                -4.240434e-02 1 1  ON 22
 eC_3                 1.333959e-01 1 1  ON 23
 eC_4                 2.188307e-01 1 1  ON 24
 eC_5                 2.607443e-01 1 1  ON 25
 eC_6                 1.438823e-01 1 1  ON 26
 eC_7                 5.068502e-02 1 1  ON 27
 eC_8                 1.014587e-02 1 1  ON 28
 eC_9                 3.828186e-03 1 1  ON 29
 eO_0                -8.876333e-01 1 1  ON 30
 eO_1                -5.188456e-01 1 1  ON 31
 eO_2                -6.435844e-02 1 1  ON 32
 eO_3                 1.981631e-01 1 1  ON 33
 eO_4                 3.422043e-01 1 1  ON 34
 eO_5                 3.858690e-01 1 1  ON 35
 eO_6                 3.024651e-01 1 1  ON 36
 eO_7                 1.739626e-01 1 1  ON 37
 eO_8                 3.721704e-02 1 1  ON 38
 eO_9                 1.711192e-02 1 1  ON 39
eH1_0                -1.270812e-01 1 1  ON 40
eH1_1                -2.950655e-02 1 1  ON 41
eH1_2                -9.003680e-03 1 1  ON 42
eH1_3                -1.538749e-02 1 1  ON 43
eH1_4                 1.430166e-02 1 1  ON 44
eH1_5                 1.542182e-02 1 1  ON 45
eH1_6                 2.968601e-02 1 1  ON 46
eH1_7                 4.137570e-02 1 1  ON 47
eH1_8                 4.853096e-02 1 1  ON 48
eH1_9                 2.369769e-02 1 1  ON 49
eH2_0                -1.257112e-01 1 1  ON 50
eH2_1                -2.859714e-02 1 1  ON 51
eH2_2                -9.206284e-03 1 1  ON 52
eH2_3                -1.540868e-02 1 1  ON 53
eH2_4                 1.390198e-02 1 1  ON 54
eH2_5                 1.564429e-02 1 1  ON 55
eH2_6                 3.037504e-02 1 1  ON 56
eH2_7                 3.847323e-02 1 1  ON 57
eH2_8                 4.828390e-02 1 1  ON 58
eH2_9                 2.433675e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 14
    time step          = 0.05
    reference energy   = -22.5668
    reference variance = 0.621608
====================================================
  Execution time = 4.8468e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORMP2PJWARM.s014
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2425e+01
  VMC Evar = 5.6358e-01
  Total weights = 2.0000e+06
  Execution time = 4.6484e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.561653129226
                                         uncertainty =       0.003761407094

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.561653129226
                                         uncertainty =       0.003761407094

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000529999534
  error estimate for blocks of size 2^( 2) =       0.000551475262
  error estimate for blocks of size 2^( 3) =       0.000572168439
  error estimate for blocks of size 2^( 4) =       0.000587946023
  error estimate for blocks of size 2^( 5) =       0.000597557050
  error estimate for blocks of size 2^( 6) =       0.000603806724
  error estimate for blocks of size 2^( 7) =       0.000606811733

      target function =                  N/A
              le_mean =     -22.424594369170
             les_mean =     503.424231352714
             stat err =       0.000599030382
             autocorr =       1.277458277554
              std dev =       0.749532528840
             le_variance =       0.561799011790

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.576446968384
                                         uncertainty =       0.003989451777

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.576446968384
                                         uncertainty =       0.003989451777

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000536929732
  error estimate for blocks of size 2^( 2) =       0.000557383811
  error estimate for blocks of size 2^( 3) =       0.000576633095
  error estimate for blocks of size 2^( 4) =       0.000591042036
  error estimate for blocks of size 2^( 5) =       0.000599643714
  error estimate for blocks of size 2^( 6) =       0.000605099548
  error estimate for blocks of size 2^( 7) =       0.000608304926

      target function =                  N/A
              le_mean =     -22.426093646934
             les_mean =     503.506263045930
             stat err =       0.000601022556
             autocorr =       1.252987206230
              std dev =       0.759333308349
             le_variance =       0.576587073168

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.565465769549
                                         uncertainty =       0.003818624410

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.565465769549
                                         uncertainty =       0.003818624410

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000531794050
  error estimate for blocks of size 2^( 2) =       0.000552879651
  error estimate for blocks of size 2^( 3) =       0.000573083601
  error estimate for blocks of size 2^( 4) =       0.000588414692
  error estimate for blocks of size 2^( 5) =       0.000597707650
  error estimate for blocks of size 2^( 6) =       0.000603756489
  error estimate for blocks of size 2^( 7) =       0.000606816764

      target function =                  N/A
              le_mean =     -22.424604638654
             les_mean =     503.428502740957
             stat err =       0.000599173899
             autocorr =       1.269459424350
              std dev =       0.752070358302
             le_variance =       0.565609823836

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.562270763645
                                         uncertainty =       0.003768543301

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.562270763645
                                         uncertainty =       0.003768543301

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000530290706
  error estimate for blocks of size 2^( 2) =       0.000551709375
  error estimate for blocks of size 2^( 3) =       0.000572336260
  error estimate for blocks of size 2^( 4) =       0.000588055017
  error estimate for blocks of size 2^( 5) =       0.000597622139
  error estimate for blocks of size 2^( 6) =       0.000603850955
  error estimate for blocks of size 2^( 7) =       0.000606865571

      target function =                  N/A
              le_mean =     -22.424577513139
             les_mean =     503.424092827470
             stat err =       0.000599098420
             autocorr =       1.276345694617
              std dev =       0.749944308521
             le_variance =       0.562416465884


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.424594369170        initial
     1.5259e-02     1.5259e-01             2.3533e-01       -22.426093646934  <--
     6.1035e-02     6.1035e-01             2.7787e-02       -22.424604638654
     2.4414e-01     2.4414e+00             6.2079e-03       -22.424577513139

*****************************************************************************
Applying the update for shift_i =   1.5259e-02     and shift_s =   1.5259e-01
*****************************************************************************

  Execution time = 7.1715e+01
  </log>
  <optVariables href="FORMP2PJWARM.s014.opt.xml">
 uu_0                 2.775805e-01 1 1  ON 0
 uu_1                 1.053068e-01 1 1  ON 1
 uu_2                -9.227805e-03 1 1  ON 2
 uu_3                -7.553533e-02 1 1  ON 3
 uu_4                -1.153919e-01 1 1  ON 4
 uu_5                -1.377780e-01 1 1  ON 5
 uu_6                -1.461559e-01 1 1  ON 6
 uu_7                -1.401569e-01 1 1  ON 7
 uu_8                -1.044483e-01 1 1  ON 8
 uu_9                -2.577850e-02 1 1  ON 9
 ud_0                 4.289607e-01 1 1  ON 10
 ud_1                 1.474507e-01 1 1  ON 11
 ud_2                 2.465699e-03 1 1  ON 12
 ud_3                -7.514382e-02 1 1  ON 13
 ud_4                -1.204166e-01 1 1  ON 14
 ud_5                -1.482501e-01 1 1  ON 15
 ud_6                -1.603028e-01 1 1  ON 16
 ud_7                -1.584795e-01 1 1  ON 17
 ud_8                -1.288370e-01 1 1  ON 18
 ud_9                -6.344165e-02 1 1  ON 19
 eC_0                -5.648134e-01 1 1  ON 20
 eC_1                -4.017139e-01 1 1  ON 21
 eC_2                -1.203429e-01 1 1  ON 22
 eC_3                 7.310003e-02 1 1  ON 23
 eC_4                 1.915582e-01 1 1  ON 24
 eC_5                 3.071546e-01 1 1  ON 25
 eC_6                 2.919018e-01 1 1  ON 26
 eC_7                 1.754154e-01 1 1  ON 27
 eC_8                 3.694224e-02 1 1  ON 28
 eC_9                 8.048019e-03 1 1  ON 29
 eO_0                -1.059647e+00 1 1  ON 30
 eO_1                -6.785956e-01 1 1  ON 31
 eO_2                -1.976474e-01 1 1  ON 32
 eO_3                 1.079194e-01 1 1  ON 33
 eO_4                 3.138243e-01 1 1  ON 34
 eO_5                 4.320995e-01 1 1  ON 35
 eO_6                 4.293029e-01 1 1  ON 36
 eO_7                 3.815074e-01 1 1  ON 37
 eO_8                 1.776600e-01 1 1  ON 38
 eO_9                 6.076871e-02 1 1  ON 39
eH1_0                -1.600352e-01 1 1  ON 40
eH1_1                -5.794384e-02 1 1  ON 41
eH1_2                -3.097150e-02 1 1  ON 42
eH1_3                -2.953897e-02 1 1  ON 43
eH1_4                 1.354847e-02 1 1  ON 44
eH1_5                 2.776140e-02 1 1  ON 45
eH1_6                 4.474529e-02 1 1  ON 46
eH1_7                 3.419119e-02 1 1  ON 47
eH1_8                 6.863862e-02 1 1  ON 48
eH1_9                 7.020420e-02 1 1  ON 49
eH2_0                -1.497360e-01 1 1  ON 50
eH2_1                -5.259379e-02 1 1  ON 51
eH2_2                -3.075375e-02 1 1  ON 52
eH2_3                -3.019974e-02 1 1  ON 53
eH2_4                 1.153707e-02 1 1  ON 54
eH2_5                 2.770483e-02 1 1  ON 55
eH2_6                 4.924288e-02 1 1  ON 56
eH2_7                 2.226450e-02 1 1  ON 57
eH2_8                 6.015241e-02 1 1  ON 58
eH2_9                 6.815827e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.3897e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORMP2PJWARM.s015 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORMP2PJWARM.s015 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=15  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2378e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 30888 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 15
    time step          = 0.05
    reference energy   = -22.3462
    reference variance = 0.631439
====================================================
  Execution time = 4.9933e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORMP2PJWARM.s015
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2425e+01
  VMC Evar = 5.6756e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.5919e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.567510818572
                                         uncertainty =       0.003264030140

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.567510818572
                                         uncertainty =       0.003264030140

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000532711808
  error estimate for blocks of size 2^( 2) =       0.000553080575
  error estimate for blocks of size 2^( 3) =       0.000571489031
  error estimate for blocks of size 2^( 4) =       0.000585575838
  error estimate for blocks of size 2^( 5) =       0.000593521255
  error estimate for blocks of size 2^( 6) =       0.000599305440
  error estimate for blocks of size 2^( 7) =       0.000601452527

      target function =                  N/A
              le_mean =     -22.425071297324
             les_mean =     503.451386146523
             stat err =       0.000594963765
             autocorr =       1.247373136810
              std dev =       0.753368263347
             le_variance =       0.567563740219


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.242507129732e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.8147e-03, overlap shift 3.8147e-02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.425071297325       residual = 5.94e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.425091985821       residual = 5.92e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.425103676175       residual = 4.97e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.425111028439       residual = 2.83e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.425117928301       residual = 1.80e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.425138910296       residual = 2.51e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.425152350416       residual = 2.43e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.425162954845       residual = 2.30e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.425176516420       residual = 3.08e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.425224668093       residual = 4.65e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -22.425262311975       residual = 4.97e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -22.425274172345       residual = 2.78e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -22.425304669355       residual = 3.19e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -22.425333003562       residual = 9.73e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -22.425340904298       residual = 1.38e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -22.425353715210       residual = 8.19e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -22.425359924163       residual = 5.10e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   energy =     -22.425390282881       residual = 6.82e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   energy =     -22.425402247161       residual = 3.19e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   energy =     -22.425403473343       residual = 4.17e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   energy =     -22.425404409378       residual = 3.23e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   energy =     -22.425412307335       residual = 1.04e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   energy =     -22.425421957781       residual = 1.36e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   energy =     -22.425430324038       residual = 1.14e-06           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   energy =     -22.425435949023       residual = 2.23e-06           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   energy =     -22.425443114702       residual = 1.42e-06           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   energy =     -22.425443228139       residual = 5.19e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   energy =     -22.425446016471       residual = 2.12e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   energy =     -22.425446707317       residual = 2.89e-07           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   energy =     -22.425445499437       residual = 2.01e-07           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   energy =     -22.425442686931       residual = 3.91e-08           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   energy =     -22.425443420818       residual = 3.60e-08           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   energy =     -22.425443955605       residual = 2.87e-08           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   energy =     -22.425444193065       residual = 3.65e-08           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   energy =     -22.425444106478       residual = 2.74e-08           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   energy =     -22.425444317822       residual = 2.07e-08           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   energy =     -22.425444235725       residual = 8.48e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         36 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 3.8147e-03 is 7.152689e+01

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 1.5259e-02, overlap shift 1.5259e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.425071297325       residual = 5.94e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.425091203612       residual = 6.06e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.425102183003       residual = 4.89e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.425109230625       residual = 2.85e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.425115143781       residual = 1.63e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.425134942474       residual = 2.31e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.425147338367       residual = 2.10e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.425156222501       residual = 2.05e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.425166702792       residual = 2.51e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.425201797279       residual = 2.99e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -22.425221255639       residual = 2.66e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -22.425225293534       residual = 1.18e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -22.425239188505       residual = 1.27e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -22.425247430009       residual = 3.16e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -22.425247631464       residual = 4.12e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -22.425250761650       residual = 2.27e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -22.425250795155       residual = 1.37e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   energy =     -22.425258658613       residual = 1.62e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   energy =     -22.425259425849       residual = 1.08e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   energy =     -22.425259685600       residual = 3.34e-07           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   energy =     -22.425258336280       residual = 2.90e-07           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   energy =     -22.425259822365       residual = 9.84e-08           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   energy =     -22.425262127300       residual = 1.06e-07           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   energy =     -22.425263432294       residual = 7.90e-08           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   energy =     -22.425263669459       residual = 1.10e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   energy =     -22.425263741042       residual = 3.85e-08           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   energy =     -22.425263027219       residual = 1.15e-08           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   energy =     -22.425263175212       residual = 4.78e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         27 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.5259e-02 is 6.123398e-02

solving harmonic davidson linear method for identity shift 6.1035e-02, overlap shift 6.1035e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.425071297325       residual = 5.94e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.425088588560       residual = 6.60e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.425097590380       residual = 4.62e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.425103619401       residual = 2.95e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.425107319345       residual = 1.22e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.425123185786       residual = 1.82e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.425133096475       residual = 1.11e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.425138229791       residual = 9.99e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.425146886308       residual = 2.47e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.425155109501       residual = 9.09e-06           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -22.425158139046       residual = 5.40e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -22.425157369365       residual = 1.74e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -22.425159284011       residual = 7.31e-07           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -22.425159267970       residual = 4.61e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -22.425158801540       residual = 2.72e-07           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -22.425158608734       residual = 2.16e-07           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -22.425158248515       residual = 1.01e-07           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   energy =     -22.425159236909       residual = 1.15e-07           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   energy =     -22.425159263694       residual = 1.73e-08           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   energy =     -22.425159147341       residual = 6.79e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         19 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 6.1035e-02 is 1.336417e-02

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.262277 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 6.5893e+01
  </log>
  <optVariables href="FORMP2PJWARM.s015.opt.xml">
 uu_0                 2.726657e-01 1 1  ON 0
 uu_1                 9.842419e-02 1 1  ON 1
 uu_2                -1.405968e-02 1 1  ON 2
 uu_3                -8.012567e-02 1 1  ON 3
 uu_4                -1.179346e-01 1 1  ON 4
 uu_5                -1.394302e-01 1 1  ON 5
 uu_6                -1.483022e-01 1 1  ON 6
 uu_7                -1.410618e-01 1 1  ON 7
 uu_8                -1.171919e-01 1 1  ON 8
 uu_9                -4.598437e-02 1 1  ON 9
 ud_0                 4.244479e-01 1 1  ON 10
 ud_1                 1.432006e-01 1 1  ON 11
 ud_2                -4.925592e-04 1 1  ON 12
 ud_3                -7.809237e-02 1 1  ON 13
 ud_4                -1.217672e-01 1 1  ON 14
 ud_5                -1.484608e-01 1 1  ON 15
 ud_6                -1.630309e-01 1 1  ON 16
 ud_7                -1.612885e-01 1 1  ON 17
 ud_8                -1.382426e-01 1 1  ON 18
 ud_9                -7.515112e-02 1 1  ON 19
 eC_0                -5.650049e-01 1 1  ON 20
 eC_1                -4.049894e-01 1 1  ON 21
 eC_2                -1.276750e-01 1 1  ON 22
 eC_3                 6.504337e-02 1 1  ON 23
 eC_4                 1.763670e-01 1 1  ON 24
 eC_5                 2.796800e-01 1 1  ON 25
 eC_6                 2.757126e-01 1 1  ON 26
 eC_7                 2.209814e-01 1 1  ON 27
 eC_8                 6.468960e-02 1 1  ON 28
 eC_9                 1.220875e-02 1 1  ON 29
 eO_0                -1.063617e+00 1 1  ON 30
 eO_1                -6.843827e-01 1 1  ON 31
 eO_2                -2.091780e-01 1 1  ON 32
 eO_3                 9.284609e-02 1 1  ON 33
 eO_4                 2.906013e-01 1 1  ON 34
 eO_5                 4.085400e-01 1 1  ON 35
 eO_6                 4.085257e-01 1 1  ON 36
 eO_7                 3.794564e-01 1 1  ON 37
 eO_8                 2.388940e-01 1 1  ON 38
 eO_9                 9.382619e-02 1 1  ON 39
eH1_0                -1.539122e-01 1 1  ON 40
eH1_1                -5.452630e-02 1 1  ON 41
eH1_2                -3.424995e-02 1 1  ON 42
eH1_3                -3.391058e-02 1 1  ON 43
eH1_4                 7.523442e-03 1 1  ON 44
eH1_5                 2.206436e-02 1 1  ON 45
eH1_6                 4.922401e-02 1 1  ON 46
eH1_7                 3.729644e-02 1 1  ON 47
eH1_8                 4.626678e-02 1 1  ON 48
eH1_9                 8.409240e-02 1 1  ON 49
eH2_0                -1.555532e-01 1 1  ON 50
eH2_1                -5.592690e-02 1 1  ON 51
eH2_2                -3.452771e-02 1 1  ON 52
eH2_3                -3.292425e-02 1 1  ON 53
eH2_4                 9.637398e-03 1 1  ON 54
eH2_5                 2.251078e-02 1 1  ON 55
eH2_6                 4.817738e-02 1 1  ON 56
eH2_7                 4.211410e-02 1 1  ON 57
eH2_8                 3.657658e-02 1 1  ON 58
eH2_9                 8.250748e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 15
    time step          = 0.05
    reference energy   = -22.4077
    reference variance = 0.427295
====================================================
  Execution time = 4.8306e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORMP2PJWARM.s015
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2426e+01
  VMC Evar = 5.7310e-01
  Total weights = 2.0000e+06
  Execution time = 4.6376e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.577047865976
                                         uncertainty =       0.004393624909

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.577047865976
                                         uncertainty =       0.004393624909

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000537190695
  error estimate for blocks of size 2^( 2) =       0.000557779389
  error estimate for blocks of size 2^( 3) =       0.000576419320
  error estimate for blocks of size 2^( 4) =       0.000590743925
  error estimate for blocks of size 2^( 5) =       0.000599908548
  error estimate for blocks of size 2^( 6) =       0.000606188234
  error estimate for blocks of size 2^( 7) =       0.000609576487

      target function =                  N/A
              le_mean =     -22.426643887911
             les_mean =     503.531503472991
             stat err =       0.000601604298
             autocorr =       1.254194516680
              std dev =       0.759702366963
             le_variance =       0.577147686370

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance = 638119184.629311919212
                                         uncertainty = 352630602.260930478573

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance = 638119184.629311919212
                                         uncertainty = 352630602.260930478573

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =      17.847969801275
  error estimate for blocks of size 2^( 2) =      17.888739646926
  error estimate for blocks of size 2^( 3) =      17.942181019121
  error estimate for blocks of size 2^( 4) =      18.175550425875
  error estimate for blocks of size 2^( 5) =      18.191038434652
  error estimate for blocks of size 2^( 6) =      18.186998188588
  error estimate for blocks of size 2^( 7) =      18.195806440915

      target function =                  N/A
              le_mean =    -125.703428667900
             les_mean = 637115534.856385231018
             stat err =      18.187348372507
             autocorr =       1.038391504619
              std dev =   25240.840953788214
             le_variance = 637100052.054432272911

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.570344237797
                                         uncertainty =       0.004366312373

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.570344237797
                                         uncertainty =       0.004366312373

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000534058995
  error estimate for blocks of size 2^( 2) =       0.000554669784
  error estimate for blocks of size 2^( 3) =       0.000573410471
  error estimate for blocks of size 2^( 4) =       0.000587710711
  error estimate for blocks of size 2^( 5) =       0.000596948400
  error estimate for blocks of size 2^( 6) =       0.000603243826
  error estimate for blocks of size 2^( 7) =       0.000606681979

      target function =                  N/A
              le_mean =     -22.426532165478
             les_mean =     503.519782703459
             stat err =       0.000598646229
             autocorr =       1.256498674284
              std dev =       0.755273473293
             le_variance =       0.570438019460

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.575326048537
                                         uncertainty =       0.004389314599

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.575326048537
                                         uncertainty =       0.004389314599

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000536388298
  error estimate for blocks of size 2^( 2) =       0.000556961328
  error estimate for blocks of size 2^( 3) =       0.000575602385
  error estimate for blocks of size 2^( 4) =       0.000589916150
  error estimate for blocks of size 2^( 5) =       0.000599088889
  error estimate for blocks of size 2^( 6) =       0.000605358148
  error estimate for blocks of size 2^( 7) =       0.000608769188

      target function =                  N/A
              le_mean =     -22.426505297682
             les_mean =     503.523564391834
             stat err =       0.000600783094
             autocorr =       1.254517767944
              std dev =       0.758567605804
             le_variance =       0.575424812575


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.426643887911        initial  <--
            N/A            N/A                    N/A                    N/A     bad update
     1.5259e-02     1.5259e-01             6.1234e-02       -22.426532165478
     6.1035e-02     6.1035e-01             1.3364e-02       -22.426505297682

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 71.4840
  </log>
  <optVariables href="FORMP2PJWARM.s015.opt.xml">
 uu_0                 2.775805e-01 1 1  ON 0
 uu_1                 1.053068e-01 1 1  ON 1
 uu_2                -9.227805e-03 1 1  ON 2
 uu_3                -7.553533e-02 1 1  ON 3
 uu_4                -1.153919e-01 1 1  ON 4
 uu_5                -1.377780e-01 1 1  ON 5
 uu_6                -1.461559e-01 1 1  ON 6
 uu_7                -1.401569e-01 1 1  ON 7
 uu_8                -1.044483e-01 1 1  ON 8
 uu_9                -2.577850e-02 1 1  ON 9
 ud_0                 4.289607e-01 1 1  ON 10
 ud_1                 1.474507e-01 1 1  ON 11
 ud_2                 2.465699e-03 1 1  ON 12
 ud_3                -7.514382e-02 1 1  ON 13
 ud_4                -1.204166e-01 1 1  ON 14
 ud_5                -1.482501e-01 1 1  ON 15
 ud_6                -1.603028e-01 1 1  ON 16
 ud_7                -1.584795e-01 1 1  ON 17
 ud_8                -1.288370e-01 1 1  ON 18
 ud_9                -6.344165e-02 1 1  ON 19
 eC_0                -5.648134e-01 1 1  ON 20
 eC_1                -4.017139e-01 1 1  ON 21
 eC_2                -1.203429e-01 1 1  ON 22
 eC_3                 7.310003e-02 1 1  ON 23
 eC_4                 1.915582e-01 1 1  ON 24
 eC_5                 3.071546e-01 1 1  ON 25
 eC_6                 2.919018e-01 1 1  ON 26
 eC_7                 1.754154e-01 1 1  ON 27
 eC_8                 3.694224e-02 1 1  ON 28
 eC_9                 8.048019e-03 1 1  ON 29
 eO_0                -1.059647e+00 1 1  ON 30
 eO_1                -6.785956e-01 1 1  ON 31
 eO_2                -1.976474e-01 1 1  ON 32
 eO_3                 1.079194e-01 1 1  ON 33
 eO_4                 3.138243e-01 1 1  ON 34
 eO_5                 4.320995e-01 1 1  ON 35
 eO_6                 4.293029e-01 1 1  ON 36
 eO_7                 3.815074e-01 1 1  ON 37
 eO_8                 1.776600e-01 1 1  ON 38
 eO_9                 6.076871e-02 1 1  ON 39
eH1_0                -1.600352e-01 1 1  ON 40
eH1_1                -5.794384e-02 1 1  ON 41
eH1_2                -3.097150e-02 1 1  ON 42
eH1_3                -2.953897e-02 1 1  ON 43
eH1_4                 1.354847e-02 1 1  ON 44
eH1_5                 2.776140e-02 1 1  ON 45
eH1_6                 4.474529e-02 1 1  ON 46
eH1_7                 3.419119e-02 1 1  ON 47
eH1_8                 6.863862e-02 1 1  ON 48
eH1_9                 7.020420e-02 1 1  ON 49
eH2_0                -1.497360e-01 1 1  ON 50
eH2_1                -5.259379e-02 1 1  ON 51
eH2_2                -3.075375e-02 1 1  ON 52
eH2_3                -3.019974e-02 1 1  ON 53
eH2_4                 1.153707e-02 1 1  ON 54
eH2_5                 2.770483e-02 1 1  ON 55
eH2_6                 4.924288e-02 1 1  ON 56
eH2_7                 2.226450e-02 1 1  ON 57
eH2_8                 6.015241e-02 1 1  ON 58
eH2_9                 6.815827e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.3738e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORMP2PJWARM.s016 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORMP2PJWARM.s016 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=16  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2378e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 30888 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 16
    time step          = 0.05
    reference energy   = -22.4104
    reference variance = 0.486927
====================================================
  Execution time = 5.0155e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORMP2PJWARM.s016
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2426e+01
  VMC Evar = 5.7409e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.6102e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.574172861330
                                         uncertainty =       0.006715925146

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.574172861330
                                         uncertainty =       0.006715925146

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000535764297
  error estimate for blocks of size 2^( 2) =       0.000555767233
  error estimate for blocks of size 2^( 3) =       0.000574634753
  error estimate for blocks of size 2^( 4) =       0.000588440362
  error estimate for blocks of size 2^( 5) =       0.000596243765
  error estimate for blocks of size 2^( 6) =       0.000602554627
  error estimate for blocks of size 2^( 7) =       0.000604321367

      target function =                  N/A
              le_mean =     -22.426389456368
             les_mean =     503.517030525660
             stat err =       0.000597890030
             autocorr =       1.245360494382
              std dev =       0.757685135129
             le_variance =       0.574086763995


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.242638945637e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.8147e-02, overlap shift 3.8147e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.426389456368       residual = 7.97e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.426406471507       residual = 4.77e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.426413405900       residual = 5.68e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.426435360573       residual = 2.83e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.426439066708       residual = 1.86e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.426441868517       residual = 2.11e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.426452267106       residual = 1.66e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.426458611406       residual = 1.68e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.426463426225       residual = 1.24e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.426455605908       residual = 1.43e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -22.426480074649       residual = 8.39e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -22.426479656449       residual = 4.65e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -22.426482214941       residual = 4.76e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -22.426484521545       residual = 1.18e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -22.426489274028       residual = 1.13e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -22.426491302885       residual = 4.93e-07           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -22.426493101752       residual = 3.26e-07           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   energy =     -22.426492060909       residual = 2.80e-07           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   energy =     -22.426493012966       residual = 8.77e-08           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   energy =     -22.426492215907       residual = 4.32e-08           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   energy =     -22.426491168727       residual = 2.60e-08           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   energy =     -22.426491561983       residual = 1.02e-08           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   energy =     -22.426491710786       residual = 3.17e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         22 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 3.8147e-02 is 2.087540e-02

solving harmonic davidson linear method for identity shift 1.5259e-01, overlap shift 1.5259e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.426389456368       residual = 7.97e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.426402589023       residual = 4.90e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.426405359514       residual = 4.59e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.426420523294       residual = 1.51e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.426423818421       residual = 1.35e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.426425044571       residual = 1.76e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.426429993029       residual = 6.76e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.426433596610       residual = 6.78e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.426431577366       residual = 6.43e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.426431084707       residual = 2.65e-06           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -22.426436720520       residual = 8.82e-07           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -22.426436173520       residual = 5.30e-07           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -22.426435023319       residual = 2.30e-07           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -22.426435435612       residual = 7.68e-08           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -22.426435875682       residual = 4.27e-08           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -22.426436191024       residual = 2.91e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -22.426436224443       residual = 1.46e-08           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   energy =     -22.426436100202       residual = 4.64e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         17 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.5259e-01 is 5.205614e-03

solving harmonic davidson linear method for identity shift 6.1035e-01, overlap shift 6.1035e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.426389456368       residual = 7.97e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.426396322346       residual = 6.25e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.426397189275       residual = 3.66e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.426400672763       residual = 3.13e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.426403310705       residual = 1.22e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.426405637079       residual = 1.05e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.426406178368       residual = 5.35e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.426406929374       residual = 2.49e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.426406375344       residual = 1.37e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.426407839920       residual = 2.28e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -22.426407412220       residual = 8.76e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -22.426407349490       residual = 2.60e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -22.426407323031       residual = 8.94e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         12 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 6.1035e-01 is 1.296811e-03

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.274215 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 6.6273e+01
  </log>
  <optVariables href="FORMP2PJWARM.s016.opt.xml">
 uu_0                 2.776795e-01 1 1  ON 0
 uu_1                 1.039208e-01 1 1  ON 1
 uu_2                -9.391188e-03 1 1  ON 2
 uu_3                -7.619338e-02 1 1  ON 3
 uu_4                -1.152070e-01 1 1  ON 4
 uu_5                -1.375471e-01 1 1  ON 5
 uu_6                -1.466386e-01 1 1  ON 6
 uu_7                -1.398770e-01 1 1  ON 7
 uu_8                -1.066966e-01 1 1  ON 8
 uu_9                -2.685201e-02 1 1  ON 9
 ud_0                 4.280693e-01 1 1  ON 10
 ud_1                 1.469549e-01 1 1  ON 11
 ud_2                 2.565684e-03 1 1  ON 12
 ud_3                -7.537701e-02 1 1  ON 13
 ud_4                -1.198840e-01 1 1  ON 14
 ud_5                -1.473831e-01 1 1  ON 15
 ud_6                -1.607319e-01 1 1  ON 16
 ud_7                -1.589790e-01 1 1  ON 17
 ud_8                -1.303280e-01 1 1  ON 18
 ud_9                -6.383332e-02 1 1  ON 19
 eC_0                -5.634371e-01 1 1  ON 20
 eC_1                -4.014543e-01 1 1  ON 21
 eC_2                -1.214336e-01 1 1  ON 22
 eC_3                 7.234003e-02 1 1  ON 23
 eC_4                 1.900686e-01 1 1  ON 24
 eC_5                 3.046184e-01 1 1  ON 25
 eC_6                 2.904626e-01 1 1  ON 26
 eC_7                 1.791586e-01 1 1  ON 27
 eC_8                 3.867655e-02 1 1  ON 28
 eC_9                 8.238552e-03 1 1  ON 29
 eO_0                -1.058635e+00 1 1  ON 30
 eO_1                -6.778894e-01 1 1  ON 31
 eO_2                -1.984241e-01 1 1  ON 32
 eO_3                 1.068830e-01 1 1  ON 33
 eO_4                 3.104045e-01 1 1  ON 34
 eO_5                 4.296932e-01 1 1  ON 35
 eO_6                 4.270041e-01 1 1  ON 36
 eO_7                 3.811411e-01 1 1  ON 37
 eO_8                 1.828656e-01 1 1  ON 38
 eO_9                 6.343216e-02 1 1  ON 39
eH1_0                -1.580793e-01 1 1  ON 40
eH1_1                -5.684173e-02 1 1  ON 41
eH1_2                -3.211363e-02 1 1  ON 42
eH1_3                -2.995559e-02 1 1  ON 43
eH1_4                 1.237707e-02 1 1  ON 44
eH1_5                 2.659725e-02 1 1  ON 45
eH1_6                 4.639358e-02 1 1  ON 46
eH1_7                 3.428407e-02 1 1  ON 47
eH1_8                 6.616778e-02 1 1  ON 48
eH1_9                 7.108126e-02 1 1  ON 49
eH2_0                -1.510000e-01 1 1  ON 50
eH2_1                -5.303138e-02 1 1  ON 51
eH2_2                -3.061659e-02 1 1  ON 52
eH2_3                -2.973783e-02 1 1  ON 53
eH2_4                 1.236788e-02 1 1  ON 54
eH2_5                 2.648715e-02 1 1  ON 55
eH2_6                 4.849590e-02 1 1  ON 56
eH2_7                 2.517289e-02 1 1  ON 57
eH2_8                 5.768555e-02 1 1  ON 58
eH2_9                 6.927135e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 16
    time step          = 0.05
    reference energy   = -22.3609
    reference variance = 0.385782
====================================================
  Execution time = 4.8383e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORMP2PJWARM.s016
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2427e+01
  VMC Evar = 5.6960e-01
  Total weights = 2.0000e+06
  Execution time = 4.6497e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.571348870572
                                         uncertainty =       0.003310636107

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.571348870572
                                         uncertainty =       0.003310636107

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000534497823
  error estimate for blocks of size 2^( 2) =       0.000554715826
  error estimate for blocks of size 2^( 3) =       0.000572657744
  error estimate for blocks of size 2^( 4) =       0.000586198785
  error estimate for blocks of size 2^( 5) =       0.000594926053
  error estimate for blocks of size 2^( 6) =       0.000598321943
  error estimate for blocks of size 2^( 7) =       0.000599448352

      target function =                  N/A
              le_mean =     -22.426983052884
             les_mean =     503.540944414465
             stat err =       0.000594723783
             autocorr =       1.238051558164
              std dev =       0.755894070500
             le_variance =       0.571375845816

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.567953413351
                                         uncertainty =       0.003294143115

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.567953413351
                                         uncertainty =       0.003294143115

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000532907432
  error estimate for blocks of size 2^( 2) =       0.000553124821
  error estimate for blocks of size 2^( 3) =       0.000571089889
  error estimate for blocks of size 2^( 4) =       0.000584646752
  error estimate for blocks of size 2^( 5) =       0.000593352440
  error estimate for blocks of size 2^( 6) =       0.000596825947
  error estimate for blocks of size 2^( 7) =       0.000597951997

      target function =                  N/A
              le_mean =     -22.426966183059
             les_mean =     503.536792554063
             stat err =       0.000593194284
             autocorr =       1.239054362793
              std dev =       0.753644917699
             le_variance =       0.567980661973

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.568045196474
                                         uncertainty =       0.003295208266

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.568045196474
                                         uncertainty =       0.003295208266

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000532950639
  error estimate for blocks of size 2^( 2) =       0.000553197215
  error estimate for blocks of size 2^( 3) =       0.000571185375
  error estimate for blocks of size 2^( 4) =       0.000584752042
  error estimate for blocks of size 2^( 5) =       0.000593468330
  error estimate for blocks of size 2^( 6) =       0.000596952837
  error estimate for blocks of size 2^( 7) =       0.000598048877

      target function =                  N/A
              le_mean =     -22.426959826567
             les_mean =     503.536599545443
             stat err =       0.000593305522
             autocorr =       1.239318137964
              std dev =       0.753706021630
             le_variance =       0.568072767042

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.570519408354
                                         uncertainty =       0.003306888454

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.570519408354
                                         uncertainty =       0.003306888454

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000534109777
  error estimate for blocks of size 2^( 2) =       0.000554337225
  error estimate for blocks of size 2^( 3) =       0.000572291420
  error estimate for blocks of size 2^( 4) =       0.000585837527
  error estimate for blocks of size 2^( 5) =       0.000594562109
  error estimate for blocks of size 2^( 6) =       0.000597978689
  error estimate for blocks of size 2^( 7) =       0.000599092142

      target function =                  N/A
              le_mean =     -22.426962697336
             les_mean =     503.539202049994
             stat err =       0.000594367617
             autocorr =       1.238366580310
              std dev =       0.755345290306
             le_variance =       0.570546507587


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.426983052884        initial  <--
     3.8147e-02     3.8147e-01             2.0875e-02       -22.426966183059
     1.5259e-01     1.5259e+00             5.2056e-03       -22.426959826567
     6.1035e-01     6.1035e+00             1.2968e-03       -22.426962697336

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 71.6422
  </log>
  <optVariables href="FORMP2PJWARM.s016.opt.xml">
 uu_0                 2.775805e-01 1 1  ON 0
 uu_1                 1.053068e-01 1 1  ON 1
 uu_2                -9.227805e-03 1 1  ON 2
 uu_3                -7.553533e-02 1 1  ON 3
 uu_4                -1.153919e-01 1 1  ON 4
 uu_5                -1.377780e-01 1 1  ON 5
 uu_6                -1.461559e-01 1 1  ON 6
 uu_7                -1.401569e-01 1 1  ON 7
 uu_8                -1.044483e-01 1 1  ON 8
 uu_9                -2.577850e-02 1 1  ON 9
 ud_0                 4.289607e-01 1 1  ON 10
 ud_1                 1.474507e-01 1 1  ON 11
 ud_2                 2.465699e-03 1 1  ON 12
 ud_3                -7.514382e-02 1 1  ON 13
 ud_4                -1.204166e-01 1 1  ON 14
 ud_5                -1.482501e-01 1 1  ON 15
 ud_6                -1.603028e-01 1 1  ON 16
 ud_7                -1.584795e-01 1 1  ON 17
 ud_8                -1.288370e-01 1 1  ON 18
 ud_9                -6.344165e-02 1 1  ON 19
 eC_0                -5.648134e-01 1 1  ON 20
 eC_1                -4.017139e-01 1 1  ON 21
 eC_2                -1.203429e-01 1 1  ON 22
 eC_3                 7.310003e-02 1 1  ON 23
 eC_4                 1.915582e-01 1 1  ON 24
 eC_5                 3.071546e-01 1 1  ON 25
 eC_6                 2.919018e-01 1 1  ON 26
 eC_7                 1.754154e-01 1 1  ON 27
 eC_8                 3.694224e-02 1 1  ON 28
 eC_9                 8.048019e-03 1 1  ON 29
 eO_0                -1.059647e+00 1 1  ON 30
 eO_1                -6.785956e-01 1 1  ON 31
 eO_2                -1.976474e-01 1 1  ON 32
 eO_3                 1.079194e-01 1 1  ON 33
 eO_4                 3.138243e-01 1 1  ON 34
 eO_5                 4.320995e-01 1 1  ON 35
 eO_6                 4.293029e-01 1 1  ON 36
 eO_7                 3.815074e-01 1 1  ON 37
 eO_8                 1.776600e-01 1 1  ON 38
 eO_9                 6.076871e-02 1 1  ON 39
eH1_0                -1.600352e-01 1 1  ON 40
eH1_1                -5.794384e-02 1 1  ON 41
eH1_2                -3.097150e-02 1 1  ON 42
eH1_3                -2.953897e-02 1 1  ON 43
eH1_4                 1.354847e-02 1 1  ON 44
eH1_5                 2.776140e-02 1 1  ON 45
eH1_6                 4.474529e-02 1 1  ON 46
eH1_7                 3.419119e-02 1 1  ON 47
eH1_8                 6.863862e-02 1 1  ON 48
eH1_9                 7.020420e-02 1 1  ON 49
eH2_0                -1.497360e-01 1 1  ON 50
eH2_1                -5.259379e-02 1 1  ON 51
eH2_2                -3.075375e-02 1 1  ON 52
eH2_3                -3.019974e-02 1 1  ON 53
eH2_4                 1.153707e-02 1 1  ON 54
eH2_5                 2.770483e-02 1 1  ON 55
eH2_6                 4.924288e-02 1 1  ON 56
eH2_7                 2.226450e-02 1 1  ON 57
eH2_8                 6.015241e-02 1 1  ON 58
eH2_9                 6.815827e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.3792e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORMP2PJWARM.s017 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORMP2PJWARM.s017 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=17  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2379e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 30888 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 17
    time step          = 0.05
    reference energy   = -22.4559
    reference variance = 0.319015
====================================================
  Execution time = 4.9131e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORMP2PJWARM.s017
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2426e+01
  VMC Evar = 5.8115e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.6006e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.581292206668
                                         uncertainty =       0.004920185571

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.581292206668
                                         uncertainty =       0.004920185571

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000539050583
  error estimate for blocks of size 2^( 2) =       0.000558947012
  error estimate for blocks of size 2^( 3) =       0.000578317671
  error estimate for blocks of size 2^( 4) =       0.000591940702
  error estimate for blocks of size 2^( 5) =       0.000601996162
  error estimate for blocks of size 2^( 6) =       0.000609581018
  error estimate for blocks of size 2^( 7) =       0.000617819181

      target function =                  N/A
              le_mean =     -22.426091440405
             les_mean =     503.510728063942
             stat err =       0.000605334266
             autocorr =       1.261047592940
              std dev =       0.762332644646
             le_variance =       0.581151061092


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.242609144041e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.8147e-01, overlap shift 3.8147e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.426091440405       residual = 8.22e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.426098753788       residual = 5.91e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.426102977681       residual = 4.60e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.426110091805       residual = 3.88e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.426117859634       residual = 1.26e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.426122294378       residual = 8.86e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.426121388764       residual = 6.94e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.426122527905       residual = 2.57e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.426123312554       residual = 1.92e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.426122894262       residual = 4.91e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -22.426122449794       residual = 2.95e-07           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -22.426122958761       residual = 1.07e-07           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -22.426122806565       residual = 3.00e-08           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -22.426122948582       residual = 1.43e-08           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -22.426122932017       residual = 3.16e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         14 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 3.8147e-01 is 2.169379e-03

solving harmonic davidson linear method for identity shift 1.5259e+00, overlap shift 1.5259e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.426091440405       residual = 8.22e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.426094158929       residual = 7.38e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.426095802352       residual = 5.67e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.426097386587       residual = 3.25e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.426100022338       residual = 1.85e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.426102426568       residual = 6.58e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.426102245898       residual = 3.19e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.426102253689       residual = 1.54e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.426102592404       residual = 7.65e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.426102466927       residual = 1.21e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -22.426102417997       residual = 4.10e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -22.426102439274       residual = 1.87e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -22.426102404560       residual = 6.91e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         12 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.5259e+00 is 5.542477e-04

solving harmonic davidson linear method for identity shift 6.1035e+00, overlap shift 6.1035e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.426091440405       residual = 8.22e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.426092214225       residual = 8.22e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.426092712523       residual = 6.62e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.426093118123       residual = 3.10e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.426093769259       residual = 1.97e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.426094560044       residual = 6.29e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.426094560896       residual = 2.36e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.426094539164       residual = 1.18e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.426094617559       residual = 5.16e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.426094583547       residual = 6.98e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -22.426094585123       residual = 2.24e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -22.426094578735       residual = 6.41e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 6.1035e+00 is 1.509344e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.280556 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 6.5147e+01
  </log>
  <optVariables href="FORMP2PJWARM.s017.opt.xml">
 uu_0                 2.777634e-01 1 1  ON 0
 uu_1                 1.050143e-01 1 1  ON 1
 uu_2                -9.180266e-03 1 1  ON 2
 uu_3                -7.568491e-02 1 1  ON 3
 uu_4                -1.152803e-01 1 1  ON 4
 uu_5                -1.377709e-01 1 1  ON 5
 uu_6                -1.462175e-01 1 1  ON 6
 uu_7                -1.401092e-01 1 1  ON 7
 uu_8                -1.046790e-01 1 1  ON 8
 uu_9                -2.591962e-02 1 1  ON 9
 ud_0                 4.288316e-01 1 1  ON 10
 ud_1                 1.473339e-01 1 1  ON 11
 ud_2                 2.586474e-03 1 1  ON 12
 ud_3                -7.526443e-02 1 1  ON 13
 ud_4                -1.203218e-01 1 1  ON 14
 ud_5                -1.481026e-01 1 1  ON 15
 ud_6                -1.605657e-01 1 1  ON 16
 ud_7                -1.584921e-01 1 1  ON 17
 ud_8                -1.289230e-01 1 1  ON 18
 ud_9                -6.343719e-02 1 1  ON 19
 eC_0                -5.646842e-01 1 1  ON 20
 eC_1                -4.016512e-01 1 1  ON 21
 eC_2                -1.205593e-01 1 1  ON 22
 eC_3                 7.306992e-02 1 1  ON 23
 eC_4                 1.913985e-01 1 1  ON 24
 eC_5                 3.068840e-01 1 1  ON 25
 eC_6                 2.917887e-01 1 1  ON 26
 eC_7                 1.758127e-01 1 1  ON 27
 eC_8                 3.711872e-02 1 1  ON 28
 eC_9                 8.068313e-03 1 1  ON 29
 eO_0                -1.059470e+00 1 1  ON 30
 eO_1                -6.785201e-01 1 1  ON 31
 eO_2                -1.978279e-01 1 1  ON 32
 eO_3                 1.079926e-01 1 1  ON 33
 eO_4                 3.132700e-01 1 1  ON 34
 eO_5                 4.320004e-01 1 1  ON 35
 eO_6                 4.289511e-01 1 1  ON 36
 eO_7                 3.814994e-01 1 1  ON 37
 eO_8                 1.782036e-01 1 1  ON 38
 eO_9                 6.101929e-02 1 1  ON 39
eH1_0                -1.598085e-01 1 1  ON 40
eH1_1                -5.780710e-02 1 1  ON 41
eH1_2                -3.117610e-02 1 1  ON 42
eH1_3                -2.960052e-02 1 1  ON 43
eH1_4                 1.340060e-02 1 1  ON 44
eH1_5                 2.762455e-02 1 1  ON 45
eH1_6                 4.508965e-02 1 1  ON 46
eH1_7                 3.409190e-02 1 1  ON 47
eH1_8                 6.838611e-02 1 1  ON 48
eH1_9                 7.032345e-02 1 1  ON 49
eH2_0                -1.499668e-01 1 1  ON 50
eH2_1                -5.270477e-02 1 1  ON 51
eH2_2                -3.072872e-02 1 1  ON 52
eH2_3                -3.018688e-02 1 1  ON 53
eH2_4                 1.178988e-02 1 1  ON 54
eH2_5                 2.753373e-02 1 1  ON 55
eH2_6                 4.922577e-02 1 1  ON 56
eH2_7                 2.251521e-02 1 1  ON 57
eH2_8                 5.994763e-02 1 1  ON 58
eH2_9                 6.827502e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 17
    time step          = 0.05
    reference energy   = -22.3712
    reference variance = 0.97396
====================================================
  Execution time = 4.8570e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORMP2PJWARM.s017
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2425e+01
  VMC Evar = 5.7991e-01
  Total weights = 2.0000e+06
  Execution time = 4.6651e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.579963803733
                                         uncertainty =       0.005136713293

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.579963803733
                                         uncertainty =       0.005136713293

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000538670577
  error estimate for blocks of size 2^( 2) =       0.000558484844
  error estimate for blocks of size 2^( 3) =       0.000576555500
  error estimate for blocks of size 2^( 4) =       0.000590036925
  error estimate for blocks of size 2^( 5) =       0.000597895123
  error estimate for blocks of size 2^( 6) =       0.000601416115
  error estimate for blocks of size 2^( 7) =       0.000604331172

      target function =                  N/A
              le_mean =     -22.425356989380
             les_mean =     503.476967792809
             stat err =       0.000598419834
             autocorr =       1.234142898937
              std dev =       0.761795236152
             le_variance =       0.580331981823

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.578901530846
                                         uncertainty =       0.005122728091

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.578901530846
                                         uncertainty =       0.005122728091

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000538175422
  error estimate for blocks of size 2^( 2) =       0.000558003317
  error estimate for blocks of size 2^( 3) =       0.000576097469
  error estimate for blocks of size 2^( 4) =       0.000589589278
  error estimate for blocks of size 2^( 5) =       0.000597463062
  error estimate for blocks of size 2^( 6) =       0.000601009072
  error estimate for blocks of size 2^( 7) =       0.000603945502

      target function =                  N/A
              le_mean =     -22.425351223628
             les_mean =     503.475642783250
             stat err =       0.000598001728
             autocorr =       1.234687804135
              std dev =       0.761094980819
             le_variance =       0.579265569827

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.579149257340
                                         uncertainty =       0.005125761755

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.579149257340
                                         uncertainty =       0.005125761755

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000538290631
  error estimate for blocks of size 2^( 2) =       0.000558118874
  error estimate for blocks of size 2^( 3) =       0.000576210110
  error estimate for blocks of size 2^( 4) =       0.000589701678
  error estimate for blocks of size 2^( 5) =       0.000597570106
  error estimate for blocks of size 2^( 6) =       0.000601114538
  error estimate for blocks of size 2^( 7) =       0.000604042717

      target function =                  N/A
              le_mean =     -22.425350472322
             les_mean =     503.475857123075
             stat err =       0.000598107260
             autocorr =       1.234594978575
              std dev =       0.761257910539
             le_variance =       0.579513606359

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.579837276498
                                         uncertainty =       0.005135050928

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.579837276498
                                         uncertainty =       0.005135050928

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000538611567
  error estimate for blocks of size 2^( 2) =       0.000558428071
  error estimate for blocks of size 2^( 3) =       0.000576501944
  error estimate for blocks of size 2^( 4) =       0.000589985049
  error estimate for blocks of size 2^( 5) =       0.000597844587
  error estimate for blocks of size 2^( 6) =       0.000601369343
  error estimate for blocks of size 2^( 7) =       0.000604286098

      target function =                  N/A
              le_mean =     -22.425355346672
             les_mean =     503.476766975463
             stat err =       0.000598371269
             autocorr =       1.234212990728
              std dev =       0.761711783455
             le_variance =       0.580204841055


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.425356989380        initial  <--
     3.8147e-01     3.8147e+00             2.1694e-03       -22.425351223628
     1.5259e+00     1.5259e+01             5.5425e-04       -22.425350472322
     6.1035e+00     6.1035e+01             1.5093e-04       -22.425355346672

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 71.8907
  </log>
  <optVariables href="FORMP2PJWARM.s017.opt.xml">
 uu_0                 2.775805e-01 1 1  ON 0
 uu_1                 1.053068e-01 1 1  ON 1
 uu_2                -9.227805e-03 1 1  ON 2
 uu_3                -7.553533e-02 1 1  ON 3
 uu_4                -1.153919e-01 1 1  ON 4
 uu_5                -1.377780e-01 1 1  ON 5
 uu_6                -1.461559e-01 1 1  ON 6
 uu_7                -1.401569e-01 1 1  ON 7
 uu_8                -1.044483e-01 1 1  ON 8
 uu_9                -2.577850e-02 1 1  ON 9
 ud_0                 4.289607e-01 1 1  ON 10
 ud_1                 1.474507e-01 1 1  ON 11
 ud_2                 2.465699e-03 1 1  ON 12
 ud_3                -7.514382e-02 1 1  ON 13
 ud_4                -1.204166e-01 1 1  ON 14
 ud_5                -1.482501e-01 1 1  ON 15
 ud_6                -1.603028e-01 1 1  ON 16
 ud_7                -1.584795e-01 1 1  ON 17
 ud_8                -1.288370e-01 1 1  ON 18
 ud_9                -6.344165e-02 1 1  ON 19
 eC_0                -5.648134e-01 1 1  ON 20
 eC_1                -4.017139e-01 1 1  ON 21
 eC_2                -1.203429e-01 1 1  ON 22
 eC_3                 7.310003e-02 1 1  ON 23
 eC_4                 1.915582e-01 1 1  ON 24
 eC_5                 3.071546e-01 1 1  ON 25
 eC_6                 2.919018e-01 1 1  ON 26
 eC_7                 1.754154e-01 1 1  ON 27
 eC_8                 3.694224e-02 1 1  ON 28
 eC_9                 8.048019e-03 1 1  ON 29
 eO_0                -1.059647e+00 1 1  ON 30
 eO_1                -6.785956e-01 1 1  ON 31
 eO_2                -1.976474e-01 1 1  ON 32
 eO_3                 1.079194e-01 1 1  ON 33
 eO_4                 3.138243e-01 1 1  ON 34
 eO_5                 4.320995e-01 1 1  ON 35
 eO_6                 4.293029e-01 1 1  ON 36
 eO_7                 3.815074e-01 1 1  ON 37
 eO_8                 1.776600e-01 1 1  ON 38
 eO_9                 6.076871e-02 1 1  ON 39
eH1_0                -1.600352e-01 1 1  ON 40
eH1_1                -5.794384e-02 1 1  ON 41
eH1_2                -3.097150e-02 1 1  ON 42
eH1_3                -2.953897e-02 1 1  ON 43
eH1_4                 1.354847e-02 1 1  ON 44
eH1_5                 2.776140e-02 1 1  ON 45
eH1_6                 4.474529e-02 1 1  ON 46
eH1_7                 3.419119e-02 1 1  ON 47
eH1_8                 6.863862e-02 1 1  ON 48
eH1_9                 7.020420e-02 1 1  ON 49
eH2_0                -1.497360e-01 1 1  ON 50
eH2_1                -5.259379e-02 1 1  ON 51
eH2_2                -3.075375e-02 1 1  ON 52
eH2_3                -3.019974e-02 1 1  ON 53
eH2_4                 1.153707e-02 1 1  ON 54
eH2_5                 2.770483e-02 1 1  ON 55
eH2_6                 4.924288e-02 1 1  ON 56
eH2_7                 2.226450e-02 1 1  ON 57
eH2_8                 6.015241e-02 1 1  ON 58
eH2_9                 6.815827e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.3704e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORMP2PJWARM.s018 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORMP2PJWARM.s018 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=18  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2381e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 30888 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 18
    time step          = 0.05
    reference energy   = -22.4824
    reference variance = 0.328858
====================================================
  Execution time = 4.9516e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORMP2PJWARM.s018
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2425e+01
  VMC Evar = 5.7818e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.6028e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.577195074785
                                         uncertainty =       0.005312306957

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.577195074785
                                         uncertainty =       0.005312306957

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000537669683
  error estimate for blocks of size 2^( 2) =       0.000557774207
  error estimate for blocks of size 2^( 3) =       0.000574922728
  error estimate for blocks of size 2^( 4) =       0.000588632982
  error estimate for blocks of size 2^( 5) =       0.000596963242
  error estimate for blocks of size 2^( 6) =       0.000601120742
  error estimate for blocks of size 2^( 7) =       0.000604429323

      target function =                  N/A
              le_mean =     -22.425265688563
             les_mean =     503.470718289834
             stat err =       0.000597786572
             autocorr =       1.236121649218
              std dev =       0.760379757949
             le_variance =       0.578177376299


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.242526568856e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.8147e+00, overlap shift 3.8147e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.425265688563       residual = 8.26e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.425267977972       residual = 1.07e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.425269667144       residual = 6.19e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.425270638733       residual = 2.04e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.425271582538       residual = 1.46e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.425271675360       residual = 6.07e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.425271759885       residual = 2.56e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.425271881001       residual = 1.32e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.425271895365       residual = 6.57e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.425272116304       residual = 6.52e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -22.425272035957       residual = 1.42e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -22.425272036099       residual = 5.33e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 3.8147e+00 is 2.081643e-04

solving harmonic davidson linear method for identity shift 1.5259e+01, overlap shift 1.5259e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.425265688563       residual = 8.26e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.425266287885       residual = 1.12e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.425266750464       residual = 6.79e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.425267026916       residual = 1.99e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.425267286034       residual = 1.50e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.425267327277       residual = 5.82e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.425267351924       residual = 2.31e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.425267369682       residual = 1.12e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.425267372901       residual = 5.72e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.425267428161       residual = 4.65e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -22.425267412002       residual = 1.12e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -22.425267409368       residual = 4.95e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.5259e+01 is 5.207945e-05

solving harmonic davidson linear method for identity shift 6.1035e+01, overlap shift 6.1035e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.425265688563       residual = 8.26e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.425265840179       residual = 1.13e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.425265958642       residual = 6.97e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.425266030246       residual = 1.98e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.425266096676       residual = 1.52e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.425266108423       residual = 5.75e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.425266115062       residual = 2.25e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.425266118691       residual = 1.07e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.425266119366       residual = 5.51e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.425266133123       residual = 4.19e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -22.425266129435       residual = 1.06e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -22.425266128636       residual = 4.80e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 6.1035e+01 is 1.302129e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.285491 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 6.5553e+01
  </log>
  <optVariables href="FORMP2PJWARM.s018.opt.xml">
 uu_0                 2.775973e-01 1 1  ON 0
 uu_1                 1.052820e-01 1 1  ON 1
 uu_2                -9.217776e-03 1 1  ON 2
 uu_3                -7.555647e-02 1 1  ON 3
 uu_4                -1.153841e-01 1 1  ON 4
 uu_5                -1.377720e-01 1 1  ON 5
 uu_6                -1.461663e-01 1 1  ON 6
 uu_7                -1.401485e-01 1 1  ON 7
 uu_8                -1.044768e-01 1 1  ON 8
 uu_9                -2.579116e-02 1 1  ON 9
 ud_0                 4.289501e-01 1 1  ON 10
 ud_1                 1.474321e-01 1 1  ON 11
 ud_2                 2.480246e-03 1 1  ON 12
 ud_3                -7.515929e-02 1 1  ON 13
 ud_4                -1.204010e-01 1 1  ON 14
 ud_5                -1.482259e-01 1 1  ON 15
 ud_6                -1.603328e-01 1 1  ON 16
 ud_7                -1.584742e-01 1 1  ON 17
 ud_8                -1.288464e-01 1 1  ON 18
 ud_9                -6.344281e-02 1 1  ON 19
 eC_0                -5.648037e-01 1 1  ON 20
 eC_1                -4.016991e-01 1 1  ON 21
 eC_2                -1.203644e-01 1 1  ON 22
 eC_3                 7.309389e-02 1 1  ON 23
 eC_4                 1.915395e-01 1 1  ON 24
 eC_5                 3.071277e-01 1 1  ON 25
 eC_6                 2.918869e-01 1 1  ON 26
 eC_7                 1.754567e-01 1 1  ON 27
 eC_8                 3.696134e-02 1 1  ON 28
 eC_9                 8.050926e-03 1 1  ON 29
 eO_0                -1.059630e+00 1 1  ON 30
 eO_1                -6.785938e-01 1 1  ON 31
 eO_2                -1.976583e-01 1 1  ON 32
 eO_3                 1.079354e-01 1 1  ON 33
 eO_4                 3.137737e-01 1 1  ON 34
 eO_5                 4.320744e-01 1 1  ON 35
 eO_6                 4.292759e-01 1 1  ON 36
 eO_7                 3.815068e-01 1 1  ON 37
 eO_8                 1.777121e-01 1 1  ON 38
 eO_9                 6.079111e-02 1 1  ON 39
eH1_0                -1.600119e-01 1 1  ON 40
eH1_1                -5.792684e-02 1 1  ON 41
eH1_2                -3.099608e-02 1 1  ON 42
eH1_3                -2.954278e-02 1 1  ON 43
eH1_4                 1.353187e-02 1 1  ON 44
eH1_5                 2.774793e-02 1 1  ON 45
eH1_6                 4.477849e-02 1 1  ON 46
eH1_7                 3.417577e-02 1 1  ON 47
eH1_8                 6.861653e-02 1 1  ON 48
eH1_9                 7.021804e-02 1 1  ON 49
eH2_0                -1.497597e-01 1 1  ON 50
eH2_1                -5.260312e-02 1 1  ON 51
eH2_2                -3.075185e-02 1 1  ON 52
eH2_3                -3.019480e-02 1 1  ON 53
eH2_4                 1.155840e-02 1 1  ON 54
eH2_5                 2.768690e-02 1 1  ON 55
eH2_6                 4.922839e-02 1 1  ON 56
eH2_7                 2.229538e-02 1 1  ON 57
eH2_8                 6.013388e-02 1 1  ON 58
eH2_9                 6.817257e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 18
    time step          = 0.05
    reference energy   = -22.3991
    reference variance = 0.589784
====================================================
  Execution time = 5.0635e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORMP2PJWARM.s018
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2426e+01
  VMC Evar = 5.7143e-01
  Total weights = 2.0000e+06
  Execution time = 4.6338e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.571438775713
                                         uncertainty =       0.003739686548

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.571438775713
                                         uncertainty =       0.003739686548

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000534541388
  error estimate for blocks of size 2^( 2) =       0.000555416242
  error estimate for blocks of size 2^( 3) =       0.000573772259
  error estimate for blocks of size 2^( 4) =       0.000587686088
  error estimate for blocks of size 2^( 5) =       0.000595658559
  error estimate for blocks of size 2^( 6) =       0.000599707915
  error estimate for blocks of size 2^( 7) =       0.000602549346

      target function =                  N/A
              le_mean =     -22.425771216386
             les_mean =     503.486683354344
             stat err =       0.000596400477
             autocorr =       1.244839299428
              std dev =       0.755955680190
             le_variance =       0.571468990411

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.571280621560
                                         uncertainty =       0.003738125374

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.571280621560
                                         uncertainty =       0.003738125374

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000534467287
  error estimate for blocks of size 2^( 2) =       0.000555343049
  error estimate for blocks of size 2^( 3) =       0.000573702204
  error estimate for blocks of size 2^( 4) =       0.000587615925
  error estimate for blocks of size 2^( 5) =       0.000595590240
  error estimate for blocks of size 2^( 6) =       0.000599639151
  error estimate for blocks of size 2^( 7) =       0.000602478518

      target function =                  N/A
              le_mean =     -22.425770550180
             les_mean =     503.486495045259
             stat err =       0.000596330959
             autocorr =       1.244894234783
              std dev =       0.755850885819
             le_variance =       0.571310561594

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.571352867088
                                         uncertainty =       0.003738831309

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.571352867088
                                         uncertainty =       0.003738831309

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000534501138
  error estimate for blocks of size 2^( 2) =       0.000555376577
  error estimate for blocks of size 2^( 3) =       0.000573734348
  error estimate for blocks of size 2^( 4) =       0.000587648167
  error estimate for blocks of size 2^( 5) =       0.000595621685
  error estimate for blocks of size 2^( 6) =       0.000599670869
  error estimate for blocks of size 2^( 7) =       0.000602511102

      target function =                  N/A
              le_mean =     -22.425770757564
             les_mean =     503.486576717150
             stat err =       0.000596362956
             autocorr =       1.244870139376
              std dev =       0.755898757790
             le_variance =       0.571382932028

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.571427737325
                                         uncertainty =       0.003739576926

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.571427737325
                                         uncertainty =       0.003739576926

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000534536216
  error estimate for blocks of size 2^( 2) =       0.000555411148
  error estimate for blocks of size 2^( 3) =       0.000573767391
  error estimate for blocks of size 2^( 4) =       0.000587681221
  error estimate for blocks of size 2^( 5) =       0.000595653827
  error estimate for blocks of size 2^( 6) =       0.000599703163
  error estimate for blocks of size 2^( 7) =       0.000602544438

      target function =                  N/A
              le_mean =     -22.425771148530
             les_mean =     503.486669253370
             stat err =       0.000596395662
             autocorr =       1.244843288291
              std dev =       0.755948366529
             le_variance =       0.571457932858


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.425771216386        initial  <--
     3.8147e+00     3.8147e+01             2.0816e-04       -22.425770550180
     1.5259e+01     1.5259e+02             5.2079e-05       -22.425770757564
     6.1035e+01     6.1035e+02             1.3021e-05       -22.425771148530

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 73.8135
  </log>
  <optVariables href="FORMP2PJWARM.s018.opt.xml">
 uu_0                 2.775805e-01 1 1  ON 0
 uu_1                 1.053068e-01 1 1  ON 1
 uu_2                -9.227805e-03 1 1  ON 2
 uu_3                -7.553533e-02 1 1  ON 3
 uu_4                -1.153919e-01 1 1  ON 4
 uu_5                -1.377780e-01 1 1  ON 5
 uu_6                -1.461559e-01 1 1  ON 6
 uu_7                -1.401569e-01 1 1  ON 7
 uu_8                -1.044483e-01 1 1  ON 8
 uu_9                -2.577850e-02 1 1  ON 9
 ud_0                 4.289607e-01 1 1  ON 10
 ud_1                 1.474507e-01 1 1  ON 11
 ud_2                 2.465699e-03 1 1  ON 12
 ud_3                -7.514382e-02 1 1  ON 13
 ud_4                -1.204166e-01 1 1  ON 14
 ud_5                -1.482501e-01 1 1  ON 15
 ud_6                -1.603028e-01 1 1  ON 16
 ud_7                -1.584795e-01 1 1  ON 17
 ud_8                -1.288370e-01 1 1  ON 18
 ud_9                -6.344165e-02 1 1  ON 19
 eC_0                -5.648134e-01 1 1  ON 20
 eC_1                -4.017139e-01 1 1  ON 21
 eC_2                -1.203429e-01 1 1  ON 22
 eC_3                 7.310003e-02 1 1  ON 23
 eC_4                 1.915582e-01 1 1  ON 24
 eC_5                 3.071546e-01 1 1  ON 25
 eC_6                 2.919018e-01 1 1  ON 26
 eC_7                 1.754154e-01 1 1  ON 27
 eC_8                 3.694224e-02 1 1  ON 28
 eC_9                 8.048019e-03 1 1  ON 29
 eO_0                -1.059647e+00 1 1  ON 30
 eO_1                -6.785956e-01 1 1  ON 31
 eO_2                -1.976474e-01 1 1  ON 32
 eO_3                 1.079194e-01 1 1  ON 33
 eO_4                 3.138243e-01 1 1  ON 34
 eO_5                 4.320995e-01 1 1  ON 35
 eO_6                 4.293029e-01 1 1  ON 36
 eO_7                 3.815074e-01 1 1  ON 37
 eO_8                 1.776600e-01 1 1  ON 38
 eO_9                 6.076871e-02 1 1  ON 39
eH1_0                -1.600352e-01 1 1  ON 40
eH1_1                -5.794384e-02 1 1  ON 41
eH1_2                -3.097150e-02 1 1  ON 42
eH1_3                -2.953897e-02 1 1  ON 43
eH1_4                 1.354847e-02 1 1  ON 44
eH1_5                 2.776140e-02 1 1  ON 45
eH1_6                 4.474529e-02 1 1  ON 46
eH1_7                 3.419119e-02 1 1  ON 47
eH1_8                 6.863862e-02 1 1  ON 48
eH1_9                 7.020420e-02 1 1  ON 49
eH2_0                -1.497360e-01 1 1  ON 50
eH2_1                -5.259379e-02 1 1  ON 51
eH2_2                -3.075375e-02 1 1  ON 52
eH2_3                -3.019974e-02 1 1  ON 53
eH2_4                 1.153707e-02 1 1  ON 54
eH2_5                 2.770483e-02 1 1  ON 55
eH2_6                 4.924288e-02 1 1  ON 56
eH2_7                 2.226450e-02 1 1  ON 57
eH2_8                 6.015241e-02 1 1  ON 58
eH2_9                 6.815827e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.3937e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORMP2PJWARM.s019 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORMP2PJWARM.s019 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=19  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2384e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 30888 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 19
    time step          = 0.05
    reference energy   = -22.3309
    reference variance = 0.371196
====================================================
  Execution time = 4.9541e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORMP2PJWARM.s019
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2427e+01
  VMC Evar = 5.9915e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.5885e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.599304948230
                                         uncertainty =       0.028686089334

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.599304948230
                                         uncertainty =       0.028686089334

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000547333792
  error estimate for blocks of size 2^( 2) =       0.000567422440
  error estimate for blocks of size 2^( 3) =       0.000585949352
  error estimate for blocks of size 2^( 4) =       0.000599822787
  error estimate for blocks of size 2^( 5) =       0.000609585404
  error estimate for blocks of size 2^( 6) =       0.000615037281
  error estimate for blocks of size 2^( 7) =       0.000616266976

      target function =                  N/A
              le_mean =     -22.427375025560
             les_mean =     503.586298796209
             stat err =       0.000610178112
             autocorr =       1.242821410843
              std dev =       0.774046871095
             le_variance =       0.599148558652


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.242737502556e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.8147e+01, overlap shift 3.8147e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.427375025560       residual = 1.01e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.427375182026       residual = 1.71e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.427375182500       residual = 4.55e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.427375226309       residual = 2.82e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.427375276009       residual = 2.05e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.427375319252       residual = 7.04e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.427375355235       residual = 2.66e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.427375363623       residual = 9.71e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.427375376554       residual = 6.11e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.427375381180       residual = 6.06e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -22.427375379352       residual = 3.34e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -22.427375380261       residual = 1.21e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -22.427375381037       residual = 2.87e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         12 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 3.8147e+01 is 2.203661e-05

solving harmonic davidson linear method for identity shift 1.5259e+02, overlap shift 1.5259e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.427375025560       residual = 1.01e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.427375064918       residual = 1.73e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.427375065101       residual = 4.59e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.427375076103       residual = 2.83e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.427375088506       residual = 2.07e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.427375099440       residual = 7.00e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.427375108492       residual = 2.64e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.427375110569       residual = 9.54e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.427375113847       residual = 5.99e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.427375114981       residual = 5.90e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -22.427375114517       residual = 3.27e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -22.427375114743       residual = 1.18e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -22.427375114940       residual = 2.80e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         12 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.5259e+02 is 5.509448e-06

solving harmonic davidson linear method for identity shift 6.1035e+02, overlap shift 6.1035e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.427375025560       residual = 1.01e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.427375035415       residual = 1.73e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.427375035465       residual = 4.60e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.427375038218       residual = 2.83e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.427375041318       residual = 2.07e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.427375044059       residual = 6.99e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.427375046327       residual = 2.64e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.427375046844       residual = 9.50e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.427375047665       residual = 5.97e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.427375047948       residual = 5.86e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -22.427375047832       residual = 3.26e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -22.427375047890       residual = 1.17e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -22.427375047938       residual = 2.78e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         12 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 6.1035e+02 is 1.377381e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.291250 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 6.5435e+01
  </log>
  <optVariables href="FORMP2PJWARM.s019.opt.xml">
 uu_0                 2.775817e-01 1 1  ON 0
 uu_1                 1.053023e-01 1 1  ON 1
 uu_2                -9.225945e-03 1 1  ON 2
 uu_3                -7.553815e-02 1 1  ON 3
 uu_4                -1.153902e-01 1 1  ON 4
 uu_5                -1.377776e-01 1 1  ON 5
 uu_6                -1.461572e-01 1 1  ON 6
 uu_7                -1.401552e-01 1 1  ON 7
 uu_8                -1.044509e-01 1 1  ON 8
 uu_9                -2.577973e-02 1 1  ON 9
 ud_0                 4.289597e-01 1 1  ON 10
 ud_1                 1.474497e-01 1 1  ON 11
 ud_2                 2.467614e-03 1 1  ON 12
 ud_3                -7.514619e-02 1 1  ON 13
 ud_4                -1.204160e-01 1 1  ON 14
 ud_5                -1.482480e-01 1 1  ON 15
 ud_6                -1.603055e-01 1 1  ON 16
 ud_7                -1.584804e-01 1 1  ON 17
 ud_8                -1.288383e-01 1 1  ON 18
 ud_9                -6.344105e-02 1 1  ON 19
 eC_0                -5.648124e-01 1 1  ON 20
 eC_1                -4.017130e-01 1 1  ON 21
 eC_2                -1.203450e-01 1 1  ON 22
 eC_3                 7.309933e-02 1 1  ON 23
 eC_4                 1.915564e-01 1 1  ON 24
 eC_5                 3.071525e-01 1 1  ON 25
 eC_6                 2.919001e-01 1 1  ON 26
 eC_7                 1.754196e-01 1 1  ON 27
 eC_8                 3.694433e-02 1 1  ON 28
 eC_9                 8.048243e-03 1 1  ON 29
 eO_0                -1.059646e+00 1 1  ON 30
 eO_1                -6.785953e-01 1 1  ON 31
 eO_2                -1.976499e-01 1 1  ON 32
 eO_3                 1.079215e-01 1 1  ON 33
 eO_4                 3.138199e-01 1 1  ON 34
 eO_5                 4.320982e-01 1 1  ON 35
 eO_6                 4.292990e-01 1 1  ON 36
 eO_7                 3.815072e-01 1 1  ON 37
 eO_8                 1.776655e-01 1 1  ON 38
 eO_9                 6.077132e-02 1 1  ON 39
eH1_0                -1.600336e-01 1 1  ON 40
eH1_1                -5.794168e-02 1 1  ON 41
eH1_2                -3.097362e-02 1 1  ON 42
eH1_3                -2.953956e-02 1 1  ON 43
eH1_4                 1.354693e-02 1 1  ON 44
eH1_5                 2.775912e-02 1 1  ON 45
eH1_6                 4.474940e-02 1 1  ON 46
eH1_7                 3.419008e-02 1 1  ON 47
eH1_8                 6.863601e-02 1 1  ON 48
eH1_9                 7.020564e-02 1 1  ON 49
eH2_0                -1.497379e-01 1 1  ON 50
eH2_1                -5.259484e-02 1 1  ON 51
eH2_2                -3.075349e-02 1 1  ON 52
eH2_3                -3.019992e-02 1 1  ON 53
eH2_4                 1.153982e-02 1 1  ON 54
eH2_5                 2.770243e-02 1 1  ON 55
eH2_6                 4.924170e-02 1 1  ON 56
eH2_7                 2.226827e-02 1 1  ON 57
eH2_8                 6.015048e-02 1 1  ON 58
eH2_9                 6.815949e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 19
    time step          = 0.05
    reference energy   = -22.4029
    reference variance = 0.356072
====================================================
  Execution time = 4.8653e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORMP2PJWARM.s019
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2426e+01
  VMC Evar = 5.7341e-01
  Total weights = 2.0000e+06
  Execution time = 4.6623e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.573532098829
                                         uncertainty =       0.004829367835

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.573532098829
                                         uncertainty =       0.004829367835

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000535451455
  error estimate for blocks of size 2^( 2) =       0.000555529228
  error estimate for blocks of size 2^( 3) =       0.000574094021
  error estimate for blocks of size 2^( 4) =       0.000589067324
  error estimate for blocks of size 2^( 5) =       0.000596346105
  error estimate for blocks of size 2^( 6) =       0.000602315294
  error estimate for blocks of size 2^( 7) =       0.000605455886

      target function =                  N/A
              le_mean =     -22.425840793244
             les_mean =     503.491751518531
             stat err =       0.000598296152
             autocorr =       1.248510541073
              std dev =       0.757242709654
             le_variance =       0.573416521325

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.573511050606
                                         uncertainty =       0.004829331595

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.573511050606
                                         uncertainty =       0.004829331595

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000535441635
  error estimate for blocks of size 2^( 2) =       0.000555519918
  error estimate for blocks of size 2^( 3) =       0.000574085074
  error estimate for blocks of size 2^( 4) =       0.000589058670
  error estimate for blocks of size 2^( 5) =       0.000596337101
  error estimate for blocks of size 2^( 6) =       0.000602306846
  error estimate for blocks of size 2^( 7) =       0.000605447987

      target function =                  N/A
              le_mean =     -22.425840763549
             les_mean =     503.491729154616
             stat err =       0.000598287651
             autocorr =       1.248520855803
              std dev =       0.757228822254
             le_variance =       0.573395489253

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.573521447786
                                         uncertainty =       0.004829349438

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.573521447786
                                         uncertainty =       0.004829349438

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000535446486
  error estimate for blocks of size 2^( 2) =       0.000555524518
  error estimate for blocks of size 2^( 3) =       0.000574089496
  error estimate for blocks of size 2^( 4) =       0.000589062948
  error estimate for blocks of size 2^( 5) =       0.000596341550
  error estimate for blocks of size 2^( 6) =       0.000602311023
  error estimate for blocks of size 2^( 7) =       0.000605451895

      target function =                  N/A
              le_mean =     -22.425840777483
             les_mean =     503.491740168752
             stat err =       0.000598291854
             autocorr =       1.248515775910
              std dev =       0.757235682228
             le_variance =       0.573405878439

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.573530762573
                                         uncertainty =       0.004829365526

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.573530762573
                                         uncertainty =       0.004829365526

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000535450832
  error estimate for blocks of size 2^( 2) =       0.000555528637
  error estimate for blocks of size 2^( 3) =       0.000574093453
  error estimate for blocks of size 2^( 4) =       0.000589066775
  error estimate for blocks of size 2^( 5) =       0.000596345533
  error estimate for blocks of size 2^( 6) =       0.000602314758
  error estimate for blocks of size 2^( 7) =       0.000605455385

      target function =                  N/A
              le_mean =     -22.425840791162
             les_mean =     503.491750089920
             stat err =       0.000598295613
             autocorr =       1.248511198055
              std dev =       0.757241828012
             le_variance =       0.573415186091


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.425840793244        initial  <--
     3.8147e+01     3.8147e+02             2.2037e-05       -22.425840763549
     1.5259e+02     1.5259e+03             5.5094e-06       -22.425840777483
     6.1035e+02     6.1035e+03             1.3774e-06       -22.425840791162

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 71.9657
  </log>
  <optVariables href="FORMP2PJWARM.s019.opt.xml">
 uu_0                 2.775805e-01 1 1  ON 0
 uu_1                 1.053068e-01 1 1  ON 1
 uu_2                -9.227805e-03 1 1  ON 2
 uu_3                -7.553533e-02 1 1  ON 3
 uu_4                -1.153919e-01 1 1  ON 4
 uu_5                -1.377780e-01 1 1  ON 5
 uu_6                -1.461559e-01 1 1  ON 6
 uu_7                -1.401569e-01 1 1  ON 7
 uu_8                -1.044483e-01 1 1  ON 8
 uu_9                -2.577850e-02 1 1  ON 9
 ud_0                 4.289607e-01 1 1  ON 10
 ud_1                 1.474507e-01 1 1  ON 11
 ud_2                 2.465699e-03 1 1  ON 12
 ud_3                -7.514382e-02 1 1  ON 13
 ud_4                -1.204166e-01 1 1  ON 14
 ud_5                -1.482501e-01 1 1  ON 15
 ud_6                -1.603028e-01 1 1  ON 16
 ud_7                -1.584795e-01 1 1  ON 17
 ud_8                -1.288370e-01 1 1  ON 18
 ud_9                -6.344165e-02 1 1  ON 19
 eC_0                -5.648134e-01 1 1  ON 20
 eC_1                -4.017139e-01 1 1  ON 21
 eC_2                -1.203429e-01 1 1  ON 22
 eC_3                 7.310003e-02 1 1  ON 23
 eC_4                 1.915582e-01 1 1  ON 24
 eC_5                 3.071546e-01 1 1  ON 25
 eC_6                 2.919018e-01 1 1  ON 26
 eC_7                 1.754154e-01 1 1  ON 27
 eC_8                 3.694224e-02 1 1  ON 28
 eC_9                 8.048019e-03 1 1  ON 29
 eO_0                -1.059647e+00 1 1  ON 30
 eO_1                -6.785956e-01 1 1  ON 31
 eO_2                -1.976474e-01 1 1  ON 32
 eO_3                 1.079194e-01 1 1  ON 33
 eO_4                 3.138243e-01 1 1  ON 34
 eO_5                 4.320995e-01 1 1  ON 35
 eO_6                 4.293029e-01 1 1  ON 36
 eO_7                 3.815074e-01 1 1  ON 37
 eO_8                 1.776600e-01 1 1  ON 38
 eO_9                 6.076871e-02 1 1  ON 39
eH1_0                -1.600352e-01 1 1  ON 40
eH1_1                -5.794384e-02 1 1  ON 41
eH1_2                -3.097150e-02 1 1  ON 42
eH1_3                -2.953897e-02 1 1  ON 43
eH1_4                 1.354847e-02 1 1  ON 44
eH1_5                 2.776140e-02 1 1  ON 45
eH1_6                 4.474529e-02 1 1  ON 46
eH1_7                 3.419119e-02 1 1  ON 47
eH1_8                 6.863862e-02 1 1  ON 48
eH1_9                 7.020420e-02 1 1  ON 49
eH2_0                -1.497360e-01 1 1  ON 50
eH2_1                -5.259379e-02 1 1  ON 51
eH2_2                -3.075375e-02 1 1  ON 52
eH2_3                -3.019974e-02 1 1  ON 53
eH2_4                 1.153707e-02 1 1  ON 54
eH2_5                 2.770483e-02 1 1  ON 55
eH2_6                 4.924288e-02 1 1  ON 56
eH2_7                 2.226450e-02 1 1  ON 57
eH2_8                 6.015241e-02 1 1  ON 58
eH2_9                 6.815827e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.3741e+02 secs
  Total Execution time = 2.7572e+03 secs

=========================================================
  A new xml input file : FORMP2PJWARM.s019.cont.xml
