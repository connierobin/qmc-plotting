Rank =    0  Free Memory = 87237 MB
Rank =    1  Free Memory = 87236 MB
Rank =    2  Free Memory = 87235 MB
Rank =    3  Free Memory = 87235 MB
Rank =    4  Free Memory = 87234 MB
Rank =    5  Free Memory = 87234 MB
Rank =    6  Free Memory = 87233 MB
Rank =    7  Free Memory = 87233 MB
Rank =    8  Free Memory = 87233 MB
Rank =    9  Free Memory = 87233 MB
Rank =   10  Free Memory = 87233 MB
Rank =   11  Free Memory = 87233 MB
Rank =   12  Free Memory = 87233 MB
Rank =   13  Free Memory = 87232 MB
Rank =   14  Free Memory = 87222 MB
Rank =   15  Free Memory = 87220 MB
Rank =   16  Free Memory = 87220 MB
Rank =   17  Free Memory = 87220 MB
Rank =   18  Free Memory = 87220 MB
Rank =   19  Free Memory = 87220 MB
Rank =   20  Free Memory = 87220 MB
Rank =   21  Free Memory = 87220 MB
Rank =   22  Free Memory = 87220 MB
Rank =   23  Free Memory = 87220 MB
Rank =   24  Free Memory = 87220 MB
Rank =   25  Free Memory = 87220 MB
Rank =   26  Free Memory = 87220 MB
Rank =   27  Free Memory = 87220 MB
Rank =   28  Free Memory = 87220 MB
Rank =   29  Free Memory = 87220 MB
Rank =   30  Free Memory = 87220 MB
Rank =   31  Free Memory = 87220 MB
Rank =   32  Free Memory = 87713 MB
Rank =   33  Free Memory = 87712 MB
Rank =   34  Free Memory = 87712 MB
Rank =   35  Free Memory = 87712 MB
Rank =   36  Free Memory = 87712 MB
Rank =   37  Free Memory = 87712 MB
Rank =   38  Free Memory = 87712 MB
Rank =   39  Free Memory = 87712 MB
Rank =   40  Free Memory = 87712 MB
Rank =   41  Free Memory = 87712 MB
Rank =   42  Free Memory = 87712 MB
Rank =   43  Free Memory = 87712 MB
Rank =   44  Free Memory = 87712 MB
Rank =   45  Free Memory = 87712 MB
Rank =   46  Free Memory = 87712 MB
Rank =   47  Free Memory = 87712 MB
Rank =   48  Free Memory = 87712 MB
Rank =   49  Free Memory = 87712 MB
Rank =   50  Free Memory = 87712 MB
Rank =   51  Free Memory = 87712 MB
Rank =   52  Free Memory = 87712 MB
Rank =   53  Free Memory = 87712 MB
Rank =   54  Free Memory = 87712 MB
Rank =   55  Free Memory = 87712 MB
Rank =   56  Free Memory = 87712 MB
Rank =   57  Free Memory = 87712 MB
Rank =   58  Free Memory = 87712 MB
Rank =   59  Free Memory = 87712 MB
Rank =   60  Free Memory = 87712 MB
Rank =   61  Free Memory = 87712 MB
Rank =   62  Free Memory = 87712 MB
Rank =   63  Free Memory = 87712 MB
Rank =   64  Free Memory = 87295 MB
Rank =   65  Free Memory = 87295 MB
Rank =   66  Free Memory = 87295 MB
Rank =   67  Free Memory = 87295 MB
Rank =   68  Free Memory = 87295 MB
Rank =   69  Free Memory = 87294 MB
Rank =   70  Free Memory = 87294 MB
Rank =   71  Free Memory = 87294 MB
Rank =   72  Free Memory = 87294 MB
Rank =   73  Free Memory = 87294 MB
Rank =   74  Free Memory = 87294 MB
Rank =   75  Free Memory = 87294 MB
Rank =   76  Free Memory = 87294 MB
Rank =   77  Free Memory = 87294 MB
Rank =   78  Free Memory = 87294 MB
Rank =   79  Free Memory = 87294 MB
Rank =   80  Free Memory = 87294 MB
Rank =   81  Free Memory = 87294 MB
Rank =   82  Free Memory = 87294 MB
Rank =   83  Free Memory = 87294 MB
Rank =   84  Free Memory = 87294 MB
Rank =   85  Free Memory = 87294 MB
Rank =   86  Free Memory = 87294 MB
Rank =   87  Free Memory = 87294 MB
Rank =   88  Free Memory = 87294 MB
Rank =   89  Free Memory = 87294 MB
Rank =   90  Free Memory = 87294 MB
Rank =   91  Free Memory = 87294 MB
Rank =   92  Free Memory = 87294 MB
Rank =   93  Free Memory = 87294 MB
Rank =   94  Free Memory = 87294 MB
Rank =   95  Free Memory = 87294 MB
Rank =   96  Free Memory = 74764 MB
Rank =   97  Free Memory = 74764 MB
Rank =   98  Free Memory = 74764 MB
Rank =   99  Free Memory = 74764 MB
Rank =  100  Free Memory = 74764 MB
Rank =  101  Free Memory = 74764 MB
Rank =  102  Free Memory = 74764 MB
Rank =  103  Free Memory = 74764 MB
Rank =  104  Free Memory = 74764 MB
Rank =  105  Free Memory = 74764 MB
Rank =  106  Free Memory = 74764 MB
Rank =  107  Free Memory = 74764 MB
Rank =  108  Free Memory = 74764 MB
Rank =  109  Free Memory = 74764 MB
Rank =  110  Free Memory = 74764 MB
Rank =  111  Free Memory = 74764 MB
Rank =  112  Free Memory = 74764 MB
Rank =  113  Free Memory = 74764 MB
Rank =  114  Free Memory = 74764 MB
Rank =  115  Free Memory = 74764 MB
Rank =  116  Free Memory = 74764 MB
Rank =  117  Free Memory = 74764 MB
Rank =  118  Free Memory = 74764 MB
Rank =  119  Free Memory = 74764 MB
Rank =  120  Free Memory = 74764 MB
Rank =  121  Free Memory = 74764 MB
Rank =  122  Free Memory = 74764 MB
Rank =  123  Free Memory = 74764 MB
Rank =  124  Free Memory = 74764 MB
Rank =  125  Free Memory = 74764 MB
Rank =  126  Free Memory = 74764 MB
Rank =  127  Free Memory = 74764 MB
  Input file(s): opt_forma_pi2pistar_Jwarm_run001.xml 

=====================================================
                    QMCPACK 3.7.9

       (c) Copyright 2003-  QMCPACK developers

                    Please cite:
 J. Kim et al. J. Phys. Cond. Mat. 30 195901 (2018)
      https://doi.org/10.1088/1361-648X/aab9c3

  Git branch: gvp
  Last git commit: 02b8462cd86e2c45b012131e3a811aee79855b67-dirty
  Last git commit date: Mon Oct 24 16:30:05 2022 -0700
  Last git commit subject: Merge commit 59872d0bcea460ceb08aa7832e89b700ee19b55f into gvp
=====================================================
  Global options 

  Total number of MPI ranks = 128
  Number of MPI groups      = 1
  MPI group ID              = 0
  Number of ranks in group  = 128
  MPI ranks per node        = 32
  OMP 1st level threads     = 1
  OMP nested threading disabled or only 1 thread on the 2nd level

  Precision used in this calculation, see definitions in the manual:
  Base precision      = double
  Full precision      = double

  Structure-of-arrays (SoA) optimization enabled

  Input XML = opt_forma_pi2pistar_Jwarm_run001.xml

  Project = FORMP2PJWARM
  date    = 2023-02-03 12:54:11 PST
  host    = n0110.savio3

 Random Number
 -------------
  Offset for the random number seeds based on time: 115

  Range of prime numbers to use as seeds over processors and threads = 643-1553


 Particle Set 
 ------------
  Name: e
  All the species have the same mass 1
  Particle set size: 12

 Particle Set 
 ------------
  Name: ion0
  All the species have the same mass 1
  Particle set size: 4

 Wavefunction setup: 
 ------------------- 
  Name: psi0

   Jastrow
   -------
    Name: J2   Type: Two-Body   Function: Bspline

    Radial function for species: u - u
     Number of parameters: 10
     Cusp: -0.25
     Cutoff radius: 10

     Name                        Value Type Recompute Use Index
     ---- ---------------------------- ---- --------- --- -----
     uu_0                 0.000000e+00    1         1  ON     0
     uu_1                 0.000000e+00    1         1  ON     1
     uu_2                 0.000000e+00    1         1  ON     2
     uu_3                 0.000000e+00    1         1  ON     3
     uu_4                 0.000000e+00    1         1  ON     4
     uu_5                 0.000000e+00    1         1  ON     5
     uu_6                 0.000000e+00    1         1  ON     6
     uu_7                 0.000000e+00    1         1  ON     7
     uu_8                 0.000000e+00    1         1  ON     8
     uu_9                 0.000000e+00    1         1  ON     9

    Radial function for species: u - d
     Number of parameters: 10
     Cusp: -5.000000e-01
     Cutoff radius: 1.000000e+01

     Name                        Value Type Recompute Use Index
     ---- ---------------------------- ---- --------- --- -----
     ud_0                 0.000000e+00    1         1  ON     0
     ud_1                 0.000000e+00    1         1  ON     1
     ud_2                 0.000000e+00    1         1  ON     2
     ud_3                 0.000000e+00    1         1  ON     3
     ud_4                 0.000000e+00    1         1  ON     4
     ud_5                 0.000000e+00    1         1  ON     5
     ud_6                 0.000000e+00    1         1  ON     6
     ud_7                 0.000000e+00    1         1  ON     7
     ud_8                 0.000000e+00    1         1  ON     8
     ud_9                 0.000000e+00    1         1  ON     9


   Jastrow
   -------
    Name: J1   Type: One-Body   Function: Bspline

    Radial function for element: C
     Number of parameters: 10
     Cusp: 0.000000e+00
     Cutoff radius: 1.000000e+01

     Name                        Value Type Recompute Use Index
     ---- ---------------------------- ---- --------- --- -----
     eC_0                 0.000000e+00    1         1  ON     0
     eC_1                 0.000000e+00    1         1  ON     1
     eC_2                 0.000000e+00    1         1  ON     2
     eC_3                 0.000000e+00    1         1  ON     3
     eC_4                 0.000000e+00    1         1  ON     4
     eC_5                 0.000000e+00    1         1  ON     5
     eC_6                 0.000000e+00    1         1  ON     6
     eC_7                 0.000000e+00    1         1  ON     7
     eC_8                 0.000000e+00    1         1  ON     8
     eC_9                 0.000000e+00    1         1  ON     9

    Radial function for element: O
     Number of parameters: 10
     Cusp: 0.000000e+00
     Cutoff radius: 1.000000e+01

     Name                        Value Type Recompute Use Index
     ---- ---------------------------- ---- --------- --- -----
     eO_0                 0.000000e+00    1         1  ON     0
     eO_1                 0.000000e+00    1         1  ON     1
     eO_2                 0.000000e+00    1         1  ON     2
     eO_3                 0.000000e+00    1         1  ON     3
     eO_4                 0.000000e+00    1         1  ON     4
     eO_5                 0.000000e+00    1         1  ON     5
     eO_6                 0.000000e+00    1         1  ON     6
     eO_7                 0.000000e+00    1         1  ON     7
     eO_8                 0.000000e+00    1         1  ON     8
     eO_9                 0.000000e+00    1         1  ON     9

    Radial function for element: H1
     Number of parameters: 10
     Cusp: 0.000000e+00
     Cutoff radius: 1.000000e+01

      Name                        Value Type Recompute Use Index
     ----- ---------------------------- ---- --------- --- -----
     eH1_0                 0.000000e+00    1         1  ON     0
     eH1_1                 0.000000e+00    1         1  ON     1
     eH1_2                 0.000000e+00    1         1  ON     2
     eH1_3                 0.000000e+00    1         1  ON     3
     eH1_4                 0.000000e+00    1         1  ON     4
     eH1_5                 0.000000e+00    1         1  ON     5
     eH1_6                 0.000000e+00    1         1  ON     6
     eH1_7                 0.000000e+00    1         1  ON     7
     eH1_8                 0.000000e+00    1         1  ON     8
     eH1_9                 0.000000e+00    1         1  ON     9

    Radial function for element: H2
     Number of parameters: 10
     Cusp: 0.000000e+00
     Cutoff radius: 1.000000e+01

      Name                        Value Type Recompute Use Index
     ----- ---------------------------- ---- --------- --- -----
     eH2_0                 0.000000e+00    1         1  ON     0
     eH2_1                 0.000000e+00    1         1  ON     1
     eH2_2                 0.000000e+00    1         1  ON     2
     eH2_3                 0.000000e+00    1         1  ON     3
     eH2_4                 0.000000e+00    1         1  ON     4
     eH2_5                 0.000000e+00    1         1  ON     5
     eH2_6                 0.000000e+00    1         1  ON     6
     eH2_7                 0.000000e+00    1         1  ON     7
     eH2_8                 0.000000e+00    1         1  ON     8
     eH2_9                 0.000000e+00    1         1  ON     9

  Created SPOSet builder named 'LCAOBSet' of type molecularorbital
  LCAO: SoaAtomicBasisSet<MultiQuintic,0>
  AO BasisSet for C
   Angular momentum expanded in cartesian functions x^lx y^ly z^lz according to Gamess
Using log grid with default values: ri = 1.000000e-06 rf = 1.000000e+02 npts = 1001
   R(n,l,m,s) 0 0 0 0
   R(n,l,m,s) 1 0 0 0
   R(n,l,m,s) 2 1 0 0
   R(n,l,m,s) 3 1 0 0
   R(n,l,m,s) 4 2 0 0
Expanding Ylm (angular function) according to Gamess using cartesian gaussians
Adding 1 cartesian gaussian orbitals for l= 0
Adding 1 cartesian gaussian orbitals for l= 0
Adding 3 cartesian gaussian orbitals for l= 1
Adding 3 cartesian gaussian orbitals for l= 1
Adding 6 cartesian gaussian orbitals for l= 2
  Setting cutoff radius 1.270574e+01

   Maximum Angular Momentum  = 2
   Number of Radial functors = 5
   Basis size                = 14

  AO BasisSet for O
   Angular momentum expanded in cartesian functions x^lx y^ly z^lz according to Gamess
Using log grid with default values: ri = 1.000000e-06 rf = 1.000000e+02 npts = 1001
   R(n,l,m,s) 0 0 0 0
   R(n,l,m,s) 1 0 0 0
   R(n,l,m,s) 2 1 0 0
   R(n,l,m,s) 3 1 0 0
   R(n,l,m,s) 4 2 0 0
Expanding Ylm (angular function) according to Gamess using cartesian gaussians
Adding 1 cartesian gaussian orbitals for l= 0
Adding 1 cartesian gaussian orbitals for l= 0
Adding 3 cartesian gaussian orbitals for l= 1
Adding 3 cartesian gaussian orbitals for l= 1
Adding 6 cartesian gaussian orbitals for l= 2
  Setting cutoff radius 1.018591e+01

   Maximum Angular Momentum  = 2
   Number of Radial functors = 5
   Basis size                = 14

  AO BasisSet for H1
   Angular momentum expanded in cartesian functions x^lx y^ly z^lz according to Gamess
Using log grid with default values: ri = 1.000000e-06 rf = 1.000000e+02 npts = 1001
   R(n,l,m,s) 0 0 0 0
   R(n,l,m,s) 1 0 0 0
   R(n,l,m,s) 2 1 0 0
Expanding Ylm (angular function) according to Gamess using cartesian gaussians
Adding 1 cartesian gaussian orbitals for l= 0
Adding 1 cartesian gaussian orbitals for l= 0
Adding 3 cartesian gaussian orbitals for l= 1
  Setting cutoff radius 1.270574e+01

   Maximum Angular Momentum  = 1
   Number of Radial functors = 3
   Basis size                = 5

  AO BasisSet for H2
   Angular momentum expanded in cartesian functions x^lx y^ly z^lz according to Gamess
Using log grid with default values: ri = 1.000000e-06 rf = 1.000000e+02 npts = 1001
   R(n,l,m,s) 0 0 0 0
   R(n,l,m,s) 1 0 0 0
   R(n,l,m,s) 2 1 0 0
Expanding Ylm (angular function) according to Gamess using cartesian gaussians
Adding 1 cartesian gaussian orbitals for l= 0
Adding 1 cartesian gaussian orbitals for l= 0
Adding 3 cartesian gaussian orbitals for l= 1
  Setting cutoff radius 1.270574e+01

   Maximum Angular Momentum  = 1
   Number of Radial functors = 3
   Basis size                = 5

Creating SPOSet in SlaterDetBuilder::put(xmlNodePtr cur).
spo_name = spo-up
  Building SPOSet 'spo-up' with '' basis set.
Creating SPOSet in SlaterDetBuilder::put(xmlNodePtr cur).
spo_name = spo-dn
  Building SPOSet 'spo-dn' with '' basis set.
Using Bryan's algorithm for MultiSlaterDeterminant expansion. 
Creating base determinant (up) for MSD expansion. 
Creating base determinant (down) for MSD expansion. 
Found determinant list. 
Reading CI expansion.
Found 425 terms in the MSD expansion.
Norm of ci vector (sum of ci^2): 9.999916e-01
Norm of qchem ci vector (sum of qchem_ci^2): 0.000000e+00
Found 28 unique up determinants.
Found 28 unique down determinants.
Number of terms in pairs array: 12
Number of terms in pairs array: 12
CI coefficients are not optimizable. 
  FermionWF = MultiSlaterDeterminantFast
  QMCHamiltonian::addOperator Kinetic to H, physical Hamiltonian 
  QMCHamiltonian::addOperator ElecElec to H, physical Hamiltonian 
QMCHamiltonian::addOperatorType added type coulomb named ElecElec

  ECPotential builder for pseudopotential 

  Adding pseudopotential for C
   Linear grid  ri=0.000000e+00 rf=1.000000e+01 npts = 10001
    ECPComponentBuilder::buildSemiLocalAndLocal 
    Assuming Hartree unit
   Number of angular momentum channels 2
   Maximum angular momentum channel 1
   Creating a Linear Grid Rmax=1.405000e+00
  Using global grid with delta = 1.000000e-03
   Making L=1 a local potential with a radial cutoff of 9.999000e+00
    Non-local pseudopotential parameters
    Maximum angular mementum = 0
    Number of non-local channels = 1
       l(0)=0
    Cutoff radius = 1.405000e+00
    Spherical grids and weights: 
         1.0000000000e+00  0.0000000000e+00  0.0000000000e+00    8.3333333333e-02
        -1.0000000000e+00  1.2246467991e-16  0.0000000000e+00    8.3333333333e-02
         4.4721359550e-01  8.9442719100e-01  0.0000000000e+00    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -8.9442719100e-01  1.0953573965e-16    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
    Maximum cutoff radius 1.4050000000e+00

  Adding pseudopotential for O
   Linear grid  ri=0.0000000000e+00 rf=1.0000000000e+01 npts = 10001
    ECPComponentBuilder::buildSemiLocalAndLocal 
    Assuming Hartree unit
   Number of angular momentum channels 2
   Maximum angular momentum channel 1
   Creating a Linear Grid Rmax=1.0750000000e+00
  Using global grid with delta = 1.0000000000e-03
   Making L=1 a local potential with a radial cutoff of 9.9990000000e+00
    Non-local pseudopotential parameters
    Maximum angular mementum = 0
    Number of non-local channels = 1
       l(0)=0
    Cutoff radius = 1.0750000000e+00
    Spherical grids and weights: 
         1.0000000000e+00  0.0000000000e+00  0.0000000000e+00    8.3333333333e-02
        -1.0000000000e+00  1.2246467991e-16  0.0000000000e+00    8.3333333333e-02
         4.4721359550e-01  8.9442719100e-01  0.0000000000e+00    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -8.9442719100e-01  1.0953573965e-16    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
    Maximum cutoff radius 1.0750000000e+00

  Adding pseudopotential for H1
   Linear grid  ri=0.0000000000e+00 rf=1.0000000000e+01 npts = 10001
    ECPComponentBuilder::buildSemiLocalAndLocal 
    Assuming Hartree unit
   Number of angular momentum channels 2
   Maximum angular momentum channel 1
   Creating a Linear Grid Rmax=1.0000000000e-10
  Using global grid with delta = 1.0000000000e-03
   Making L=1 a local potential with a radial cutoff of 9.9990000000e+00
    Non-local pseudopotential parameters
    Maximum angular mementum = 0
    Number of non-local channels = 1
       l(0)=0
    Cutoff radius = 1.0000000000e-03
    Spherical grids and weights: 
         1.0000000000e+00  0.0000000000e+00  0.0000000000e+00    8.3333333333e-02
        -1.0000000000e+00  1.2246467991e-16  0.0000000000e+00    8.3333333333e-02
         4.4721359550e-01  8.9442719100e-01  0.0000000000e+00    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -8.9442719100e-01  1.0953573965e-16    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
    Maximum cutoff radius 1.0000000000e-03

  Adding pseudopotential for H2
   Linear grid  ri=0.0000000000e+00 rf=1.0000000000e+01 npts = 10001
    ECPComponentBuilder::buildSemiLocalAndLocal 
    Assuming Hartree unit
   Number of angular momentum channels 2
   Maximum angular momentum channel 1
   Creating a Linear Grid Rmax=1.0000000000e-10
  Using global grid with delta = 1.0000000000e-03
   Making L=1 a local potential with a radial cutoff of 9.9990000000e+00
    Non-local pseudopotential parameters
    Maximum angular mementum = 0
    Number of non-local channels = 1
       l(0)=0
    Cutoff radius = 1.0000000000e-03
    Spherical grids and weights: 
         1.0000000000e+00  0.0000000000e+00  0.0000000000e+00    8.3333333333e-02
        -1.0000000000e+00  1.2246467991e-16  0.0000000000e+00    8.3333333333e-02
         4.4721359550e-01  8.9442719100e-01  0.0000000000e+00    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -8.9442719100e-01  1.0953573965e-16    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
    Maximum cutoff radius 1.0000000000e-03
  QMCHamiltonian::addOperator LocalECP to H, physical Hamiltonian 

  Using NonLocalECP potential 
    Maximum grid on a sphere for NonLocalECPotential: 12
  QMCHamiltonian::addOperator NonLocalECP to H, physical Hamiltonian 
QMCHamiltonian::addOperatorType added type pseudo named NonLocalECP
  QMCHamiltonian::addOperator IonIon to H, physical Hamiltonian 
QMCHamiltonian::addOperatorType added type coulomb named IonIon

  QMCHamiltonian::add2WalkerProperty added
    5 to P::PropertyList 
    0 to P::Collectables 
    starting Index of the observables in P::PropertyList = 10
ParticleSetPool::randomize 
  Initialization Execution time = 1.5750e-01 secs
=========================================================
 Summary of QMC systems 
=========================================================
ParticleSetPool has: 

  ParticleSet 'e' contains 12 particles :  u(6) d(6)

    u  4.0107225728e-02 -5.0659535091e-01 -4.8356690577e-01
    u -2.0203417087e-01 -1.2691590666e+00 -2.1169263951e+00
    u  2.9913287695e-01 -2.3710879234e-01  2.0101719070e+00
    u  4.8474243406e-02 -5.3051852953e-01  9.5378285444e-01
    u -5.5511775119e-01 -9.8683271286e-02  1.4043240644e+00
    u  6.9646297924e-01  2.5004217823e+00 -2.4744046405e+00
    d -1.1004432466e+00 -7.1118992563e-01 -1.4300801983e+00
    d -3.6824818327e-02  7.5687344105e-01 -1.6708867165e+00
    d -9.4375526199e-01  1.5348935511e-01  1.1974289766e+00
    d -8.9321447322e-02 -6.9596903295e-02  1.4810785623e+00
    (... and 2 more particle positions ...)

  Distance table for similar particles (A-A):
    source/target: e
    Using structure-of-arrays (SoA) data layout
    Distance computations use open boundary conditions in 3D.

  Distance table for dissimilar particles (A-B):
    source: ion0  target: e
    Using structure-of-arrays (SoA) data layout
    Distance computations use open boundary conditions in 3D.


  ParticleSet 'ion0' contains 4 particles :  C(1) O(1) H1(1) H2(1)

    C  0.0000000000e+00  0.0000000000e+00 -1.1394765782e+00
    O  0.0000000000e+00  0.0000000000e+00  1.1440287480e+00
    H1  0.0000000000e+00  1.7662761033e+00 -2.2339863698e+00
    H2  0.0000000000e+00 -1.7662761033e+00 -2.2339863698e+00

  Distance table for similar particles (A-A):
    source/target: ion0
    Using structure-of-arrays (SoA) data layout
    Distance computations use open boundary conditions in 3D.


  Hamiltonian h0
  Kinetic         Kinetic energy
  ElecElec        CoulombAA source/target e

  LocalECP        LocalECPotential: ion0
  NonLocalECP     NonLocalECPotential: ion0
  IonIon          CoulombAA source/target ion0


Loop execution max-interations = 20
Inside LM engine constructor, num_params is: 0 and _total_num_params is: 0

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORMP2PJWARM.s000 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15
  Adding 1 walkers to 0 existing sets
  Total number of walkers: 1.2800000000e+02
  Total weight: 1.2800000000e+02

=========================================================
  Start VMC
  File Root FORMP2PJWARM.s000 append = no 
=========================================================
Resetting walkers
  Using the current 1 walkers.
  Total number of walkers: 1.2800000000e+02
  Total weight: 1.2800000000e+02
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=0  my_counter=0
  time step      = 5.0000000000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000000000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625000000e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000000000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000000000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000000000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000000000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000000000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000000000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000000000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625000000e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000000000e-02</parameter>
<parameter name="time_step" condition="au">5.0000000000e-02</parameter>
<parameter name="timestep" condition="au">5.0000000000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
  Set drift_modifier UNR parameter a = 1.0000000000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000000000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: 0 and ratio_threshold_: 0.0000000000e+00
Allocating full size _hmat_temp and _smat_temp
Inside LM engine's get_param, num_params is: 60
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 30888 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 0
    time step          = 0.05
    reference energy   = -22.135
    reference variance = 1.62208
====================================================
  Execution time = 4.9907e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORMP2PJWARM.s000
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2124e+01
  VMC Evar = 2.0810e+00
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.6139e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.081108237669
                                         uncertainty =       0.003362766928

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.081108237669
                                         uncertainty =       0.003362766928

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001020052056
  error estimate for blocks of size 2^( 2) =       0.001113720653
  error estimate for blocks of size 2^( 3) =       0.001196308904
  error estimate for blocks of size 2^( 4) =       0.001253919595
  error estimate for blocks of size 2^( 5) =       0.001289555960
  error estimate for blocks of size 2^( 6) =       0.001309647470
  error estimate for blocks of size 2^( 7) =       0.001321931552

      target function =                  N/A
              le_mean =     -22.124329079492
             les_mean =     491.566948569839
             stat err =       0.001293763644
             autocorr =       1.608663526180
              std dev =       1.442571451502
             le_variance =       2.081012392689


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy-2.212432907949e+01 
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.5000e-01, overlap shift 2.5000e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.124329079492       residual = 5.86e-01           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.159623075045       residual = 3.86e-01           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.183478377322       residual = 3.10e-01           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.204690150017       residual = 1.67e-01           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.232554718774       residual = 1.01e-01           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.242480902836       residual = 3.22e-02           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.249500460537       residual = 1.26e-02           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.255076629452       residual = 1.10e-02           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.257306318296       residual = 2.16e-03           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.257949744074       residual = 1.46e-03           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -22.258552017258       residual = 7.45e-04           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -22.258769045058       residual = 3.76e-04           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -22.258884428558       residual = 1.98e-04           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -22.258953462581       residual = 5.01e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -22.258981010486       residual = 3.17e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -22.259000528267       residual = 1.46e-05           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -22.259003928604       residual = 5.46e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   energy =     -22.259006486271       residual = 1.05e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   energy =     -22.259009130370       residual = 2.88e-07           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   energy =     -22.259009513717       residual = 8.51e-08           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   energy =     -22.259009983227       residual = 4.39e-08           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   energy =     -22.259009822409       residual = 9.61e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         21 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 2.5000e-01 is 1.987495e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 1.0000e+00, overlap shift 1.0000e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.124329079492       residual = 5.86e-01           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.138963048933       residual = 5.37e-01           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.150151790643       residual = 4.21e-01           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.160637988748       residual = 1.62e-01           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.173245970118       residual = 1.41e-01           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.179318734649       residual = 3.32e-02           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.182488020884       residual = 6.10e-03           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.183564971296       residual = 4.70e-03           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.184147399328       residual = 1.39e-03           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.184287382485       residual = 4.80e-04           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -22.184379403813       residual = 1.12e-04           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -22.184401432549       residual = 8.08e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -22.184409711542       residual = 1.62e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -22.184412635167       residual = 7.58e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -22.184413024936       residual = 1.97e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -22.184414608748       residual = 9.53e-07           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -22.184414155333       residual = 1.17e-07           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   energy =     -22.184414275532       residual = 2.21e-08           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   energy =     -22.184414235596       residual = 8.26e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         18 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.0000e+00 is 1.437164e-01

solving harmonic davidson linear method for identity shift 4.0000e+00, overlap shift 4.0000e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.124329079492       residual = 5.86e-01           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.128701394823       residual = 6.29e-01           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.132361302449       residual = 5.08e-01           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.135992037507       residual = 1.67e-01           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.139849520324       residual = 1.57e-01           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.141961185496       residual = 3.68e-02           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.143114773138       residual = 6.29e-03           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.143366522740       residual = 2.54e-03           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.143491620109       residual = 1.00e-03           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.143519490787       residual = 3.43e-04           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -22.143542759784       residual = 5.68e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -22.143546825125       residual = 2.88e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -22.143547490694       residual = 5.26e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -22.143548417065       residual = 3.57e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -22.143548419238       residual = 4.93e-07           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -22.143548297200       residual = 1.33e-07           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -22.143548343059       residual = 2.81e-08           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   energy =     -22.143548305964       residual = 4.26e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         17 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 4.0000e+00 is 3.277202e-02

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.017027 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 6.6493e+01
  </log>
  <optVariables href="FORMP2PJWARM.s000.opt.xml">
uu_0  5.871910e-02                 1 1 ON  0
uu_1  1.755495e-02                 1 1 ON  1
uu_2  -1.800534e-02                1 1 ON  2
uu_3  -1.396826e-02                1 1 ON  3
uu_4  -1.332547e-02                1 1 ON  4
uu_5  -8.750356e-03                1 1 ON  5
uu_6  -6.636756e-03                1 1 ON  6
uu_7  -5.219796e-03                1 1 ON  7
uu_8  -4.681059e-03                1 1 ON  8
uu_9  -3.045224e-03                1 1 ON  9
ud_0  1.437164e-01                 1 1 ON  10
ud_1  1.870739e-03                 1 1 ON  11
ud_2  -3.579416e-02                1 1 ON  12
ud_3  -2.830132e-02                1 1 ON  13
ud_4  -2.555866e-02                1 1 ON  14
ud_5  -1.823160e-02                1 1 ON  15
ud_6  -1.402205e-02                1 1 ON  16
ud_7  -9.959959e-03                1 1 ON  17
ud_8  -6.742422e-03                1 1 ON  18
ud_9  -3.852134e-03                1 1 ON  19
eC_0  -2.880708e-02                1 1 ON  20
eC_1  -2.280614e-02                1 1 ON  21
eC_2  2.568566e-02                 1 1 ON  22
eC_3  2.313451e-02                 1 1 ON  23
eC_4  1.088644e-02                 1 1 ON  24
eC_5  -3.859498e-04                1 1 ON  25
eC_6  -4.337142e-03                1 1 ON  26
eC_7  -2.120761e-03                1 1 ON  27
eC_8  -7.992814e-04                1 1 ON  28
eC_9  -3.266120e-04                1 1 ON  29
eO_0  -1.061649e-01                1 1 ON  30
eO_1  -3.948737e-02                1 1 ON  31
eO_2  6.653082e-02                 1 1 ON  32
eO_3  5.126618e-02                 1 1 ON  33
eO_4  3.209296e-02                 1 1 ON  34
eO_5  1.166247e-02                 1 1 ON  35
eO_6  -6.893330e-03                1 1 ON  36
eO_7  -5.172437e-03                1 1 ON  37
eO_8  -2.252106e-03                1 1 ON  38
eO_9  -9.100341e-04                1 1 ON  39
eH1_0 -1.057939e-02                1 1 ON  40
eH1_1 7.119787e-03                 1 1 ON  41
eH1_2 1.058209e-02                 1 1 ON  42
eH1_3 1.250720e-03                 1 1 ON  43
eH1_4 -7.118707e-03                1 1 ON  44
eH1_5 -2.196776e-03                1 1 ON  45
eH1_6 4.219366e-03                 1 1 ON  46
eH1_7 -7.128664e-04                1 1 ON  47
eH1_8 -1.683097e-03                1 1 ON  48
eH1_9 -5.921632e-04                1 1 ON  49
eH2_0 -1.065798e-02                1 1 ON  50
eH2_1 7.075337e-03                 1 1 ON  51
eH2_2 1.052087e-02                 1 1 ON  52
eH2_3 1.337778e-03                 1 1 ON  53
eH2_4 -6.766653e-03                1 1 ON  54
eH2_5 -1.962153e-03                1 1 ON  55
eH2_6 3.874891e-03                 1 1 ON  56
eH2_7 -7.288676e-04                1 1 ON  57
eH2_8 -1.681165e-03                1 1 ON  58
eH2_9 -6.916694e-04                1 1 ON  59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 0
    time step          = 0.05
    reference energy   = -22.1798
    reference variance = 1.0194
====================================================
  Execution time = 4.8938e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORMP2PJWARM.s000
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2277e+01
  VMC Evar = 1.0155e+00
  Total weights = 2.0000e+06
  Execution time = 4.5490e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       1.881396390454
                                         uncertainty =       0.003796389714

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       1.881396390454
                                         uncertainty =       0.003796389714

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000969945882
  error estimate for blocks of size 2^( 2) =       0.001053732027
  error estimate for blocks of size 2^( 3) =       0.001127158204
  error estimate for blocks of size 2^( 4) =       0.001176023644
  error estimate for blocks of size 2^( 5) =       0.001206214303
  error estimate for blocks of size 2^( 6) =       0.001220742796
  error estimate for blocks of size 2^( 7) =       0.001231854140

      target function =                  N/A
              le_mean =     -22.315216623173
             les_mean =     499.850482025253
             stat err =       0.001208708721
             autocorr =       1.552917215032
              std dev =       1.371710620692
             le_variance =       1.881590026920

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =      77.786836367325
                                         uncertainty =       0.605171533259

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =      77.786836367325
                                         uncertainty =       0.605171533259

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.006236659996
  error estimate for blocks of size 2^( 2) =       0.006565090551
  error estimate for blocks of size 2^( 3) =       0.006829054042
  error estimate for blocks of size 2^( 4) =       0.007006076848
  error estimate for blocks of size 2^( 5) =       0.007136263706
  error estimate for blocks of size 2^( 6) =       0.007224160445
  error estimate for blocks of size 2^( 7) =       0.007288171329

      target function =                  N/A
              le_mean =     -28.068781606540
             les_mean =     865.648317795005
             stat err =       0.007163668082
             autocorr =       1.319370513824
              std dev =       8.819969150472
             le_variance =      77.791855815285

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.848254900233
                                         uncertainty =       0.003974561940

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.848254900233
                                         uncertainty =       0.003974561940

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000651217021
  error estimate for blocks of size 2^( 2) =       0.000709768707
  error estimate for blocks of size 2^( 3) =       0.000768824460
  error estimate for blocks of size 2^( 4) =       0.000812187209
  error estimate for blocks of size 2^( 5) =       0.000839423735
  error estimate for blocks of size 2^( 6) =       0.000855446778
  error estimate for blocks of size 2^( 7) =       0.000862864730

      target function =                  N/A
              le_mean =     -22.315261780263
             les_mean =     498.819075113675
             stat err =       0.000842480613
             autocorr =       1.673664271750
              std dev =       0.920959942724
             le_variance =       0.848167216102

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       1.628866396186
                                         uncertainty =       0.003564997445

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       1.628866396186
                                         uncertainty =       0.003564997445

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000902502256
  error estimate for blocks of size 2^( 2) =       0.000985297463
  error estimate for blocks of size 2^( 3) =       0.001058728565
  error estimate for blocks of size 2^( 4) =       0.001107955811
  error estimate for blocks of size 2^( 5) =       0.001138278621
  error estimate for blocks of size 2^( 6) =       0.001152902768
  error estimate for blocks of size 2^( 7) =       0.001163682490

      target function =                  N/A
              le_mean =     -22.299642808411
             les_mean =     498.903089212600
             stat err =       0.001140704923
             autocorr =       1.597533738712
              std dev =       1.276330930597
             le_variance =       1.629020644398


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.315216623173        initial
            N/A            N/A                    N/A                    N/A     bad update
     1.0000e+00     1.0000e+01             1.4372e-01       -22.315261780263  <--
     4.0000e+00     4.0000e+01             3.2772e-02       -22.299642808411

*****************************************************************************
Applying the update for shift_i =   1.0000e+00     and shift_s =   1.0000e+01
*****************************************************************************

  Execution time = 7.1756e+01
  </log>
  <optVariables href="FORMP2PJWARM.s000.opt.xml">
 uu_0                 5.871910e-02 1 1  ON 0
 uu_1                 1.755495e-02 1 1  ON 1
 uu_2                -1.800534e-02 1 1  ON 2
 uu_3                -1.396826e-02 1 1  ON 3
 uu_4                -1.332547e-02 1 1  ON 4
 uu_5                -8.750356e-03 1 1  ON 5
 uu_6                -6.636756e-03 1 1  ON 6
 uu_7                -5.219796e-03 1 1  ON 7
 uu_8                -4.681059e-03 1 1  ON 8
 uu_9                -3.045224e-03 1 1  ON 9
 ud_0                 1.437164e-01 1 1  ON 10
 ud_1                 1.870739e-03 1 1  ON 11
 ud_2                -3.579416e-02 1 1  ON 12
 ud_3                -2.830132e-02 1 1  ON 13
 ud_4                -2.555866e-02 1 1  ON 14
 ud_5                -1.823160e-02 1 1  ON 15
 ud_6                -1.402205e-02 1 1  ON 16
 ud_7                -9.959959e-03 1 1  ON 17
 ud_8                -6.742422e-03 1 1  ON 18
 ud_9                -3.852134e-03 1 1  ON 19
 eC_0                -2.880708e-02 1 1  ON 20
 eC_1                -2.280614e-02 1 1  ON 21
 eC_2                 2.568566e-02 1 1  ON 22
 eC_3                 2.313451e-02 1 1  ON 23
 eC_4                 1.088644e-02 1 1  ON 24
 eC_5                -3.859498e-04 1 1  ON 25
 eC_6                -4.337142e-03 1 1  ON 26
 eC_7                -2.120761e-03 1 1  ON 27
 eC_8                -7.992814e-04 1 1  ON 28
 eC_9                -3.266120e-04 1 1  ON 29
 eO_0                -1.061649e-01 1 1  ON 30
 eO_1                -3.948737e-02 1 1  ON 31
 eO_2                 6.653082e-02 1 1  ON 32
 eO_3                 5.126618e-02 1 1  ON 33
 eO_4                 3.209296e-02 1 1  ON 34
 eO_5                 1.166247e-02 1 1  ON 35
 eO_6                -6.893330e-03 1 1  ON 36
 eO_7                -5.172437e-03 1 1  ON 37
 eO_8                -2.252106e-03 1 1  ON 38
 eO_9                -9.100341e-04 1 1  ON 39
eH1_0                -1.057939e-02 1 1  ON 40
eH1_1                 7.119787e-03 1 1  ON 41
eH1_2                 1.058209e-02 1 1  ON 42
eH1_3                 1.250720e-03 1 1  ON 43
eH1_4                -7.118707e-03 1 1  ON 44
eH1_5                -2.196776e-03 1 1  ON 45
eH1_6                 4.219366e-03 1 1  ON 46
eH1_7                -7.128664e-04 1 1  ON 47
eH1_8                -1.683097e-03 1 1  ON 48
eH1_9                -5.921632e-04 1 1  ON 49
eH2_0                -1.065798e-02 1 1  ON 50
eH2_1                 7.075337e-03 1 1  ON 51
eH2_2                 1.052087e-02 1 1  ON 52
eH2_3                 1.337778e-03 1 1  ON 53
eH2_4                -6.766653e-03 1 1  ON 54
eH2_5                -1.962153e-03 1 1  ON 55
eH2_6                 3.874891e-03 1 1  ON 56
eH2_7                -7.288676e-04 1 1  ON 57
eH2_8                -1.681165e-03 1 1  ON 58
eH2_9                -6.916694e-04 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.3826e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORMP2PJWARM.s001 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORMP2PJWARM.s001 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=1  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2157e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 30888 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 1
    time step          = 0.05
    reference energy   = -22.2555
    reference variance = 0.956411
====================================================
  Execution time = 4.9292e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORMP2PJWARM.s001
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2276e+01
  VMC Evar = 1.0145e+00
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.5932e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       1.014516450286
                                         uncertainty =       0.005344444658

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       1.014516450286
                                         uncertainty =       0.005344444658

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000712221648
  error estimate for blocks of size 2^( 2) =       0.000787633336
  error estimate for blocks of size 2^( 3) =       0.000857574811
  error estimate for blocks of size 2^( 4) =       0.000908929202
  error estimate for blocks of size 2^( 5) =       0.000939830632
  error estimate for blocks of size 2^( 6) =       0.000956476215
  error estimate for blocks of size 2^( 7) =       0.000964466366

      target function =                  N/A
              le_mean =     -22.276437467184
             les_mean =     497.254185073775
             stat err =       0.000942425604
             autocorr =       1.750909960286
              std dev =       1.007233513973
             le_variance =       1.014519351670


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.227643746718e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.5000e-01, overlap shift 2.5000e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.276437467184       residual = 1.48e-01           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.285638615375       residual = 8.74e-02           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.293352043384       residual = 1.28e-01           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.302782150804       residual = 5.84e-02           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.315262938192       residual = 2.83e-02           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.319021981289       residual = 1.62e-02           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.321664387616       residual = 6.63e-03           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.324294396099       residual = 4.62e-03           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.325124667230       residual = 1.10e-03           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.325539767516       residual = 8.43e-04           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -22.325812501336       residual = 5.26e-04           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -22.325921976476       residual = 1.89e-04           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -22.326001636413       residual = 8.40e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -22.326028531654       residual = 2.77e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -22.326046720686       residual = 1.63e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -22.326053809490       residual = 6.17e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -22.326053630653       residual = 2.83e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   energy =     -22.326054871701       residual = 4.76e-07           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   energy =     -22.326055839243       residual = 1.34e-07           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   energy =     -22.326056703278       residual = 4.64e-08           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   energy =     -22.326056453911       residual = 1.44e-08           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   energy =     -22.326056372993       residual = 3.77e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         21 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 2.5000e-01 is 3.508385e-01

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 1.0000e+00, overlap shift 1.0000e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.276437467184       residual = 1.48e-01           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.280040061586       residual = 1.06e-01           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.282985706939       residual = 1.50e-01           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.287321347780       residual = 5.00e-02           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.292382401639       residual = 3.38e-02           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.293895950325       residual = 1.23e-02           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.294866078191       residual = 2.75e-03           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.295350978430       residual = 1.90e-03           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.295554434772       residual = 5.83e-04           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.295625710728       residual = 1.86e-04           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -22.295652979024       residual = 8.18e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -22.295656747907       residual = 3.61e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -22.295665168630       residual = 7.94e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -22.295666668976       residual = 3.50e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -22.295667740027       residual = 1.24e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -22.295667998367       residual = 3.43e-07           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -22.295667742956       residual = 4.35e-08           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   energy =     -22.295667718292       residual = 1.12e-08           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   energy =     -22.295667681744       residual = 3.63e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         18 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.0000e+00 is 6.504747e-02

solving harmonic davidson linear method for identity shift 4.0000e+00, overlap shift 4.0000e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.276437467184       residual = 1.48e-01           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.277486131420       residual = 1.17e-01           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.278356204764       residual = 1.64e-01           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.279760905943       residual = 4.75e-02           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.281223046448       residual = 3.64e-02           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.281689019867       residual = 1.14e-02           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.281984027449       residual = 2.20e-03           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.282081614224       residual = 1.05e-03           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.282127786894       residual = 4.45e-04           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.282142158683       residual = 1.01e-04           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -22.282148142009       residual = 3.75e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -22.282148187345       residual = 1.29e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -22.282149112674       residual = 2.31e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -22.282149374871       residual = 1.42e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -22.282149418424       residual = 2.79e-07           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -22.282149504639       residual = 6.74e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -22.282149492621       residual = 8.82e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         16 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 4.0000e+00 is 1.476998e-02

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.030156 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 6.5241e+01
  </log>
  <optVariables href="FORMP2PJWARM.s001.opt.xml">
 uu_0                 8.938903e-02 1 1  ON 0
 uu_1                 2.349502e-02 1 1  ON 1
 uu_2                -2.457323e-02 1 1  ON 2
 uu_3                -2.421510e-02 1 1  ON 3
 uu_4                -2.125790e-02 1 1  ON 4
 uu_5                -1.471370e-02 1 1  ON 5
 uu_6                -9.716460e-03 1 1  ON 6
 uu_7                -6.772065e-03 1 1  ON 7
 uu_8                -5.378641e-03 1 1  ON 8
 uu_9                -3.329887e-03 1 1  ON 9
 ud_0                 1.977501e-01 1 1  ON 10
 ud_1                 9.935388e-03 1 1  ON 11
 ud_2                -4.686636e-02 1 1  ON 12
 ud_3                -4.394762e-02 1 1  ON 13
 ud_4                -3.777060e-02 1 1  ON 14
 ud_5                -2.817706e-02 1 1  ON 15
 ud_6                -2.027066e-02 1 1  ON 16
 ud_7                -1.375727e-02 1 1  ON 17
 ud_8                -8.732374e-03 1 1  ON 18
 ud_9                -4.552644e-03 1 1  ON 19
 eC_0                -5.076227e-02 1 1  ON 20
 eC_1                -3.803763e-02 1 1  ON 21
 eC_2                 3.933234e-02 1 1  ON 22
 eC_3                 3.981962e-02 1 1  ON 23
 eC_4                 1.938782e-02 1 1  ON 24
 eC_5                 1.499641e-03 1 1  ON 25
 eC_6                -6.590823e-03 1 1  ON 26
 eC_7                -2.974655e-03 1 1  ON 27
 eC_8                -1.058332e-03 1 1  ON 28
 eC_9                -4.363064e-04 1 1  ON 29
 eO_0                -1.712124e-01 1 1  ON 30
 eO_1                -6.201715e-02 1 1  ON 31
 eO_2                 9.437182e-02 1 1  ON 32
 eO_3                 8.427225e-02 1 1  ON 33
 eO_4                 5.496360e-02 1 1  ON 34
 eO_5                 2.255306e-02 1 1  ON 35
 eO_6                -9.572332e-03 1 1  ON 36
 eO_7                -7.997143e-03 1 1  ON 37
 eO_8                -3.369931e-03 1 1  ON 38
 eO_9                -1.163752e-03 1 1  ON 39
eH1_0                -1.766355e-02 1 1  ON 40
eH1_1                 1.121056e-02 1 1  ON 41
eH1_2                 1.524307e-02 1 1  ON 42
eH1_3                 9.912540e-04 1 1  ON 43
eH1_4                -9.631155e-03 1 1  ON 44
eH1_5                -3.405979e-03 1 1  ON 45
eH1_6                 6.769218e-03 1 1  ON 46
eH1_7                 6.629609e-05 1 1  ON 47
eH1_8                -2.410280e-03 1 1  ON 48
eH1_9                -7.605082e-04 1 1  ON 49
eH2_0                -1.767958e-02 1 1  ON 50
eH2_1                 1.115064e-02 1 1  ON 51
eH2_2                 1.530901e-02 1 1  ON 52
eH2_3                 1.196530e-03 1 1  ON 53
eH2_4                -9.313712e-03 1 1  ON 54
eH2_5                -3.188978e-03 1 1  ON 55
eH2_6                 6.610492e-03 1 1  ON 56
eH2_7                -1.648635e-04 1 1  ON 57
eH2_8                -2.544109e-03 1 1  ON 58
eH2_9                -9.243451e-04 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 1
    time step          = 0.05
    reference energy   = -22.3705
    reference variance = 1.09738
====================================================
  Execution time = 4.8594e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORMP2PJWARM.s001
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2320e+01
  VMC Evar = 8.0821e-01
  Total weights = 2.0000e+06
  Execution time = 4.5585e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.985836322942
                                         uncertainty =       0.003822594735

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.985836322942
                                         uncertainty =       0.003822594735

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000702129659
  error estimate for blocks of size 2^( 2) =       0.000775099227
  error estimate for blocks of size 2^( 3) =       0.000842422430
  error estimate for blocks of size 2^( 4) =       0.000891426138
  error estimate for blocks of size 2^( 5) =       0.000921597762
  error estimate for blocks of size 2^( 6) =       0.000935395976
  error estimate for blocks of size 2^( 7) =       0.000946777285

      target function =                  N/A
              le_mean =     -22.325909438813
             les_mean =     499.432203893004
             stat err =       0.000923799290
             autocorr =       1.731093840868
              std dev =       0.992961286200
             le_variance =       0.985972115893

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.741629108869
                                         uncertainty =       0.005904065572

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.741629108869
                                         uncertainty =       0.005904065572

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000608949619
  error estimate for blocks of size 2^( 2) =       0.000645486384
  error estimate for blocks of size 2^( 3) =       0.000682721184
  error estimate for blocks of size 2^( 4) =       0.000713837696
  error estimate for blocks of size 2^( 5) =       0.000734968749
  error estimate for blocks of size 2^( 6) =       0.000747640586
  error estimate for blocks of size 2^( 7) =       0.000752257213

      target function =                  N/A
              le_mean =     -22.381082359636
             les_mean =     501.654486494797
             stat err =       0.000737176061
             autocorr =       1.465479410460
              std dev =       0.861184809903
             le_variance =       0.741639276808

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.717907613329
                                         uncertainty =       0.004640765755

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.717907613329
                                         uncertainty =       0.004640765755

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000599159711
  error estimate for blocks of size 2^( 2) =       0.000657316972
  error estimate for blocks of size 2^( 3) =       0.000714229294
  error estimate for blocks of size 2^( 4) =       0.000758024689
  error estimate for blocks of size 2^( 5) =       0.000786154488
  error estimate for blocks of size 2^( 6) =       0.000800043460
  error estimate for blocks of size 2^( 7) =       0.000808009855

      target function =                  N/A
              le_mean =     -22.326330929327
             les_mean =     499.183037126221
             stat err =       0.000788058123
             autocorr =       1.729941010360
              std dev =       0.847339789798
             le_variance =       0.717984719375

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.933269839645
                                         uncertainty =       0.003897647959

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.933269839645
                                         uncertainty =       0.003897647959

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000683153392
  error estimate for blocks of size 2^( 2) =       0.000754649613
  error estimate for blocks of size 2^( 3) =       0.000821069644
  error estimate for blocks of size 2^( 4) =       0.000869689614
  error estimate for blocks of size 2^( 5) =       0.000899777285
  error estimate for blocks of size 2^( 6) =       0.000913623639
  error estimate for blocks of size 2^( 7) =       0.000924577852

      target function =                  N/A
              le_mean =     -22.323426356334
             les_mean =     499.268760934023
             stat err =       0.000901917098
             autocorr =       1.742997570319
              std dev =       0.966124792177
             le_variance =       0.933397114059


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.325909438813        initial
            N/A            N/A                    N/A                    N/A     bad update
     1.0000e+00     1.0000e+01             6.5047e-02       -22.326330929327  <--
     4.0000e+00     4.0000e+01             1.4770e-02       -22.323426356334

*****************************************************************************
Applying the update for shift_i =   1.0000e+00     and shift_s =   1.0000e+01
*****************************************************************************

  Execution time = 7.1473e+01
  </log>
  <optVariables href="FORMP2PJWARM.s001.opt.xml">
 uu_0                 8.938903e-02 1 1  ON 0
 uu_1                 2.349502e-02 1 1  ON 1
 uu_2                -2.457323e-02 1 1  ON 2
 uu_3                -2.421510e-02 1 1  ON 3
 uu_4                -2.125790e-02 1 1  ON 4
 uu_5                -1.471370e-02 1 1  ON 5
 uu_6                -9.716460e-03 1 1  ON 6
 uu_7                -6.772065e-03 1 1  ON 7
 uu_8                -5.378641e-03 1 1  ON 8
 uu_9                -3.329887e-03 1 1  ON 9
 ud_0                 1.977501e-01 1 1  ON 10
 ud_1                 9.935388e-03 1 1  ON 11
 ud_2                -4.686636e-02 1 1  ON 12
 ud_3                -4.394762e-02 1 1  ON 13
 ud_4                -3.777060e-02 1 1  ON 14
 ud_5                -2.817706e-02 1 1  ON 15
 ud_6                -2.027066e-02 1 1  ON 16
 ud_7                -1.375727e-02 1 1  ON 17
 ud_8                -8.732374e-03 1 1  ON 18
 ud_9                -4.552644e-03 1 1  ON 19
 eC_0                -5.076227e-02 1 1  ON 20
 eC_1                -3.803763e-02 1 1  ON 21
 eC_2                 3.933234e-02 1 1  ON 22
 eC_3                 3.981962e-02 1 1  ON 23
 eC_4                 1.938782e-02 1 1  ON 24
 eC_5                 1.499641e-03 1 1  ON 25
 eC_6                -6.590823e-03 1 1  ON 26
 eC_7                -2.974655e-03 1 1  ON 27
 eC_8                -1.058332e-03 1 1  ON 28
 eC_9                -4.363064e-04 1 1  ON 29
 eO_0                -1.712124e-01 1 1  ON 30
 eO_1                -6.201715e-02 1 1  ON 31
 eO_2                 9.437182e-02 1 1  ON 32
 eO_3                 8.427225e-02 1 1  ON 33
 eO_4                 5.496360e-02 1 1  ON 34
 eO_5                 2.255306e-02 1 1  ON 35
 eO_6                -9.572332e-03 1 1  ON 36
 eO_7                -7.997143e-03 1 1  ON 37
 eO_8                -3.369931e-03 1 1  ON 38
 eO_9                -1.163752e-03 1 1  ON 39
eH1_0                -1.766355e-02 1 1  ON 40
eH1_1                 1.121056e-02 1 1  ON 41
eH1_2                 1.524307e-02 1 1  ON 42
eH1_3                 9.912540e-04 1 1  ON 43
eH1_4                -9.631155e-03 1 1  ON 44
eH1_5                -3.405979e-03 1 1  ON 45
eH1_6                 6.769218e-03 1 1  ON 46
eH1_7                 6.629609e-05 1 1  ON 47
eH1_8                -2.410280e-03 1 1  ON 48
eH1_9                -7.605082e-04 1 1  ON 49
eH2_0                -1.767958e-02 1 1  ON 50
eH2_1                 1.115064e-02 1 1  ON 51
eH2_2                 1.530901e-02 1 1  ON 52
eH2_3                 1.196530e-03 1 1  ON 53
eH2_4                -9.313712e-03 1 1  ON 54
eH2_5                -3.188978e-03 1 1  ON 55
eH2_6                 6.610492e-03 1 1  ON 56
eH2_7                -1.648635e-04 1 1  ON 57
eH2_8                -2.544109e-03 1 1  ON 58
eH2_9                -9.243451e-04 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.3672e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORMP2PJWARM.s002 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORMP2PJWARM.s002 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=2  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2235e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 30888 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 2
    time step          = 0.05
    reference energy   = -22.2055
    reference variance = 0.725888
====================================================
  Execution time = 4.9227e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORMP2PJWARM.s002
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2322e+01
  VMC Evar = 8.1055e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.5991e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.810255653911
                                         uncertainty =       0.007392737357

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.810255653911
                                         uncertainty =       0.007392737357

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000636610619
  error estimate for blocks of size 2^( 2) =       0.000702603905
  error estimate for blocks of size 2^( 3) =       0.000766188051
  error estimate for blocks of size 2^( 4) =       0.000813688588
  error estimate for blocks of size 2^( 5) =       0.000841610494
  error estimate for blocks of size 2^( 6) =       0.000857528564
  error estimate for blocks of size 2^( 7) =       0.000867515528

      target function =                  N/A
              le_mean =     -22.321712513159
             les_mean =     499.069395276008
             stat err =       0.000845085794
             autocorr =       1.762194512754
              std dev =       0.900303371749
             le_variance =       0.810546161182


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.232171251316e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.5000e-01, overlap shift 2.5000e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.321712513159       residual = 6.71e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.326186325783       residual = 3.95e-02           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.331304881362       residual = 9.19e-02           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.336592041414       residual = 3.63e-02           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.344598604994       residual = 1.25e-02           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.347197290571       residual = 7.10e-03           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.348228674724       residual = 5.57e-03           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.349705320095       residual = 2.55e-03           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.350209415465       residual = 8.85e-04           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.350564496283       residual = 5.22e-04           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -22.350700441958       residual = 3.71e-04           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -22.350789884945       residual = 1.24e-04           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -22.350833099955       residual = 5.77e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -22.350854122257       residual = 1.90e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -22.350870191362       residual = 1.27e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -22.350878118776       residual = 2.92e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -22.350879152618       residual = 1.56e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   energy =     -22.350879314754       residual = 3.28e-07           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   energy =     -22.350879386825       residual = 9.34e-08           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   energy =     -22.350879456017       residual = 3.66e-08           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   energy =     -22.350879966263       residual = 1.06e-08           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   energy =     -22.350879898262       residual = 3.31e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         21 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 2.5000e-01 is 2.330133e-01

solving harmonic davidson linear method for identity shift 1.0000e+00, overlap shift 1.0000e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.321712513159       residual = 6.71e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.323436851144       residual = 4.39e-02           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.325182770250       residual = 1.06e-01           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.327566843458       residual = 2.87e-02           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.330678539074       residual = 1.04e-02           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.331394919691       residual = 6.89e-03           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.331718039339       residual = 1.79e-03           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.332015233691       residual = 9.87e-04           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.332122022004       residual = 3.62e-04           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.332172178850       residual = 1.04e-04           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -22.332186490826       residual = 5.50e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -22.332193313666       residual = 2.33e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -22.332196427644       residual = 4.86e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -22.332196605180       residual = 1.54e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -22.332196802867       residual = 7.88e-07           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -22.332196993281       residual = 1.93e-07           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -22.332197214070       residual = 1.03e-08           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   energy =     -22.332197249996       residual = 6.33e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         17 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.0000e+00 is 5.117733e-02

solving harmonic davidson linear method for identity shift 4.0000e+00, overlap shift 4.0000e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.321712513159       residual = 6.71e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.322211012388       residual = 4.65e-02           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.322696957106       residual = 1.12e-01           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.323449885565       residual = 2.61e-02           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.324337072012       residual = 9.65e-03           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.324514967730       residual = 6.55e-03           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.324614334355       residual = 1.27e-03           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.324674135421       residual = 5.70e-04           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.324695655562       residual = 2.34e-04           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.324703987319       residual = 5.18e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -22.324707162470       residual = 2.64e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -22.324708331831       residual = 8.13e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -22.324708833969       residual = 1.50e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -22.324708814445       residual = 8.85e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -22.324708790844       residual = 1.92e-07           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -22.324708769518       residual = 3.71e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -22.324708755876       residual = 4.40e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         16 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 4.0000e+00 is 1.226649e-02

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.042814 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 6.5234e+01
  </log>
  <optVariables href="FORMP2PJWARM.s002.opt.xml">
 uu_0                 1.111798e-01 1 1  ON 0
 uu_1                 2.718621e-02 1 1  ON 1
 uu_2                -2.858587e-02 1 1  ON 2
 uu_3                -3.227269e-02 1 1  ON 3
 uu_4                -2.784437e-02 1 1  ON 4
 uu_5                -1.966984e-02 1 1  ON 5
 uu_6                -1.198713e-02 1 1  ON 6
 uu_7                -7.393270e-03 1 1  ON 7
 uu_8                -5.233468e-03 1 1  ON 8
 uu_9                -2.829214e-03 1 1  ON 9
 ud_0                 2.305057e-01 1 1  ON 10
 ud_1                 1.773867e-02 1 1  ON 11
 ud_2                -5.217349e-02 1 1  ON 12
 ud_3                -5.490310e-02 1 1  ON 13
 ud_4                -4.683781e-02 1 1  ON 14
 ud_5                -3.570756e-02 1 1  ON 15
 ud_6                -2.497718e-02 1 1  ON 16
 ud_7                -1.612472e-02 1 1  ON 17
 ud_8                -9.605658e-03 1 1  ON 18
 ud_9                -4.514059e-03 1 1  ON 19
 eC_0                -7.031893e-02 1 1  ON 20
 eC_1                -5.047031e-02 1 1  ON 21
 eC_2                 4.879780e-02 1 1  ON 22
 eC_3                 5.403387e-02 1 1  ON 23
 eC_4                 2.731843e-02 1 1  ON 24
 eC_5                 4.184430e-03 1 1  ON 25
 eC_6                -8.229501e-03 1 1  ON 26
 eC_7                -3.524652e-03 1 1  ON 27
 eC_8                -1.105543e-03 1 1  ON 28
 eC_9                -4.698060e-04 1 1  ON 29
 eO_0                -2.223897e-01 1 1  ON 30
 eO_1                -7.983450e-02 1 1  ON 31
 eO_2                 1.112766e-01 1 1  ON 32
 eO_3                 1.103029e-01 1 1  ON 33
 eO_4                 7.475781e-02 1 1  ON 34
 eO_5                 3.303316e-02 1 1  ON 35
 eO_6                -1.068117e-02 1 1  ON 36
 eO_7                -1.015289e-02 1 1  ON 37
 eO_8                -4.165445e-03 1 1  ON 38
 eO_9                -1.268058e-03 1 1  ON 39
eH1_0                -2.342369e-02 1 1  ON 40
eH1_1                 1.420069e-02 1 1  ON 41
eH1_2                 1.800039e-02 1 1  ON 42
eH1_3                 4.886444e-04 1 1  ON 43
eH1_4                -1.078724e-02 1 1  ON 44
eH1_5                -4.412382e-03 1 1  ON 45
eH1_6                 9.025679e-03 1 1  ON 46
eH1_7                 1.227472e-03 1 1  ON 47
eH1_8                -3.016202e-03 1 1  ON 48
eH1_9                -8.693315e-04 1 1  ON 49
eH2_0                -2.350800e-02 1 1  ON 50
eH2_1                 1.394932e-02 1 1  ON 51
eH2_2                 1.814754e-02 1 1  ON 52
eH2_3                 6.979503e-04 1 1  ON 53
eH2_4                -1.054427e-02 1 1  ON 54
eH2_5                -4.098955e-03 1 1  ON 55
eH2_6                 8.785592e-03 1 1  ON 56
eH2_7                 1.033077e-03 1 1  ON 57
eH2_8                -3.011040e-03 1 1  ON 58
eH2_9                -9.819192e-04 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 2
    time step          = 0.05
    reference energy   = -22.4433
    reference variance = 0.361919
====================================================
  Execution time = 4.9956e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORMP2PJWARM.s002
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2342e+01
  VMC Evar = 7.0509e-01
  Total weights = 2.0000e+06
  Execution time = 4.5495e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.781464847518
                                         uncertainty =       0.002461720400

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.781464847518
                                         uncertainty =       0.002461720400

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000625093491
  error estimate for blocks of size 2^( 2) =       0.000689774419
  error estimate for blocks of size 2^( 3) =       0.000751922179
  error estimate for blocks of size 2^( 4) =       0.000796949218
  error estimate for blocks of size 2^( 5) =       0.000826344962
  error estimate for blocks of size 2^( 6) =       0.000843954411
  error estimate for blocks of size 2^( 7) =       0.000851427737

      target function =                  N/A
              le_mean =     -22.344718279009
             les_mean =     500.067918323150
             stat err =       0.000829669082
             autocorr =       1.761650935238
              std dev =       0.884015693079
             le_variance =       0.781483745610

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.618713707651
                                         uncertainty =       0.003220947741

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.618713707651
                                         uncertainty =       0.003220947741

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000556171220
  error estimate for blocks of size 2^( 2) =       0.000597923931
  error estimate for blocks of size 2^( 3) =       0.000641749315
  error estimate for blocks of size 2^( 4) =       0.000675862600
  error estimate for blocks of size 2^( 5) =       0.000698362312
  error estimate for blocks of size 2^( 6) =       0.000712020779
  error estimate for blocks of size 2^( 7) =       0.000718748277

      target function =                  N/A
              le_mean =     -22.359802149271
             les_mean =     500.579404696548
             stat err =       0.000701248492
             autocorr =       1.589742765390
              std dev =       0.786544881947
             le_variance =       0.618652851317

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.660364249241
                                         uncertainty =       0.002758463500

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.660364249241
                                         uncertainty =       0.002758463500

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000574603242
  error estimate for blocks of size 2^( 2) =       0.000628344300
  error estimate for blocks of size 2^( 3) =       0.000682505222
  error estimate for blocks of size 2^( 4) =       0.000723054200
  error estimate for blocks of size 2^( 5) =       0.000749595979
  error estimate for blocks of size 2^( 6) =       0.000765720175
  error estimate for blocks of size 2^( 7) =       0.000772939209

      target function =                  N/A
              le_mean =     -22.344512649638
             les_mean =     499.937582991801
             stat err =       0.000752827391
             autocorr =       1.716542968894
              std dev =       0.812611698240
             le_variance =       0.660337772116

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.759300492451
                                         uncertainty =       0.002483859298

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.759300492451
                                         uncertainty =       0.002483859298

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000616162771
  error estimate for blocks of size 2^( 2) =       0.000679562994
  error estimate for blocks of size 2^( 3) =       0.000740842689
  error estimate for blocks of size 2^( 4) =       0.000785403644
  error estimate for blocks of size 2^( 5) =       0.000814497773
  error estimate for blocks of size 2^( 6) =       0.000831967207
  error estimate for blocks of size 2^( 7) =       0.000839427319

      target function =                  N/A
              le_mean =     -22.343669454956
             les_mean =     499.998877454151
             stat err =       0.000817823986
             autocorr =       1.761687116663
              std dev =       0.871385747802
             le_variance =       0.759313121472


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.344718279009        initial
     2.5000e-01     2.5000e+00             2.3301e-01       -22.359802149271  <--
     1.0000e+00     1.0000e+01             5.1177e-02       -22.344512649638
     4.0000e+00     4.0000e+01             1.2266e-02       -22.343669454956

*****************************************************************************
Applying the update for shift_i =   2.5000e-01     and shift_s =   2.5000e+00
*****************************************************************************

  Execution time = 7.2793e+01
  </log>
  <optVariables href="FORMP2PJWARM.s002.opt.xml">
 uu_0                 1.777058e-01 1 1  ON 0
 uu_1                 3.998192e-02 1 1  ON 1
 uu_2                -3.808942e-02 1 1  ON 2
 uu_3                -5.845048e-02 1 1  ON 3
 uu_4                -5.309870e-02 1 1  ON 4
 uu_5                -4.003522e-02 1 1  ON 5
 uu_6                -2.271391e-02 1 1  ON 6
 uu_7                -8.564476e-03 1 1  ON 7
 uu_8                -1.206280e-03 1 1  ON 8
 uu_9                 2.402598e-03 1 1  ON 9
 ud_0                 3.168257e-01 1 1  ON 10
 ud_1                 4.815540e-02 1 1  ON 11
 ud_2                -5.950761e-02 1 1  ON 12
 ud_3                -8.566988e-02 1 1  ON 13
 ud_4                -7.805688e-02 1 1  ON 14
 ud_5                -6.321128e-02 1 1  ON 15
 ud_6                -4.342689e-02 1 1  ON 16
 ud_7                -2.406125e-02 1 1  ON 17
 ud_8                -1.017927e-02 1 1  ON 18
 ud_9                -1.403198e-03 1 1  ON 19
 eC_0                -1.543460e-01 1 1  ON 20
 eC_1                -9.828997e-02 1 1  ON 21
 eC_2                 7.389036e-02 1 1  ON 22
 eC_3                 1.089242e-01 1 1  ON 23
 eC_4                 6.640963e-02 1 1  ON 24
 eC_5                 2.284472e-02 1 1  ON 25
 eC_6                -1.283665e-02 1 1  ON 26
 eC_7                -5.010664e-03 1 1  ON 27
 eC_8                -8.807385e-04 1 1  ON 28
 eC_9                -4.167346e-04 1 1  ON 29
 eO_0                -4.042257e-01 1 1  ON 30
 eO_1                -1.511459e-01 1 1  ON 31
 eO_2                 1.474373e-01 1 1  ON 32
 eO_3                 1.976715e-01 1 1  ON 33
 eO_4                 1.555535e-01 1 1  ON 34
 eO_5                 8.575153e-02 1 1  ON 35
 eO_6                -4.995776e-03 1 1  ON 36
 eO_7                -1.698732e-02 1 1  ON 37
 eO_8                -7.113359e-03 1 1  ON 38
 eO_9                -1.260983e-03 1 1  ON 39
eH1_0                -4.577531e-02 1 1  ON 40
eH1_1                 2.168774e-02 1 1  ON 41
eH1_2                 2.372676e-02 1 1  ON 42
eH1_3                -2.635443e-03 1 1  ON 43
eH1_4                -1.084306e-02 1 1  ON 44
eH1_5                -7.297556e-03 1 1  ON 45
eH1_6                 1.780366e-02 1 1  ON 46
eH1_7                 9.026565e-03 1 1  ON 47
eH1_8                -4.452433e-03 1 1  ON 48
eH1_9                -9.207714e-04 1 1  ON 49
eH2_0                -4.602628e-02 1 1  ON 50
eH2_1                 2.091786e-02 1 1  ON 51
eH2_2                 2.414949e-02 1 1  ON 52
eH2_3                -2.418234e-03 1 1  ON 53
eH2_4                -1.088292e-02 1 1  ON 54
eH2_5                -6.940625e-03 1 1  ON 55
eH2_6                 1.720575e-02 1 1  ON 56
eH2_7                 8.998274e-03 1 1  ON 57
eH2_8                -3.876321e-03 1 1  ON 58
eH2_9                -8.156743e-04 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.3803e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORMP2PJWARM.s003 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORMP2PJWARM.s003 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=3  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2265e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 30888 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 3
    time step          = 0.05
    reference energy   = -22.3884
    reference variance = 0.681041
====================================================
  Execution time = 4.8983e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORMP2PJWARM.s003
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2389e+01
  VMC Evar = 5.9774e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.5989e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.597747343649
                                         uncertainty =       0.003676888439

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.597747343649
                                         uncertainty =       0.003676888439

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000546690060
  error estimate for blocks of size 2^( 2) =       0.000585840442
  error estimate for blocks of size 2^( 3) =       0.000626030870
  error estimate for blocks of size 2^( 4) =       0.000657915726
  error estimate for blocks of size 2^( 5) =       0.000677326861
  error estimate for blocks of size 2^( 6) =       0.000691127572
  error estimate for blocks of size 2^( 7) =       0.000696295491

      target function =                  N/A
              le_mean =     -22.389037093628
             les_mean =     501.866721724809
             stat err =       0.000680666413
             autocorr =       1.550194837776
              std dev =       0.773136497551
             le_variance =       0.597740043846


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.238903709363e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.2500e-02, overlap shift 6.2500e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.389037093628       residual = 6.16e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.389650459238       residual = 4.97e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.391752223099       residual = 1.37e-02           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.394791035570       residual = 7.88e-03           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.396977008108       residual = 6.85e-03           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.399063021011       residual = 3.90e-03           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.399777074518       residual = 2.03e-03           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.400792097154       residual = 9.19e-04           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.401139591140       residual = 8.30e-04           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.401571953638       residual = 6.56e-04           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -22.401883166431       residual = 4.28e-04           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -22.402003622633       residual = 1.31e-04           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -22.402120751018       residual = 2.00e-04           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -22.402249253253       residual = 5.12e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -22.402283816160       residual = 3.43e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -22.402304148513       residual = 1.48e-05           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -22.402315924306       residual = 9.17e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   energy =     -22.402335055380       residual = 3.77e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   energy =     -22.402348862967       residual = 2.87e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   energy =     -22.402350175127       residual = 8.73e-07           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   energy =     -22.402348181371       residual = 2.31e-07           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   energy =     -22.402347265551       residual = 1.32e-07           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   energy =     -22.402349145887       residual = 3.58e-08           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   energy =     -22.402349086656       residual = 2.16e-08           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   energy =     -22.402349298178       residual = 5.13e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         24 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 6.2500e-02 is 3.253146e-01

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 2.5000e-01, overlap shift 2.5000e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.389037093628       residual = 6.16e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.389367781146       residual = 5.25e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.390323413490       residual = 1.08e-02           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.391885746840       residual = 6.99e-03           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.392949048456       residual = 3.76e-03           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.393587115142       residual = 2.40e-03           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.393900551235       residual = 6.34e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.394125692985       residual = 2.36e-04           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.394208057356       residual = 1.77e-04           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.394257790816       residual = 9.80e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -22.394289255939       residual = 3.10e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -22.394299670402       residual = 2.35e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -22.394304843895       residual = 1.31e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -22.394308769921       residual = 4.21e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -22.394309551063       residual = 1.76e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -22.394309544853       residual = 3.14e-07           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -22.394309971913       residual = 9.36e-08           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   energy =     -22.394310749080       residual = 1.07e-07           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   energy =     -22.394310996949       residual = 3.16e-08           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   energy =     -22.394311048567       residual = 5.32e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         19 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 2.5000e-01 is 7.214781e-02

solving harmonic davidson linear method for identity shift 1.0000e+00, overlap shift 1.0000e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.389037093628       residual = 6.16e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.389153382361       residual = 5.63e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.389473506977       residual = 9.41e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.389970313836       residual = 5.74e-03           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.390348051011       residual = 2.74e-03           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.390496938912       residual = 1.07e-03           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.390578671866       residual = 2.41e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.390614030131       residual = 8.57e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.390628114056       residual = 2.93e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.390633307425       residual = 1.95e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -22.390635385041       residual = 4.96e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -22.390635705836       residual = 1.88e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -22.390636418465       residual = 8.64e-07           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -22.390636436865       residual = 2.66e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -22.390636264278       residual = 5.98e-08           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -22.390636234273       residual = 2.05e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -22.390636212129       residual = 6.16e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         16 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.0000e+00 is 1.918640e-02

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.058895 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 6.4992e+01
  </log>
  <optVariables href="FORMP2PJWARM.s003.opt.xml">
 uu_0                 1.952260e-01 1 1  ON 0
 uu_1                 4.698110e-02 1 1  ON 1
 uu_2                -3.781349e-02 1 1  ON 2
 uu_3                -6.609695e-02 1 1  ON 3
 uu_4                -6.508456e-02 1 1  ON 4
 uu_5                -5.161044e-02 1 1  ON 5
 uu_6                -3.144552e-02 1 1  ON 6
 uu_7                -9.902368e-03 1 1  ON 7
 uu_8                 3.610483e-03 1 1  ON 8
 uu_9                 8.192987e-03 1 1  ON 9
 ud_0                 3.294716e-01 1 1  ON 10
 ud_1                 6.186986e-02 1 1  ON 11
 ud_2                -5.339865e-02 1 1  ON 12
 ud_3                -9.027532e-02 1 1  ON 13
 ud_4                -8.932274e-02 1 1  ON 14
 ud_5                -7.540325e-02 1 1  ON 15
 ud_6                -5.364002e-02 1 1  ON 16
 ud_7                -2.919737e-02 1 1  ON 17
 ud_8                -9.041432e-03 1 1  ON 18
 ud_9                 2.999695e-03 1 1  ON 19
 eC_0                -2.023577e-01 1 1  ON 20
 eC_1                -1.221880e-01 1 1  ON 21
 eC_2                 7.389730e-02 1 1  ON 22
 eC_3                 1.335010e-01 1 1  ON 23
 eC_4                 9.440776e-02 1 1  ON 24
 eC_5                 4.141565e-02 1 1  ON 25
 eC_6                -1.260824e-02 1 1  ON 26
 eC_7                -5.153370e-03 1 1  ON 27
 eC_8                -5.328033e-04 1 1  ON 28
 eC_9                -2.003596e-04 1 1  ON 29
 eO_0                -4.763735e-01 1 1  ON 30
 eO_1                -1.909832e-01 1 1  ON 31
 eO_2                 1.376346e-01 1 1  ON 32
 eO_3                 2.252230e-01 1 1  ON 33
 eO_4                 1.975021e-01 1 1  ON 34
 eO_5                 1.241980e-01 1 1  ON 35
 eO_6                 1.025211e-02 1 1  ON 36
 eO_7                -1.832451e-02 1 1  ON 37
 eO_8                -8.371729e-03 1 1  ON 38
 eO_9                -6.781375e-04 1 1  ON 39
eH1_0                -5.683295e-02 1 1  ON 40
eH1_1                 2.035507e-02 1 1  ON 41
eH1_2                 2.289746e-02 1 1  ON 42
eH1_3                -4.683104e-03 1 1  ON 43
eH1_4                -7.103682e-03 1 1  ON 44
eH1_5                -7.318156e-03 1 1  ON 45
eH1_6                 2.116354e-02 1 1  ON 46
eH1_7                 1.630204e-02 1 1  ON 47
eH1_8                -4.047951e-03 1 1  ON 48
eH1_9                -7.190415e-04 1 1  ON 49
eH2_0                -5.721042e-02 1 1  ON 50
eH2_1                 1.978498e-02 1 1  ON 51
eH2_2                 2.231942e-02 1 1  ON 52
eH2_3                -4.221878e-03 1 1  ON 53
eH2_4                -7.175608e-03 1 1  ON 54
eH2_5                -6.893815e-03 1 1  ON 55
eH2_6                 2.097118e-02 1 1  ON 56
eH2_7                 1.600386e-02 1 1  ON 57
eH2_8                -3.134911e-03 1 1  ON 58
eH2_9                -4.502441e-04 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 3
    time step          = 0.05
    reference energy   = -22.4029
    reference variance = 0.35223
====================================================
  Execution time = 4.8497e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORMP2PJWARM.s003
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2399e+01
  VMC Evar = 5.7959e-01
  Total weights = 2.0000e+06
  Execution time = 4.5654e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.599024738409
                                         uncertainty =       0.006459673528

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.599024738409
                                         uncertainty =       0.006459673528

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000547255865
  error estimate for blocks of size 2^( 2) =       0.000585312849
  error estimate for blocks of size 2^( 3) =       0.000624584237
  error estimate for blocks of size 2^( 4) =       0.000653895786
  error estimate for blocks of size 2^( 5) =       0.000672529005
  error estimate for blocks of size 2^( 6) =       0.000682006826
  error estimate for blocks of size 2^( 7) =       0.000689262423

      target function =                  N/A
              le_mean =     -22.400767808896
             les_mean =     502.393376091637
             stat err =       0.000674423510
             autocorr =       1.518743924245
              std dev =       0.773936666059
             le_variance =       0.598977963071

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.598644882044
                                         uncertainty =       0.006368948542

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.598644882044
                                         uncertainty =       0.006368948542

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000547066850
  error estimate for blocks of size 2^( 2) =       0.000572070817
  error estimate for blocks of size 2^( 3) =       0.000597370059
  error estimate for blocks of size 2^( 4) =       0.000616449993
  error estimate for blocks of size 2^( 5) =       0.000629370956
  error estimate for blocks of size 2^( 6) =       0.000636378741
  error estimate for blocks of size 2^( 7) =       0.000642219217

      target function =                  N/A
              le_mean =     -22.412135463731
             les_mean =     502.902380022156
             stat err =       0.000631104727
             autocorr =       1.330828422833
              std dev =       0.773669358843
             le_variance =       0.598564276813

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.573881956835
                                         uncertainty =       0.006299823546

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.573881956835
                                         uncertainty =       0.006299823546

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000535639221
  error estimate for blocks of size 2^( 2) =       0.000566485995
  error estimate for blocks of size 2^( 3) =       0.000598595938
  error estimate for blocks of size 2^( 4) =       0.000623100330
  error estimate for blocks of size 2^( 5) =       0.000639208921
  error estimate for blocks of size 2^( 6) =       0.000647404788
  error estimate for blocks of size 2^( 7) =       0.000654185793

      target function =                  N/A
              le_mean =     -22.400651739798
             les_mean =     502.363016831374
             stat err =       0.000640974958
             autocorr =       1.431981427688
              std dev =       0.757508251161
             le_variance =       0.573818750578

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.591198492287
                                         uncertainty =       0.006420458800

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.591198492287
                                         uncertainty =       0.006420458800

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000543667827
  error estimate for blocks of size 2^( 2) =       0.000580682078
  error estimate for blocks of size 2^( 3) =       0.000618973936
  error estimate for blocks of size 2^( 4) =       0.000647669554
  error estimate for blocks of size 2^( 5) =       0.000665991675
  error estimate for blocks of size 2^( 6) =       0.000675285823
  error estimate for blocks of size 2^( 7) =       0.000682469426

      target function =                  N/A
              le_mean =     -22.400039142635
             les_mean =     502.352902708585
             stat err =       0.000667854120
             autocorr =       1.509023321912
              std dev =       0.768862414609
             le_variance =       0.591149412598


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.400767808896        initial  <--
            N/A            N/A                    N/A                    N/A     bad update
     2.5000e-01     2.5000e+00             7.2148e-02       -22.400651739798
     1.0000e+00     1.0000e+01             1.9186e-02       -22.400039142635

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 71.4869
  </log>
  <optVariables href="FORMP2PJWARM.s003.opt.xml">
 uu_0                 1.777058e-01 1 1  ON 0
 uu_1                 3.998192e-02 1 1  ON 1
 uu_2                -3.808942e-02 1 1  ON 2
 uu_3                -5.845048e-02 1 1  ON 3
 uu_4                -5.309870e-02 1 1  ON 4
 uu_5                -4.003522e-02 1 1  ON 5
 uu_6                -2.271391e-02 1 1  ON 6
 uu_7                -8.564476e-03 1 1  ON 7
 uu_8                -1.206280e-03 1 1  ON 8
 uu_9                 2.402598e-03 1 1  ON 9
 ud_0                 3.168257e-01 1 1  ON 10
 ud_1                 4.815540e-02 1 1  ON 11
 ud_2                -5.950761e-02 1 1  ON 12
 ud_3                -8.566988e-02 1 1  ON 13
 ud_4                -7.805688e-02 1 1  ON 14
 ud_5                -6.321128e-02 1 1  ON 15
 ud_6                -4.342689e-02 1 1  ON 16
 ud_7                -2.406125e-02 1 1  ON 17
 ud_8                -1.017927e-02 1 1  ON 18
 ud_9                -1.403198e-03 1 1  ON 19
 eC_0                -1.543460e-01 1 1  ON 20
 eC_1                -9.828997e-02 1 1  ON 21
 eC_2                 7.389036e-02 1 1  ON 22
 eC_3                 1.089242e-01 1 1  ON 23
 eC_4                 6.640963e-02 1 1  ON 24
 eC_5                 2.284472e-02 1 1  ON 25
 eC_6                -1.283665e-02 1 1  ON 26
 eC_7                -5.010664e-03 1 1  ON 27
 eC_8                -8.807385e-04 1 1  ON 28
 eC_9                -4.167346e-04 1 1  ON 29
 eO_0                -4.042257e-01 1 1  ON 30
 eO_1                -1.511459e-01 1 1  ON 31
 eO_2                 1.474373e-01 1 1  ON 32
 eO_3                 1.976715e-01 1 1  ON 33
 eO_4                 1.555535e-01 1 1  ON 34
 eO_5                 8.575153e-02 1 1  ON 35
 eO_6                -4.995776e-03 1 1  ON 36
 eO_7                -1.698732e-02 1 1  ON 37
 eO_8                -7.113359e-03 1 1  ON 38
 eO_9                -1.260983e-03 1 1  ON 39
eH1_0                -4.577531e-02 1 1  ON 40
eH1_1                 2.168774e-02 1 1  ON 41
eH1_2                 2.372676e-02 1 1  ON 42
eH1_3                -2.635443e-03 1 1  ON 43
eH1_4                -1.084306e-02 1 1  ON 44
eH1_5                -7.297556e-03 1 1  ON 45
eH1_6                 1.780366e-02 1 1  ON 46
eH1_7                 9.026565e-03 1 1  ON 47
eH1_8                -4.452433e-03 1 1  ON 48
eH1_9                -9.207714e-04 1 1  ON 49
eH2_0                -4.602628e-02 1 1  ON 50
eH2_1                 2.091786e-02 1 1  ON 51
eH2_2                 2.414949e-02 1 1  ON 52
eH2_3                -2.418234e-03 1 1  ON 53
eH2_4                -1.088292e-02 1 1  ON 54
eH2_5                -6.940625e-03 1 1  ON 55
eH2_6                 1.720575e-02 1 1  ON 56
eH2_7                 8.998274e-03 1 1  ON 57
eH2_8                -3.876321e-03 1 1  ON 58
eH2_9                -8.156743e-04 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.3649e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORMP2PJWARM.s004 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORMP2PJWARM.s004 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=4  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2298e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 30888 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 4
    time step          = 0.05
    reference energy   = -22.314
    reference variance = 0.50504
====================================================
  Execution time = 4.9518e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORMP2PJWARM.s004
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2388e+01
  VMC Evar = 6.0162e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.5934e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.601625882358
                                         uncertainty =       0.006921044843

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.601625882358
                                         uncertainty =       0.006921044843

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000548461184
  error estimate for blocks of size 2^( 2) =       0.000587562180
  error estimate for blocks of size 2^( 3) =       0.000627159263
  error estimate for blocks of size 2^( 4) =       0.000658216706
  error estimate for blocks of size 2^( 5) =       0.000678710795
  error estimate for blocks of size 2^( 6) =       0.000692195449
  error estimate for blocks of size 2^( 7) =       0.000695012745

      target function =                  N/A
              le_mean =     -22.388334752869
             les_mean =     501.839152047180
             stat err =       0.000681033924
             autocorr =       1.541862680230
              std dev =       0.775641245349
             le_variance =       0.601619341487


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.238833475287e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.2500e-01, overlap shift 6.2500e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.388334752869       residual = 6.72e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.388495221327       residual = 5.18e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.388974212159       residual = 9.55e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.389749458483       residual = 6.12e-03           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.390294684782       residual = 2.92e-03           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.390512902281       residual = 1.41e-03           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.390659279785       residual = 3.08e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.390723266871       residual = 1.11e-04           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.390742483203       residual = 4.71e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.390754088090       residual = 2.97e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -22.390756642118       residual = 8.88e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -22.390758414776       residual = 3.69e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -22.390760358706       residual = 1.31e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -22.390760709890       residual = 7.08e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -22.390761175794       residual = 1.76e-07           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -22.390761203319       residual = 5.09e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -22.390761220076       residual = 1.95e-08           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   energy =     -22.390761239491       residual = 7.08e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         17 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 6.2500e-01 is 3.008881e-02

solving harmonic davidson linear method for identity shift 2.5000e+00, overlap shift 2.5000e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.388334752869       residual = 6.72e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.388381840882       residual = 5.41e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.388521909073       residual = 9.10e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.388737965857       residual = 5.16e-03           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.388894068412       residual = 2.60e-03           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.388949319550       residual = 8.45e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.388984059518       residual = 1.57e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.388995009364       residual = 6.22e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.388998139607       residual = 1.48e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.389000146547       residual = 1.07e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -22.389000057857       residual = 2.40e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -22.389000109382       residual = 8.84e-07           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -22.389000242064       residual = 4.10e-07           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -22.389000306158       residual = 1.13e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -22.389000339977       residual = 3.65e-08           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -22.389000311756       residual = 8.02e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         15 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 2.5000e+00 is 7.866205e-03

solving harmonic davidson linear method for identity shift 1.0000e+01, overlap shift 1.0000e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.388334752869       residual = 6.72e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.388347059433       residual = 5.49e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.388383841086       residual = 9.04e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.388439756878       residual = 4.83e-03           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.388479530599       residual = 2.51e-03           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.388493595007       residual = 7.26e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.388502240775       residual = 1.23e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.388504615028       residual = 4.97e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.388505235037       residual = 1.05e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.388505662552       residual = 7.53e-06           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -22.388505624867       residual = 1.45e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -22.388505640821       residual = 5.73e-07           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -22.388505642254       residual = 2.47e-07           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -22.388505653272       residual = 7.46e-08           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -22.388505662495       residual = 1.51e-08           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -22.388505654687       residual = 2.80e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         15 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.0000e+01 is 1.998572e-03

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.068218 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 6.5467e+01
  </log>
  <optVariables href="FORMP2PJWARM.s004.opt.xml">
 uu_0                 1.797465e-01 1 1  ON 0
 uu_1                 4.061428e-02 1 1  ON 1
 uu_2                -3.816669e-02 1 1  ON 2
 uu_3                -5.941659e-02 1 1  ON 3
 uu_4                -5.444968e-02 1 1  ON 4
 uu_5                -4.114022e-02 1 1  ON 5
 uu_6                -2.347045e-02 1 1  ON 6
 uu_7                -8.459212e-03 1 1  ON 7
 uu_8                -7.046105e-04 1 1  ON 8
 uu_9                 2.896749e-03 1 1  ON 9
 ud_0                 3.175819e-01 1 1  ON 10
 ud_1                 4.977986e-02 1 1  ON 11
 ud_2                -5.872088e-02 1 1  ON 12
 ud_3                -8.628607e-02 1 1  ON 13
 ud_4                -7.934362e-02 1 1  ON 14
 ud_5                -6.442429e-02 1 1  ON 15
 ud_6                -4.430790e-02 1 1  ON 16
 ud_7                -2.435416e-02 1 1  ON 17
 ud_8                -9.915240e-03 1 1  ON 18
 ud_9                -1.015204e-03 1 1  ON 19
 eC_0                -1.593544e-01 1 1  ON 20
 eC_1                -1.006128e-01 1 1  ON 21
 eC_2                 7.430885e-02 1 1  ON 22
 eC_3                 1.117567e-01 1 1  ON 23
 eC_4                 6.901845e-02 1 1  ON 24
 eC_5                 2.434019e-02 1 1  ON 25
 eC_6                -1.291028e-02 1 1  ON 26
 eC_7                -5.034977e-03 1 1  ON 27
 eC_8                -8.378016e-04 1 1  ON 28
 eC_9                -3.958186e-04 1 1  ON 29
 eO_0                -4.120919e-01 1 1  ON 30
 eO_1                -1.548897e-01 1 1  ON 31
 eO_2                 1.467822e-01 1 1  ON 32
 eO_3                 2.011237e-01 1 1  ON 33
 eO_4                 1.600498e-01 1 1  ON 34
 eO_5                 8.928424e-02 1 1  ON 35
 eO_6                -3.968498e-03 1 1  ON 36
 eO_7                -1.721841e-02 1 1  ON 37
 eO_8                -7.228198e-03 1 1  ON 38
 eO_9                -1.214492e-03 1 1  ON 39
eH1_0                -4.692900e-02 1 1  ON 40
eH1_1                 2.174958e-02 1 1  ON 41
eH1_2                 2.368901e-02 1 1  ON 42
eH1_3                -2.949715e-03 1 1  ON 43
eH1_4                -1.045183e-02 1 1  ON 44
eH1_5                -7.327505e-03 1 1  ON 45
eH1_6                 1.816384e-02 1 1  ON 46
eH1_7                 9.674425e-03 1 1  ON 47
eH1_8                -4.428641e-03 1 1  ON 48
eH1_9                -8.929487e-04 1 1  ON 49
eH2_0                -4.721216e-02 1 1  ON 50
eH2_1                 2.101034e-02 1 1  ON 51
eH2_2                 2.405739e-02 1 1  ON 52
eH2_3                -2.676998e-03 1 1  ON 53
eH2_4                -1.049419e-02 1 1  ON 54
eH2_5                -6.966388e-03 1 1  ON 55
eH2_6                 1.757365e-02 1 1  ON 56
eH2_7                 9.615856e-03 1 1  ON 57
eH2_8                -3.845535e-03 1 1  ON 58
eH2_9                -7.811355e-04 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 4
    time step          = 0.05
    reference energy   = -22.4443
    reference variance = 0.65557
====================================================
  Execution time = 4.9583e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORMP2PJWARM.s004
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2389e+01
  VMC Evar = 5.8860e-01
  Total weights = 2.0000e+06
  Execution time = 4.6096e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.592444747636
                                         uncertainty =       0.003369265222

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.592444747636
                                         uncertainty =       0.003369265222

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000544225751
  error estimate for blocks of size 2^( 2) =       0.000583640250
  error estimate for blocks of size 2^( 3) =       0.000623361983
  error estimate for blocks of size 2^( 4) =       0.000655407084
  error estimate for blocks of size 2^( 5) =       0.000675614284
  error estimate for blocks of size 2^( 6) =       0.000685608468
  error estimate for blocks of size 2^( 7) =       0.000686722874

      target function =                  N/A
              le_mean =     -22.388778566682
             les_mean =     501.849768747311
             stat err =       0.000675838178
             autocorr =       1.542152307047
              std dev =       0.769651437712
             le_variance =       0.592363335573

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.581128138426
                                         uncertainty =       0.003442504502

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.581128138426
                                         uncertainty =       0.003442504502

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000539002111
  error estimate for blocks of size 2^( 2) =       0.000576692317
  error estimate for blocks of size 2^( 3) =       0.000614718787
  error estimate for blocks of size 2^( 4) =       0.000645590423
  error estimate for blocks of size 2^( 5) =       0.000665203765
  error estimate for blocks of size 2^( 6) =       0.000674863347
  error estimate for blocks of size 2^( 7) =       0.000675680041

      target function =                  N/A
              le_mean =     -22.388884629691
             les_mean =     501.843201222431
             stat err =       0.000665334394
             autocorr =       1.523698419250
              std dev =       0.762264095520
             le_variance =       0.581046551319

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.585162684254
                                         uncertainty =       0.003399347663

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.585162684254
                                         uncertainty =       0.003399347663

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000540870544
  error estimate for blocks of size 2^( 2) =       0.000579419879
  error estimate for blocks of size 2^( 3) =       0.000618295662
  error estimate for blocks of size 2^( 4) =       0.000649759350
  error estimate for blocks of size 2^( 5) =       0.000669674090
  error estimate for blocks of size 2^( 6) =       0.000679491279
  error estimate for blocks of size 2^( 7) =       0.000680440621

      target function =                  N/A
              le_mean =     -22.388760781632
             les_mean =     501.841690935621
             stat err =       0.000669841335
             autocorr =       1.533759362559
              std dev =       0.764906458985
             le_variance =       0.585081890997

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.591404460596
                                         uncertainty =       0.003372519403

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.591404460596
                                         uncertainty =       0.003372519403

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000543747720
  error estimate for blocks of size 2^( 2) =       0.000583053745
  error estimate for blocks of size 2^( 3) =       0.000622670031
  error estimate for blocks of size 2^( 4) =       0.000654643056
  error estimate for blocks of size 2^( 5) =       0.000674814134
  error estimate for blocks of size 2^( 6) =       0.000684785760
  error estimate for blocks of size 2^( 7) =       0.000685878505

      target function =                  N/A
              le_mean =     -22.388765928934
             les_mean =     501.848162690221
             stat err =       0.000675030364
             autocorr =       1.541174162897
              std dev =       0.768975399671
             le_variance =       0.591323165299


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.388778566682        initial
     6.2500e-01     6.2500e+00             3.0089e-02       -22.388884629691  <--
     2.5000e+00     2.5000e+01             7.8662e-03       -22.388760781632
     1.0000e+01     1.0000e+02             1.9986e-03       -22.388765928934

*****************************************************************************
Applying the update for shift_i =   6.2500e-01     and shift_s =   6.2500e+00
*****************************************************************************

  Execution time = 7.2577e+01
  </log>
  <optVariables href="FORMP2PJWARM.s004.opt.xml">
 uu_0                 1.853666e-01 1 1  ON 0
 uu_1                 4.265370e-02 1 1  ON 1
 uu_2                -3.823542e-02 1 1  ON 2
 uu_3                -6.196416e-02 1 1  ON 3
 uu_4                -5.820116e-02 1 1  ON 4
 uu_5                -4.453928e-02 1 1  ON 5
 uu_6                -2.588031e-02 1 1  ON 6
 uu_7                -8.531965e-03 1 1  ON 7
 uu_8                 7.432282e-04 1 1  ON 8
 uu_9                 4.473600e-03 1 1  ON 9
 ud_0                 3.210232e-01 1 1  ON 10
 ud_1                 5.404871e-02 1 1  ON 11
 ud_2                -5.679487e-02 1 1  ON 12
 ud_3                -8.785111e-02 1 1  ON 13
 ud_4                -8.297055e-02 1 1  ON 14
 ud_5                -6.816910e-02 1 1  ON 15
 ud_6                -4.722401e-02 1 1  ON 16
 ud_7                -2.554570e-02 1 1  ON 17
 ud_8                -9.250473e-03 1 1  ON 18
 ud_9                 2.089473e-04 1 1  ON 19
 eC_0                -1.740024e-01 1 1  ON 20
 eC_1                -1.075424e-01 1 1  ON 21
 eC_2                 7.493214e-02 1 1  ON 22
 eC_3                 1.195946e-01 1 1  ON 23
 eC_4                 7.716143e-02 1 1  ON 24
 eC_5                 2.923352e-02 1 1  ON 25
 eC_6                -1.301617e-02 1 1  ON 26
 eC_7                -5.085177e-03 1 1  ON 27
 eC_8                -7.002108e-04 1 1  ON 28
 eC_9                -3.291874e-04 1 1  ON 29
 eO_0                -4.343145e-01 1 1  ON 30
 eO_1                -1.664991e-01 1 1  ON 31
 eO_2                 1.444509e-01 1 1  ON 32
 eO_3                 2.101813e-01 1 1  ON 33
 eO_4                 1.730104e-01 1 1  ON 34
 eO_5                 1.002629e-01 1 1  ON 35
 eO_6                -2.103071e-04 1 1  ON 36
 eO_7                -1.778617e-02 1 1  ON 37
 eO_8                -7.582598e-03 1 1  ON 38
 eO_9                -1.064281e-03 1 1  ON 39
eH1_0                -5.025611e-02 1 1  ON 40
eH1_1                 2.160513e-02 1 1  ON 41
eH1_2                 2.345776e-02 1 1  ON 42
eH1_3                -3.703111e-03 1 1  ON 43
eH1_4                -9.329480e-03 1 1  ON 44
eH1_5                -7.369590e-03 1 1  ON 45
eH1_6                 1.918991e-02 1 1  ON 46
eH1_7                 1.172119e-02 1 1  ON 47
eH1_8                -4.297034e-03 1 1  ON 48
eH1_9                -7.948407e-04 1 1  ON 49
eH2_0                -5.062719e-02 1 1  ON 50
eH2_1                 2.093732e-02 1 1  ON 51
eH2_2                 2.369826e-02 1 1  ON 52
eH2_3                -3.304427e-03 1 1  ON 53
eH2_4                -9.364488e-03 1 1  ON 54
eH2_5                -6.995778e-03 1 1  ON 55
eH2_6                 1.861300e-02 1 1  ON 56
eH2_7                 1.157984e-02 1 1  ON 57
eH2_8                -3.691393e-03 1 1  ON 58
eH2_9                -6.624455e-04 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.3805e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORMP2PJWARM.s005 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORMP2PJWARM.s005 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=5  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2314e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 30888 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 5
    time step          = 0.05
    reference energy   = -22.3934
    reference variance = 0.482719
====================================================
  Execution time = 4.8880e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORMP2PJWARM.s005
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2393e+01
  VMC Evar = 5.8532e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.6108e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.585351319078
                                         uncertainty =       0.006434698984

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.585351319078
                                         uncertainty =       0.006434698984

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000540980308
  error estimate for blocks of size 2^( 2) =       0.000577841899
  error estimate for blocks of size 2^( 3) =       0.000615445268
  error estimate for blocks of size 2^( 4) =       0.000645966656
  error estimate for blocks of size 2^( 5) =       0.000664902242
  error estimate for blocks of size 2^( 6) =       0.000675834883
  error estimate for blocks of size 2^( 7) =       0.000678543059

      target function =                  N/A
              le_mean =     -22.393266951886
             les_mean =     502.043723872609
             stat err =       0.000666311710
             autocorr =       1.517022347049
              std dev =       0.765061688243
             le_variance =       0.585319386817


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.239326695189e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5625e-01, overlap shift 1.5625e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.393266951886       residual = 3.90e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.393548959485       residual = 3.99e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.395146031516       residual = 1.01e-02           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.396421782350       residual = 5.44e-03           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.397572736848       residual = 3.28e-03           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.398352428883       residual = 1.49e-03           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.398584929619       residual = 8.97e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.398884013777       residual = 2.55e-04           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.398975150111       residual = 2.53e-04           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.399072066342       residual = 1.64e-04           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -22.399135309350       residual = 4.85e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -22.399151259719       residual = 3.81e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -22.399157980743       residual = 3.34e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -22.399169355332       residual = 6.47e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -22.399177026777       residual = 3.30e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -22.399179633685       residual = 8.09e-07           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -22.399181212475       residual = 7.44e-07           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   energy =     -22.399179735419       residual = 2.72e-07           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   energy =     -22.399181597132       residual = 1.13e-07           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   energy =     -22.399182310942       residual = 2.52e-08           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   energy =     -22.399181848520       residual = 6.63e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         20 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.5625e-01 is 1.004495e-01

solving harmonic davidson linear method for identity shift 6.2500e-01, overlap shift 6.2500e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.393266951886       residual = 3.90e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.393375901883       residual = 4.04e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.393963289794       residual = 8.62e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.394433309901       residual = 4.18e-03           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.394824876474       residual = 1.64e-03           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.394984705143       residual = 9.25e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.395062384155       residual = 2.48e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.395111989561       residual = 7.41e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.395129719880       residual = 3.64e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.395141808072       residual = 2.24e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -22.395144468453       residual = 6.90e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -22.395144958551       residual = 4.71e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -22.395143351818       residual = 1.25e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -22.395143048198       residual = 4.44e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -22.395143431235       residual = 1.28e-07           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -22.395143895484       residual = 4.23e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -22.395143896468       residual = 1.51e-08           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   energy =     -22.395144002306       residual = 5.67e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         17 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 6.2500e-01 is 2.627943e-02

solving harmonic davidson linear method for identity shift 2.5000e+00, overlap shift 2.5000e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.393266951886       residual = 3.90e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.393298488355       residual = 4.09e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.393467519389       residual = 8.12e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.393599369273       residual = 3.52e-03           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.393708355611       residual = 1.19e-03           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.393740190899       residual = 5.86e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.393760759373       residual = 1.30e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.393768498619       residual = 3.98e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.393772638856       residual = 1.10e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.393774613441       residual = 7.75e-06           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -22.393774768238       residual = 1.67e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -22.393774904947       residual = 9.46e-07           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -22.393774502263       residual = 2.72e-07           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -22.393774285464       residual = 7.53e-08           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -22.393774344101       residual = 2.26e-08           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -22.393774372192       residual = 6.12e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         15 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 2.5000e+00 is 6.812185e-03

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.080048 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 6.5005e+01
  </log>
  <optVariables href="FORMP2PJWARM.s005.opt.xml">
 uu_0                 1.916625e-01 1 1  ON 0
 uu_1                 4.516342e-02 1 1  ON 1
 uu_2                -3.808210e-02 1 1  ON 2
 uu_3                -6.486790e-02 1 1  ON 3
 uu_4                -6.251232e-02 1 1  ON 4
 uu_5                -4.867578e-02 1 1  ON 5
 uu_6                -2.889802e-02 1 1  ON 6
 uu_7                -8.885059e-03 1 1  ON 7
 uu_8                 2.528752e-03 1 1  ON 8
 uu_9                 6.542760e-03 1 1  ON 9
 ud_0                 3.260675e-01 1 1  ON 10
 ud_1                 5.900326e-02 1 1  ON 11
 ud_2                -5.468584e-02 1 1  ON 12
 ud_3                -8.955764e-02 1 1  ON 13
 ud_4                -8.717465e-02 1 1  ON 14
 ud_5                -7.264627e-02 1 1  ON 15
 ud_6                -5.118346e-02 1 1  ON 16
 ud_7                -2.749891e-02 1 1  ON 17
 ud_8                -8.668417e-03 1 1  ON 18
 ud_9                 1.960222e-03 1 1  ON 19
 eC_0                -1.918391e-01 1 1  ON 20
 eC_1                -1.160284e-01 1 1  ON 21
 eC_2                 7.512199e-02 1 1  ON 22
 eC_3                 1.287922e-01 1 1  ON 23
 eC_4                 8.740453e-02 1 1  ON 24
 eC_5                 3.580475e-02 1 1  ON 25
 eC_6                -1.311600e-02 1 1  ON 26
 eC_7                -5.114359e-03 1 1  ON 27
 eC_8                -5.444016e-04 1 1  ON 28
 eC_9                -2.599386e-04 1 1  ON 29
 eO_0                -4.605939e-01 1 1  ON 30
 eO_1                -1.812968e-01 1 1  ON 31
 eO_2                 1.410846e-01 1 1  ON 32
 eO_3                 2.204830e-01 1 1  ON 33
 eO_4                 1.883569e-01 1 1  ON 34
 eO_5                 1.141169e-01 1 1  ON 35
 eO_6                 5.274931e-03 1 1  ON 36
 eO_7                -1.833080e-02 1 1  ON 37
 eO_8                -7.972228e-03 1 1  ON 38
 eO_9                -8.567550e-04 1 1  ON 39
eH1_0                -5.431204e-02 1 1  ON 40
eH1_1                 2.115494e-02 1 1  ON 41
eH1_2                 2.316645e-02 1 1  ON 42
eH1_3                -4.465408e-03 1 1  ON 43
eH1_4                -7.980956e-03 1 1  ON 44
eH1_5                -7.206489e-03 1 1  ON 45
eH1_6                 2.052607e-02 1 1  ON 46
eH1_7                 1.408322e-02 1 1  ON 47
eH1_8                -4.172181e-03 1 1  ON 48
eH1_9                -6.703115e-04 1 1  ON 49
eH2_0                -5.468113e-02 1 1  ON 50
eH2_1                 2.061652e-02 1 1  ON 51
eH2_2                 2.306958e-02 1 1  ON 52
eH2_3                -4.004909e-03 1 1  ON 53
eH2_4                -7.891474e-03 1 1  ON 54
eH2_5                -6.982686e-03 1 1  ON 55
eH2_6                 1.982183e-02 1 1  ON 56
eH2_7                 1.419056e-02 1 1  ON 57
eH2_8                -3.506561e-03 1 1  ON 58
eH2_9                -5.486185e-04 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 5
    time step          = 0.05
    reference energy   = -22.4849
    reference variance = 0.400594
====================================================
  Execution time = 4.8134e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORMP2PJWARM.s005
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2397e+01
  VMC Evar = 5.8238e-01
  Total weights = 2.0000e+06
  Execution time = 4.5197e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.588363770564
                                         uncertainty =       0.004327462511

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.588363770564
                                         uncertainty =       0.004327462511

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000542366689
  error estimate for blocks of size 2^( 2) =       0.000579269960
  error estimate for blocks of size 2^( 3) =       0.000617095735
  error estimate for blocks of size 2^( 4) =       0.000647516453
  error estimate for blocks of size 2^( 5) =       0.000664223967
  error estimate for blocks of size 2^( 6) =       0.000672923702
  error estimate for blocks of size 2^( 7) =       0.000677817389

      target function =                  N/A
              le_mean =     -22.396992547249
             les_mean =     502.213598117363
             stat err =       0.000665620378
             autocorr =       1.506146449300
              std dev =       0.767022326910
             le_variance =       0.588323249979

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.575835357695
                                         uncertainty =       0.004593423480

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.575835357695
                                         uncertainty =       0.004593423480

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000536553752
  error estimate for blocks of size 2^( 2) =       0.000568120336
  error estimate for blocks of size 2^( 3) =       0.000600578623
  error estimate for blocks of size 2^( 4) =       0.000627137578
  error estimate for blocks of size 2^( 5) =       0.000641712618
  error estimate for blocks of size 2^( 6) =       0.000649468641
  error estimate for blocks of size 2^( 7) =       0.000654614997

      target function =                  N/A
              le_mean =     -22.398105354692
             les_mean =     502.250903049640
             stat err =       0.000643233458
             autocorr =       1.437178728728
              std dev =       0.758801593082
             le_variance =       0.575779857664

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.578286953499
                                         uncertainty =       0.004455999511

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.578286953499
                                         uncertainty =       0.004455999511

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000537697804
  error estimate for blocks of size 2^( 2) =       0.000571718414
  error estimate for blocks of size 2^( 3) =       0.000606724537
  error estimate for blocks of size 2^( 4) =       0.000635180209
  error estimate for blocks of size 2^( 5) =       0.000650832901
  error estimate for blocks of size 2^( 6) =       0.000659118378
  error estimate for blocks of size 2^( 7) =       0.000664240476

      target function =                  N/A
              le_mean =     -22.397001252073
             les_mean =     502.203902653809
             stat err =       0.000652342991
             autocorr =       1.471890408928
              std dev =       0.760419527345
             le_variance =       0.578237857567

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.586441482789
                                         uncertainty =       0.004341373281

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.586441482789
                                         uncertainty =       0.004341373281

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000541479359
  error estimate for blocks of size 2^( 2) =       0.000578000448
  error estimate for blocks of size 2^( 3) =       0.000615460656
  error estimate for blocks of size 2^( 4) =       0.000645631926
  error estimate for blocks of size 2^( 5) =       0.000662208659
  error estimate for blocks of size 2^( 6) =       0.000670861493
  error estimate for blocks of size 2^( 7) =       0.000675791342

      target function =                  N/A
              le_mean =     -22.396902422105
             les_mean =     502.207637603859
             stat err =       0.000663623355
             autocorr =       1.502033130229
              std dev =       0.765767452804
             le_variance =       0.586399791774


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.396992547249        initial
     1.5625e-01     1.5625e+00             1.0045e-01       -22.398105354692  <--
     6.2500e-01     6.2500e+00             2.6279e-02       -22.397001252073
     2.5000e+00     2.5000e+01             6.8122e-03       -22.396902422105

*****************************************************************************
Applying the update for shift_i =   1.5625e-01     and shift_s =   1.5625e+00
*****************************************************************************

  Execution time = 7.0683e+01
  </log>
  <optVariables href="FORMP2PJWARM.s005.opt.xml">
 uu_0                 2.083507e-01 1 1  ON 0
 uu_1                 5.328221e-02 1 1  ON 1
 uu_2                -3.652641e-02 1 1  ON 2
 uu_3                -7.127286e-02 1 1  ON 3
 uu_4                -7.391337e-02 1 1  ON 4
 uu_5                -6.140561e-02 1 1  ON 5
 uu_6                -3.973820e-02 1 1  ON 6
 uu_7                -1.321762e-02 1 1  ON 7
 uu_8                 6.597088e-03 1 1  ON 8
 uu_9                 1.404036e-02 1 1  ON 9
 ud_0                 3.421623e-01 1 1  ON 10
 ud_1                 7.240525e-02 1 1  ON 11
 ud_2                -4.854539e-02 1 1  ON 12
 ud_3                -9.274507e-02 1 1  ON 13
 ud_4                -9.761351e-02 1 1  ON 14
 ud_5                -8.603288e-02 1 1  ON 15
 ud_6                -6.438357e-02 1 1  ON 16
 ud_7                -3.610080e-02 1 1  ON 17
 ud_8                -8.904365e-03 1 1  ON 18
 ud_9                 7.877698e-03 1 1  ON 19
 eC_0                -2.436562e-01 1 1  ON 20
 eC_1                -1.432508e-01 1 1  ON 21
 eC_2                 7.014967e-02 1 1  ON 22
 eC_3                 1.507310e-01 1 1  ON 23
 eC_4                 1.205721e-01 1 1  ON 24
 eC_5                 6.148135e-02 1 1  ON 25
 eC_6                -1.115787e-02 1 1  ON 26
 eC_7                -4.824102e-03 1 1  ON 27
 eC_8                 4.609767e-05 1 1  ON 28
 eC_9                 2.231439e-05 1 1  ON 29
 eO_0                -5.347640e-01 1 1  ON 30
 eO_1                -2.287311e-01 1 1  ON 31
 eO_2                 1.252465e-01 1 1  ON 32
 eO_3                 2.426537e-01 1 1  ON 33
 eO_4                 2.317751e-01 1 1  ON 34
 eO_5                 1.598570e-01 1 1  ON 35
 eO_6                 3.012103e-02 1 1  ON 36
 eO_7                -1.747077e-02 1 1  ON 37
 eO_8                -9.114993e-03 1 1  ON 38
 eO_9                -5.341509e-05 1 1  ON 39
eH1_0                -6.623293e-02 1 1  ON 40
eH1_1                 1.723917e-02 1 1  ON 41
eH1_2                 2.125882e-02 1 1  ON 42
eH1_3                -5.619044e-03 1 1  ON 43
eH1_4                -3.696180e-03 1 1  ON 44
eH1_5                -6.301304e-03 1 1  ON 45
eH1_6                 2.345833e-02 1 1  ON 46
eH1_7                 2.247852e-02 1 1  ON 47
eH1_8                -2.783357e-03 1 1  ON 48
eH1_9                -7.597721e-05 1 1  ON 49
eH2_0                -6.656515e-02 1 1  ON 50
eH2_1                 1.685436e-02 1 1  ON 51
eH2_2                 2.045523e-02 1 1  ON 52
eH2_3                -5.088786e-03 1 1  ON 53
eH2_4                -3.496882e-03 1 1  ON 54
eH2_5                -6.372243e-03 1 1  ON 55
eH2_6                 2.244537e-02 1 1  ON 56
eH2_7                 2.330046e-02 1 1  ON 57
eH2_8                -1.881608e-03 1 1  ON 58
eH2_9                 2.768660e-05 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.3570e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORMP2PJWARM.s006 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORMP2PJWARM.s006 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=6  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2335e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 30888 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 6
    time step          = 0.05
    reference energy   = -22.5045
    reference variance = 0.74114
====================================================
  Execution time = 4.9004e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORMP2PJWARM.s006
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2406e+01
  VMC Evar = 5.7456e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.6163e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.574503006745
                                         uncertainty =       0.012446316624

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.574503006745
                                         uncertainty =       0.012446316624

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000535983675
  error estimate for blocks of size 2^( 2) =       0.000566721353
  error estimate for blocks of size 2^( 3) =       0.000597432480
  error estimate for blocks of size 2^( 4) =       0.000622670105
  error estimate for blocks of size 2^( 5) =       0.000638637143
  error estimate for blocks of size 2^( 6) =       0.000646090800
  error estimate for blocks of size 2^( 7) =       0.000650785639

      target function =                  N/A
              le_mean =     -22.405756616787
             les_mean =     502.592486282535
             stat err =       0.000639545922
             autocorr =       1.423771659426
              std dev =       0.757995381982
             le_variance =       0.574556999106


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.240575661679e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.9062e-02, overlap shift 3.9062e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.405756616787       residual = 1.38e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.405927442802       residual = 1.37e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.407192843633       residual = 6.39e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.409167624337       residual = 3.93e-03           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.410466421082       residual = 2.20e-03           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.410917722698       residual = 1.18e-03           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.411206573962       residual = 1.06e-03           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.411655267318       residual = 4.25e-04           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.411818649643       residual = 3.18e-04           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.412050577778       residual = 4.01e-04           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -22.412209497429       residual = 2.88e-04           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -22.412293948233       residual = 1.01e-04           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -22.412409704600       residual = 8.07e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -22.412484129060       residual = 3.34e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -22.412521616304       residual = 1.30e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -22.412541089912       residual = 1.78e-05           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -22.412546844529       residual = 9.20e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   energy =     -22.412572058315       residual = 8.46e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   energy =     -22.412584998740       residual = 4.65e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   energy =     -22.412591561386       residual = 1.30e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   energy =     -22.412596794174       residual = 4.47e-07           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   energy =     -22.412597050302       residual = 2.89e-07           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   energy =     -22.412597505474       residual = 1.38e-07           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   energy =     -22.412599234660       residual = 5.22e-08           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   energy =     -22.412598616498       residual = 2.81e-08           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   energy =     -22.412598458399       residual = 1.65e-08           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   energy =     -22.412598141386       residual = 7.89e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         26 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 3.9062e-02 is 3.378990e-01

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 1.5625e-01, overlap shift 1.5625e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.405756616787       residual = 1.38e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.405855064724       residual = 1.28e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.406773865236       residual = 5.08e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.407667391402       residual = 1.76e-03           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.408027469404       residual = 5.89e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.408153052947       residual = 2.40e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.408233018372       residual = 3.73e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.408278188769       residual = 8.13e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.408312296318       residual = 8.50e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.408347091018       residual = 4.37e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -22.408352664443       residual = 2.20e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -22.408359139568       residual = 1.49e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -22.408366924471       residual = 6.60e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -22.408370259443       residual = 1.38e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -22.408373699699       residual = 8.94e-07           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -22.408372891630       residual = 3.51e-07           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -22.408372278159       residual = 2.14e-07           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   energy =     -22.408373272240       residual = 5.55e-08           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   energy =     -22.408373667386       residual = 1.58e-08           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   energy =     -22.408373919309       residual = 8.64e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         19 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.5625e-01 is 6.307345e-02

solving harmonic davidson linear method for identity shift 6.2500e-01, overlap shift 6.2500e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.405756616787       residual = 1.38e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.405793148537       residual = 1.22e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.406200070372       residual = 3.30e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.406419182162       residual = 7.83e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.406482804574       residual = 2.63e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.406500120099       residual = 1.80e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.406513601310       residual = 5.16e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.406525053790       residual = 1.74e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.406531342318       residual = 1.17e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.406533283470       residual = 3.93e-06           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -22.406532465167       residual = 2.11e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -22.406533036825       residual = 1.23e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -22.406533390917       residual = 2.63e-07           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -22.406533509021       residual = 8.61e-08           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -22.406533587608       residual = 2.36e-08           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -22.406533560850       residual = 1.19e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -22.406533531173       residual = 3.01e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         16 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 6.2500e-01 is 1.617604e-02

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.097249 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 6.5188e+01
  </log>
  <optVariables href="FORMP2PJWARM.s006.opt.xml">
 uu_0                 2.219256e-01 1 1  ON 0
 uu_1                 6.146609e-02 1 1  ON 1
 uu_2                -3.386946e-02 1 1  ON 2
 uu_3                -7.466519e-02 1 1  ON 3
 uu_4                -8.253169e-02 1 1  ON 4
 uu_5                -7.264534e-02 1 1  ON 5
 uu_6                -5.105014e-02 1 1  ON 6
 uu_7                -2.142838e-02 1 1  ON 7
 uu_8                 7.688029e-03 1 1  ON 8
 uu_9                 2.202828e-02 1 1  ON 9
 ud_0                 3.564011e-01 1 1  ON 10
 ud_1                 8.337093e-02 1 1  ON 11
 ud_2                -4.284465e-02 1 1  ON 12
 ud_3                -9.394768e-02 1 1  ON 13
 ud_4                -1.049535e-01 1 1  ON 14
 ud_5                -9.727307e-02 1 1  ON 15
 ud_6                -7.655214e-02 1 1  ON 16
 ud_7                -4.557194e-02 1 1  ON 17
 ud_8                -1.167785e-02 1 1  ON 18
 ud_9                 1.288220e-02 1 1  ON 19
 eC_0                -2.874656e-01 1 1  ON 20
 eC_1                -1.693598e-01 1 1  ON 21
 eC_2                 6.040599e-02 1 1  ON 22
 eC_3                 1.636556e-01 1 1  ON 23
 eC_4                 1.504410e-01 1 1  ON 24
 eC_5                 9.095672e-02 1 1  ON 25
 eC_6                -5.617450e-03 1 1  ON 26
 eC_7                -3.896685e-03 1 1  ON 27
 eC_8                 6.487961e-04 1 1  ON 28
 eC_9                 2.904959e-04 1 1  ON 29
 eO_0                -5.978374e-01 1 1  ON 30
 eO_1                -2.734671e-01 1 1  ON 31
 eO_2                 1.046692e-01 1 1  ON 32
 eO_3                 2.537309e-01 1 1  ON 33
 eO_4                 2.672629e-01 1 1  ON 34
 eO_5                 2.043362e-01 1 1  ON 35
 eO_6                 6.185396e-02 1 1  ON 36
 eO_7                -1.286147e-02 1 1  ON 37
 eO_8                -9.930998e-03 1 1  ON 38
 eO_9                 9.625614e-04 1 1  ON 39
eH1_0                -7.619523e-02 1 1  ON 40
eH1_1                 1.117342e-02 1 1  ON 41
eH1_2                 1.880645e-02 1 1  ON 42
eH1_3                -5.461259e-03 1 1  ON 43
eH1_4                 9.243455e-05 1 1  ON 44
eH1_5                -4.923541e-03 1 1  ON 45
eH1_6                 2.420814e-02 1 1  ON 46
eH1_7                 3.112580e-02 1 1  ON 47
eH1_8                 6.200549e-05 1 1  ON 48
eH1_9                 4.851774e-04 1 1  ON 49
eH2_0                -7.678773e-02 1 1  ON 50
eH2_1                 1.062182e-02 1 1  ON 51
eH2_2                 1.785161e-02 1 1  ON 52
eH2_3                -5.699626e-03 1 1  ON 53
eH2_4                 2.423335e-04 1 1  ON 54
eH2_5                -5.069747e-03 1 1  ON 55
eH2_6                 2.375008e-02 1 1  ON 56
eH2_7                 3.238768e-02 1 1  ON 57
eH2_8                 1.192388e-03 1 1  ON 58
eH2_9                 8.304590e-04 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 6
    time step          = 0.05
    reference energy   = -22.3241
    reference variance = 0.352412
====================================================
  Execution time = 4.8106e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORMP2PJWARM.s006
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2411e+01
  VMC Evar = 5.6421e-01
  Total weights = 2.0000e+06
  Execution time = 4.5071e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.562232863193
                                         uncertainty =       0.005516126623

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.562232863193
                                         uncertainty =       0.005516126623

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000530142238
  error estimate for blocks of size 2^( 2) =       0.000560865496
  error estimate for blocks of size 2^( 3) =       0.000592064435
  error estimate for blocks of size 2^( 4) =       0.000618051999
  error estimate for blocks of size 2^( 5) =       0.000635088028
  error estimate for blocks of size 2^( 6) =       0.000645990759
  error estimate for blocks of size 2^( 7) =       0.000649249428

      target function =                  N/A
              le_mean =     -22.411958101822
             les_mean =     502.857967261946
             stat err =       0.000637095053
             autocorr =       1.444187732444
              std dev =       0.749734343080
             le_variance =       0.562101585194

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.609929202391
                                         uncertainty =       0.005919451537

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.609929202391
                                         uncertainty =       0.005919451537

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000552163312
  error estimate for blocks of size 2^( 2) =       0.000574866072
  error estimate for blocks of size 2^( 3) =       0.000596735675
  error estimate for blocks of size 2^( 4) =       0.000615150980
  error estimate for blocks of size 2^( 5) =       0.000627903751
  error estimate for blocks of size 2^( 6) =       0.000636044143
  error estimate for blocks of size 2^( 7) =       0.000638919910

      target function =                  N/A
              le_mean =     -22.421772711792
             les_mean =     503.345659881481
             stat err =       0.000629504696
             autocorr =       1.299759062223
              std dev =       0.780876845043
             le_variance =       0.609768647124

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.572232687926
                                         uncertainty =       0.005673902211

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.572232687926
                                         uncertainty =       0.005673902211

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000534829525
  error estimate for blocks of size 2^( 2) =       0.000561137574
  error estimate for blocks of size 2^( 3) =       0.000587638498
  error estimate for blocks of size 2^( 4) =       0.000610127932
  error estimate for blocks of size 2^( 5) =       0.000625275537
  error estimate for blocks of size 2^( 6) =       0.000635101363
  error estimate for blocks of size 2^( 7) =       0.000638113606

      target function =                  N/A
              le_mean =     -22.411964474964
             les_mean =     502.868236581794
             stat err =       0.000627154609
             autocorr =       1.375049996091
              std dev =       0.756363167268
             le_variance =       0.572085240799

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.562695015659
                                         uncertainty =       0.005537407750

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.562695015659
                                         uncertainty =       0.005537407750

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000530358982
  error estimate for blocks of size 2^( 2) =       0.000560408201
  error estimate for blocks of size 2^( 3) =       0.000590925025
  error estimate for blocks of size 2^( 4) =       0.000616429077
  error estimate for blocks of size 2^( 5) =       0.000633209248
  error estimate for blocks of size 2^( 6) =       0.000643975175
  error estimate for blocks of size 2^( 7) =       0.000647194628

      target function =                  N/A
              le_mean =     -22.411620406978
             les_mean =     502.843290284169
             stat err =       0.000635202032
             autocorr =       1.434445001608
              std dev =       0.750040864883
             le_variance =       0.562561298995


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.411958101822        initial
            N/A            N/A                    N/A                    N/A     bad update
     1.5625e-01     1.5625e+00             6.3073e-02       -22.411964474964  <--
     6.2500e-01     6.2500e+00             1.6176e-02       -22.411620406978

*****************************************************************************
Applying the update for shift_i =   1.5625e-01     and shift_s =   1.5625e+00
*****************************************************************************

  Execution time = 7.0594e+01
  </log>
  <optVariables href="FORMP2PJWARM.s006.opt.xml">
 uu_0                 2.219256e-01 1 1  ON 0
 uu_1                 6.146609e-02 1 1  ON 1
 uu_2                -3.386946e-02 1 1  ON 2
 uu_3                -7.466519e-02 1 1  ON 3
 uu_4                -8.253169e-02 1 1  ON 4
 uu_5                -7.264534e-02 1 1  ON 5
 uu_6                -5.105014e-02 1 1  ON 6
 uu_7                -2.142838e-02 1 1  ON 7
 uu_8                 7.688029e-03 1 1  ON 8
 uu_9                 2.202828e-02 1 1  ON 9
 ud_0                 3.564011e-01 1 1  ON 10
 ud_1                 8.337093e-02 1 1  ON 11
 ud_2                -4.284465e-02 1 1  ON 12
 ud_3                -9.394768e-02 1 1  ON 13
 ud_4                -1.049535e-01 1 1  ON 14
 ud_5                -9.727307e-02 1 1  ON 15
 ud_6                -7.655214e-02 1 1  ON 16
 ud_7                -4.557194e-02 1 1  ON 17
 ud_8                -1.167785e-02 1 1  ON 18
 ud_9                 1.288220e-02 1 1  ON 19
 eC_0                -2.874656e-01 1 1  ON 20
 eC_1                -1.693598e-01 1 1  ON 21
 eC_2                 6.040599e-02 1 1  ON 22
 eC_3                 1.636556e-01 1 1  ON 23
 eC_4                 1.504410e-01 1 1  ON 24
 eC_5                 9.095672e-02 1 1  ON 25
 eC_6                -5.617450e-03 1 1  ON 26
 eC_7                -3.896685e-03 1 1  ON 27
 eC_8                 6.487961e-04 1 1  ON 28
 eC_9                 2.904959e-04 1 1  ON 29
 eO_0                -5.978374e-01 1 1  ON 30
 eO_1                -2.734671e-01 1 1  ON 31
 eO_2                 1.046692e-01 1 1  ON 32
 eO_3                 2.537309e-01 1 1  ON 33
 eO_4                 2.672629e-01 1 1  ON 34
 eO_5                 2.043362e-01 1 1  ON 35
 eO_6                 6.185396e-02 1 1  ON 36
 eO_7                -1.286147e-02 1 1  ON 37
 eO_8                -9.930998e-03 1 1  ON 38
 eO_9                 9.625614e-04 1 1  ON 39
eH1_0                -7.619523e-02 1 1  ON 40
eH1_1                 1.117342e-02 1 1  ON 41
eH1_2                 1.880645e-02 1 1  ON 42
eH1_3                -5.461259e-03 1 1  ON 43
eH1_4                 9.243455e-05 1 1  ON 44
eH1_5                -4.923541e-03 1 1  ON 45
eH1_6                 2.420814e-02 1 1  ON 46
eH1_7                 3.112580e-02 1 1  ON 47
eH1_8                 6.200549e-05 1 1  ON 48
eH1_9                 4.851774e-04 1 1  ON 49
eH2_0                -7.678773e-02 1 1  ON 50
eH2_1                 1.062182e-02 1 1  ON 51
eH2_2                 1.785161e-02 1 1  ON 52
eH2_3                -5.699626e-03 1 1  ON 53
eH2_4                 2.423335e-04 1 1  ON 54
eH2_5                -5.069747e-03 1 1  ON 55
eH2_6                 2.375008e-02 1 1  ON 56
eH2_7                 3.238768e-02 1 1  ON 57
eH2_8                 1.192388e-03 1 1  ON 58
eH2_9                 8.304590e-04 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.3579e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORMP2PJWARM.s007 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORMP2PJWARM.s007 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=7  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2346e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 30888 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 7
    time step          = 0.05
    reference energy   = -22.4382
    reference variance = 0.562698
====================================================
  Execution time = 5.0742e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORMP2PJWARM.s007
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2412e+01
  VMC Evar = 5.6914e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.5935e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.568919675248
                                         uncertainty =       0.006616198254

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.568919675248
                                         uncertainty =       0.006616198254

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000533449006
  error estimate for blocks of size 2^( 2) =       0.000560676401
  error estimate for blocks of size 2^( 3) =       0.000588393797
  error estimate for blocks of size 2^( 4) =       0.000610936934
  error estimate for blocks of size 2^( 5) =       0.000626312690
  error estimate for blocks of size 2^( 6) =       0.000632809642
  error estimate for blocks of size 2^( 7) =       0.000636197483

      target function =                  N/A
              le_mean =     -22.411989160582
             les_mean =     502.866393532804
             stat err =       0.000626564187
             autocorr =       1.379575002244
              std dev =       0.754410818684
             le_variance =       0.569135683348


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.241198916058e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.9062e-02, overlap shift 3.9062e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.411989160582       residual = 5.43e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.412120064135       residual = 1.16e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.412605300561       residual = 2.91e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.413468236293       residual = 3.10e-03           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.414719524271       residual = 2.41e-03           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.415154269543       residual = 9.64e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.415351857991       residual = 4.22e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.415551730666       residual = 2.33e-04           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.415612634615       residual = 1.29e-04           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.415694849911       residual = 1.60e-04           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -22.415822985237       residual = 2.21e-04           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -22.415899424040       residual = 7.09e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -22.415953204384       residual = 3.63e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -22.415989472066       residual = 2.14e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -22.416012736053       residual = 2.35e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -22.416018440316       residual = 6.14e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -22.416030607579       residual = 8.28e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   energy =     -22.416043672970       residual = 6.85e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   energy =     -22.416049630648       residual = 8.70e-07           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   energy =     -22.416050701377       residual = 5.25e-07           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   energy =     -22.416052414926       residual = 1.80e-07           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   energy =     -22.416051835464       residual = 1.41e-07           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   energy =     -22.416052778648       residual = 6.07e-08           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   energy =     -22.416052178026       residual = 3.27e-08           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   energy =     -22.416052317028       residual = 1.82e-08           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   energy =     -22.416052167972       residual = 9.72e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         25 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 3.9062e-02 is 2.321162e-01

solving harmonic davidson linear method for identity shift 1.5625e-01, overlap shift 1.5625e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.411989160582       residual = 5.43e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.412062459301       residual = 1.08e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.412364343150       residual = 2.42e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.412808351331       residual = 1.80e-03           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.413178676143       residual = 1.25e-03           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.413324276831       residual = 2.21e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.413364446235       residual = 7.42e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.413388260269       residual = 3.97e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.413398361582       residual = 2.64e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.413415924958       residual = 2.61e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -22.413427959298       residual = 1.12e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -22.413432757661       residual = 4.53e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -22.413433284559       residual = 2.73e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -22.413436535875       residual = 7.32e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -22.413437423464       residual = 3.45e-07           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -22.413436699046       residual = 2.50e-07           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -22.413436871764       residual = 1.39e-07           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   energy =     -22.413437493865       residual = 3.92e-08           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   energy =     -22.413437527978       residual = 8.79e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         18 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.5625e-01 is 4.510982e-02

solving harmonic davidson linear method for identity shift 6.2500e-01, overlap shift 6.2500e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.411989160582       residual = 5.43e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.412015715308       residual = 1.04e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.412137116103       residual = 1.96e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.412275667228       residual = 1.11e-03           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.412350829753       residual = 6.06e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.412391240347       residual = 4.75e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.412395164975       residual = 1.53e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.412397270999       residual = 9.25e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.412399616939       residual = 5.04e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.412401743731       residual = 1.59e-06           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -22.412401785543       residual = 7.41e-07           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -22.412402155078       residual = 4.76e-07           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -22.412401838517       residual = 1.00e-07           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -22.412402069471       residual = 4.25e-08           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -22.412402079540       residual = 1.31e-08           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -22.412402109515       residual = 5.66e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         15 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 6.2500e-01 is 1.142216e-02

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.112861 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 6.6696e+01
  </log>
  <optVariables href="FORMP2PJWARM.s007.opt.xml">
 uu_0                 2.305705e-01 1 1  ON 0
 uu_1                 6.749723e-02 1 1  ON 1
 uu_2                -3.115592e-02 1 1  ON 2
 uu_3                -7.609093e-02 1 1  ON 3
 uu_4                -8.772028e-02 1 1  ON 4
 uu_5                -8.067950e-02 1 1  ON 5
 uu_6                -6.017300e-02 1 1  ON 6
 uu_7                -2.870919e-02 1 1  ON 7
 uu_8                 6.472581e-03 1 1  ON 8
 uu_9                 2.793723e-02 1 1  ON 9
 ud_0                 3.654140e-01 1 1  ON 10
 ud_1                 9.112465e-02 1 1  ON 11
 ud_2                -3.853667e-02 1 1  ON 12
 ud_3                -9.375260e-02 1 1  ON 13
 ud_4                -1.091155e-01 1 1  ON 14
 ud_5                -1.048660e-01 1 1  ON 15
 ud_6                -8.596091e-02 1 1  ON 16
 ud_7                -5.393556e-02 1 1  ON 17
 ud_8                -1.566098e-02 1 1  ON 18
 ud_9                 1.689745e-02 1 1  ON 19
 eC_0                -3.187096e-01 1 1  ON 20
 eC_1                -1.898209e-01 1 1  ON 21
 eC_2                 4.979198e-02 1 1  ON 22
 eC_3                 1.693795e-01 1 1  ON 23
 eC_4                 1.719883e-01 1 1  ON 24
 eC_5                 1.165927e-01 1 1  ON 25
 eC_6                 1.657034e-03 1 1  ON 26
 eC_7                -2.532010e-03 1 1  ON 27
 eC_8                 1.056194e-03 1 1  ON 28
 eC_9                 5.423777e-04 1 1  ON 29
 eO_0                -6.429473e-01 1 1  ON 30
 eO_1                -3.082090e-01 1 1  ON 31
 eO_2                 8.603202e-02 1 1  ON 32
 eO_3                 2.565283e-01 1 1  ON 33
 eO_4                 2.894502e-01 1 1  ON 34
 eO_5                 2.372964e-01 1 1  ON 35
 eO_6                 9.183776e-02 1 1  ON 36
 eO_7                -4.085529e-03 1 1  ON 37
 eO_8                -9.911477e-03 1 1  ON 38
 eO_9                 1.862682e-03 1 1  ON 39
eH1_0                -8.397700e-02 1 1  ON 40
eH1_1                 6.172226e-03 1 1  ON 41
eH1_2                 1.630265e-02 1 1  ON 42
eH1_3                -5.539482e-03 1 1  ON 43
eH1_4                 3.656871e-03 1 1  ON 44
eH1_5                -2.509233e-03 1 1  ON 45
eH1_6                 2.386222e-02 1 1  ON 46
eH1_7                 3.673678e-02 1 1  ON 47
eH1_8                 2.895877e-03 1 1  ON 48
eH1_9                 1.321850e-03 1 1  ON 49
eH2_0                -8.484908e-02 1 1  ON 50
eH2_1                 5.326760e-03 1 1  ON 51
eH2_2                 1.502164e-02 1 1  ON 52
eH2_3                -5.746136e-03 1 1  ON 53
eH2_4                 3.831432e-03 1 1  ON 54
eH2_5                -3.203680e-03 1 1  ON 55
eH2_6                 2.354386e-02 1 1  ON 56
eH2_7                 3.872245e-02 1 1  ON 57
eH2_8                 4.860522e-03 1 1  ON 58
eH2_9                 1.688383e-03 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 7
    time step          = 0.05
    reference energy   = -22.4332
    reference variance = 0.34491
====================================================
  Execution time = 4.8355e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORMP2PJWARM.s007
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2414e+01
  VMC Evar = 5.6529e-01
  Total weights = 2.0000e+06
  Execution time = 4.4872e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.563235962960
                                         uncertainty =       0.005052727071

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.563235962960
                                         uncertainty =       0.005052727071

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000530610556
  error estimate for blocks of size 2^( 2) =       0.000558489505
  error estimate for blocks of size 2^( 3) =       0.000585744930
  error estimate for blocks of size 2^( 4) =       0.000607789209
  error estimate for blocks of size 2^( 5) =       0.000622917665
  error estimate for blocks of size 2^( 6) =       0.000633194346
  error estimate for blocks of size 2^( 7) =       0.000639763284

      target function =                  N/A
              le_mean =     -22.414475378761
             les_mean =     502.971801347484
             stat err =       0.000625916126
             autocorr =       1.391491349903
              std dev =       0.750396644426
             le_variance =       0.563095123966

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.586828272080
                                         uncertainty =       0.005830541090

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.586828272080
                                         uncertainty =       0.005830541090

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000541594850
  error estimate for blocks of size 2^( 2) =       0.000564404409
  error estimate for blocks of size 2^( 3) =       0.000585792787
  error estimate for blocks of size 2^( 4) =       0.000602457836
  error estimate for blocks of size 2^( 5) =       0.000614130718
  error estimate for blocks of size 2^( 6) =       0.000622312655
  error estimate for blocks of size 2^( 7) =       0.000628964859

      target function =                  N/A
              le_mean =     -22.418492729342
             les_mean =     503.175465926071
             stat err =       0.000616966517
             autocorr =       1.297699502217
              std dev =       0.765930782673
             le_variance =       0.586649963846

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.569928297387
                                         uncertainty =       0.005366765190

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.569928297387
                                         uncertainty =       0.005366765190

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000533747254
  error estimate for blocks of size 2^( 2) =       0.000559057590
  error estimate for blocks of size 2^( 3) =       0.000583481344
  error estimate for blocks of size 2^( 4) =       0.000603081627
  error estimate for blocks of size 2^( 5) =       0.000616729117
  error estimate for blocks of size 2^( 6) =       0.000626130880
  error estimate for blocks of size 2^( 7) =       0.000632777385

      target function =                  N/A
              le_mean =     -22.414554320346
             les_mean =     502.982017356698
             stat err =       0.000619679752
             autocorr =       1.347917479751
              std dev =       0.754832605177
             le_variance =       0.569772261838

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.563702938022
                                         uncertainty =       0.005091277181

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.563702938022
                                         uncertainty =       0.005091277181

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000530829645
  error estimate for blocks of size 2^( 2) =       0.000558336131
  error estimate for blocks of size 2^( 3) =       0.000585193852
  error estimate for blocks of size 2^( 4) =       0.000606908206
  error estimate for blocks of size 2^( 5) =       0.000621843690
  error estimate for blocks of size 2^( 6) =       0.000632008718
  error estimate for blocks of size 2^( 7) =       0.000638590307

      target function =                  N/A
              le_mean =     -22.414342099059
             les_mean =     502.966291675919
             stat err =       0.000624837730
             autocorr =       1.385556227529
              std dev =       0.750706483291
             le_variance =       0.563560224054


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.414475378761        initial
     3.9062e-02     3.9062e-01             2.3212e-01       -22.418492729342  <--
     1.5625e-01     1.5625e+00             4.5110e-02       -22.414554320346
     6.2500e-01     6.2500e+00             1.1422e-02       -22.414342099059

*****************************************************************************
Applying the update for shift_i =   3.9062e-02     and shift_s =   3.9062e-01
*****************************************************************************

  Execution time = 7.0821e+01
  </log>
  <optVariables href="FORMP2PJWARM.s007.opt.xml">
 uu_0                 2.638110e-01 1 1  ON 0
 uu_1                 9.182593e-02 1 1  ON 1
 uu_2                -1.756112e-02 1 1  ON 2
 uu_3                -7.730435e-02 1 1  ON 3
 uu_4                -1.044233e-01 1 1  ON 4
 uu_5                -1.106503e-01 1 1  ON 5
 uu_6                -9.919404e-02 1 1  ON 6
 uu_7                -6.661362e-02 1 1  ON 7
 uu_8                -1.395037e-02 1 1  ON 8
 uu_9                 4.650685e-02 1 1  ON 9
 ud_0                 4.010330e-01 1 1  ON 10
 ud_1                 1.218450e-01 1 1  ON 11
 ud_2                -1.887724e-02 1 1  ON 12
 ud_3                -8.921081e-02 1 1  ON 13
 ud_4                -1.214568e-01 1 1  ON 14
 ud_5                -1.322557e-01 1 1  ON 15
 ud_6                -1.246807e-01 1 1  ON 16
 ud_7                -9.437624e-02 1 1  ON 17
 ud_8                -4.480495e-02 1 1  ON 18
 ud_9                 2.494731e-02 1 1  ON 19
 eC_0                -4.408478e-01 1 1  ON 20
 eC_1                -2.798085e-01 1 1  ON 21
 eC_2                -7.629806e-03 1 1  ON 22
 eC_3                 1.694233e-01 1 1  ON 23
 eC_4                 2.432547e-01 1 1  ON 24
 eC_5                 2.344031e-01 1 1  ON 25
 eC_6                 6.308189e-02 1 1  ON 26
 eC_7                 1.202198e-02 1 1  ON 27
 eC_8                 3.471437e-03 1 1  ON 28
 eC_9                 1.926414e-03 1 1  ON 29
 eO_0                -8.299536e-01 1 1  ON 30
 eO_1                -4.610495e-01 1 1  ON 31
 eO_2                -9.378107e-03 1 1  ON 32
 eO_3                 2.428700e-01 1 1  ON 33
 eO_4                 3.625456e-01 1 1  ON 34
 eO_5                 3.703854e-01 1 1  ON 35
 eO_6                 2.401094e-01 1 1  ON 36
 eO_7                 7.103237e-02 1 1  ON 37
 eO_8                -1.183143e-03 1 1  ON 38
 eO_9                 7.335836e-03 1 1  ON 39
eH1_0                -1.164203e-01 1 1  ON 40
eH1_1                -1.767031e-02 1 1  ON 41
eH1_2                 2.469544e-03 1 1  ON 42
eH1_3                -7.147508e-03 1 1  ON 43
eH1_4                 1.698662e-02 1 1  ON 44
eH1_5                 1.018018e-02 1 1  ON 45
eH1_6                 2.296277e-02 1 1  ON 46
eH1_7                 5.246148e-02 1 1  ON 47
eH1_8                 2.414114e-02 1 1  ON 48
eH1_9                 8.226679e-03 1 1  ON 49
eH2_0                -1.185326e-01 1 1  ON 50
eH2_1                -1.953318e-02 1 1  ON 51
eH2_2                 9.128941e-05 1 1  ON 52
eH2_3                -7.857756e-03 1 1  ON 53
eH2_4                 1.658245e-02 1 1  ON 54
eH2_5                 8.390789e-03 1 1  ON 55
eH2_6                 2.278105e-02 1 1  ON 56
eH2_7                 5.702006e-02 1 1  ON 57
eH2_8                 3.059517e-02 1 1  ON 58
eH2_9                 8.819764e-03 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.3752e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORMP2PJWARM.s008 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORMP2PJWARM.s008 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=8  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2357e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 30888 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 8
    time step          = 0.05
    reference energy   = -22.3065
    reference variance = 0.836213
====================================================
  Execution time = 4.9603e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORMP2PJWARM.s008
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2422e+01
  VMC Evar = 5.6614e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.5919e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.566185739217
                                         uncertainty =       0.003794102395

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.566185739217
                                         uncertainty =       0.003794102395

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000532042800
  error estimate for blocks of size 2^( 2) =       0.000553832923
  error estimate for blocks of size 2^( 3) =       0.000574596553
  error estimate for blocks of size 2^( 4) =       0.000590164600
  error estimate for blocks of size 2^( 5) =       0.000599843121
  error estimate for blocks of size 2^( 6) =       0.000607023802
  error estimate for blocks of size 2^( 7) =       0.000609841928

      target function =                  N/A
              le_mean =     -22.422438747894
             les_mean =     503.331898201053
             stat err =       0.000601718363
             autocorr =       1.279067283438
              std dev =       0.752422142855
             le_variance =       0.566139081058


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.242243874789e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.7656e-03, overlap shift 9.7656e-02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.422438747894       residual = 7.68e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.422482346014       residual = 2.80e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.422551246694       residual = 1.93e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.422632439883       residual = 3.27e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.422758909862       residual = 3.73e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.422877412156       residual = 3.03e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.423093604772       residual = 4.96e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.423221877452       residual = 1.66e-04           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.423329882058       residual = 1.61e-04           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.423416916912       residual = 2.22e-04           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -22.423591993876       residual = 2.43e-04           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -22.423687839321       residual = 2.09e-04           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -22.423763448382       residual = 1.31e-04           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -22.423887830151       residual = 4.29e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -22.424002222676       residual = 2.84e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -22.424026368028       residual = 1.33e-05           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -22.424036255010       residual = 9.96e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   energy =     -22.424046663925       residual = 5.20e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   energy =     -22.424045548678       residual = 4.08e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   energy =     -22.424061978979       residual = 3.27e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   energy =     -22.424074394766       residual = 3.72e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   energy =     -22.424084462008       residual = 2.83e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   energy =     -22.424087299631       residual = 2.04e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   energy =     -22.424086443182       residual = 1.19e-06           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   energy =     -22.424089388837       residual = 1.12e-06           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   energy =     -22.424094212433       residual = 8.31e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   energy =     -22.424097800817       residual = 2.35e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   energy =     -22.424097323575       residual = 1.48e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   energy =     -22.424097731738       residual = 5.51e-08           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   energy =     -22.424098235993       residual = 2.66e-08           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   energy =     -22.424098617430       residual = 1.89e-08           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   energy =     -22.424098252183       residual = 1.44e-08           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   energy =     -22.424098619455       residual = 3.59e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         32 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 9.7656e-03 is 8.059956e-01

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 3.9062e-02, overlap shift 3.9062e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.422438747894       residual = 7.68e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.422476978867       residual = 2.73e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.422527691110       residual = 1.83e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.422592738613       residual = 2.65e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.422686790713       residual = 2.83e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.422757762893       residual = 1.87e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.422849876145       residual = 2.38e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.422914486026       residual = 6.17e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.422957857681       residual = 5.72e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.422982972355       residual = 6.61e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -22.423032366383       residual = 5.52e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -22.423043147146       residual = 3.13e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -22.423050648054       residual = 1.83e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -22.423073491459       residual = 6.45e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -22.423084662912       residual = 4.66e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -22.423091548970       residual = 1.35e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -22.423088811298       residual = 1.05e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   energy =     -22.423089834970       residual = 2.92e-07           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   energy =     -22.423089331312       residual = 2.14e-07           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   energy =     -22.423091012617       residual = 1.48e-07           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   energy =     -22.423091019217       residual = 9.43e-08           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   energy =     -22.423091421945       residual = 4.25e-08           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   energy =     -22.423090759518       residual = 2.33e-08           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   energy =     -22.423090677142       residual = 1.14e-08           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   energy =     -22.423090713260       residual = 4.33e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         24 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 3.9062e-02 is 7.530150e-02

solving harmonic davidson linear method for identity shift 1.5625e-01, overlap shift 1.5625e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.422438747894       residual = 7.68e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.422464364601       residual = 2.66e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.422486636330       residual = 1.62e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.422524349946       residual = 1.83e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.422570952475       residual = 1.71e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.422593013336       residual = 7.55e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.422609640795       residual = 5.11e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.422624324492       residual = 1.37e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.422637240467       residual = 1.02e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.422640098587       residual = 9.28e-06           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -22.422639825912       residual = 3.58e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -22.422640758462       residual = 2.06e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -22.422642962648       residual = 1.08e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -22.422643462847       residual = 3.28e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -22.422645631560       residual = 1.32e-07           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -22.422644933937       residual = 4.10e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -22.422645004135       residual = 2.07e-08           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   energy =     -22.422644768211       residual = 7.37e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         17 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.5625e-01 is 1.547457e-02

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.140782 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 6.5553e+01
  </log>
  <optVariables href="FORMP2PJWARM.s008.opt.xml">
 uu_0                 2.662219e-01 1 1  ON 0
 uu_1                 9.483322e-02 1 1  ON 1
 uu_2                -1.376651e-02 1 1  ON 2
 uu_3                -7.428650e-02 1 1  ON 3
 uu_4                -1.038735e-01 1 1  ON 4
 uu_5                -1.140858e-01 1 1  ON 5
 uu_6                -1.087114e-01 1 1  ON 6
 uu_7                -8.244630e-02 1 1  ON 7
 uu_8                -3.786135e-02 1 1  ON 8
 uu_9                 3.626420e-02 1 1  ON 9
 ud_0                 4.072153e-01 1 1  ON 10
 ud_1                 1.271819e-01 1 1  ON 11
 ud_2                -1.292239e-02 1 1  ON 12
 ud_3                -8.403910e-02 1 1  ON 13
 ud_4                -1.185076e-01 1 1  ON 14
 ud_5                -1.333365e-01 1 1  ON 15
 ud_6                -1.321587e-01 1 1  ON 16
 ud_7                -1.100523e-01 1 1  ON 17
 ud_8                -6.864976e-02 1 1  ON 18
 ud_9                 7.018044e-03 1 1  ON 19
 eC_0                -4.580689e-01 1 1  ON 20
 eC_1                -3.044401e-01 1 1  ON 21
 eC_2                -3.553332e-02 1 1  ON 22
 eC_3                 1.408609e-01 1 1  ON 23
 eC_4                 2.270945e-01 1 1  ON 24
 eC_5                 2.632588e-01 1 1  ON 25
 eC_6                 1.221525e-01 1 1  ON 26
 eC_7                 3.381676e-02 1 1  ON 27
 eC_8                 6.446807e-03 1 1  ON 28
 eC_9                 3.015314e-03 1 1  ON 29
 eO_0                -8.728821e-01 1 1  ON 30
 eO_1                -5.055032e-01 1 1  ON 31
 eO_2                -5.303625e-02 1 1  ON 32
 eO_3                 2.071778e-01 1 1  ON 33
 eO_4                 3.503305e-01 1 1  ON 34
 eO_5                 3.872193e-01 1 1  ON 35
 eO_6                 2.920594e-01 1 1  ON 36
 eO_7                 1.463339e-01 1 1  ON 37
 eO_8                 2.275576e-02 1 1  ON 38
 eO_9                 1.346841e-02 1 1  ON 39
eH1_0                -1.228384e-01 1 1  ON 40
eH1_1                -2.541990e-02 1 1  ON 41
eH1_2                -5.834484e-03 1 1  ON 42
eH1_3                -1.184668e-02 1 1  ON 43
eH1_4                 1.675359e-02 1 1  ON 44
eH1_5                 1.515299e-02 1 1  ON 45
eH1_6                 2.797479e-02 1 1  ON 46
eH1_7                 4.423904e-02 1 1  ON 47
eH1_8                 4.066430e-02 1 1  ON 48
eH1_9                 1.604134e-02 1 1  ON 49
eH2_0                -1.248400e-01 1 1  ON 50
eH2_1                -2.559075e-02 1 1  ON 51
eH2_2                -6.155011e-03 1 1  ON 52
eH2_3                -1.210216e-02 1 1  ON 53
eH2_4                 1.564619e-02 1 1  ON 54
eH2_5                 1.529438e-02 1 1  ON 55
eH2_6                 2.656124e-02 1 1  ON 56
eH2_7                 4.257475e-02 1 1  ON 57
eH2_8                 4.517423e-02 1 1  ON 58
eH2_9                 1.878441e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 8
    time step          = 0.05
    reference energy   = -22.3936
    reference variance = 0.396459
====================================================
  Execution time = 4.8189e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORMP2PJWARM.s008
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2424e+01
  VMC Evar = 5.7280e-01
  Total weights = 2.0000e+06
  Execution time = 4.5197e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.576403337273
                                         uncertainty =       0.005025583692

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.576403337273
                                         uncertainty =       0.005025583692

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000536844493
  error estimate for blocks of size 2^( 2) =       0.000559270544
  error estimate for blocks of size 2^( 3) =       0.000580113768
  error estimate for blocks of size 2^( 4) =       0.000596922094
  error estimate for blocks of size 2^( 5) =       0.000606862480
  error estimate for blocks of size 2^( 6) =       0.000612297553
  error estimate for blocks of size 2^( 7) =       0.000615357647

      target function =                  N/A
              le_mean =     -22.424352836134
             les_mean =     503.428003849516
             stat err =       0.000607859943
             autocorr =       1.282065006235
              std dev =       0.759212762198
             le_variance =       0.576404018285

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.660634160776
                                         uncertainty =       0.005188560979

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.660634160776
                                         uncertainty =       0.005188560979

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000574743005
  error estimate for blocks of size 2^( 2) =       0.000610125272
  error estimate for blocks of size 2^( 3) =       0.000644673442
  error estimate for blocks of size 2^( 4) =       0.000672371325
  error estimate for blocks of size 2^( 5) =       0.000688837845
  error estimate for blocks of size 2^( 6) =       0.000697705523
  error estimate for blocks of size 2^( 7) =       0.000702405063

      target function =                  N/A
              le_mean =     -22.454843950919
             les_mean =     504.880675573937
             stat err =       0.000690329939
             autocorr =       1.442666770328
              std dev =       0.812809352899
             le_variance =       0.660659044161

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.571052258267
                                         uncertainty =       0.004986265158

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.571052258267
                                         uncertainty =       0.004986265158

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000534348224
  error estimate for blocks of size 2^( 2) =       0.000556043651
  error estimate for blocks of size 2^( 3) =       0.000576058934
  error estimate for blocks of size 2^( 4) =       0.000592043523
  error estimate for blocks of size 2^( 5) =       0.000601443992
  error estimate for blocks of size 2^( 6) =       0.000606552043
  error estimate for blocks of size 2^( 7) =       0.000609322705

      target function =                  N/A
              le_mean =     -22.424259807763
             les_mean =     503.418483690575
             stat err =       0.000602340566
             autocorr =       1.270677921035
              std dev =       0.755682506112
             le_variance =       0.571056050044

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.574967797959
                                         uncertainty =       0.005016393018

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.574967797959
                                         uncertainty =       0.005016393018

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000536175782
  error estimate for blocks of size 2^( 2) =       0.000558490009
  error estimate for blocks of size 2^( 3) =       0.000579222757
  error estimate for blocks of size 2^( 4) =       0.000595926249
  error estimate for blocks of size 2^( 5) =       0.000605801109
  error estimate for blocks of size 2^( 6) =       0.000611189024
  error estimate for blocks of size 2^( 7) =       0.000614202244

      target function =                  N/A
              le_mean =     -22.424183024644
             les_mean =     503.418952972974
             stat err =       0.000606779656
             autocorr =       1.280700668343
              std dev =       0.758267062276
             le_variance =       0.574968937732


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.424352836134        initial  <--
            N/A            N/A                    N/A                    N/A     bad update
     3.9062e-02     3.9062e-01             7.5302e-02       -22.424259807763
     1.5625e-01     1.5625e+00             1.5475e-02       -22.424183024644

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 70.7724
  </log>
  <optVariables href="FORMP2PJWARM.s008.opt.xml">
 uu_0                 2.638110e-01 1 1  ON 0
 uu_1                 9.182593e-02 1 1  ON 1
 uu_2                -1.756112e-02 1 1  ON 2
 uu_3                -7.730435e-02 1 1  ON 3
 uu_4                -1.044233e-01 1 1  ON 4
 uu_5                -1.106503e-01 1 1  ON 5
 uu_6                -9.919404e-02 1 1  ON 6
 uu_7                -6.661362e-02 1 1  ON 7
 uu_8                -1.395037e-02 1 1  ON 8
 uu_9                 4.650685e-02 1 1  ON 9
 ud_0                 4.010330e-01 1 1  ON 10
 ud_1                 1.218450e-01 1 1  ON 11
 ud_2                -1.887724e-02 1 1  ON 12
 ud_3                -8.921081e-02 1 1  ON 13
 ud_4                -1.214568e-01 1 1  ON 14
 ud_5                -1.322557e-01 1 1  ON 15
 ud_6                -1.246807e-01 1 1  ON 16
 ud_7                -9.437624e-02 1 1  ON 17
 ud_8                -4.480495e-02 1 1  ON 18
 ud_9                 2.494731e-02 1 1  ON 19
 eC_0                -4.408478e-01 1 1  ON 20
 eC_1                -2.798085e-01 1 1  ON 21
 eC_2                -7.629806e-03 1 1  ON 22
 eC_3                 1.694233e-01 1 1  ON 23
 eC_4                 2.432547e-01 1 1  ON 24
 eC_5                 2.344031e-01 1 1  ON 25
 eC_6                 6.308189e-02 1 1  ON 26
 eC_7                 1.202198e-02 1 1  ON 27
 eC_8                 3.471437e-03 1 1  ON 28
 eC_9                 1.926414e-03 1 1  ON 29
 eO_0                -8.299536e-01 1 1  ON 30
 eO_1                -4.610495e-01 1 1  ON 31
 eO_2                -9.378107e-03 1 1  ON 32
 eO_3                 2.428700e-01 1 1  ON 33
 eO_4                 3.625456e-01 1 1  ON 34
 eO_5                 3.703854e-01 1 1  ON 35
 eO_6                 2.401094e-01 1 1  ON 36
 eO_7                 7.103237e-02 1 1  ON 37
 eO_8                -1.183143e-03 1 1  ON 38
 eO_9                 7.335836e-03 1 1  ON 39
eH1_0                -1.164203e-01 1 1  ON 40
eH1_1                -1.767031e-02 1 1  ON 41
eH1_2                 2.469544e-03 1 1  ON 42
eH1_3                -7.147508e-03 1 1  ON 43
eH1_4                 1.698662e-02 1 1  ON 44
eH1_5                 1.018018e-02 1 1  ON 45
eH1_6                 2.296277e-02 1 1  ON 46
eH1_7                 5.246148e-02 1 1  ON 47
eH1_8                 2.414114e-02 1 1  ON 48
eH1_9                 8.226679e-03 1 1  ON 49
eH2_0                -1.185326e-01 1 1  ON 50
eH2_1                -1.953318e-02 1 1  ON 51
eH2_2                 9.128941e-05 1 1  ON 52
eH2_3                -7.857756e-03 1 1  ON 53
eH2_4                 1.658245e-02 1 1  ON 54
eH2_5                 8.390789e-03 1 1  ON 55
eH2_6                 2.278105e-02 1 1  ON 56
eH2_7                 5.702006e-02 1 1  ON 57
eH2_8                 3.059517e-02 1 1  ON 58
eH2_9                 8.819764e-03 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.3633e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORMP2PJWARM.s009 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORMP2PJWARM.s009 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=9  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2357e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 30888 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 9
    time step          = 0.05
    reference energy   = -22.4655
    reference variance = 0.39139
====================================================
  Execution time = 5.0046e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORMP2PJWARM.s009
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2423e+01
  VMC Evar = 5.7162e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.5954e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.571821491891
                                         uncertainty =       0.003876455858

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.571821491891
                                         uncertainty =       0.003876455858

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000534612401
  error estimate for blocks of size 2^( 2) =       0.000556746987
  error estimate for blocks of size 2^( 3) =       0.000578364337
  error estimate for blocks of size 2^( 4) =       0.000594397248
  error estimate for blocks of size 2^( 5) =       0.000605450429
  error estimate for blocks of size 2^( 6) =       0.000613482217
  error estimate for blocks of size 2^( 7) =       0.000616051831

      target function =                  N/A
              le_mean =     -22.423377120111
             les_mean =     503.379462024094
             stat err =       0.000607345431
             autocorr =       1.290605406727
              std dev =       0.756056108498
             le_variance =       0.571620839196


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.242337712011e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.7656e-02, overlap shift 9.7656e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.423377120111       residual = 7.84e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.423410164141       residual = 2.17e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.423450482505       residual = 1.43e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.423492446256       residual = 3.74e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.423570758529       residual = 2.18e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.423603640250       residual = 1.07e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.423628417297       residual = 7.68e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.423659766770       residual = 3.01e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.423678878136       residual = 1.67e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.423687954233       residual = 2.01e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -22.423691877296       residual = 1.12e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -22.423689630607       residual = 6.50e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -22.423688785289       residual = 2.45e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -22.423687112299       residual = 9.46e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -22.423688276773       residual = 5.32e-07           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -22.423690157831       residual = 1.33e-07           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -22.423689702709       residual = 7.23e-08           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   energy =     -22.423690202420       residual = 3.24e-08           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   energy =     -22.423689524319       residual = 1.08e-08           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   energy =     -22.423689615867       residual = 8.59e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         19 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 9.7656e-02 is 2.458583e-02

solving harmonic davidson linear method for identity shift 3.9062e-01, overlap shift 3.9062e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.423377120111       residual = 7.84e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.423395310700       residual = 1.75e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.423409080824       residual = 1.26e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.423422348619       residual = 2.69e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.423455383194       residual = 8.85e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.423460581212       residual = 4.10e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.423464083395       residual = 1.69e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.423467982828       residual = 6.69e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.423473271581       residual = 3.01e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.423474082418       residual = 2.18e-06           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -22.423472073820       residual = 7.51e-07           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -22.423471485665       residual = 4.78e-07           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -22.423471404895       residual = 1.32e-07           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -22.423471044647       residual = 4.47e-08           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -22.423471338484       residual = 1.23e-08           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -22.423471343345       residual = 2.86e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         15 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 3.9062e-01 is 5.863886e-03

solving harmonic davidson linear method for identity shift 1.5625e+00, overlap shift 1.5625e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.423377120111       residual = 7.84e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.423383621337       residual = 1.50e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.423387103797       residual = 1.15e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.423390343905       residual = 2.13e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.423400670007       residual = 3.76e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.423400952388       residual = 1.76e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.423401444148       residual = 5.55e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.423402127527       residual = 2.26e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.423403128007       residual = 4.74e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.423402972397       residual = 4.43e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -22.423402569528       residual = 8.24e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -22.423402482276       residual = 3.93e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -22.423402504481       residual = 1.04e-08           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -22.423402526840       residual = 3.05e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         13 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.5625e+00 is 1.449186e-03

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.150767 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 6.6014e+01
  </log>
  <optVariables href="FORMP2PJWARM.s009.opt.xml">
 uu_0                 2.637996e-01 1 1  ON 0
 uu_1                 9.210878e-02 1 1  ON 1
 uu_2                -1.705215e-02 1 1  ON 2
 uu_3                -7.680321e-02 1 1  ON 3
 uu_4                -1.040971e-01 1 1  ON 4
 uu_5                -1.104693e-01 1 1  ON 5
 uu_6                -9.984838e-02 1 1  ON 6
 uu_7                -6.772097e-02 1 1  ON 7
 uu_8                -1.658061e-02 1 1  ON 8
 uu_9                 4.603878e-02 1 1  ON 9
 ud_0                 4.013976e-01 1 1  ON 10
 ud_1                 1.221279e-01 1 1  ON 11
 ud_2                -1.805230e-02 1 1  ON 12
 ud_3                -8.856352e-02 1 1  ON 13
 ud_4                -1.208738e-01 1 1  ON 14
 ud_5                -1.320129e-01 1 1  ON 15
 ud_6                -1.251098e-01 1 1  ON 16
 ud_7                -9.583060e-02 1 1  ON 17
 ud_8                -4.699321e-02 1 1  ON 18
 ud_9                 2.363403e-02 1 1  ON 19
 eC_0                -4.406230e-01 1 1  ON 20
 eC_1                -2.816822e-01 1 1  ON 21
 eC_2                -1.026203e-02 1 1  ON 22
 eC_3                 1.661689e-01 1 1  ON 23
 eC_4                 2.414067e-01 1 1  ON 24
 eC_5                 2.378141e-01 1 1  ON 25
 eC_6                 6.760921e-02 1 1  ON 26
 eC_7                 1.320307e-02 1 1  ON 27
 eC_8                 3.647559e-03 1 1  ON 28
 eC_9                 2.001373e-03 1 1  ON 29
 eO_0                -8.319057e-01 1 1  ON 30
 eO_1                -4.638647e-01 1 1  ON 31
 eO_2                -1.337214e-02 1 1  ON 32
 eO_3                 2.393764e-01 1 1  ON 33
 eO_4                 3.611672e-01 1 1  ON 34
 eO_5                 3.714344e-01 1 1  ON 35
 eO_6                 2.450795e-01 1 1  ON 36
 eO_7                 7.689625e-02 1 1  ON 37
 eO_8                 4.980890e-05 1 1  ON 38
 eO_9                 7.617483e-03 1 1  ON 39
eH1_0                -1.165910e-01 1 1  ON 40
eH1_1                -1.804476e-02 1 1  ON 41
eH1_2                 1.768570e-03 1 1  ON 42
eH1_3                -7.329286e-03 1 1  ON 43
eH1_4                 1.670771e-02 1 1  ON 44
eH1_5                 1.046702e-02 1 1  ON 45
eH1_6                 2.278880e-02 1 1  ON 46
eH1_7                 5.184522e-02 1 1  ON 47
eH1_8                 2.567933e-02 1 1  ON 48
eH1_9                 8.761659e-03 1 1  ON 49
eH2_0                -1.185387e-01 1 1  ON 50
eH2_1                -2.015651e-02 1 1  ON 51
eH2_2                -3.361747e-04 1 1  ON 52
eH2_3                -8.333619e-03 1 1  ON 53
eH2_4                 1.616116e-02 1 1  ON 54
eH2_5                 9.073374e-03 1 1  ON 55
eH2_6                 2.303202e-02 1 1  ON 56
eH2_7                 5.598045e-02 1 1  ON 57
eH2_8                 3.197750e-02 1 1  ON 58
eH2_9                 9.371025e-03 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 9
    time step          = 0.05
    reference energy   = -22.4294
    reference variance = 0.452051
====================================================
  Execution time = 4.8018e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORMP2PJWARM.s009
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2422e+01
  VMC Evar = 5.7192e-01
  Total weights = 2.0000e+06
  Execution time = 4.5090e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.573043687249
                                         uncertainty =       0.004837299713

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.573043687249
                                         uncertainty =       0.004837299713

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000535310944
  error estimate for blocks of size 2^( 2) =       0.000557906077
  error estimate for blocks of size 2^( 3) =       0.000578839299
  error estimate for blocks of size 2^( 4) =       0.000595035317
  error estimate for blocks of size 2^( 5) =       0.000605455446
  error estimate for blocks of size 2^( 6) =       0.000612027711
  error estimate for blocks of size 2^( 7) =       0.000619935067

      target function =                  N/A
              le_mean =     -22.422255884166
             les_mean =     503.330674262342
             stat err =       0.000608113385
             autocorr =       1.290496647256
              std dev =       0.757043997329
             le_variance =       0.573115613892

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.569902387184
                                         uncertainty =       0.004809473849

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.569902387184
                                         uncertainty =       0.004809473849

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000533841806
  error estimate for blocks of size 2^( 2) =       0.000556266876
  error estimate for blocks of size 2^( 3) =       0.000577020309
  error estimate for blocks of size 2^( 4) =       0.000593047297
  error estimate for blocks of size 2^( 5) =       0.000603386558
  error estimate for blocks of size 2^( 6) =       0.000609965410
  error estimate for blocks of size 2^( 7) =       0.000617820334

      target function =                  N/A
              le_mean =     -22.422251432865
             les_mean =     503.327333181962
             stat err =       0.000606054899
             autocorr =       1.288839299883
              std dev =       0.754966322659
             le_variance =       0.569974148350

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.570709555079
                                         uncertainty =       0.004818029209

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.570709555079
                                         uncertainty =       0.004818029209

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000534219737
  error estimate for blocks of size 2^( 2) =       0.000556741843
  error estimate for blocks of size 2^( 3) =       0.000577597788
  error estimate for blocks of size 2^( 4) =       0.000593725220
  error estimate for blocks of size 2^( 5) =       0.000604120385
  error estimate for blocks of size 2^( 6) =       0.000610715969
  error estimate for blocks of size 2^( 7) =       0.000618600693

      target function =                  N/A
              le_mean =     -22.422234922490
             les_mean =     503.327400088919
             stat err =       0.000606790566
             autocorr =       1.290142797356
              std dev =       0.755500797480
             le_variance =       0.570781454994

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.572692242948
                                         uncertainty =       0.004834970175

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.572692242948
                                         uncertainty =       0.004834970175

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000535146802
  error estimate for blocks of size 2^( 2) =       0.000557733328
  error estimate for blocks of size 2^( 3) =       0.000578656724
  error estimate for blocks of size 2^( 4) =       0.000594844726
  error estimate for blocks of size 2^( 5) =       0.000605262428
  error estimate for blocks of size 2^( 6) =       0.000611839711
  error estimate for blocks of size 2^( 7) =       0.000619744140

      target function =                  N/A
              le_mean =     -22.422248667850
             les_mean =     503.329999236864
             stat err =       0.000607922751
             autocorr =       1.290478948088
              std dev =       0.756811865880
             le_variance =       0.572764200337


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.422255884166        initial  <--
     9.7656e-02     9.7656e-01             2.4586e-02       -22.422251432865
     3.9062e-01     3.9062e+00             5.8639e-03       -22.422234922490
     1.5625e+00     1.5625e+01             1.4492e-03       -22.422248667850

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 70.5544
  </log>
  <optVariables href="FORMP2PJWARM.s009.opt.xml">
 uu_0                 2.638110e-01 1 1  ON 0
 uu_1                 9.182593e-02 1 1  ON 1
 uu_2                -1.756112e-02 1 1  ON 2
 uu_3                -7.730435e-02 1 1  ON 3
 uu_4                -1.044233e-01 1 1  ON 4
 uu_5                -1.106503e-01 1 1  ON 5
 uu_6                -9.919404e-02 1 1  ON 6
 uu_7                -6.661362e-02 1 1  ON 7
 uu_8                -1.395037e-02 1 1  ON 8
 uu_9                 4.650685e-02 1 1  ON 9
 ud_0                 4.010330e-01 1 1  ON 10
 ud_1                 1.218450e-01 1 1  ON 11
 ud_2                -1.887724e-02 1 1  ON 12
 ud_3                -8.921081e-02 1 1  ON 13
 ud_4                -1.214568e-01 1 1  ON 14
 ud_5                -1.322557e-01 1 1  ON 15
 ud_6                -1.246807e-01 1 1  ON 16
 ud_7                -9.437624e-02 1 1  ON 17
 ud_8                -4.480495e-02 1 1  ON 18
 ud_9                 2.494731e-02 1 1  ON 19
 eC_0                -4.408478e-01 1 1  ON 20
 eC_1                -2.798085e-01 1 1  ON 21
 eC_2                -7.629806e-03 1 1  ON 22
 eC_3                 1.694233e-01 1 1  ON 23
 eC_4                 2.432547e-01 1 1  ON 24
 eC_5                 2.344031e-01 1 1  ON 25
 eC_6                 6.308189e-02 1 1  ON 26
 eC_7                 1.202198e-02 1 1  ON 27
 eC_8                 3.471437e-03 1 1  ON 28
 eC_9                 1.926414e-03 1 1  ON 29
 eO_0                -8.299536e-01 1 1  ON 30
 eO_1                -4.610495e-01 1 1  ON 31
 eO_2                -9.378107e-03 1 1  ON 32
 eO_3                 2.428700e-01 1 1  ON 33
 eO_4                 3.625456e-01 1 1  ON 34
 eO_5                 3.703854e-01 1 1  ON 35
 eO_6                 2.401094e-01 1 1  ON 36
 eO_7                 7.103237e-02 1 1  ON 37
 eO_8                -1.183143e-03 1 1  ON 38
 eO_9                 7.335836e-03 1 1  ON 39
eH1_0                -1.164203e-01 1 1  ON 40
eH1_1                -1.767031e-02 1 1  ON 41
eH1_2                 2.469544e-03 1 1  ON 42
eH1_3                -7.147508e-03 1 1  ON 43
eH1_4                 1.698662e-02 1 1  ON 44
eH1_5                 1.018018e-02 1 1  ON 45
eH1_6                 2.296277e-02 1 1  ON 46
eH1_7                 5.246148e-02 1 1  ON 47
eH1_8                 2.414114e-02 1 1  ON 48
eH1_9                 8.226679e-03 1 1  ON 49
eH2_0                -1.185326e-01 1 1  ON 50
eH2_1                -1.953318e-02 1 1  ON 51
eH2_2                 9.128941e-05 1 1  ON 52
eH2_3                -7.857756e-03 1 1  ON 53
eH2_4                 1.658245e-02 1 1  ON 54
eH2_5                 8.390789e-03 1 1  ON 55
eH2_6                 2.278105e-02 1 1  ON 56
eH2_7                 5.702006e-02 1 1  ON 57
eH2_8                 3.059517e-02 1 1  ON 58
eH2_9                 8.819764e-03 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.3658e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORMP2PJWARM.s010 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORMP2PJWARM.s010 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=10  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2366e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 30888 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 10
    time step          = 0.05
    reference energy   = -22.3887
    reference variance = 0.464816
====================================================
  Execution time = 4.9213e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORMP2PJWARM.s010
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2422e+01
  VMC Evar = 5.6952e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.6099e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.569538085377
                                         uncertainty =       0.004498735792

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.569538085377
                                         uncertainty =       0.004498735792

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000533629962
  error estimate for blocks of size 2^( 2) =       0.000555454637
  error estimate for blocks of size 2^( 3) =       0.000576358053
  error estimate for blocks of size 2^( 4) =       0.000592228998
  error estimate for blocks of size 2^( 5) =       0.000602438040
  error estimate for blocks of size 2^( 6) =       0.000608151517
  error estimate for blocks of size 2^( 7) =       0.000610617669

      target function =                  N/A
              le_mean =     -22.421533150275
             les_mean =     503.294670396715
             stat err =       0.000603359056
             autocorr =       1.278413237738
              std dev =       0.754666729496
             le_variance =       0.569521872608


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.242153315027e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.7656e-01, overlap shift 9.7656e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.421533150275       residual = 7.69e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.421538471511       residual = 2.96e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.421548504501       residual = 1.75e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.421554406301       residual = 1.13e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.421564750570       residual = 7.43e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.421569738834       residual = 2.94e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.421571371837       residual = 8.76e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.421571627739       residual = 2.12e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.421572546685       residual = 1.91e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.421572734128       residual = 4.87e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -22.421572586722       residual = 1.67e-07           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -22.421572590754       residual = 8.05e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -22.421572683996       residual = 2.35e-08           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -22.421572700710       residual = 8.56e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         13 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 9.7656e-01 is 2.398036e-03

solving harmonic davidson linear method for identity shift 3.9062e+00, overlap shift 3.9062e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.421533150275       residual = 7.69e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.421534666512       residual = 3.11e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.421537428461       residual = 1.61e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.421538992917       residual = 1.04e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.421541553644       residual = 5.60e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.421542686615       residual = 2.23e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.421543028124       residual = 5.68e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.421543044258       residual = 1.42e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.421543268039       residual = 1.06e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.421543306777       residual = 1.71e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -22.421543277270       residual = 6.81e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -22.421543280736       residual = 2.99e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -22.421543299473       residual = 6.06e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         12 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 3.9062e+00 is 5.953496e-04

solving harmonic davidson linear method for identity shift 1.5625e+01, overlap shift 1.5625e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.421533150275       residual = 7.69e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.421533543058       residual = 3.15e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.421534252834       residual = 1.57e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.421534649365       residual = 1.01e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.421535286037       residual = 5.12e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.421535558713       residual = 2.07e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.421535638262       residual = 4.94e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.421535640267       residual = 1.25e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.421535695738       residual = 8.68e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.421535704120       residual = 1.30e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -22.421535698781       residual = 5.66e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -22.421535699346       residual = 2.01e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -22.421535702767       residual = 4.88e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         12 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.5625e+01 is 1.486070e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.156941 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 6.5322e+01
  </log>
  <optVariables href="FORMP2PJWARM.s010.opt.xml">
 uu_0                 2.638278e-01 1 1  ON 0
 uu_1                 9.184043e-02 1 1  ON 1
 uu_2                -1.748859e-02 1 1  ON 2
 uu_3                -7.725357e-02 1 1  ON 3
 uu_4                -1.043724e-01 1 1  ON 4
 uu_5                -1.106619e-01 1 1  ON 5
 uu_6                -9.926704e-02 1 1  ON 6
 uu_7                -6.675715e-02 1 1  ON 7
 uu_8                -1.424722e-02 1 1  ON 8
 uu_9                 4.647206e-02 1 1  ON 9
 ud_0                 4.010977e-01 1 1  ON 10
 ud_1                 1.218461e-01 1 1  ON 11
 ud_2                -1.880396e-02 1 1  ON 12
 ud_3                -8.917083e-02 1 1  ON 13
 ud_4                -1.214120e-01 1 1  ON 14
 ud_5                -1.322320e-01 1 1  ON 15
 ud_6                -1.247161e-01 1 1  ON 16
 ud_7                -9.450847e-02 1 1  ON 17
 ud_8                -4.502018e-02 1 1  ON 18
 ud_9                 2.481167e-02 1 1  ON 19
 eC_0                -4.408092e-01 1 1  ON 20
 eC_1                -2.800353e-01 1 1  ON 21
 eC_2                -7.894881e-03 1 1  ON 22
 eC_3                 1.690718e-01 1 1  ON 23
 eC_4                 2.430263e-01 1 1  ON 24
 eC_5                 2.347884e-01 1 1  ON 25
 eC_6                 6.357323e-02 1 1  ON 26
 eC_7                 1.214416e-02 1 1  ON 27
 eC_8                 3.488649e-03 1 1  ON 28
 eC_9                 1.939057e-03 1 1  ON 29
 eO_0                -8.300995e-01 1 1  ON 30
 eO_1                -4.613322e-01 1 1  ON 31
 eO_2                -9.782165e-03 1 1  ON 32
 eO_3                 2.425150e-01 1 1  ON 33
 eO_4                 3.624090e-01 1 1  ON 34
 eO_5                 3.704360e-01 1 1  ON 35
 eO_6                 2.406139e-01 1 1  ON 36
 eO_7                 7.162772e-02 1 1  ON 37
 eO_8                -1.064250e-03 1 1  ON 38
 eO_9                 7.358001e-03 1 1  ON 39
eH1_0                -1.164693e-01 1 1  ON 40
eH1_1                -1.779134e-02 1 1  ON 41
eH1_2                 2.365355e-03 1 1  ON 42
eH1_3                -7.170910e-03 1 1  ON 43
eH1_4                 1.702527e-02 1 1  ON 44
eH1_5                 1.019569e-02 1 1  ON 45
eH1_6                 2.294392e-02 1 1  ON 46
eH1_7                 5.244418e-02 1 1  ON 47
eH1_8                 2.434333e-02 1 1  ON 48
eH1_9                 8.289802e-03 1 1  ON 49
eH2_0                -1.185148e-01 1 1  ON 50
eH2_1                -1.962006e-02 1 1  ON 51
eH2_2                 6.919943e-05 1 1  ON 52
eH2_3                -7.907246e-03 1 1  ON 53
eH2_4                 1.649999e-02 1 1  ON 54
eH2_5                 8.483152e-03 1 1  ON 55
eH2_6                 2.278192e-02 1 1  ON 56
eH2_7                 5.693031e-02 1 1  ON 57
eH2_8                 3.073866e-02 1 1  ON 58
eH2_9                 8.875844e-03 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 10
    time step          = 0.05
    reference energy   = -22.3052
    reference variance = 0.514843
====================================================
  Execution time = 4.8168e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORMP2PJWARM.s010
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2422e+01
  VMC Evar = 5.8586e-01
  Total weights = 2.0000e+06
  Execution time = 4.5158e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.586109148388
                                         uncertainty =       0.011400156023

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.586109148388
                                         uncertainty =       0.011400156023

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000541275667
  error estimate for blocks of size 2^( 2) =       0.000562882967
  error estimate for blocks of size 2^( 3) =       0.000583614397
  error estimate for blocks of size 2^( 4) =       0.000599458703
  error estimate for blocks of size 2^( 5) =       0.000610086119
  error estimate for blocks of size 2^( 6) =       0.000616302503
  error estimate for blocks of size 2^( 7) =       0.000620547504

      target function =                  N/A
              le_mean =     -22.421637398514
             les_mean =     503.315782032890
             stat err =       0.000611598707
             autocorr =       1.276721317514
              std dev =       0.765479389305
             le_variance =       0.585958695450

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.585721187110
                                         uncertainty =       0.011387087266

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.585721187110
                                         uncertainty =       0.011387087266

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000541096511
  error estimate for blocks of size 2^( 2) =       0.000562686739
  error estimate for blocks of size 2^( 3) =       0.000583400184
  error estimate for blocks of size 2^( 4) =       0.000599227733
  error estimate for blocks of size 2^( 5) =       0.000609838172
  error estimate for blocks of size 2^( 6) =       0.000616045550
  error estimate for blocks of size 2^( 7) =       0.000620278192

      target function =                  N/A
              le_mean =     -22.421636319334
             les_mean =     503.315345811648
             stat err =       0.000611347412
             autocorr =       1.276517253429
              std dev =       0.765226024089
             le_variance =       0.585570867943

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.585914369707
                                         uncertainty =       0.011392953129

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.585914369707
                                         uncertainty =       0.011392953129

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000541185719
  error estimate for blocks of size 2^( 2) =       0.000562784440
  error estimate for blocks of size 2^( 3) =       0.000583506927
  error estimate for blocks of size 2^( 4) =       0.000599342562
  error estimate for blocks of size 2^( 5) =       0.000609961063
  error estimate for blocks of size 2^( 6) =       0.000616171987
  error estimate for blocks of size 2^( 7) =       0.000620410249

      target function =                  N/A
              le_mean =     -22.421636465277
             les_mean =     503.315545452061
             stat err =       0.000611471465
             autocorr =       1.276614391172
              std dev =       0.765352182932
             le_variance =       0.585763963918

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.586084983259
                                         uncertainty =       0.011399231633

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.586084983259
                                         uncertainty =       0.011399231633

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000541264508
  error estimate for blocks of size 2^( 2) =       0.000562870721
  error estimate for blocks of size 2^( 3) =       0.000583601022
  error estimate for blocks of size 2^( 4) =       0.000599444219
  error estimate for blocks of size 2^( 5) =       0.000610070487
  error estimate for blocks of size 2^( 6) =       0.000616286129
  error estimate for blocks of size 2^( 7) =       0.000620530269

      target function =                  N/A
              le_mean =     -22.421637227691
             les_mean =     503.315750212119
             stat err =       0.000611582776
             autocorr =       1.276707447536
              std dev =       0.765463607831
             le_variance =       0.585934534914


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.421637398514        initial  <--
     9.7656e-01     9.7656e+00             2.3980e-03       -22.421636319334
     3.9062e+00     3.9062e+01             5.9535e-04       -22.421636465277
     1.5625e+01     1.5625e+02             1.4861e-04       -22.421637227691

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 70.7200
  </log>
  <optVariables href="FORMP2PJWARM.s010.opt.xml">
 uu_0                 2.638110e-01 1 1  ON 0
 uu_1                 9.182593e-02 1 1  ON 1
 uu_2                -1.756112e-02 1 1  ON 2
 uu_3                -7.730435e-02 1 1  ON 3
 uu_4                -1.044233e-01 1 1  ON 4
 uu_5                -1.106503e-01 1 1  ON 5
 uu_6                -9.919404e-02 1 1  ON 6
 uu_7                -6.661362e-02 1 1  ON 7
 uu_8                -1.395037e-02 1 1  ON 8
 uu_9                 4.650685e-02 1 1  ON 9
 ud_0                 4.010330e-01 1 1  ON 10
 ud_1                 1.218450e-01 1 1  ON 11
 ud_2                -1.887724e-02 1 1  ON 12
 ud_3                -8.921081e-02 1 1  ON 13
 ud_4                -1.214568e-01 1 1  ON 14
 ud_5                -1.322557e-01 1 1  ON 15
 ud_6                -1.246807e-01 1 1  ON 16
 ud_7                -9.437624e-02 1 1  ON 17
 ud_8                -4.480495e-02 1 1  ON 18
 ud_9                 2.494731e-02 1 1  ON 19
 eC_0                -4.408478e-01 1 1  ON 20
 eC_1                -2.798085e-01 1 1  ON 21
 eC_2                -7.629806e-03 1 1  ON 22
 eC_3                 1.694233e-01 1 1  ON 23
 eC_4                 2.432547e-01 1 1  ON 24
 eC_5                 2.344031e-01 1 1  ON 25
 eC_6                 6.308189e-02 1 1  ON 26
 eC_7                 1.202198e-02 1 1  ON 27
 eC_8                 3.471437e-03 1 1  ON 28
 eC_9                 1.926414e-03 1 1  ON 29
 eO_0                -8.299536e-01 1 1  ON 30
 eO_1                -4.610495e-01 1 1  ON 31
 eO_2                -9.378107e-03 1 1  ON 32
 eO_3                 2.428700e-01 1 1  ON 33
 eO_4                 3.625456e-01 1 1  ON 34
 eO_5                 3.703854e-01 1 1  ON 35
 eO_6                 2.401094e-01 1 1  ON 36
 eO_7                 7.103237e-02 1 1  ON 37
 eO_8                -1.183143e-03 1 1  ON 38
 eO_9                 7.335836e-03 1 1  ON 39
eH1_0                -1.164203e-01 1 1  ON 40
eH1_1                -1.767031e-02 1 1  ON 41
eH1_2                 2.469544e-03 1 1  ON 42
eH1_3                -7.147508e-03 1 1  ON 43
eH1_4                 1.698662e-02 1 1  ON 44
eH1_5                 1.018018e-02 1 1  ON 45
eH1_6                 2.296277e-02 1 1  ON 46
eH1_7                 5.246148e-02 1 1  ON 47
eH1_8                 2.414114e-02 1 1  ON 48
eH1_9                 8.226679e-03 1 1  ON 49
eH2_0                -1.185326e-01 1 1  ON 50
eH2_1                -1.953318e-02 1 1  ON 51
eH2_2                 9.128941e-05 1 1  ON 52
eH2_3                -7.857756e-03 1 1  ON 53
eH2_4                 1.658245e-02 1 1  ON 54
eH2_5                 8.390789e-03 1 1  ON 55
eH2_6                 2.278105e-02 1 1  ON 56
eH2_7                 5.702006e-02 1 1  ON 57
eH2_8                 3.059517e-02 1 1  ON 58
eH2_9                 8.819764e-03 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.3605e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORMP2PJWARM.s011 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORMP2PJWARM.s011 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=11  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2364e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 30888 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 11
    time step          = 0.05
    reference energy   = -22.474
    reference variance = 0.356113
====================================================
  Execution time = 4.9072e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORMP2PJWARM.s011
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2422e+01
  VMC Evar = 5.7463e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.6266e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.574548122207
                                         uncertainty =       0.003896961249

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.574548122207
                                         uncertainty =       0.003896961249

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000536019052
  error estimate for blocks of size 2^( 2) =       0.000558206004
  error estimate for blocks of size 2^( 3) =       0.000579184367
  error estimate for blocks of size 2^( 4) =       0.000594813914
  error estimate for blocks of size 2^( 5) =       0.000603844703
  error estimate for blocks of size 2^( 6) =       0.000609266255
  error estimate for blocks of size 2^( 7) =       0.000613038543

      target function =                  N/A
              le_mean =     -22.421963130445
             les_mean =     503.319063184727
             stat err =       0.000605240853
             autocorr =       1.274958406355
              std dev =       0.758045413567
             le_variance =       0.574632849030


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.242196313044e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.7656e+00, overlap shift 9.7656e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.421963130445       residual = 7.72e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.421964191906       residual = 2.81e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.421965019185       residual = 1.05e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.421965560270       residual = 1.00e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.421966531613       residual = 6.72e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.421966798071       residual = 1.28e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.421967011248       residual = 4.63e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.421967132624       residual = 1.19e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.421967090666       residual = 6.47e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.421967154069       residual = 1.58e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -22.421967127645       residual = 4.60e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -22.421967135988       residual = 1.08e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -22.421967129696       residual = 3.73e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         12 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 9.7656e+00 is 2.255215e-04

solving harmonic davidson linear method for identity shift 3.9062e+01, overlap shift 3.9062e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.421963130445       residual = 7.72e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.421963399813       residual = 2.84e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.421963609810       residual = 1.04e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.421963745279       residual = 9.86e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.421963987278       residual = 6.30e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.421964051267       residual = 1.23e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.421964108460       residual = 4.32e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.421964132818       residual = 1.05e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.421964125644       residual = 5.40e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.421964139864       residual = 1.45e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -22.421964133714       residual = 4.55e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -22.421964135939       residual = 9.85e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 3.9062e+01 is 5.626765e-05

solving harmonic davidson linear method for identity shift 1.5625e+02, overlap shift 1.5625e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.421963130445       residual = 7.72e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.421963198042       residual = 2.85e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.421963250746       residual = 1.03e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.421963284624       residual = 9.81e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.421963345063       residual = 6.20e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.421963360892       residual = 1.22e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.421963375436       residual = 4.24e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.421963381139       residual = 1.02e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.421963379603       residual = 5.12e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.421963383013       residual = 1.42e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -22.421963381505       residual = 4.54e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -22.421963382076       residual = 9.62e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.5625e+02 is 1.406464e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.162318 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 6.5367e+01
  </log>
  <optVariables href="FORMP2PJWARM.s011.opt.xml">
 uu_0                 2.638150e-01 1 1  ON 0
 uu_1                 9.182755e-02 1 1  ON 1
 uu_2                -1.755734e-02 1 1  ON 2
 uu_3                -7.730115e-02 1 1  ON 3
 uu_4                -1.044177e-01 1 1  ON 4
 uu_5                -1.106489e-01 1 1  ON 5
 uu_6                -9.920133e-02 1 1  ON 6
 uu_7                -6.662511e-02 1 1  ON 7
 uu_8                -1.397863e-02 1 1  ON 8
 uu_9                 4.650097e-02 1 1  ON 9
 ud_0                 4.010475e-01 1 1  ON 10
 ud_1                 1.218452e-01 1 1  ON 11
 ud_2                -1.886732e-02 1 1  ON 12
 ud_3                -8.920770e-02 1 1  ON 13
 ud_4                -1.214515e-01 1 1  ON 14
 ud_5                -1.322536e-01 1 1  ON 15
 ud_6                -1.246862e-01 1 1  ON 16
 ud_7                -9.439287e-02 1 1  ON 17
 ud_8                -4.483337e-02 1 1  ON 18
 ud_9                 2.493396e-02 1 1  ON 19
 eC_0                -4.408431e-01 1 1  ON 20
 eC_1                -2.798300e-01 1 1  ON 21
 eC_2                -7.654157e-03 1 1  ON 22
 eC_3                 1.693869e-01 1 1  ON 23
 eC_4                 2.432368e-01 1 1  ON 24
 eC_5                 2.344395e-01 1 1  ON 25
 eC_6                 6.312626e-02 1 1  ON 26
 eC_7                 1.203343e-02 1 1  ON 27
 eC_8                 3.473439e-03 1 1  ON 28
 eC_9                 1.927377e-03 1 1  ON 29
 eO_0                -8.299692e-01 1 1  ON 30
 eO_1                -4.610808e-01 1 1  ON 31
 eO_2                -9.415044e-03 1 1  ON 32
 eO_3                 2.428374e-01 1 1  ON 33
 eO_4                 3.625309e-01 1 1  ON 34
 eO_5                 3.703920e-01 1 1  ON 35
 eO_6                 2.401609e-01 1 1  ON 36
 eO_7                 7.108864e-02 1 1  ON 37
 eO_8                -1.172355e-03 1 1  ON 38
 eO_9                 7.338775e-03 1 1  ON 39
eH1_0                -1.164217e-01 1 1  ON 40
eH1_1                -1.767795e-02 1 1  ON 41
eH1_2                 2.459431e-03 1 1  ON 42
eH1_3                -7.148826e-03 1 1  ON 43
eH1_4                 1.698684e-02 1 1  ON 44
eH1_5                 1.017942e-02 1 1  ON 45
eH1_6                 2.296408e-02 1 1  ON 46
eH1_7                 5.245835e-02 1 1  ON 47
eH1_8                 2.415652e-02 1 1  ON 48
eH1_9                 8.232288e-03 1 1  ON 49
eH2_0                -1.185348e-01 1 1  ON 50
eH2_1                -1.953994e-02 1 1  ON 51
eH2_2                 8.826395e-05 1 1  ON 52
eH2_3                -7.858729e-03 1 1  ON 53
eH2_4                 1.657711e-02 1 1  ON 54
eH2_5                 8.399757e-03 1 1  ON 55
eH2_6                 2.277822e-02 1 1  ON 56
eH2_7                 5.701172e-02 1 1  ON 57
eH2_8                 3.060943e-02 1 1  ON 58
eH2_9                 8.825011e-03 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 11
    time step          = 0.05
    reference energy   = -22.5285
    reference variance = 0.736505
====================================================
  Execution time = 4.8444e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORMP2PJWARM.s011
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2422e+01
  VMC Evar = 5.9095e-01
  Total weights = 2.0000e+06
  Execution time = 4.5204e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.591105973532
                                         uncertainty =       0.011872253604

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.591105973532
                                         uncertainty =       0.011872253604

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000543576087
  error estimate for blocks of size 2^( 2) =       0.000565260526
  error estimate for blocks of size 2^( 3) =       0.000586386454
  error estimate for blocks of size 2^( 4) =       0.000601599888
  error estimate for blocks of size 2^( 5) =       0.000611656648
  error estimate for blocks of size 2^( 6) =       0.000617383973
  error estimate for blocks of size 2^( 7) =       0.000617981048

      target function =                  N/A
              le_mean =     -22.422310453277
             les_mean =     503.350955692675
             stat err =       0.000612155389
             autocorr =       1.268243567478
              std dev =       0.768732674605
             le_variance =       0.590949925005

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.591107734870
                                         uncertainty =       0.011874030391

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.591107734870
                                         uncertainty =       0.011874030391

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000543576905
  error estimate for blocks of size 2^( 2) =       0.000565258519
  error estimate for blocks of size 2^( 3) =       0.000586381051
  error estimate for blocks of size 2^( 4) =       0.000601591868
  error estimate for blocks of size 2^( 5) =       0.000611646844
  error estimate for blocks of size 2^( 6) =       0.000617374617
  error estimate for blocks of size 2^( 7) =       0.000617969741

      target function =                  N/A
              le_mean =     -22.422310826614
             les_mean =     503.350974212520
             stat err =       0.000612145768
             autocorr =       1.268199885214
              std dev =       0.768733830859
             le_variance =       0.590951702708

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.591107664049
                                         uncertainty =       0.011873164518

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.591107664049
                                         uncertainty =       0.011873164518

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000543576868
  error estimate for blocks of size 2^( 2) =       0.000565259877
  error estimate for blocks of size 2^( 3) =       0.000586384080
  error estimate for blocks of size 2^( 4) =       0.000601596180
  error estimate for blocks of size 2^( 5) =       0.000611652033
  error estimate for blocks of size 2^( 6) =       0.000617379590
  error estimate for blocks of size 2^( 7) =       0.000617975658

      target function =                  N/A
              le_mean =     -22.422310643036
             les_mean =     503.350965901118
             stat err =       0.000612150865
             autocorr =       1.268221175794
              std dev =       0.768733779542
             le_variance =       0.590951623809

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.591106214031
                                         uncertainty =       0.011872368916

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.591106214031
                                         uncertainty =       0.011872368916

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000543576198
  error estimate for blocks of size 2^( 2) =       0.000565260458
  error estimate for blocks of size 2^( 3) =       0.000586386169
  error estimate for blocks of size 2^( 4) =       0.000601599435
  error estimate for blocks of size 2^( 5) =       0.000611656082
  error estimate for blocks of size 2^( 6) =       0.000617383436
  error estimate for blocks of size 2^( 7) =       0.000617980384

      target function =                  N/A
              le_mean =     -22.422310476613
             les_mean =     503.350956980669
             stat err =       0.000612154834
             autocorr =       1.268240750265
              std dev =       0.768732831702
             le_variance =       0.590950166536


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.422310453277        initial
     9.7656e+00     9.7656e+01             2.2552e-04       -22.422310826614  <--
     3.9062e+01     3.9062e+02             5.6268e-05       -22.422310643036
     1.5625e+02     1.5625e+03             1.4065e-05       -22.422310476613

*****************************************************************************
Applying the update for shift_i =   9.7656e+00     and shift_s =   9.7656e+01
*****************************************************************************

  Execution time = 7.1327e+01
  </log>
  <optVariables href="FORMP2PJWARM.s011.opt.xml">
 uu_0                 2.638265e-01 1 1  ON 0
 uu_1                 9.183242e-02 1 1  ON 1
 uu_2                -1.754596e-02 1 1  ON 2
 uu_3                -7.729142e-02 1 1  ON 3
 uu_4                -1.044009e-01 1 1  ON 4
 uu_5                -1.106445e-01 1 1  ON 5
 uu_6                -9.922303e-02 1 1  ON 6
 uu_7                -6.665996e-02 1 1  ON 7
 uu_8                -1.406316e-02 1 1  ON 8
 uu_9                 4.648323e-02 1 1  ON 9
 ud_0                 4.010894e-01 1 1  ON 10
 ud_1                 1.218467e-01 1 1  ON 11
 ud_2                -1.883826e-02 1 1  ON 12
 ud_3                -8.919743e-02 1 1  ON 13
 ud_4                -1.214363e-01 1 1  ON 14
 ud_5                -1.322474e-01 1 1  ON 15
 ud_6                -1.247027e-01 1 1  ON 16
 ud_7                -9.444243e-02 1 1  ON 17
 ud_8                -4.491837e-02 1 1  ON 18
 ud_9                 2.489379e-02 1 1  ON 19
 eC_0                -4.408304e-01 1 1  ON 20
 eC_1                -2.798940e-01 1 1  ON 21
 eC_2                -7.727749e-03 1 1  ON 22
 eC_3                 1.692793e-01 1 1  ON 23
 eC_4                 2.431832e-01 1 1  ON 24
 eC_5                 2.345477e-01 1 1  ON 25
 eC_6                 6.325974e-02 1 1  ON 26
 eC_7                 1.206809e-02 1 1  ON 27
 eC_8                 3.479531e-03 1 1  ON 28
 eC_9                 1.930283e-03 1 1  ON 29
 eO_0                -8.300177e-01 1 1  ON 30
 eO_1                -4.611745e-01 1 1  ON 31
 eO_2                -9.526278e-03 1 1  ON 32
 eO_3                 2.427401e-01 1 1  ON 33
 eO_4                 3.624869e-01 1 1  ON 34
 eO_5                 3.704126e-01 1 1  ON 35
 eO_6                 2.403150e-01 1 1  ON 36
 eO_7                 7.125789e-02 1 1  ON 37
 eO_8                -1.139576e-03 1 1  ON 38
 eO_9                 7.347719e-03 1 1  ON 39
eH1_0                -1.164266e-01 1 1  ON 40
eH1_1                -1.770073e-02 1 1  ON 41
eH1_2                 2.429440e-03 1 1  ON 42
eH1_3                -7.152579e-03 1 1  ON 43
eH1_4                 1.698730e-02 1 1  ON 44
eH1_5                 1.017708e-02 1 1  ON 45
eH1_6                 2.296792e-02 1 1  ON 46
eH1_7                 5.244874e-02 1 1  ON 47
eH1_8                 2.420275e-02 1 1  ON 48
eH1_9                 8.249225e-03 1 1  ON 49
eH2_0                -1.185416e-01 1 1  ON 50
eH2_1                -1.956033e-02 1 1  ON 51
eH2_2                 7.941136e-05 1 1  ON 52
eH2_3                -7.861642e-03 1 1  ON 53
eH2_4                 1.656197e-02 1 1  ON 54
eH2_5                 8.426502e-03 1 1  ON 55
eH2_6                 2.276952e-02 1 1  ON 56
eH2_7                 5.698632e-02 1 1  ON 57
eH2_8                 3.065230e-02 1 1  ON 58
eH2_9                 8.840856e-03 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.3670e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORMP2PJWARM.s012 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORMP2PJWARM.s012 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=12  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2375e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 30888 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 12
    time step          = 0.05
    reference energy   = -22.5778
    reference variance = 0.837091
====================================================
  Execution time = 5.0510e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORMP2PJWARM.s012
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2422e+01
  VMC Evar = 5.7773e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.5830e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.577788639825
                                         uncertainty =       0.005594319173

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.577788639825
                                         uncertainty =       0.005594319173

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000537462991
  error estimate for blocks of size 2^( 2) =       0.000559504978
  error estimate for blocks of size 2^( 3) =       0.000580661183
  error estimate for blocks of size 2^( 4) =       0.000596389138
  error estimate for blocks of size 2^( 5) =       0.000606171385
  error estimate for blocks of size 2^( 6) =       0.000609337187
  error estimate for blocks of size 2^( 7) =       0.000611052398

      target function =                  N/A
              le_mean =     -22.422025722157
             les_mean =     503.324970129829
             stat err =       0.000605737527
             autocorr =       1.270199188109
              std dev =       0.760087451291
             le_variance =       0.577732933610


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.242202572216e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.4414e+00, overlap shift 2.4414e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.422025722157       residual = 8.54e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.422028179928       residual = 1.98e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.422032590643       residual = 1.94e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.422036469974       residual = 1.05e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.422039366769       residual = 9.87e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.422042554549       residual = 1.32e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.422042697585       residual = 5.68e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.422043064639       residual = 1.75e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.422042913221       residual = 3.62e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.422042858561       residual = 2.69e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -22.422042960153       residual = 6.04e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -22.422043003493       residual = 1.65e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -22.422043000029       residual = 5.18e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         12 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 2.4414e+00 is 9.278877e-04

solving harmonic davidson linear method for identity shift 9.7656e+00, overlap shift 9.7656e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.422025722157       residual = 8.54e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.422026369954       residual = 2.03e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.422027528458       residual = 1.87e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.422028533934       residual = 1.02e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.422029247420       residual = 9.24e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.422030058539       residual = 9.92e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.422030088977       residual = 4.47e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.422030174218       residual = 1.26e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.422030143687       residual = 3.83e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.422030121210       residual = 1.53e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -22.422030133756       residual = 4.77e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -22.422030151328       residual = 1.45e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -22.422030147433       residual = 5.49e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         12 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 9.7656e+00 is 2.315743e-04

solving harmonic davidson linear method for identity shift 3.9062e+01, overlap shift 3.9062e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.422025722157       residual = 8.54e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.422025886335       residual = 2.05e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.422026179864       residual = 1.85e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.422026433569       residual = 1.01e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.422026611209       residual = 9.07e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.422026814912       residual = 9.20e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.422026822542       residual = 4.15e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.422026843315       residual = 1.15e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.422026836323       residual = 3.91e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.422026830224       residual = 1.31e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -22.422026832547       residual = 4.58e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -22.422026837089       residual = 1.31e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -22.422026836165       residual = 5.14e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         12 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 3.9062e+01 is 5.786984e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.168165 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 6.6349e+01
  </log>
  <optVariables href="FORMP2PJWARM.s012.opt.xml">
 uu_0                 2.638348e-01 1 1  ON 0
 uu_1                 9.184122e-02 1 1  ON 1
 uu_2                -1.752749e-02 1 1  ON 2
 uu_3                -7.727000e-02 1 1  ON 3
 uu_4                -1.043860e-01 1 1  ON 4
 uu_5                -1.106324e-01 1 1  ON 5
 uu_6                -9.925536e-02 1 1  ON 6
 uu_7                -6.671044e-02 1 1  ON 7
 uu_8                -1.417348e-02 1 1  ON 8
 uu_9                 4.646241e-02 1 1  ON 9
 ud_0                 4.011397e-01 1 1  ON 10
 ud_1                 1.218468e-01 1 1  ON 11
 ud_2                -1.879767e-02 1 1  ON 12
 ud_3                -8.918072e-02 1 1  ON 13
 ud_4                -1.214161e-01 1 1  ON 14
 ud_5                -1.322339e-01 1 1  ON 15
 ud_6                -1.247218e-01 1 1  ON 16
 ud_7                -9.451270e-02 1 1  ON 17
 ud_8                -4.501590e-02 1 1  ON 18
 ud_9                 2.483448e-02 1 1  ON 19
 eC_0                -4.408093e-01 1 1  ON 20
 eC_1                -2.799727e-01 1 1  ON 21
 eC_2                -7.835562e-03 1 1  ON 22
 eC_3                 1.691372e-01 1 1  ON 23
 eC_4                 2.431061e-01 1 1  ON 24
 eC_5                 2.346918e-01 1 1  ON 25
 eC_6                 6.344685e-02 1 1  ON 26
 eC_7                 1.211188e-02 1 1  ON 27
 eC_8                 3.486469e-03 1 1  ON 28
 eC_9                 1.932804e-03 1 1  ON 29
 eO_0                -8.300679e-01 1 1  ON 30
 eO_1                -4.612864e-01 1 1  ON 31
 eO_2                -9.687552e-03 1 1  ON 32
 eO_3                 2.425987e-01 1 1  ON 33
 eO_4                 3.624348e-01 1 1  ON 34
 eO_5                 3.704318e-01 1 1  ON 35
 eO_6                 2.405114e-01 1 1  ON 36
 eO_7                 7.148946e-02 1 1  ON 37
 eO_8                -1.092709e-03 1 1  ON 38
 eO_9                 7.358469e-03 1 1  ON 39
eH1_0                -1.164437e-01 1 1  ON 40
eH1_1                -1.773791e-02 1 1  ON 41
eH1_2                 2.387605e-03 1 1  ON 42
eH1_3                -7.153947e-03 1 1  ON 43
eH1_4                 1.698366e-02 1 1  ON 44
eH1_5                 1.020322e-02 1 1  ON 45
eH1_6                 2.296995e-02 1 1  ON 46
eH1_7                 5.243746e-02 1 1  ON 47
eH1_8                 2.426582e-02 1 1  ON 48
eH1_9                 8.267332e-03 1 1  ON 49
eH2_0                -1.185479e-01 1 1  ON 50
eH2_1                -1.958014e-02 1 1  ON 51
eH2_2                 5.625100e-05 1 1  ON 52
eH2_3                -7.864514e-03 1 1  ON 53
eH2_4                 1.654503e-02 1 1  ON 54
eH2_5                 8.463834e-03 1 1  ON 55
eH2_6                 2.275530e-02 1 1  ON 56
eH2_7                 5.695168e-02 1 1  ON 57
eH2_8                 3.070903e-02 1 1  ON 58
eH2_9                 8.861639e-03 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 12
    time step          = 0.05
    reference energy   = -22.339
    reference variance = 0.605194
====================================================
  Execution time = 4.8025e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORMP2PJWARM.s012
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2422e+01
  VMC Evar = 5.7134e-01
  Total weights = 2.0000e+06
  Execution time = 4.5198e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.571467731214
                                         uncertainty =       0.003988791096

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.571467731214
                                         uncertainty =       0.003988791096

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000534489760
  error estimate for blocks of size 2^( 2) =       0.000556125196
  error estimate for blocks of size 2^( 3) =       0.000577195279
  error estimate for blocks of size 2^( 4) =       0.000594245581
  error estimate for blocks of size 2^( 5) =       0.000606083533
  error estimate for blocks of size 2^( 6) =       0.000614476121
  error estimate for blocks of size 2^( 7) =       0.000616689928

      target function =                  N/A
              le_mean =     -22.421771577340
             les_mean =     503.307198988021
             stat err =       0.000607873791
             autocorr =       1.293445274691
              std dev =       0.755882667675
             le_variance =       0.571358607292

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.571395512920
                                         uncertainty =       0.003989557100

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.571395512920
                                         uncertainty =       0.003989557100

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000534455951
  error estimate for blocks of size 2^( 2) =       0.000556081817
  error estimate for blocks of size 2^( 3) =       0.000577142589
  error estimate for blocks of size 2^( 4) =       0.000594183774
  error estimate for blocks of size 2^( 5) =       0.000606015622
  error estimate for blocks of size 2^( 6) =       0.000614404742
  error estimate for blocks of size 2^( 7) =       0.000616622696

      target function =                  N/A
              le_mean =     -22.421770432724
             les_mean =     503.307075378662
             stat err =       0.000607806709
             autocorr =       1.293323427644
              std dev =       0.755834854004
             le_variance =       0.571286326527

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.571439267789
                                         uncertainty =       0.003989320084

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.571439267789
                                         uncertainty =       0.003989320084

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000534476428
  error estimate for blocks of size 2^( 2) =       0.000556106845
  error estimate for blocks of size 2^( 3) =       0.000577172109
  error estimate for blocks of size 2^( 4) =       0.000594217706
  error estimate for blocks of size 2^( 5) =       0.000606052484
  error estimate for blocks of size 2^( 6) =       0.000614443216
  error estimate for blocks of size 2^( 7) =       0.000616659142

      target function =                  N/A
              le_mean =     -22.421770921796
             les_mean =     503.307141088122
             stat err =       0.000607843137
             autocorr =       1.293379349651
              std dev =       0.755863813322
             le_variance =       0.571330104290

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.571464456880
                                         uncertainty =       0.003988863513

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.571464456880
                                         uncertainty =       0.003988863513

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000534488226
  error estimate for blocks of size 2^( 2) =       0.000556123024
  error estimate for blocks of size 2^( 3) =       0.000577192497
  error estimate for blocks of size 2^( 4) =       0.000594242205
  error estimate for blocks of size 2^( 5) =       0.000606079755
  error estimate for blocks of size 2^( 6) =       0.000614472107
  error estimate for blocks of size 2^( 7) =       0.000616686181

      target function =                  N/A
              le_mean =     -22.421771485607
             les_mean =     503.307191594724
             stat err =       0.000607870062
             autocorr =       1.293436831552
              std dev =       0.755880498244
             le_variance =       0.571355327625


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.421771577340        initial  <--
     2.4414e+00     2.4414e+01             9.2789e-04       -22.421770432724
     9.7656e+00     9.7656e+01             2.3157e-04       -22.421770921796
     3.9062e+01     3.9062e+02             5.7870e-05       -22.421771485607

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 70.5990
  </log>
  <optVariables href="FORMP2PJWARM.s012.opt.xml">
 uu_0                 2.638265e-01 1 1  ON 0
 uu_1                 9.183242e-02 1 1  ON 1
 uu_2                -1.754596e-02 1 1  ON 2
 uu_3                -7.729142e-02 1 1  ON 3
 uu_4                -1.044009e-01 1 1  ON 4
 uu_5                -1.106445e-01 1 1  ON 5
 uu_6                -9.922303e-02 1 1  ON 6
 uu_7                -6.665996e-02 1 1  ON 7
 uu_8                -1.406316e-02 1 1  ON 8
 uu_9                 4.648323e-02 1 1  ON 9
 ud_0                 4.010894e-01 1 1  ON 10
 ud_1                 1.218467e-01 1 1  ON 11
 ud_2                -1.883826e-02 1 1  ON 12
 ud_3                -8.919743e-02 1 1  ON 13
 ud_4                -1.214363e-01 1 1  ON 14
 ud_5                -1.322474e-01 1 1  ON 15
 ud_6                -1.247027e-01 1 1  ON 16
 ud_7                -9.444243e-02 1 1  ON 17
 ud_8                -4.491837e-02 1 1  ON 18
 ud_9                 2.489379e-02 1 1  ON 19
 eC_0                -4.408304e-01 1 1  ON 20
 eC_1                -2.798940e-01 1 1  ON 21
 eC_2                -7.727749e-03 1 1  ON 22
 eC_3                 1.692793e-01 1 1  ON 23
 eC_4                 2.431832e-01 1 1  ON 24
 eC_5                 2.345477e-01 1 1  ON 25
 eC_6                 6.325974e-02 1 1  ON 26
 eC_7                 1.206809e-02 1 1  ON 27
 eC_8                 3.479531e-03 1 1  ON 28
 eC_9                 1.930283e-03 1 1  ON 29
 eO_0                -8.300177e-01 1 1  ON 30
 eO_1                -4.611745e-01 1 1  ON 31
 eO_2                -9.526278e-03 1 1  ON 32
 eO_3                 2.427401e-01 1 1  ON 33
 eO_4                 3.624869e-01 1 1  ON 34
 eO_5                 3.704126e-01 1 1  ON 35
 eO_6                 2.403150e-01 1 1  ON 36
 eO_7                 7.125789e-02 1 1  ON 37
 eO_8                -1.139576e-03 1 1  ON 38
 eO_9                 7.347719e-03 1 1  ON 39
eH1_0                -1.164266e-01 1 1  ON 40
eH1_1                -1.770073e-02 1 1  ON 41
eH1_2                 2.429440e-03 1 1  ON 42
eH1_3                -7.152579e-03 1 1  ON 43
eH1_4                 1.698730e-02 1 1  ON 44
eH1_5                 1.017708e-02 1 1  ON 45
eH1_6                 2.296792e-02 1 1  ON 46
eH1_7                 5.244874e-02 1 1  ON 47
eH1_8                 2.420275e-02 1 1  ON 48
eH1_9                 8.249225e-03 1 1  ON 49
eH2_0                -1.185416e-01 1 1  ON 50
eH2_1                -1.956033e-02 1 1  ON 51
eH2_2                 7.941136e-05 1 1  ON 52
eH2_3                -7.861642e-03 1 1  ON 53
eH2_4                 1.656197e-02 1 1  ON 54
eH2_5                 8.426502e-03 1 1  ON 55
eH2_6                 2.276952e-02 1 1  ON 56
eH2_7                 5.698632e-02 1 1  ON 57
eH2_8                 3.065230e-02 1 1  ON 58
eH2_9                 8.840856e-03 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.3695e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORMP2PJWARM.s013 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORMP2PJWARM.s013 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=13  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2382e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 30888 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 13
    time step          = 0.05
    reference energy   = -22.4769
    reference variance = 0.434609
====================================================
  Execution time = 4.8756e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORMP2PJWARM.s013
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2422e+01
  VMC Evar = 5.7449e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.5847e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.574453467631
                                         uncertainty =       0.004202732207

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.574453467631
                                         uncertainty =       0.004202732207

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000535951160
  error estimate for blocks of size 2^( 2) =       0.000557862729
  error estimate for blocks of size 2^( 3) =       0.000578394080
  error estimate for blocks of size 2^( 4) =       0.000595555796
  error estimate for blocks of size 2^( 5) =       0.000605896266
  error estimate for blocks of size 2^( 6) =       0.000612567580
  error estimate for blocks of size 2^( 7) =       0.000614996501

      target function =                  N/A
              le_mean =     -22.422046849969
             les_mean =     503.322671945727
             stat err =       0.000607254036
             autocorr =       1.283779362007
              std dev =       0.757949398556
             le_variance =       0.574487290771


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.242204684997e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.4414e+01, overlap shift 2.4414e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.422046849969       residual = 7.39e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.422047395195       residual = 1.68e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.422047884863       residual = 3.26e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.422048201749       residual = 9.91e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.422048235528       residual = 7.62e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.422048441057       residual = 9.21e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.422048597965       residual = 3.40e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.422048626276       residual = 1.10e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.422048623330       residual = 4.36e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.422048621919       residual = 1.41e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -22.422048622405       residual = 3.13e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -22.422048619210       residual = 1.08e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -22.422048617555       residual = 5.63e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         12 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 2.4414e+01 is 9.333098e-05

solving harmonic davidson linear method for identity shift 9.7656e+01, overlap shift 9.7656e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.422046849969       residual = 7.39e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.422046987259       residual = 1.69e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.422047109904       residual = 3.25e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.422047189712       residual = 9.85e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.422047197917       residual = 7.57e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.422047249096       residual = 9.05e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.422047288044       residual = 3.32e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.422047294994       residual = 1.06e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.422047294043       residual = 4.20e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.422047293888       residual = 1.34e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -22.422047293951       residual = 3.05e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -22.422047293236       residual = 9.81e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 9.7656e+01 is 2.330082e-05

solving harmonic davidson linear method for identity shift 3.9062e+02, overlap shift 3.9062e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.422046849969       residual = 7.39e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.422046884353       residual = 1.69e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.422046915029       residual = 3.25e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.422046935019       residual = 9.83e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.422046937054       residual = 7.55e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.422046949837       residual = 9.01e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.422046959555       residual = 3.30e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.422046961285       residual = 1.05e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.422046961034       residual = 4.17e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.422046961009       residual = 1.33e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -22.422046961018       residual = 3.03e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -22.422046960845       residual = 9.57e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 3.9062e+02 is 5.824939e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.173525 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 6.4612e+01
  </log>
  <optVariables href="FORMP2PJWARM.s013.opt.xml">
 uu_0                 2.638271e-01 1 1  ON 0
 uu_1                 9.183414e-02 1 1  ON 1
 uu_2                -1.754397e-02 1 1  ON 2
 uu_3                -7.728866e-02 1 1  ON 3
 uu_4                -1.043984e-01 1 1  ON 4
 uu_5                -1.106446e-01 1 1  ON 5
 uu_6                -9.922525e-02 1 1  ON 6
 uu_7                -6.666532e-02 1 1  ON 7
 uu_8                -1.407449e-02 1 1  ON 8
 uu_9                 4.648087e-02 1 1  ON 9
 ud_0                 4.010930e-01 1 1  ON 10
 ud_1                 1.218466e-01 1 1  ON 11
 ud_2                -1.883502e-02 1 1  ON 12
 ud_3                -8.919571e-02 1 1  ON 13
 ud_4                -1.214342e-01 1 1  ON 14
 ud_5                -1.322469e-01 1 1  ON 15
 ud_6                -1.247042e-01 1 1  ON 16
 ud_7                -9.444924e-02 1 1  ON 17
 ud_8                -4.492735e-02 1 1  ON 18
 ud_9                 2.488922e-02 1 1  ON 19
 eC_0                -4.408286e-01 1 1  ON 20
 eC_1                -2.799021e-01 1 1  ON 21
 eC_2                -7.738997e-03 1 1  ON 22
 eC_3                 1.692658e-01 1 1  ON 23
 eC_4                 2.431749e-01 1 1  ON 24
 eC_5                 2.345632e-01 1 1  ON 25
 eC_6                 6.327816e-02 1 1  ON 26
 eC_7                 1.207279e-02 1 1  ON 27
 eC_8                 3.479852e-03 1 1  ON 28
 eC_9                 1.930571e-03 1 1  ON 29
 eO_0                -8.300223e-01 1 1  ON 30
 eO_1                -4.611849e-01 1 1  ON 31
 eO_2                -9.542192e-03 1 1  ON 32
 eO_3                 2.427239e-01 1 1  ON 33
 eO_4                 3.624805e-01 1 1  ON 34
 eO_5                 3.704154e-01 1 1  ON 35
 eO_6                 2.403358e-01 1 1  ON 36
 eO_7                 7.128119e-02 1 1  ON 37
 eO_8                -1.135079e-03 1 1  ON 38
 eO_9                 7.348843e-03 1 1  ON 39
eH1_0                -1.164263e-01 1 1  ON 40
eH1_1                -1.770379e-02 1 1  ON 41
eH1_2                 2.425337e-03 1 1  ON 42
eH1_3                -7.153785e-03 1 1  ON 43
eH1_4                 1.698635e-02 1 1  ON 44
eH1_5                 1.017778e-02 1 1  ON 45
eH1_6                 2.296796e-02 1 1  ON 46
eH1_7                 5.244813e-02 1 1  ON 47
eH1_8                 2.420945e-02 1 1  ON 48
eH1_9                 8.251129e-03 1 1  ON 49
eH2_0                -1.185429e-01 1 1  ON 50
eH2_1                -1.956380e-02 1 1  ON 51
eH2_2                 7.753638e-05 1 1  ON 52
eH2_3                -7.862154e-03 1 1  ON 53
eH2_4                 1.656059e-02 1 1  ON 54
eH2_5                 8.430210e-03 1 1  ON 55
eH2_6                 2.277031e-02 1 1  ON 56
eH2_7                 5.698197e-02 1 1  ON 57
eH2_8                 3.065803e-02 1 1  ON 58
eH2_9                 8.842897e-03 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 13
    time step          = 0.05
    reference energy   = -22.4951
    reference variance = 0.568842
====================================================
  Execution time = 4.9801e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORMP2PJWARM.s013
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2422e+01
  VMC Evar = 5.7455e-01
  Total weights = 2.0000e+06
  Execution time = 4.5213e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.574481050228
                                         uncertainty =       0.004326428991

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.574481050228
                                         uncertainty =       0.004326428991

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000535979284
  error estimate for blocks of size 2^( 2) =       0.000558404635
  error estimate for blocks of size 2^( 3) =       0.000580185763
  error estimate for blocks of size 2^( 4) =       0.000596867006
  error estimate for blocks of size 2^( 5) =       0.000606523195
  error estimate for blocks of size 2^( 6) =       0.000615226652
  error estimate for blocks of size 2^( 7) =       0.000620182232

      target function =                  N/A
              le_mean =     -22.421706156797
             les_mean =     503.307454280084
             stat err =       0.000609699771
             autocorr =       1.294005301738
              std dev =       0.757989172491
             le_variance =       0.574547585614

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.574471916277
                                         uncertainty =       0.004326480181

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.574471916277
                                         uncertainty =       0.004326480181

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000535975024
  error estimate for blocks of size 2^( 2) =       0.000558399494
  error estimate for blocks of size 2^( 3) =       0.000580179718
  error estimate for blocks of size 2^( 4) =       0.000596859894
  error estimate for blocks of size 2^( 5) =       0.000606515873
  error estimate for blocks of size 2^( 6) =       0.000615219007
  error estimate for blocks of size 2^( 7) =       0.000620174477

      target function =                  N/A
              le_mean =     -22.421706063287
             les_mean =     503.307440954677
             stat err =       0.000609692313
             autocorr =       1.293994210947
              std dev =       0.757983148569
             le_variance =       0.574538453514

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.574476622198
                                         uncertainty =       0.004326457207

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.574476622198
                                         uncertainty =       0.004326457207

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000535977219
  error estimate for blocks of size 2^( 2) =       0.000558402124
  error estimate for blocks of size 2^( 3) =       0.000580182795
  error estimate for blocks of size 2^( 4) =       0.000596863500
  error estimate for blocks of size 2^( 5) =       0.000606519581
  error estimate for blocks of size 2^( 6) =       0.000615222873
  error estimate for blocks of size 2^( 7) =       0.000620178397

      target function =                  N/A
              le_mean =     -22.421706108013
             les_mean =     503.307447665332
             stat err =       0.000609696088
             autocorr =       1.293999637329
              std dev =       0.757986252191
             le_variance =       0.574543158510

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.574480499490
                                         uncertainty =       0.004326432569

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.574480499490
                                         uncertainty =       0.004326432569

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000535979027
  error estimate for blocks of size 2^( 2) =       0.000558404323
  error estimate for blocks of size 2^( 3) =       0.000580185393
  error estimate for blocks of size 2^( 4) =       0.000596866569
  error estimate for blocks of size 2^( 5) =       0.000606522744
  error estimate for blocks of size 2^( 6) =       0.000615226180
  error estimate for blocks of size 2^( 7) =       0.000620181753

      target function =                  N/A
              le_mean =     -22.421706150585
             les_mean =     503.307453450903
             stat err =       0.000609699312
             autocorr =       1.294004591874
              std dev =       0.757988809279
             le_variance =       0.574547034992


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.421706156797        initial  <--
     2.4414e+01     2.4414e+02             9.3331e-05       -22.421706063287
     9.7656e+01     9.7656e+02             2.3301e-05       -22.421706108013
     3.9062e+02     3.9062e+03             5.8249e-06       -22.421706150585

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 72.3367
  </log>
  <optVariables href="FORMP2PJWARM.s013.opt.xml">
 uu_0                 2.638265e-01 1 1  ON 0
 uu_1                 9.183242e-02 1 1  ON 1
 uu_2                -1.754596e-02 1 1  ON 2
 uu_3                -7.729142e-02 1 1  ON 3
 uu_4                -1.044009e-01 1 1  ON 4
 uu_5                -1.106445e-01 1 1  ON 5
 uu_6                -9.922303e-02 1 1  ON 6
 uu_7                -6.665996e-02 1 1  ON 7
 uu_8                -1.406316e-02 1 1  ON 8
 uu_9                 4.648323e-02 1 1  ON 9
 ud_0                 4.010894e-01 1 1  ON 10
 ud_1                 1.218467e-01 1 1  ON 11
 ud_2                -1.883826e-02 1 1  ON 12
 ud_3                -8.919743e-02 1 1  ON 13
 ud_4                -1.214363e-01 1 1  ON 14
 ud_5                -1.322474e-01 1 1  ON 15
 ud_6                -1.247027e-01 1 1  ON 16
 ud_7                -9.444243e-02 1 1  ON 17
 ud_8                -4.491837e-02 1 1  ON 18
 ud_9                 2.489379e-02 1 1  ON 19
 eC_0                -4.408304e-01 1 1  ON 20
 eC_1                -2.798940e-01 1 1  ON 21
 eC_2                -7.727749e-03 1 1  ON 22
 eC_3                 1.692793e-01 1 1  ON 23
 eC_4                 2.431832e-01 1 1  ON 24
 eC_5                 2.345477e-01 1 1  ON 25
 eC_6                 6.325974e-02 1 1  ON 26
 eC_7                 1.206809e-02 1 1  ON 27
 eC_8                 3.479531e-03 1 1  ON 28
 eC_9                 1.930283e-03 1 1  ON 29
 eO_0                -8.300177e-01 1 1  ON 30
 eO_1                -4.611745e-01 1 1  ON 31
 eO_2                -9.526278e-03 1 1  ON 32
 eO_3                 2.427401e-01 1 1  ON 33
 eO_4                 3.624869e-01 1 1  ON 34
 eO_5                 3.704126e-01 1 1  ON 35
 eO_6                 2.403150e-01 1 1  ON 36
 eO_7                 7.125789e-02 1 1  ON 37
 eO_8                -1.139576e-03 1 1  ON 38
 eO_9                 7.347719e-03 1 1  ON 39
eH1_0                -1.164266e-01 1 1  ON 40
eH1_1                -1.770073e-02 1 1  ON 41
eH1_2                 2.429440e-03 1 1  ON 42
eH1_3                -7.152579e-03 1 1  ON 43
eH1_4                 1.698730e-02 1 1  ON 44
eH1_5                 1.017708e-02 1 1  ON 45
eH1_6                 2.296792e-02 1 1  ON 46
eH1_7                 5.244874e-02 1 1  ON 47
eH1_8                 2.420275e-02 1 1  ON 48
eH1_9                 8.249225e-03 1 1  ON 49
eH2_0                -1.185416e-01 1 1  ON 50
eH2_1                -1.956033e-02 1 1  ON 51
eH2_2                 7.941136e-05 1 1  ON 52
eH2_3                -7.861642e-03 1 1  ON 53
eH2_4                 1.656197e-02 1 1  ON 54
eH2_5                 8.426502e-03 1 1  ON 55
eH2_6                 2.276952e-02 1 1  ON 56
eH2_7                 5.698632e-02 1 1  ON 57
eH2_8                 3.065230e-02 1 1  ON 58
eH2_9                 8.840856e-03 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.3696e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORMP2PJWARM.s014 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORMP2PJWARM.s014 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=14  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2389e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 30888 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 14
    time step          = 0.05
    reference energy   = -22.4397
    reference variance = 0.458578
====================================================
  Execution time = 5.1262e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORMP2PJWARM.s014
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2422e+01
  VMC Evar = 5.7359e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.5960e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.573198657747
                                         uncertainty =       0.004941243191

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.573198657747
                                         uncertainty =       0.004941243191

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000535533731
  error estimate for blocks of size 2^( 2) =       0.000557769034
  error estimate for blocks of size 2^( 3) =       0.000578952148
  error estimate for blocks of size 2^( 4) =       0.000595131878
  error estimate for blocks of size 2^( 5) =       0.000605458796
  error estimate for blocks of size 2^( 6) =       0.000612087599
  error estimate for blocks of size 2^( 7) =       0.000618575369

      target function =                  N/A
              le_mean =     -22.421886501741
             les_mean =     503.314586763226
             stat err =       0.000607813411
             autocorr =       1.288151358651
              std dev =       0.757359064810
             le_variance =       0.573592753050


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.242188650174e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.4414e+02, overlap shift 2.4414e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.421886501741       residual = 1.00e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.421886533805       residual = 2.71e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.421886563049       residual = 1.36e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.421886584977       residual = 8.94e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.421886633584       residual = 6.38e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.421886652650       residual = 2.40e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.421886659447       residual = 5.05e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.421886663413       residual = 1.06e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.421886662263       residual = 4.97e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.421886663236       residual = 1.49e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -22.421886663527       residual = 7.74e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -22.421886663882       residual = 1.68e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -22.421886664063       residual = 6.32e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         12 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 2.4414e+02 is 9.228240e-06

solving harmonic davidson linear method for identity shift 9.7656e+02, overlap shift 9.7656e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.421886501741       residual = 1.00e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.421886509763       residual = 2.72e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.421886517077       residual = 1.36e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.421886522560       residual = 8.94e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.421886534714       residual = 6.38e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.421886539477       residual = 2.40e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.421886541177       residual = 5.04e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.421886542166       residual = 1.05e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.421886541882       residual = 4.96e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.421886542124       residual = 1.48e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -22.421886542198       residual = 7.70e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -22.421886542285       residual = 1.67e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -22.421886542332       residual = 6.29e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         12 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 9.7656e+02 is 2.307008e-06

solving harmonic davidson linear method for identity shift 3.9062e+03, overlap shift 3.9062e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.421886501741       residual = 1.00e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.421886503747       residual = 2.72e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.421886505576       residual = 1.36e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.421886506947       residual = 8.94e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.421886509985       residual = 6.38e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.421886511172       residual = 2.40e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.421886511600       residual = 5.04e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.421886511844       residual = 1.05e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.421886511773       residual = 4.96e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.421886511832       residual = 1.48e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -22.421886511858       residual = 7.69e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -22.421886511869       residual = 1.67e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -22.421886511879       residual = 6.29e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         12 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 3.9062e+03 is 5.767488e-07

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.179385 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 6.7231e+01
  </log>
  <optVariables href="FORMP2PJWARM.s014.opt.xml">
 uu_0                 2.638265e-01 1 1  ON 0
 uu_1                 9.183254e-02 1 1  ON 1
 uu_2                -1.754571e-02 1 1  ON 2
 uu_3                -7.729122e-02 1 1  ON 3
 uu_4                -1.044007e-01 1 1  ON 4
 uu_5                -1.106445e-01 1 1  ON 5
 uu_6                -9.922329e-02 1 1  ON 6
 uu_7                -6.666047e-02 1 1  ON 7
 uu_8                -1.406416e-02 1 1  ON 8
 uu_9                 4.648300e-02 1 1  ON 9
 ud_0                 4.010897e-01 1 1  ON 10
 ud_1                 1.218468e-01 1 1  ON 11
 ud_2                -1.883801e-02 1 1  ON 12
 ud_3                -8.919728e-02 1 1  ON 13
 ud_4                -1.214360e-01 1 1  ON 14
 ud_5                -1.322472e-01 1 1  ON 15
 ud_6                -1.247028e-01 1 1  ON 16
 ud_7                -9.444315e-02 1 1  ON 17
 ud_8                -4.491935e-02 1 1  ON 18
 ud_9                 2.489326e-02 1 1  ON 19
 eC_0                -4.408301e-01 1 1  ON 20
 eC_1                -2.798947e-01 1 1  ON 21
 eC_2                -7.728823e-03 1 1  ON 22
 eC_3                 1.692778e-01 1 1  ON 23
 eC_4                 2.431823e-01 1 1  ON 24
 eC_5                 2.345492e-01 1 1  ON 25
 eC_6                 6.326162e-02 1 1  ON 26
 eC_7                 1.206862e-02 1 1  ON 27
 eC_8                 3.479595e-03 1 1  ON 28
 eC_9                 1.930316e-03 1 1  ON 29
 eO_0                -8.300183e-01 1 1  ON 30
 eO_1                -4.611755e-01 1 1  ON 31
 eO_2                -9.527966e-03 1 1  ON 32
 eO_3                 2.427387e-01 1 1  ON 33
 eO_4                 3.624864e-01 1 1  ON 34
 eO_5                 3.704129e-01 1 1  ON 35
 eO_6                 2.403171e-01 1 1  ON 36
 eO_7                 7.126020e-02 1 1  ON 37
 eO_8                -1.139158e-03 1 1  ON 38
 eO_9                 7.347820e-03 1 1  ON 39
eH1_0                -1.164268e-01 1 1  ON 40
eH1_1                -1.770111e-02 1 1  ON 41
eH1_2                 2.429167e-03 1 1  ON 42
eH1_3                -7.152651e-03 1 1  ON 43
eH1_4                 1.698719e-02 1 1  ON 44
eH1_5                 1.017713e-02 1 1  ON 45
eH1_6                 2.296805e-02 1 1  ON 46
eH1_7                 5.244861e-02 1 1  ON 47
eH1_8                 2.420342e-02 1 1  ON 48
eH1_9                 8.249457e-03 1 1  ON 49
eH2_0                -1.185417e-01 1 1  ON 50
eH2_1                -1.956065e-02 1 1  ON 51
eH2_2                 7.934245e-05 1 1  ON 52
eH2_3                -7.861825e-03 1 1  ON 53
eH2_4                 1.656168e-02 1 1  ON 54
eH2_5                 8.426921e-03 1 1  ON 55
eH2_6                 2.276945e-02 1 1  ON 56
eH2_7                 5.698589e-02 1 1  ON 57
eH2_8                 3.065294e-02 1 1  ON 58
eH2_9                 8.841103e-03 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 14
    time step          = 0.05
    reference energy   = -22.4479
    reference variance = 0.405152
====================================================
  Execution time = 4.9131e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORMP2PJWARM.s014
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2422e+01
  VMC Evar = 5.8474e-01
  Total weights = 2.0000e+06
  Execution time = 4.5356e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.584801208121
                                         uncertainty =       0.005916995142

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.584801208121
                                         uncertainty =       0.005916995142

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000540713015
  error estimate for blocks of size 2^( 2) =       0.000563037104
  error estimate for blocks of size 2^( 3) =       0.000584079196
  error estimate for blocks of size 2^( 4) =       0.000601054663
  error estimate for blocks of size 2^( 5) =       0.000611175246
  error estimate for blocks of size 2^( 6) =       0.000618028402
  error estimate for blocks of size 2^( 7) =       0.000620911374

      target function =                  N/A
              le_mean =     -22.422022741798
             les_mean =     503.331844670626
             stat err =       0.000612792421
             autocorr =       1.284378788170
              std dev =       0.764683679221
             le_variance =       0.584741129268

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.584800409872
                                         uncertainty =       0.005916983161

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.584800409872
                                         uncertainty =       0.005916983161

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000540712646
  error estimate for blocks of size 2^( 2) =       0.000563036622
  error estimate for blocks of size 2^( 3) =       0.000584078598
  error estimate for blocks of size 2^( 4) =       0.000601053945
  error estimate for blocks of size 2^( 5) =       0.000611174504
  error estimate for blocks of size 2^( 6) =       0.000618027652
  error estimate for blocks of size 2^( 7) =       0.000620910683

      target function =                  N/A
              le_mean =     -22.422022738697
             les_mean =     503.331843732825
             stat err =       0.000612791696
             autocorr =       1.284377502922
              std dev =       0.764683156953
             le_variance =       0.584740330528

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.584800809619
                                         uncertainty =       0.005916989152

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.584800809619
                                         uncertainty =       0.005916989152

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000540712831
  error estimate for blocks of size 2^( 2) =       0.000563036863
  error estimate for blocks of size 2^( 3) =       0.000584078897
  error estimate for blocks of size 2^( 4) =       0.000601054304
  error estimate for blocks of size 2^( 5) =       0.000611174875
  error estimate for blocks of size 2^( 6) =       0.000618028028
  error estimate for blocks of size 2^( 7) =       0.000620911029

      target function =                  N/A
              le_mean =     -22.422022740234
             les_mean =     503.331844201735
             stat err =       0.000612792059
             autocorr =       1.284378145074
              std dev =       0.764683418495
             le_variance =       0.584740730521

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.584801158325
                                         uncertainty =       0.005916994393

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.584801158325
                                         uncertainty =       0.005916994393

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000540712992
  error estimate for blocks of size 2^( 2) =       0.000563037074
  error estimate for blocks of size 2^( 3) =       0.000584079158
  error estimate for blocks of size 2^( 4) =       0.000601054618
  error estimate for blocks of size 2^( 5) =       0.000611175200
  error estimate for blocks of size 2^( 6) =       0.000618028356
  error estimate for blocks of size 2^( 7) =       0.000620911330

      target function =                  N/A
              le_mean =     -22.422022741602
             les_mean =     503.331844611981
             stat err =       0.000612792376
             autocorr =       1.284378707770
              std dev =       0.764683646642
             le_variance =       0.584741079441


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.422022741798        initial  <--
     2.4414e+02     2.4414e+03             9.2282e-06       -22.422022738697
     9.7656e+02     9.7656e+03             2.3070e-06       -22.422022740234
     3.9062e+03     3.9062e+04             5.7675e-07       -22.422022741602

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 71.7660
  </log>
  <optVariables href="FORMP2PJWARM.s014.opt.xml">
 uu_0                 2.638265e-01 1 1  ON 0
 uu_1                 9.183242e-02 1 1  ON 1
 uu_2                -1.754596e-02 1 1  ON 2
 uu_3                -7.729142e-02 1 1  ON 3
 uu_4                -1.044009e-01 1 1  ON 4
 uu_5                -1.106445e-01 1 1  ON 5
 uu_6                -9.922303e-02 1 1  ON 6
 uu_7                -6.665996e-02 1 1  ON 7
 uu_8                -1.406316e-02 1 1  ON 8
 uu_9                 4.648323e-02 1 1  ON 9
 ud_0                 4.010894e-01 1 1  ON 10
 ud_1                 1.218467e-01 1 1  ON 11
 ud_2                -1.883826e-02 1 1  ON 12
 ud_3                -8.919743e-02 1 1  ON 13
 ud_4                -1.214363e-01 1 1  ON 14
 ud_5                -1.322474e-01 1 1  ON 15
 ud_6                -1.247027e-01 1 1  ON 16
 ud_7                -9.444243e-02 1 1  ON 17
 ud_8                -4.491837e-02 1 1  ON 18
 ud_9                 2.489379e-02 1 1  ON 19
 eC_0                -4.408304e-01 1 1  ON 20
 eC_1                -2.798940e-01 1 1  ON 21
 eC_2                -7.727749e-03 1 1  ON 22
 eC_3                 1.692793e-01 1 1  ON 23
 eC_4                 2.431832e-01 1 1  ON 24
 eC_5                 2.345477e-01 1 1  ON 25
 eC_6                 6.325974e-02 1 1  ON 26
 eC_7                 1.206809e-02 1 1  ON 27
 eC_8                 3.479531e-03 1 1  ON 28
 eC_9                 1.930283e-03 1 1  ON 29
 eO_0                -8.300177e-01 1 1  ON 30
 eO_1                -4.611745e-01 1 1  ON 31
 eO_2                -9.526278e-03 1 1  ON 32
 eO_3                 2.427401e-01 1 1  ON 33
 eO_4                 3.624869e-01 1 1  ON 34
 eO_5                 3.704126e-01 1 1  ON 35
 eO_6                 2.403150e-01 1 1  ON 36
 eO_7                 7.125789e-02 1 1  ON 37
 eO_8                -1.139576e-03 1 1  ON 38
 eO_9                 7.347719e-03 1 1  ON 39
eH1_0                -1.164266e-01 1 1  ON 40
eH1_1                -1.770073e-02 1 1  ON 41
eH1_2                 2.429440e-03 1 1  ON 42
eH1_3                -7.152579e-03 1 1  ON 43
eH1_4                 1.698730e-02 1 1  ON 44
eH1_5                 1.017708e-02 1 1  ON 45
eH1_6                 2.296792e-02 1 1  ON 46
eH1_7                 5.244874e-02 1 1  ON 47
eH1_8                 2.420275e-02 1 1  ON 48
eH1_9                 8.249225e-03 1 1  ON 49
eH2_0                -1.185416e-01 1 1  ON 50
eH2_1                -1.956033e-02 1 1  ON 51
eH2_2                 7.941136e-05 1 1  ON 52
eH2_3                -7.861642e-03 1 1  ON 53
eH2_4                 1.656197e-02 1 1  ON 54
eH2_5                 8.426502e-03 1 1  ON 55
eH2_6                 2.276952e-02 1 1  ON 56
eH2_7                 5.698632e-02 1 1  ON 57
eH2_8                 3.065230e-02 1 1  ON 58
eH2_9                 8.840856e-03 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.3900e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORMP2PJWARM.s015 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORMP2PJWARM.s015 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=15  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2393e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 30888 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 15
    time step          = 0.05
    reference energy   = -22.2288
    reference variance = 2.16298
====================================================
  Execution time = 4.8947e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORMP2PJWARM.s015
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2422e+01
  VMC Evar = 5.7763e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.5925e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.577736526085
                                         uncertainty =       0.006072685915

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.577736526085
                                         uncertainty =       0.006072685915

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000537415850
  error estimate for blocks of size 2^( 2) =       0.000559082940
  error estimate for blocks of size 2^( 3) =       0.000579323976
  error estimate for blocks of size 2^( 4) =       0.000595507799
  error estimate for blocks of size 2^( 5) =       0.000605285746
  error estimate for blocks of size 2^( 6) =       0.000610905863
  error estimate for blocks of size 2^( 7) =       0.000616370481

      target function =                  N/A
              le_mean =     -22.421683483446
             les_mean =     503.309521535413
             stat err =       0.000607017472
             autocorr =       1.275796602614
              std dev =       0.760020784183
             le_variance =       0.577631592391


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.242168348345e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.4414e+03, overlap shift 2.4414e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.421683483446       residual = 7.09e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.421683489116       residual = 1.49e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.421683491353       residual = 1.84e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.421683493361       residual = 9.67e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.421683496976       residual = 9.28e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.421683498550       residual = 1.54e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.421683499811       residual = 4.76e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.421683499069       residual = 1.00e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.421683499485       residual = 4.64e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.421683499563       residual = 1.39e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -22.421683499481       residual = 5.10e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -22.421683499487       residual = 2.04e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -22.421683499446       residual = 5.57e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         12 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 2.4414e+03 is 8.913750e-07

solving harmonic davidson linear method for identity shift 9.7656e+03, overlap shift 9.7656e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.421683483446       residual = 7.09e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.421683484864       residual = 1.49e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.421683485423       residual = 1.84e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.421683485925       residual = 9.67e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.421683486822       residual = 9.28e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.421683487232       residual = 1.54e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.421683487509       residual = 4.76e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.421683487353       residual = 1.00e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.421683487482       residual = 4.64e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.421683487390       residual = 1.39e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -22.421683487473       residual = 5.10e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -22.421683487459       residual = 2.04e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -22.421683487458       residual = 5.57e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         12 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 9.7656e+03 is 2.228434e-07

solving harmonic davidson linear method for identity shift 3.9062e+04, overlap shift 3.9062e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.421683483446       residual = 7.09e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.421683483800       residual = 1.49e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.421683483940       residual = 1.84e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.421683484066       residual = 9.67e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.421683484269       residual = 9.28e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.421683484381       residual = 1.54e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.421683484457       residual = 4.76e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.421683484432       residual = 1.00e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.421683484188       residual = 4.64e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.421683484493       residual = 1.39e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -22.421683484526       residual = 5.10e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -22.421683484503       residual = 2.04e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -22.421683484365       residual = 5.57e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         12 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 3.9062e+04 is 5.571082e-08

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.185230 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 6.4883e+01
  </log>
  <optVariables href="FORMP2PJWARM.s015.opt.xml">
 uu_0                 2.638265e-01 1 1  ON 0
 uu_1                 9.183243e-02 1 1  ON 1
 uu_2                -1.754594e-02 1 1  ON 2
 uu_3                -7.729139e-02 1 1  ON 3
 uu_4                -1.044009e-01 1 1  ON 4
 uu_5                -1.106445e-01 1 1  ON 5
 uu_6                -9.922305e-02 1 1  ON 6
 uu_7                -6.666002e-02 1 1  ON 7
 uu_8                -1.406327e-02 1 1  ON 8
 uu_9                 4.648321e-02 1 1  ON 9
 ud_0                 4.010894e-01 1 1  ON 10
 ud_1                 1.218467e-01 1 1  ON 11
 ud_2                -1.883824e-02 1 1  ON 12
 ud_3                -8.919741e-02 1 1  ON 13
 ud_4                -1.214362e-01 1 1  ON 14
 ud_5                -1.322474e-01 1 1  ON 15
 ud_6                -1.247027e-01 1 1  ON 16
 ud_7                -9.444249e-02 1 1  ON 17
 ud_8                -4.491845e-02 1 1  ON 18
 ud_9                 2.489374e-02 1 1  ON 19
 eC_0                -4.408303e-01 1 1  ON 20
 eC_1                -2.798941e-01 1 1  ON 21
 eC_2                -7.727855e-03 1 1  ON 22
 eC_3                 1.692792e-01 1 1  ON 23
 eC_4                 2.431831e-01 1 1  ON 24
 eC_5                 2.345479e-01 1 1  ON 25
 eC_6                 6.325993e-02 1 1  ON 26
 eC_7                 1.206813e-02 1 1  ON 27
 eC_8                 3.479540e-03 1 1  ON 28
 eC_9                 1.930288e-03 1 1  ON 29
 eO_0                -8.300177e-01 1 1  ON 30
 eO_1                -4.611746e-01 1 1  ON 31
 eO_2                -9.526445e-03 1 1  ON 32
 eO_3                 2.427400e-01 1 1  ON 33
 eO_4                 3.624869e-01 1 1  ON 34
 eO_5                 3.704126e-01 1 1  ON 35
 eO_6                 2.403152e-01 1 1  ON 36
 eO_7                 7.125811e-02 1 1  ON 37
 eO_8                -1.139528e-03 1 1  ON 38
 eO_9                 7.347733e-03 1 1  ON 39
eH1_0                -1.164266e-01 1 1  ON 40
eH1_1                -1.770075e-02 1 1  ON 41
eH1_2                 2.429402e-03 1 1  ON 42
eH1_3                -7.152583e-03 1 1  ON 43
eH1_4                 1.698730e-02 1 1  ON 44
eH1_5                 1.017709e-02 1 1  ON 45
eH1_6                 2.296792e-02 1 1  ON 46
eH1_7                 5.244873e-02 1 1  ON 47
eH1_8                 2.420281e-02 1 1  ON 48
eH1_9                 8.249243e-03 1 1  ON 49
eH2_0                -1.185417e-01 1 1  ON 50
eH2_1                -1.956036e-02 1 1  ON 51
eH2_2                 7.939315e-05 1 1  ON 52
eH2_3                -7.861658e-03 1 1  ON 53
eH2_4                 1.656195e-02 1 1  ON 54
eH2_5                 8.426538e-03 1 1  ON 55
eH2_6                 2.276953e-02 1 1  ON 56
eH2_7                 5.698628e-02 1 1  ON 57
eH2_8                 3.065236e-02 1 1  ON 58
eH2_9                 8.840879e-03 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 15
    time step          = 0.05
    reference energy   = -22.4178
    reference variance = 0.434121
====================================================
  Execution time = 4.9846e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORMP2PJWARM.s015
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2421e+01
  VMC Evar = 5.7811e-01
  Total weights = 2.0000e+06
  Execution time = 4.5351e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.577763812036
                                         uncertainty =       0.004384912520

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.577763812036
                                         uncertainty =       0.004384912520

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000537636706
  error estimate for blocks of size 2^( 2) =       0.000560014207
  error estimate for blocks of size 2^( 3) =       0.000581375236
  error estimate for blocks of size 2^( 4) =       0.000597860660
  error estimate for blocks of size 2^( 5) =       0.000608755111
  error estimate for blocks of size 2^( 6) =       0.000615570650
  error estimate for blocks of size 2^( 7) =       0.000618003161

      target function =                  N/A
              le_mean =     -22.421401184356
             les_mean =     503.297337235624
             stat err =       0.000610047395
             autocorr =       1.287506207726
              std dev =       0.760333120978
             le_variance =       0.578106454856

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.577763705277
                                         uncertainty =       0.004384912397

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.577763705277
                                         uncertainty =       0.004384912397

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000537636656
  error estimate for blocks of size 2^( 2) =       0.000560014149
  error estimate for blocks of size 2^( 3) =       0.000581375170
  error estimate for blocks of size 2^( 4) =       0.000597860588
  error estimate for blocks of size 2^( 5) =       0.000608755035
  error estimate for blocks of size 2^( 6) =       0.000615570571
  error estimate for blocks of size 2^( 7) =       0.000618003081

      target function =                  N/A
              le_mean =     -22.421401184716
             les_mean =     503.297337144813
             stat err =       0.000610047319
             autocorr =       1.287506123191
              std dev =       0.760333050622
             le_variance =       0.578106347868

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.577763758665
                                         uncertainty =       0.004384912459

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.577763758665
                                         uncertainty =       0.004384912459

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000537636681
  error estimate for blocks of size 2^( 2) =       0.000560014178
  error estimate for blocks of size 2^( 3) =       0.000581375203
  error estimate for blocks of size 2^( 4) =       0.000597860624
  error estimate for blocks of size 2^( 5) =       0.000608755073
  error estimate for blocks of size 2^( 6) =       0.000615570611
  error estimate for blocks of size 2^( 7) =       0.000618003121

      target function =                  N/A
              le_mean =     -22.421401184536
             les_mean =     503.297337190223
             stat err =       0.000610047357
             autocorr =       1.287506165455
              std dev =       0.760333085805
             le_variance =       0.578106401370

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.577763805365
                                         uncertainty =       0.004384912512

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.577763805365
                                         uncertainty =       0.004384912512

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000537636703
  error estimate for blocks of size 2^( 2) =       0.000560014204
  error estimate for blocks of size 2^( 3) =       0.000581375232
  error estimate for blocks of size 2^( 4) =       0.000597860655
  error estimate for blocks of size 2^( 5) =       0.000608755106
  error estimate for blocks of size 2^( 6) =       0.000615570645
  error estimate for blocks of size 2^( 7) =       0.000618003156

      target function =                  N/A
              le_mean =     -22.421401184378
             les_mean =     503.297337229949
             stat err =       0.000610047391
             autocorr =       1.287506202448
              std dev =       0.760333116581
             le_variance =       0.578106448170


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.421401184356        initial
     2.4414e+03     2.4414e+04             8.9137e-07       -22.421401184716  <--
     9.7656e+03     9.7656e+04             2.2284e-07       -22.421401184536
     3.9062e+04     3.9062e+05             5.5711e-08       -22.421401184378

*****************************************************************************
Applying the update for shift_i =   2.4414e+03     and shift_s =   2.4414e+04
*****************************************************************************

  Execution time = 7.2512e+01
  </log>
  <optVariables href="FORMP2PJWARM.s015.opt.xml">
 uu_0                 2.638265e-01 1 1  ON 0
 uu_1                 9.183246e-02 1 1  ON 1
 uu_2                -1.754587e-02 1 1  ON 2
 uu_3                -7.729131e-02 1 1  ON 3
 uu_4                -1.044008e-01 1 1  ON 4
 uu_5                -1.106445e-01 1 1  ON 5
 uu_6                -9.922311e-02 1 1  ON 6
 uu_7                -6.666019e-02 1 1  ON 7
 uu_8                -1.406360e-02 1 1  ON 8
 uu_9                 4.648316e-02 1 1  ON 9
 ud_0                 4.010895e-01 1 1  ON 10
 ud_1                 1.218467e-01 1 1  ON 11
 ud_2                -1.883816e-02 1 1  ON 12
 ud_3                -8.919735e-02 1 1  ON 13
 ud_4                -1.214362e-01 1 1  ON 14
 ud_5                -1.322474e-01 1 1  ON 15
 ud_6                -1.247028e-01 1 1  ON 16
 ud_7                -9.444269e-02 1 1  ON 17
 ud_8                -4.491871e-02 1 1  ON 18
 ud_9                 2.489359e-02 1 1  ON 19
 eC_0                -4.408303e-01 1 1  ON 20
 eC_1                -2.798943e-01 1 1  ON 21
 eC_2                -7.728173e-03 1 1  ON 22
 eC_3                 1.692787e-01 1 1  ON 23
 eC_4                 2.431829e-01 1 1  ON 24
 eC_5                 2.345483e-01 1 1  ON 25
 eC_6                 6.326049e-02 1 1  ON 26
 eC_7                 1.206827e-02 1 1  ON 27
 eC_8                 3.479565e-03 1 1  ON 28
 eC_9                 1.930301e-03 1 1  ON 29
 eO_0                -8.300179e-01 1 1  ON 30
 eO_1                -4.611749e-01 1 1  ON 31
 eO_2                -9.526948e-03 1 1  ON 32
 eO_3                 2.427395e-01 1 1  ON 33
 eO_4                 3.624867e-01 1 1  ON 34
 eO_5                 3.704128e-01 1 1  ON 35
 eO_6                 2.403158e-01 1 1  ON 36
 eO_7                 7.125878e-02 1 1  ON 37
 eO_8                -1.139381e-03 1 1  ON 38
 eO_9                 7.347773e-03 1 1  ON 39
eH1_0                -1.164267e-01 1 1  ON 40
eH1_1                -1.770083e-02 1 1  ON 41
eH1_2                 2.429286e-03 1 1  ON 42
eH1_3                -7.152596e-03 1 1  ON 43
eH1_4                 1.698732e-02 1 1  ON 44
eH1_5                 1.017711e-02 1 1  ON 45
eH1_6                 2.296793e-02 1 1  ON 46
eH1_7                 5.244870e-02 1 1  ON 47
eH1_8                 2.420299e-02 1 1  ON 48
eH1_9                 8.249296e-03 1 1  ON 49
eH2_0                -1.185417e-01 1 1  ON 50
eH2_1                -1.956045e-02 1 1  ON 51
eH2_2                 7.933851e-05 1 1  ON 52
eH2_3                -7.861707e-03 1 1  ON 53
eH2_4                 1.656188e-02 1 1  ON 54
eH2_5                 8.426647e-03 1 1  ON 55
eH2_6                 2.276953e-02 1 1  ON 56
eH2_7                 5.698617e-02 1 1  ON 57
eH2_8                 3.065253e-02 1 1  ON 58
eH2_9                 8.840948e-03 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.3740e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORMP2PJWARM.s016 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORMP2PJWARM.s016 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=16  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2388e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 30888 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 16
    time step          = 0.05
    reference energy   = -22.4634
    reference variance = 0.235811
====================================================
  Execution time = 4.8921e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORMP2PJWARM.s016
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2421e+01
  VMC Evar = 5.6971e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.5867e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.569641122791
                                         uncertainty =       0.002676588626

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.569641122791
                                         uncertainty =       0.002676588626

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000533718170
  error estimate for blocks of size 2^( 2) =       0.000555956306
  error estimate for blocks of size 2^( 3) =       0.000577598106
  error estimate for blocks of size 2^( 4) =       0.000593202516
  error estimate for blocks of size 2^( 5) =       0.000604458318
  error estimate for blocks of size 2^( 6) =       0.000611422519
  error estimate for blocks of size 2^( 7) =       0.000615868555

      target function =                  N/A
              le_mean =     -22.421385728316
             les_mean =     503.288247862024
             stat err =       0.000606237977
             autocorr =       1.290215638374
              std dev =       0.754791473815
             le_variance =       0.569710168944


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.242138572832e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.1035e+02, overlap shift 6.1035e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.421385728316       residual = 7.51e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.421385731518       residual = 2.20e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.421385739636       residual = 1.33e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.421385759272       residual = 1.06e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.421385778589       residual = 9.36e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.421385789393       residual = 6.59e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.421385789381       residual = 2.49e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.421385787049       residual = 8.26e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.421385787827       residual = 2.07e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.421385787904       residual = 7.86e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -22.421385787865       residual = 3.35e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -22.421385787838       residual = 5.02e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 6.1035e+02 is 3.788728e-06

solving harmonic davidson linear method for identity shift 2.4414e+03, overlap shift 2.4414e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.421385728316       residual = 7.51e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.421385729117       residual = 2.20e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.421385731146       residual = 1.33e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.421385736056       residual = 1.06e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.421385740884       residual = 9.36e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.421385743584       residual = 6.58e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.421385743583       residual = 2.48e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.421385743003       residual = 8.25e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.421385743195       residual = 2.07e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.421385743216       residual = 7.85e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -22.421385743206       residual = 3.35e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -22.421385743193       residual = 5.00e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 2.4414e+03 is 9.471722e-07

solving harmonic davidson linear method for identity shift 9.7656e+03, overlap shift 9.7656e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.421385728316       residual = 7.51e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.421385728516       residual = 2.20e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.421385729024       residual = 1.33e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.421385730251       residual = 1.06e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.421385731459       residual = 9.36e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.421385732129       residual = 6.58e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.421385732138       residual = 2.48e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.421385731983       residual = 8.25e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.421385732039       residual = 2.07e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.421385732031       residual = 7.84e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -22.421385732025       residual = 3.35e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -22.421385731998       residual = 5.00e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 9.7656e+03 is 2.367924e-07

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.190299 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 6.4797e+01
  </log>
  <optVariables href="FORMP2PJWARM.s016.opt.xml">
 uu_0                 2.638265e-01 1 1  ON 0
 uu_1                 9.183246e-02 1 1  ON 1
 uu_2                -1.754580e-02 1 1  ON 2
 uu_3                -7.729124e-02 1 1  ON 3
 uu_4                -1.044008e-01 1 1  ON 4
 uu_5                -1.106445e-01 1 1  ON 5
 uu_6                -9.922324e-02 1 1  ON 6
 uu_7                -6.666041e-02 1 1  ON 7
 uu_8                -1.406397e-02 1 1  ON 8
 uu_9                 4.648314e-02 1 1  ON 9
 ud_0                 4.010896e-01 1 1  ON 10
 ud_1                 1.218467e-01 1 1  ON 11
 ud_2                -1.883804e-02 1 1  ON 12
 ud_3                -8.919729e-02 1 1  ON 13
 ud_4                -1.214361e-01 1 1  ON 14
 ud_5                -1.322474e-01 1 1  ON 15
 ud_6                -1.247029e-01 1 1  ON 16
 ud_7                -9.444296e-02 1 1  ON 17
 ud_8                -4.491909e-02 1 1  ON 18
 ud_9                 2.489341e-02 1 1  ON 19
 eC_0                -4.408302e-01 1 1  ON 20
 eC_1                -2.798947e-01 1 1  ON 21
 eC_2                -7.728607e-03 1 1  ON 22
 eC_3                 1.692781e-01 1 1  ON 23
 eC_4                 2.431826e-01 1 1  ON 24
 eC_5                 2.345489e-01 1 1  ON 25
 eC_6                 6.326125e-02 1 1  ON 26
 eC_7                 1.206846e-02 1 1  ON 27
 eC_8                 3.479590e-03 1 1  ON 28
 eC_9                 1.930316e-03 1 1  ON 29
 eO_0                -8.300181e-01 1 1  ON 30
 eO_1                -4.611753e-01 1 1  ON 31
 eO_2                -9.527586e-03 1 1  ON 32
 eO_3                 2.427389e-01 1 1  ON 33
 eO_4                 3.624864e-01 1 1  ON 34
 eO_5                 3.704129e-01 1 1  ON 35
 eO_6                 2.403166e-01 1 1  ON 36
 eO_7                 7.125973e-02 1 1  ON 37
 eO_8                -1.139193e-03 1 1  ON 38
 eO_9                 7.347830e-03 1 1  ON 39
eH1_0                -1.164267e-01 1 1  ON 40
eH1_1                -1.770097e-02 1 1  ON 41
eH1_2                 2.429190e-03 1 1  ON 42
eH1_3                -7.152647e-03 1 1  ON 43
eH1_4                 1.698725e-02 1 1  ON 44
eH1_5                 1.017722e-02 1 1  ON 45
eH1_6                 2.296796e-02 1 1  ON 46
eH1_7                 5.244865e-02 1 1  ON 47
eH1_8                 2.420323e-02 1 1  ON 48
eH1_9                 8.249377e-03 1 1  ON 49
eH2_0                -1.185417e-01 1 1  ON 50
eH2_1                -1.956058e-02 1 1  ON 51
eH2_2                 7.930917e-05 1 1  ON 52
eH2_3                -7.861766e-03 1 1  ON 53
eH2_4                 1.656178e-02 1 1  ON 54
eH2_5                 8.426804e-03 1 1  ON 55
eH2_6                 2.276952e-02 1 1  ON 56
eH2_7                 5.698601e-02 1 1  ON 57
eH2_8                 3.065278e-02 1 1  ON 58
eH2_9                 8.841046e-03 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 16
    time step          = 0.05
    reference energy   = -22.4577
    reference variance = 0.567284
====================================================
  Execution time = 4.8285e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORMP2PJWARM.s016
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2421e+01
  VMC Evar = 5.6914e-01
  Total weights = 2.0000e+06
  Execution time = 4.5159e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.569264986678
                                         uncertainty =       0.003719039365

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.569264986678
                                         uncertainty =       0.003719039365

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000533451048
  error estimate for blocks of size 2^( 2) =       0.000555888561
  error estimate for blocks of size 2^( 3) =       0.000577529587
  error estimate for blocks of size 2^( 4) =       0.000593448010
  error estimate for blocks of size 2^( 5) =       0.000603606732
  error estimate for blocks of size 2^( 6) =       0.000607458756
  error estimate for blocks of size 2^( 7) =       0.000611189686

      target function =                  N/A
              le_mean =     -22.421321618137
             les_mean =     503.284802861447
             stat err =       0.000603925796
             autocorr =       1.281675299879
              std dev =       0.754413707522
             le_variance =       0.569140042097

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.569264516158
                                         uncertainty =       0.003719032975

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.569264516158
                                         uncertainty =       0.003719032975

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000533450828
  error estimate for blocks of size 2^( 2) =       0.000555888303
  error estimate for blocks of size 2^( 3) =       0.000577529296
  error estimate for blocks of size 2^( 4) =       0.000593447688
  error estimate for blocks of size 2^( 5) =       0.000603606385
  error estimate for blocks of size 2^( 6) =       0.000607458398
  error estimate for blocks of size 2^( 7) =       0.000611189325

      target function =                  N/A
              le_mean =     -22.421321621440
             les_mean =     503.284802538973
             stat err =       0.000603925449
             autocorr =       1.281674887928
              std dev =       0.754413395609
             le_variance =       0.569139571474

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.569264751518
                                         uncertainty =       0.003719036170

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.569264751518
                                         uncertainty =       0.003719036170

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000533450938
  error estimate for blocks of size 2^( 2) =       0.000555888432
  error estimate for blocks of size 2^( 3) =       0.000577529442
  error estimate for blocks of size 2^( 4) =       0.000593447849
  error estimate for blocks of size 2^( 5) =       0.000603606558
  error estimate for blocks of size 2^( 6) =       0.000607458577
  error estimate for blocks of size 2^( 7) =       0.000611189506

      target function =                  N/A
              le_mean =     -22.421321619788
             les_mean =     503.284802700288
             stat err =       0.000603925623
             autocorr =       1.281675093833
              std dev =       0.754413551632
             le_variance =       0.569139806886

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.569264957286
                                         uncertainty =       0.003719038966

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.569264957286
                                         uncertainty =       0.003719038966

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000533451035
  error estimate for blocks of size 2^( 2) =       0.000555888545
  error estimate for blocks of size 2^( 3) =       0.000577529569
  error estimate for blocks of size 2^( 4) =       0.000593447990
  error estimate for blocks of size 2^( 5) =       0.000603606710
  error estimate for blocks of size 2^( 6) =       0.000607458733
  error estimate for blocks of size 2^( 7) =       0.000611189664

      target function =                  N/A
              le_mean =     -22.421321618343
             les_mean =     503.284802841300
             stat err =       0.000603925774
             autocorr =       1.281675274130
              std dev =       0.754413688037
             le_variance =       0.569140012698


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.421321618137        initial
     6.1035e+02     6.1035e+03             3.7887e-06       -22.421321621440  <--
     2.4414e+03     2.4414e+04             9.4717e-07       -22.421321619788
     9.7656e+03     9.7656e+04             2.3679e-07       -22.421321618343

*****************************************************************************
Applying the update for shift_i =   6.1035e+02     and shift_s =   6.1035e+03
*****************************************************************************

  Execution time = 7.0828e+01
  </log>
  <optVariables href="FORMP2PJWARM.s016.opt.xml">
 uu_0                 2.638263e-01 1 1  ON 0
 uu_1                 9.183246e-02 1 1  ON 1
 uu_2                -1.754560e-02 1 1  ON 2
 uu_3                -7.729101e-02 1 1  ON 3
 uu_4                -1.044005e-01 1 1  ON 4
 uu_5                -1.106444e-01 1 1  ON 5
 uu_6                -9.922365e-02 1 1  ON 6
 uu_7                -6.666107e-02 1 1  ON 7
 uu_8                -1.406505e-02 1 1  ON 8
 uu_9                 4.648306e-02 1 1  ON 9
 ud_0                 4.010900e-01 1 1  ON 10
 ud_1                 1.218467e-01 1 1  ON 11
 ud_2                -1.883770e-02 1 1  ON 12
 ud_3                -8.919711e-02 1 1  ON 13
 ud_4                -1.214357e-01 1 1  ON 14
 ud_5                -1.322473e-01 1 1  ON 15
 ud_6                -1.247032e-01 1 1  ON 16
 ud_7                -9.444376e-02 1 1  ON 17
 ud_8                -4.492022e-02 1 1  ON 18
 ud_9                 2.489288e-02 1 1  ON 19
 eC_0                -4.408300e-01 1 1  ON 20
 eC_1                -2.798957e-01 1 1  ON 21
 eC_2                -7.729908e-03 1 1  ON 22
 eC_3                 1.692764e-01 1 1  ON 23
 eC_4                 2.431817e-01 1 1  ON 24
 eC_5                 2.345506e-01 1 1  ON 25
 eC_6                 6.326354e-02 1 1  ON 26
 eC_7                 1.206905e-02 1 1  ON 27
 eC_8                 3.479664e-03 1 1  ON 28
 eC_9                 1.930362e-03 1 1  ON 29
 eO_0                -8.300187e-01 1 1  ON 30
 eO_1                -4.611766e-01 1 1  ON 31
 eO_2                -9.529501e-03 1 1  ON 32
 eO_3                 2.427369e-01 1 1  ON 33
 eO_4                 3.624856e-01 1 1  ON 34
 eO_5                 3.704134e-01 1 1  ON 35
 eO_6                 2.403189e-01 1 1  ON 36
 eO_7                 7.126257e-02 1 1  ON 37
 eO_8                -1.138626e-03 1 1  ON 38
 eO_9                 7.347999e-03 1 1  ON 39
eH1_0                -1.164270e-01 1 1  ON 40
eH1_1                -1.770139e-02 1 1  ON 41
eH1_2                 2.428903e-03 1 1  ON 42
eH1_3                -7.152799e-03 1 1  ON 43
eH1_4                 1.698707e-02 1 1  ON 44
eH1_5                 1.017754e-02 1 1  ON 45
eH1_6                 2.296804e-02 1 1  ON 46
eH1_7                 5.244850e-02 1 1  ON 47
eH1_8                 2.420395e-02 1 1  ON 48
eH1_9                 8.249621e-03 1 1  ON 49
eH2_0                -1.185418e-01 1 1  ON 50
eH2_1                -1.956097e-02 1 1  ON 51
eH2_2                 7.922110e-05 1 1  ON 52
eH2_3                -7.861943e-03 1 1  ON 53
eH2_4                 1.656148e-02 1 1  ON 54
eH2_5                 8.427275e-03 1 1  ON 55
eH2_6                 2.276947e-02 1 1  ON 56
eH2_7                 5.698553e-02 1 1  ON 57
eH2_8                 3.065351e-02 1 1  ON 58
eH2_9                 8.841342e-03 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.3563e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORMP2PJWARM.s017 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORMP2PJWARM.s017 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=17  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2393e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 30888 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 17
    time step          = 0.05
    reference energy   = -22.4008
    reference variance = 0.483371
====================================================
  Execution time = 4.9285e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORMP2PJWARM.s017
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2423e+01
  VMC Evar = 5.7725e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.5968e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.577201889666
                                         uncertainty =       0.005341201474

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.577201889666
                                         uncertainty =       0.005341201474

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000537236942
  error estimate for blocks of size 2^( 2) =       0.000559037214
  error estimate for blocks of size 2^( 3) =       0.000580377574
  error estimate for blocks of size 2^( 4) =       0.000595927281
  error estimate for blocks of size 2^( 5) =       0.000606135879
  error estimate for blocks of size 2^( 6) =       0.000610322236
  error estimate for blocks of size 2^( 7) =       0.000615169647

      target function =                  N/A
              le_mean =     -22.423116767436
             les_mean =     503.373412342158
             stat err =       0.000606888761
             autocorr =       1.276105123020
              std dev =       0.759767770244
             le_variance =       0.577247064702


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.242311676744e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5259e+02, overlap shift 1.5259e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.423116767436       residual = 7.81e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.423116819074       residual = 2.09e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.423116881470       residual = 1.85e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.423116919464       residual = 8.46e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.423116966677       residual = 7.53e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.423116991540       residual = 1.90e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.423117009320       residual = 4.75e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.423117013385       residual = 9.91e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.423117011396       residual = 5.46e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.423117013357       residual = 1.05e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -22.423117015189       residual = 5.01e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -22.423117014575       residual = 9.69e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.5259e+02 is 1.530420e-05

solving harmonic davidson linear method for identity shift 6.1035e+02, overlap shift 6.1035e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.423116767436       residual = 7.81e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.423116780358       residual = 2.09e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.423116795968       residual = 1.85e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.423116805470       residual = 8.45e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.423116817265       residual = 7.51e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.423116823473       residual = 1.89e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.423116827924       residual = 4.74e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.423116828939       residual = 9.86e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.423116828442       residual = 5.43e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.423116828929       residual = 1.04e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -22.423116829386       residual = 4.97e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -22.423116829234       residual = 9.61e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 6.1035e+02 is 3.825979e-06

solving harmonic davidson linear method for identity shift 2.4414e+03, overlap shift 2.4414e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.423116767436       residual = 7.81e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.423116770667       residual = 2.09e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.423116774571       residual = 1.85e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.423116776946       residual = 8.45e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.423116779895       residual = 7.51e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.423116781446       residual = 1.89e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.423116782556       residual = 4.73e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.423116782816       residual = 9.85e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.423116782708       residual = 5.43e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.423116782796       residual = 1.04e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -22.423116782909       residual = 4.96e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -22.423116782893       residual = 9.59e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 2.4414e+03 is 9.564902e-07

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.195316 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 6.5262e+01
  </log>
  <optVariables href="FORMP2PJWARM.s017.opt.xml">
 uu_0                 2.638263e-01 1 1  ON 0
 uu_1                 9.183285e-02 1 1  ON 1
 uu_2                -1.754523e-02 1 1  ON 2
 uu_3                -7.729076e-02 1 1  ON 3
 uu_4                -1.044001e-01 1 1  ON 4
 uu_5                -1.106446e-01 1 1  ON 5
 uu_6                -9.922419e-02 1 1  ON 6
 uu_7                -6.666177e-02 1 1  ON 7
 uu_8                -1.406662e-02 1 1  ON 8
 uu_9                 4.648278e-02 1 1  ON 9
 ud_0                 4.010905e-01 1 1  ON 10
 ud_1                 1.218468e-01 1 1  ON 11
 ud_2                -1.883731e-02 1 1  ON 12
 ud_3                -8.919659e-02 1 1  ON 13
 ud_4                -1.214353e-01 1 1  ON 14
 ud_5                -1.322469e-01 1 1  ON 15
 ud_6                -1.247034e-01 1 1  ON 16
 ud_7                -9.444465e-02 1 1  ON 17
 ud_8                -4.492166e-02 1 1  ON 18
 ud_9                 2.489187e-02 1 1  ON 19
 eC_0                -4.408298e-01 1 1  ON 20
 eC_1                -2.798968e-01 1 1  ON 21
 eC_2                -7.731720e-03 1 1  ON 22
 eC_3                 1.692741e-01 1 1  ON 23
 eC_4                 2.431804e-01 1 1  ON 24
 eC_5                 2.345529e-01 1 1  ON 25
 eC_6                 6.326652e-02 1 1  ON 26
 eC_7                 1.206988e-02 1 1  ON 27
 eC_8                 3.479751e-03 1 1  ON 28
 eC_9                 1.930394e-03 1 1  ON 29
 eO_0                -8.300199e-01 1 1  ON 30
 eO_1                -4.611783e-01 1 1  ON 31
 eO_2                -9.531990e-03 1 1  ON 32
 eO_3                 2.427347e-01 1 1  ON 33
 eO_4                 3.624848e-01 1 1  ON 34
 eO_5                 3.704138e-01 1 1  ON 35
 eO_6                 2.403221e-01 1 1  ON 36
 eO_7                 7.126640e-02 1 1  ON 37
 eO_8                -1.137890e-03 1 1  ON 38
 eO_9                 7.348156e-03 1 1  ON 39
eH1_0                -1.164272e-01 1 1  ON 40
eH1_1                -1.770174e-02 1 1  ON 41
eH1_2                 2.428388e-03 1 1  ON 42
eH1_3                -7.152789e-03 1 1  ON 43
eH1_4                 1.698707e-02 1 1  ON 44
eH1_5                 1.017761e-02 1 1  ON 45
eH1_6                 2.296812e-02 1 1  ON 46
eH1_7                 5.244812e-02 1 1  ON 47
eH1_8                 2.420494e-02 1 1  ON 48
eH1_9                 8.249947e-03 1 1  ON 49
eH2_0                -1.185418e-01 1 1  ON 50
eH2_1                -1.956131e-02 1 1  ON 51
eH2_2                 7.883251e-05 1 1  ON 52
eH2_3                -7.862361e-03 1 1  ON 53
eH2_4                 1.656097e-02 1 1  ON 54
eH2_5                 8.428025e-03 1 1  ON 55
eH2_6                 2.276937e-02 1 1  ON 56
eH2_7                 5.698509e-02 1 1  ON 57
eH2_8                 3.065450e-02 1 1  ON 58
eH2_9                 8.841729e-03 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 17
    time step          = 0.05
    reference energy   = -22.4604
    reference variance = 0.516908
====================================================
  Execution time = 4.7893e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORMP2PJWARM.s017
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2422e+01
  VMC Evar = 5.7182e-01
  Total weights = 2.0000e+06
  Execution time = 4.5125e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.571667612011
                                         uncertainty =       0.005221870134

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.571667612011
                                         uncertainty =       0.005221870134

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000534705227
  error estimate for blocks of size 2^( 2) =       0.000557154571
  error estimate for blocks of size 2^( 3) =       0.000578311416
  error estimate for blocks of size 2^( 4) =       0.000594996165
  error estimate for blocks of size 2^( 5) =       0.000604714405
  error estimate for blocks of size 2^( 6) =       0.000610733149
  error estimate for blocks of size 2^( 7) =       0.000614296712

      target function =                  N/A
              le_mean =     -22.422241995154
             les_mean =     503.328755163323
             stat err =       0.000606185107
             autocorr =       1.285232401190
              std dev =       0.756187384175
             le_variance =       0.571819359986

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.571666050278
                                         uncertainty =       0.005221872133

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.571666050278
                                         uncertainty =       0.005221872133

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000534704496
  error estimate for blocks of size 2^( 2) =       0.000557153662
  error estimate for blocks of size 2^( 3) =       0.000578310358
  error estimate for blocks of size 2^( 4) =       0.000594995004
  error estimate for blocks of size 2^( 5) =       0.000604713210
  error estimate for blocks of size 2^( 6) =       0.000610731859
  error estimate for blocks of size 2^( 7) =       0.000614295339

      target function =                  N/A
              le_mean =     -22.422242003283
             les_mean =     503.328753964096
             stat err =       0.000606183853
             autocorr =       1.285230596069
              std dev =       0.756186350205
             le_variance =       0.571817796236

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.571666833361
                                         uncertainty =       0.005221871163

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.571666833361
                                         uncertainty =       0.005221871163

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000534704863
  error estimate for blocks of size 2^( 2) =       0.000557154117
  error estimate for blocks of size 2^( 3) =       0.000578310888
  error estimate for blocks of size 2^( 4) =       0.000594995585
  error estimate for blocks of size 2^( 5) =       0.000604713808
  error estimate for blocks of size 2^( 6) =       0.000610732505
  error estimate for blocks of size 2^( 7) =       0.000614296026

      target function =                  N/A
              le_mean =     -22.422241999218
             les_mean =     503.328754565897
             stat err =       0.000606184481
             autocorr =       1.285231497176
              std dev =       0.756186868655
             le_variance =       0.571818580327

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.571667514743
                                         uncertainty =       0.005221870263

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.571667514743
                                         uncertainty =       0.005221870263

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000534705182
  error estimate for blocks of size 2^( 2) =       0.000557154514
  error estimate for blocks of size 2^( 3) =       0.000578311350
  error estimate for blocks of size 2^( 4) =       0.000594996092
  error estimate for blocks of size 2^( 5) =       0.000604714330
  error estimate for blocks of size 2^( 6) =       0.000610733068
  error estimate for blocks of size 2^( 7) =       0.000614296627

      target function =                  N/A
              le_mean =     -22.422241995660
             les_mean =     503.328755088639
             stat err =       0.000606185029
             autocorr =       1.285232288139
              std dev =       0.756187319777
             le_variance =       0.571819262591


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.422241995154        initial
     1.5259e+02     1.5259e+03             1.5304e-05       -22.422242003283  <--
     6.1035e+02     6.1035e+03             3.8260e-06       -22.422241999218
     2.4414e+03     2.4414e+04             9.5649e-07       -22.422241995660

*****************************************************************************
Applying the update for shift_i =   1.5259e+02     and shift_s =   1.5259e+03
*****************************************************************************

  Execution time = 7.2342e+01
  </log>
  <optVariables href="FORMP2PJWARM.s017.opt.xml">
 uu_0                 2.638262e-01 1 1  ON 0
 uu_1                 9.183402e-02 1 1  ON 1
 uu_2                -1.754410e-02 1 1  ON 2
 uu_3                -7.729003e-02 1 1  ON 3
 uu_4                -1.043989e-01 1 1  ON 4
 uu_5                -1.106449e-01 1 1  ON 5
 uu_6                -9.922581e-02 1 1  ON 6
 uu_7                -6.666386e-02 1 1  ON 7
 uu_8                -1.407133e-02 1 1  ON 8
 uu_9                 4.648194e-02 1 1  ON 9
 ud_0                 4.010917e-01 1 1  ON 10
 ud_1                 1.218468e-01 1 1  ON 11
 ud_2                -1.883615e-02 1 1  ON 12
 ud_3                -8.919503e-02 1 1  ON 13
 ud_4                -1.214338e-01 1 1  ON 14
 ud_5                -1.322458e-01 1 1  ON 15
 ud_6                -1.247042e-01 1 1  ON 16
 ud_7                -9.444731e-02 1 1  ON 17
 ud_8                -4.492599e-02 1 1  ON 18
 ud_9                 2.488886e-02 1 1  ON 19
 eC_0                -4.408291e-01 1 1  ON 20
 eC_1                -2.799001e-01 1 1  ON 21
 eC_2                -7.737156e-03 1 1  ON 22
 eC_3                 1.692673e-01 1 1  ON 23
 eC_4                 2.431768e-01 1 1  ON 24
 eC_5                 2.345598e-01 1 1  ON 25
 eC_6                 6.327546e-02 1 1  ON 26
 eC_7                 1.207238e-02 1 1  ON 27
 eC_8                 3.480011e-03 1 1  ON 28
 eC_9                 1.930491e-03 1 1  ON 29
 eO_0                -8.300236e-01 1 1  ON 30
 eO_1                -4.611832e-01 1 1  ON 31
 eO_2                -9.539456e-03 1 1  ON 32
 eO_3                 2.427281e-01 1 1  ON 33
 eO_4                 3.624821e-01 1 1  ON 34
 eO_5                 3.704149e-01 1 1  ON 35
 eO_6                 2.403317e-01 1 1  ON 36
 eO_7                 7.127787e-02 1 1  ON 37
 eO_8                -1.135681e-03 1 1  ON 38
 eO_9                 7.348627e-03 1 1  ON 39
eH1_0                -1.164280e-01 1 1  ON 40
eH1_1                -1.770280e-02 1 1  ON 41
eH1_2                 2.426846e-03 1 1  ON 42
eH1_3                -7.152760e-03 1 1  ON 43
eH1_4                 1.698709e-02 1 1  ON 44
eH1_5                 1.017782e-02 1 1  ON 45
eH1_6                 2.296836e-02 1 1  ON 46
eH1_7                 5.244700e-02 1 1  ON 47
eH1_8                 2.420793e-02 1 1  ON 48
eH1_9                 8.250924e-03 1 1  ON 49
eH2_0                -1.185419e-01 1 1  ON 50
eH2_1                -1.956234e-02 1 1  ON 51
eH2_2                 7.766651e-05 1 1  ON 52
eH2_3                -7.863615e-03 1 1  ON 53
eH2_4                 1.655943e-02 1 1  ON 54
eH2_5                 8.430274e-03 1 1  ON 55
eH2_6                 2.276909e-02 1 1  ON 56
eH2_7                 5.698378e-02 1 1  ON 57
eH2_8                 3.065745e-02 1 1  ON 58
eH2_9                 8.842890e-03 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.3761e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORMP2PJWARM.s018 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORMP2PJWARM.s018 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=18  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2395e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 30888 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 18
    time step          = 0.05
    reference energy   = -22.4317
    reference variance = 0.415576
====================================================
  Execution time = 4.9531e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORMP2PJWARM.s018
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2422e+01
  VMC Evar = 5.8208e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.6243e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.582210564891
                                         uncertainty =       0.005569097346

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.582210564891
                                         uncertainty =       0.005569097346

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000539482333
  error estimate for blocks of size 2^( 2) =       0.000561068114
  error estimate for blocks of size 2^( 3) =       0.000582285791
  error estimate for blocks of size 2^( 4) =       0.000598011349
  error estimate for blocks of size 2^( 5) =       0.000610335895
  error estimate for blocks of size 2^( 6) =       0.000618911541
  error estimate for blocks of size 2^( 7) =       0.000622657971

      target function =                  N/A
              le_mean =     -22.422359154103
             les_mean =     503.344272118954
             stat err =       0.000612479189
             autocorr =       1.288926700046
              std dev =       0.762943231444
             le_variance =       0.582082374407


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.242235915410e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.8147e+01, overlap shift 3.8147e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.422359154103       residual = 6.90e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.422359591683       residual = 1.01e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.422359686900       residual = 1.53e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.422359898570       residual = 1.69e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.422360047385       residual = 5.20e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.422360148777       residual = 1.05e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.422360157350       residual = 4.25e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.422360200363       residual = 1.09e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.422360212966       residual = 3.53e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.422360203979       residual = 1.21e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -22.422360201353       residual = 4.85e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -22.422360201428       residual = 1.22e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -22.422360200919       residual = 4.96e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         12 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 3.8147e+01 is 6.017738e-05

solving harmonic davidson linear method for identity shift 1.5259e+02, overlap shift 1.5259e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.422359154103       residual = 6.90e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.422359263851       residual = 1.01e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.422359287801       residual = 1.53e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.422359340716       residual = 1.68e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.422359378006       residual = 5.17e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.422359403333       residual = 1.04e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.422359405227       residual = 4.21e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.422359416005       residual = 1.07e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.422359419157       residual = 3.51e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.422359416915       residual = 1.17e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -22.422359416264       residual = 4.81e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -22.422359416284       residual = 1.15e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -22.422359416166       residual = 4.77e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         12 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.5259e+02 is 1.504272e-05

solving harmonic davidson linear method for identity shift 6.1035e+02, overlap shift 6.1035e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.422359154103       residual = 6.90e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.422359181562       residual = 1.01e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.422359187559       residual = 1.53e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.422359200787       residual = 1.68e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.422359210116       residual = 5.17e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.422359216446       residual = 1.04e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.422359216905       residual = 4.20e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.422359219600       residual = 1.06e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.422359220385       residual = 3.51e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.422359219828       residual = 1.16e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -22.422359219664       residual = 4.80e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -22.422359219670       residual = 1.14e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -22.422359219639       residual = 4.72e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         12 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 6.1035e+02 is 3.760578e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.201216 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 6.5784e+01
  </log>
  <optVariables href="FORMP2PJWARM.s018.opt.xml">
 uu_0                 2.638252e-01 1 1  ON 0
 uu_1                 9.183476e-02 1 1  ON 1
 uu_2                -1.754259e-02 1 1  ON 2
 uu_3                -7.728854e-02 1 1  ON 3
 uu_4                -1.043978e-01 1 1  ON 4
 uu_5                -1.106445e-01 1 1  ON 5
 uu_6                -9.922766e-02 1 1  ON 6
 uu_7                -6.666676e-02 1 1  ON 7
 uu_8                -1.407799e-02 1 1  ON 8
 uu_9                 4.648062e-02 1 1  ON 9
 ud_0                 4.010941e-01 1 1  ON 10
 ud_1                 1.218463e-01 1 1  ON 11
 ud_2                -1.883366e-02 1 1  ON 12
 ud_3                -8.919407e-02 1 1  ON 13
 ud_4                -1.214319e-01 1 1  ON 14
 ud_5                -1.322455e-01 1 1  ON 15
 ud_6                -1.247055e-01 1 1  ON 16
 ud_7                -9.445082e-02 1 1  ON 17
 ud_8                -4.493157e-02 1 1  ON 18
 ud_9                 2.488491e-02 1 1  ON 19
 eC_0                -4.408282e-01 1 1  ON 20
 eC_1                -2.799047e-01 1 1  ON 21
 eC_2                -7.744009e-03 1 1  ON 22
 eC_3                 1.692590e-01 1 1  ON 23
 eC_4                 2.431717e-01 1 1  ON 24
 eC_5                 2.345691e-01 1 1  ON 25
 eC_6                 6.328690e-02 1 1  ON 26
 eC_7                 1.207484e-02 1 1  ON 27
 eC_8                 3.480242e-03 1 1  ON 28
 eC_9                 1.930738e-03 1 1  ON 29
 eO_0                -8.300273e-01 1 1  ON 30
 eO_1                -4.611903e-01 1 1  ON 31
 eO_2                -9.550463e-03 1 1  ON 32
 eO_3                 2.427189e-01 1 1  ON 33
 eO_4                 3.624783e-01 1 1  ON 34
 eO_5                 3.704179e-01 1 1  ON 35
 eO_6                 2.403440e-01 1 1  ON 36
 eO_7                 7.129292e-02 1 1  ON 37
 eO_8                -1.132506e-03 1 1  ON 38
 eO_9                 7.349219e-03 1 1  ON 39
eH1_0                -1.164285e-01 1 1  ON 40
eH1_1                -1.770427e-02 1 1  ON 41
eH1_2                 2.424721e-03 1 1  ON 42
eH1_3                -7.152866e-03 1 1  ON 43
eH1_4                 1.698728e-02 1 1  ON 44
eH1_5                 1.017830e-02 1 1  ON 45
eH1_6                 2.296891e-02 1 1  ON 46
eH1_7                 5.244550e-02 1 1  ON 47
eH1_8                 2.421102e-02 1 1  ON 48
eH1_9                 8.251851e-03 1 1  ON 49
eH2_0                -1.185424e-01 1 1  ON 50
eH2_1                -1.956402e-02 1 1  ON 51
eH2_2                 7.759605e-05 1 1  ON 52
eH2_3                -7.864060e-03 1 1  ON 53
eH2_4                 1.655750e-02 1 1  ON 54
eH2_5                 8.432186e-03 1 1  ON 55
eH2_6                 2.276903e-02 1 1  ON 56
eH2_7                 5.698142e-02 1 1  ON 57
eH2_8                 3.066119e-02 1 1  ON 58
eH2_9                 8.844017e-03 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 18
    time step          = 0.05
    reference energy   = -22.4327
    reference variance = 0.457152
====================================================
  Execution time = 4.8643e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORMP2PJWARM.s018
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2422e+01
  VMC Evar = 6.0441e-01
  Total weights = 2.0000e+06
  Execution time = 4.5039e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.604578401705
                                         uncertainty =       0.032513763146

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.604578401705
                                         uncertainty =       0.032513763146

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000549734934
  error estimate for blocks of size 2^( 2) =       0.000570900253
  error estimate for blocks of size 2^( 3) =       0.000591975057
  error estimate for blocks of size 2^( 4) =       0.000607643067
  error estimate for blocks of size 2^( 5) =       0.000618060759
  error estimate for blocks of size 2^( 6) =       0.000622991032
  error estimate for blocks of size 2^( 7) =       0.000627349622

      target function =                  N/A
              le_mean =     -22.422329149788
             les_mean =     503.365261193954
             stat err =       0.000619011120
             autocorr =       1.267915264183
              std dev =       0.777442598991
             le_variance =       0.604416994725

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.604565123787
                                         uncertainty =       0.032510212245

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.604565123787
                                         uncertainty =       0.032510212245

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000549728893
  error estimate for blocks of size 2^( 2) =       0.000570893830
  error estimate for blocks of size 2^( 3) =       0.000591968240
  error estimate for blocks of size 2^( 4) =       0.000607635850
  error estimate for blocks of size 2^( 5) =       0.000618053242
  error estimate for blocks of size 2^( 6) =       0.000622983237
  error estimate for blocks of size 2^( 7) =       0.000627341923

      target function =                  N/A
              le_mean =     -22.422329045888
             les_mean =     503.365243252543
             stat err =       0.000619003563
             autocorr =       1.267912169186
              std dev =       0.777434056794
             le_variance =       0.604403712664

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.604571771837
                                         uncertainty =       0.032511974032

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.604571771837
                                         uncertainty =       0.032511974032

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000549731918
  error estimate for blocks of size 2^( 2) =       0.000570897046
  error estimate for blocks of size 2^( 3) =       0.000591971653
  error estimate for blocks of size 2^( 4) =       0.000607639463
  error estimate for blocks of size 2^( 5) =       0.000618057004
  error estimate for blocks of size 2^( 6) =       0.000622987138
  error estimate for blocks of size 2^( 7) =       0.000627345774

      target function =                  N/A
              le_mean =     -22.422329097169
             les_mean =     503.365252202282
             stat err =       0.000619007345
             autocorr =       1.267913709892
              std dev =       0.777438333722
             le_variance =       0.604410362740

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.604577573093
                                         uncertainty =       0.032513539069

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.604577573093
                                         uncertainty =       0.032513539069

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000549734557
  error estimate for blocks of size 2^( 2) =       0.000570899852
  error estimate for blocks of size 2^( 3) =       0.000591974631
  error estimate for blocks of size 2^( 4) =       0.000607642617
  error estimate for blocks of size 2^( 5) =       0.000618060290
  error estimate for blocks of size 2^( 6) =       0.000622990545
  error estimate for blocks of size 2^( 7) =       0.000627349141

      target function =                  N/A
              le_mean =     -22.422329143164
             les_mean =     503.365260068010
             stat err =       0.000619010648
             autocorr =       1.267915069653
              std dev =       0.777442065910
             le_variance =       0.604416165847


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.422329149788        initial  <--
     3.8147e+01     3.8147e+02             6.0177e-05       -22.422329045888
     1.5259e+02     1.5259e+03             1.5043e-05       -22.422329097169
     6.1035e+02     6.1035e+03             3.7606e-06       -22.422329143164

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 71.1388
  </log>
  <optVariables href="FORMP2PJWARM.s018.opt.xml">
 uu_0                 2.638262e-01 1 1  ON 0
 uu_1                 9.183402e-02 1 1  ON 1
 uu_2                -1.754410e-02 1 1  ON 2
 uu_3                -7.729003e-02 1 1  ON 3
 uu_4                -1.043989e-01 1 1  ON 4
 uu_5                -1.106449e-01 1 1  ON 5
 uu_6                -9.922581e-02 1 1  ON 6
 uu_7                -6.666386e-02 1 1  ON 7
 uu_8                -1.407133e-02 1 1  ON 8
 uu_9                 4.648194e-02 1 1  ON 9
 ud_0                 4.010917e-01 1 1  ON 10
 ud_1                 1.218468e-01 1 1  ON 11
 ud_2                -1.883615e-02 1 1  ON 12
 ud_3                -8.919503e-02 1 1  ON 13
 ud_4                -1.214338e-01 1 1  ON 14
 ud_5                -1.322458e-01 1 1  ON 15
 ud_6                -1.247042e-01 1 1  ON 16
 ud_7                -9.444731e-02 1 1  ON 17
 ud_8                -4.492599e-02 1 1  ON 18
 ud_9                 2.488886e-02 1 1  ON 19
 eC_0                -4.408291e-01 1 1  ON 20
 eC_1                -2.799001e-01 1 1  ON 21
 eC_2                -7.737156e-03 1 1  ON 22
 eC_3                 1.692673e-01 1 1  ON 23
 eC_4                 2.431768e-01 1 1  ON 24
 eC_5                 2.345598e-01 1 1  ON 25
 eC_6                 6.327546e-02 1 1  ON 26
 eC_7                 1.207238e-02 1 1  ON 27
 eC_8                 3.480011e-03 1 1  ON 28
 eC_9                 1.930491e-03 1 1  ON 29
 eO_0                -8.300236e-01 1 1  ON 30
 eO_1                -4.611832e-01 1 1  ON 31
 eO_2                -9.539456e-03 1 1  ON 32
 eO_3                 2.427281e-01 1 1  ON 33
 eO_4                 3.624821e-01 1 1  ON 34
 eO_5                 3.704149e-01 1 1  ON 35
 eO_6                 2.403317e-01 1 1  ON 36
 eO_7                 7.127787e-02 1 1  ON 37
 eO_8                -1.135681e-03 1 1  ON 38
 eO_9                 7.348627e-03 1 1  ON 39
eH1_0                -1.164280e-01 1 1  ON 40
eH1_1                -1.770280e-02 1 1  ON 41
eH1_2                 2.426846e-03 1 1  ON 42
eH1_3                -7.152760e-03 1 1  ON 43
eH1_4                 1.698709e-02 1 1  ON 44
eH1_5                 1.017782e-02 1 1  ON 45
eH1_6                 2.296836e-02 1 1  ON 46
eH1_7                 5.244700e-02 1 1  ON 47
eH1_8                 2.420793e-02 1 1  ON 48
eH1_9                 8.250924e-03 1 1  ON 49
eH2_0                -1.185419e-01 1 1  ON 50
eH2_1                -1.956234e-02 1 1  ON 51
eH2_2                 7.766651e-05 1 1  ON 52
eH2_3                -7.863615e-03 1 1  ON 53
eH2_4                 1.655943e-02 1 1  ON 54
eH2_5                 8.430274e-03 1 1  ON 55
eH2_6                 2.276909e-02 1 1  ON 56
eH2_7                 5.698378e-02 1 1  ON 57
eH2_8                 3.065745e-02 1 1  ON 58
eH2_9                 8.842890e-03 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.3693e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORMP2PJWARM.s019 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORMP2PJWARM.s019 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=19  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2397e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 30888 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 19
    time step          = 0.05
    reference energy   = -22.448
    reference variance = 0.487025
====================================================
  Execution time = 4.8952e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORMP2PJWARM.s019
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2423e+01
  VMC Evar = 5.8828e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.6068e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.588424527812
                                         uncertainty =       0.015971183701

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.588424527812
                                         uncertainty =       0.015971183701

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000542345163
  error estimate for blocks of size 2^( 2) =       0.000564448392
  error estimate for blocks of size 2^( 3) =       0.000585158143
  error estimate for blocks of size 2^( 4) =       0.000600722236
  error estimate for blocks of size 2^( 5) =       0.000610580630
  error estimate for blocks of size 2^( 6) =       0.000615874895
  error estimate for blocks of size 2^( 7) =       0.000618078341

      target function =                  N/A
              le_mean =     -22.423046757416
             les_mean =     503.381302142667
             stat err =       0.000611314026
             autocorr =       1.270507338125
              std dev =       0.766991884937
             le_variance =       0.588276551559


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.242304675742e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.8147e+02, overlap shift 3.8147e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.423046757416       residual = 8.59e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.423046773639       residual = 3.14e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.423046799035       residual = 1.11e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.423046809279       residual = 9.78e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.423046828737       residual = 1.16e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.423046846433       residual = 8.37e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.423046852404       residual = 3.06e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.423046854728       residual = 1.41e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.423046855877       residual = 2.72e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.423046855819       residual = 1.80e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -22.423046855160       residual = 4.19e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -22.423046855047       residual = 7.05e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 3.8147e+02 is 5.671229e-06

solving harmonic davidson linear method for identity shift 1.5259e+03, overlap shift 1.5259e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.423046757416       residual = 8.59e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.423046761473       residual = 3.14e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.423046767824       residual = 1.11e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.423046770385       residual = 9.78e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.423046775250       residual = 1.16e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.423046779672       residual = 8.36e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.423046781165       residual = 3.05e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.423046781746       residual = 1.41e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.423046782032       residual = 2.72e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.423046782017       residual = 1.79e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -22.423046781858       residual = 4.19e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -22.423046781823       residual = 7.02e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.5259e+03 is 1.417786e-06

solving harmonic davidson linear method for identity shift 6.1035e+03, overlap shift 6.1035e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.423046757416       residual = 8.59e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.423046758430       residual = 3.14e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.423046760018       residual = 1.11e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.423046760658       residual = 9.78e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.423046761875       residual = 1.16e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.423046762974       residual = 8.35e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.423046763350       residual = 3.05e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.423046763497       residual = 1.40e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.423046763588       residual = 2.72e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.423046763562       residual = 1.79e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -22.423046763530       residual = 4.19e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -22.423046763521       residual = 7.02e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 6.1035e+03 is 3.544451e-07

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.206239 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 6.5029e+01
  </log>
  <optVariables href="FORMP2PJWARM.s019.opt.xml">
 uu_0                 2.638263e-01 1 1  ON 0
 uu_1                 9.183402e-02 1 1  ON 1
 uu_2                -1.754390e-02 1 1  ON 2
 uu_3                -7.728990e-02 1 1  ON 3
 uu_4                -1.043988e-01 1 1  ON 4
 uu_5                -1.106449e-01 1 1  ON 5
 uu_6                -9.922595e-02 1 1  ON 6
 uu_7                -6.666419e-02 1 1  ON 7
 uu_8                -1.407216e-02 1 1  ON 8
 uu_9                 4.648178e-02 1 1  ON 9
 ud_0                 4.010920e-01 1 1  ON 10
 ud_1                 1.218468e-01 1 1  ON 11
 ud_2                -1.883588e-02 1 1  ON 12
 ud_3                -8.919491e-02 1 1  ON 13
 ud_4                -1.214336e-01 1 1  ON 14
 ud_5                -1.322458e-01 1 1  ON 15
 ud_6                -1.247043e-01 1 1  ON 16
 ud_7                -9.444767e-02 1 1  ON 17
 ud_8                -4.492664e-02 1 1  ON 18
 ud_9                 2.488849e-02 1 1  ON 19
 eC_0                -4.408289e-01 1 1  ON 20
 eC_1                -2.799006e-01 1 1  ON 21
 eC_2                -7.737808e-03 1 1  ON 22
 eC_3                 1.692663e-01 1 1  ON 23
 eC_4                 2.431763e-01 1 1  ON 24
 eC_5                 2.345607e-01 1 1  ON 25
 eC_6                 6.327656e-02 1 1  ON 26
 eC_7                 1.207270e-02 1 1  ON 27
 eC_8                 3.480056e-03 1 1  ON 28
 eC_9                 1.930514e-03 1 1  ON 29
 eO_0                -8.300239e-01 1 1  ON 30
 eO_1                -4.611839e-01 1 1  ON 31
 eO_2                -9.540573e-03 1 1  ON 32
 eO_3                 2.427271e-01 1 1  ON 33
 eO_4                 3.624818e-01 1 1  ON 34
 eO_5                 3.704152e-01 1 1  ON 35
 eO_6                 2.403330e-01 1 1  ON 36
 eO_7                 7.127929e-02 1 1  ON 37
 eO_8                -1.135440e-03 1 1  ON 38
 eO_9                 7.348709e-03 1 1  ON 39
eH1_0                -1.164281e-01 1 1  ON 40
eH1_1                -1.770295e-02 1 1  ON 41
eH1_2                 2.426672e-03 1 1  ON 42
eH1_3                -7.152856e-03 1 1  ON 43
eH1_4                 1.698705e-02 1 1  ON 44
eH1_5                 1.017783e-02 1 1  ON 45
eH1_6                 2.296837e-02 1 1  ON 46
eH1_7                 5.244685e-02 1 1  ON 47
eH1_8                 2.420836e-02 1 1  ON 48
eH1_9                 8.251071e-03 1 1  ON 49
eH2_0                -1.185419e-01 1 1  ON 50
eH2_1                -1.956248e-02 1 1  ON 51
eH2_2                 7.761544e-05 1 1  ON 52
eH2_3                -7.863708e-03 1 1  ON 53
eH2_4                 1.655927e-02 1 1  ON 54
eH2_5                 8.430516e-03 1 1  ON 55
eH2_6                 2.276901e-02 1 1  ON 56
eH2_7                 5.698352e-02 1 1  ON 57
eH2_8                 3.065784e-02 1 1  ON 58
eH2_9                 8.843028e-03 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 19
    time step          = 0.05
    reference energy   = -22.3658
    reference variance = 0.404298
====================================================
  Execution time = 4.8482e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORMP2PJWARM.s019
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2422e+01
  VMC Evar = 5.8302e-01
  Total weights = 2.0000e+06
  Execution time = 4.5332e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.583053040588
                                         uncertainty =       0.012340941108

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.583053040588
                                         uncertainty =       0.012340941108

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000539917857
  error estimate for blocks of size 2^( 2) =       0.000562093104
  error estimate for blocks of size 2^( 3) =       0.000583286306
  error estimate for blocks of size 2^( 4) =       0.000599823220
  error estimate for blocks of size 2^( 5) =       0.000610749074
  error estimate for blocks of size 2^( 6) =       0.000615065852
  error estimate for blocks of size 2^( 7) =       0.000619139828

      target function =                  N/A
              le_mean =     -22.422181544006
             les_mean =     503.337247484479
             stat err =       0.000611194494
             autocorr =       1.281455365543
              std dev =       0.763559155294
             le_variance =       0.583022583634

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.583052035494
                                         uncertainty =       0.012340919050

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.583052035494
                                         uncertainty =       0.012340919050

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000539917391
  error estimate for blocks of size 2^( 2) =       0.000562092585
  error estimate for blocks of size 2^( 3) =       0.000583285725
  error estimate for blocks of size 2^( 4) =       0.000599822577
  error estimate for blocks of size 2^( 5) =       0.000610748356
  error estimate for blocks of size 2^( 6) =       0.000615065127
  error estimate for blocks of size 2^( 7) =       0.000619139038

      target function =                  N/A
              le_mean =     -22.422181548148
             les_mean =     503.337246664216
             stat err =       0.000611193774
             autocorr =       1.281454561234
              std dev =       0.763558496517
             le_variance =       0.583021577604

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.583052538264
                                         uncertainty =       0.012340930090

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.583052538264
                                         uncertainty =       0.012340930090

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000539917624
  error estimate for blocks of size 2^( 2) =       0.000562092845
  error estimate for blocks of size 2^( 3) =       0.000583286016
  error estimate for blocks of size 2^( 4) =       0.000599822899
  error estimate for blocks of size 2^( 5) =       0.000610748715
  error estimate for blocks of size 2^( 6) =       0.000615065490
  error estimate for blocks of size 2^( 7) =       0.000619139433

      target function =                  N/A
              le_mean =     -22.422181546077
             les_mean =     503.337247074554
             stat err =       0.000611194134
             autocorr =       1.281454963178
              std dev =       0.763558826051
             le_variance =       0.583022080841

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.583052977803
                                         uncertainty =       0.012340939731

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.583052977803
                                         uncertainty =       0.012340939731

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000539917827
  error estimate for blocks of size 2^( 2) =       0.000562093071
  error estimate for blocks of size 2^( 3) =       0.000583286270
  error estimate for blocks of size 2^( 4) =       0.000599823180
  error estimate for blocks of size 2^( 5) =       0.000610749029
  error estimate for blocks of size 2^( 6) =       0.000615065807
  error estimate for blocks of size 2^( 7) =       0.000619139778

      target function =                  N/A
              le_mean =     -22.422181544264
             les_mean =     503.337247433230
             stat err =       0.000611194449
             autocorr =       1.281455315247
              std dev =       0.763559114142
             le_variance =       0.583022520790


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.422181544006        initial
     3.8147e+02     3.8147e+03             5.6712e-06       -22.422181548148  <--
     1.5259e+03     1.5259e+04             1.4178e-06       -22.422181546077
     6.1035e+03     6.1035e+04             3.5445e-07       -22.422181544264

*****************************************************************************
Applying the update for shift_i =   3.8147e+02     and shift_s =   3.8147e+03
*****************************************************************************

  Execution time = 7.1103e+01
  </log>
  <optVariables href="FORMP2PJWARM.s019.opt.xml">
 uu_0                 2.638267e-01 1 1  ON 0
 uu_1                 9.183400e-02 1 1  ON 1
 uu_2                -1.754333e-02 1 1  ON 2
 uu_3                -7.728951e-02 1 1  ON 3
 uu_4                -1.043984e-01 1 1  ON 4
 uu_5                -1.106448e-01 1 1  ON 5
 uu_6                -9.922637e-02 1 1  ON 6
 uu_7                -6.666519e-02 1 1  ON 7
 uu_8                -1.407463e-02 1 1  ON 8
 uu_9                 4.648129e-02 1 1  ON 9
 ud_0                 4.010927e-01 1 1  ON 10
 ud_1                 1.218468e-01 1 1  ON 11
 ud_2                -1.883507e-02 1 1  ON 12
 ud_3                -8.919454e-02 1 1  ON 13
 ud_4                -1.214331e-01 1 1  ON 14
 ud_5                -1.322457e-01 1 1  ON 15
 ud_6                -1.247046e-01 1 1  ON 16
 ud_7                -9.444873e-02 1 1  ON 17
 ud_8                -4.492859e-02 1 1  ON 18
 ud_9                 2.488735e-02 1 1  ON 19
 eC_0                -4.408284e-01 1 1  ON 20
 eC_1                -2.799021e-01 1 1  ON 21
 eC_2                -7.739764e-03 1 1  ON 22
 eC_3                 1.692635e-01 1 1  ON 23
 eC_4                 2.431748e-01 1 1  ON 24
 eC_5                 2.345634e-01 1 1  ON 25
 eC_6                 6.327989e-02 1 1  ON 26
 eC_7                 1.207365e-02 1 1  ON 27
 eC_8                 3.480190e-03 1 1  ON 28
 eC_9                 1.930585e-03 1 1  ON 29
 eO_0                -8.300249e-01 1 1  ON 30
 eO_1                -4.611859e-01 1 1  ON 31
 eO_2                -9.543925e-03 1 1  ON 32
 eO_3                 2.427242e-01 1 1  ON 33
 eO_4                 3.624809e-01 1 1  ON 34
 eO_5                 3.704161e-01 1 1  ON 35
 eO_6                 2.403369e-01 1 1  ON 36
 eO_7                 7.128354e-02 1 1  ON 37
 eO_8                -1.134719e-03 1 1  ON 38
 eO_9                 7.348956e-03 1 1  ON 39
eH1_0                -1.164281e-01 1 1  ON 40
eH1_1                -1.770337e-02 1 1  ON 41
eH1_2                 2.426150e-03 1 1  ON 42
eH1_3                -7.153142e-03 1 1  ON 43
eH1_4                 1.698692e-02 1 1  ON 44
eH1_5                 1.017787e-02 1 1  ON 45
eH1_6                 2.296840e-02 1 1  ON 46
eH1_7                 5.244638e-02 1 1  ON 47
eH1_8                 2.420967e-02 1 1  ON 48
eH1_9                 8.251511e-03 1 1  ON 49
eH2_0                -1.185420e-01 1 1  ON 50
eH2_1                -1.956287e-02 1 1  ON 51
eH2_2                 7.746214e-05 1 1  ON 52
eH2_3                -7.863985e-03 1 1  ON 53
eH2_4                 1.655877e-02 1 1  ON 54
eH2_5                 8.431244e-03 1 1  ON 55
eH2_6                 2.276878e-02 1 1  ON 56
eH2_7                 5.698273e-02 1 1  ON 57
eH2_8                 3.065903e-02 1 1  ON 58
eH2_9                 8.843443e-03 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.3614e+02 secs
  Total Execution time = 2.7390e+03 secs

=========================================================
  A new xml input file : FORMP2PJWARM.s019.cont.xml
