Rank =    0  Free Memory = 91178 MB
Rank =    1  Free Memory = 91178 MB
Rank =    2  Free Memory = 91177 MB
Rank =    3  Free Memory = 91177 MB
Rank =    4  Free Memory = 91177 MB
Rank =    5  Free Memory = 91176 MB
Rank =    6  Free Memory = 91176 MB
Rank =    7  Free Memory = 91176 MB
Rank =    8  Free Memory = 91175 MB
Rank =    9  Free Memory = 91175 MB
Rank =   10  Free Memory = 91175 MB
Rank =   11  Free Memory = 91175 MB
Rank =   12  Free Memory = 91175 MB
Rank =   13  Free Memory = 91175 MB
Rank =   14  Free Memory = 91175 MB
Rank =   15  Free Memory = 91163 MB
Rank =   16  Free Memory = 91160 MB
Rank =   17  Free Memory = 91160 MB
Rank =   18  Free Memory = 91160 MB
Rank =   19  Free Memory = 91160 MB
Rank =   20  Free Memory = 91160 MB
Rank =   21  Free Memory = 91160 MB
Rank =   22  Free Memory = 91160 MB
Rank =   23  Free Memory = 91160 MB
Rank =   24  Free Memory = 91160 MB
Rank =   25  Free Memory = 91160 MB
Rank =   26  Free Memory = 91160 MB
Rank =   27  Free Memory = 91160 MB
Rank =   28  Free Memory = 91160 MB
Rank =   29  Free Memory = 91160 MB
Rank =   30  Free Memory = 91160 MB
Rank =   31  Free Memory = 91160 MB
Rank =   32  Free Memory = 74805 MB
Rank =   33  Free Memory = 74805 MB
Rank =   34  Free Memory = 74805 MB
Rank =   35  Free Memory = 74805 MB
Rank =   36  Free Memory = 74805 MB
Rank =   37  Free Memory = 74805 MB
Rank =   38  Free Memory = 74805 MB
Rank =   39  Free Memory = 74805 MB
Rank =   40  Free Memory = 74805 MB
Rank =   41  Free Memory = 74805 MB
Rank =   42  Free Memory = 74805 MB
Rank =   43  Free Memory = 74805 MB
Rank =   44  Free Memory = 74805 MB
Rank =   45  Free Memory = 74805 MB
Rank =   46  Free Memory = 74805 MB
Rank =   47  Free Memory = 74805 MB
Rank =   48  Free Memory = 74805 MB
Rank =   49  Free Memory = 74805 MB
Rank =   50  Free Memory = 74805 MB
Rank =   51  Free Memory = 74805 MB
Rank =   52  Free Memory = 74805 MB
Rank =   53  Free Memory = 74805 MB
Rank =   54  Free Memory = 74805 MB
Rank =   55  Free Memory = 74805 MB
Rank =   56  Free Memory = 74805 MB
Rank =   57  Free Memory = 74805 MB
Rank =   58  Free Memory = 74805 MB
Rank =   59  Free Memory = 74805 MB
Rank =   60  Free Memory = 74805 MB
Rank =   61  Free Memory = 74805 MB
Rank =   62  Free Memory = 74805 MB
Rank =   63  Free Memory = 74805 MB
Rank =   64  Free Memory = 57766 MB
Rank =   65  Free Memory = 57766 MB
Rank =   66  Free Memory = 57766 MB
Rank =   67  Free Memory = 57766 MB
Rank =   68  Free Memory = 57766 MB
Rank =   69  Free Memory = 57766 MB
Rank =   70  Free Memory = 57766 MB
Rank =   71  Free Memory = 57766 MB
Rank =   72  Free Memory = 57766 MB
Rank =   73  Free Memory = 57766 MB
Rank =   74  Free Memory = 57766 MB
Rank =   75  Free Memory = 57766 MB
Rank =   76  Free Memory = 57766 MB
Rank =   77  Free Memory = 57766 MB
Rank =   78  Free Memory = 57766 MB
Rank =   79  Free Memory = 57766 MB
Rank =   80  Free Memory = 57766 MB
Rank =   81  Free Memory = 57766 MB
Rank =   82  Free Memory = 57766 MB
Rank =   83  Free Memory = 57766 MB
Rank =   84  Free Memory = 57766 MB
Rank =   85  Free Memory = 57765 MB
Rank =   86  Free Memory = 57765 MB
Rank =   87  Free Memory = 57765 MB
Rank =   88  Free Memory = 57765 MB
Rank =   89  Free Memory = 57765 MB
Rank =   90  Free Memory = 57765 MB
Rank =   91  Free Memory = 57765 MB
Rank =   92  Free Memory = 57765 MB
Rank =   93  Free Memory = 57765 MB
Rank =   94  Free Memory = 57765 MB
Rank =   95  Free Memory = 57765 MB
Rank =   96  Free Memory = 57765 MB
Rank =   97  Free Memory = 57765 MB
Rank =   98  Free Memory = 57765 MB
Rank =   99  Free Memory = 57765 MB
Rank =  100  Free Memory = 57765 MB
Rank =  101  Free Memory = 57765 MB
Rank =  102  Free Memory = 57765 MB
Rank =  103  Free Memory = 57765 MB
Rank =  104  Free Memory = 70667 MB
Rank =  105  Free Memory = 70667 MB
Rank =  106  Free Memory = 70667 MB
Rank =  107  Free Memory = 70667 MB
Rank =  108  Free Memory = 70667 MB
Rank =  109  Free Memory = 70667 MB
Rank =  110  Free Memory = 70667 MB
Rank =  111  Free Memory = 70667 MB
Rank =  112  Free Memory = 70667 MB
Rank =  113  Free Memory = 70667 MB
Rank =  114  Free Memory = 70667 MB
Rank =  115  Free Memory = 70667 MB
Rank =  116  Free Memory = 70667 MB
Rank =  117  Free Memory = 70667 MB
Rank =  118  Free Memory = 70667 MB
Rank =  119  Free Memory = 70667 MB
Rank =  120  Free Memory = 70667 MB
Rank =  121  Free Memory = 70667 MB
Rank =  122  Free Memory = 70667 MB
Rank =  123  Free Memory = 70667 MB
Rank =  124  Free Memory = 70667 MB
Rank =  125  Free Memory = 70667 MB
  Input file(s): opt_form_gs_lmtt_run002c.xml 
Rank =  126  Free Memory = 70667 MB
Rank =  127  Free Memory = 70667 MB

=====================================================
                    QMCPACK 3.7.9

       (c) Copyright 2003-  QMCPACK developers

                    Please cite:
 J. Kim et al. J. Phys. Cond. Mat. 30 195901 (2018)
      https://doi.org/10.1088/1361-648X/aab9c3

  Git branch: gvp
  Last git commit: 02b8462cd86e2c45b012131e3a811aee79855b67-dirty
  Last git commit date: Mon Oct 24 16:30:05 2022 -0700
  Last git commit subject: Merge commit 59872d0bcea460ceb08aa7832e89b700ee19b55f into gvp
=====================================================
  Global options 

  Total number of MPI ranks = 128
  Number of MPI groups      = 1
  MPI group ID              = 0
  Number of ranks in group  = 128
  MPI ranks per node        = 32
  OMP 1st level threads     = 1
  OMP nested threading disabled or only 1 thread on the 2nd level

  Precision used in this calculation, see definitions in the manual:
  Base precision      = double
  Full precision      = double

  Structure-of-arrays (SoA) optimization enabled

  Input XML = opt_form_gs_lmtt_run002c.xml

  Project = FORM
  date    = 2023-02-07 15:19:22 PST
  host    = n0011.savio3

 Random Number
 -------------
  Offset for the random number seeds based on time: 122

  Range of prime numbers to use as seeds over processors and threads = 683-1601


 Particle Set 
 ------------
  Name: e
  All the species have the same mass 1
  Particle set size: 12

 Particle Set 
 ------------
  Name: ion0
  All the species have the same mass 1
  Particle set size: 4

 Wavefunction setup: 
 ------------------- 
  Name: psi0

   Jastrow
   -------
    Name: J2   Type: Two-Body   Function: Bspline

    Radial function for species: u - u
     Number of parameters: 10
     Cusp: -0.25
     Cutoff radius: 10

     Name                        Value Type Recompute Use Index
     ---- ---------------------------- ---- --------- --- -----
     uu_0                 2.534196e-01    1         1 OFF
     uu_1                 8.187228e-02    1         1 OFF
     uu_2                -2.275242e-02    1         1 OFF
     uu_3                -7.828085e-02    1         1 OFF
     uu_4                -1.012281e-01    1         1 OFF
     uu_5                -1.043850e-01    1         1 OFF
     uu_6                -9.225148e-02    1         1 OFF
     uu_7                -6.069684e-02    1         1 OFF
     uu_8                -1.052881e-02    1         1 OFF
     uu_9                 4.845842e-02    1         1 OFF

    Radial function for species: u - d
     Number of parameters: 10
     Cusp: -5.000000e-01
     Cutoff radius: 1.000000e+01

     Name                        Value Type Recompute Use Index
     ---- ---------------------------- ---- --------- --- -----
     ud_0                 3.799971e-01    1         1 OFF
     ud_1                 1.046499e-01    1         1 OFF
     ud_2                -2.771780e-02    1         1 OFF
     ud_3                -9.219840e-02    1         1 OFF
     ud_4                -1.209376e-01    1         1 OFF
     ud_5                -1.275224e-01    1         1 OFF
     ud_6                -1.165844e-01    1         1 OFF
     ud_7                -8.423038e-02    1         1 OFF
     ud_8                -3.239087e-02    1         1 OFF
     ud_9                 3.370246e-02    1         1 OFF


   Jastrow
   -------
    Name: J1   Type: One-Body   Function: Bspline

    Radial function for element: C
     Number of parameters: 10
     Cusp: 0.000000e+00
     Cutoff radius: 1.000000e+01

     Name                        Value Type Recompute Use Index
     ---- ---------------------------- ---- --------- --- -----
     eC_0                -3.999855e-01    1         1 OFF
     eC_1                -2.498990e-01    1         1 OFF
     eC_2                 3.490505e-03    1         1 OFF
     eC_3                 1.569873e-01    1         1 OFF
     eC_4                 1.937241e-01    1         1 OFF
     eC_5                 1.909108e-01    1         1 OFF
     eC_6                 7.780258e-02    1         1 OFF
     eC_7                 2.053700e-02    1         1 OFF
     eC_8                 3.721676e-03    1         1 OFF
     eC_9                 1.954518e-03    1         1 OFF

    Radial function for element: O
     Number of parameters: 10
     Cusp: 0.000000e+00
     Cutoff radius: 1.000000e+01

     Name                        Value Type Recompute Use Index
     ---- ---------------------------- ---- --------- --- -----
     eO_0                -7.811229e-01    1         1 OFF
     eO_1                -4.363078e-01    1         1 OFF
     eO_2                -2.444857e-02    1         1 OFF
     eO_3                 2.276114e-01    1         1 OFF
     eO_4                 3.261821e-01    1         1 OFF
     eO_5                 3.434507e-01    1         1 OFF
     eO_6                 2.386071e-01    1         1 OFF
     eO_7                 8.692309e-02    1         1 OFF
     eO_8                 2.545572e-03    1         1 OFF
     eO_9                 8.205743e-03    1         1 OFF

    Radial function for element: H1
     Number of parameters: 10
     Cusp: 0.000000e+00
     Cutoff radius: 1.000000e+01

      Name                        Value Type Recompute Use Index
     ----- ---------------------------- ---- --------- --- -----
     eH1_0                -9.754690e-02    1         1 OFF
     eH1_1                -1.618070e-02    1         1 OFF
     eH1_2                 3.264367e-03    1         1 OFF
     eH1_3                -1.234601e-02    1         1 OFF
     eH1_4                 6.385266e-03    1         1 OFF
     eH1_5                 1.475235e-02    1         1 OFF
     eH1_6                 3.538953e-02    1         1 OFF
     eH1_7                 3.905609e-02    1         1 OFF
     eH1_8                 2.047949e-02    1         1 OFF
     eH1_9                 5.154311e-03    1         1 OFF

    Radial function for element: H2
     Number of parameters: 10
     Cusp: 0.000000e+00
     Cutoff radius: 1.000000e+01

      Name                        Value Type Recompute Use Index
     ----- ---------------------------- ---- --------- --- -----
     eH2_0                -9.801842e-02    1         1 OFF
     eH2_1                -1.558700e-02    1         1 OFF
     eH2_2                 3.971294e-03    1         1 OFF
     eH2_3                -1.199441e-02    1         1 OFF
     eH2_4                 6.952834e-03    1         1 OFF
     eH2_5                 1.581570e-02    1         1 OFF
     eH2_6                 3.509343e-02    1         1 OFF
     eH2_7                 3.686799e-02    1         1 OFF
     eH2_8                 2.112069e-02    1         1 OFF
     eH2_9                 4.281832e-03    1         1 OFF

  Created SPOSet builder named 'LCAOBSet' of type molecularorbital
  LCAO: SoaAtomicBasisSet<MultiQuintic,0>
  AO BasisSet for C
   Angular momentum expanded in cartesian functions x^lx y^ly z^lz according to Gamess
Using log grid with default values: ri = 1.000000e-06 rf = 1.000000e+02 npts = 1001
   R(n,l,m,s) 0 0 0 0
   R(n,l,m,s) 1 0 0 0
   R(n,l,m,s) 2 1 0 0
   R(n,l,m,s) 3 1 0 0
   R(n,l,m,s) 4 2 0 0
Expanding Ylm (angular function) according to Gamess using cartesian gaussians
Adding 1 cartesian gaussian orbitals for l= 0
Adding 1 cartesian gaussian orbitals for l= 0
Adding 3 cartesian gaussian orbitals for l= 1
Adding 3 cartesian gaussian orbitals for l= 1
Adding 6 cartesian gaussian orbitals for l= 2
  Setting cutoff radius 1.270574e+01

   Maximum Angular Momentum  = 2
   Number of Radial functors = 5
   Basis size                = 14

  AO BasisSet for O
   Angular momentum expanded in cartesian functions x^lx y^ly z^lz according to Gamess
Using log grid with default values: ri = 1.000000e-06 rf = 1.000000e+02 npts = 1001
   R(n,l,m,s) 0 0 0 0
   R(n,l,m,s) 1 0 0 0
   R(n,l,m,s) 2 1 0 0
   R(n,l,m,s) 3 1 0 0
   R(n,l,m,s) 4 2 0 0
Expanding Ylm (angular function) according to Gamess using cartesian gaussians
Adding 1 cartesian gaussian orbitals for l= 0
Adding 1 cartesian gaussian orbitals for l= 0
Adding 3 cartesian gaussian orbitals for l= 1
Adding 3 cartesian gaussian orbitals for l= 1
Adding 6 cartesian gaussian orbitals for l= 2
  Setting cutoff radius 1.018591e+01

   Maximum Angular Momentum  = 2
   Number of Radial functors = 5
   Basis size                = 14

  AO BasisSet for H1
   Angular momentum expanded in cartesian functions x^lx y^ly z^lz according to Gamess
Using log grid with default values: ri = 1.000000e-06 rf = 1.000000e+02 npts = 1001
   R(n,l,m,s) 0 0 0 0
   R(n,l,m,s) 1 0 0 0
   R(n,l,m,s) 2 1 0 0
Expanding Ylm (angular function) according to Gamess using cartesian gaussians
Adding 1 cartesian gaussian orbitals for l= 0
Adding 1 cartesian gaussian orbitals for l= 0
Adding 3 cartesian gaussian orbitals for l= 1
  Setting cutoff radius 1.270574e+01

   Maximum Angular Momentum  = 1
   Number of Radial functors = 3
   Basis size                = 5

  AO BasisSet for H2
   Angular momentum expanded in cartesian functions x^lx y^ly z^lz according to Gamess
Using log grid with default values: ri = 1.000000e-06 rf = 1.000000e+02 npts = 1001
   R(n,l,m,s) 0 0 0 0
   R(n,l,m,s) 1 0 0 0
   R(n,l,m,s) 2 1 0 0
Expanding Ylm (angular function) according to Gamess using cartesian gaussians
Adding 1 cartesian gaussian orbitals for l= 0
Adding 1 cartesian gaussian orbitals for l= 0
Adding 3 cartesian gaussian orbitals for l= 1
  Setting cutoff radius 1.270574e+01

   Maximum Angular Momentum  = 1
   Number of Radial functors = 3
   Basis size                = 5

Creating SPOSet in SlaterDetBuilder::put(xmlNodePtr cur).
spo_name = spo-up
  Building SPOSet 'spo-up' with '' basis set.
Creating SPOSet in SlaterDetBuilder::put(xmlNodePtr cur).
spo_name = spo-dn
  Building SPOSet 'spo-dn' with '' basis set.
Using Bryan's algorithm for MultiSlaterDeterminant expansion. 
Creating base determinant (up) for MSD expansion. 
Creating base determinant (down) for MSD expansion. 
Found determinant list. 
Reading CI expansion.
Found 70 terms in the MSD expansion.
Norm of ci vector (sum of ci^2): 9.773909e-01
Norm of qchem ci vector (sum of qchem_ci^2): 0.000000e+00
Found 20 unique up determinants.
Found 20 unique down determinants.
Number of terms in pairs array: 12
Number of terms in pairs array: 12
CI coefficients are optimizable. 
  FermionWF = MultiSlaterDeterminantFast
  QMCHamiltonian::addOperator Kinetic to H, physical Hamiltonian 
  QMCHamiltonian::addOperator ElecElec to H, physical Hamiltonian 
QMCHamiltonian::addOperatorType added type coulomb named ElecElec

  ECPotential builder for pseudopotential 

  Adding pseudopotential for C
   Linear grid  ri=0.000000e+00 rf=1.000000e+01 npts = 10001
    ECPComponentBuilder::buildSemiLocalAndLocal 
    Assuming Hartree unit
   Number of angular momentum channels 2
   Maximum angular momentum channel 1
   Creating a Linear Grid Rmax=1.405000e+00
  Using global grid with delta = 1.000000e-03
   Making L=1 a local potential with a radial cutoff of 9.999000e+00
    Non-local pseudopotential parameters
    Maximum angular mementum = 0
    Number of non-local channels = 1
       l(0)=0
    Cutoff radius = 1.405000e+00
    Spherical grids and weights: 
         1.0000000000e+00  0.0000000000e+00  0.0000000000e+00    8.3333333333e-02
        -1.0000000000e+00  1.2246467991e-16  0.0000000000e+00    8.3333333333e-02
         4.4721359550e-01  8.9442719100e-01  0.0000000000e+00    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -8.9442719100e-01  1.0953573965e-16    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
    Maximum cutoff radius 1.4050000000e+00

  Adding pseudopotential for O
   Linear grid  ri=0.0000000000e+00 rf=1.0000000000e+01 npts = 10001
    ECPComponentBuilder::buildSemiLocalAndLocal 
    Assuming Hartree unit
   Number of angular momentum channels 2
   Maximum angular momentum channel 1
   Creating a Linear Grid Rmax=1.0750000000e+00
  Using global grid with delta = 1.0000000000e-03
   Making L=1 a local potential with a radial cutoff of 9.9990000000e+00
    Non-local pseudopotential parameters
    Maximum angular mementum = 0
    Number of non-local channels = 1
       l(0)=0
    Cutoff radius = 1.0750000000e+00
    Spherical grids and weights: 
         1.0000000000e+00  0.0000000000e+00  0.0000000000e+00    8.3333333333e-02
        -1.0000000000e+00  1.2246467991e-16  0.0000000000e+00    8.3333333333e-02
         4.4721359550e-01  8.9442719100e-01  0.0000000000e+00    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -8.9442719100e-01  1.0953573965e-16    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
    Maximum cutoff radius 1.0750000000e+00

  Adding pseudopotential for H1
   Linear grid  ri=0.0000000000e+00 rf=1.0000000000e+01 npts = 10001
    ECPComponentBuilder::buildSemiLocalAndLocal 
    Assuming Hartree unit
   Number of angular momentum channels 2
   Maximum angular momentum channel 1
   Creating a Linear Grid Rmax=1.0000000000e-10
  Using global grid with delta = 1.0000000000e-03
   Making L=1 a local potential with a radial cutoff of 9.9990000000e+00
    Non-local pseudopotential parameters
    Maximum angular mementum = 0
    Number of non-local channels = 1
       l(0)=0
    Cutoff radius = 1.0000000000e-03
    Spherical grids and weights: 
         1.0000000000e+00  0.0000000000e+00  0.0000000000e+00    8.3333333333e-02
        -1.0000000000e+00  1.2246467991e-16  0.0000000000e+00    8.3333333333e-02
         4.4721359550e-01  8.9442719100e-01  0.0000000000e+00    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -8.9442719100e-01  1.0953573965e-16    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
    Maximum cutoff radius 1.0000000000e-03

  Adding pseudopotential for H2
   Linear grid  ri=0.0000000000e+00 rf=1.0000000000e+01 npts = 10001
    ECPComponentBuilder::buildSemiLocalAndLocal 
    Assuming Hartree unit
   Number of angular momentum channels 2
   Maximum angular momentum channel 1
   Creating a Linear Grid Rmax=1.0000000000e-10
  Using global grid with delta = 1.0000000000e-03
   Making L=1 a local potential with a radial cutoff of 9.9990000000e+00
    Non-local pseudopotential parameters
    Maximum angular mementum = 0
    Number of non-local channels = 1
       l(0)=0
    Cutoff radius = 1.0000000000e-03
    Spherical grids and weights: 
         1.0000000000e+00  0.0000000000e+00  0.0000000000e+00    8.3333333333e-02
        -1.0000000000e+00  1.2246467991e-16  0.0000000000e+00    8.3333333333e-02
         4.4721359550e-01  8.9442719100e-01  0.0000000000e+00    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -8.9442719100e-01  1.0953573965e-16    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
    Maximum cutoff radius 1.0000000000e-03
  QMCHamiltonian::addOperator LocalECP to H, physical Hamiltonian 

  Using NonLocalECP potential 
    Maximum grid on a sphere for NonLocalECPotential: 12
  QMCHamiltonian::addOperator NonLocalECP to H, physical Hamiltonian 
QMCHamiltonian::addOperatorType added type pseudo named NonLocalECP
  QMCHamiltonian::addOperator IonIon to H, physical Hamiltonian 
QMCHamiltonian::addOperatorType added type coulomb named IonIon

  QMCHamiltonian::add2WalkerProperty added
    5 to P::PropertyList 
    0 to P::Collectables 
    starting Index of the observables in P::PropertyList = 10
ParticleSetPool::randomize 
  Initialization Execution time = 2.4320e-01 secs
=========================================================
 Summary of QMC systems 
=========================================================
ParticleSetPool has: 

  ParticleSet 'e' contains 12 particles :  u(6) d(6)

    u  1.0776882035e+00  1.1858078688e-01 -1.1228966320e+00
    u  5.2623637829e-01  1.7541589896e-01 -1.3337143393e+00
    u -2.1907738776e-01  1.2604145828e+00  7.3980442540e-01
    u  5.1104917034e-03  1.4830329441e-01  1.8508537617e+00
    u  2.0319189978e-01  5.3211297520e-02  1.1096632188e+00
    u -7.1114543523e-01  2.3194667600e+00 -1.9120363364e+00
    d  4.5386831405e-01  7.4543549121e-01 -1.7781369559e+00
    d -5.3250436761e-01  5.6773482298e-01 -1.4296151151e+00
    d -8.5149149983e-02 -4.7335234687e-01  1.2151269463e+00
    d -1.3341711209e-02  5.3976693736e-01  8.3781480332e-01
    (... and 2 more particle positions ...)

  Distance table for similar particles (A-A):
    source/target: e
    Using structure-of-arrays (SoA) data layout
    Distance computations use open boundary conditions in 3D.

  Distance table for dissimilar particles (A-B):
    source: ion0  target: e
    Using structure-of-arrays (SoA) data layout
    Distance computations use open boundary conditions in 3D.


  ParticleSet 'ion0' contains 4 particles :  C(1) O(1) H1(1) H2(1)

    C  0.0000000000e+00  0.0000000000e+00 -1.1394765782e+00
    O  0.0000000000e+00  0.0000000000e+00  1.1440287480e+00
    H1  0.0000000000e+00  1.7662761033e+00 -2.2339863698e+00
    H2  0.0000000000e+00 -1.7662761033e+00 -2.2339863698e+00

  Distance table for similar particles (A-A):
    source/target: ion0
    Using structure-of-arrays (SoA) data layout
    Distance computations use open boundary conditions in 3D.


  Hamiltonian h0
  Kinetic         Kinetic energy
  ElecElec        CoulombAA source/target e

  LocalECP        LocalECPotential: ion0
  NonLocalECP     NonLocalECPotential: ion0
  IonIon          CoulombAA source/target ion0


Loop execution max-interations = 20
Inside LM engine constructor, num_params is: 0 and _total_num_params is: 0

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s000 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15
  Adding 1 walkers to 0 existing sets
  Total number of walkers: 1.2800000000e+02
  Total weight: 1.2800000000e+02

=========================================================
  Start VMC
  File Root FORM.s000 append = no 
=========================================================
Resetting walkers
  Using the current 1 walkers.
  Total number of walkers: 1.2800000000e+02
  Total weight: 1.2800000000e+02
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=0  my_counter=0
  time step      = 5.0000000000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000000000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625000000e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000000000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000000000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000000000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000000000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000000000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000000000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000000000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625000000e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000000000e-02</parameter>
<parameter name="time_step" condition="au">5.0000000000e-02</parameter>
<parameter name="timestep" condition="au">5.0000000000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
  Set drift_modifier UNR parameter a = 1.0000000000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000000000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: 0 and ratio_threshold_: 0.0000000000e+00
Allocating full size _hmat_temp and _smat_temp
Inside LM engine's get_param, num_params is: 69
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 0
    time step          = 0.05
    reference energy   = -22.7427
    reference variance = 0.332055
====================================================
  Execution time = 2.6213e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s000
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5336e+04
  VMC Eavg = -2.2819e+01
  VMC Evar = 4.8781e-01
  Total weights = 1.963422884e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.6605e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.473057079969
                                         uncertainty =       0.002325105543

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.473057079969
                                         uncertainty =       0.002325105543

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000486315550
  error estimate for blocks of size 2^( 2) =       0.000507669015
  error estimate for blocks of size 2^( 3) =       0.000527287977
  error estimate for blocks of size 2^( 4) =       0.000542631134
  error estimate for blocks of size 2^( 5) =       0.000553011994
  error estimate for blocks of size 2^( 6) =       0.000559127452
  error estimate for blocks of size 2^( 7) =       0.000563448793

      target function =                  N/A
              le_mean =     -22.818793629890
             les_mean =     521.185148730678
             stat err =       0.000554554843
             autocorr =       1.300327334897
              std dev =       0.687754046523
             le_variance =       0.473005628509


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy-2.281879362989e+01 
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.5000e-01, overlap shift 2.5000e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.818793629815       residual = 2.74e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.818833926678       residual = 9.44e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.818840597807       residual = 3.03e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.818840565921       residual = 5.76e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.5000e-01 is 2.490292e-03

solving harmonic davidson linear method for identity shift 1.0000e+00, overlap shift 1.0000e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.818793629815       residual = 2.74e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.818807865666       residual = 5.05e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.818809336498       residual = 8.25e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.818809426571       residual = 1.32e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.0000e+00 is 7.738100e-04

solving harmonic davidson linear method for identity shift 4.0000e+00, overlap shift 4.0000e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.818793629815       residual = 2.74e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.818797598650       residual = 4.78e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.818797926511       residual = 8.36e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.818797967416       residual = 1.41e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 4.0000e+00 is 2.060884e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.003669 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0886e+01
  </log>
  <optVariables href="FORM.s000.opt.xml">
ci_01 1.266572e-01                 3 1 ON  0
ci_02 -2.841354e-02                3 1 ON  1
ci_03 -2.819258e-02                3 1 ON  2
ci_04 2.584512e-02                 3 1 ON  3
ci_05 -2.372013e-02                3 1 ON  4
ci_06 -2.336222e-02                3 1 ON  5
ci_07 2.575813e-02                 3 1 ON  6
ci_08 -5.134613e-03                3 1 ON  7
ci_09 -1.161719e-02                3 1 ON  8
ci_10 -1.152274e-02                3 1 ON  9
ci_11 1.584957e-02                 3 1 ON  10
ci_12 1.063108e-02                 3 1 ON  11
ci_13 1.160273e-02                 3 1 ON  12
ci_14 1.504971e-02                 3 1 ON  13
ci_15 8.636846e-03                 3 1 ON  14
ci_16 8.358005e-03                 3 1 ON  15
ci_17 -9.871004e-03                3 1 ON  16
ci_18 -1.015278e-02                3 1 ON  17
ci_19 9.811676e-03                 3 1 ON  18
ci_20 1.069269e-02                 3 1 ON  19
ci_21 7.532897e-03                 3 1 ON  20
ci_22 9.079628e-03                 3 1 ON  21
ci_23 6.572672e-03                 3 1 ON  22
ci_24 6.362534e-03                 3 1 ON  23
ci_25 5.357567e-03                 3 1 ON  24
ci_26 3.450904e-03                 3 1 ON  25
ci_27 2.693010e-03                 3 1 ON  26
ci_28 4.429844e-03                 3 1 ON  27
ci_29 4.553471e-03                 3 1 ON  28
ci_30 -3.478372e-04                3 1 ON  29
ci_31 -5.864848e-04                3 1 ON  30
ci_32 -1.244401e-04                3 1 ON  31
ci_33 -3.848244e-04                3 1 ON  32
ci_34 3.404893e-04                 3 1 ON  33
ci_35 -1.583417e-04                3 1 ON  34
ci_36 -7.748095e-04                3 1 ON  35
ci_37 -9.097405e-04                3 1 ON  36
ci_38 -5.323710e-05                3 1 ON  37
ci_39 -4.219036e-04                3 1 ON  38
ci_40 -1.150212e-03                3 1 ON  39
ci_41 5.436744e-04                 3 1 ON  40
ci_42 1.901183e-04                 3 1 ON  41
ci_43 -2.267929e-03                3 1 ON  42
ci_44 -1.781479e-03                3 1 ON  43
ci_45 -3.977278e-04                3 1 ON  44
ci_46 -4.559614e-04                3 1 ON  45
ci_47 -1.385355e-03                3 1 ON  46
ci_48 -1.998057e-03                3 1 ON  47
ci_49 -1.599172e-03                3 1 ON  48
ci_50 -5.473329e-04                3 1 ON  49
ci_51 4.814009e-04                 3 1 ON  50
ci_52 2.694363e-06                 3 1 ON  51
ci_53 -8.829247e-04                3 1 ON  52
ci_54 -3.722690e-04                3 1 ON  53
ci_55 -8.024058e-04                3 1 ON  54
ci_56 1.617407e-03                 3 1 ON  55
ci_57 1.655977e-03                 3 1 ON  56
ci_58 -9.900968e-04                3 1 ON  57
ci_59 -1.100493e-03                3 1 ON  58
ci_60 1.366340e-03                 3 1 ON  59
ci_61 1.635122e-03                 3 1 ON  60
ci_62 -2.906218e-04                3 1 ON  61
ci_63 -7.607019e-05                3 1 ON  62
ci_64 -9.179199e-04                3 1 ON  63
ci_65 -2.203278e-04                3 1 ON  64
ci_66 -6.564796e-04                3 1 ON  65
ci_67 -5.642187e-04                3 1 ON  66
ci_68 -1.442822e-03                3 1 ON  67
ci_69 -1.675324e-03                3 1 ON  68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 0
    time step          = 0.05
    reference energy   = -22.7795
    reference variance = 0.456096
====================================================
  Execution time = 2.5513e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s000
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2819e+01
  VMC Evar = 4.8891e-01
  Total weights = 1.9638e+06
  Execution time = 3.5835e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.472470546635
                                         uncertainty =       0.002562314730

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.472470546635
                                         uncertainty =       0.002562314730

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000486043072
  error estimate for blocks of size 2^( 2) =       0.000506992433
  error estimate for blocks of size 2^( 3) =       0.000526959621
  error estimate for blocks of size 2^( 4) =       0.000543188661
  error estimate for blocks of size 2^( 5) =       0.000552928316
  error estimate for blocks of size 2^( 6) =       0.000558735826
  error estimate for blocks of size 2^( 7) =       0.000561261216

      target function =                  N/A
              le_mean =     -22.819291554918
             les_mean =     521.210009410762
             stat err =       0.000554028505
             autocorr =       1.299315755255
              std dev =       0.687368704830
             le_variance =       0.472475736379

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.471734554537
                                         uncertainty =       0.002400989661

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.471734554537
                                         uncertainty =       0.002400989661

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000485666674
  error estimate for blocks of size 2^( 2) =       0.000506654731
  error estimate for blocks of size 2^( 3) =       0.000526676292
  error estimate for blocks of size 2^( 4) =       0.000542964529
  error estimate for blocks of size 2^( 5) =       0.000552707313
  error estimate for blocks of size 2^( 6) =       0.000558485878
  error estimate for blocks of size 2^( 7) =       0.000561050038

      target function =                  N/A
              le_mean =     -22.819286319887
             les_mean =     521.550176059039
             stat err =       0.000553801939
             autocorr =       1.300266394423
              std dev =       0.686836396539
             le_variance =       0.471744235610

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.471781641207
                                         uncertainty =       0.002410186907

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.471781641207
                                         uncertainty =       0.002410186907

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000485690402
  error estimate for blocks of size 2^( 2) =       0.000506667347
  error estimate for blocks of size 2^( 3) =       0.000526672153
  error estimate for blocks of size 2^( 4) =       0.000542955479
  error estimate for blocks of size 2^( 5) =       0.000552708779
  error estimate for blocks of size 2^( 6) =       0.000558492853
  error estimate for blocks of size 2^( 7) =       0.000561048593

      target function =                  N/A
              le_mean =     -22.819284484806
             les_mean =     521.214543127851
             stat err =       0.000553801426
             autocorr =       1.300136937883
              std dev =       0.686869953444
             le_variance =       0.471790332945

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.472319390930
                                         uncertainty =       0.002519322434

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.472319390930
                                         uncertainty =       0.002519322434

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000485965654
  error estimate for blocks of size 2^( 2) =       0.000506919114
  error estimate for blocks of size 2^( 3) =       0.000526891703
  error estimate for blocks of size 2^( 4) =       0.000543129210
  error estimate for blocks of size 2^( 5) =       0.000552870867
  error estimate for blocks of size 2^( 6) =       0.000558673083
  error estimate for blocks of size 2^( 7) =       0.000561202350

      target function =                  N/A
              le_mean =     -22.819288256601
             les_mean =     521.208965896499
             stat err =       0.000553968878
             autocorr =       1.299450017968
              std dev =       0.687259219333
             le_variance =       0.472325234559


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.819291554918        initial  <--
     2.5000e-01     2.5000e+00             2.4903e-03       -22.819286319887
     1.0000e+00     1.0000e+01             7.7381e-04       -22.819284484806
     4.0000e+00     4.0000e+01             2.0609e-04       -22.819288256601

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 43.4569
  </log>
  <optVariables href="FORM.s000.opt.xml">
ci_01                 1.274310e-01 3 1  ON 0
ci_02                -2.884264e-02 3 1  ON 1
ci_03                -2.859435e-02 3 1  ON 2
ci_04                 2.613791e-02 3 1  ON 3
ci_05                -2.402287e-02 3 1  ON 4
ci_06                -2.362332e-02 3 1  ON 5
ci_07                 2.584734e-02 3 1  ON 6
ci_08                -5.199615e-03 3 1  ON 7
ci_09                -1.173903e-02 3 1  ON 8
ci_10                -1.143622e-02 3 1  ON 9
ci_11                 1.571622e-02 3 1  ON 10
ci_12                 1.061105e-02 3 1  ON 11
ci_13                 1.147656e-02 3 1  ON 12
ci_14                 1.483937e-02 3 1  ON 13
ci_15                 8.683321e-03 3 1  ON 14
ci_16                 8.465739e-03 3 1  ON 15
ci_17                -9.898253e-03 3 1  ON 16
ci_18                -9.976914e-03 3 1  ON 17
ci_19                 9.786970e-03 3 1  ON 18
ci_20                 1.059300e-02 3 1  ON 19
ci_21                 7.589117e-03 3 1  ON 20
ci_22                 9.217673e-03 3 1  ON 21
ci_23                 6.526999e-03 3 1  ON 22
ci_24                 6.510165e-03 3 1  ON 23
ci_25                 5.207201e-03 3 1  ON 24
ci_26                 3.780665e-03 3 1  ON 25
ci_27                 3.062053e-03 3 1  ON 26
ci_28                 4.595420e-03 3 1  ON 27
ci_29                 4.636444e-03 3 1  ON 28
ci_30                -4.188823e-04 3 1  ON 29
ci_31                -5.000057e-04 3 1  ON 30
ci_32                -2.063288e-05 3 1  ON 31
ci_33                -4.708724e-04 3 1  ON 32
ci_34                 1.723648e-04 3 1  ON 33
ci_35                -2.508028e-04 3 1  ON 34
ci_36                -9.113814e-04 3 1  ON 35
ci_37                -8.638490e-04 3 1  ON 36
ci_38                -1.304233e-04 3 1  ON 37
ci_39                -2.814179e-04 3 1  ON 38
ci_40                -1.217435e-03 3 1  ON 39
ci_41                 5.907017e-04 3 1  ON 40
ci_42                 2.374215e-04 3 1  ON 41
ci_43                -2.483628e-03 3 1  ON 42
ci_44                -1.668049e-03 3 1  ON 43
ci_45                -4.930533e-04 3 1  ON 44
ci_46                -4.855602e-04 3 1  ON 45
ci_47                -1.580592e-03 3 1  ON 46
ci_48                -2.027346e-03 3 1  ON 47
ci_49                -1.688505e-03 3 1  ON 48
ci_50                -5.833423e-04 3 1  ON 49
ci_51                 5.814381e-04 3 1  ON 50
ci_52                 3.063086e-05 3 1  ON 51
ci_53                -9.292375e-04 3 1  ON 52
ci_54                -4.898951e-04 3 1  ON 53
ci_55                -6.871716e-04 3 1  ON 54
ci_56                 1.580070e-03 3 1  ON 55
ci_57                 1.604691e-03 3 1  ON 56
ci_58                -9.150164e-04 3 1  ON 57
ci_59                -9.968577e-04 3 1  ON 58
ci_60                 1.351952e-03 3 1  ON 59
ci_61                 1.834777e-03 3 1  ON 60
ci_62                -4.335774e-04 3 1  ON 61
ci_63                -6.690101e-05 3 1  ON 62
ci_64                -9.494210e-04 3 1  ON 63
ci_65                 1.312971e-04 3 1  ON 64
ci_66                -6.936459e-04 3 1  ON 65
ci_67                -6.513412e-04 3 1  ON 66
ci_68                -1.365331e-03 3 1  ON 67
ci_69                -1.607004e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.4350e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s001 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s001 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=1  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2761e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 1
    time step          = 0.05
    reference energy   = -22.8098
    reference variance = 0.318781
====================================================
  Execution time = 2.5989e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s001
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5349e+04
  VMC Eavg = -2.2819e+01
  VMC Evar = 4.8407e-01
  Total weights = 1.963490080e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.6592e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.470406703614
                                         uncertainty =       0.002691963883

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.470406703614
                                         uncertainty =       0.002691963883

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000484977420
  error estimate for blocks of size 2^( 2) =       0.000506026285
  error estimate for blocks of size 2^( 3) =       0.000526442789
  error estimate for blocks of size 2^( 4) =       0.000541902048
  error estimate for blocks of size 2^( 5) =       0.000551971054
  error estimate for blocks of size 2^( 6) =       0.000556892289
  error estimate for blocks of size 2^( 7) =       0.000559707023

      target function =                  N/A
              le_mean =     -22.818884342936
             les_mean =     521.185548126716
             stat err =       0.000552618104
             autocorr =       1.298396030958
              std dev =       0.685861644323
             le_variance =       0.470406195154


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281888434294e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.5000e+00, overlap shift 2.5000e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.818884342892       residual = 2.89e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.818892377329       residual = 6.80e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.818892824328       residual = 1.41e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.818892873435       residual = 2.65e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.5000e+00 is 3.078532e-04

solving harmonic davidson linear method for identity shift 1.0000e+01, overlap shift 1.0000e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.818884342892       residual = 2.89e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.818886455019       residual = 7.13e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.818886570367       residual = 1.66e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.818886584584       residual = 3.89e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.0000e+01 is 7.906525e-05

solving harmonic davidson linear method for identity shift 4.0000e+01, overlap shift 4.0000e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.818884342892       residual = 2.89e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.818884877816       residual = 7.26e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.818884906945       residual = 1.75e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.818884910687       residual = 4.34e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 4.0000e+01 is 1.990313e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.005064 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0657e+01
  </log>
  <optVariables href="FORM.s001.opt.xml">
ci_01                 1.273519e-01 3 1  ON 0
ci_02                -2.878799e-02 3 1  ON 1
ci_03                -2.853449e-02 3 1  ON 2
ci_04                 2.608062e-02 3 1  ON 3
ci_05                -2.399486e-02 3 1  ON 4
ci_06                -2.360331e-02 3 1  ON 5
ci_07                 2.582561e-02 3 1  ON 6
ci_08                -5.199054e-03 3 1  ON 7
ci_09                -1.172274e-02 3 1  ON 8
ci_10                -1.143973e-02 3 1  ON 9
ci_11                 1.573464e-02 3 1  ON 10
ci_12                 1.062681e-02 3 1  ON 11
ci_13                 1.148242e-02 3 1  ON 12
ci_14                 1.484544e-02 3 1  ON 13
ci_15                 8.663515e-03 3 1  ON 14
ci_16                 8.441914e-03 3 1  ON 15
ci_17                -9.902336e-03 3 1  ON 16
ci_18                -9.976874e-03 3 1  ON 17
ci_19                 9.778043e-03 3 1  ON 18
ci_20                 1.058722e-02 3 1  ON 19
ci_21                 7.573883e-03 3 1  ON 20
ci_22                 9.199948e-03 3 1  ON 21
ci_23                 6.532959e-03 3 1  ON 22
ci_24                 6.528059e-03 3 1  ON 23
ci_25                 5.197564e-03 3 1  ON 24
ci_26                 3.765368e-03 3 1  ON 25
ci_27                 3.061028e-03 3 1  ON 26
ci_28                 4.583315e-03 3 1  ON 27
ci_29                 4.618796e-03 3 1  ON 28
ci_30                -4.044279e-04 3 1  ON 29
ci_31                -4.787473e-04 3 1  ON 30
ci_32                -1.159479e-05 3 1  ON 31
ci_33                -4.570105e-04 3 1  ON 32
ci_34                 1.601957e-04 3 1  ON 33
ci_35                -2.576099e-04 3 1  ON 34
ci_36                -9.075636e-04 3 1  ON 35
ci_37                -8.538002e-04 3 1  ON 36
ci_38                -1.219207e-04 3 1  ON 37
ci_39                -2.640717e-04 3 1  ON 38
ci_40                -1.225753e-03 3 1  ON 39
ci_41                 5.874604e-04 3 1  ON 40
ci_42                 2.208993e-04 3 1  ON 41
ci_43                -2.477025e-03 3 1  ON 42
ci_44                -1.688298e-03 3 1  ON 43
ci_45                -4.762001e-04 3 1  ON 44
ci_46                -4.947132e-04 3 1  ON 45
ci_47                -1.586264e-03 3 1  ON 46
ci_48                -1.988701e-03 3 1  ON 47
ci_49                -1.685539e-03 3 1  ON 48
ci_50                -5.952402e-04 3 1  ON 49
ci_51                 5.352819e-04 3 1  ON 50
ci_52                 4.429985e-05 3 1  ON 51
ci_53                -9.403242e-04 3 1  ON 52
ci_54                -4.731707e-04 3 1  ON 53
ci_55                -6.624169e-04 3 1  ON 54
ci_56                 1.572845e-03 3 1  ON 55
ci_57                 1.587274e-03 3 1  ON 56
ci_58                -9.274109e-04 3 1  ON 57
ci_59                -9.905716e-04 3 1  ON 58
ci_60                 1.354974e-03 3 1  ON 59
ci_61                 1.835832e-03 3 1  ON 60
ci_62                -4.301447e-04 3 1  ON 61
ci_63                -9.895217e-05 3 1  ON 62
ci_64                -9.379225e-04 3 1  ON 63
ci_65                 1.248722e-04 3 1  ON 64
ci_66                -6.862942e-04 3 1  ON 65
ci_67                -6.662365e-04 3 1  ON 66
ci_68                -1.347597e-03 3 1  ON 67
ci_69                -1.584610e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 1
    time step          = 0.05
    reference energy   = -22.752
    reference variance = 0.345228
====================================================
  Execution time = 2.5280e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s001
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2820e+01
  VMC Evar = 4.8567e-01
  Total weights = 1.9637e+06
  Execution time = 3.5765e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.471545675449
                                         uncertainty =       0.002594450825

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.471545675449
                                         uncertainty =       0.002594450825

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000485523500
  error estimate for blocks of size 2^( 2) =       0.000506605392
  error estimate for blocks of size 2^( 3) =       0.000526946821
  error estimate for blocks of size 2^( 4) =       0.000541211827
  error estimate for blocks of size 2^( 5) =       0.000550682229
  error estimate for blocks of size 2^( 6) =       0.000557459647
  error estimate for blocks of size 2^( 7) =       0.000562427054

      target function =                  N/A
              le_mean =     -22.819887746121
             les_mean =     521.232996803594
             stat err =       0.000552945189
             autocorr =       1.297010992707
              std dev =       0.686633918917
             le_variance =       0.471466138608

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.471394927491
                                         uncertainty =       0.002580705170

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.471394927491
                                         uncertainty =       0.002580705170

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000485445944
  error estimate for blocks of size 2^( 2) =       0.000506537123
  error estimate for blocks of size 2^( 3) =       0.000526889838
  error estimate for blocks of size 2^( 4) =       0.000541165879
  error estimate for blocks of size 2^( 5) =       0.000550636177
  error estimate for blocks of size 2^( 6) =       0.000557420629
  error estimate for blocks of size 2^( 7) =       0.000562404032

      target function =                  N/A
              le_mean =     -22.819887529845
             les_mean =     521.232847246788
             stat err =       0.000552906679
             autocorr =       1.297244741770
              std dev =       0.686524237887
             le_variance =       0.471315529206

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.471462503361
                                         uncertainty =       0.002586721380

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.471462503361
                                         uncertainty =       0.002586721380

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000485480710
  error estimate for blocks of size 2^( 2) =       0.000506567563
  error estimate for blocks of size 2^( 3) =       0.000526914933
  error estimate for blocks of size 2^( 4) =       0.000541185801
  error estimate for blocks of size 2^( 5) =       0.000550655999
  error estimate for blocks of size 2^( 6) =       0.000557437202
  error estimate for blocks of size 2^( 7) =       0.000562413411

      target function =                  N/A
              le_mean =     -22.819887402152
             les_mean =     521.232886438135
             stat err =       0.000552923104
             autocorr =       1.297136011320
              std dev =       0.686573404999
             le_variance =       0.471383040452

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.471534679404
                                         uncertainty =       0.002593410702

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.471534679404
                                         uncertainty =       0.002593410702

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000485517843
  error estimate for blocks of size 2^( 2) =       0.000506600368
  error estimate for blocks of size 2^( 3) =       0.000526942550
  error estimate for blocks of size 2^( 4) =       0.000541208302
  error estimate for blocks of size 2^( 5) =       0.000550678669
  error estimate for blocks of size 2^( 6) =       0.000557456578
  error estimate for blocks of size 2^( 7) =       0.000562425145

      target function =                  N/A
              le_mean =     -22.819887673510
             les_mean =     521.232977473122
             stat err =       0.000552942173
             autocorr =       1.297027068968
              std dev =       0.686625918661
             le_variance =       0.471455152177


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.819887746121        initial  <--
     2.5000e+00     2.5000e+01             3.0785e-04       -22.819887529845
     1.0000e+01     1.0000e+02             7.9065e-05       -22.819887402152
     4.0000e+01     4.0000e+02             1.9903e-05       -22.819887673510

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 43.2455
  </log>
  <optVariables href="FORM.s001.opt.xml">
ci_01                 1.274310e-01 3 1  ON 0
ci_02                -2.884264e-02 3 1  ON 1
ci_03                -2.859435e-02 3 1  ON 2
ci_04                 2.613791e-02 3 1  ON 3
ci_05                -2.402287e-02 3 1  ON 4
ci_06                -2.362332e-02 3 1  ON 5
ci_07                 2.584734e-02 3 1  ON 6
ci_08                -5.199615e-03 3 1  ON 7
ci_09                -1.173903e-02 3 1  ON 8
ci_10                -1.143622e-02 3 1  ON 9
ci_11                 1.571622e-02 3 1  ON 10
ci_12                 1.061105e-02 3 1  ON 11
ci_13                 1.147656e-02 3 1  ON 12
ci_14                 1.483937e-02 3 1  ON 13
ci_15                 8.683321e-03 3 1  ON 14
ci_16                 8.465739e-03 3 1  ON 15
ci_17                -9.898253e-03 3 1  ON 16
ci_18                -9.976914e-03 3 1  ON 17
ci_19                 9.786970e-03 3 1  ON 18
ci_20                 1.059300e-02 3 1  ON 19
ci_21                 7.589117e-03 3 1  ON 20
ci_22                 9.217673e-03 3 1  ON 21
ci_23                 6.526999e-03 3 1  ON 22
ci_24                 6.510165e-03 3 1  ON 23
ci_25                 5.207201e-03 3 1  ON 24
ci_26                 3.780665e-03 3 1  ON 25
ci_27                 3.062053e-03 3 1  ON 26
ci_28                 4.595420e-03 3 1  ON 27
ci_29                 4.636444e-03 3 1  ON 28
ci_30                -4.188823e-04 3 1  ON 29
ci_31                -5.000057e-04 3 1  ON 30
ci_32                -2.063288e-05 3 1  ON 31
ci_33                -4.708724e-04 3 1  ON 32
ci_34                 1.723648e-04 3 1  ON 33
ci_35                -2.508028e-04 3 1  ON 34
ci_36                -9.113814e-04 3 1  ON 35
ci_37                -8.638490e-04 3 1  ON 36
ci_38                -1.304233e-04 3 1  ON 37
ci_39                -2.814179e-04 3 1  ON 38
ci_40                -1.217435e-03 3 1  ON 39
ci_41                 5.907017e-04 3 1  ON 40
ci_42                 2.374215e-04 3 1  ON 41
ci_43                -2.483628e-03 3 1  ON 42
ci_44                -1.668049e-03 3 1  ON 43
ci_45                -4.930533e-04 3 1  ON 44
ci_46                -4.855602e-04 3 1  ON 45
ci_47                -1.580592e-03 3 1  ON 46
ci_48                -2.027346e-03 3 1  ON 47
ci_49                -1.688505e-03 3 1  ON 48
ci_50                -5.833423e-04 3 1  ON 49
ci_51                 5.814381e-04 3 1  ON 50
ci_52                 3.063086e-05 3 1  ON 51
ci_53                -9.292375e-04 3 1  ON 52
ci_54                -4.898951e-04 3 1  ON 53
ci_55                -6.871716e-04 3 1  ON 54
ci_56                 1.580070e-03 3 1  ON 55
ci_57                 1.604691e-03 3 1  ON 56
ci_58                -9.150164e-04 3 1  ON 57
ci_59                -9.968577e-04 3 1  ON 58
ci_60                 1.351952e-03 3 1  ON 59
ci_61                 1.834777e-03 3 1  ON 60
ci_62                -4.335774e-04 3 1  ON 61
ci_63                -6.690101e-05 3 1  ON 62
ci_64                -9.494210e-04 3 1  ON 63
ci_65                 1.312971e-04 3 1  ON 64
ci_66                -6.936459e-04 3 1  ON 65
ci_67                -6.513412e-04 3 1  ON 66
ci_68                -1.365331e-03 3 1  ON 67
ci_69                -1.607004e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.3910e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s002 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s002 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=2  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2771e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 2
    time step          = 0.05
    reference energy   = -22.8379
    reference variance = 0.447813
====================================================
  Execution time = 2.5961e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s002
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5333e+04
  VMC Eavg = -2.2820e+01
  VMC Evar = 4.9425e-01
  Total weights = 1.963528048e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.6650e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.474749309105
                                         uncertainty =       0.003143807041

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.474749309105
                                         uncertainty =       0.003143807041

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000487399254
  error estimate for blocks of size 2^( 2) =       0.000508506860
  error estimate for blocks of size 2^( 3) =       0.000528389887
  error estimate for blocks of size 2^( 4) =       0.000543494622
  error estimate for blocks of size 2^( 5) =       0.000552729381
  error estimate for blocks of size 2^( 6) =       0.000558601911
  error estimate for blocks of size 2^( 7) =       0.000562667824

      target function =                  N/A
              le_mean =     -22.820051509978
             les_mean =     521.249002073590
             stat err =       0.000554373435
             autocorr =       1.293704536459
              std dev =       0.689286635753
             le_variance =       0.475116066228


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.282005150998e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.5000e+01, overlap shift 2.5000e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.820051509939       residual = 3.32e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.820052357013       residual = 5.81e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.820052357237       residual = 1.30e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.820052362130       residual = 2.42e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.5000e+01 is 3.850009e-05

solving harmonic davidson linear method for identity shift 1.0000e+02, overlap shift 1.0000e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.820051509939       residual = 3.32e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.820051722733       residual = 5.85e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.820051722674       residual = 1.33e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.820051723903       residual = 2.54e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.0000e+02 is 9.648825e-06

solving harmonic davidson linear method for identity shift 4.0000e+02, overlap shift 4.0000e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.820051509939       residual = 3.32e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.820051563202       residual = 5.86e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.820051563180       residual = 1.34e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.820051563488       residual = 2.57e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 4.0000e+02 is 2.413699e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.006439 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0635e+01
  </log>
  <optVariables href="FORM.s002.opt.xml">
ci_01                 1.274214e-01 3 1  ON 0
ci_02                -2.883832e-02 3 1  ON 1
ci_03                -2.859005e-02 3 1  ON 2
ci_04                 2.613488e-02 3 1  ON 3
ci_05                -2.401993e-02 3 1  ON 4
ci_06                -2.362130e-02 3 1  ON 5
ci_07                 2.584829e-02 3 1  ON 6
ci_08                -5.198320e-03 3 1  ON 7
ci_09                -1.173931e-02 3 1  ON 8
ci_10                -1.143395e-02 3 1  ON 9
ci_11                 1.571812e-02 3 1  ON 10
ci_12                 1.061584e-02 3 1  ON 11
ci_13                 1.147760e-02 3 1  ON 12
ci_14                 1.484146e-02 3 1  ON 13
ci_15                 8.680022e-03 3 1  ON 14
ci_16                 8.466447e-03 3 1  ON 15
ci_17                -9.897983e-03 3 1  ON 16
ci_18                -9.973973e-03 3 1  ON 17
ci_19                 9.785812e-03 3 1  ON 18
ci_20                 1.059416e-02 3 1  ON 19
ci_21                 7.591057e-03 3 1  ON 20
ci_22                 9.216434e-03 3 1  ON 21
ci_23                 6.527488e-03 3 1  ON 22
ci_24                 6.509571e-03 3 1  ON 23
ci_25                 5.205991e-03 3 1  ON 24
ci_26                 3.778912e-03 3 1  ON 25
ci_27                 3.056318e-03 3 1  ON 26
ci_28                 4.596723e-03 3 1  ON 27
ci_29                 4.634301e-03 3 1  ON 28
ci_30                -4.177421e-04 3 1  ON 29
ci_31                -4.991521e-04 3 1  ON 30
ci_32                -2.052589e-05 3 1  ON 31
ci_33                -4.683117e-04 3 1  ON 32
ci_34                 1.721729e-04 3 1  ON 33
ci_35                -2.502400e-04 3 1  ON 34
ci_36                -9.114799e-04 3 1  ON 35
ci_37                -8.660297e-04 3 1  ON 36
ci_38                -1.308584e-04 3 1  ON 37
ci_39                -2.832342e-04 3 1  ON 38
ci_40                -1.217880e-03 3 1  ON 39
ci_41                 5.878414e-04 3 1  ON 40
ci_42                 2.373189e-04 3 1  ON 41
ci_43                -2.483150e-03 3 1  ON 42
ci_44                -1.668950e-03 3 1  ON 43
ci_45                -4.945478e-04 3 1  ON 44
ci_46                -4.853228e-04 3 1  ON 45
ci_47                -1.582827e-03 3 1  ON 46
ci_48                -2.024997e-03 3 1  ON 47
ci_49                -1.685372e-03 3 1  ON 48
ci_50                -5.849673e-04 3 1  ON 49
ci_51                 5.814244e-04 3 1  ON 50
ci_52                 3.321079e-05 3 1  ON 51
ci_53                -9.296339e-04 3 1  ON 52
ci_54                -4.891311e-04 3 1  ON 53
ci_55                -6.866402e-04 3 1  ON 54
ci_56                 1.580811e-03 3 1  ON 55
ci_57                 1.603006e-03 3 1  ON 56
ci_58                -9.148663e-04 3 1  ON 57
ci_59                -9.983071e-04 3 1  ON 58
ci_60                 1.351837e-03 3 1  ON 59
ci_61                 1.834166e-03 3 1  ON 60
ci_62                -4.326671e-04 3 1  ON 61
ci_63                -6.801608e-05 3 1  ON 62
ci_64                -9.463489e-04 3 1  ON 63
ci_65                 1.289379e-04 3 1  ON 64
ci_66                -6.928243e-04 3 1  ON 65
ci_67                -6.499928e-04 3 1  ON 66
ci_68                -1.364221e-03 3 1  ON 67
ci_69                -1.606229e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 2
    time step          = 0.05
    reference energy   = -22.8111
    reference variance = 0.331861
====================================================
  Execution time = 2.5192e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s002
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2818e+01
  VMC Evar = 4.8419e-01
  Total weights = 1.9633e+06
  Execution time = 3.5773e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.471019963856
                                         uncertainty =       0.002431687519

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.471019963856
                                         uncertainty =       0.002431687519

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000485318914
  error estimate for blocks of size 2^( 2) =       0.000506431002
  error estimate for blocks of size 2^( 3) =       0.000526653150
  error estimate for blocks of size 2^( 4) =       0.000542625130
  error estimate for blocks of size 2^( 5) =       0.000552437112
  error estimate for blocks of size 2^( 6) =       0.000557841209
  error estimate for blocks of size 2^( 7) =       0.000559101428

      target function =                  N/A
              le_mean =     -22.818245728881
             les_mean =     521.156529487239
             stat err =       0.000553001220
             autocorr =       1.298367826213
              std dev =       0.686344589686
             le_variance =       0.471068895791

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.471011439450
                                         uncertainty =       0.002431030114

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.471011439450
                                         uncertainty =       0.002431030114

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000485314521
  error estimate for blocks of size 2^( 2) =       0.000506427357
  error estimate for blocks of size 2^( 3) =       0.000526650238
  error estimate for blocks of size 2^( 4) =       0.000542622903
  error estimate for blocks of size 2^( 5) =       0.000552435561
  error estimate for blocks of size 2^( 6) =       0.000557840268
  error estimate for blocks of size 2^( 7) =       0.000559100671

      target function =                  N/A
              le_mean =     -22.818245698476
             les_mean =     521.156532622483
             stat err =       0.000552999851
             autocorr =       1.298384902035
              std dev =       0.686338377120
             le_variance =       0.471060367908

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.471015666941
                                         uncertainty =       0.002431357154

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.471015666941
                                         uncertainty =       0.002431357154

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000485316699
  error estimate for blocks of size 2^( 2) =       0.000506429164
  error estimate for blocks of size 2^( 3) =       0.000526651680
  error estimate for blocks of size 2^( 4) =       0.000542624004
  error estimate for blocks of size 2^( 5) =       0.000552436328
  error estimate for blocks of size 2^( 6) =       0.000557840731
  error estimate for blocks of size 2^( 7) =       0.000559101045

      target function =                  N/A
              le_mean =     -22.818245712052
             les_mean =     521.156529184256
             stat err =       0.000553000527
             autocorr =       1.298376421954
              std dev =       0.686341458127
             le_variance =       0.471064597143

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.471019424431
                                         uncertainty =       0.002431646131

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.471019424431
                                         uncertainty =       0.002431646131

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000485318636
  error estimate for blocks of size 2^( 2) =       0.000506430771
  error estimate for blocks of size 2^( 3) =       0.000526652966
  error estimate for blocks of size 2^( 4) =       0.000542624988
  error estimate for blocks of size 2^( 5) =       0.000552437014
  error estimate for blocks of size 2^( 6) =       0.000557841148
  error estimate for blocks of size 2^( 7) =       0.000559101380

      target function =                  N/A
              le_mean =     -22.818245726608
             les_mean =     521.156529268660
             stat err =       0.000553001132
             autocorr =       1.298368903393
              std dev =       0.686344196559
             le_variance =       0.471068356151


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.818245728881        initial  <--
     2.5000e+01     2.5000e+02             3.8500e-05       -22.818245698476
     1.0000e+02     1.0000e+03             9.6488e-06       -22.818245712052
     4.0000e+02     4.0000e+03             2.4137e-06       -22.818245726608

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 45.0323
  </log>
  <optVariables href="FORM.s002.opt.xml">
ci_01                 1.274310e-01 3 1  ON 0
ci_02                -2.884264e-02 3 1  ON 1
ci_03                -2.859435e-02 3 1  ON 2
ci_04                 2.613791e-02 3 1  ON 3
ci_05                -2.402287e-02 3 1  ON 4
ci_06                -2.362332e-02 3 1  ON 5
ci_07                 2.584734e-02 3 1  ON 6
ci_08                -5.199615e-03 3 1  ON 7
ci_09                -1.173903e-02 3 1  ON 8
ci_10                -1.143622e-02 3 1  ON 9
ci_11                 1.571622e-02 3 1  ON 10
ci_12                 1.061105e-02 3 1  ON 11
ci_13                 1.147656e-02 3 1  ON 12
ci_14                 1.483937e-02 3 1  ON 13
ci_15                 8.683321e-03 3 1  ON 14
ci_16                 8.465739e-03 3 1  ON 15
ci_17                -9.898253e-03 3 1  ON 16
ci_18                -9.976914e-03 3 1  ON 17
ci_19                 9.786970e-03 3 1  ON 18
ci_20                 1.059300e-02 3 1  ON 19
ci_21                 7.589117e-03 3 1  ON 20
ci_22                 9.217673e-03 3 1  ON 21
ci_23                 6.526999e-03 3 1  ON 22
ci_24                 6.510165e-03 3 1  ON 23
ci_25                 5.207201e-03 3 1  ON 24
ci_26                 3.780665e-03 3 1  ON 25
ci_27                 3.062053e-03 3 1  ON 26
ci_28                 4.595420e-03 3 1  ON 27
ci_29                 4.636444e-03 3 1  ON 28
ci_30                -4.188823e-04 3 1  ON 29
ci_31                -5.000057e-04 3 1  ON 30
ci_32                -2.063288e-05 3 1  ON 31
ci_33                -4.708724e-04 3 1  ON 32
ci_34                 1.723648e-04 3 1  ON 33
ci_35                -2.508028e-04 3 1  ON 34
ci_36                -9.113814e-04 3 1  ON 35
ci_37                -8.638490e-04 3 1  ON 36
ci_38                -1.304233e-04 3 1  ON 37
ci_39                -2.814179e-04 3 1  ON 38
ci_40                -1.217435e-03 3 1  ON 39
ci_41                 5.907017e-04 3 1  ON 40
ci_42                 2.374215e-04 3 1  ON 41
ci_43                -2.483628e-03 3 1  ON 42
ci_44                -1.668049e-03 3 1  ON 43
ci_45                -4.930533e-04 3 1  ON 44
ci_46                -4.855602e-04 3 1  ON 45
ci_47                -1.580592e-03 3 1  ON 46
ci_48                -2.027346e-03 3 1  ON 47
ci_49                -1.688505e-03 3 1  ON 48
ci_50                -5.833423e-04 3 1  ON 49
ci_51                 5.814381e-04 3 1  ON 50
ci_52                 3.063086e-05 3 1  ON 51
ci_53                -9.292375e-04 3 1  ON 52
ci_54                -4.898951e-04 3 1  ON 53
ci_55                -6.871716e-04 3 1  ON 54
ci_56                 1.580070e-03 3 1  ON 55
ci_57                 1.604691e-03 3 1  ON 56
ci_58                -9.150164e-04 3 1  ON 57
ci_59                -9.968577e-04 3 1  ON 58
ci_60                 1.351952e-03 3 1  ON 59
ci_61                 1.834777e-03 3 1  ON 60
ci_62                -4.335774e-04 3 1  ON 61
ci_63                -6.690101e-05 3 1  ON 62
ci_64                -9.494210e-04 3 1  ON 63
ci_65                 1.312971e-04 3 1  ON 64
ci_66                -6.936459e-04 3 1  ON 65
ci_67                -6.513412e-04 3 1  ON 66
ci_68                -1.365331e-03 3 1  ON 67
ci_69                -1.607004e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.5674e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s003 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s003 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=3  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2789e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 3
    time step          = 0.05
    reference energy   = -22.7856
    reference variance = 0.488273
====================================================
  Execution time = 2.5969e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s003
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5364e+04
  VMC Eavg = -2.2819e+01
  VMC Evar = 4.8717e-01
  Total weights = 1.963885332e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.6896e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.473025279087
                                         uncertainty =       0.002587069067

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.473025279087
                                         uncertainty =       0.002587069067

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000486289048
  error estimate for blocks of size 2^( 2) =       0.000507672430
  error estimate for blocks of size 2^( 3) =       0.000527408056
  error estimate for blocks of size 2^( 4) =       0.000543307583
  error estimate for blocks of size 2^( 5) =       0.000552492863
  error estimate for blocks of size 2^( 6) =       0.000557858464
  error estimate for blocks of size 2^( 7) =       0.000563242261

      target function =                  N/A
              le_mean =     -22.818780488253
             les_mean =     521.183914517857
             stat err =       0.000554225293
             autocorr =       1.298923892400
              std dev =       0.687716567302
             le_variance =       0.472954076942


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281878048825e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.5000e+02, overlap shift 2.5000e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.818780488158       residual = 2.96e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.818780559963       residual = 6.70e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.818780564365       residual = 1.54e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.818780565140       residual = 4.79e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.5000e+02 is 4.049868e-06

solving harmonic davidson linear method for identity shift 1.0000e+03, overlap shift 1.0000e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.818780488158       residual = 2.96e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.818780506118       residual = 6.71e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.818780507217       residual = 1.55e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.818780507411       residual = 4.80e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.0000e+03 is 1.012745e-06

solving harmonic davidson linear method for identity shift 4.0000e+03, overlap shift 4.0000e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.818780488158       residual = 2.96e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.818780492648       residual = 6.71e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.818780492923       residual = 1.55e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.818780492972       residual = 4.81e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 4.0000e+03 is 2.532037e-07

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.007806 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0668e+01
  </log>
  <optVariables href="FORM.s003.opt.xml">
ci_01                 1.274300e-01 3 1  ON 0
ci_02                -2.884210e-02 3 1  ON 1
ci_03                -2.859380e-02 3 1  ON 2
ci_04                 2.613757e-02 3 1  ON 3
ci_05                -2.402245e-02 3 1  ON 4
ci_06                -2.362320e-02 3 1  ON 5
ci_07                 2.584742e-02 3 1  ON 6
ci_08                -5.199656e-03 3 1  ON 7
ci_09                -1.173911e-02 3 1  ON 8
ci_10                -1.143599e-02 3 1  ON 9
ci_11                 1.571649e-02 3 1  ON 10
ci_12                 1.061094e-02 3 1  ON 11
ci_13                 1.147656e-02 3 1  ON 12
ci_14                 1.483960e-02 3 1  ON 13
ci_15                 8.682913e-03 3 1  ON 14
ci_16                 8.465453e-03 3 1  ON 15
ci_17                -9.898087e-03 3 1  ON 16
ci_18                -9.976990e-03 3 1  ON 17
ci_19                 9.787174e-03 3 1  ON 18
ci_20                 1.059303e-02 3 1  ON 19
ci_21                 7.589266e-03 3 1  ON 20
ci_22                 9.217536e-03 3 1  ON 21
ci_23                 6.526792e-03 3 1  ON 22
ci_24                 6.510266e-03 3 1  ON 23
ci_25                 5.207120e-03 3 1  ON 24
ci_26                 3.780747e-03 3 1  ON 25
ci_27                 3.062196e-03 3 1  ON 26
ci_28                 4.595396e-03 3 1  ON 27
ci_29                 4.636515e-03 3 1  ON 28
ci_30                -4.188824e-04 3 1  ON 29
ci_31                -5.000035e-04 3 1  ON 30
ci_32                -2.064615e-05 3 1  ON 31
ci_33                -4.709551e-04 3 1  ON 32
ci_34                 1.723394e-04 3 1  ON 33
ci_35                -2.506947e-04 3 1  ON 34
ci_36                -9.117348e-04 3 1  ON 35
ci_37                -8.637007e-04 3 1  ON 36
ci_38                -1.305570e-04 3 1  ON 37
ci_39                -2.816369e-04 3 1  ON 38
ci_40                -1.217602e-03 3 1  ON 39
ci_41                 5.906923e-04 3 1  ON 40
ci_42                 2.373163e-04 3 1  ON 41
ci_43                -2.483438e-03 3 1  ON 42
ci_44                -1.668179e-03 3 1  ON 43
ci_45                -4.929973e-04 3 1  ON 44
ci_46                -4.854405e-04 3 1  ON 45
ci_47                -1.580537e-03 3 1  ON 46
ci_48                -2.027189e-03 3 1  ON 47
ci_49                -1.688477e-03 3 1  ON 48
ci_50                -5.834822e-04 3 1  ON 49
ci_51                 5.813016e-04 3 1  ON 50
ci_52                 3.036740e-05 3 1  ON 51
ci_53                -9.291288e-04 3 1  ON 52
ci_54                -4.898039e-04 3 1  ON 53
ci_55                -6.870854e-04 3 1  ON 54
ci_56                 1.580032e-03 3 1  ON 55
ci_57                 1.604824e-03 3 1  ON 56
ci_58                -9.149215e-04 3 1  ON 57
ci_59                -9.968612e-04 3 1  ON 58
ci_60                 1.351837e-03 3 1  ON 59
ci_61                 1.834717e-03 3 1  ON 60
ci_62                -4.335659e-04 3 1  ON 61
ci_63                -6.688204e-05 3 1  ON 62
ci_64                -9.493451e-04 3 1  ON 63
ci_65                 1.310490e-04 3 1  ON 64
ci_66                -6.935145e-04 3 1  ON 65
ci_67                -6.515467e-04 3 1  ON 66
ci_68                -1.365199e-03 3 1  ON 67
ci_69                -1.606838e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 3
    time step          = 0.05
    reference energy   = -22.8792
    reference variance = 0.464189
====================================================
  Execution time = 2.5142e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s003
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2818e+01
  VMC Evar = 4.9042e-01
  Total weights = 1.9637e+06
  Execution time = 3.5665e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.475910357994
                                         uncertainty =       0.003116313298

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.475910357994
                                         uncertainty =       0.003116313298

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000487756268
  error estimate for blocks of size 2^( 2) =       0.000509505902
  error estimate for blocks of size 2^( 3) =       0.000529747878
  error estimate for blocks of size 2^( 4) =       0.000545386601
  error estimate for blocks of size 2^( 5) =       0.000555207446
  error estimate for blocks of size 2^( 6) =       0.000559261802
  error estimate for blocks of size 2^( 7) =       0.000561264663

      target function =                  N/A
              le_mean =     -22.817645623845
             les_mean =     521.135376646875
             stat err =       0.000555280128
             autocorr =       1.296040413999
              std dev =       0.689791529755
             le_variance =       0.475812354521

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.475909305539
                                         uncertainty =       0.003116335766

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.475909305539
                                         uncertainty =       0.003116335766

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000487755729
  error estimate for blocks of size 2^( 2) =       0.000509505448
  error estimate for blocks of size 2^( 3) =       0.000529747528
  error estimate for blocks of size 2^( 4) =       0.000545386343
  error estimate for blocks of size 2^( 5) =       0.000555207277
  error estimate for blocks of size 2^( 6) =       0.000559261680
  error estimate for blocks of size 2^( 7) =       0.000561264520

      target function =                  N/A
              le_mean =     -22.817645604616
             les_mean =     521.135374109689
             stat err =       0.000555279955
             autocorr =       1.296042470439
              std dev =       0.689790767483
             le_variance =       0.475811302905

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.475909831355
                                         uncertainty =       0.003116324537

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.475909831355
                                         uncertainty =       0.003116324537

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000487755999
  error estimate for blocks of size 2^( 2) =       0.000509505675
  error estimate for blocks of size 2^( 3) =       0.000529747703
  error estimate for blocks of size 2^( 4) =       0.000545386472
  error estimate for blocks of size 2^( 5) =       0.000555207361
  error estimate for blocks of size 2^( 6) =       0.000559261741
  error estimate for blocks of size 2^( 7) =       0.000561264591

      target function =                  N/A
              le_mean =     -22.817645614206
             les_mean =     521.135375372646
             stat err =       0.000555280041
             autocorr =       1.296041442831
              std dev =       0.689791148321
             le_variance =       0.475811828302

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.475910292140
                                         uncertainty =       0.003116314703

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.475910292140
                                         uncertainty =       0.003116314703

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000487756235
  error estimate for blocks of size 2^( 2) =       0.000509505874
  error estimate for blocks of size 2^( 3) =       0.000529747857
  error estimate for blocks of size 2^( 4) =       0.000545386585
  error estimate for blocks of size 2^( 5) =       0.000555207435
  error estimate for blocks of size 2^( 6) =       0.000559261795
  error estimate for blocks of size 2^( 7) =       0.000561264654

      target function =                  N/A
              le_mean =     -22.817645622638
             les_mean =     521.135376487047
             stat err =       0.000555280117
             autocorr =       1.296040542629
              std dev =       0.689791482059
             le_variance =       0.475812288721


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.817645623845        initial  <--
     2.5000e+02     2.5000e+03             4.0499e-06       -22.817645604616
     1.0000e+03     1.0000e+04             1.0127e-06       -22.817645614206
     4.0000e+03     4.0000e+04             2.5320e-07       -22.817645622638

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 43.0378
  </log>
  <optVariables href="FORM.s003.opt.xml">
ci_01                 1.274310e-01 3 1  ON 0
ci_02                -2.884264e-02 3 1  ON 1
ci_03                -2.859435e-02 3 1  ON 2
ci_04                 2.613791e-02 3 1  ON 3
ci_05                -2.402287e-02 3 1  ON 4
ci_06                -2.362332e-02 3 1  ON 5
ci_07                 2.584734e-02 3 1  ON 6
ci_08                -5.199615e-03 3 1  ON 7
ci_09                -1.173903e-02 3 1  ON 8
ci_10                -1.143622e-02 3 1  ON 9
ci_11                 1.571622e-02 3 1  ON 10
ci_12                 1.061105e-02 3 1  ON 11
ci_13                 1.147656e-02 3 1  ON 12
ci_14                 1.483937e-02 3 1  ON 13
ci_15                 8.683321e-03 3 1  ON 14
ci_16                 8.465739e-03 3 1  ON 15
ci_17                -9.898253e-03 3 1  ON 16
ci_18                -9.976914e-03 3 1  ON 17
ci_19                 9.786970e-03 3 1  ON 18
ci_20                 1.059300e-02 3 1  ON 19
ci_21                 7.589117e-03 3 1  ON 20
ci_22                 9.217673e-03 3 1  ON 21
ci_23                 6.526999e-03 3 1  ON 22
ci_24                 6.510165e-03 3 1  ON 23
ci_25                 5.207201e-03 3 1  ON 24
ci_26                 3.780665e-03 3 1  ON 25
ci_27                 3.062053e-03 3 1  ON 26
ci_28                 4.595420e-03 3 1  ON 27
ci_29                 4.636444e-03 3 1  ON 28
ci_30                -4.188823e-04 3 1  ON 29
ci_31                -5.000057e-04 3 1  ON 30
ci_32                -2.063288e-05 3 1  ON 31
ci_33                -4.708724e-04 3 1  ON 32
ci_34                 1.723648e-04 3 1  ON 33
ci_35                -2.508028e-04 3 1  ON 34
ci_36                -9.113814e-04 3 1  ON 35
ci_37                -8.638490e-04 3 1  ON 36
ci_38                -1.304233e-04 3 1  ON 37
ci_39                -2.814179e-04 3 1  ON 38
ci_40                -1.217435e-03 3 1  ON 39
ci_41                 5.907017e-04 3 1  ON 40
ci_42                 2.374215e-04 3 1  ON 41
ci_43                -2.483628e-03 3 1  ON 42
ci_44                -1.668049e-03 3 1  ON 43
ci_45                -4.930533e-04 3 1  ON 44
ci_46                -4.855602e-04 3 1  ON 45
ci_47                -1.580592e-03 3 1  ON 46
ci_48                -2.027346e-03 3 1  ON 47
ci_49                -1.688505e-03 3 1  ON 48
ci_50                -5.833423e-04 3 1  ON 49
ci_51                 5.814381e-04 3 1  ON 50
ci_52                 3.063086e-05 3 1  ON 51
ci_53                -9.292375e-04 3 1  ON 52
ci_54                -4.898951e-04 3 1  ON 53
ci_55                -6.871716e-04 3 1  ON 54
ci_56                 1.580070e-03 3 1  ON 55
ci_57                 1.604691e-03 3 1  ON 56
ci_58                -9.150164e-04 3 1  ON 57
ci_59                -9.968577e-04 3 1  ON 58
ci_60                 1.351952e-03 3 1  ON 59
ci_61                 1.834777e-03 3 1  ON 60
ci_62                -4.335774e-04 3 1  ON 61
ci_63                -6.690101e-05 3 1  ON 62
ci_64                -9.494210e-04 3 1  ON 63
ci_65                 1.312971e-04 3 1  ON 64
ci_66                -6.936459e-04 3 1  ON 65
ci_67                -6.513412e-04 3 1  ON 66
ci_68                -1.365331e-03 3 1  ON 67
ci_69                -1.607004e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.3714e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s004 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s004 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=4  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2800e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 4
    time step          = 0.05
    reference energy   = -22.7597
    reference variance = 0.477087
====================================================
  Execution time = 2.5883e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s004
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5338e+04
  VMC Eavg = -2.2819e+01
  VMC Evar = 4.9267e-01
  Total weights = 1.963792343e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.7146e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.475398444200
                                         uncertainty =       0.003071673838

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.475398444200
                                         uncertainty =       0.003071673838

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000487476121
  error estimate for blocks of size 2^( 2) =       0.000509012383
  error estimate for blocks of size 2^( 3) =       0.000528438082
  error estimate for blocks of size 2^( 4) =       0.000544672938
  error estimate for blocks of size 2^( 5) =       0.000554778186
  error estimate for blocks of size 2^( 6) =       0.000559032695
  error estimate for blocks of size 2^( 7) =       0.000561776268

      target function =                  N/A
              le_mean =     -22.819350200850
             les_mean =     521.215413532662
             stat err =       0.000555065022
             autocorr =       1.296525397608
              std dev =       0.689395341247
             le_variance =       0.475265936533


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281935020085e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.5000e+03, overlap shift 2.5000e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.819350200742       residual = 3.57e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.819350209081       residual = 6.84e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.819350209463       residual = 1.51e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.819350209543       residual = 3.15e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.5000e+03 is 3.806109e-07

solving harmonic davidson linear method for identity shift 1.0000e+04, overlap shift 1.0000e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.819350200742       residual = 3.57e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.819350202827       residual = 6.84e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.819350202922       residual = 1.51e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.819350202942       residual = 3.15e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.0000e+04 is 9.515513e-08

solving harmonic davidson linear method for identity shift 4.0000e+04, overlap shift 4.0000e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.819350200742       residual = 3.57e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.819350201263       residual = 6.84e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.819350201287       residual = 1.51e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.819350201298       residual = 3.15e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 4.0000e+04 is 2.378894e-08

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.009170 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0607e+01
  </log>
  <optVariables href="FORM.s004.opt.xml">
ci_01                 1.274309e-01 3 1  ON 0
ci_02                -2.884258e-02 3 1  ON 1
ci_03                -2.859431e-02 3 1  ON 2
ci_04                 2.613787e-02 3 1  ON 3
ci_05                -2.402283e-02 3 1  ON 4
ci_06                -2.362331e-02 3 1  ON 5
ci_07                 2.584735e-02 3 1  ON 6
ci_08                -5.199588e-03 3 1  ON 7
ci_09                -1.173900e-02 3 1  ON 8
ci_10                -1.143623e-02 3 1  ON 9
ci_11                 1.571620e-02 3 1  ON 10
ci_12                 1.061107e-02 3 1  ON 11
ci_13                 1.147662e-02 3 1  ON 12
ci_14                 1.483940e-02 3 1  ON 13
ci_15                 8.683318e-03 3 1  ON 14
ci_16                 8.465719e-03 3 1  ON 15
ci_17                -9.898251e-03 3 1  ON 16
ci_18                -9.976923e-03 3 1  ON 17
ci_19                 9.786945e-03 3 1  ON 18
ci_20                 1.059300e-02 3 1  ON 19
ci_21                 7.589135e-03 3 1  ON 20
ci_22                 9.217663e-03 3 1  ON 21
ci_23                 6.526949e-03 3 1  ON 22
ci_24                 6.510159e-03 3 1  ON 23
ci_25                 5.207196e-03 3 1  ON 24
ci_26                 3.780655e-03 3 1  ON 25
ci_27                 3.062081e-03 3 1  ON 26
ci_28                 4.595415e-03 3 1  ON 27
ci_29                 4.636429e-03 3 1  ON 28
ci_30                -4.188770e-04 3 1  ON 29
ci_31                -4.999877e-04 3 1  ON 30
ci_32                -2.064479e-05 3 1  ON 31
ci_33                -4.708419e-04 3 1  ON 32
ci_34                 1.723868e-04 3 1  ON 33
ci_35                -2.507878e-04 3 1  ON 34
ci_36                -9.113545e-04 3 1  ON 35
ci_37                -8.638464e-04 3 1  ON 36
ci_38                -1.304195e-04 3 1  ON 37
ci_39                -2.814359e-04 3 1  ON 38
ci_40                -1.217416e-03 3 1  ON 39
ci_41                 5.906771e-04 3 1  ON 40
ci_42                 2.374265e-04 3 1  ON 41
ci_43                -2.483624e-03 3 1  ON 42
ci_44                -1.668057e-03 3 1  ON 43
ci_45                -4.930352e-04 3 1  ON 44
ci_46                -4.855404e-04 3 1  ON 45
ci_47                -1.580594e-03 3 1  ON 46
ci_48                -2.027304e-03 3 1  ON 47
ci_49                -1.688514e-03 3 1  ON 48
ci_50                -5.833196e-04 3 1  ON 49
ci_51                 5.814484e-04 3 1  ON 50
ci_52                 3.063496e-05 3 1  ON 51
ci_53                -9.292409e-04 3 1  ON 52
ci_54                -4.898964e-04 3 1  ON 53
ci_55                -6.871751e-04 3 1  ON 54
ci_56                 1.580085e-03 3 1  ON 55
ci_57                 1.604693e-03 3 1  ON 56
ci_58                -9.149952e-04 3 1  ON 57
ci_59                -9.968546e-04 3 1  ON 58
ci_60                 1.351975e-03 3 1  ON 59
ci_61                 1.834764e-03 3 1  ON 60
ci_62                -4.335777e-04 3 1  ON 61
ci_63                -6.688855e-05 3 1  ON 62
ci_64                -9.494384e-04 3 1  ON 63
ci_65                 1.312678e-04 3 1  ON 64
ci_66                -6.936384e-04 3 1  ON 65
ci_67                -6.513418e-04 3 1  ON 66
ci_68                -1.365315e-03 3 1  ON 67
ci_69                -1.607000e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 4
    time step          = 0.05
    reference energy   = -22.8102
    reference variance = 0.43009
====================================================
  Execution time = 2.5146e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s004
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2818e+01
  VMC Evar = 4.9247e-01
  Total weights = 1.9636e+06
  Execution time = 3.5800e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.475320471638
                                         uncertainty =       0.002992155747

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.475320471638
                                         uncertainty =       0.002992155747

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000487486377
  error estimate for blocks of size 2^( 2) =       0.000508358417
  error estimate for blocks of size 2^( 3) =       0.000528205618
  error estimate for blocks of size 2^( 4) =       0.000543124663
  error estimate for blocks of size 2^( 5) =       0.000552463188
  error estimate for blocks of size 2^( 6) =       0.000558556723
  error estimate for blocks of size 2^( 7) =       0.000561660579

      target function =                  N/A
              le_mean =     -22.818256167088
             les_mean =     521.165286855905
             stat err =       0.000553951288
             autocorr =       1.291273340762
              std dev =       0.689409846439
             le_variance =       0.475285936367

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.475320388422
                                         uncertainty =       0.002992146424

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.475320388422
                                         uncertainty =       0.002992146424

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000487486335
  error estimate for blocks of size 2^( 2) =       0.000508358384
  error estimate for blocks of size 2^( 3) =       0.000528205592
  error estimate for blocks of size 2^( 4) =       0.000543124642
  error estimate for blocks of size 2^( 5) =       0.000552463169
  error estimate for blocks of size 2^( 6) =       0.000558556700
  error estimate for blocks of size 2^( 7) =       0.000561660553

      target function =                  N/A
              le_mean =     -22.818256167922
             les_mean =     521.165286859146
             stat err =       0.000553951266
             autocorr =       1.291273465329
              std dev =       0.689409785987
             le_variance =       0.475285853015

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.475320430026
                                         uncertainty =       0.002992151085

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.475320430026
                                         uncertainty =       0.002992151085

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000487486356
  error estimate for blocks of size 2^( 2) =       0.000508358400
  error estimate for blocks of size 2^( 3) =       0.000528205605
  error estimate for blocks of size 2^( 4) =       0.000543124652
  error estimate for blocks of size 2^( 5) =       0.000552463179
  error estimate for blocks of size 2^( 6) =       0.000558556711
  error estimate for blocks of size 2^( 7) =       0.000561660566

      target function =                  N/A
              le_mean =     -22.818256167505
             les_mean =     521.165286857476
             stat err =       0.000553951277
             autocorr =       1.291273403051
              std dev =       0.689409816210
             le_variance =       0.475285894687

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.475320466436
                                         uncertainty =       0.002992155164

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.475320466436
                                         uncertainty =       0.002992155164

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000487486375
  error estimate for blocks of size 2^( 2) =       0.000508358415
  error estimate for blocks of size 2^( 3) =       0.000528205617
  error estimate for blocks of size 2^( 4) =       0.000543124661
  error estimate for blocks of size 2^( 5) =       0.000552463187
  error estimate for blocks of size 2^( 6) =       0.000558556721
  error estimate for blocks of size 2^( 7) =       0.000561660577

      target function =                  N/A
              le_mean =     -22.818256167140
             les_mean =     521.165286856096
             stat err =       0.000553951287
             autocorr =       1.291273348550
              std dev =       0.689409842660
             le_variance =       0.475285931156


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.818256167088        initial
     2.5000e+03     2.5000e+04             3.8061e-07       -22.818256167922  <--
     1.0000e+04     1.0000e+05             9.5155e-08       -22.818256167505
     4.0000e+04     4.0000e+05             2.3789e-08       -22.818256167140

*****************************************************************************
Applying the update for shift_i =   2.5000e+03     and shift_s =   2.5000e+04
*****************************************************************************

  Execution time = 4.3044e+01
  </log>
  <optVariables href="FORM.s004.opt.xml">
ci_01                 1.274306e-01 3 1  ON 0
ci_02                -2.884242e-02 3 1  ON 1
ci_03                -2.859419e-02 3 1  ON 2
ci_04                 2.613776e-02 3 1  ON 3
ci_05                -2.402271e-02 3 1  ON 4
ci_06                -2.362326e-02 3 1  ON 5
ci_07                 2.584737e-02 3 1  ON 6
ci_08                -5.199505e-03 3 1  ON 7
ci_09                -1.173891e-02 3 1  ON 8
ci_10                -1.143627e-02 3 1  ON 9
ci_11                 1.571614e-02 3 1  ON 10
ci_12                 1.061112e-02 3 1  ON 11
ci_13                 1.147678e-02 3 1  ON 12
ci_14                 1.483949e-02 3 1  ON 13
ci_15                 8.683308e-03 3 1  ON 14
ci_16                 8.465659e-03 3 1  ON 15
ci_17                -9.898245e-03 3 1  ON 16
ci_18                -9.976948e-03 3 1  ON 17
ci_19                 9.786870e-03 3 1  ON 18
ci_20                 1.059301e-02 3 1  ON 19
ci_21                 7.589188e-03 3 1  ON 20
ci_22                 9.217633e-03 3 1  ON 21
ci_23                 6.526799e-03 3 1  ON 22
ci_24                 6.510140e-03 3 1  ON 23
ci_25                 5.207182e-03 3 1  ON 24
ci_26                 3.780626e-03 3 1  ON 25
ci_27                 3.062166e-03 3 1  ON 26
ci_28                 4.595399e-03 3 1  ON 27
ci_29                 4.636383e-03 3 1  ON 28
ci_30                -4.188611e-04 3 1  ON 29
ci_31                -4.999337e-04 3 1  ON 30
ci_32                -2.068054e-05 3 1  ON 31
ci_33                -4.707501e-04 3 1  ON 32
ci_34                 1.724526e-04 3 1  ON 33
ci_35                -2.507425e-04 3 1  ON 34
ci_36                -9.112737e-04 3 1  ON 35
ci_37                -8.638387e-04 3 1  ON 36
ci_38                -1.304082e-04 3 1  ON 37
ci_39                -2.814899e-04 3 1  ON 38
ci_40                -1.217356e-03 3 1  ON 39
ci_41                 5.906032e-04 3 1  ON 40
ci_42                 2.374417e-04 3 1  ON 41
ci_43                -2.483612e-03 3 1  ON 42
ci_44                -1.668081e-03 3 1  ON 43
ci_45                -4.929811e-04 3 1  ON 44
ci_46                -4.854809e-04 3 1  ON 45
ci_47                -1.580601e-03 3 1  ON 46
ci_48                -2.027178e-03 3 1  ON 47
ci_49                -1.688540e-03 3 1  ON 48
ci_50                -5.832517e-04 3 1  ON 49
ci_51                 5.814793e-04 3 1  ON 50
ci_52                 3.064728e-05 3 1  ON 51
ci_53                -9.292511e-04 3 1  ON 52
ci_54                -4.899003e-04 3 1  ON 53
ci_55                -6.871857e-04 3 1  ON 54
ci_56                 1.580130e-03 3 1  ON 55
ci_57                 1.604700e-03 3 1  ON 56
ci_58                -9.149318e-04 3 1  ON 57
ci_59                -9.968455e-04 3 1  ON 58
ci_60                 1.352046e-03 3 1  ON 59
ci_61                 1.834723e-03 3 1  ON 60
ci_62                -4.335784e-04 3 1  ON 61
ci_63                -6.685117e-05 3 1  ON 62
ci_64                -9.494908e-04 3 1  ON 63
ci_65                 1.311798e-04 3 1  ON 64
ci_66                -6.936161e-04 3 1  ON 65
ci_67                -6.513436e-04 3 1  ON 66
ci_68                -1.365266e-03 3 1  ON 67
ci_69                -1.606988e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.3657e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s005 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s005 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=5  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2797e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 5
    time step          = 0.05
    reference energy   = -22.8245
    reference variance = 0.492625
====================================================
  Execution time = 2.5994e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s005
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5345e+04
  VMC Eavg = -2.2819e+01
  VMC Evar = 4.8288e-01
  Total weights = 1.963564939e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.6391e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.469012948500
                                         uncertainty =       0.001881915771

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.469012948500
                                         uncertainty =       0.001881915771

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000484277067
  error estimate for blocks of size 2^( 2) =       0.000505759535
  error estimate for blocks of size 2^( 3) =       0.000526012476
  error estimate for blocks of size 2^( 4) =       0.000541719442
  error estimate for blocks of size 2^( 5) =       0.000550936067
  error estimate for blocks of size 2^( 6) =       0.000555401401
  error estimate for blocks of size 2^( 7) =       0.000558561760

      target function =                  N/A
              le_mean =     -22.818909239037
             les_mean =     521.185496105916
             stat err =       0.000551654668
             autocorr =       1.297617781432
              std dev =       0.684871195407
             le_variance =       0.469048554298


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281890923904e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.2500e+02, overlap shift 6.2500e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.818909238965       residual = 2.73e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.818909266817       residual = 5.51e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.818909267578       residual = 1.51e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.818909267712       residual = 2.92e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 6.2500e+02 is 1.365943e-06

solving harmonic davidson linear method for identity shift 2.5000e+03, overlap shift 2.5000e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.818909238965       residual = 2.73e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.818909245929       residual = 5.51e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.818909246119       residual = 1.51e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.818909246153       residual = 2.93e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.5000e+03 is 3.415209e-07

solving harmonic davidson linear method for identity shift 1.0000e+04, overlap shift 1.0000e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.818909238965       residual = 2.73e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.818909240706       residual = 5.51e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.818909240753       residual = 1.51e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.818909240762       residual = 2.93e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.0000e+04 is 8.538244e-08

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.010555 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0643e+01
  </log>
  <optVariables href="FORM.s005.opt.xml">
ci_01                 1.274303e-01 3 1  ON 0
ci_02                -2.884221e-02 3 1  ON 1
ci_03                -2.859399e-02 3 1  ON 2
ci_04                 2.613765e-02 3 1  ON 3
ci_05                -2.402271e-02 3 1  ON 4
ci_06                -2.362322e-02 3 1  ON 5
ci_07                 2.584734e-02 3 1  ON 6
ci_08                -5.199435e-03 3 1  ON 7
ci_09                -1.173885e-02 3 1  ON 8
ci_10                -1.143626e-02 3 1  ON 9
ci_11                 1.571613e-02 3 1  ON 10
ci_12                 1.061109e-02 3 1  ON 11
ci_13                 1.147684e-02 3 1  ON 12
ci_14                 1.483950e-02 3 1  ON 13
ci_15                 8.683211e-03 3 1  ON 14
ci_16                 8.465727e-03 3 1  ON 15
ci_17                -9.898237e-03 3 1  ON 16
ci_18                -9.976916e-03 3 1  ON 17
ci_19                 9.786908e-03 3 1  ON 18
ci_20                 1.059298e-02 3 1  ON 19
ci_21                 7.589230e-03 3 1  ON 20
ci_22                 9.217539e-03 3 1  ON 21
ci_23                 6.526776e-03 3 1  ON 22
ci_24                 6.510087e-03 3 1  ON 23
ci_25                 5.207224e-03 3 1  ON 24
ci_26                 3.780600e-03 3 1  ON 25
ci_27                 3.062106e-03 3 1  ON 26
ci_28                 4.595358e-03 3 1  ON 27
ci_29                 4.636372e-03 3 1  ON 28
ci_30                -4.188206e-04 3 1  ON 29
ci_31                -4.999721e-04 3 1  ON 30
ci_32                -2.068320e-05 3 1  ON 31
ci_33                -4.708543e-04 3 1  ON 32
ci_34                 1.725220e-04 3 1  ON 33
ci_35                -2.506341e-04 3 1  ON 34
ci_36                -9.113544e-04 3 1  ON 35
ci_37                -8.637640e-04 3 1  ON 36
ci_38                -1.303446e-04 3 1  ON 37
ci_39                -2.815368e-04 3 1  ON 38
ci_40                -1.217442e-03 3 1  ON 39
ci_41                 5.906117e-04 3 1  ON 40
ci_42                 2.374305e-04 3 1  ON 41
ci_43                -2.483510e-03 3 1  ON 42
ci_44                -1.668262e-03 3 1  ON 43
ci_45                -4.929793e-04 3 1  ON 44
ci_46                -4.854617e-04 3 1  ON 45
ci_47                -1.580595e-03 3 1  ON 46
ci_48                -2.027097e-03 3 1  ON 47
ci_49                -1.688508e-03 3 1  ON 48
ci_50                -5.832096e-04 3 1  ON 49
ci_51                 5.814212e-04 3 1  ON 50
ci_52                 3.067083e-05 3 1  ON 51
ci_53                -9.292809e-04 3 1  ON 52
ci_54                -4.899997e-04 3 1  ON 53
ci_55                -6.872511e-04 3 1  ON 54
ci_56                 1.580070e-03 3 1  ON 55
ci_57                 1.604720e-03 3 1  ON 56
ci_58                -9.149640e-04 3 1  ON 57
ci_59                -9.968380e-04 3 1  ON 58
ci_60                 1.351979e-03 3 1  ON 59
ci_61                 1.834677e-03 3 1  ON 60
ci_62                -4.336320e-04 3 1  ON 61
ci_63                -6.690977e-05 3 1  ON 62
ci_64                -9.495713e-04 3 1  ON 63
ci_65                 1.310863e-04 3 1  ON 64
ci_66                -6.936175e-04 3 1  ON 65
ci_67                -6.513785e-04 3 1  ON 66
ci_68                -1.365195e-03 3 1  ON 67
ci_69                -1.607018e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 5
    time step          = 0.05
    reference energy   = -22.8438
    reference variance = 0.32793
====================================================
  Execution time = 2.5238e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s005
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2819e+01
  VMC Evar = 4.9186e-01
  Total weights = 1.9637e+06
  Execution time = 3.5717e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.473910031402
                                         uncertainty =       0.002258980246

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.473910031402
                                         uncertainty =       0.002258980246

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000486796670
  error estimate for blocks of size 2^( 2) =       0.000507763119
  error estimate for blocks of size 2^( 3) =       0.000527487440
  error estimate for blocks of size 2^( 4) =       0.000542932156
  error estimate for blocks of size 2^( 5) =       0.000551991306
  error estimate for blocks of size 2^( 6) =       0.000556689564
  error estimate for blocks of size 2^( 7) =       0.000560102105

      target function =                  N/A
              le_mean =     -22.819353022785
             les_mean =     521.214727487491
             stat err =       0.000552928782
             autocorr =       1.290158882511
              std dev =       0.688434453526
             le_variance =       0.473941996801

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.473909785811
                                         uncertainty =       0.002258982027

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.473909785811
                                         uncertainty =       0.002258982027

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000486796545
  error estimate for blocks of size 2^( 2) =       0.000507763021
  error estimate for blocks of size 2^( 3) =       0.000527487374
  error estimate for blocks of size 2^( 4) =       0.000542932123
  error estimate for blocks of size 2^( 5) =       0.000551991305
  error estimate for blocks of size 2^( 6) =       0.000556689567
  error estimate for blocks of size 2^( 7) =       0.000560102149

      target function =                  N/A
              le_mean =     -22.819353025915
             les_mean =     521.214734208933
             stat err =       0.000552928786
             autocorr =       1.290159563857
              std dev =       0.688434276101
             le_variance =       0.473941752511

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.473909908564
                                         uncertainty =       0.002258981136

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.473909908564
                                         uncertainty =       0.002258981136

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000486796608
  error estimate for blocks of size 2^( 2) =       0.000507763070
  error estimate for blocks of size 2^( 3) =       0.000527487407
  error estimate for blocks of size 2^( 4) =       0.000542932139
  error estimate for blocks of size 2^( 5) =       0.000551991306
  error estimate for blocks of size 2^( 6) =       0.000556689565
  error estimate for blocks of size 2^( 7) =       0.000560102127

      target function =                  N/A
              le_mean =     -22.819353024347
             les_mean =     521.214730819412
             stat err =       0.000552928784
             autocorr =       1.290159223274
              std dev =       0.688434364782
             le_variance =       0.473941874613

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.473910016044
                                         uncertainty =       0.002258980357

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.473910016044
                                         uncertainty =       0.002258980357

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000486796663
  error estimate for blocks of size 2^( 2) =       0.000507763113
  error estimate for blocks of size 2^( 3) =       0.000527487436
  error estimate for blocks of size 2^( 4) =       0.000542932154
  error estimate for blocks of size 2^( 5) =       0.000551991306
  error estimate for blocks of size 2^( 6) =       0.000556689564
  error estimate for blocks of size 2^( 7) =       0.000560102107

      target function =                  N/A
              le_mean =     -22.819353022980
             les_mean =     521.214727900637
             stat err =       0.000552928783
             autocorr =       1.290158925118
              std dev =       0.688434442430
             le_variance =       0.473941981524


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.819353022785        initial
     6.2500e+02     6.2500e+03             1.3659e-06       -22.819353025915  <--
     2.5000e+03     2.5000e+04             3.4152e-07       -22.819353024347
     1.0000e+04     1.0000e+05             8.5382e-08       -22.819353022980

*****************************************************************************
Applying the update for shift_i =   6.2500e+02     and shift_s =   6.2500e+03
*****************************************************************************

  Execution time = 4.3149e+01
  </log>
  <optVariables href="FORM.s005.opt.xml">
ci_01                 1.274293e-01 3 1  ON 0
ci_02                -2.884159e-02 3 1  ON 1
ci_03                -2.859339e-02 3 1  ON 2
ci_04                 2.613731e-02 3 1  ON 3
ci_05                -2.402271e-02 3 1  ON 4
ci_06                -2.362309e-02 3 1  ON 5
ci_07                 2.584727e-02 3 1  ON 6
ci_08                -5.199224e-03 3 1  ON 7
ci_09                -1.173865e-02 3 1  ON 8
ci_10                -1.143626e-02 3 1  ON 9
ci_11                 1.571610e-02 3 1  ON 10
ci_12                 1.061099e-02 3 1  ON 11
ci_13                 1.147701e-02 3 1  ON 12
ci_14                 1.483953e-02 3 1  ON 13
ci_15                 8.682921e-03 3 1  ON 14
ci_16                 8.465929e-03 3 1  ON 15
ci_17                -9.898215e-03 3 1  ON 16
ci_18                -9.976821e-03 3 1  ON 17
ci_19                 9.787022e-03 3 1  ON 18
ci_20                 1.059290e-02 3 1  ON 19
ci_21                 7.589354e-03 3 1  ON 20
ci_22                 9.217258e-03 3 1  ON 21
ci_23                 6.526707e-03 3 1  ON 22
ci_24                 6.509927e-03 3 1  ON 23
ci_25                 5.207352e-03 3 1  ON 24
ci_26                 3.780522e-03 3 1  ON 25
ci_27                 3.061927e-03 3 1  ON 26
ci_28                 4.595236e-03 3 1  ON 27
ci_29                 4.636340e-03 3 1  ON 28
ci_30                -4.186993e-04 3 1  ON 29
ci_31                -5.000872e-04 3 1  ON 30
ci_32                -2.069118e-05 3 1  ON 31
ci_33                -4.711667e-04 3 1  ON 32
ci_34                 1.727302e-04 3 1  ON 33
ci_35                -2.503090e-04 3 1  ON 34
ci_36                -9.115965e-04 3 1  ON 35
ci_37                -8.635399e-04 3 1  ON 36
ci_38                -1.301538e-04 3 1  ON 37
ci_39                -2.816774e-04 3 1  ON 38
ci_40                -1.217702e-03 3 1  ON 39
ci_41                 5.906370e-04 3 1  ON 40
ci_42                 2.373969e-04 3 1  ON 41
ci_43                -2.483204e-03 3 1  ON 42
ci_44                -1.668802e-03 3 1  ON 43
ci_45                -4.929739e-04 3 1  ON 44
ci_46                -4.854040e-04 3 1  ON 45
ci_47                -1.580578e-03 3 1  ON 46
ci_48                -2.026853e-03 3 1  ON 47
ci_49                -1.688415e-03 3 1  ON 48
ci_50                -5.830834e-04 3 1  ON 49
ci_51                 5.812471e-04 3 1  ON 50
ci_52                 3.074144e-05 3 1  ON 51
ci_53                -9.293703e-04 3 1  ON 52
ci_54                -4.902979e-04 3 1  ON 53
ci_55                -6.874471e-04 3 1  ON 54
ci_56                 1.579890e-03 3 1  ON 55
ci_57                 1.604779e-03 3 1  ON 56
ci_58                -9.150606e-04 3 1  ON 57
ci_59                -9.968156e-04 3 1  ON 58
ci_60                 1.351777e-03 3 1  ON 59
ci_61                 1.834539e-03 3 1  ON 60
ci_62                -4.337927e-04 3 1  ON 61
ci_63                -6.708546e-05 3 1  ON 62
ci_64                -9.498128e-04 3 1  ON 63
ci_65                 1.308058e-04 3 1  ON 64
ci_66                -6.936219e-04 3 1  ON 65
ci_67                -6.514834e-04 3 1  ON 66
ci_68                -1.364983e-03 3 1  ON 67
ci_69                -1.607109e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.3798e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s006 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s006 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=6  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2803e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 6
    time step          = 0.05
    reference energy   = -22.854
    reference variance = 0.595549
====================================================
  Execution time = 2.5747e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s006
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5335e+04
  VMC Eavg = -2.2819e+01
  VMC Evar = 4.9516e-01
  Total weights = 1.963893457e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.6118e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.476065954436
                                         uncertainty =       0.003545177824

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.476065954436
                                         uncertainty =       0.003545177824

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000487862622
  error estimate for blocks of size 2^( 2) =       0.000509270936
  error estimate for blocks of size 2^( 3) =       0.000529223481
  error estimate for blocks of size 2^( 4) =       0.000544404767
  error estimate for blocks of size 2^( 5) =       0.000555098426
  error estimate for blocks of size 2^( 6) =       0.000562182662
  error estimate for blocks of size 2^( 7) =       0.000564729287

      target function =                  N/A
              le_mean =     -22.818660539621
             les_mean =     521.186433396097
             stat err =       0.000556603785
             autocorr =       1.301658984350
              std dev =       0.689941936297
             le_variance =       0.476019875461


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281866053962e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5625e+02, overlap shift 1.5625e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.818660539561       residual = 3.13e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.818660653098       residual = 7.08e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.818660658422       residual = 1.86e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.818660659851       residual = 3.51e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.5625e+02 is 6.214780e-06

solving harmonic davidson linear method for identity shift 6.2500e+02, overlap shift 6.2500e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.818660539561       residual = 3.13e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.818660567967       residual = 7.09e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.818660569295       residual = 1.87e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.818660569653       residual = 3.53e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 6.2500e+02 is 1.554360e-06

solving harmonic davidson linear method for identity shift 2.5000e+03, overlap shift 2.5000e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.818660539561       residual = 3.13e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.818660546664       residual = 7.10e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.818660546995       residual = 1.87e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.818660547085       residual = 3.54e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.5000e+03 is 3.886316e-07

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.011925 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0368e+01
  </log>
  <optVariables href="FORM.s006.opt.xml">
ci_01                 1.274277e-01 3 1  ON 0
ci_02                -2.884064e-02 3 1  ON 1
ci_03                -2.859265e-02 3 1  ON 2
ci_04                 2.613685e-02 3 1  ON 3
ci_05                -2.402222e-02 3 1  ON 4
ci_06                -2.362264e-02 3 1  ON 5
ci_07                 2.584705e-02 3 1  ON 6
ci_08                -5.199156e-03 3 1  ON 7
ci_09                -1.173828e-02 3 1  ON 8
ci_10                -1.143599e-02 3 1  ON 9
ci_11                 1.571612e-02 3 1  ON 10
ci_12                 1.061153e-02 3 1  ON 11
ci_13                 1.147724e-02 3 1  ON 12
ci_14                 1.483974e-02 3 1  ON 13
ci_15                 8.682746e-03 3 1  ON 14
ci_16                 8.466015e-03 3 1  ON 15
ci_17                -9.898318e-03 3 1  ON 16
ci_18                -9.977032e-03 3 1  ON 17
ci_19                 9.787120e-03 3 1  ON 18
ci_20                 1.059280e-02 3 1  ON 19
ci_21                 7.589210e-03 3 1  ON 20
ci_22                 9.216801e-03 3 1  ON 21
ci_23                 6.526274e-03 3 1  ON 22
ci_24                 6.509570e-03 3 1  ON 23
ci_25                 5.206938e-03 3 1  ON 24
ci_26                 3.780139e-03 3 1  ON 25
ci_27                 3.061912e-03 3 1  ON 26
ci_28                 4.594922e-03 3 1  ON 27
ci_29                 4.635953e-03 3 1  ON 28
ci_30                -4.186216e-04 3 1  ON 29
ci_31                -4.998881e-04 3 1  ON 30
ci_32                -2.070960e-05 3 1  ON 31
ci_33                -4.710415e-04 3 1  ON 32
ci_34                 1.727041e-04 3 1  ON 33
ci_35                -2.502926e-04 3 1  ON 34
ci_36                -9.114879e-04 3 1  ON 35
ci_37                -8.636025e-04 3 1  ON 36
ci_38                -1.304519e-04 3 1  ON 37
ci_39                -2.815765e-04 3 1  ON 38
ci_40                -1.217909e-03 3 1  ON 39
ci_41                 5.902393e-04 3 1  ON 40
ci_42                 2.375474e-04 3 1  ON 41
ci_43                -2.483291e-03 3 1  ON 42
ci_44                -1.669013e-03 3 1  ON 43
ci_45                -4.933021e-04 3 1  ON 44
ci_46                -4.849739e-04 3 1  ON 45
ci_47                -1.580156e-03 3 1  ON 46
ci_48                -2.026355e-03 3 1  ON 47
ci_49                -1.688446e-03 3 1  ON 48
ci_50                -5.831414e-04 3 1  ON 49
ci_51                 5.812503e-04 3 1  ON 50
ci_52                 3.060431e-05 3 1  ON 51
ci_53                -9.297861e-04 3 1  ON 52
ci_54                -4.903238e-04 3 1  ON 53
ci_55                -6.874910e-04 3 1  ON 54
ci_56                 1.580034e-03 3 1  ON 55
ci_57                 1.604961e-03 3 1  ON 56
ci_58                -9.155806e-04 3 1  ON 57
ci_59                -9.966987e-04 3 1  ON 58
ci_60                 1.351841e-03 3 1  ON 59
ci_61                 1.834529e-03 3 1  ON 60
ci_62                -4.338661e-04 3 1  ON 61
ci_63                -6.733251e-05 3 1  ON 62
ci_64                -9.497489e-04 3 1  ON 63
ci_65                 1.301859e-04 3 1  ON 64
ci_66                -6.934937e-04 3 1  ON 65
ci_67                -6.509915e-04 3 1  ON 66
ci_68                -1.364995e-03 3 1  ON 67
ci_69                -1.606577e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 6
    time step          = 0.05
    reference energy   = -22.8285
    reference variance = 0.31828
====================================================
  Execution time = 2.5231e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s006
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2819e+01
  VMC Evar = 4.9132e-01
  Total weights = 1.9635e+06
  Execution time = 3.5809e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.473135392939
                                         uncertainty =       0.002212217877

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.473135392939
                                         uncertainty =       0.002212217877

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000486316933
  error estimate for blocks of size 2^( 2) =       0.000507729693
  error estimate for blocks of size 2^( 3) =       0.000527788958
  error estimate for blocks of size 2^( 4) =       0.000542064399
  error estimate for blocks of size 2^( 5) =       0.000550751704
  error estimate for blocks of size 2^( 6) =       0.000554869330
  error estimate for blocks of size 2^( 7) =       0.000559343182

      target function =                  N/A
              le_mean =     -22.818819834828
             les_mean =     521.189852364431
             stat err =       0.000551757154
             autocorr =       1.287232990120
              std dev =       0.687756002854
             le_variance =       0.473008319462

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.473134479454
                                         uncertainty =       0.002212241816

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.473134479454
                                         uncertainty =       0.002212241816

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000486316464
  error estimate for blocks of size 2^( 2) =       0.000507729363
  error estimate for blocks of size 2^( 3) =       0.000527788759
  error estimate for blocks of size 2^( 4) =       0.000542064361
  error estimate for blocks of size 2^( 5) =       0.000550751805
  error estimate for blocks of size 2^( 6) =       0.000554869471
  error estimate for blocks of size 2^( 7) =       0.000559343366

      target function =                  N/A
              le_mean =     -22.818819817497
             les_mean =     521.189858218460
             stat err =       0.000551757251
             autocorr =       1.287235924655
              std dev =       0.687755339583
             le_variance =       0.473007407124

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.473134935424
                                         uncertainty =       0.002212229856

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.473134935424
                                         uncertainty =       0.002212229856

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000486316699
  error estimate for blocks of size 2^( 2) =       0.000507729528
  error estimate for blocks of size 2^( 3) =       0.000527788858
  error estimate for blocks of size 2^( 4) =       0.000542064380
  error estimate for blocks of size 2^( 5) =       0.000550751754
  error estimate for blocks of size 2^( 6) =       0.000554869400
  error estimate for blocks of size 2^( 7) =       0.000559343274

      target function =                  N/A
              le_mean =     -22.818819826061
             les_mean =     521.189855083992
             stat err =       0.000551757202
             autocorr =       1.287234458533
              std dev =       0.687755670657
             le_variance =       0.473007862521

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.473135335693
                                         uncertainty =       0.002212219374

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.473135335693
                                         uncertainty =       0.002212219374

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000486316904
  error estimate for blocks of size 2^( 2) =       0.000507729673
  error estimate for blocks of size 2^( 3) =       0.000527788945
  error estimate for blocks of size 2^( 4) =       0.000542064397
  error estimate for blocks of size 2^( 5) =       0.000550751710
  error estimate for blocks of size 2^( 6) =       0.000554869339
  error estimate for blocks of size 2^( 7) =       0.000559343193

      target function =                  N/A
              le_mean =     -22.818819833722
             les_mean =     521.189852683161
             stat err =       0.000551757160
             autocorr =       1.287233173714
              std dev =       0.687755961289
             le_variance =       0.473008262288


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.818819834828        initial  <--
     1.5625e+02     1.5625e+03             6.2148e-06       -22.818819817497
     6.2500e+02     6.2500e+03             1.5544e-06       -22.818819826061
     2.5000e+03     2.5000e+04             3.8863e-07       -22.818819833722

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 44.6952
  </log>
  <optVariables href="FORM.s006.opt.xml">
ci_01                 1.274293e-01 3 1  ON 0
ci_02                -2.884159e-02 3 1  ON 1
ci_03                -2.859339e-02 3 1  ON 2
ci_04                 2.613731e-02 3 1  ON 3
ci_05                -2.402271e-02 3 1  ON 4
ci_06                -2.362309e-02 3 1  ON 5
ci_07                 2.584727e-02 3 1  ON 6
ci_08                -5.199224e-03 3 1  ON 7
ci_09                -1.173865e-02 3 1  ON 8
ci_10                -1.143626e-02 3 1  ON 9
ci_11                 1.571610e-02 3 1  ON 10
ci_12                 1.061099e-02 3 1  ON 11
ci_13                 1.147701e-02 3 1  ON 12
ci_14                 1.483953e-02 3 1  ON 13
ci_15                 8.682921e-03 3 1  ON 14
ci_16                 8.465929e-03 3 1  ON 15
ci_17                -9.898215e-03 3 1  ON 16
ci_18                -9.976821e-03 3 1  ON 17
ci_19                 9.787022e-03 3 1  ON 18
ci_20                 1.059290e-02 3 1  ON 19
ci_21                 7.589354e-03 3 1  ON 20
ci_22                 9.217258e-03 3 1  ON 21
ci_23                 6.526707e-03 3 1  ON 22
ci_24                 6.509927e-03 3 1  ON 23
ci_25                 5.207352e-03 3 1  ON 24
ci_26                 3.780522e-03 3 1  ON 25
ci_27                 3.061927e-03 3 1  ON 26
ci_28                 4.595236e-03 3 1  ON 27
ci_29                 4.636340e-03 3 1  ON 28
ci_30                -4.186993e-04 3 1  ON 29
ci_31                -5.000872e-04 3 1  ON 30
ci_32                -2.069118e-05 3 1  ON 31
ci_33                -4.711667e-04 3 1  ON 32
ci_34                 1.727302e-04 3 1  ON 33
ci_35                -2.503090e-04 3 1  ON 34
ci_36                -9.115965e-04 3 1  ON 35
ci_37                -8.635399e-04 3 1  ON 36
ci_38                -1.301538e-04 3 1  ON 37
ci_39                -2.816774e-04 3 1  ON 38
ci_40                -1.217702e-03 3 1  ON 39
ci_41                 5.906370e-04 3 1  ON 40
ci_42                 2.373969e-04 3 1  ON 41
ci_43                -2.483204e-03 3 1  ON 42
ci_44                -1.668802e-03 3 1  ON 43
ci_45                -4.929739e-04 3 1  ON 44
ci_46                -4.854040e-04 3 1  ON 45
ci_47                -1.580578e-03 3 1  ON 46
ci_48                -2.026853e-03 3 1  ON 47
ci_49                -1.688415e-03 3 1  ON 48
ci_50                -5.830834e-04 3 1  ON 49
ci_51                 5.812471e-04 3 1  ON 50
ci_52                 3.074144e-05 3 1  ON 51
ci_53                -9.293703e-04 3 1  ON 52
ci_54                -4.902979e-04 3 1  ON 53
ci_55                -6.874471e-04 3 1  ON 54
ci_56                 1.579890e-03 3 1  ON 55
ci_57                 1.604779e-03 3 1  ON 56
ci_58                -9.150606e-04 3 1  ON 57
ci_59                -9.968156e-04 3 1  ON 58
ci_60                 1.351777e-03 3 1  ON 59
ci_61                 1.834539e-03 3 1  ON 60
ci_62                -4.337927e-04 3 1  ON 61
ci_63                -6.708546e-05 3 1  ON 62
ci_64                -9.498128e-04 3 1  ON 63
ci_65                 1.308058e-04 3 1  ON 64
ci_66                -6.936219e-04 3 1  ON 65
ci_67                -6.514834e-04 3 1  ON 66
ci_68                -1.364983e-03 3 1  ON 67
ci_69                -1.607109e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.5070e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s007 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s007 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=7  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2808e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 7
    time step          = 0.05
    reference energy   = -22.8882
    reference variance = 0.580812
====================================================
  Execution time = 2.5757e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s007
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5316e+04
  VMC Eavg = -2.2819e+01
  VMC Evar = 4.9887e-01
  Total weights = 1.963732907e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.6432e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.480432960577
                                         uncertainty =       0.004824807822

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.480432960577
                                         uncertainty =       0.004824807822

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000490114077
  error estimate for blocks of size 2^( 2) =       0.000511159892
  error estimate for blocks of size 2^( 3) =       0.000531302573
  error estimate for blocks of size 2^( 4) =       0.000546395326
  error estimate for blocks of size 2^( 5) =       0.000556175368
  error estimate for blocks of size 2^( 6) =       0.000560882916
  error estimate for blocks of size 2^( 7) =       0.000562323602

      target function =                  N/A
              le_mean =     -22.818936683591
             les_mean =     521.202737655491
             stat err =       0.000556444303
             autocorr =       1.288988512724
              std dev =       0.693125975378
             le_variance =       0.480423617744


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281893668359e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5625e+03, overlap shift 1.5625e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.818936683521       residual = 3.39e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.818936692873       residual = 8.77e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.818936693603       residual = 2.29e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.818936693706       residual = 8.31e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.5625e+03 is 7.375939e-07

solving harmonic davidson linear method for identity shift 6.2500e+03, overlap shift 6.2500e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.818936683521       residual = 3.39e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.818936685859       residual = 8.77e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.818936686041       residual = 2.29e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.818936686068       residual = 8.32e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 6.2500e+03 is 1.844068e-07

solving harmonic davidson linear method for identity shift 2.5000e+04, overlap shift 2.5000e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.818936683521       residual = 3.39e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.818936684105       residual = 8.77e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.818936684151       residual = 2.29e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.818936684158       residual = 8.32e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.5000e+04 is 4.610223e-08

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.013311 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0410e+01
  </log>
  <optVariables href="FORM.s007.opt.xml">
ci_01                 1.274291e-01 3 1  ON 0
ci_02                -2.884149e-02 3 1  ON 1
ci_03                -2.859329e-02 3 1  ON 2
ci_04                 2.613724e-02 3 1  ON 3
ci_05                -2.402265e-02 3 1  ON 4
ci_06                -2.362308e-02 3 1  ON 5
ci_07                 2.584727e-02 3 1  ON 6
ci_08                -5.199218e-03 3 1  ON 7
ci_09                -1.173864e-02 3 1  ON 8
ci_10                -1.143621e-02 3 1  ON 9
ci_11                 1.571612e-02 3 1  ON 10
ci_12                 1.061098e-02 3 1  ON 11
ci_13                 1.147702e-02 3 1  ON 12
ci_14                 1.483956e-02 3 1  ON 13
ci_15                 8.682913e-03 3 1  ON 14
ci_16                 8.465919e-03 3 1  ON 15
ci_17                -9.898232e-03 3 1  ON 16
ci_18                -9.976839e-03 3 1  ON 17
ci_19                 9.786990e-03 3 1  ON 18
ci_20                 1.059287e-02 3 1  ON 19
ci_21                 7.589371e-03 3 1  ON 20
ci_22                 9.217235e-03 3 1  ON 21
ci_23                 6.526695e-03 3 1  ON 22
ci_24                 6.509966e-03 3 1  ON 23
ci_25                 5.207344e-03 3 1  ON 24
ci_26                 3.780481e-03 3 1  ON 25
ci_27                 3.061957e-03 3 1  ON 26
ci_28                 4.595266e-03 3 1  ON 27
ci_29                 4.636359e-03 3 1  ON 28
ci_30                -4.186783e-04 3 1  ON 29
ci_31                -5.000397e-04 3 1  ON 30
ci_32                -2.067467e-05 3 1  ON 31
ci_33                -4.711861e-04 3 1  ON 32
ci_34                 1.727450e-04 3 1  ON 33
ci_35                -2.503152e-04 3 1  ON 34
ci_36                -9.116078e-04 3 1  ON 35
ci_37                -8.635585e-04 3 1  ON 36
ci_38                -1.301542e-04 3 1  ON 37
ci_39                -2.817033e-04 3 1  ON 38
ci_40                -1.217724e-03 3 1  ON 39
ci_41                 5.906600e-04 3 1  ON 40
ci_42                 2.374191e-04 3 1  ON 41
ci_43                -2.483212e-03 3 1  ON 42
ci_44                -1.668801e-03 3 1  ON 43
ci_45                -4.929728e-04 3 1  ON 44
ci_46                -4.854081e-04 3 1  ON 45
ci_47                -1.580581e-03 3 1  ON 46
ci_48                -2.026833e-03 3 1  ON 47
ci_49                -1.688409e-03 3 1  ON 48
ci_50                -5.830755e-04 3 1  ON 49
ci_51                 5.812449e-04 3 1  ON 50
ci_52                 3.074201e-05 3 1  ON 51
ci_53                -9.293807e-04 3 1  ON 52
ci_54                -4.903344e-04 3 1  ON 53
ci_55                -6.874407e-04 3 1  ON 54
ci_56                 1.579878e-03 3 1  ON 55
ci_57                 1.604785e-03 3 1  ON 56
ci_58                -9.150493e-04 3 1  ON 57
ci_59                -9.967937e-04 3 1  ON 58
ci_60                 1.351774e-03 3 1  ON 59
ci_61                 1.834524e-03 3 1  ON 60
ci_62                -4.337806e-04 3 1  ON 61
ci_63                -6.706203e-05 3 1  ON 62
ci_64                -9.498158e-04 3 1  ON 63
ci_65                 1.307438e-04 3 1  ON 64
ci_66                -6.935786e-04 3 1  ON 65
ci_67                -6.514650e-04 3 1  ON 66
ci_68                -1.364926e-03 3 1  ON 67
ci_69                -1.607109e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 7
    time step          = 0.05
    reference energy   = -22.7834
    reference variance = 0.48514
====================================================
  Execution time = 2.4992e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s007
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2819e+01
  VMC Evar = 4.8879e-01
  Total weights = 1.9633e+06
  Execution time = 3.5876e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.473270195808
                                         uncertainty =       0.002142320881

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.473270195808
                                         uncertainty =       0.002142320881

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000486417576
  error estimate for blocks of size 2^( 2) =       0.000507187620
  error estimate for blocks of size 2^( 3) =       0.000527282557
  error estimate for blocks of size 2^( 4) =       0.000542834646
  error estimate for blocks of size 2^( 5) =       0.000553398581
  error estimate for blocks of size 2^( 6) =       0.000558331846
  error estimate for blocks of size 2^( 7) =       0.000559295425

      target function =                  N/A
              le_mean =     -22.819074825745
             les_mean =     521.198964782105
             stat err =       0.000553465125
             autocorr =       1.294678697867
              std dev =       0.687898332290
             le_variance =       0.473204115568

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.473270059867
                                         uncertainty =       0.002142319127

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.473270059867
                                         uncertainty =       0.002142319127

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000486417506
  error estimate for blocks of size 2^( 2) =       0.000507187566
  error estimate for blocks of size 2^( 3) =       0.000527282523
  error estimate for blocks of size 2^( 4) =       0.000542834623
  error estimate for blocks of size 2^( 5) =       0.000553398568
  error estimate for blocks of size 2^( 6) =       0.000558331839
  error estimate for blocks of size 2^( 7) =       0.000559295439

      target function =                  N/A
              le_mean =     -22.819074826320
             les_mean =     521.198966572136
             stat err =       0.000553465118
             autocorr =       1.294679036253
              std dev =       0.687898233692
             le_variance =       0.473203979916

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.473270127829
                                         uncertainty =       0.002142320004

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.473270127829
                                         uncertainty =       0.002142320004

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000486417541
  error estimate for blocks of size 2^( 2) =       0.000507187593
  error estimate for blocks of size 2^( 3) =       0.000527282540
  error estimate for blocks of size 2^( 4) =       0.000542834635
  error estimate for blocks of size 2^( 5) =       0.000553398575
  error estimate for blocks of size 2^( 6) =       0.000558331843
  error estimate for blocks of size 2^( 7) =       0.000559295432

      target function =                  N/A
              le_mean =     -22.819074826033
             les_mean =     521.198965612974
             stat err =       0.000553465121
             autocorr =       1.294678867080
              std dev =       0.687898282985
             le_variance =       0.473204047734

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.473270187310
                                         uncertainty =       0.002142320772

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.473270187310
                                         uncertainty =       0.002142320772

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000486417571
  error estimate for blocks of size 2^( 2) =       0.000507187617
  error estimate for blocks of size 2^( 3) =       0.000527282555
  error estimate for blocks of size 2^( 4) =       0.000542834645
  error estimate for blocks of size 2^( 5) =       0.000553398580
  error estimate for blocks of size 2^( 6) =       0.000558331846
  error estimate for blocks of size 2^( 7) =       0.000559295426

      target function =                  N/A
              le_mean =     -22.819074825781
             les_mean =     521.198964879963
             stat err =       0.000553465124
             autocorr =       1.294678719024
              std dev =       0.687898326127
             le_variance =       0.473204107089


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.819074825745        initial
     1.5625e+03     1.5625e+04             7.3759e-07       -22.819074826320  <--
     6.2500e+03     6.2500e+04             1.8441e-07       -22.819074826033
     2.5000e+04     2.5000e+05             4.6102e-08       -22.819074825781

*****************************************************************************
Applying the update for shift_i =   1.5625e+03     and shift_s =   1.5625e+04
*****************************************************************************

  Execution time = 4.2989e+01
  </log>
  <optVariables href="FORM.s007.opt.xml">
ci_01                 1.274285e-01 3 1  ON 0
ci_02                -2.884118e-02 3 1  ON 1
ci_03                -2.859297e-02 3 1  ON 2
ci_04                 2.613701e-02 3 1  ON 3
ci_05                -2.402247e-02 3 1  ON 4
ci_06                -2.362304e-02 3 1  ON 5
ci_07                 2.584727e-02 3 1  ON 6
ci_08                -5.199198e-03 3 1  ON 7
ci_09                -1.173860e-02 3 1  ON 8
ci_10                -1.143607e-02 3 1  ON 9
ci_11                 1.571616e-02 3 1  ON 10
ci_12                 1.061096e-02 3 1  ON 11
ci_13                 1.147706e-02 3 1  ON 12
ci_14                 1.483963e-02 3 1  ON 13
ci_15                 8.682887e-03 3 1  ON 14
ci_16                 8.465888e-03 3 1  ON 15
ci_17                -9.898285e-03 3 1  ON 16
ci_18                -9.976895e-03 3 1  ON 17
ci_19                 9.786896e-03 3 1  ON 18
ci_20                 1.059278e-02 3 1  ON 19
ci_21                 7.589421e-03 3 1  ON 20
ci_22                 9.217166e-03 3 1  ON 21
ci_23                 6.526660e-03 3 1  ON 22
ci_24                 6.510084e-03 3 1  ON 23
ci_25                 5.207323e-03 3 1  ON 24
ci_26                 3.780356e-03 3 1  ON 25
ci_27                 3.062049e-03 3 1  ON 26
ci_28                 4.595355e-03 3 1  ON 27
ci_29                 4.636414e-03 3 1  ON 28
ci_30                -4.186151e-04 3 1  ON 29
ci_31                -4.998971e-04 3 1  ON 30
ci_32                -2.062516e-05 3 1  ON 31
ci_33                -4.712442e-04 3 1  ON 32
ci_34                 1.727894e-04 3 1  ON 33
ci_35                -2.503339e-04 3 1  ON 34
ci_36                -9.116417e-04 3 1  ON 35
ci_37                -8.636142e-04 3 1  ON 36
ci_38                -1.301555e-04 3 1  ON 37
ci_39                -2.817810e-04 3 1  ON 38
ci_40                -1.217789e-03 3 1  ON 39
ci_41                 5.907289e-04 3 1  ON 40
ci_42                 2.374857e-04 3 1  ON 41
ci_43                -2.483237e-03 3 1  ON 42
ci_44                -1.668798e-03 3 1  ON 43
ci_45                -4.929692e-04 3 1  ON 44
ci_46                -4.854205e-04 3 1  ON 45
ci_47                -1.580593e-03 3 1  ON 46
ci_48                -2.026773e-03 3 1  ON 47
ci_49                -1.688389e-03 3 1  ON 48
ci_50                -5.830520e-04 3 1  ON 49
ci_51                 5.812380e-04 3 1  ON 50
ci_52                 3.074371e-05 3 1  ON 51
ci_53                -9.294119e-04 3 1  ON 52
ci_54                -4.904440e-04 3 1  ON 53
ci_55                -6.874216e-04 3 1  ON 54
ci_56                 1.579844e-03 3 1  ON 55
ci_57                 1.604804e-03 3 1  ON 56
ci_58                -9.150153e-04 3 1  ON 57
ci_59                -9.967280e-04 3 1  ON 58
ci_60                 1.351767e-03 3 1  ON 59
ci_61                 1.834479e-03 3 1  ON 60
ci_62                -4.337441e-04 3 1  ON 61
ci_63                -6.699175e-05 3 1  ON 62
ci_64                -9.498250e-04 3 1  ON 63
ci_65                 1.305579e-04 3 1  ON 64
ci_66                -6.934489e-04 3 1  ON 65
ci_67                -6.514099e-04 3 1  ON 66
ci_68                -1.364758e-03 3 1  ON 67
ci_69                -1.607111e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.3406e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s008 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s008 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=8  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2812e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 8
    time step          = 0.05
    reference energy   = -22.8893
    reference variance = 0.351111
====================================================
  Execution time = 2.5657e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s008
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5352e+04
  VMC Eavg = -2.2820e+01
  VMC Evar = 4.9449e-01
  Total weights = 1.963265923e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.6575e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.477544541395
                                         uncertainty =       0.003834600005

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.477544541395
                                         uncertainty =       0.003834600005

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000488712833
  error estimate for blocks of size 2^( 2) =       0.000509390808
  error estimate for blocks of size 2^( 3) =       0.000529118627
  error estimate for blocks of size 2^( 4) =       0.000544147825
  error estimate for blocks of size 2^( 5) =       0.000554408513
  error estimate for blocks of size 2^( 6) =       0.000560595407
  error estimate for blocks of size 2^( 7) =       0.000564751064

      target function =                  N/A
              le_mean =     -22.819509102085
             les_mean =     521.224486638615
             stat err =       0.000555975702
             autocorr =       1.294208170915
              std dev =       0.691144316813
             le_variance =       0.477680466663


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281950910209e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.9062e+02, overlap shift 3.9062e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.819509102022       residual = 2.74e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.819509141125       residual = 6.49e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.819509141210       residual = 3.89e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.819509141411       residual = 1.52e-08           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.819509141582       residual = 3.80e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          4 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.9062e+02 is 1.990335e-06

solving harmonic davidson linear method for identity shift 1.5625e+03, overlap shift 1.5625e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.819509102022       residual = 2.74e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.819509111801       residual = 6.50e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.819509111821       residual = 3.90e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.819509111872       residual = 1.53e-08           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.819509111914       residual = 3.82e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          4 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.5625e+03 is 4.976732e-07

solving harmonic davidson linear method for identity shift 6.2500e+03, overlap shift 6.2500e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.819509102022       residual = 2.74e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.819509104467       residual = 6.50e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.819509104472       residual = 3.90e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.819509104486       residual = 1.53e-08           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.819509104495       residual = 3.82e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          4 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 6.2500e+03 is 1.244239e-07

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.015878 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0326e+01
  </log>
  <optVariables href="FORM.s008.opt.xml">
ci_01                 1.274280e-01 3 1  ON 0
ci_02                -2.884090e-02 3 1  ON 1
ci_03                -2.859257e-02 3 1  ON 2
ci_04                 2.613689e-02 3 1  ON 3
ci_05                -2.402224e-02 3 1  ON 4
ci_06                -2.362295e-02 3 1  ON 5
ci_07                 2.584721e-02 3 1  ON 6
ci_08                -5.199119e-03 3 1  ON 7
ci_09                -1.173859e-02 3 1  ON 8
ci_10                -1.143600e-02 3 1  ON 9
ci_11                 1.571615e-02 3 1  ON 10
ci_12                 1.061099e-02 3 1  ON 11
ci_13                 1.147716e-02 3 1  ON 12
ci_14                 1.483972e-02 3 1  ON 13
ci_15                 8.682675e-03 3 1  ON 14
ci_16                 8.465775e-03 3 1  ON 15
ci_17                -9.898163e-03 3 1  ON 16
ci_18                -9.976738e-03 3 1  ON 17
ci_19                 9.786623e-03 3 1  ON 18
ci_20                 1.059275e-02 3 1  ON 19
ci_21                 7.589421e-03 3 1  ON 20
ci_22                 9.217063e-03 3 1  ON 21
ci_23                 6.526775e-03 3 1  ON 22
ci_24                 6.510085e-03 3 1  ON 23
ci_25                 5.207365e-03 3 1  ON 24
ci_26                 3.780387e-03 3 1  ON 25
ci_27                 3.062041e-03 3 1  ON 26
ci_28                 4.595451e-03 3 1  ON 27
ci_29                 4.636432e-03 3 1  ON 28
ci_30                -4.187746e-04 3 1  ON 29
ci_31                -4.998254e-04 3 1  ON 30
ci_32                -2.060075e-05 3 1  ON 31
ci_33                -4.711656e-04 3 1  ON 32
ci_34                 1.728086e-04 3 1  ON 33
ci_35                -2.503048e-04 3 1  ON 34
ci_36                -9.116178e-04 3 1  ON 35
ci_37                -8.636552e-04 3 1  ON 36
ci_38                -1.302595e-04 3 1  ON 37
ci_39                -2.817711e-04 3 1  ON 38
ci_40                -1.217992e-03 3 1  ON 39
ci_41                 5.908303e-04 3 1  ON 40
ci_42                 2.374503e-04 3 1  ON 41
ci_43                -2.483194e-03 3 1  ON 42
ci_44                -1.669020e-03 3 1  ON 43
ci_45                -4.930364e-04 3 1  ON 44
ci_46                -4.854354e-04 3 1  ON 45
ci_47                -1.580642e-03 3 1  ON 46
ci_48                -2.026643e-03 3 1  ON 47
ci_49                -1.688283e-03 3 1  ON 48
ci_50                -5.830507e-04 3 1  ON 49
ci_51                 5.812836e-04 3 1  ON 50
ci_52                 3.069096e-05 3 1  ON 51
ci_53                -9.295143e-04 3 1  ON 52
ci_54                -4.904459e-04 3 1  ON 53
ci_55                -6.876304e-04 3 1  ON 54
ci_56                 1.579737e-03 3 1  ON 55
ci_57                 1.604715e-03 3 1  ON 56
ci_58                -9.151764e-04 3 1  ON 57
ci_59                -9.966905e-04 3 1  ON 58
ci_60                 1.351697e-03 3 1  ON 59
ci_61                 1.834571e-03 3 1  ON 60
ci_62                -4.337097e-04 3 1  ON 61
ci_63                -6.693441e-05 3 1  ON 62
ci_64                -9.496095e-04 3 1  ON 63
ci_65                 1.305831e-04 3 1  ON 64
ci_66                -6.932757e-04 3 1  ON 65
ci_67                -6.512203e-04 3 1  ON 66
ci_68                -1.364691e-03 3 1  ON 67
ci_69                -1.606989e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 8
    time step          = 0.05
    reference energy   = -22.8452
    reference variance = 0.38438
====================================================
  Execution time = 2.5036e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s008
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2819e+01
  VMC Evar = 4.8309e-01
  Total weights = 1.9637e+06
  Execution time = 3.5756e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.469169909579
                                         uncertainty =       0.002013041549

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.469169909579
                                         uncertainty =       0.002013041549

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000484324804
  error estimate for blocks of size 2^( 2) =       0.000505453715
  error estimate for blocks of size 2^( 3) =       0.000525575534
  error estimate for blocks of size 2^( 4) =       0.000541679041
  error estimate for blocks of size 2^( 5) =       0.000550833646
  error estimate for blocks of size 2^( 6) =       0.000555650393
  error estimate for blocks of size 2^( 7) =       0.000561154256

      target function =                  N/A
              le_mean =     -22.818857891291
             les_mean =     521.183368687969
             stat err =       0.000552329334
             autocorr =       1.300537247342
              std dev =       0.684938706736
             le_variance =       0.469141031985

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.469169583649
                                         uncertainty =       0.002013063093

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.469169583649
                                         uncertainty =       0.002013063093

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000484324635
  error estimate for blocks of size 2^( 2) =       0.000505453597
  error estimate for blocks of size 2^( 3) =       0.000525575460
  error estimate for blocks of size 2^( 4) =       0.000541679011
  error estimate for blocks of size 2^( 5) =       0.000550833630
  error estimate for blocks of size 2^( 6) =       0.000555650343
  error estimate for blocks of size 2^( 7) =       0.000561154223

      target function =                  N/A
              le_mean =     -22.818857914763
             les_mean =     521.183366105142
             stat err =       0.000552329302
             autocorr =       1.300538003260
              std dev =       0.684938467461
             le_variance =       0.469140704208

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.469169746498
                                         uncertainty =       0.002013052321

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.469169746498
                                         uncertainty =       0.002013052321

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000484324720
  error estimate for blocks of size 2^( 2) =       0.000505453656
  error estimate for blocks of size 2^( 3) =       0.000525575497
  error estimate for blocks of size 2^( 4) =       0.000541679026
  error estimate for blocks of size 2^( 5) =       0.000550833638
  error estimate for blocks of size 2^( 6) =       0.000555650368
  error estimate for blocks of size 2^( 7) =       0.000561154239

      target function =                  N/A
              le_mean =     -22.818857903022
             les_mean =     521.183367359575
             stat err =       0.000552329318
             autocorr =       1.300537625454
              std dev =       0.684938587014
             le_variance =       0.469140867981

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.469169889184
                                         uncertainty =       0.002013042896

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.469169889184
                                         uncertainty =       0.002013042896

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000484324794
  error estimate for blocks of size 2^( 2) =       0.000505453708
  error estimate for blocks of size 2^( 3) =       0.000525575529
  error estimate for blocks of size 2^( 4) =       0.000541679039
  error estimate for blocks of size 2^( 5) =       0.000550833645
  error estimate for blocks of size 2^( 6) =       0.000555650390
  error estimate for blocks of size 2^( 7) =       0.000561154254

      target function =                  N/A
              le_mean =     -22.818857892756
             les_mean =     521.183368517433
             stat err =       0.000552329332
             autocorr =       1.300537294619
              std dev =       0.684938691764
             le_variance =       0.469141011475


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.818857891291        initial
     3.9062e+02     3.9062e+03             1.9903e-06       -22.818857914763  <--
     1.5625e+03     1.5625e+04             4.9767e-07       -22.818857903022
     6.2500e+03     6.2500e+04             1.2442e-07       -22.818857892756

*****************************************************************************
Applying the update for shift_i =   3.9062e+02     and shift_s =   3.9062e+03
*****************************************************************************

  Execution time = 4.2921e+01
  </log>
  <optVariables href="FORM.s008.opt.xml">
ci_01                 1.274265e-01 3 1  ON 0
ci_02                -2.884004e-02 3 1  ON 1
ci_03                -2.859135e-02 3 1  ON 2
ci_04                 2.613653e-02 3 1  ON 3
ci_05                -2.402155e-02 3 1  ON 4
ci_06                -2.362270e-02 3 1  ON 5
ci_07                 2.584704e-02 3 1  ON 6
ci_08                -5.198883e-03 3 1  ON 7
ci_09                -1.173854e-02 3 1  ON 8
ci_10                -1.143576e-02 3 1  ON 9
ci_11                 1.571612e-02 3 1  ON 10
ci_12                 1.061106e-02 3 1  ON 11
ci_13                 1.147746e-02 3 1  ON 12
ci_14                 1.483999e-02 3 1  ON 13
ci_15                 8.682040e-03 3 1  ON 14
ci_16                 8.465435e-03 3 1  ON 15
ci_17                -9.897797e-03 3 1  ON 16
ci_18                -9.976268e-03 3 1  ON 17
ci_19                 9.785804e-03 3 1  ON 18
ci_20                 1.059267e-02 3 1  ON 19
ci_21                 7.589421e-03 3 1  ON 20
ci_22                 9.216753e-03 3 1  ON 21
ci_23                 6.527119e-03 3 1  ON 22
ci_24                 6.510088e-03 3 1  ON 23
ci_25                 5.207489e-03 3 1  ON 24
ci_26                 3.780482e-03 3 1  ON 25
ci_27                 3.062020e-03 3 1  ON 26
ci_28                 4.595738e-03 3 1  ON 27
ci_29                 4.636485e-03 3 1  ON 28
ci_30                -4.192526e-04 3 1  ON 29
ci_31                -4.996102e-04 3 1  ON 30
ci_32                -2.052762e-05 3 1  ON 31
ci_33                -4.709299e-04 3 1  ON 32
ci_34                 1.728664e-04 3 1  ON 33
ci_35                -2.502177e-04 3 1  ON 34
ci_36                -9.115462e-04 3 1  ON 35
ci_37                -8.637779e-04 3 1  ON 36
ci_38                -1.305712e-04 3 1  ON 37
ci_39                -2.817412e-04 3 1  ON 38
ci_40                -1.218601e-03 3 1  ON 39
ci_41                 5.911341e-04 3 1  ON 40
ci_42                 2.373442e-04 3 1  ON 41
ci_43                -2.483068e-03 3 1  ON 42
ci_44                -1.669686e-03 3 1  ON 43
ci_45                -4.932380e-04 3 1  ON 44
ci_46                -4.854799e-04 3 1  ON 45
ci_47                -1.580789e-03 3 1  ON 46
ci_48                -2.026251e-03 3 1  ON 47
ci_49                -1.687968e-03 3 1  ON 48
ci_50                -5.830469e-04 3 1  ON 49
ci_51                 5.814205e-04 3 1  ON 50
ci_52                 3.053281e-05 3 1  ON 51
ci_53                -9.298210e-04 3 1  ON 52
ci_54                -4.904516e-04 3 1  ON 53
ci_55                -6.882568e-04 3 1  ON 54
ci_56                 1.579416e-03 3 1  ON 55
ci_57                 1.604447e-03 3 1  ON 56
ci_58                -9.156595e-04 3 1  ON 57
ci_59                -9.965778e-04 3 1  ON 58
ci_60                 1.351485e-03 3 1  ON 59
ci_61                 1.834847e-03 3 1  ON 60
ci_62                -4.336063e-04 3 1  ON 61
ci_63                -6.676248e-05 3 1  ON 62
ci_64                -9.489634e-04 3 1  ON 63
ci_65                 1.306583e-04 3 1  ON 64
ci_66                -6.927566e-04 3 1  ON 65
ci_67                -6.506518e-04 3 1  ON 66
ci_68                -1.364490e-03 3 1  ON 67
ci_69                -1.606625e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.3254e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s009 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s009 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=9  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2818e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 9
    time step          = 0.05
    reference energy   = -22.7908
    reference variance = 0.409099
====================================================
  Execution time = 2.5663e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s009
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5332e+04
  VMC Eavg = -2.2820e+01
  VMC Evar = 4.9101e-01
  Total weights = 1.963825381e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.6592e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.476880073403
                                         uncertainty =       0.004590219720

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.476880073403
                                         uncertainty =       0.004590219720

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000488300454
  error estimate for blocks of size 2^( 2) =       0.000509497340
  error estimate for blocks of size 2^( 3) =       0.000530073591
  error estimate for blocks of size 2^( 4) =       0.000545362392
  error estimate for blocks of size 2^( 5) =       0.000554288932
  error estimate for blocks of size 2^( 6) =       0.000557974484
  error estimate for blocks of size 2^( 7) =       0.000562453821

      target function =                  N/A
              le_mean =     -22.820021216643
             les_mean =     521.244379878595
             stat err =       0.000555019907
             autocorr =       1.291941548653
              std dev =       0.690561124056
             le_variance =       0.476874666057


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.282002121664e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.7656e+01, overlap shift 9.7656e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.820021216577       residual = 2.41e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.820021400865       residual = 5.10e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.820021399952       residual = 1.04e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.820021401550       residual = 2.77e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.7656e+01 is 9.211987e-06

solving harmonic davidson linear method for identity shift 3.9062e+02, overlap shift 3.9062e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.820021216577       residual = 2.41e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.820021262706       residual = 5.11e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.820021262472       residual = 1.05e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.820021262871       residual = 2.79e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.9062e+02 is 2.304526e-06

solving harmonic davidson linear method for identity shift 1.5625e+03, overlap shift 1.5625e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.820021216577       residual = 2.41e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.820021228113       residual = 5.12e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.820021228054       residual = 1.05e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.820021228153       residual = 2.80e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.5625e+03 is 5.762271e-07

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.017263 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0332e+01
  </log>
  <optVariables href="FORM.s009.opt.xml">
ci_01                 1.274242e-01 3 1  ON 0
ci_02                -2.883873e-02 3 1  ON 1
ci_03                -2.858977e-02 3 1  ON 2
ci_04                 2.613592e-02 3 1  ON 3
ci_05                -2.402055e-02 3 1  ON 4
ci_06                -2.362208e-02 3 1  ON 5
ci_07                 2.584675e-02 3 1  ON 6
ci_08                -5.198456e-03 3 1  ON 7
ci_09                -1.173819e-02 3 1  ON 8
ci_10                -1.143556e-02 3 1  ON 9
ci_11                 1.571642e-02 3 1  ON 10
ci_12                 1.061161e-02 3 1  ON 11
ci_13                 1.147798e-02 3 1  ON 12
ci_14                 1.484049e-02 3 1  ON 13
ci_15                 8.681678e-03 3 1  ON 14
ci_16                 8.464995e-03 3 1  ON 15
ci_17                -9.897898e-03 3 1  ON 16
ci_18                -9.975631e-03 3 1  ON 17
ci_19                 9.785859e-03 3 1  ON 18
ci_20                 1.059244e-02 3 1  ON 19
ci_21                 7.589056e-03 3 1  ON 20
ci_22                 9.216331e-03 3 1  ON 21
ci_23                 6.526588e-03 3 1  ON 22
ci_24                 6.510174e-03 3 1  ON 23
ci_25                 5.207144e-03 3 1  ON 24
ci_26                 3.780483e-03 3 1  ON 25
ci_27                 3.061777e-03 3 1  ON 26
ci_28                 4.595385e-03 3 1  ON 27
ci_29                 4.636176e-03 3 1  ON 28
ci_30                -4.190340e-04 3 1  ON 29
ci_31                -4.998603e-04 3 1  ON 30
ci_32                -2.064965e-05 3 1  ON 31
ci_33                -4.711375e-04 3 1  ON 32
ci_34                 1.724826e-04 3 1  ON 33
ci_35                -2.505859e-04 3 1  ON 34
ci_36                -9.113214e-04 3 1  ON 35
ci_37                -8.637521e-04 3 1  ON 36
ci_38                -1.308903e-04 3 1  ON 37
ci_39                -2.817349e-04 3 1  ON 38
ci_40                -1.218039e-03 3 1  ON 39
ci_41                 5.907574e-04 3 1  ON 40
ci_42                 2.372403e-04 3 1  ON 41
ci_43                -2.483389e-03 3 1  ON 42
ci_44                -1.669928e-03 3 1  ON 43
ci_45                -4.937408e-04 3 1  ON 44
ci_46                -4.853474e-04 3 1  ON 45
ci_47                -1.580865e-03 3 1  ON 46
ci_48                -2.025746e-03 3 1  ON 47
ci_49                -1.687839e-03 3 1  ON 48
ci_50                -5.828102e-04 3 1  ON 49
ci_51                 5.813387e-04 3 1  ON 50
ci_52                 3.082393e-05 3 1  ON 51
ci_53                -9.294526e-04 3 1  ON 52
ci_54                -4.903512e-04 3 1  ON 53
ci_55                -6.886146e-04 3 1  ON 54
ci_56                 1.578821e-03 3 1  ON 55
ci_57                 1.603753e-03 3 1  ON 56
ci_58                -9.157150e-04 3 1  ON 57
ci_59                -9.967823e-04 3 1  ON 58
ci_60                 1.351462e-03 3 1  ON 59
ci_61                 1.834641e-03 3 1  ON 60
ci_62                -4.337296e-04 3 1  ON 61
ci_63                -6.705124e-05 3 1  ON 62
ci_64                -9.486782e-04 3 1  ON 63
ci_65                 1.307532e-04 3 1  ON 64
ci_66                -6.927302e-04 3 1  ON 65
ci_67                -6.502870e-04 3 1  ON 66
ci_68                -1.364538e-03 3 1  ON 67
ci_69                -1.606366e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 9
    time step          = 0.05
    reference energy   = -23.0179
    reference variance = 2.53034
====================================================
  Execution time = 2.5115e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s009
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2819e+01
  VMC Evar = 4.8160e-01
  Total weights = 1.9638e+06
  Execution time = 3.5612e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.468623597404
                                         uncertainty =       0.001857392305

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.468623597404
                                         uncertainty =       0.001857392305

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000484192553
  error estimate for blocks of size 2^( 2) =       0.000505467352
  error estimate for blocks of size 2^( 3) =       0.000525962151
  error estimate for blocks of size 2^( 4) =       0.000540439259
  error estimate for blocks of size 2^( 5) =       0.000549643942
  error estimate for blocks of size 2^( 6) =       0.000555188605
  error estimate for blocks of size 2^( 7) =       0.000556407732

      target function =                  N/A
              le_mean =     -22.819238858174
             les_mean =     521.199259276489
             stat err =       0.000550419885
             autocorr =       1.292266300902
              std dev =       0.684751674960
             le_variance =       0.468884856360

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.468622126176
                                         uncertainty =       0.001857500551

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.468622126176
                                         uncertainty =       0.001857500551

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000484191792
  error estimate for blocks of size 2^( 2) =       0.000505466822
  error estimate for blocks of size 2^( 3) =       0.000525961878
  error estimate for blocks of size 2^( 4) =       0.000540439272
  error estimate for blocks of size 2^( 5) =       0.000549644149
  error estimate for blocks of size 2^( 6) =       0.000555188968
  error estimate for blocks of size 2^( 7) =       0.000556408007

      target function =                  N/A
              le_mean =     -22.819238901254
             les_mean =     521.199256372885
             stat err =       0.000550420099
             autocorr =       1.292271366101
              std dev =       0.684750599721
             le_variance =       0.468883383818

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.468622859941
                                         uncertainty =       0.001857446448

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.468622859941
                                         uncertainty =       0.001857446448

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000484192172
  error estimate for blocks of size 2^( 2) =       0.000505467086
  error estimate for blocks of size 2^( 3) =       0.000525962014
  error estimate for blocks of size 2^( 4) =       0.000540439265
  error estimate for blocks of size 2^( 5) =       0.000549644045
  error estimate for blocks of size 2^( 6) =       0.000555188786
  error estimate for blocks of size 2^( 7) =       0.000556407870

      target function =                  N/A
              le_mean =     -22.819238879641
             les_mean =     521.199257712650
             stat err =       0.000550419992
             autocorr =       1.292268837393
              std dev =       0.684751135989
             le_variance =       0.468884118238

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.468623505097
                                         uncertainty =       0.001857399070

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.468623505097
                                         uncertainty =       0.001857399070

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000484192505
  error estimate for blocks of size 2^( 2) =       0.000505467319
  error estimate for blocks of size 2^( 3) =       0.000525962134
  error estimate for blocks of size 2^( 4) =       0.000540439260
  error estimate for blocks of size 2^( 5) =       0.000549643955
  error estimate for blocks of size 2^( 6) =       0.000555188627
  error estimate for blocks of size 2^( 7) =       0.000556407750

      target function =                  N/A
              le_mean =     -22.819238860847
             les_mean =     521.199259069864
             stat err =       0.000550419898
             autocorr =       1.292266618088
              std dev =       0.684751607498
             le_variance =       0.468884763971


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.819238858174        initial
     9.7656e+01     9.7656e+02             9.2120e-06       -22.819238901254  <--
     3.9062e+02     3.9062e+03             2.3045e-06       -22.819238879641
     1.5625e+03     1.5625e+04             5.7623e-07       -22.819238860847

*****************************************************************************
Applying the update for shift_i =   9.7656e+01     and shift_s =   9.7656e+02
*****************************************************************************

  Execution time = 4.2991e+01
  </log>
  <optVariables href="FORM.s009.opt.xml">
ci_01                 1.274173e-01 3 1  ON 0
ci_02                -2.883480e-02 3 1  ON 1
ci_03                -2.858502e-02 3 1  ON 2
ci_04                 2.613409e-02 3 1  ON 3
ci_05                -2.401756e-02 3 1  ON 4
ci_06                -2.362021e-02 3 1  ON 5
ci_07                 2.584588e-02 3 1  ON 6
ci_08                -5.197177e-03 3 1  ON 7
ci_09                -1.173712e-02 3 1  ON 8
ci_10                -1.143496e-02 3 1  ON 9
ci_11                 1.571730e-02 3 1  ON 10
ci_12                 1.061325e-02 3 1  ON 11
ci_13                 1.147957e-02 3 1  ON 12
ci_14                 1.484200e-02 3 1  ON 13
ci_15                 8.680592e-03 3 1  ON 14
ci_16                 8.463677e-03 3 1  ON 15
ci_17                -9.898202e-03 3 1  ON 16
ci_18                -9.973724e-03 3 1  ON 17
ci_19                 9.786023e-03 3 1  ON 18
ci_20                 1.059173e-02 3 1  ON 19
ci_21                 7.587963e-03 3 1  ON 20
ci_22                 9.215067e-03 3 1  ON 21
ci_23                 6.524999e-03 3 1  ON 22
ci_24                 6.510432e-03 3 1  ON 23
ci_25                 5.206112e-03 3 1  ON 24
ci_26                 3.780488e-03 3 1  ON 25
ci_27                 3.061049e-03 3 1  ON 26
ci_28                 4.594326e-03 3 1  ON 27
ci_29                 4.635251e-03 3 1  ON 28
ci_30                -4.183777e-04 3 1  ON 29
ci_31                -5.006090e-04 3 1  ON 30
ci_32                -2.101519e-05 3 1  ON 31
ci_33                -4.717591e-04 3 1  ON 32
ci_34                 1.713343e-04 3 1  ON 33
ci_35                -2.516877e-04 3 1  ON 34
ci_36                -9.106485e-04 3 1  ON 35
ci_37                -8.636747e-04 3 1  ON 36
ci_38                -1.318448e-04 3 1  ON 37
ci_39                -2.817161e-04 3 1  ON 38
ci_40                -1.216361e-03 3 1  ON 39
ci_41                 5.896294e-04 3 1  ON 40
ci_42                 2.369287e-04 3 1  ON 41
ci_43                -2.484349e-03 3 1  ON 42
ci_44                -1.670651e-03 3 1  ON 43
ci_45                -4.952453e-04 3 1  ON 44
ci_46                -4.849508e-04 3 1  ON 45
ci_47                -1.581093e-03 3 1  ON 46
ci_48                -2.024232e-03 3 1  ON 47
ci_49                -1.687455e-03 3 1  ON 48
ci_50                -5.821029e-04 3 1  ON 49
ci_51                 5.810940e-04 3 1  ON 50
ci_52                 3.169500e-05 3 1  ON 51
ci_53                -9.283508e-04 3 1  ON 52
ci_54                -4.900507e-04 3 1  ON 53
ci_55                -6.896859e-04 3 1  ON 54
ci_56                 1.577042e-03 3 1  ON 55
ci_57                 1.601678e-03 3 1  ON 56
ci_58                -9.158813e-04 3 1  ON 57
ci_59                -9.973945e-04 3 1  ON 58
ci_60                 1.351395e-03 3 1  ON 59
ci_61                 1.834026e-03 3 1  ON 60
ci_62                -4.340984e-04 3 1  ON 61
ci_63                -6.791453e-05 3 1  ON 62
ci_64                -9.478244e-04 3 1  ON 63
ci_65                 1.310371e-04 3 1  ON 64
ci_66                -6.926511e-04 3 1  ON 65
ci_67                -6.491954e-04 3 1  ON 66
ci_68                -1.364682e-03 3 1  ON 67
ci_69                -1.605590e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.3330e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s010 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s010 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=10  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2827e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 10
    time step          = 0.05
    reference energy   = -22.7544
    reference variance = 0.747709
====================================================
  Execution time = 2.5625e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s010
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5314e+04
  VMC Eavg = -2.2819e+01
  VMC Evar = 4.8800e-01
  Total weights = 1.963645719e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.6476e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.473285400661
                                         uncertainty =       0.002717434970

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.473285400661
                                         uncertainty =       0.002717434970

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000486458114
  error estimate for blocks of size 2^( 2) =       0.000507665372
  error estimate for blocks of size 2^( 3) =       0.000528180363
  error estimate for blocks of size 2^( 4) =       0.000542662420
  error estimate for blocks of size 2^( 5) =       0.000552137942
  error estimate for blocks of size 2^( 6) =       0.000556439852
  error estimate for blocks of size 2^( 7) =       0.000559536940

      target function =                  N/A
              le_mean =     -22.818541649466
             les_mean =     521.173847957423
             stat err =       0.000552694288
             autocorr =       1.290859721602
              std dev =       0.687955662103
             le_variance =       0.473282993020


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281854164947e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.4414e+01, overlap shift 2.4414e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.818541649410       residual = 3.43e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.818542084047       residual = 6.82e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.818542082352       residual = 1.65e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.818542081856       residual = 3.09e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.4414e+01 is 3.959139e-05

solving harmonic davidson linear method for identity shift 9.7656e+01, overlap shift 9.7656e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.818541649410       residual = 3.43e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.818541758622       residual = 6.83e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.818541757973       residual = 1.69e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.818541757841       residual = 3.20e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.7656e+01 is 9.924465e-06

solving harmonic davidson linear method for identity shift 3.9062e+02, overlap shift 3.9062e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.818541649410       residual = 3.43e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.818541676748       residual = 6.83e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.818541676571       residual = 1.70e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.818541676537       residual = 3.23e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.9062e+02 is 2.482786e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.018657 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0282e+01
  </log>
  <optVariables href="FORM.s010.opt.xml">
ci_01                 1.274074e-01 3 1  ON 0
ci_02                -2.882927e-02 3 1  ON 1
ci_03                -2.858169e-02 3 1  ON 2
ci_04                 2.613023e-02 3 1  ON 3
ci_05                -2.401478e-02 3 1  ON 4
ci_06                -2.361850e-02 3 1  ON 5
ci_07                 2.584334e-02 3 1  ON 6
ci_08                -5.194369e-03 3 1  ON 7
ci_09                -1.173821e-02 3 1  ON 8
ci_10                -1.143170e-02 3 1  ON 9
ci_11                 1.571614e-02 3 1  ON 10
ci_12                 1.061474e-02 3 1  ON 11
ci_13                 1.147894e-02 3 1  ON 12
ci_14                 1.484023e-02 3 1  ON 13
ci_15                 8.678959e-03 3 1  ON 14
ci_16                 8.462735e-03 3 1  ON 15
ci_17                -9.899668e-03 3 1  ON 16
ci_18                -9.976122e-03 3 1  ON 17
ci_19                 9.786007e-03 3 1  ON 18
ci_20                 1.059297e-02 3 1  ON 19
ci_21                 7.587869e-03 3 1  ON 20
ci_22                 9.214113e-03 3 1  ON 21
ci_23                 6.523396e-03 3 1  ON 22
ci_24                 6.505386e-03 3 1  ON 23
ci_25                 5.203717e-03 3 1  ON 24
ci_26                 3.777473e-03 3 1  ON 25
ci_27                 3.060514e-03 3 1  ON 26
ci_28                 4.594543e-03 3 1  ON 27
ci_29                 4.632306e-03 3 1  ON 28
ci_30                -4.190761e-04 3 1  ON 29
ci_31                -5.000661e-04 3 1  ON 30
ci_32                -2.255384e-05 3 1  ON 31
ci_33                -4.708375e-04 3 1  ON 32
ci_34                 1.722747e-04 3 1  ON 33
ci_35                -2.495316e-04 3 1  ON 34
ci_36                -9.095097e-04 3 1  ON 35
ci_37                -8.648498e-04 3 1  ON 36
ci_38                -1.345532e-04 3 1  ON 37
ci_39                -2.816311e-04 3 1  ON 38
ci_40                -1.217473e-03 3 1  ON 39
ci_41                 5.897912e-04 3 1  ON 40
ci_42                 2.368992e-04 3 1  ON 41
ci_43                -2.484470e-03 3 1  ON 42
ci_44                -1.670533e-03 3 1  ON 43
ci_45                -4.922511e-04 3 1  ON 44
ci_46                -4.862398e-04 3 1  ON 45
ci_47                -1.581021e-03 3 1  ON 46
ci_48                -2.024292e-03 3 1  ON 47
ci_49                -1.688188e-03 3 1  ON 48
ci_50                -5.826831e-04 3 1  ON 49
ci_51                 5.793890e-04 3 1  ON 50
ci_52                 3.017785e-05 3 1  ON 51
ci_53                -9.269285e-04 3 1  ON 52
ci_54                -4.911342e-04 3 1  ON 53
ci_55                -6.899509e-04 3 1  ON 54
ci_56                 1.575069e-03 3 1  ON 55
ci_57                 1.600443e-03 3 1  ON 56
ci_58                -9.204995e-04 3 1  ON 57
ci_59                -9.988749e-04 3 1  ON 58
ci_60                 1.352349e-03 3 1  ON 59
ci_61                 1.831448e-03 3 1  ON 60
ci_62                -4.316614e-04 3 1  ON 61
ci_63                -7.036588e-05 3 1  ON 62
ci_64                -9.465665e-04 3 1  ON 63
ci_65                 1.301505e-04 3 1  ON 64
ci_66                -6.900083e-04 3 1  ON 65
ci_67                -6.507490e-04 3 1  ON 66
ci_68                -1.363431e-03 3 1  ON 67
ci_69                -1.603596e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 10
    time step          = 0.05
    reference energy   = -22.7307
    reference variance = 0.479594
====================================================
  Execution time = 2.5123e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s010
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2819e+01
  VMC Evar = 4.8552e-01
  Total weights = 1.9636e+06
  Execution time = 3.5785e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.472154916938
                                         uncertainty =       0.002221488752

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.472154916938
                                         uncertainty =       0.002221488752

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000485854295
  error estimate for blocks of size 2^( 2) =       0.000507078539
  error estimate for blocks of size 2^( 3) =       0.000527528448
  error estimate for blocks of size 2^( 4) =       0.000544139216
  error estimate for blocks of size 2^( 5) =       0.000554635022
  error estimate for blocks of size 2^( 6) =       0.000561281827
  error estimate for blocks of size 2^( 7) =       0.000564215953

      target function =                  N/A
              le_mean =     -22.819075300293
             les_mean =     521.195705268292
             stat err =       0.000556068004
             autocorr =       1.309916826139
              std dev =       0.687101733740
             le_variance =       0.472108792509

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.472147080272
                                         uncertainty =       0.002221172792

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.472147080272
                                         uncertainty =       0.002221172792

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000485850265
  error estimate for blocks of size 2^( 2) =       0.000507075211
  error estimate for blocks of size 2^( 3) =       0.000527526000
  error estimate for blocks of size 2^( 4) =       0.000544137622
  error estimate for blocks of size 2^( 5) =       0.000554634080
  error estimate for blocks of size 2^( 6) =       0.000561281096
  error estimate for blocks of size 2^( 7) =       0.000564214650

      target function =                  N/A
              le_mean =     -22.819075506411
             les_mean =     521.196720173021
             stat err =       0.000556066862
             autocorr =       1.309933172844
              std dev =       0.687096034748
             le_variance =       0.472100960967

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.472150962451
                                         uncertainty =       0.002221329358

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.472150962451
                                         uncertainty =       0.002221329358

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000485852262
  error estimate for blocks of size 2^( 2) =       0.000507076863
  error estimate for blocks of size 2^( 3) =       0.000527527225
  error estimate for blocks of size 2^( 4) =       0.000544138443
  error estimate for blocks of size 2^( 5) =       0.000554634576
  error estimate for blocks of size 2^( 6) =       0.000561281492
  error estimate for blocks of size 2^( 7) =       0.000564215350

      target function =                  N/A
              le_mean =     -22.819075388218
             les_mean =     521.195791061854
             stat err =       0.000556067465
             autocorr =       1.309925250806
              std dev =       0.687098857931
             le_variance =       0.472104840570

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.472154420291
                                         uncertainty =       0.002221468741

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.472154420291
                                         uncertainty =       0.002221468741

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000485854040
  error estimate for blocks of size 2^( 2) =       0.000507078328
  error estimate for blocks of size 2^( 3) =       0.000527528294
  error estimate for blocks of size 2^( 4) =       0.000544139118
  error estimate for blocks of size 2^( 5) =       0.000554634965
  error estimate for blocks of size 2^( 6) =       0.000561281784
  error estimate for blocks of size 2^( 7) =       0.000564215875

      target function =                  N/A
              le_mean =     -22.819075311265
             les_mean =     521.195707665766
             stat err =       0.000556067935
             autocorr =       1.309917878195
              std dev =       0.687101372566
             le_variance =       0.472108296182


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.819075300293        initial
     2.4414e+01     2.4414e+02             3.9591e-05       -22.819075506411  <--
     9.7656e+01     9.7656e+02             9.9245e-06       -22.819075388218
     3.9062e+02     3.9062e+03             2.4828e-06       -22.819075311265

*****************************************************************************
Applying the update for shift_i =   2.4414e+01     and shift_s =   2.4414e+02
*****************************************************************************

  Execution time = 4.3082e+01
  </log>
  <optVariables href="FORM.s010.opt.xml">
ci_01                 1.273777e-01 3 1  ON 0
ci_02                -2.881281e-02 3 1  ON 1
ci_03                -2.857177e-02 3 1  ON 2
ci_04                 2.611877e-02 3 1  ON 3
ci_05                -2.400648e-02 3 1  ON 4
ci_06                -2.361344e-02 3 1  ON 5
ci_07                 2.583580e-02 3 1  ON 6
ci_08                -5.186036e-03 3 1  ON 7
ci_09                -1.174145e-02 3 1  ON 8
ci_10                -1.142199e-02 3 1  ON 9
ci_11                 1.571267e-02 3 1  ON 10
ci_12                 1.061919e-02 3 1  ON 11
ci_13                 1.147707e-02 3 1  ON 12
ci_14                 1.483495e-02 3 1  ON 13
ci_15                 8.674085e-03 3 1  ON 14
ci_16                 8.459936e-03 3 1  ON 15
ci_17                -9.904031e-03 3 1  ON 16
ci_18                -9.983266e-03 3 1  ON 17
ci_19                 9.785970e-03 3 1  ON 18
ci_20                 1.059667e-02 3 1  ON 19
ci_21                 7.587582e-03 3 1  ON 20
ci_22                 9.211265e-03 3 1  ON 21
ci_23                 6.518643e-03 3 1  ON 22
ci_24                 6.490319e-03 3 1  ON 23
ci_25                 5.196599e-03 3 1  ON 24
ci_26                 3.768492e-03 3 1  ON 25
ci_27                 3.058921e-03 3 1  ON 26
ci_28                 4.595188e-03 3 1  ON 27
ci_29                 4.623531e-03 3 1  ON 28
ci_30                -4.211617e-04 3 1  ON 29
ci_31                -4.984419e-04 3 1  ON 30
ci_32                -2.713136e-05 3 1  ON 31
ci_33                -4.681070e-04 3 1  ON 32
ci_34                 1.750821e-04 3 1  ON 33
ci_35                -2.430920e-04 3 1  ON 34
ci_36                -9.061151e-04 3 1  ON 35
ci_37                -8.683320e-04 3 1  ON 36
ci_38                -1.426000e-04 3 1  ON 37
ci_39                -2.813700e-04 3 1  ON 38
ci_40                -1.220762e-03 3 1  ON 39
ci_41                 5.902620e-04 3 1  ON 40
ci_42                 2.367974e-04 3 1  ON 41
ci_43                -2.484832e-03 3 1  ON 42
ci_44                -1.670178e-03 3 1  ON 43
ci_45                -4.833567e-04 3 1  ON 44
ci_46                -4.900624e-04 3 1  ON 45
ci_47                -1.580796e-03 3 1  ON 46
ci_48                -2.024467e-03 3 1  ON 47
ci_49                -1.690367e-03 3 1  ON 48
ci_50                -5.843980e-04 3 1  ON 49
ci_51                 5.743301e-04 3 1  ON 50
ci_52                 2.567697e-05 3 1  ON 51
ci_53                -9.227147e-04 3 1  ON 52
ci_54                -4.943575e-04 3 1  ON 53
ci_55                -6.907350e-04 3 1  ON 54
ci_56                 1.569219e-03 3 1  ON 55
ci_57                 1.596774e-03 3 1  ON 56
ci_58                -9.342514e-04 3 1  ON 57
ci_59                -1.003280e-03 3 1  ON 58
ci_60                 1.355203e-03 3 1  ON 59
ci_61                 1.823730e-03 3 1  ON 60
ci_62                -4.244376e-04 3 1  ON 61
ci_63                -7.762132e-05 3 1  ON 62
ci_64                -9.428280e-04 3 1  ON 63
ci_65                 1.275158e-04 3 1  ON 64
ci_66                -6.821638e-04 3 1  ON 65
ci_67                -6.553652e-04 3 1  ON 66
ci_68                -1.359717e-03 3 1  ON 67
ci_69                -1.597667e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.3371e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s011 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s011 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=11  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2819e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
WARNING Many moves were rejected due to bad weights, consider decreasing FermionicWeight and JastrowWeight for ParameterDerivativeAdjusted.
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 11
    time step          = 0.05
    reference energy   = -22.85
    reference variance = 0.715723
====================================================
  Execution time = 2.7578e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s011
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5367e+04
  VMC Eavg = -2.2819e+01
  VMC Evar = 4.8588e-01
  Total weights = 1.963476488e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.6220e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.471341833871
                                         uncertainty =       0.001988915502

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.471341833871
                                         uncertainty =       0.001988915502

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000485401932
  error estimate for blocks of size 2^( 2) =       0.000506924252
  error estimate for blocks of size 2^( 3) =       0.000527276282
  error estimate for blocks of size 2^( 4) =       0.000542699369
  error estimate for blocks of size 2^( 5) =       0.000553596072
  error estimate for blocks of size 2^( 6) =       0.000557550163
  error estimate for blocks of size 2^( 7) =       0.000561765686

      target function =                  N/A
              le_mean =     -22.818746673709
             les_mean =     521.181082062480
             stat err =       0.000553902822
             autocorr =       1.302159415182
              std dev =       0.686461995177
             le_variance =       0.471230070823


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281874667371e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.1035e+00, overlap shift 6.1035e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.818746673655       residual = 4.00e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.818748959856       residual = 1.03e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.818749513295       residual = 2.07e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.818749512842       residual = 2.52e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 6.1035e+00 is 1.051681e-04

solving harmonic davidson linear method for identity shift 2.4414e+01, overlap shift 2.4414e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.818746673655       residual = 4.00e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.818747259922       residual = 1.02e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.818747398328       residual = 2.05e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.818747398107       residual = 2.68e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.4414e+01 is 2.654148e-05

solving harmonic davidson linear method for identity shift 9.7656e+01, overlap shift 9.7656e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.818746673655       residual = 4.00e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.818746821171       residual = 1.01e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.818746855772       residual = 2.04e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.818746855714       residual = 2.74e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.7656e+01 is 6.651108e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.023120 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.2216e+01
  </log>
  <optVariables href="FORM.s011.opt.xml">
ci_01                 1.273512e-01 3 1  ON 0
ci_02                -2.879079e-02 3 1  ON 1
ci_03                -2.856850e-02 3 1  ON 2
ci_04                 2.610194e-02 3 1  ON 3
ci_05                -2.399584e-02 3 1  ON 4
ci_06                -2.360586e-02 3 1  ON 5
ci_07                 2.584948e-02 3 1  ON 6
ci_08                -5.190225e-03 3 1  ON 7
ci_09                -1.173688e-02 3 1  ON 8
ci_10                -1.141986e-02 3 1  ON 9
ci_11                 1.572552e-02 3 1  ON 10
ci_12                 1.061251e-02 3 1  ON 11
ci_13                 1.148139e-02 3 1  ON 12
ci_14                 1.485547e-02 3 1  ON 13
ci_15                 8.665901e-03 3 1  ON 14
ci_16                 8.456316e-03 3 1  ON 15
ci_17                -9.909117e-03 3 1  ON 16
ci_18                -9.978138e-03 3 1  ON 17
ci_19                 9.777185e-03 3 1  ON 18
ci_20                 1.060438e-02 3 1  ON 19
ci_21                 7.579226e-03 3 1  ON 20
ci_22                 9.207520e-03 3 1  ON 21
ci_23                 6.517171e-03 3 1  ON 22
ci_24                 6.492038e-03 3 1  ON 23
ci_25                 5.179989e-03 3 1  ON 24
ci_26                 3.766479e-03 3 1  ON 25
ci_27                 3.066573e-03 3 1  ON 26
ci_28                 4.582819e-03 3 1  ON 27
ci_29                 4.624243e-03 3 1  ON 28
ci_30                -4.166097e-04 3 1  ON 29
ci_31                -4.970084e-04 3 1  ON 30
ci_32                -1.854768e-05 3 1  ON 31
ci_33                -4.686995e-04 3 1  ON 32
ci_34                 1.745088e-04 3 1  ON 33
ci_35                -2.441042e-04 3 1  ON 34
ci_36                -9.068853e-04 3 1  ON 35
ci_37                -8.470407e-04 3 1  ON 36
ci_38                -1.420460e-04 3 1  ON 37
ci_39                -2.603470e-04 3 1  ON 38
ci_40                -1.215840e-03 3 1  ON 39
ci_41                 5.853735e-04 3 1  ON 40
ci_42                 2.406668e-04 3 1  ON 41
ci_43                -2.482934e-03 3 1  ON 42
ci_44                -1.676099e-03 3 1  ON 43
ci_45                -4.754408e-04 3 1  ON 44
ci_46                -4.922409e-04 3 1  ON 45
ci_47                -1.571928e-03 3 1  ON 46
ci_48                -2.011697e-03 3 1  ON 47
ci_49                -1.690885e-03 3 1  ON 48
ci_50                -5.922783e-04 3 1  ON 49
ci_51                 5.696386e-04 3 1  ON 50
ci_52                 3.469858e-05 3 1  ON 51
ci_53                -9.242523e-04 3 1  ON 52
ci_54                -5.012861e-04 3 1  ON 53
ci_55                -6.767575e-04 3 1  ON 54
ci_56                 1.569595e-03 3 1  ON 55
ci_57                 1.592273e-03 3 1  ON 56
ci_58                -9.376892e-04 3 1  ON 57
ci_59                -9.992037e-04 3 1  ON 58
ci_60                 1.358565e-03 3 1  ON 59
ci_61                 1.818357e-03 3 1  ON 60
ci_62                -4.135045e-04 3 1  ON 61
ci_63                -7.569779e-05 3 1  ON 62
ci_64                -9.268282e-04 3 1  ON 63
ci_65                 1.240325e-04 3 1  ON 64
ci_66                -6.891268e-04 3 1  ON 65
ci_67                -6.483458e-04 3 1  ON 66
ci_68                -1.355046e-03 3 1  ON 67
ci_69                -1.575312e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 11
    time step          = 0.05
    reference energy   = -22.8168
    reference variance = 0.521924
====================================================
  Execution time = 2.5003e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s011
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2819e+01
  VMC Evar = 4.8829e-01
  Total weights = 1.9637e+06
  Execution time = 3.5787e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.474390695042
                                         uncertainty =       0.003143262805

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.474390695042
                                         uncertainty =       0.003143262805

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000487006777
  error estimate for blocks of size 2^( 2) =       0.000507669484
  error estimate for blocks of size 2^( 3) =       0.000527410704
  error estimate for blocks of size 2^( 4) =       0.000541400018
  error estimate for blocks of size 2^( 5) =       0.000549289401
  error estimate for blocks of size 2^( 6) =       0.000552680468
  error estimate for blocks of size 2^( 7) =       0.000556758862

      target function =                  N/A
              le_mean =     -22.818565483765
             les_mean =     521.176237688073
             stat err =       0.000550032188
             autocorr =       1.275575594011
              std dev =       0.688731588386
             le_variance =       0.474351200841

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.474351779344
                                         uncertainty =       0.003138468082

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.474351779344
                                         uncertainty =       0.003138468082

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000486986800
  error estimate for blocks of size 2^( 2) =       0.000507653387
  error estimate for blocks of size 2^( 3) =       0.000527397157
  error estimate for blocks of size 2^( 4) =       0.000541389467
  error estimate for blocks of size 2^( 5) =       0.000549279252
  error estimate for blocks of size 2^( 6) =       0.000552673034
  error estimate for blocks of size 2^( 7) =       0.000556754026

      target function =                  N/A
              le_mean =     -22.818565055992
             les_mean =     521.175246782574
             stat err =       0.000550023945
             autocorr =       1.275642014578
              std dev =       0.688703336842
             le_variance =       0.474312286178

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.474370576733
                                         uncertainty =       0.003140828873

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.474370576733
                                         uncertainty =       0.003140828873

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000486996449
  error estimate for blocks of size 2^( 2) =       0.000507661146
  error estimate for blocks of size 2^( 3) =       0.000527403670
  error estimate for blocks of size 2^( 4) =       0.000541394519
  error estimate for blocks of size 2^( 5) =       0.000549284099
  error estimate for blocks of size 2^( 6) =       0.000552676535
  error estimate for blocks of size 2^( 7) =       0.000556756322

      target function =                  N/A
              le_mean =     -22.818565207385
             les_mean =     521.175202943626
             stat err =       0.000550027869
             autocorr =       1.275609663445
              std dev =       0.688716982966
             le_variance =       0.474331082626

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.474388133411
                                         uncertainty =       0.003142956886

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.474388133411
                                         uncertainty =       0.003142956886

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000487005462
  error estimate for blocks of size 2^( 2) =       0.000507668416
  error estimate for blocks of size 2^( 3) =       0.000527409798
  error estimate for blocks of size 2^( 4) =       0.000541399306
  error estimate for blocks of size 2^( 5) =       0.000549288703
  error estimate for blocks of size 2^( 6) =       0.000552679913
  error estimate for blocks of size 2^( 7) =       0.000556758571

      target function =                  N/A
              le_mean =     -22.818565431561
             les_mean =     521.175773383527
             stat err =       0.000550031623
             autocorr =       1.275579864816
              std dev =       0.688729728721
             le_variance =       0.474348639225


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.818565483765        initial  <--
     6.1035e+00     6.1035e+01             1.0517e-04       -22.818565055992
     2.4414e+01     2.4414e+02             2.6541e-05       -22.818565207385
     9.7656e+01     9.7656e+02             6.6511e-06       -22.818565431561

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 42.9734
  </log>
  <optVariables href="FORM.s011.opt.xml">
ci_01                 1.273777e-01 3 1  ON 0
ci_02                -2.881281e-02 3 1  ON 1
ci_03                -2.857177e-02 3 1  ON 2
ci_04                 2.611877e-02 3 1  ON 3
ci_05                -2.400648e-02 3 1  ON 4
ci_06                -2.361344e-02 3 1  ON 5
ci_07                 2.583580e-02 3 1  ON 6
ci_08                -5.186036e-03 3 1  ON 7
ci_09                -1.174145e-02 3 1  ON 8
ci_10                -1.142199e-02 3 1  ON 9
ci_11                 1.571267e-02 3 1  ON 10
ci_12                 1.061919e-02 3 1  ON 11
ci_13                 1.147707e-02 3 1  ON 12
ci_14                 1.483495e-02 3 1  ON 13
ci_15                 8.674085e-03 3 1  ON 14
ci_16                 8.459936e-03 3 1  ON 15
ci_17                -9.904031e-03 3 1  ON 16
ci_18                -9.983266e-03 3 1  ON 17
ci_19                 9.785970e-03 3 1  ON 18
ci_20                 1.059667e-02 3 1  ON 19
ci_21                 7.587582e-03 3 1  ON 20
ci_22                 9.211265e-03 3 1  ON 21
ci_23                 6.518643e-03 3 1  ON 22
ci_24                 6.490319e-03 3 1  ON 23
ci_25                 5.196599e-03 3 1  ON 24
ci_26                 3.768492e-03 3 1  ON 25
ci_27                 3.058921e-03 3 1  ON 26
ci_28                 4.595188e-03 3 1  ON 27
ci_29                 4.623531e-03 3 1  ON 28
ci_30                -4.211617e-04 3 1  ON 29
ci_31                -4.984419e-04 3 1  ON 30
ci_32                -2.713136e-05 3 1  ON 31
ci_33                -4.681070e-04 3 1  ON 32
ci_34                 1.750821e-04 3 1  ON 33
ci_35                -2.430920e-04 3 1  ON 34
ci_36                -9.061151e-04 3 1  ON 35
ci_37                -8.683320e-04 3 1  ON 36
ci_38                -1.426000e-04 3 1  ON 37
ci_39                -2.813700e-04 3 1  ON 38
ci_40                -1.220762e-03 3 1  ON 39
ci_41                 5.902620e-04 3 1  ON 40
ci_42                 2.367974e-04 3 1  ON 41
ci_43                -2.484832e-03 3 1  ON 42
ci_44                -1.670178e-03 3 1  ON 43
ci_45                -4.833567e-04 3 1  ON 44
ci_46                -4.900624e-04 3 1  ON 45
ci_47                -1.580796e-03 3 1  ON 46
ci_48                -2.024467e-03 3 1  ON 47
ci_49                -1.690367e-03 3 1  ON 48
ci_50                -5.843980e-04 3 1  ON 49
ci_51                 5.743301e-04 3 1  ON 50
ci_52                 2.567697e-05 3 1  ON 51
ci_53                -9.227147e-04 3 1  ON 52
ci_54                -4.943575e-04 3 1  ON 53
ci_55                -6.907350e-04 3 1  ON 54
ci_56                 1.569219e-03 3 1  ON 55
ci_57                 1.596774e-03 3 1  ON 56
ci_58                -9.342514e-04 3 1  ON 57
ci_59                -1.003280e-03 3 1  ON 58
ci_60                 1.355203e-03 3 1  ON 59
ci_61                 1.823730e-03 3 1  ON 60
ci_62                -4.244376e-04 3 1  ON 61
ci_63                -7.762132e-05 3 1  ON 62
ci_64                -9.428280e-04 3 1  ON 63
ci_65                 1.275158e-04 3 1  ON 64
ci_66                -6.821638e-04 3 1  ON 65
ci_67                -6.553652e-04 3 1  ON 66
ci_68                -1.359717e-03 3 1  ON 67
ci_69                -1.597667e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.5201e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s012 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s012 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=12  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2820e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 12
    time step          = 0.05
    reference energy   = -22.8425
    reference variance = 0.375752
====================================================
  Execution time = 2.5655e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s012
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5335e+04
  VMC Eavg = -2.2820e+01
  VMC Evar = 4.9007e-01
  Total weights = 1.963508597e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.6424e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.474336934890
                                         uncertainty =       0.002135220075

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.474336934890
                                         uncertainty =       0.002135220075

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000486987127
  error estimate for blocks of size 2^( 2) =       0.000508246192
  error estimate for blocks of size 2^( 3) =       0.000528133175
  error estimate for blocks of size 2^( 4) =       0.000543052452
  error estimate for blocks of size 2^( 5) =       0.000552362285
  error estimate for blocks of size 2^( 6) =       0.000555864652
  error estimate for blocks of size 2^( 7) =       0.000558060474

      target function =                  N/A
              le_mean =     -22.819611303285
             les_mean =     521.224727743710
             stat err =       0.000552334966
             autocorr =       1.286382466536
              std dev =       0.688703799680
             le_variance =       0.474312923693


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281961130329e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.1035e+01, overlap shift 6.1035e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.819611303213       residual = 2.80e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.819611606638       residual = 6.96e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.819611621082       residual = 1.70e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.819611622959       residual = 2.79e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 6.1035e+01 is 1.649464e-05

solving harmonic davidson linear method for identity shift 2.4414e+02, overlap shift 2.4414e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.819611303213       residual = 2.80e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.819611379218       residual = 6.97e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.819611382806       residual = 1.72e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.819611383275       residual = 2.84e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.4414e+02 is 4.128472e-06

solving harmonic davidson linear method for identity shift 9.7656e+02, overlap shift 9.7656e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.819611303213       residual = 2.80e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.819611322224       residual = 6.97e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.819611323119       residual = 1.72e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.819611323236       residual = 2.85e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.7656e+02 is 1.032419e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.024467 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0307e+01
  </log>
  <optVariables href="FORM.s012.opt.xml">
ci_01                 1.273736e-01 3 1  ON 0
ci_02                -2.881043e-02 3 1  ON 1
ci_03                -2.856904e-02 3 1  ON 2
ci_04                 2.611697e-02 3 1  ON 3
ci_05                -2.400502e-02 3 1  ON 4
ci_06                -2.361265e-02 3 1  ON 5
ci_07                 2.583520e-02 3 1  ON 6
ci_08                -5.185187e-03 3 1  ON 7
ci_09                -1.174209e-02 3 1  ON 8
ci_10                -1.142215e-02 3 1  ON 9
ci_11                 1.571281e-02 3 1  ON 10
ci_12                 1.061897e-02 3 1  ON 11
ci_13                 1.147634e-02 3 1  ON 12
ci_14                 1.483550e-02 3 1  ON 13
ci_15                 8.674094e-03 3 1  ON 14
ci_16                 8.459808e-03 3 1  ON 15
ci_17                -9.903882e-03 3 1  ON 16
ci_18                -9.983408e-03 3 1  ON 17
ci_19                 9.785378e-03 3 1  ON 18
ci_20                 1.059831e-02 3 1  ON 19
ci_21                 7.587998e-03 3 1  ON 20
ci_22                 9.211150e-03 3 1  ON 21
ci_23                 6.518174e-03 3 1  ON 22
ci_24                 6.490912e-03 3 1  ON 23
ci_25                 5.197028e-03 3 1  ON 24
ci_26                 3.768239e-03 3 1  ON 25
ci_27                 3.058484e-03 3 1  ON 26
ci_28                 4.594737e-03 3 1  ON 27
ci_29                 4.623228e-03 3 1  ON 28
ci_30                -4.207905e-04 3 1  ON 29
ci_31                -4.979327e-04 3 1  ON 30
ci_32                -2.800499e-05 3 1  ON 31
ci_33                -4.684984e-04 3 1  ON 32
ci_34                 1.755733e-04 3 1  ON 33
ci_35                -2.425150e-04 3 1  ON 34
ci_36                -9.059639e-04 3 1  ON 35
ci_37                -8.692824e-04 3 1  ON 36
ci_38                -1.421716e-04 3 1  ON 37
ci_39                -2.814577e-04 3 1  ON 38
ci_40                -1.220779e-03 3 1  ON 39
ci_41                 5.897678e-04 3 1  ON 40
ci_42                 2.361994e-04 3 1  ON 41
ci_43                -2.484214e-03 3 1  ON 42
ci_44                -1.670504e-03 3 1  ON 43
ci_45                -4.834872e-04 3 1  ON 44
ci_46                -4.892110e-04 3 1  ON 45
ci_47                -1.581530e-03 3 1  ON 46
ci_48                -2.023907e-03 3 1  ON 47
ci_49                -1.689956e-03 3 1  ON 48
ci_50                -5.846636e-04 3 1  ON 49
ci_51                 5.738419e-04 3 1  ON 50
ci_52                 2.584368e-05 3 1  ON 51
ci_53                -9.222704e-04 3 1  ON 52
ci_54                -4.943485e-04 3 1  ON 53
ci_55                -6.908226e-04 3 1  ON 54
ci_56                 1.569240e-03 3 1  ON 55
ci_57                 1.597835e-03 3 1  ON 56
ci_58                -9.343737e-04 3 1  ON 57
ci_59                -1.003871e-03 3 1  ON 58
ci_60                 1.354935e-03 3 1  ON 59
ci_61                 1.823822e-03 3 1  ON 60
ci_62                -4.250753e-04 3 1  ON 61
ci_63                -7.831754e-05 3 1  ON 62
ci_64                -9.426142e-04 3 1  ON 63
ci_65                 1.272842e-04 3 1  ON 64
ci_66                -6.817719e-04 3 1  ON 65
ci_67                -6.556703e-04 3 1  ON 66
ci_68                -1.359112e-03 3 1  ON 67
ci_69                -1.597833e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 12
    time step          = 0.05
    reference energy   = -22.838
    reference variance = 0.419429
====================================================
  Execution time = 2.4996e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s012
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2819e+01
  VMC Evar = 4.8384e-01
  Total weights = 1.9637e+06
  Execution time = 3.5863e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.469147672954
                                         uncertainty =       0.002367221357

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.469147672954
                                         uncertainty =       0.002367221357

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000484310962
  error estimate for blocks of size 2^( 2) =       0.000505959292
  error estimate for blocks of size 2^( 3) =       0.000526027827
  error estimate for blocks of size 2^( 4) =       0.000541419236
  error estimate for blocks of size 2^( 5) =       0.000550367119
  error estimate for blocks of size 2^( 6) =       0.000553502710
  error estimate for blocks of size 2^( 7) =       0.000558748045

      target function =                  N/A
              le_mean =     -22.819277659409
             les_mean =     521.203277965031
             stat err =       0.000551009277
             autocorr =       1.294402143360
              std dev =       0.684919131400
             le_variance =       0.469114216558

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.469143933989
                                         uncertainty =       0.002367130456

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.469143933989
                                         uncertainty =       0.002367130456

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000484309027
  error estimate for blocks of size 2^( 2) =       0.000505957728
  error estimate for blocks of size 2^( 3) =       0.000526026730
  error estimate for blocks of size 2^( 4) =       0.000541418475
  error estimate for blocks of size 2^( 5) =       0.000550366666
  error estimate for blocks of size 2^( 6) =       0.000553502233
  error estimate for blocks of size 2^( 7) =       0.000558747697

      target function =                  N/A
              le_mean =     -22.819277654071
             les_mean =     521.203265087924
             stat err =       0.000551008768
             autocorr =       1.294410094265
              std dev =       0.684916394481
             le_variance =       0.469110467428

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.469145797185
                                         uncertainty =       0.002367175823

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.469145797185
                                         uncertainty =       0.002367175823

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000484309991
  error estimate for blocks of size 2^( 2) =       0.000505958507
  error estimate for blocks of size 2^( 3) =       0.000526027276
  error estimate for blocks of size 2^( 4) =       0.000541418853
  error estimate for blocks of size 2^( 5) =       0.000550366891
  error estimate for blocks of size 2^( 6) =       0.000553502469
  error estimate for blocks of size 2^( 7) =       0.000558747869

      target function =                  N/A
              le_mean =     -22.819277656479
             les_mean =     521.203271348536
             stat err =       0.000551009021
             autocorr =       1.294406127194
              std dev =       0.684917758342
             le_variance =       0.469112335692

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.469147438072
                                         uncertainty =       0.002367215661

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.469147438072
                                         uncertainty =       0.002367215661

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000484310841
  error estimate for blocks of size 2^( 2) =       0.000505959193
  error estimate for blocks of size 2^( 3) =       0.000526027758
  error estimate for blocks of size 2^( 4) =       0.000541419188
  error estimate for blocks of size 2^( 5) =       0.000550367090
  error estimate for blocks of size 2^( 6) =       0.000553502679
  error estimate for blocks of size 2^( 7) =       0.000558748023

      target function =                  N/A
              le_mean =     -22.819277659012
             les_mean =     521.203277118933
             stat err =       0.000551009245
             autocorr =       1.294402641606
              std dev =       0.684918959468
             le_variance =       0.469113981038


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.819277659409        initial  <--
     6.1035e+01     6.1035e+02             1.6495e-05       -22.819277654071
     2.4414e+02     2.4414e+03             4.1285e-06       -22.819277656479
     9.7656e+02     9.7656e+03             1.0324e-06       -22.819277659012

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 42.9666
  </log>
  <optVariables href="FORM.s012.opt.xml">
ci_01                 1.273777e-01 3 1  ON 0
ci_02                -2.881281e-02 3 1  ON 1
ci_03                -2.857177e-02 3 1  ON 2
ci_04                 2.611877e-02 3 1  ON 3
ci_05                -2.400648e-02 3 1  ON 4
ci_06                -2.361344e-02 3 1  ON 5
ci_07                 2.583580e-02 3 1  ON 6
ci_08                -5.186036e-03 3 1  ON 7
ci_09                -1.174145e-02 3 1  ON 8
ci_10                -1.142199e-02 3 1  ON 9
ci_11                 1.571267e-02 3 1  ON 10
ci_12                 1.061919e-02 3 1  ON 11
ci_13                 1.147707e-02 3 1  ON 12
ci_14                 1.483495e-02 3 1  ON 13
ci_15                 8.674085e-03 3 1  ON 14
ci_16                 8.459936e-03 3 1  ON 15
ci_17                -9.904031e-03 3 1  ON 16
ci_18                -9.983266e-03 3 1  ON 17
ci_19                 9.785970e-03 3 1  ON 18
ci_20                 1.059667e-02 3 1  ON 19
ci_21                 7.587582e-03 3 1  ON 20
ci_22                 9.211265e-03 3 1  ON 21
ci_23                 6.518643e-03 3 1  ON 22
ci_24                 6.490319e-03 3 1  ON 23
ci_25                 5.196599e-03 3 1  ON 24
ci_26                 3.768492e-03 3 1  ON 25
ci_27                 3.058921e-03 3 1  ON 26
ci_28                 4.595188e-03 3 1  ON 27
ci_29                 4.623531e-03 3 1  ON 28
ci_30                -4.211617e-04 3 1  ON 29
ci_31                -4.984419e-04 3 1  ON 30
ci_32                -2.713136e-05 3 1  ON 31
ci_33                -4.681070e-04 3 1  ON 32
ci_34                 1.750821e-04 3 1  ON 33
ci_35                -2.430920e-04 3 1  ON 34
ci_36                -9.061151e-04 3 1  ON 35
ci_37                -8.683320e-04 3 1  ON 36
ci_38                -1.426000e-04 3 1  ON 37
ci_39                -2.813700e-04 3 1  ON 38
ci_40                -1.220762e-03 3 1  ON 39
ci_41                 5.902620e-04 3 1  ON 40
ci_42                 2.367974e-04 3 1  ON 41
ci_43                -2.484832e-03 3 1  ON 42
ci_44                -1.670178e-03 3 1  ON 43
ci_45                -4.833567e-04 3 1  ON 44
ci_46                -4.900624e-04 3 1  ON 45
ci_47                -1.580796e-03 3 1  ON 46
ci_48                -2.024467e-03 3 1  ON 47
ci_49                -1.690367e-03 3 1  ON 48
ci_50                -5.843980e-04 3 1  ON 49
ci_51                 5.743301e-04 3 1  ON 50
ci_52                 2.567697e-05 3 1  ON 51
ci_53                -9.227147e-04 3 1  ON 52
ci_54                -4.943575e-04 3 1  ON 53
ci_55                -6.907350e-04 3 1  ON 54
ci_56                 1.569219e-03 3 1  ON 55
ci_57                 1.596774e-03 3 1  ON 56
ci_58                -9.342514e-04 3 1  ON 57
ci_59                -1.003280e-03 3 1  ON 58
ci_60                 1.355203e-03 3 1  ON 59
ci_61                 1.823730e-03 3 1  ON 60
ci_62                -4.244376e-04 3 1  ON 61
ci_63                -7.762132e-05 3 1  ON 62
ci_64                -9.428280e-04 3 1  ON 63
ci_65                 1.275158e-04 3 1  ON 64
ci_66                -6.821638e-04 3 1  ON 65
ci_67                -6.553652e-04 3 1  ON 66
ci_68                -1.359717e-03 3 1  ON 67
ci_69                -1.597667e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.3280e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s013 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s013 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=13  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2822e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 13
    time step          = 0.05
    reference energy   = -22.8535
    reference variance = 0.404786
====================================================
  Execution time = 2.5666e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s013
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5346e+04
  VMC Eavg = -2.2819e+01
  VMC Evar = 4.8945e-01
  Total weights = 1.963651960e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.6065e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.473188537445
                                         uncertainty =       0.002999472028

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.473188537445
                                         uncertainty =       0.002999472028

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000486430122
  error estimate for blocks of size 2^( 2) =       0.000507502104
  error estimate for blocks of size 2^( 3) =       0.000527255070
  error estimate for blocks of size 2^( 4) =       0.000541700493
  error estimate for blocks of size 2^( 5) =       0.000551014705
  error estimate for blocks of size 2^( 6) =       0.000555347811
  error estimate for blocks of size 2^( 7) =       0.000555493953

      target function =                  N/A
              le_mean =     -22.818683926691
             les_mean =     521.181782084061
             stat err =       0.000550889240
             autocorr =       1.282589438273
              std dev =       0.687916075427
             le_variance =       0.473228526831


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281868392669e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.1035e+02, overlap shift 6.1035e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.818683926591       residual = 3.39e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.818683961348       residual = 7.72e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.818683962438       residual = 1.85e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.818683962663       residual = 4.65e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 6.1035e+02 is 1.669833e-06

solving harmonic davidson linear method for identity shift 2.4414e+03, overlap shift 2.4414e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.818683926591       residual = 3.39e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.818683935282       residual = 7.72e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.818683935554       residual = 1.85e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.818683935611       residual = 4.66e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.4414e+03 is 4.175063e-07

solving harmonic davidson linear method for identity shift 9.7656e+03, overlap shift 9.7656e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.818683926591       residual = 3.39e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.818683928764       residual = 7.72e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.818683928832       residual = 1.85e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.818683928846       residual = 4.66e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.7656e+03 is 1.043796e-07

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.025826 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0282e+01
  </log>
  <optVariables href="FORM.s013.opt.xml">
ci_01                 1.273773e-01 3 1  ON 0
ci_02                -2.881258e-02 3 1  ON 1
ci_03                -2.857160e-02 3 1  ON 2
ci_04                 2.611856e-02 3 1  ON 3
ci_05                -2.400636e-02 3 1  ON 4
ci_06                -2.361337e-02 3 1  ON 5
ci_07                 2.583579e-02 3 1  ON 6
ci_08                -5.186098e-03 3 1  ON 7
ci_09                -1.174135e-02 3 1  ON 8
ci_10                -1.142207e-02 3 1  ON 9
ci_11                 1.571274e-02 3 1  ON 10
ci_12                 1.061918e-02 3 1  ON 11
ci_13                 1.147709e-02 3 1  ON 12
ci_14                 1.483503e-02 3 1  ON 13
ci_15                 8.673962e-03 3 1  ON 14
ci_16                 8.459878e-03 3 1  ON 15
ci_17                -9.904001e-03 3 1  ON 16
ci_18                -9.983300e-03 3 1  ON 17
ci_19                 9.785934e-03 3 1  ON 18
ci_20                 1.059667e-02 3 1  ON 19
ci_21                 7.587678e-03 3 1  ON 20
ci_22                 9.211218e-03 3 1  ON 21
ci_23                 6.518612e-03 3 1  ON 22
ci_24                 6.490436e-03 3 1  ON 23
ci_25                 5.196735e-03 3 1  ON 24
ci_26                 3.768341e-03 3 1  ON 25
ci_27                 3.058803e-03 3 1  ON 26
ci_28                 4.595232e-03 3 1  ON 27
ci_29                 4.623532e-03 3 1  ON 28
ci_30                -4.211367e-04 3 1  ON 29
ci_31                -4.984401e-04 3 1  ON 30
ci_32                -2.719128e-05 3 1  ON 31
ci_33                -4.679412e-04 3 1  ON 32
ci_34                 1.752053e-04 3 1  ON 33
ci_35                -2.430440e-04 3 1  ON 34
ci_36                -9.060782e-04 3 1  ON 35
ci_37                -8.684153e-04 3 1  ON 36
ci_38                -1.426290e-04 3 1  ON 37
ci_39                -2.814054e-04 3 1  ON 38
ci_40                -1.220876e-03 3 1  ON 39
ci_41                 5.901795e-04 3 1  ON 40
ci_42                 2.369362e-04 3 1  ON 41
ci_43                -2.484709e-03 3 1  ON 42
ci_44                -1.670134e-03 3 1  ON 43
ci_45                -4.833292e-04 3 1  ON 44
ci_46                -4.900454e-04 3 1  ON 45
ci_47                -1.580815e-03 3 1  ON 46
ci_48                -2.024393e-03 3 1  ON 47
ci_49                -1.690363e-03 3 1  ON 48
ci_50                -5.843823e-04 3 1  ON 49
ci_51                 5.741977e-04 3 1  ON 50
ci_52                 2.564461e-05 3 1  ON 51
ci_53                -9.227083e-04 3 1  ON 52
ci_54                -4.943833e-04 3 1  ON 53
ci_55                -6.907535e-04 3 1  ON 54
ci_56                 1.569270e-03 3 1  ON 55
ci_57                 1.596846e-03 3 1  ON 56
ci_58                -9.342269e-04 3 1  ON 57
ci_59                -1.003299e-03 3 1  ON 58
ci_60                 1.355202e-03 3 1  ON 59
ci_61                 1.823736e-03 3 1  ON 60
ci_62                -4.243780e-04 3 1  ON 61
ci_63                -7.773899e-05 3 1  ON 62
ci_64                -9.427700e-04 3 1  ON 63
ci_65                 1.274129e-04 3 1  ON 64
ci_66                -6.821112e-04 3 1  ON 65
ci_67                -6.553153e-04 3 1  ON 66
ci_68                -1.359683e-03 3 1  ON 67
ci_69                -1.597659e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 13
    time step          = 0.05
    reference energy   = -22.722
    reference variance = 0.342569
====================================================
  Execution time = 2.5037e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s013
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2820e+01
  VMC Evar = 4.8691e-01
  Total weights = 1.9636e+06
  Execution time = 3.5690e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.472718867412
                                         uncertainty =       0.002107371807

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.472718867412
                                         uncertainty =       0.002107371807

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000486146602
  error estimate for blocks of size 2^( 2) =       0.000507529390
  error estimate for blocks of size 2^( 3) =       0.000527584277
  error estimate for blocks of size 2^( 4) =       0.000542996251
  error estimate for blocks of size 2^( 5) =       0.000553701554
  error estimate for blocks of size 2^( 6) =       0.000557699923
  error estimate for blocks of size 2^( 7) =       0.000561058048

      target function =                  N/A
              le_mean =     -22.819939866900
             les_mean =     521.236565135878
             stat err =       0.000553863944
             autocorr =       1.297990990390
              std dev =       0.687515118349
             le_variance =       0.472677037959

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.472718575280
                                         uncertainty =       0.002107366824

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.472718575280
                                         uncertainty =       0.002107366824

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000486146452
  error estimate for blocks of size 2^( 2) =       0.000507529263
  error estimate for blocks of size 2^( 3) =       0.000527584184
  error estimate for blocks of size 2^( 4) =       0.000542996202
  error estimate for blocks of size 2^( 5) =       0.000553701517
  error estimate for blocks of size 2^( 6) =       0.000557699911
  error estimate for blocks of size 2^( 7) =       0.000561058031

      target function =                  N/A
              le_mean =     -22.819939863693
             les_mean =     521.236564678649
             stat err =       0.000553863915
             autocorr =       1.297991657669
              std dev =       0.687514906062
             le_variance =       0.472676746058

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.472718721287
                                         uncertainty =       0.002107369315

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.472718721287
                                         uncertainty =       0.002107369315

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000486146527
  error estimate for blocks of size 2^( 2) =       0.000507529326
  error estimate for blocks of size 2^( 3) =       0.000527584231
  error estimate for blocks of size 2^( 4) =       0.000542996226
  error estimate for blocks of size 2^( 5) =       0.000553701535
  error estimate for blocks of size 2^( 6) =       0.000557699917
  error estimate for blocks of size 2^( 7) =       0.000561058040

      target function =                  N/A
              le_mean =     -22.819939865293
             les_mean =     521.236564900592
             stat err =       0.000553863930
             autocorr =       1.297991324112
              std dev =       0.687515012163
             le_variance =       0.472676891949

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.472718849142
                                         uncertainty =       0.002107371495

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.472718849142
                                         uncertainty =       0.002107371495

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000486146593
  error estimate for blocks of size 2^( 2) =       0.000507529382
  error estimate for blocks of size 2^( 3) =       0.000527584272
  error estimate for blocks of size 2^( 4) =       0.000542996248
  error estimate for blocks of size 2^( 5) =       0.000553701551
  error estimate for blocks of size 2^( 6) =       0.000557699922
  error estimate for blocks of size 2^( 7) =       0.000561058047

      target function =                  N/A
              le_mean =     -22.819939866699
             les_mean =     521.236565105715
             stat err =       0.000553863942
             autocorr =       1.297991032104
              std dev =       0.687515105073
             le_variance =       0.472677019703


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.819939866900        initial  <--
     6.1035e+02     6.1035e+03             1.6698e-06       -22.819939863693
     2.4414e+03     2.4414e+04             4.1751e-07       -22.819939865293
     9.7656e+03     9.7656e+04             1.0438e-07       -22.819939866699

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 42.9341
  </log>
  <optVariables href="FORM.s013.opt.xml">
ci_01                 1.273777e-01 3 1  ON 0
ci_02                -2.881281e-02 3 1  ON 1
ci_03                -2.857177e-02 3 1  ON 2
ci_04                 2.611877e-02 3 1  ON 3
ci_05                -2.400648e-02 3 1  ON 4
ci_06                -2.361344e-02 3 1  ON 5
ci_07                 2.583580e-02 3 1  ON 6
ci_08                -5.186036e-03 3 1  ON 7
ci_09                -1.174145e-02 3 1  ON 8
ci_10                -1.142199e-02 3 1  ON 9
ci_11                 1.571267e-02 3 1  ON 10
ci_12                 1.061919e-02 3 1  ON 11
ci_13                 1.147707e-02 3 1  ON 12
ci_14                 1.483495e-02 3 1  ON 13
ci_15                 8.674085e-03 3 1  ON 14
ci_16                 8.459936e-03 3 1  ON 15
ci_17                -9.904031e-03 3 1  ON 16
ci_18                -9.983266e-03 3 1  ON 17
ci_19                 9.785970e-03 3 1  ON 18
ci_20                 1.059667e-02 3 1  ON 19
ci_21                 7.587582e-03 3 1  ON 20
ci_22                 9.211265e-03 3 1  ON 21
ci_23                 6.518643e-03 3 1  ON 22
ci_24                 6.490319e-03 3 1  ON 23
ci_25                 5.196599e-03 3 1  ON 24
ci_26                 3.768492e-03 3 1  ON 25
ci_27                 3.058921e-03 3 1  ON 26
ci_28                 4.595188e-03 3 1  ON 27
ci_29                 4.623531e-03 3 1  ON 28
ci_30                -4.211617e-04 3 1  ON 29
ci_31                -4.984419e-04 3 1  ON 30
ci_32                -2.713136e-05 3 1  ON 31
ci_33                -4.681070e-04 3 1  ON 32
ci_34                 1.750821e-04 3 1  ON 33
ci_35                -2.430920e-04 3 1  ON 34
ci_36                -9.061151e-04 3 1  ON 35
ci_37                -8.683320e-04 3 1  ON 36
ci_38                -1.426000e-04 3 1  ON 37
ci_39                -2.813700e-04 3 1  ON 38
ci_40                -1.220762e-03 3 1  ON 39
ci_41                 5.902620e-04 3 1  ON 40
ci_42                 2.367974e-04 3 1  ON 41
ci_43                -2.484832e-03 3 1  ON 42
ci_44                -1.670178e-03 3 1  ON 43
ci_45                -4.833567e-04 3 1  ON 44
ci_46                -4.900624e-04 3 1  ON 45
ci_47                -1.580796e-03 3 1  ON 46
ci_48                -2.024467e-03 3 1  ON 47
ci_49                -1.690367e-03 3 1  ON 48
ci_50                -5.843980e-04 3 1  ON 49
ci_51                 5.743301e-04 3 1  ON 50
ci_52                 2.567697e-05 3 1  ON 51
ci_53                -9.227147e-04 3 1  ON 52
ci_54                -4.943575e-04 3 1  ON 53
ci_55                -6.907350e-04 3 1  ON 54
ci_56                 1.569219e-03 3 1  ON 55
ci_57                 1.596774e-03 3 1  ON 56
ci_58                -9.342514e-04 3 1  ON 57
ci_59                -1.003280e-03 3 1  ON 58
ci_60                 1.355203e-03 3 1  ON 59
ci_61                 1.823730e-03 3 1  ON 60
ci_62                -4.244376e-04 3 1  ON 61
ci_63                -7.762132e-05 3 1  ON 62
ci_64                -9.428280e-04 3 1  ON 63
ci_65                 1.275158e-04 3 1  ON 64
ci_66                -6.821638e-04 3 1  ON 65
ci_67                -6.553652e-04 3 1  ON 66
ci_68                -1.359717e-03 3 1  ON 67
ci_69                -1.597667e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.3222e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s014 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s014 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=14  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2819e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 14
    time step          = 0.05
    reference energy   = -22.798
    reference variance = 0.292061
====================================================
  Execution time = 2.5697e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s014
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5351e+04
  VMC Eavg = -2.2819e+01
  VMC Evar = 5.0030e-01
  Total weights = 1.963426069e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.7082e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.475545577973
                                         uncertainty =       0.004244341368

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.475545577973
                                         uncertainty =       0.004244341368

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000487598800
  error estimate for blocks of size 2^( 2) =       0.000508483855
  error estimate for blocks of size 2^( 3) =       0.000528180217
  error estimate for blocks of size 2^( 4) =       0.000544185728
  error estimate for blocks of size 2^( 5) =       0.000553847195
  error estimate for blocks of size 2^( 6) =       0.000560201226
  error estimate for blocks of size 2^( 7) =       0.000561082560

      target function =                  N/A
              le_mean =     -22.818794431394
             les_mean =     521.197684168800
             stat err =       0.000554829177
             autocorr =       1.294772080703
              std dev =       0.689568836441
             le_variance =       0.475505180190


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281879443139e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.1035e+03, overlap shift 6.1035e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.818794431322       residual = 3.24e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.818794433915       residual = 6.00e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.818794433910       residual = 1.98e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.818794433927       residual = 3.39e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 6.1035e+03 is 1.427946e-07

solving harmonic davidson linear method for identity shift 2.4414e+04, overlap shift 2.4414e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.818794431322       residual = 3.24e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.818794431971       residual = 6.00e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.818794431969       residual = 1.98e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.818794431983       residual = 3.39e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.4414e+04 is 3.569935e-08

solving harmonic davidson linear method for identity shift 9.7656e+04, overlap shift 9.7656e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.818794431322       residual = 3.24e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.818794431485       residual = 6.00e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.818794431484       residual = 1.98e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.818794431485       residual = 3.39e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.7656e+04 is 8.924881e-09

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.027178 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0415e+01
  </log>
  <optVariables href="FORM.s014.opt.xml">
ci_01                 1.273777e-01 3 1  ON 0
ci_02                -2.881277e-02 3 1  ON 1
ci_03                -2.857174e-02 3 1  ON 2
ci_04                 2.611876e-02 3 1  ON 3
ci_05                -2.400648e-02 3 1  ON 4
ci_06                -2.361344e-02 3 1  ON 5
ci_07                 2.583579e-02 3 1  ON 6
ci_08                -5.186026e-03 3 1  ON 7
ci_09                -1.174145e-02 3 1  ON 8
ci_10                -1.142198e-02 3 1  ON 9
ci_11                 1.571267e-02 3 1  ON 10
ci_12                 1.061919e-02 3 1  ON 11
ci_13                 1.147708e-02 3 1  ON 12
ci_14                 1.483496e-02 3 1  ON 13
ci_15                 8.674074e-03 3 1  ON 14
ci_16                 8.459930e-03 3 1  ON 15
ci_17                -9.904023e-03 3 1  ON 16
ci_18                -9.983268e-03 3 1  ON 17
ci_19                 9.785975e-03 3 1  ON 18
ci_20                 1.059666e-02 3 1  ON 19
ci_21                 7.587585e-03 3 1  ON 20
ci_22                 9.211266e-03 3 1  ON 21
ci_23                 6.518641e-03 3 1  ON 22
ci_24                 6.490327e-03 3 1  ON 23
ci_25                 5.196605e-03 3 1  ON 24
ci_26                 3.768479e-03 3 1  ON 25
ci_27                 3.058915e-03 3 1  ON 26
ci_28                 4.595183e-03 3 1  ON 27
ci_29                 4.623522e-03 3 1  ON 28
ci_30                -4.211642e-04 3 1  ON 29
ci_31                -4.984386e-04 3 1  ON 30
ci_32                -2.712282e-05 3 1  ON 31
ci_33                -4.681170e-04 3 1  ON 32
ci_34                 1.750777e-04 3 1  ON 33
ci_35                -2.430844e-04 3 1  ON 34
ci_36                -9.061179e-04 3 1  ON 35
ci_37                -8.683312e-04 3 1  ON 36
ci_38                -1.426005e-04 3 1  ON 37
ci_39                -2.813713e-04 3 1  ON 38
ci_40                -1.220768e-03 3 1  ON 39
ci_41                 5.902650e-04 3 1  ON 40
ci_42                 2.367975e-04 3 1  ON 41
ci_43                -2.484825e-03 3 1  ON 42
ci_44                -1.670178e-03 3 1  ON 43
ci_45                -4.833613e-04 3 1  ON 44
ci_46                -4.900663e-04 3 1  ON 45
ci_47                -1.580795e-03 3 1  ON 46
ci_48                -2.024466e-03 3 1  ON 47
ci_49                -1.690366e-03 3 1  ON 48
ci_50                -5.844024e-04 3 1  ON 49
ci_51                 5.743274e-04 3 1  ON 50
ci_52                 2.567696e-05 3 1  ON 51
ci_53                -9.227166e-04 3 1  ON 52
ci_54                -4.943506e-04 3 1  ON 53
ci_55                -6.907370e-04 3 1  ON 54
ci_56                 1.569233e-03 3 1  ON 55
ci_57                 1.596774e-03 3 1  ON 56
ci_58                -9.342492e-04 3 1  ON 57
ci_59                -1.003290e-03 3 1  ON 58
ci_60                 1.355202e-03 3 1  ON 59
ci_61                 1.823728e-03 3 1  ON 60
ci_62                -4.244384e-04 3 1  ON 61
ci_63                -7.763235e-05 3 1  ON 62
ci_64                -9.428153e-04 3 1  ON 63
ci_65                 1.275080e-04 3 1  ON 64
ci_66                -6.821693e-04 3 1  ON 65
ci_67                -6.553692e-04 3 1  ON 66
ci_68                -1.359721e-03 3 1  ON 67
ci_69                -1.597669e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 14
    time step          = 0.05
    reference energy   = -22.9476
    reference variance = 0.249549
====================================================
  Execution time = 2.5190e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s014
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2819e+01
  VMC Evar = 4.8913e-01
  Total weights = 1.9638e+06
  Execution time = 3.5935e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.473696590255
                                         uncertainty =       0.002494194769

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.473696590255
                                         uncertainty =       0.002494194769

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000486635594
  error estimate for blocks of size 2^( 2) =       0.000507877096
  error estimate for blocks of size 2^( 3) =       0.000528488204
  error estimate for blocks of size 2^( 4) =       0.000543634450
  error estimate for blocks of size 2^( 5) =       0.000554387240
  error estimate for blocks of size 2^( 6) =       0.000559873045
  error estimate for blocks of size 2^( 7) =       0.000563087260

      target function =                  N/A
              le_mean =     -22.818705906980
             les_mean =     521.182465075874
             stat err =       0.000555245499
             autocorr =       1.301854208458
              std dev =       0.688206656425
             le_variance =       0.473628401948

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.473696581465
                                         uncertainty =       0.002494208903

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.473696581465
                                         uncertainty =       0.002494208903

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000486635589
  error estimate for blocks of size 2^( 2) =       0.000507877094
  error estimate for blocks of size 2^( 3) =       0.000528488204
  error estimate for blocks of size 2^( 4) =       0.000543634454
  error estimate for blocks of size 2^( 5) =       0.000554387246
  error estimate for blocks of size 2^( 6) =       0.000559873055
  error estimate for blocks of size 2^( 7) =       0.000563087274

      target function =                  N/A
              le_mean =     -22.818705906910
             les_mean =     521.182465087986
             stat err =       0.000555245507
             autocorr =       1.301854271885
              std dev =       0.688206650030
             le_variance =       0.473628393146

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.473696585859
                                         uncertainty =       0.002494201836

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.473696585859
                                         uncertainty =       0.002494201836

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000486635591
  error estimate for blocks of size 2^( 2) =       0.000507877095
  error estimate for blocks of size 2^( 3) =       0.000528488204
  error estimate for blocks of size 2^( 4) =       0.000543634452
  error estimate for blocks of size 2^( 5) =       0.000554387243
  error estimate for blocks of size 2^( 6) =       0.000559873050
  error estimate for blocks of size 2^( 7) =       0.000563087267

      target function =                  N/A
              le_mean =     -22.818705906945
             les_mean =     521.182465081886
             stat err =       0.000555245503
             autocorr =       1.301854240168
              std dev =       0.688206653227
             le_variance =       0.473628397546

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.473696589706
                                         uncertainty =       0.002494195652

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.473696589706
                                         uncertainty =       0.002494195652

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000486635593
  error estimate for blocks of size 2^( 2) =       0.000507877096
  error estimate for blocks of size 2^( 3) =       0.000528488204
  error estimate for blocks of size 2^( 4) =       0.000543634451
  error estimate for blocks of size 2^( 5) =       0.000554387241
  error estimate for blocks of size 2^( 6) =       0.000559873046
  error estimate for blocks of size 2^( 7) =       0.000563087261

      target function =                  N/A
              le_mean =     -22.818705906976
             les_mean =     521.182465076621
             stat err =       0.000555245500
             autocorr =       1.301854212421
              std dev =       0.688206656025
             le_variance =       0.473628401398


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.818705906980        initial  <--
     6.1035e+03     6.1035e+04             1.4279e-07       -22.818705906910
     2.4414e+04     2.4414e+05             3.5699e-08       -22.818705906945
     9.7656e+04     9.7656e+05             8.9249e-09       -22.818705906976

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 43.1977
  </log>
  <optVariables href="FORM.s014.opt.xml">
ci_01                 1.273777e-01 3 1  ON 0
ci_02                -2.881281e-02 3 1  ON 1
ci_03                -2.857177e-02 3 1  ON 2
ci_04                 2.611877e-02 3 1  ON 3
ci_05                -2.400648e-02 3 1  ON 4
ci_06                -2.361344e-02 3 1  ON 5
ci_07                 2.583580e-02 3 1  ON 6
ci_08                -5.186036e-03 3 1  ON 7
ci_09                -1.174145e-02 3 1  ON 8
ci_10                -1.142199e-02 3 1  ON 9
ci_11                 1.571267e-02 3 1  ON 10
ci_12                 1.061919e-02 3 1  ON 11
ci_13                 1.147707e-02 3 1  ON 12
ci_14                 1.483495e-02 3 1  ON 13
ci_15                 8.674085e-03 3 1  ON 14
ci_16                 8.459936e-03 3 1  ON 15
ci_17                -9.904031e-03 3 1  ON 16
ci_18                -9.983266e-03 3 1  ON 17
ci_19                 9.785970e-03 3 1  ON 18
ci_20                 1.059667e-02 3 1  ON 19
ci_21                 7.587582e-03 3 1  ON 20
ci_22                 9.211265e-03 3 1  ON 21
ci_23                 6.518643e-03 3 1  ON 22
ci_24                 6.490319e-03 3 1  ON 23
ci_25                 5.196599e-03 3 1  ON 24
ci_26                 3.768492e-03 3 1  ON 25
ci_27                 3.058921e-03 3 1  ON 26
ci_28                 4.595188e-03 3 1  ON 27
ci_29                 4.623531e-03 3 1  ON 28
ci_30                -4.211617e-04 3 1  ON 29
ci_31                -4.984419e-04 3 1  ON 30
ci_32                -2.713136e-05 3 1  ON 31
ci_33                -4.681070e-04 3 1  ON 32
ci_34                 1.750821e-04 3 1  ON 33
ci_35                -2.430920e-04 3 1  ON 34
ci_36                -9.061151e-04 3 1  ON 35
ci_37                -8.683320e-04 3 1  ON 36
ci_38                -1.426000e-04 3 1  ON 37
ci_39                -2.813700e-04 3 1  ON 38
ci_40                -1.220762e-03 3 1  ON 39
ci_41                 5.902620e-04 3 1  ON 40
ci_42                 2.367974e-04 3 1  ON 41
ci_43                -2.484832e-03 3 1  ON 42
ci_44                -1.670178e-03 3 1  ON 43
ci_45                -4.833567e-04 3 1  ON 44
ci_46                -4.900624e-04 3 1  ON 45
ci_47                -1.580796e-03 3 1  ON 46
ci_48                -2.024467e-03 3 1  ON 47
ci_49                -1.690367e-03 3 1  ON 48
ci_50                -5.843980e-04 3 1  ON 49
ci_51                 5.743301e-04 3 1  ON 50
ci_52                 2.567697e-05 3 1  ON 51
ci_53                -9.227147e-04 3 1  ON 52
ci_54                -4.943575e-04 3 1  ON 53
ci_55                -6.907350e-04 3 1  ON 54
ci_56                 1.569219e-03 3 1  ON 55
ci_57                 1.596774e-03 3 1  ON 56
ci_58                -9.342514e-04 3 1  ON 57
ci_59                -1.003280e-03 3 1  ON 58
ci_60                 1.355203e-03 3 1  ON 59
ci_61                 1.823730e-03 3 1  ON 60
ci_62                -4.244376e-04 3 1  ON 61
ci_63                -7.762132e-05 3 1  ON 62
ci_64                -9.428280e-04 3 1  ON 63
ci_65                 1.275158e-04 3 1  ON 64
ci_66                -6.821638e-04 3 1  ON 65
ci_67                -6.553652e-04 3 1  ON 66
ci_68                -1.359717e-03 3 1  ON 67
ci_69                -1.597667e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.3625e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s015 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s015 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=15  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2823e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 15
    time step          = 0.05
    reference energy   = -22.7922
    reference variance = 0.369361
====================================================
  Execution time = 2.7500e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s015
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5373e+04
  VMC Eavg = -2.2818e+01
  VMC Evar = 4.9359e-01
  Total weights = 1.963433194e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.5898e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.474987712126
                                         uncertainty =       0.003476537632

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.474987712126
                                         uncertainty =       0.003476537632

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000487361894
  error estimate for blocks of size 2^( 2) =       0.000508581213
  error estimate for blocks of size 2^( 3) =       0.000528327167
  error estimate for blocks of size 2^( 4) =       0.000542918160
  error estimate for blocks of size 2^( 5) =       0.000551899824
  error estimate for blocks of size 2^( 6) =       0.000556631887
  error estimate for blocks of size 2^( 7) =       0.000559819191

      target function =                  N/A
              le_mean =     -22.818483046751
             les_mean =     521.176760922463
             stat err =       0.000552817266
             autocorr =       1.286648918000
              std dev =       0.689233799777
             le_variance =       0.475043230755


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281848304675e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.1035e+04, overlap shift 6.1035e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.818483046647       residual = 5.81e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.818483046844       residual = 1.69e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.818483046923       residual = 5.19e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.818483046921       residual = 1.03e-08           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.818483046921       residual = 3.18e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          4 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 6.1035e+04 is 1.938215e-08

solving harmonic davidson linear method for identity shift 2.4414e+05, overlap shift 2.4414e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.818483046647       residual = 5.81e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.818483046696       residual = 1.69e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.818483046716       residual = 5.19e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.818483046715       residual = 1.03e-08           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.818483046716       residual = 3.18e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          4 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.4414e+05 is 4.845543e-09

solving harmonic davidson linear method for identity shift 9.7656e+05, overlap shift 9.7656e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.818483046647       residual = 5.81e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.818483046659       residual = 1.69e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.818483046664       residual = 5.19e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.818483046664       residual = 1.03e-08           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.818483046664       residual = 3.18e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          4 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.7656e+05 is 1.211386e-09

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.028839 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.2100e+01
  </log>
  <optVariables href="FORM.s015.opt.xml">
ci_01                 1.273777e-01 3 1  ON 0
ci_02                -2.881281e-02 3 1  ON 1
ci_03                -2.857176e-02 3 1  ON 2
ci_04                 2.611877e-02 3 1  ON 3
ci_05                -2.400648e-02 3 1  ON 4
ci_06                -2.361344e-02 3 1  ON 5
ci_07                 2.583580e-02 3 1  ON 6
ci_08                -5.186038e-03 3 1  ON 7
ci_09                -1.174145e-02 3 1  ON 8
ci_10                -1.142198e-02 3 1  ON 9
ci_11                 1.571267e-02 3 1  ON 10
ci_12                 1.061919e-02 3 1  ON 11
ci_13                 1.147707e-02 3 1  ON 12
ci_14                 1.483495e-02 3 1  ON 13
ci_15                 8.674085e-03 3 1  ON 14
ci_16                 8.459937e-03 3 1  ON 15
ci_17                -9.904032e-03 3 1  ON 16
ci_18                -9.983267e-03 3 1  ON 17
ci_19                 9.785970e-03 3 1  ON 18
ci_20                 1.059667e-02 3 1  ON 19
ci_21                 7.587582e-03 3 1  ON 20
ci_22                 9.211264e-03 3 1  ON 21
ci_23                 6.518643e-03 3 1  ON 22
ci_24                 6.490319e-03 3 1  ON 23
ci_25                 5.196599e-03 3 1  ON 24
ci_26                 3.768492e-03 3 1  ON 25
ci_27                 3.058921e-03 3 1  ON 26
ci_28                 4.595187e-03 3 1  ON 27
ci_29                 4.623530e-03 3 1  ON 28
ci_30                -4.211626e-04 3 1  ON 29
ci_31                -4.984412e-04 3 1  ON 30
ci_32                -2.713154e-05 3 1  ON 31
ci_33                -4.681074e-04 3 1  ON 32
ci_34                 1.750828e-04 3 1  ON 33
ci_35                -2.430920e-04 3 1  ON 34
ci_36                -9.061120e-04 3 1  ON 35
ci_37                -8.683323e-04 3 1  ON 36
ci_38                -1.425990e-04 3 1  ON 37
ci_39                -2.813700e-04 3 1  ON 38
ci_40                -1.220762e-03 3 1  ON 39
ci_41                 5.902621e-04 3 1  ON 40
ci_42                 2.367981e-04 3 1  ON 41
ci_43                -2.484831e-03 3 1  ON 42
ci_44                -1.670178e-03 3 1  ON 43
ci_45                -4.833556e-04 3 1  ON 44
ci_46                -4.900607e-04 3 1  ON 45
ci_47                -1.580797e-03 3 1  ON 46
ci_48                -2.024466e-03 3 1  ON 47
ci_49                -1.690367e-03 3 1  ON 48
ci_50                -5.844015e-04 3 1  ON 49
ci_51                 5.743301e-04 3 1  ON 50
ci_52                 2.567748e-05 3 1  ON 51
ci_53                -9.227137e-04 3 1  ON 52
ci_54                -4.943575e-04 3 1  ON 53
ci_55                -6.907354e-04 3 1  ON 54
ci_56                 1.569219e-03 3 1  ON 55
ci_57                 1.596774e-03 3 1  ON 56
ci_58                -9.342519e-04 3 1  ON 57
ci_59                -1.003280e-03 3 1  ON 58
ci_60                 1.355203e-03 3 1  ON 59
ci_61                 1.823731e-03 3 1  ON 60
ci_62                -4.244392e-04 3 1  ON 61
ci_63                -7.762205e-05 3 1  ON 62
ci_64                -9.428278e-04 3 1  ON 63
ci_65                 1.275155e-04 3 1  ON 64
ci_66                -6.821644e-04 3 1  ON 65
ci_67                -6.553660e-04 3 1  ON 66
ci_68                -1.359718e-03 3 1  ON 67
ci_69                -1.597667e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 15
    time step          = 0.05
    reference energy   = -22.9338
    reference variance = 0.494641
====================================================
  Execution time = 2.5000e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s015
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2819e+01
  VMC Evar = 4.8743e-01
  Total weights = 1.9634e+06
  Execution time = 3.5800e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.472387335388
                                         uncertainty =       0.003584166207

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.472387335388
                                         uncertainty =       0.003584166207

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000485948342
  error estimate for blocks of size 2^( 2) =       0.000507218849
  error estimate for blocks of size 2^( 3) =       0.000527348400
  error estimate for blocks of size 2^( 4) =       0.000542414811
  error estimate for blocks of size 2^( 5) =       0.000552799632
  error estimate for blocks of size 2^( 6) =       0.000560220677
  error estimate for blocks of size 2^( 7) =       0.000564238295

      target function =                  N/A
              le_mean =     -22.819052697132
             les_mean =     521.196591779044
             stat err =       0.000554918354
             autocorr =       1.304001131557
              std dev =       0.687234736268
             le_variance =       0.472291582734

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.472387332779
                                         uncertainty =       0.003584166829

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.472387332779
                                         uncertainty =       0.003584166829

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000485948341
  error estimate for blocks of size 2^( 2) =       0.000507218848
  error estimate for blocks of size 2^( 3) =       0.000527348400
  error estimate for blocks of size 2^( 4) =       0.000542414810
  error estimate for blocks of size 2^( 5) =       0.000552799632
  error estimate for blocks of size 2^( 6) =       0.000560220678
  error estimate for blocks of size 2^( 7) =       0.000564238296

      target function =                  N/A
              le_mean =     -22.819052697053
             les_mean =     521.196591769305
             stat err =       0.000554918354
             autocorr =       1.304001140784
              std dev =       0.687234734376
             le_variance =       0.472291580133

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.472387334084
                                         uncertainty =       0.003584166518

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.472387334084
                                         uncertainty =       0.003584166518

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000485948342
  error estimate for blocks of size 2^( 2) =       0.000507218849
  error estimate for blocks of size 2^( 3) =       0.000527348400
  error estimate for blocks of size 2^( 4) =       0.000542414811
  error estimate for blocks of size 2^( 5) =       0.000552799632
  error estimate for blocks of size 2^( 6) =       0.000560220677
  error estimate for blocks of size 2^( 7) =       0.000564238295

      target function =                  N/A
              le_mean =     -22.819052697093
             les_mean =     521.196591774174
             stat err =       0.000554918354
             autocorr =       1.304001136158
              std dev =       0.687234735322
             le_variance =       0.472291581433

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.472387335225
                                         uncertainty =       0.003584166246

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.472387335225
                                         uncertainty =       0.003584166246

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000485948342
  error estimate for blocks of size 2^( 2) =       0.000507218849
  error estimate for blocks of size 2^( 3) =       0.000527348400
  error estimate for blocks of size 2^( 4) =       0.000542414811
  error estimate for blocks of size 2^( 5) =       0.000552799632
  error estimate for blocks of size 2^( 6) =       0.000560220677
  error estimate for blocks of size 2^( 7) =       0.000564238295

      target function =                  N/A
              le_mean =     -22.819052697127
             les_mean =     521.196591778435
             stat err =       0.000554918354
             autocorr =       1.304001132127
              std dev =       0.687234736150
             le_variance =       0.472291582571


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.819052697132        initial  <--
     6.1035e+04     6.1035e+05             1.9382e-08       -22.819052697053
     2.4414e+05     2.4414e+06             4.8455e-09       -22.819052697093
     9.7656e+05     9.7656e+06             1.2114e-09       -22.819052697127

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 43.0041
  </log>
  <optVariables href="FORM.s015.opt.xml">
ci_01                 1.273777e-01 3 1  ON 0
ci_02                -2.881281e-02 3 1  ON 1
ci_03                -2.857177e-02 3 1  ON 2
ci_04                 2.611877e-02 3 1  ON 3
ci_05                -2.400648e-02 3 1  ON 4
ci_06                -2.361344e-02 3 1  ON 5
ci_07                 2.583580e-02 3 1  ON 6
ci_08                -5.186036e-03 3 1  ON 7
ci_09                -1.174145e-02 3 1  ON 8
ci_10                -1.142199e-02 3 1  ON 9
ci_11                 1.571267e-02 3 1  ON 10
ci_12                 1.061919e-02 3 1  ON 11
ci_13                 1.147707e-02 3 1  ON 12
ci_14                 1.483495e-02 3 1  ON 13
ci_15                 8.674085e-03 3 1  ON 14
ci_16                 8.459936e-03 3 1  ON 15
ci_17                -9.904031e-03 3 1  ON 16
ci_18                -9.983266e-03 3 1  ON 17
ci_19                 9.785970e-03 3 1  ON 18
ci_20                 1.059667e-02 3 1  ON 19
ci_21                 7.587582e-03 3 1  ON 20
ci_22                 9.211265e-03 3 1  ON 21
ci_23                 6.518643e-03 3 1  ON 22
ci_24                 6.490319e-03 3 1  ON 23
ci_25                 5.196599e-03 3 1  ON 24
ci_26                 3.768492e-03 3 1  ON 25
ci_27                 3.058921e-03 3 1  ON 26
ci_28                 4.595188e-03 3 1  ON 27
ci_29                 4.623531e-03 3 1  ON 28
ci_30                -4.211617e-04 3 1  ON 29
ci_31                -4.984419e-04 3 1  ON 30
ci_32                -2.713136e-05 3 1  ON 31
ci_33                -4.681070e-04 3 1  ON 32
ci_34                 1.750821e-04 3 1  ON 33
ci_35                -2.430920e-04 3 1  ON 34
ci_36                -9.061151e-04 3 1  ON 35
ci_37                -8.683320e-04 3 1  ON 36
ci_38                -1.426000e-04 3 1  ON 37
ci_39                -2.813700e-04 3 1  ON 38
ci_40                -1.220762e-03 3 1  ON 39
ci_41                 5.902620e-04 3 1  ON 40
ci_42                 2.367974e-04 3 1  ON 41
ci_43                -2.484832e-03 3 1  ON 42
ci_44                -1.670178e-03 3 1  ON 43
ci_45                -4.833567e-04 3 1  ON 44
ci_46                -4.900624e-04 3 1  ON 45
ci_47                -1.580796e-03 3 1  ON 46
ci_48                -2.024467e-03 3 1  ON 47
ci_49                -1.690367e-03 3 1  ON 48
ci_50                -5.843980e-04 3 1  ON 49
ci_51                 5.743301e-04 3 1  ON 50
ci_52                 2.567697e-05 3 1  ON 51
ci_53                -9.227147e-04 3 1  ON 52
ci_54                -4.943575e-04 3 1  ON 53
ci_55                -6.907350e-04 3 1  ON 54
ci_56                 1.569219e-03 3 1  ON 55
ci_57                 1.596774e-03 3 1  ON 56
ci_58                -9.342514e-04 3 1  ON 57
ci_59                -1.003280e-03 3 1  ON 58
ci_60                 1.355203e-03 3 1  ON 59
ci_61                 1.823730e-03 3 1  ON 60
ci_62                -4.244376e-04 3 1  ON 61
ci_63                -7.762132e-05 3 1  ON 62
ci_64                -9.428280e-04 3 1  ON 63
ci_65                 1.275158e-04 3 1  ON 64
ci_66                -6.821638e-04 3 1  ON 65
ci_67                -6.553652e-04 3 1  ON 66
ci_68                -1.359717e-03 3 1  ON 67
ci_69                -1.597667e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.5110e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s016 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s016 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=16  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2825e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 16
    time step          = 0.05
    reference energy   = -22.7791
    reference variance = 0.305699
====================================================
  Execution time = 2.5567e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s016
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5364e+04
  VMC Eavg = -2.2819e+01
  VMC Evar = 4.9206e-01
  Total weights = 1.963562727e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.6549e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.471544939839
                                         uncertainty =       0.003003101365

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.471544939839
                                         uncertainty =       0.003003101365

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000485542152
  error estimate for blocks of size 2^( 2) =       0.000506612114
  error estimate for blocks of size 2^( 3) =       0.000526437917
  error estimate for blocks of size 2^( 4) =       0.000542199504
  error estimate for blocks of size 2^( 5) =       0.000551736160
  error estimate for blocks of size 2^( 6) =       0.000556722951
  error estimate for blocks of size 2^( 7) =       0.000559071319

      target function =                  N/A
              le_mean =     -22.818942936600
             les_mean =     521.196214109908
             stat err =       0.000552432484
             autocorr =       1.294507400981
              std dev =       0.686660296391
             le_variance =       0.471502362640


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281894293660e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.1035e+05, overlap shift 6.1035e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.818942936517       residual = 2.57e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.818942936538       residual = 5.31e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.818942936539       residual = 1.46e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.818942936536       residual = 2.90e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 6.1035e+05 is 1.436538e-09

solving harmonic davidson linear method for identity shift 2.4414e+06, overlap shift 2.4414e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.818942936517       residual = 2.57e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.818942936522       residual = 5.31e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.818942936522       residual = 1.46e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.818942936515       residual = 2.90e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.4414e+06 is 3.591346e-10

solving harmonic davidson linear method for identity shift 9.7656e+06, overlap shift 9.7656e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.818942936517       residual = 2.57e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.818942936518       residual = 5.31e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.818942936518       residual = 1.46e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.818942936518       residual = 2.90e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.7656e+06 is 8.978370e-11

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.030171 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0232e+01
  </log>
  <optVariables href="FORM.s016.opt.xml">
ci_01                 1.273777e-01 3 1  ON 0
ci_02                -2.881281e-02 3 1  ON 1
ci_03                -2.857177e-02 3 1  ON 2
ci_04                 2.611877e-02 3 1  ON 3
ci_05                -2.400648e-02 3 1  ON 4
ci_06                -2.361344e-02 3 1  ON 5
ci_07                 2.583580e-02 3 1  ON 6
ci_08                -5.186036e-03 3 1  ON 7
ci_09                -1.174145e-02 3 1  ON 8
ci_10                -1.142199e-02 3 1  ON 9
ci_11                 1.571267e-02 3 1  ON 10
ci_12                 1.061919e-02 3 1  ON 11
ci_13                 1.147707e-02 3 1  ON 12
ci_14                 1.483495e-02 3 1  ON 13
ci_15                 8.674085e-03 3 1  ON 14
ci_16                 8.459936e-03 3 1  ON 15
ci_17                -9.904031e-03 3 1  ON 16
ci_18                -9.983266e-03 3 1  ON 17
ci_19                 9.785970e-03 3 1  ON 18
ci_20                 1.059667e-02 3 1  ON 19
ci_21                 7.587582e-03 3 1  ON 20
ci_22                 9.211265e-03 3 1  ON 21
ci_23                 6.518643e-03 3 1  ON 22
ci_24                 6.490319e-03 3 1  ON 23
ci_25                 5.196599e-03 3 1  ON 24
ci_26                 3.768492e-03 3 1  ON 25
ci_27                 3.058921e-03 3 1  ON 26
ci_28                 4.595188e-03 3 1  ON 27
ci_29                 4.623531e-03 3 1  ON 28
ci_30                -4.211617e-04 3 1  ON 29
ci_31                -4.984418e-04 3 1  ON 30
ci_32                -2.713149e-05 3 1  ON 31
ci_33                -4.681070e-04 3 1  ON 32
ci_34                 1.750821e-04 3 1  ON 33
ci_35                -2.430919e-04 3 1  ON 34
ci_36                -9.061150e-04 3 1  ON 35
ci_37                -8.683320e-04 3 1  ON 36
ci_38                -1.426001e-04 3 1  ON 37
ci_39                -2.813700e-04 3 1  ON 38
ci_40                -1.220762e-03 3 1  ON 39
ci_41                 5.902620e-04 3 1  ON 40
ci_42                 2.367974e-04 3 1  ON 41
ci_43                -2.484832e-03 3 1  ON 42
ci_44                -1.670178e-03 3 1  ON 43
ci_45                -4.833566e-04 3 1  ON 44
ci_46                -4.900625e-04 3 1  ON 45
ci_47                -1.580796e-03 3 1  ON 46
ci_48                -2.024467e-03 3 1  ON 47
ci_49                -1.690367e-03 3 1  ON 48
ci_50                -5.843979e-04 3 1  ON 49
ci_51                 5.743301e-04 3 1  ON 50
ci_52                 2.567700e-05 3 1  ON 51
ci_53                -9.227147e-04 3 1  ON 52
ci_54                -4.943576e-04 3 1  ON 53
ci_55                -6.907350e-04 3 1  ON 54
ci_56                 1.569219e-03 3 1  ON 55
ci_57                 1.596774e-03 3 1  ON 56
ci_58                -9.342514e-04 3 1  ON 57
ci_59                -1.003280e-03 3 1  ON 58
ci_60                 1.355203e-03 3 1  ON 59
ci_61                 1.823730e-03 3 1  ON 60
ci_62                -4.244376e-04 3 1  ON 61
ci_63                -7.762144e-05 3 1  ON 62
ci_64                -9.428280e-04 3 1  ON 63
ci_65                 1.275157e-04 3 1  ON 64
ci_66                -6.821638e-04 3 1  ON 65
ci_67                -6.553652e-04 3 1  ON 66
ci_68                -1.359717e-03 3 1  ON 67
ci_69                -1.597667e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 16
    time step          = 0.05
    reference energy   = -22.9139
    reference variance = 0.449567
====================================================
  Execution time = 2.4987e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s016
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2819e+01
  VMC Evar = 4.8921e-01
  Total weights = 1.9635e+06
  Execution time = 3.5794e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.473561430787
                                         uncertainty =       0.002982992214

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.473561430787
                                         uncertainty =       0.002982992214

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000486551414
  error estimate for blocks of size 2^( 2) =       0.000507768907
  error estimate for blocks of size 2^( 3) =       0.000528036518
  error estimate for blocks of size 2^( 4) =       0.000543451469
  error estimate for blocks of size 2^( 5) =       0.000553157218
  error estimate for blocks of size 2^( 6) =       0.000559377341
  error estimate for blocks of size 2^( 7) =       0.000561072264

      target function =                  N/A
              le_mean =     -22.819030419334
             les_mean =     521.197358922178
             stat err =       0.000554264573
             autocorr =       1.297707347741
              std dev =       0.688087608196
             le_variance =       0.473464556553

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.473561430411
                                         uncertainty =       0.002982992173

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.473561430411
                                         uncertainty =       0.002982992173

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000486551414
  error estimate for blocks of size 2^( 2) =       0.000507768907
  error estimate for blocks of size 2^( 3) =       0.000528036518
  error estimate for blocks of size 2^( 4) =       0.000543451469
  error estimate for blocks of size 2^( 5) =       0.000553157218
  error estimate for blocks of size 2^( 6) =       0.000559377341
  error estimate for blocks of size 2^( 7) =       0.000561072264

      target function =                  N/A
              le_mean =     -22.819030419330
             les_mean =     521.197358922009
             stat err =       0.000554264573
             autocorr =       1.297707348469
              std dev =       0.688087607922
             le_variance =       0.473464556176

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.473561430599
                                         uncertainty =       0.002982992193

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.473561430599
                                         uncertainty =       0.002982992193

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000486551414
  error estimate for blocks of size 2^( 2) =       0.000507768907
  error estimate for blocks of size 2^( 3) =       0.000528036518
  error estimate for blocks of size 2^( 4) =       0.000543451469
  error estimate for blocks of size 2^( 5) =       0.000553157218
  error estimate for blocks of size 2^( 6) =       0.000559377341
  error estimate for blocks of size 2^( 7) =       0.000561072264

      target function =                  N/A
              le_mean =     -22.819030419332
             les_mean =     521.197358922093
             stat err =       0.000554264573
             autocorr =       1.297707348111
              std dev =       0.688087608059
             le_variance =       0.473464556364

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.473561430763
                                         uncertainty =       0.002982992211

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.473561430763
                                         uncertainty =       0.002982992211

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000486551414
  error estimate for blocks of size 2^( 2) =       0.000507768907
  error estimate for blocks of size 2^( 3) =       0.000528036518
  error estimate for blocks of size 2^( 4) =       0.000543451469
  error estimate for blocks of size 2^( 5) =       0.000553157218
  error estimate for blocks of size 2^( 6) =       0.000559377341
  error estimate for blocks of size 2^( 7) =       0.000561072264

      target function =                  N/A
              le_mean =     -22.819030419334
             les_mean =     521.197358922167
             stat err =       0.000554264573
             autocorr =       1.297707347788
              std dev =       0.688087608179
             le_variance =       0.473464556529


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.819030419334        initial  <--
     6.1035e+05     6.1035e+06             1.4365e-09       -22.819030419330
     2.4414e+06     2.4414e+07             3.5913e-10       -22.819030419332
     9.7656e+06     9.7656e+07             8.9784e-11       -22.819030419334

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 42.9513
  </log>
  <optVariables href="FORM.s016.opt.xml">
ci_01                 1.273777e-01 3 1  ON 0
ci_02                -2.881281e-02 3 1  ON 1
ci_03                -2.857177e-02 3 1  ON 2
ci_04                 2.611877e-02 3 1  ON 3
ci_05                -2.400648e-02 3 1  ON 4
ci_06                -2.361344e-02 3 1  ON 5
ci_07                 2.583580e-02 3 1  ON 6
ci_08                -5.186036e-03 3 1  ON 7
ci_09                -1.174145e-02 3 1  ON 8
ci_10                -1.142199e-02 3 1  ON 9
ci_11                 1.571267e-02 3 1  ON 10
ci_12                 1.061919e-02 3 1  ON 11
ci_13                 1.147707e-02 3 1  ON 12
ci_14                 1.483495e-02 3 1  ON 13
ci_15                 8.674085e-03 3 1  ON 14
ci_16                 8.459936e-03 3 1  ON 15
ci_17                -9.904031e-03 3 1  ON 16
ci_18                -9.983266e-03 3 1  ON 17
ci_19                 9.785970e-03 3 1  ON 18
ci_20                 1.059667e-02 3 1  ON 19
ci_21                 7.587582e-03 3 1  ON 20
ci_22                 9.211265e-03 3 1  ON 21
ci_23                 6.518643e-03 3 1  ON 22
ci_24                 6.490319e-03 3 1  ON 23
ci_25                 5.196599e-03 3 1  ON 24
ci_26                 3.768492e-03 3 1  ON 25
ci_27                 3.058921e-03 3 1  ON 26
ci_28                 4.595188e-03 3 1  ON 27
ci_29                 4.623531e-03 3 1  ON 28
ci_30                -4.211617e-04 3 1  ON 29
ci_31                -4.984419e-04 3 1  ON 30
ci_32                -2.713136e-05 3 1  ON 31
ci_33                -4.681070e-04 3 1  ON 32
ci_34                 1.750821e-04 3 1  ON 33
ci_35                -2.430920e-04 3 1  ON 34
ci_36                -9.061151e-04 3 1  ON 35
ci_37                -8.683320e-04 3 1  ON 36
ci_38                -1.426000e-04 3 1  ON 37
ci_39                -2.813700e-04 3 1  ON 38
ci_40                -1.220762e-03 3 1  ON 39
ci_41                 5.902620e-04 3 1  ON 40
ci_42                 2.367974e-04 3 1  ON 41
ci_43                -2.484832e-03 3 1  ON 42
ci_44                -1.670178e-03 3 1  ON 43
ci_45                -4.833567e-04 3 1  ON 44
ci_46                -4.900624e-04 3 1  ON 45
ci_47                -1.580796e-03 3 1  ON 46
ci_48                -2.024467e-03 3 1  ON 47
ci_49                -1.690367e-03 3 1  ON 48
ci_50                -5.843980e-04 3 1  ON 49
ci_51                 5.743301e-04 3 1  ON 50
ci_52                 2.567697e-05 3 1  ON 51
ci_53                -9.227147e-04 3 1  ON 52
ci_54                -4.943575e-04 3 1  ON 53
ci_55                -6.907350e-04 3 1  ON 54
ci_56                 1.569219e-03 3 1  ON 55
ci_57                 1.596774e-03 3 1  ON 56
ci_58                -9.342514e-04 3 1  ON 57
ci_59                -1.003280e-03 3 1  ON 58
ci_60                 1.355203e-03 3 1  ON 59
ci_61                 1.823730e-03 3 1  ON 60
ci_62                -4.244376e-04 3 1  ON 61
ci_63                -7.762132e-05 3 1  ON 62
ci_64                -9.428280e-04 3 1  ON 63
ci_65                 1.275158e-04 3 1  ON 64
ci_66                -6.821638e-04 3 1  ON 65
ci_67                -6.553652e-04 3 1  ON 66
ci_68                -1.359717e-03 3 1  ON 67
ci_69                -1.597667e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.3189e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s017 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s017 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=17  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2827e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 17
    time step          = 0.05
    reference energy   = -22.846
    reference variance = 0.439186
====================================================
  Execution time = 2.5611e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s017
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5342e+04
  VMC Eavg = -2.2819e+01
  VMC Evar = 4.8511e-01
  Total weights = 1.963829396e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.8052e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.472534849792
                                         uncertainty =       0.002178619102

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.472534849792
                                         uncertainty =       0.002178619102

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000486069484
  error estimate for blocks of size 2^( 2) =       0.000507248052
  error estimate for blocks of size 2^( 3) =       0.000526695307
  error estimate for blocks of size 2^( 4) =       0.000541977032
  error estimate for blocks of size 2^( 5) =       0.000551866682
  error estimate for blocks of size 2^( 6) =       0.000557208797
  error estimate for blocks of size 2^( 7) =       0.000558667365

      target function =                  N/A
              le_mean =     -22.818981456444
             les_mean =     521.191029174851
             stat err =       0.000552429969
             autocorr =       1.291688368996
              std dev =       0.687406056249
             le_variance =       0.472527086168


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281898145644e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.1035e+06, overlap shift 6.1035e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.818981456407       residual = 2.60e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.818981456410       residual = 6.07e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.818981456410       residual = 1.41e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.818981456589       residual = 2.65e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 6.1035e+06 is 1.604880e-10

solving harmonic davidson linear method for identity shift 2.4414e+07, overlap shift 2.4414e+08 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.818981456407       residual = 2.60e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.818981456407       residual = 6.07e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.818981456407       residual = 1.41e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.818981456407       residual = 2.65e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.4414e+07 is 4.012205e-11

solving harmonic davidson linear method for identity shift 9.7656e+07, overlap shift 9.7656e+08 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.818981456407       residual = 2.60e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.818981456407       residual = 6.07e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.818981456407       residual = 1.41e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.818981456407       residual = 2.65e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.7656e+07 is 1.003048e-11

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.031518 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0430e+01
  </log>
  <optVariables href="FORM.s017.opt.xml">
ci_01                 1.273777e-01 3 1  ON 0
ci_02                -2.881281e-02 3 1  ON 1
ci_03                -2.857177e-02 3 1  ON 2
ci_04                 2.611877e-02 3 1  ON 3
ci_05                -2.400648e-02 3 1  ON 4
ci_06                -2.361344e-02 3 1  ON 5
ci_07                 2.583580e-02 3 1  ON 6
ci_08                -5.186036e-03 3 1  ON 7
ci_09                -1.174145e-02 3 1  ON 8
ci_10                -1.142199e-02 3 1  ON 9
ci_11                 1.571267e-02 3 1  ON 10
ci_12                 1.061919e-02 3 1  ON 11
ci_13                 1.147707e-02 3 1  ON 12
ci_14                 1.483495e-02 3 1  ON 13
ci_15                 8.674085e-03 3 1  ON 14
ci_16                 8.459936e-03 3 1  ON 15
ci_17                -9.904031e-03 3 1  ON 16
ci_18                -9.983266e-03 3 1  ON 17
ci_19                 9.785970e-03 3 1  ON 18
ci_20                 1.059667e-02 3 1  ON 19
ci_21                 7.587582e-03 3 1  ON 20
ci_22                 9.211265e-03 3 1  ON 21
ci_23                 6.518643e-03 3 1  ON 22
ci_24                 6.490319e-03 3 1  ON 23
ci_25                 5.196599e-03 3 1  ON 24
ci_26                 3.768492e-03 3 1  ON 25
ci_27                 3.058921e-03 3 1  ON 26
ci_28                 4.595188e-03 3 1  ON 27
ci_29                 4.623531e-03 3 1  ON 28
ci_30                -4.211617e-04 3 1  ON 29
ci_31                -4.984419e-04 3 1  ON 30
ci_32                -2.713137e-05 3 1  ON 31
ci_33                -4.681070e-04 3 1  ON 32
ci_34                 1.750821e-04 3 1  ON 33
ci_35                -2.430920e-04 3 1  ON 34
ci_36                -9.061151e-04 3 1  ON 35
ci_37                -8.683320e-04 3 1  ON 36
ci_38                -1.426000e-04 3 1  ON 37
ci_39                -2.813699e-04 3 1  ON 38
ci_40                -1.220762e-03 3 1  ON 39
ci_41                 5.902620e-04 3 1  ON 40
ci_42                 2.367974e-04 3 1  ON 41
ci_43                -2.484832e-03 3 1  ON 42
ci_44                -1.670178e-03 3 1  ON 43
ci_45                -4.833567e-04 3 1  ON 44
ci_46                -4.900624e-04 3 1  ON 45
ci_47                -1.580796e-03 3 1  ON 46
ci_48                -2.024467e-03 3 1  ON 47
ci_49                -1.690367e-03 3 1  ON 48
ci_50                -5.843980e-04 3 1  ON 49
ci_51                 5.743301e-04 3 1  ON 50
ci_52                 2.567697e-05 3 1  ON 51
ci_53                -9.227147e-04 3 1  ON 52
ci_54                -4.943575e-04 3 1  ON 53
ci_55                -6.907350e-04 3 1  ON 54
ci_56                 1.569219e-03 3 1  ON 55
ci_57                 1.596774e-03 3 1  ON 56
ci_58                -9.342514e-04 3 1  ON 57
ci_59                -1.003280e-03 3 1  ON 58
ci_60                 1.355203e-03 3 1  ON 59
ci_61                 1.823730e-03 3 1  ON 60
ci_62                -4.244376e-04 3 1  ON 61
ci_63                -7.762133e-05 3 1  ON 62
ci_64                -9.428280e-04 3 1  ON 63
ci_65                 1.275158e-04 3 1  ON 64
ci_66                -6.821638e-04 3 1  ON 65
ci_67                -6.553652e-04 3 1  ON 66
ci_68                -1.359717e-03 3 1  ON 67
ci_69                -1.597667e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 17
    time step          = 0.05
    reference energy   = -22.722
    reference variance = 0.225154
====================================================
  Execution time = 2.5047e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s017
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2820e+01
  VMC Evar = 4.8480e-01
  Total weights = 1.9636e+06
  Execution time = 3.5621e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.470133953385
                                         uncertainty =       0.002537866427

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.470133953385
                                         uncertainty =       0.002537866427

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000484870224
  error estimate for blocks of size 2^( 2) =       0.000505868289
  error estimate for blocks of size 2^( 3) =       0.000525786415
  error estimate for blocks of size 2^( 4) =       0.000540730083
  error estimate for blocks of size 2^( 5) =       0.000550476034
  error estimate for blocks of size 2^( 6) =       0.000555676505
  error estimate for blocks of size 2^( 7) =       0.000558203536

      target function =                  N/A
              le_mean =     -22.819685362743
             les_mean =     521.222835611634
             stat err =       0.000551271540
             autocorr =       1.292647512372
              std dev =       0.685710046152
             le_variance =       0.470198267394

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.470133953354
                                         uncertainty =       0.002537866426

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.470133953354
                                         uncertainty =       0.002537866426

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000484870224
  error estimate for blocks of size 2^( 2) =       0.000505868289
  error estimate for blocks of size 2^( 3) =       0.000525786415
  error estimate for blocks of size 2^( 4) =       0.000540730083
  error estimate for blocks of size 2^( 5) =       0.000550476034
  error estimate for blocks of size 2^( 6) =       0.000555676505
  error estimate for blocks of size 2^( 7) =       0.000558203536

      target function =                  N/A
              le_mean =     -22.819685362742
             les_mean =     521.222835611672
             stat err =       0.000551271540
             autocorr =       1.292647512440
              std dev =       0.685710046130
             le_variance =       0.470198267363

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.470133953369
                                         uncertainty =       0.002537866426

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.470133953369
                                         uncertainty =       0.002537866426

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000484870224
  error estimate for blocks of size 2^( 2) =       0.000505868289
  error estimate for blocks of size 2^( 3) =       0.000525786415
  error estimate for blocks of size 2^( 4) =       0.000540730083
  error estimate for blocks of size 2^( 5) =       0.000550476034
  error estimate for blocks of size 2^( 6) =       0.000555676505
  error estimate for blocks of size 2^( 7) =       0.000558203536

      target function =                  N/A
              le_mean =     -22.819685362742
             les_mean =     521.222835611653
             stat err =       0.000551271540
             autocorr =       1.292647512404
              std dev =       0.685710046141
             le_variance =       0.470198267379

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.470133953383
                                         uncertainty =       0.002537866427

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.470133953383
                                         uncertainty =       0.002537866427

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000484870224
  error estimate for blocks of size 2^( 2) =       0.000505868289
  error estimate for blocks of size 2^( 3) =       0.000525786415
  error estimate for blocks of size 2^( 4) =       0.000540730083
  error estimate for blocks of size 2^( 5) =       0.000550476034
  error estimate for blocks of size 2^( 6) =       0.000555676505
  error estimate for blocks of size 2^( 7) =       0.000558203536

      target function =                  N/A
              le_mean =     -22.819685362742
             les_mean =     521.222835611637
             stat err =       0.000551271540
             autocorr =       1.292647512377
              std dev =       0.685710046151
             le_variance =       0.470198267392


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.819685362743        initial  <--
     6.1035e+06     6.1035e+07             1.6049e-10       -22.819685362742
     2.4414e+07     2.4414e+08             4.0122e-11       -22.819685362742
     9.7656e+07     9.7656e+08             1.0030e-11       -22.819685362742

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 42.9022
  </log>
  <optVariables href="FORM.s017.opt.xml">
ci_01                 1.273777e-01 3 1  ON 0
ci_02                -2.881281e-02 3 1  ON 1
ci_03                -2.857177e-02 3 1  ON 2
ci_04                 2.611877e-02 3 1  ON 3
ci_05                -2.400648e-02 3 1  ON 4
ci_06                -2.361344e-02 3 1  ON 5
ci_07                 2.583580e-02 3 1  ON 6
ci_08                -5.186036e-03 3 1  ON 7
ci_09                -1.174145e-02 3 1  ON 8
ci_10                -1.142199e-02 3 1  ON 9
ci_11                 1.571267e-02 3 1  ON 10
ci_12                 1.061919e-02 3 1  ON 11
ci_13                 1.147707e-02 3 1  ON 12
ci_14                 1.483495e-02 3 1  ON 13
ci_15                 8.674085e-03 3 1  ON 14
ci_16                 8.459936e-03 3 1  ON 15
ci_17                -9.904031e-03 3 1  ON 16
ci_18                -9.983266e-03 3 1  ON 17
ci_19                 9.785970e-03 3 1  ON 18
ci_20                 1.059667e-02 3 1  ON 19
ci_21                 7.587582e-03 3 1  ON 20
ci_22                 9.211265e-03 3 1  ON 21
ci_23                 6.518643e-03 3 1  ON 22
ci_24                 6.490319e-03 3 1  ON 23
ci_25                 5.196599e-03 3 1  ON 24
ci_26                 3.768492e-03 3 1  ON 25
ci_27                 3.058921e-03 3 1  ON 26
ci_28                 4.595188e-03 3 1  ON 27
ci_29                 4.623531e-03 3 1  ON 28
ci_30                -4.211617e-04 3 1  ON 29
ci_31                -4.984419e-04 3 1  ON 30
ci_32                -2.713136e-05 3 1  ON 31
ci_33                -4.681070e-04 3 1  ON 32
ci_34                 1.750821e-04 3 1  ON 33
ci_35                -2.430920e-04 3 1  ON 34
ci_36                -9.061151e-04 3 1  ON 35
ci_37                -8.683320e-04 3 1  ON 36
ci_38                -1.426000e-04 3 1  ON 37
ci_39                -2.813700e-04 3 1  ON 38
ci_40                -1.220762e-03 3 1  ON 39
ci_41                 5.902620e-04 3 1  ON 40
ci_42                 2.367974e-04 3 1  ON 41
ci_43                -2.484832e-03 3 1  ON 42
ci_44                -1.670178e-03 3 1  ON 43
ci_45                -4.833567e-04 3 1  ON 44
ci_46                -4.900624e-04 3 1  ON 45
ci_47                -1.580796e-03 3 1  ON 46
ci_48                -2.024467e-03 3 1  ON 47
ci_49                -1.690367e-03 3 1  ON 48
ci_50                -5.843980e-04 3 1  ON 49
ci_51                 5.743301e-04 3 1  ON 50
ci_52                 2.567697e-05 3 1  ON 51
ci_53                -9.227147e-04 3 1  ON 52
ci_54                -4.943575e-04 3 1  ON 53
ci_55                -6.907350e-04 3 1  ON 54
ci_56                 1.569219e-03 3 1  ON 55
ci_57                 1.596774e-03 3 1  ON 56
ci_58                -9.342514e-04 3 1  ON 57
ci_59                -1.003280e-03 3 1  ON 58
ci_60                 1.355203e-03 3 1  ON 59
ci_61                 1.823730e-03 3 1  ON 60
ci_62                -4.244376e-04 3 1  ON 61
ci_63                -7.762132e-05 3 1  ON 62
ci_64                -9.428280e-04 3 1  ON 63
ci_65                 1.275158e-04 3 1  ON 64
ci_66                -6.821638e-04 3 1  ON 65
ci_67                -6.553652e-04 3 1  ON 66
ci_68                -1.359717e-03 3 1  ON 67
ci_69                -1.597667e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.3339e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s018 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s018 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=18  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2824e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 18
    time step          = 0.05
    reference energy   = -22.8545
    reference variance = 0.423224
====================================================
  Execution time = 2.5598e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s018
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5339e+04
  VMC Eavg = -2.2820e+01
  VMC Evar = 4.8927e-01
  Total weights = 1.963728695e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.6074e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.474864867150
                                         uncertainty =       0.003134705680

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.474864867150
                                         uncertainty =       0.003134705680

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000487293095
  error estimate for blocks of size 2^( 2) =       0.000508245424
  error estimate for blocks of size 2^( 3) =       0.000528479661
  error estimate for blocks of size 2^( 4) =       0.000543996645
  error estimate for blocks of size 2^( 5) =       0.000553688447
  error estimate for blocks of size 2^( 6) =       0.000556952188
  error estimate for blocks of size 2^( 7) =       0.000561733736

      target function =                  N/A
              le_mean =     -22.820064973502
             les_mean =     521.244635004658
             stat err =       0.000554092754
             autocorr =       1.292958027567
              std dev =       0.689136503758
             le_variance =       0.474909120811


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.282006497350e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.1035e+07, overlap shift 6.1035e+08 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.820064973397       residual = 3.39e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.820064973397       residual = 6.78e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.820064973397       residual = 2.01e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.820064973397       residual = 3.15e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 6.1035e+07 is 1.656932e-11

solving harmonic davidson linear method for identity shift 2.4414e+08, overlap shift 2.4414e+09 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.820064973397       residual = 3.39e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.820064973397       residual = 6.78e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.820064973397       residual = 2.01e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.820064973397       residual = 3.15e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.4414e+08 is 4.142330e-12

solving harmonic davidson linear method for identity shift 9.7656e+08, overlap shift 9.7656e+09 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.820064973397       residual = 3.39e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.820064973397       residual = 6.78e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.820064973397       residual = 2.01e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.820064973397       residual = 3.15e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.7656e+08 is 1.035585e-12

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.032886 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0216e+01
  </log>
  <optVariables href="FORM.s018.opt.xml">
ci_01                 1.273777e-01 3 1  ON 0
ci_02                -2.881281e-02 3 1  ON 1
ci_03                -2.857177e-02 3 1  ON 2
ci_04                 2.611877e-02 3 1  ON 3
ci_05                -2.400648e-02 3 1  ON 4
ci_06                -2.361344e-02 3 1  ON 5
ci_07                 2.583580e-02 3 1  ON 6
ci_08                -5.186036e-03 3 1  ON 7
ci_09                -1.174145e-02 3 1  ON 8
ci_10                -1.142199e-02 3 1  ON 9
ci_11                 1.571267e-02 3 1  ON 10
ci_12                 1.061919e-02 3 1  ON 11
ci_13                 1.147707e-02 3 1  ON 12
ci_14                 1.483495e-02 3 1  ON 13
ci_15                 8.674085e-03 3 1  ON 14
ci_16                 8.459936e-03 3 1  ON 15
ci_17                -9.904031e-03 3 1  ON 16
ci_18                -9.983266e-03 3 1  ON 17
ci_19                 9.785970e-03 3 1  ON 18
ci_20                 1.059667e-02 3 1  ON 19
ci_21                 7.587582e-03 3 1  ON 20
ci_22                 9.211265e-03 3 1  ON 21
ci_23                 6.518643e-03 3 1  ON 22
ci_24                 6.490319e-03 3 1  ON 23
ci_25                 5.196599e-03 3 1  ON 24
ci_26                 3.768492e-03 3 1  ON 25
ci_27                 3.058921e-03 3 1  ON 26
ci_28                 4.595188e-03 3 1  ON 27
ci_29                 4.623531e-03 3 1  ON 28
ci_30                -4.211617e-04 3 1  ON 29
ci_31                -4.984419e-04 3 1  ON 30
ci_32                -2.713136e-05 3 1  ON 31
ci_33                -4.681070e-04 3 1  ON 32
ci_34                 1.750821e-04 3 1  ON 33
ci_35                -2.430920e-04 3 1  ON 34
ci_36                -9.061151e-04 3 1  ON 35
ci_37                -8.683320e-04 3 1  ON 36
ci_38                -1.426000e-04 3 1  ON 37
ci_39                -2.813700e-04 3 1  ON 38
ci_40                -1.220762e-03 3 1  ON 39
ci_41                 5.902620e-04 3 1  ON 40
ci_42                 2.367974e-04 3 1  ON 41
ci_43                -2.484832e-03 3 1  ON 42
ci_44                -1.670178e-03 3 1  ON 43
ci_45                -4.833567e-04 3 1  ON 44
ci_46                -4.900624e-04 3 1  ON 45
ci_47                -1.580796e-03 3 1  ON 46
ci_48                -2.024467e-03 3 1  ON 47
ci_49                -1.690367e-03 3 1  ON 48
ci_50                -5.843980e-04 3 1  ON 49
ci_51                 5.743301e-04 3 1  ON 50
ci_52                 2.567697e-05 3 1  ON 51
ci_53                -9.227147e-04 3 1  ON 52
ci_54                -4.943575e-04 3 1  ON 53
ci_55                -6.907350e-04 3 1  ON 54
ci_56                 1.569219e-03 3 1  ON 55
ci_57                 1.596774e-03 3 1  ON 56
ci_58                -9.342514e-04 3 1  ON 57
ci_59                -1.003280e-03 3 1  ON 58
ci_60                 1.355203e-03 3 1  ON 59
ci_61                 1.823730e-03 3 1  ON 60
ci_62                -4.244376e-04 3 1  ON 61
ci_63                -7.762132e-05 3 1  ON 62
ci_64                -9.428280e-04 3 1  ON 63
ci_65                 1.275158e-04 3 1  ON 64
ci_66                -6.821638e-04 3 1  ON 65
ci_67                -6.553652e-04 3 1  ON 66
ci_68                -1.359717e-03 3 1  ON 67
ci_69                -1.597667e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 18
    time step          = 0.05
    reference energy   = -22.779
    reference variance = 0.298015
====================================================
  Execution time = 2.5043e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s018
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2819e+01
  VMC Evar = 4.8894e-01
  Total weights = 1.9635e+06
  Execution time = 3.5710e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.473689696667
                                         uncertainty =       0.002467127653

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.473689696667
                                         uncertainty =       0.002467127653

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000486644103
  error estimate for blocks of size 2^( 2) =       0.000508305884
  error estimate for blocks of size 2^( 3) =       0.000527977937
  error estimate for blocks of size 2^( 4) =       0.000543792844
  error estimate for blocks of size 2^( 5) =       0.000554275907
  error estimate for blocks of size 2^( 6) =       0.000561169140
  error estimate for blocks of size 2^( 7) =       0.000566321419

      target function =                  N/A
              le_mean =     -22.819063467988
             les_mean =     521.198601392634
             stat err =       0.000556389828
             autocorr =       1.307180113108
              std dev =       0.688218690797
             le_variance =       0.473644966362

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.473689696663
                                         uncertainty =       0.002467127652

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.473689696663
                                         uncertainty =       0.002467127652

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000486644103
  error estimate for blocks of size 2^( 2) =       0.000508305884
  error estimate for blocks of size 2^( 3) =       0.000527977937
  error estimate for blocks of size 2^( 4) =       0.000543792844
  error estimate for blocks of size 2^( 5) =       0.000554275907
  error estimate for blocks of size 2^( 6) =       0.000561169140
  error estimate for blocks of size 2^( 7) =       0.000566321419

      target function =                  N/A
              le_mean =     -22.819063467988
             les_mean =     521.198601392662
             stat err =       0.000556389828
             autocorr =       1.307180113125
              std dev =       0.688218690794
             le_variance =       0.473644966358

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.473689696665
                                         uncertainty =       0.002467127653

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.473689696665
                                         uncertainty =       0.002467127653

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000486644103
  error estimate for blocks of size 2^( 2) =       0.000508305884
  error estimate for blocks of size 2^( 3) =       0.000527977937
  error estimate for blocks of size 2^( 4) =       0.000543792844
  error estimate for blocks of size 2^( 5) =       0.000554275907
  error estimate for blocks of size 2^( 6) =       0.000561169140
  error estimate for blocks of size 2^( 7) =       0.000566321419

      target function =                  N/A
              le_mean =     -22.819063467988
             les_mean =     521.198601392648
             stat err =       0.000556389828
             autocorr =       1.307180113107
              std dev =       0.688218690796
             le_variance =       0.473644966361

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.473689696667
                                         uncertainty =       0.002467127653

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.473689696667
                                         uncertainty =       0.002467127653

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000486644103
  error estimate for blocks of size 2^( 2) =       0.000508305884
  error estimate for blocks of size 2^( 3) =       0.000527977937
  error estimate for blocks of size 2^( 4) =       0.000543792844
  error estimate for blocks of size 2^( 5) =       0.000554275907
  error estimate for blocks of size 2^( 6) =       0.000561169140
  error estimate for blocks of size 2^( 7) =       0.000566321419

      target function =                  N/A
              le_mean =     -22.819063467988
             les_mean =     521.198601392636
             stat err =       0.000556389828
             autocorr =       1.307180113105
              std dev =       0.688218690797
             le_variance =       0.473644966362


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.819063467988        initial
     6.1035e+07     6.1035e+08             1.6569e-11       -22.819063467988  <--
     2.4414e+08     2.4414e+09             4.1423e-12       -22.819063467988
     9.7656e+08     9.7656e+09             1.0356e-12       -22.819063467988

*****************************************************************************
Applying the update for shift_i =   6.1035e+07     and shift_s =   6.1035e+08
*****************************************************************************

  Execution time = 4.2950e+01
  </log>
  <optVariables href="FORM.s018.opt.xml">
ci_01                 1.273777e-01 3 1  ON 0
ci_02                -2.881281e-02 3 1  ON 1
ci_03                -2.857177e-02 3 1  ON 2
ci_04                 2.611877e-02 3 1  ON 3
ci_05                -2.400648e-02 3 1  ON 4
ci_06                -2.361344e-02 3 1  ON 5
ci_07                 2.583580e-02 3 1  ON 6
ci_08                -5.186036e-03 3 1  ON 7
ci_09                -1.174145e-02 3 1  ON 8
ci_10                -1.142199e-02 3 1  ON 9
ci_11                 1.571267e-02 3 1  ON 10
ci_12                 1.061919e-02 3 1  ON 11
ci_13                 1.147707e-02 3 1  ON 12
ci_14                 1.483495e-02 3 1  ON 13
ci_15                 8.674085e-03 3 1  ON 14
ci_16                 8.459936e-03 3 1  ON 15
ci_17                -9.904031e-03 3 1  ON 16
ci_18                -9.983266e-03 3 1  ON 17
ci_19                 9.785970e-03 3 1  ON 18
ci_20                 1.059667e-02 3 1  ON 19
ci_21                 7.587582e-03 3 1  ON 20
ci_22                 9.211265e-03 3 1  ON 21
ci_23                 6.518643e-03 3 1  ON 22
ci_24                 6.490319e-03 3 1  ON 23
ci_25                 5.196599e-03 3 1  ON 24
ci_26                 3.768492e-03 3 1  ON 25
ci_27                 3.058921e-03 3 1  ON 26
ci_28                 4.595188e-03 3 1  ON 27
ci_29                 4.623531e-03 3 1  ON 28
ci_30                -4.211617e-04 3 1  ON 29
ci_31                -4.984419e-04 3 1  ON 30
ci_32                -2.713136e-05 3 1  ON 31
ci_33                -4.681070e-04 3 1  ON 32
ci_34                 1.750821e-04 3 1  ON 33
ci_35                -2.430920e-04 3 1  ON 34
ci_36                -9.061151e-04 3 1  ON 35
ci_37                -8.683320e-04 3 1  ON 36
ci_38                -1.426000e-04 3 1  ON 37
ci_39                -2.813700e-04 3 1  ON 38
ci_40                -1.220762e-03 3 1  ON 39
ci_41                 5.902620e-04 3 1  ON 40
ci_42                 2.367974e-04 3 1  ON 41
ci_43                -2.484832e-03 3 1  ON 42
ci_44                -1.670178e-03 3 1  ON 43
ci_45                -4.833567e-04 3 1  ON 44
ci_46                -4.900624e-04 3 1  ON 45
ci_47                -1.580796e-03 3 1  ON 46
ci_48                -2.024467e-03 3 1  ON 47
ci_49                -1.690367e-03 3 1  ON 48
ci_50                -5.843980e-04 3 1  ON 49
ci_51                 5.743301e-04 3 1  ON 50
ci_52                 2.567697e-05 3 1  ON 51
ci_53                -9.227147e-04 3 1  ON 52
ci_54                -4.943575e-04 3 1  ON 53
ci_55                -6.907350e-04 3 1  ON 54
ci_56                 1.569219e-03 3 1  ON 55
ci_57                 1.596774e-03 3 1  ON 56
ci_58                -9.342514e-04 3 1  ON 57
ci_59                -1.003280e-03 3 1  ON 58
ci_60                 1.355203e-03 3 1  ON 59
ci_61                 1.823730e-03 3 1  ON 60
ci_62                -4.244376e-04 3 1  ON 61
ci_63                -7.762133e-05 3 1  ON 62
ci_64                -9.428280e-04 3 1  ON 63
ci_65                 1.275158e-04 3 1  ON 64
ci_66                -6.821638e-04 3 1  ON 65
ci_67                -6.553652e-04 3 1  ON 66
ci_68                -1.359717e-03 3 1  ON 67
ci_69                -1.597667e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.3172e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s019 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s019 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=19  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2824e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 19
    time step          = 0.05
    reference energy   = -22.7898
    reference variance = 0.400237
====================================================
  Execution time = 2.7491e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s019
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5354e+04
  VMC Eavg = -2.2819e+01
  VMC Evar = 4.9376e-01
  Total weights = 1.963584098e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.6436e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.479214444223
                                         uncertainty =       0.002776237061

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.479214444223
                                         uncertainty =       0.002776237061

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000489444211
  error estimate for blocks of size 2^( 2) =       0.000510719827
  error estimate for blocks of size 2^( 3) =       0.000530044891
  error estimate for blocks of size 2^( 4) =       0.000545641040
  error estimate for blocks of size 2^( 5) =       0.000556329045
  error estimate for blocks of size 2^( 6) =       0.000562410541
  error estimate for blocks of size 2^( 7) =       0.000563978756

      target function =                  N/A
              le_mean =     -22.819139690016
             les_mean =     521.206897606846
             stat err =       0.000557089845
             autocorr =       1.295519911274
              std dev =       0.692178641205
             le_variance =       0.479111271340


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281913969002e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5259e+07, overlap shift 1.5259e+08 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.819139689964       residual = 3.89e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.819139689966       residual = 6.57e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.819139689966       residual = 1.92e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.819139689966       residual = 3.28e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.5259e+07 is 7.273165e-11

solving harmonic davidson linear method for identity shift 6.1035e+07, overlap shift 6.1035e+08 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.819139689964       residual = 3.89e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.819139689965       residual = 6.57e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.819139689965       residual = 1.92e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.819139689965       residual = 3.28e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 6.1035e+07 is 1.818291e-11

solving harmonic davidson linear method for identity shift 2.4414e+08, overlap shift 2.4414e+09 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.819139689964       residual = 3.89e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.819139689964       residual = 6.57e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.819139689964       residual = 1.92e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.819139598455       residual = 3.28e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.4414e+08 is 4.545719e-12

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.034202 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.2144e+01
  </log>
  <optVariables href="FORM.s019.opt.xml">
ci_01                 1.273777e-01 3 1  ON 0
ci_02                -2.881281e-02 3 1  ON 1
ci_03                -2.857177e-02 3 1  ON 2
ci_04                 2.611877e-02 3 1  ON 3
ci_05                -2.400648e-02 3 1  ON 4
ci_06                -2.361344e-02 3 1  ON 5
ci_07                 2.583580e-02 3 1  ON 6
ci_08                -5.186036e-03 3 1  ON 7
ci_09                -1.174145e-02 3 1  ON 8
ci_10                -1.142199e-02 3 1  ON 9
ci_11                 1.571267e-02 3 1  ON 10
ci_12                 1.061919e-02 3 1  ON 11
ci_13                 1.147707e-02 3 1  ON 12
ci_14                 1.483495e-02 3 1  ON 13
ci_15                 8.674085e-03 3 1  ON 14
ci_16                 8.459936e-03 3 1  ON 15
ci_17                -9.904031e-03 3 1  ON 16
ci_18                -9.983266e-03 3 1  ON 17
ci_19                 9.785970e-03 3 1  ON 18
ci_20                 1.059667e-02 3 1  ON 19
ci_21                 7.587582e-03 3 1  ON 20
ci_22                 9.211265e-03 3 1  ON 21
ci_23                 6.518643e-03 3 1  ON 22
ci_24                 6.490319e-03 3 1  ON 23
ci_25                 5.196599e-03 3 1  ON 24
ci_26                 3.768492e-03 3 1  ON 25
ci_27                 3.058921e-03 3 1  ON 26
ci_28                 4.595188e-03 3 1  ON 27
ci_29                 4.623531e-03 3 1  ON 28
ci_30                -4.211617e-04 3 1  ON 29
ci_31                -4.984419e-04 3 1  ON 30
ci_32                -2.713137e-05 3 1  ON 31
ci_33                -4.681070e-04 3 1  ON 32
ci_34                 1.750821e-04 3 1  ON 33
ci_35                -2.430920e-04 3 1  ON 34
ci_36                -9.061151e-04 3 1  ON 35
ci_37                -8.683320e-04 3 1  ON 36
ci_38                -1.426000e-04 3 1  ON 37
ci_39                -2.813700e-04 3 1  ON 38
ci_40                -1.220762e-03 3 1  ON 39
ci_41                 5.902620e-04 3 1  ON 40
ci_42                 2.367974e-04 3 1  ON 41
ci_43                -2.484832e-03 3 1  ON 42
ci_44                -1.670178e-03 3 1  ON 43
ci_45                -4.833567e-04 3 1  ON 44
ci_46                -4.900624e-04 3 1  ON 45
ci_47                -1.580796e-03 3 1  ON 46
ci_48                -2.024467e-03 3 1  ON 47
ci_49                -1.690367e-03 3 1  ON 48
ci_50                -5.843980e-04 3 1  ON 49
ci_51                 5.743301e-04 3 1  ON 50
ci_52                 2.567697e-05 3 1  ON 51
ci_53                -9.227147e-04 3 1  ON 52
ci_54                -4.943575e-04 3 1  ON 53
ci_55                -6.907350e-04 3 1  ON 54
ci_56                 1.569219e-03 3 1  ON 55
ci_57                 1.596774e-03 3 1  ON 56
ci_58                -9.342514e-04 3 1  ON 57
ci_59                -1.003280e-03 3 1  ON 58
ci_60                 1.355203e-03 3 1  ON 59
ci_61                 1.823730e-03 3 1  ON 60
ci_62                -4.244376e-04 3 1  ON 61
ci_63                -7.762133e-05 3 1  ON 62
ci_64                -9.428280e-04 3 1  ON 63
ci_65                 1.275158e-04 3 1  ON 64
ci_66                -6.821638e-04 3 1  ON 65
ci_67                -6.553652e-04 3 1  ON 66
ci_68                -1.359717e-03 3 1  ON 67
ci_69                -1.597667e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 19
    time step          = 0.05
    reference energy   = -22.8505
    reference variance = 0.50709
====================================================
  Execution time = 2.5045e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s019
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2819e+01
  VMC Evar = 4.8814e-01
  Total weights = 1.9637e+06
  Execution time = 3.5630e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.472769476315
                                         uncertainty =       0.005372256880

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.472769476315
                                         uncertainty =       0.005372256880

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000486149697
  error estimate for blocks of size 2^( 2) =       0.000507374325
  error estimate for blocks of size 2^( 3) =       0.000527608145
  error estimate for blocks of size 2^( 4) =       0.000542837237
  error estimate for blocks of size 2^( 5) =       0.000551466547
  error estimate for blocks of size 2^( 6) =       0.000557619547
  error estimate for blocks of size 2^( 7) =       0.000562238491

      target function =                  N/A
              le_mean =     -22.819224676811
             les_mean =     521.205150163996
             stat err =       0.000553540456
             autocorr =       1.296458724239
              std dev =       0.687519495013
             le_variance =       0.472683056023

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.472769476300
                                         uncertainty =       0.005372256881

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.472769476300
                                         uncertainty =       0.005372256881

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000486149697
  error estimate for blocks of size 2^( 2) =       0.000507374325
  error estimate for blocks of size 2^( 3) =       0.000527608145
  error estimate for blocks of size 2^( 4) =       0.000542837237
  error estimate for blocks of size 2^( 5) =       0.000551466547
  error estimate for blocks of size 2^( 6) =       0.000557619547
  error estimate for blocks of size 2^( 7) =       0.000562238491

      target function =                  N/A
              le_mean =     -22.819224676811
             les_mean =     521.205150163900
             stat err =       0.000553540456
             autocorr =       1.296458724274
              std dev =       0.687519495003
             le_variance =       0.472683056009

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.472769476308
                                         uncertainty =       0.005372256880

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.472769476308
                                         uncertainty =       0.005372256880

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000486149697
  error estimate for blocks of size 2^( 2) =       0.000507374325
  error estimate for blocks of size 2^( 3) =       0.000527608145
  error estimate for blocks of size 2^( 4) =       0.000542837237
  error estimate for blocks of size 2^( 5) =       0.000551466547
  error estimate for blocks of size 2^( 6) =       0.000557619547
  error estimate for blocks of size 2^( 7) =       0.000562238491

      target function =                  N/A
              le_mean =     -22.819224676811
             les_mean =     521.205150163948
             stat err =       0.000553540456
             autocorr =       1.296458724251
              std dev =       0.687519495008
             le_variance =       0.472683056016

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.472769476314
                                         uncertainty =       0.005372256880

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.472769476314
                                         uncertainty =       0.005372256880

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000486149697
  error estimate for blocks of size 2^( 2) =       0.000507374325
  error estimate for blocks of size 2^( 3) =       0.000527608145
  error estimate for blocks of size 2^( 4) =       0.000542837237
  error estimate for blocks of size 2^( 5) =       0.000551466547
  error estimate for blocks of size 2^( 6) =       0.000557619547
  error estimate for blocks of size 2^( 7) =       0.000562238491

      target function =                  N/A
              le_mean =     -22.819224676811
             les_mean =     521.205150163990
             stat err =       0.000553540456
             autocorr =       1.296458724238
              std dev =       0.687519495013
             le_variance =       0.472683056022


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.819224676811        initial
     1.5259e+07     1.5259e+08             7.2732e-11       -22.819224676811  <--
     6.1035e+07     6.1035e+08             1.8183e-11       -22.819224676811
     2.4414e+08     2.4414e+09             4.5457e-12       -22.819224676811

*****************************************************************************
Applying the update for shift_i =   1.5259e+07     and shift_s =   1.5259e+08
*****************************************************************************

  Execution time = 4.2951e+01
  </log>
  <optVariables href="FORM.s019.opt.xml">
ci_01                 1.273777e-01 3 1  ON 0
ci_02                -2.881281e-02 3 1  ON 1
ci_03                -2.857177e-02 3 1  ON 2
ci_04                 2.611877e-02 3 1  ON 3
ci_05                -2.400648e-02 3 1  ON 4
ci_06                -2.361344e-02 3 1  ON 5
ci_07                 2.583580e-02 3 1  ON 6
ci_08                -5.186036e-03 3 1  ON 7
ci_09                -1.174145e-02 3 1  ON 8
ci_10                -1.142199e-02 3 1  ON 9
ci_11                 1.571267e-02 3 1  ON 10
ci_12                 1.061919e-02 3 1  ON 11
ci_13                 1.147707e-02 3 1  ON 12
ci_14                 1.483495e-02 3 1  ON 13
ci_15                 8.674085e-03 3 1  ON 14
ci_16                 8.459936e-03 3 1  ON 15
ci_17                -9.904031e-03 3 1  ON 16
ci_18                -9.983266e-03 3 1  ON 17
ci_19                 9.785970e-03 3 1  ON 18
ci_20                 1.059667e-02 3 1  ON 19
ci_21                 7.587582e-03 3 1  ON 20
ci_22                 9.211265e-03 3 1  ON 21
ci_23                 6.518643e-03 3 1  ON 22
ci_24                 6.490319e-03 3 1  ON 23
ci_25                 5.196599e-03 3 1  ON 24
ci_26                 3.768492e-03 3 1  ON 25
ci_27                 3.058921e-03 3 1  ON 26
ci_28                 4.595188e-03 3 1  ON 27
ci_29                 4.623531e-03 3 1  ON 28
ci_30                -4.211617e-04 3 1  ON 29
ci_31                -4.984419e-04 3 1  ON 30
ci_32                -2.713138e-05 3 1  ON 31
ci_33                -4.681070e-04 3 1  ON 32
ci_34                 1.750821e-04 3 1  ON 33
ci_35                -2.430920e-04 3 1  ON 34
ci_36                -9.061151e-04 3 1  ON 35
ci_37                -8.683320e-04 3 1  ON 36
ci_38                -1.426000e-04 3 1  ON 37
ci_39                -2.813699e-04 3 1  ON 38
ci_40                -1.220762e-03 3 1  ON 39
ci_41                 5.902620e-04 3 1  ON 40
ci_42                 2.367974e-04 3 1  ON 41
ci_43                -2.484832e-03 3 1  ON 42
ci_44                -1.670178e-03 3 1  ON 43
ci_45                -4.833567e-04 3 1  ON 44
ci_46                -4.900624e-04 3 1  ON 45
ci_47                -1.580796e-03 3 1  ON 46
ci_48                -2.024467e-03 3 1  ON 47
ci_49                -1.690367e-03 3 1  ON 48
ci_50                -5.843980e-04 3 1  ON 49
ci_51                 5.743301e-04 3 1  ON 50
ci_52                 2.567696e-05 3 1  ON 51
ci_53                -9.227147e-04 3 1  ON 52
ci_54                -4.943575e-04 3 1  ON 53
ci_55                -6.907350e-04 3 1  ON 54
ci_56                 1.569219e-03 3 1  ON 55
ci_57                 1.596774e-03 3 1  ON 56
ci_58                -9.342514e-04 3 1  ON 57
ci_59                -1.003280e-03 3 1  ON 58
ci_60                 1.355203e-03 3 1  ON 59
ci_61                 1.823730e-03 3 1  ON 60
ci_62                -4.244376e-04 3 1  ON 61
ci_63                -7.762132e-05 3 1  ON 62
ci_64                -9.428280e-04 3 1  ON 63
ci_65                 1.275158e-04 3 1  ON 64
ci_66                -6.821638e-04 3 1  ON 65
ci_67                -6.553652e-04 3 1  ON 66
ci_68                -1.359717e-03 3 1  ON 67
ci_69                -1.597667e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.5100e+01 secs
  Total Execution time = 1.4790e+03 secs

=========================================================
  A new xml input file : FORM.s019.cont.xml
