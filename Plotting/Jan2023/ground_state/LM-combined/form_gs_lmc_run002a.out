--------------------------------------------------------------------------
WARNING: No preset parameters were found for the device that Open MPI
detected:

  Local host:            n0252.savio3
  Device name:           mlx5_0
  Device vendor ID:      0x02c9
  Device vendor part ID: 4123

Default device parameters will be used, which may result in lower
performance.  You can edit any of the files specified by the
btl_openib_device_param_files MCA parameter to set values for your
device.

NOTE: You can turn off this warning by setting the MCA parameter
      btl_openib_warn_no_device_params_found to 0.
--------------------------------------------------------------------------
Rank =    0  Free Memory = 75492 MB
Rank =    1  Free Memory = 75492 MB
Rank =    2  Free Memory = 75492 MB
Rank =    3  Free Memory = 75492 MB
Rank =    4  Free Memory = 75492 MB
Rank =    5  Free Memory = 75492 MB
Rank =    6  Free Memory = 75492 MB
Rank =    7  Free Memory = 75492 MB
Rank =    8  Free Memory = 75492 MB
Rank =    9  Free Memory = 75492 MB
Rank =   10  Free Memory = 75491 MB
Rank =   11  Free Memory = 75491 MB
Rank =   12  Free Memory = 75491 MB
Rank =   13  Free Memory = 75491 MB
Rank =   14  Free Memory = 75490 MB
Rank =   15  Free Memory = 75476 MB
Rank =   16  Free Memory = 75476 MB
Rank =   17  Free Memory = 75476 MB
Rank =   18  Free Memory = 75476 MB
Rank =   19  Free Memory = 75476 MB
Rank =   20  Free Memory = 75476 MB
Rank =   21  Free Memory = 75476 MB
Rank =   22  Free Memory = 75476 MB
Rank =   23  Free Memory = 75476 MB
Rank =   24  Free Memory = 75476 MB
Rank =   25  Free Memory = 75476 MB
Rank =   26  Free Memory = 75476 MB
Rank =   27  Free Memory = 75476 MB
Rank =   28  Free Memory = 75476 MB
Rank =   29  Free Memory = 75476 MB
Rank =   30  Free Memory = 75476 MB
Rank =   31  Free Memory = 75476 MB
Rank =   32  Free Memory = 59778 MB
Rank =   33  Free Memory = 59778 MB
Rank =   34  Free Memory = 59778 MB
Rank =   35  Free Memory = 59778 MB
Rank =   36  Free Memory = 59778 MB
Rank =   37  Free Memory = 59778 MB
Rank =   38  Free Memory = 59778 MB
Rank =   39  Free Memory = 59778 MB
Rank =   40  Free Memory = 59778 MB
Rank =   41  Free Memory = 59778 MB
Rank =   42  Free Memory = 59778 MB
Rank =   43  Free Memory = 59778 MB
Rank =   44  Free Memory = 59778 MB
Rank =   45  Free Memory = 59778 MB
Rank =   46  Free Memory = 59778 MB
Rank =   47  Free Memory = 59778 MB
Rank =   48  Free Memory = 59778 MB
Rank =   49  Free Memory = 59778 MB
Rank =   50  Free Memory = 59778 MB
Rank =   51  Free Memory = 59778 MB
Rank =   52  Free Memory = 59778 MB
Rank =   53  Free Memory = 59778 MB
Rank =   54  Free Memory = 59778 MB
Rank =   55  Free Memory = 59778 MB
Rank =   56  Free Memory = 59778 MB
Rank =   57  Free Memory = 59778 MB
Rank =   58  Free Memory = 59778 MB
Rank =   59  Free Memory = 59778 MB
Rank =   60  Free Memory = 59778 MB
Rank =   61  Free Memory = 59778 MB
Rank =   62  Free Memory = 59778 MB
Rank =   63  Free Memory = 59778 MB
Rank =   64  Free Memory = 70104 MB
Rank =   65  Free Memory = 70104 MB
Rank =   66  Free Memory = 70104 MB
Rank =   67  Free Memory = 70104 MB
Rank =   68  Free Memory = 70104 MB
Rank =   69  Free Memory = 70104 MB
Rank =   70  Free Memory = 70104 MB
Rank =   71  Free Memory = 70104 MB
Rank =   72  Free Memory = 70104 MB
Rank =   73  Free Memory = 70104 MB
Rank =   74  Free Memory = 70104 MB
Rank =   75  Free Memory = 70104 MB
Rank =   76  Free Memory = 70104 MB
Rank =   77  Free Memory = 70104 MB
Rank =   78  Free Memory = 70104 MB
Rank =   79  Free Memory = 70104 MB
Rank =   80  Free Memory = 70104 MB
Rank =   81  Free Memory = 70104 MB
Rank =   82  Free Memory = 70104 MB
Rank =   83  Free Memory = 70104 MB
Rank =   84  Free Memory = 70104 MB
Rank =   85  Free Memory = 70104 MB
Rank =   86  Free Memory = 70104 MB
Rank =   87  Free Memory = 70104 MB
Rank =   88  Free Memory = 70104 MB
Rank =   89  Free Memory = 70104 MB
Rank =   90  Free Memory = 70104 MB
Rank =   91  Free Memory = 70104 MB
Rank =   92  Free Memory = 70104 MB
Rank =   93  Free Memory = 70104 MB
Rank =   94  Free Memory = 70104 MB
Rank =   95  Free Memory = 70104 MB
Rank =   96  Free Memory = 76996 MB
Rank =   97  Free Memory = 76996 MB
Rank =   98  Free Memory = 76996 MB
Rank =   99  Free Memory = 76996 MB
Rank =  100  Free Memory = 76996 MB
Rank =  101  Free Memory = 76996 MB
Rank =  102  Free Memory = 76996 MB
Rank =  103  Free Memory = 76996 MB
Rank =  104  Free Memory = 76996 MB
Rank =  105  Free Memory = 76996 MB
Rank =  106  Free Memory = 76996 MB
Rank =  107  Free Memory = 76996 MB
Rank =  108  Free Memory = 76996 MB
Rank =  109  Free Memory = 76996 MB
Rank =  110  Free Memory = 76996 MB
Rank =  111  Free Memory = 76996 MB
Rank =  112  Free Memory = 76996 MB
Rank =  113  Free Memory = 76996 MB
Rank =  114  Free Memory = 76996 MB
Rank =  115  Free Memory = 76996 MB
Rank =  116  Free Memory = 76996 MB
Rank =  117  Free Memory = 76996 MB
Rank =  118  Free Memory = 76996 MB
Rank =  119  Free Memory = 76996 MB
Rank =  120  Free Memory = 76996 MB
Rank =  121  Free Memory = 76996 MB
Rank =  122  Free Memory = 76996 MB
Rank =  123  Free Memory = 76996 MB
Rank =  124  Free Memory = 76996 MB
Rank =  125  Free Memory = 76996 MB
Rank =  126  Free Memory = 76996 MB
Rank =  127  Free Memory = 76996 MB
  Input file(s): opt_form_gs_lmc_run002a.xml 

=====================================================
                    QMCPACK 3.7.9

       (c) Copyright 2003-  QMCPACK developers

                    Please cite:
 J. Kim et al. J. Phys. Cond. Mat. 30 195901 (2018)
      https://doi.org/10.1088/1361-648X/aab9c3

  Git branch: gvp
  Last git commit: 02b8462cd86e2c45b012131e3a811aee79855b67-dirty
  Last git commit date: Mon Oct 24 16:30:05 2022 -0700
  Last git commit subject: Merge commit 59872d0bcea460ceb08aa7832e89b700ee19b55f into gvp
=====================================================
  Global options 

  Total number of MPI ranks = 128
  Number of MPI groups      = 1
  MPI group ID              = 0
  Number of ranks in group  = 128
  MPI ranks per node        = 32
  OMP 1st level threads     = 1
  OMP nested threading disabled or only 1 thread on the 2nd level

  Precision used in this calculation, see definitions in the manual:
  Base precision      = double
  Full precision      = double

  Structure-of-arrays (SoA) optimization enabled

  Input XML = opt_form_gs_lmc_run002a.xml

  Project = FORM
  date    = 2023-02-07 12:11:18 PST
  host    = n0019.savio3

 Random Number
 -------------
  Offset for the random number seeds based on time: 102

  Range of prime numbers to use as seeds over processors and threads = 569-1459


 Particle Set 
 ------------
  Name: e
  All the species have the same mass 1
  Particle set size: 12

 Particle Set 
 ------------
  Name: ion0
  All the species have the same mass 1
  Particle set size: 4

 Wavefunction setup: 
 ------------------- 
  Name: psi0

   Jastrow
   -------
    Name: J2   Type: Two-Body   Function: Bspline

    Radial function for species: u - u
     Number of parameters: 10
     Cusp: -0.25
     Cutoff radius: 10

     Name                        Value Type Recompute Use Index
     ---- ---------------------------- ---- --------- --- -----
     uu_0                 2.536032e-01    1         1 OFF
     uu_1                 8.197417e-02    1         1 OFF
     uu_2                -2.279515e-02    1         1 OFF
     uu_3                -7.836857e-02    1         1 OFF
     uu_4                -1.013427e-01    1         1 OFF
     uu_5                -1.044477e-01    1         1 OFF
     uu_6                -9.224414e-02    1         1 OFF
     uu_7                -6.062712e-02    1         1 OFF
     uu_8                -1.023404e-02    1         1 OFF
     uu_9                 4.851606e-02    1         1 OFF

    Radial function for species: u - d
     Number of parameters: 10
     Cusp: -5.000000e-01
     Cutoff radius: 1.000000e+01

     Name                        Value Type Recompute Use Index
     ---- ---------------------------- ---- --------- --- -----
     ud_0                 3.792217e-01    1         1 OFF
     ud_1                 1.041447e-01    1         1 OFF
     ud_2                -2.759756e-02    1         1 OFF
     ud_3                -9.201142e-02    1         1 OFF
     ud_4                -1.207933e-01    1         1 OFF
     ud_5                -1.273508e-01    1         1 OFF
     ud_6                -1.163455e-01    1         1 OFF
     ud_7                -8.399626e-02    1         1 OFF
     ud_8                -3.198393e-02    1         1 OFF
     ud_9                 3.386961e-02    1         1 OFF


   Jastrow
   -------
    Name: J1   Type: One-Body   Function: Bspline

    Radial function for element: C
     Number of parameters: 10
     Cusp: 0.000000e+00
     Cutoff radius: 1.000000e+01

     Name                        Value Type Recompute Use Index
     ---- ---------------------------- ---- --------- --- -----
     eC_0                -3.996214e-01    1         1 OFF
     eC_1                -2.494767e-01    1         1 OFF
     eC_2                 3.700011e-03    1         1 OFF
     eC_3                 1.573024e-01    1         1 OFF
     eC_4                 1.937498e-01    1         1 OFF
     eC_5                 1.904877e-01    1         1 OFF
     eC_6                 7.711846e-02    1         1 OFF
     eC_7                 2.034542e-02    1         1 OFF
     eC_8                 3.700966e-03    1         1 OFF
     eC_9                 1.944711e-03    1         1 OFF

    Radial function for element: O
     Number of parameters: 10
     Cusp: 0.000000e+00
     Cutoff radius: 1.000000e+01

     Name                        Value Type Recompute Use Index
     ---- ---------------------------- ---- --------- --- -----
     eO_0                -7.797092e-01    1         1 OFF
     eO_1                -4.355440e-01    1         1 OFF
     eO_2                -2.455303e-02    1         1 OFF
     eO_3                 2.277127e-01    1         1 OFF
     eO_4                 3.261577e-01    1         1 OFF
     eO_5                 3.430617e-01    1         1 OFF
     eO_6                 2.378897e-01    1         1 OFF
     eO_7                 8.612036e-02    1         1 OFF
     eO_8                 2.385595e-03    1         1 OFF
     eO_9                 8.162181e-03    1         1 OFF

    Radial function for element: H1
     Number of parameters: 10
     Cusp: 0.000000e+00
     Cutoff radius: 1.000000e+01

      Name                        Value Type Recompute Use Index
     ----- ---------------------------- ---- --------- --- -----
     eH1_0                -9.737895e-02    1         1 OFF
     eH1_1                -1.599916e-02    1         1 OFF
     eH1_2                 3.445961e-03    1         1 OFF
     eH1_3                -1.247711e-02    1         1 OFF
     eH1_4                 6.338141e-03    1         1 OFF
     eH1_5                 1.464916e-02    1         1 OFF
     eH1_6                 3.536630e-02    1         1 OFF
     eH1_7                 3.910225e-02    1         1 OFF
     eH1_8                 2.028485e-02    1         1 OFF
     eH1_9                 5.094825e-03    1         1 OFF

    Radial function for element: H2
     Number of parameters: 10
     Cusp: 0.000000e+00
     Cutoff radius: 1.000000e+01

      Name                        Value Type Recompute Use Index
     ----- ---------------------------- ---- --------- --- -----
     eH2_0                -9.796051e-02    1         1 OFF
     eH2_1                -1.537428e-02    1         1 OFF
     eH2_2                 4.200477e-03    1         1 OFF
     eH2_3                -1.217164e-02    1         1 OFF
     eH2_4                 6.944154e-03    1         1 OFF
     eH2_5                 1.575404e-02    1         1 OFF
     eH2_6                 3.502549e-02    1         1 OFF
     eH2_7                 3.688055e-02    1         1 OFF
     eH2_8                 2.096512e-02    1         1 OFF
     eH2_9                 4.252178e-03    1         1 OFF

  Created SPOSet builder named 'LCAOBSet' of type molecularorbital
  LCAO: SoaAtomicBasisSet<MultiQuintic,0>
  AO BasisSet for C
   Angular momentum expanded in cartesian functions x^lx y^ly z^lz according to Gamess
Using log grid with default values: ri = 1.000000e-06 rf = 1.000000e+02 npts = 1001
   R(n,l,m,s) 0 0 0 0
   R(n,l,m,s) 1 0 0 0
   R(n,l,m,s) 2 1 0 0
   R(n,l,m,s) 3 1 0 0
   R(n,l,m,s) 4 2 0 0
Expanding Ylm (angular function) according to Gamess using cartesian gaussians
Adding 1 cartesian gaussian orbitals for l= 0
Adding 1 cartesian gaussian orbitals for l= 0
Adding 3 cartesian gaussian orbitals for l= 1
Adding 3 cartesian gaussian orbitals for l= 1
Adding 6 cartesian gaussian orbitals for l= 2
  Setting cutoff radius 1.270574e+01

   Maximum Angular Momentum  = 2
   Number of Radial functors = 5
   Basis size                = 14

  AO BasisSet for O
   Angular momentum expanded in cartesian functions x^lx y^ly z^lz according to Gamess
Using log grid with default values: ri = 1.000000e-06 rf = 1.000000e+02 npts = 1001
   R(n,l,m,s) 0 0 0 0
   R(n,l,m,s) 1 0 0 0
   R(n,l,m,s) 2 1 0 0
   R(n,l,m,s) 3 1 0 0
   R(n,l,m,s) 4 2 0 0
Expanding Ylm (angular function) according to Gamess using cartesian gaussians
Adding 1 cartesian gaussian orbitals for l= 0
Adding 1 cartesian gaussian orbitals for l= 0
Adding 3 cartesian gaussian orbitals for l= 1
Adding 3 cartesian gaussian orbitals for l= 1
Adding 6 cartesian gaussian orbitals for l= 2
  Setting cutoff radius 1.018591e+01

   Maximum Angular Momentum  = 2
   Number of Radial functors = 5
   Basis size                = 14

  AO BasisSet for H1
   Angular momentum expanded in cartesian functions x^lx y^ly z^lz according to Gamess
Using log grid with default values: ri = 1.000000e-06 rf = 1.000000e+02 npts = 1001
   R(n,l,m,s) 0 0 0 0
   R(n,l,m,s) 1 0 0 0
   R(n,l,m,s) 2 1 0 0
Expanding Ylm (angular function) according to Gamess using cartesian gaussians
Adding 1 cartesian gaussian orbitals for l= 0
Adding 1 cartesian gaussian orbitals for l= 0
Adding 3 cartesian gaussian orbitals for l= 1
  Setting cutoff radius 1.270574e+01

   Maximum Angular Momentum  = 1
   Number of Radial functors = 3
   Basis size                = 5

  AO BasisSet for H2
   Angular momentum expanded in cartesian functions x^lx y^ly z^lz according to Gamess
Using log grid with default values: ri = 1.000000e-06 rf = 1.000000e+02 npts = 1001
   R(n,l,m,s) 0 0 0 0
   R(n,l,m,s) 1 0 0 0
   R(n,l,m,s) 2 1 0 0
Expanding Ylm (angular function) according to Gamess using cartesian gaussians
Adding 1 cartesian gaussian orbitals for l= 0
Adding 1 cartesian gaussian orbitals for l= 0
Adding 3 cartesian gaussian orbitals for l= 1
  Setting cutoff radius 1.270574e+01

   Maximum Angular Momentum  = 1
   Number of Radial functors = 3
   Basis size                = 5

Creating SPOSet in SlaterDetBuilder::put(xmlNodePtr cur).
spo_name = spo-up
  Building SPOSet 'spo-up' with '' basis set.
Creating SPOSet in SlaterDetBuilder::put(xmlNodePtr cur).
spo_name = spo-dn
  Building SPOSet 'spo-dn' with '' basis set.
Using Bryan's algorithm for MultiSlaterDeterminant expansion. 
Creating base determinant (up) for MSD expansion. 
Creating base determinant (down) for MSD expansion. 
Found determinant list. 
Reading CI expansion.
Found 70 terms in the MSD expansion.
Norm of ci vector (sum of ci^2): 9.999797e-01
Norm of qchem ci vector (sum of qchem_ci^2): 0.000000e+00
Found 20 unique up determinants.
Found 20 unique down determinants.
Number of terms in pairs array: 12
Number of terms in pairs array: 12
CI coefficients are optimizable. 
  FermionWF = MultiSlaterDeterminantFast
  QMCHamiltonian::addOperator Kinetic to H, physical Hamiltonian 
  QMCHamiltonian::addOperator ElecElec to H, physical Hamiltonian 
QMCHamiltonian::addOperatorType added type coulomb named ElecElec

  ECPotential builder for pseudopotential 

  Adding pseudopotential for C
   Linear grid  ri=0.000000e+00 rf=1.000000e+01 npts = 10001
    ECPComponentBuilder::buildSemiLocalAndLocal 
    Assuming Hartree unit
   Number of angular momentum channels 2
   Maximum angular momentum channel 1
   Creating a Linear Grid Rmax=1.405000e+00
  Using global grid with delta = 1.000000e-03
   Making L=1 a local potential with a radial cutoff of 9.999000e+00
    Non-local pseudopotential parameters
    Maximum angular mementum = 0
    Number of non-local channels = 1
       l(0)=0
    Cutoff radius = 1.405000e+00
    Spherical grids and weights: 
         1.0000000000e+00  0.0000000000e+00  0.0000000000e+00    8.3333333333e-02
        -1.0000000000e+00  1.2246467991e-16  0.0000000000e+00    8.3333333333e-02
         4.4721359550e-01  8.9442719100e-01  0.0000000000e+00    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -8.9442719100e-01  1.0953573965e-16    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
    Maximum cutoff radius 1.4050000000e+00

  Adding pseudopotential for O
   Linear grid  ri=0.0000000000e+00 rf=1.0000000000e+01 npts = 10001
    ECPComponentBuilder::buildSemiLocalAndLocal 
    Assuming Hartree unit
   Number of angular momentum channels 2
   Maximum angular momentum channel 1
   Creating a Linear Grid Rmax=1.0750000000e+00
  Using global grid with delta = 1.0000000000e-03
   Making L=1 a local potential with a radial cutoff of 9.9990000000e+00
    Non-local pseudopotential parameters
    Maximum angular mementum = 0
    Number of non-local channels = 1
       l(0)=0
    Cutoff radius = 1.0750000000e+00
    Spherical grids and weights: 
         1.0000000000e+00  0.0000000000e+00  0.0000000000e+00    8.3333333333e-02
        -1.0000000000e+00  1.2246467991e-16  0.0000000000e+00    8.3333333333e-02
         4.4721359550e-01  8.9442719100e-01  0.0000000000e+00    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -8.9442719100e-01  1.0953573965e-16    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
    Maximum cutoff radius 1.0750000000e+00

  Adding pseudopotential for H1
   Linear grid  ri=0.0000000000e+00 rf=1.0000000000e+01 npts = 10001
    ECPComponentBuilder::buildSemiLocalAndLocal 
    Assuming Hartree unit
   Number of angular momentum channels 2
   Maximum angular momentum channel 1
   Creating a Linear Grid Rmax=1.0000000000e-10
  Using global grid with delta = 1.0000000000e-03
   Making L=1 a local potential with a radial cutoff of 9.9990000000e+00
    Non-local pseudopotential parameters
    Maximum angular mementum = 0
    Number of non-local channels = 1
       l(0)=0
    Cutoff radius = 1.0000000000e-03
    Spherical grids and weights: 
         1.0000000000e+00  0.0000000000e+00  0.0000000000e+00    8.3333333333e-02
        -1.0000000000e+00  1.2246467991e-16  0.0000000000e+00    8.3333333333e-02
         4.4721359550e-01  8.9442719100e-01  0.0000000000e+00    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -8.9442719100e-01  1.0953573965e-16    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
    Maximum cutoff radius 1.0000000000e-03

  Adding pseudopotential for H2
   Linear grid  ri=0.0000000000e+00 rf=1.0000000000e+01 npts = 10001
    ECPComponentBuilder::buildSemiLocalAndLocal 
    Assuming Hartree unit
   Number of angular momentum channels 2
   Maximum angular momentum channel 1
   Creating a Linear Grid Rmax=1.0000000000e-10
  Using global grid with delta = 1.0000000000e-03
   Making L=1 a local potential with a radial cutoff of 9.9990000000e+00
    Non-local pseudopotential parameters
    Maximum angular mementum = 0
    Number of non-local channels = 1
       l(0)=0
    Cutoff radius = 1.0000000000e-03
    Spherical grids and weights: 
         1.0000000000e+00  0.0000000000e+00  0.0000000000e+00    8.3333333333e-02
        -1.0000000000e+00  1.2246467991e-16  0.0000000000e+00    8.3333333333e-02
         4.4721359550e-01  8.9442719100e-01  0.0000000000e+00    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -8.9442719100e-01  1.0953573965e-16    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
    Maximum cutoff radius 1.0000000000e-03
  QMCHamiltonian::addOperator LocalECP to H, physical Hamiltonian 

  Using NonLocalECP potential 
    Maximum grid on a sphere for NonLocalECPotential: 12
  QMCHamiltonian::addOperator NonLocalECP to H, physical Hamiltonian 
QMCHamiltonian::addOperatorType added type pseudo named NonLocalECP
  QMCHamiltonian::addOperator IonIon to H, physical Hamiltonian 
QMCHamiltonian::addOperatorType added type coulomb named IonIon

  QMCHamiltonian::add2WalkerProperty added
    5 to P::PropertyList 
    0 to P::Collectables 
    starting Index of the observables in P::PropertyList = 10
ParticleSetPool::randomize 
  Initialization Execution time = 2.1696e-01 secs
=========================================================
 Summary of QMC systems 
=========================================================
ParticleSetPool has: 

  ParticleSet 'e' contains 12 particles :  u(6) d(6)

    u  1.0776882035e+00  1.1858078688e-01 -1.1228966320e+00
    u  5.2623637829e-01  1.7541589896e-01 -1.3337143393e+00
    u -2.1907738776e-01  1.2604145828e+00  7.3980442540e-01
    u  5.1104917034e-03  1.4830329441e-01  1.8508537617e+00
    u  2.0319189978e-01  5.3211297520e-02  1.1096632188e+00
    u -7.1114543523e-01  2.3194667600e+00 -1.9120363364e+00
    d  4.5386831405e-01  7.4543549121e-01 -1.7781369559e+00
    d -5.3250436761e-01  5.6773482298e-01 -1.4296151151e+00
    d -8.5149149983e-02 -4.7335234687e-01  1.2151269463e+00
    d -1.3341711209e-02  5.3976693736e-01  8.3781480332e-01
    (... and 2 more particle positions ...)

  Distance table for similar particles (A-A):
    source/target: e
    Using structure-of-arrays (SoA) data layout
    Distance computations use open boundary conditions in 3D.

  Distance table for dissimilar particles (A-B):
    source: ion0  target: e
    Using structure-of-arrays (SoA) data layout
    Distance computations use open boundary conditions in 3D.


  ParticleSet 'ion0' contains 4 particles :  C(1) O(1) H1(1) H2(1)

    C  0.0000000000e+00  0.0000000000e+00 -1.1394765782e+00
    O  0.0000000000e+00  0.0000000000e+00  1.1440287480e+00
    H1  0.0000000000e+00  1.7662761033e+00 -2.2339863698e+00
    H2  0.0000000000e+00 -1.7662761033e+00 -2.2339863698e+00

  Distance table for similar particles (A-A):
    source/target: ion0
    Using structure-of-arrays (SoA) data layout
    Distance computations use open boundary conditions in 3D.


  Hamiltonian h0
  Kinetic         Kinetic energy
  ElecElec        CoulombAA source/target e

  LocalECP        LocalECPotential: ion0
  NonLocalECP     NonLocalECPotential: ion0
  IonIon          CoulombAA source/target ion0


Loop execution max-interations = 20
Inside LM engine constructor, num_params is: 0 and _total_num_params is: 0

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s000 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15
  Adding 1 walkers to 0 existing sets
  Total number of walkers: 1.2800000000e+02
  Total weight: 1.2800000000e+02

=========================================================
  Start VMC
  File Root FORM.s000 append = no 
=========================================================
Resetting walkers
  Using the current 1 walkers.
  Total number of walkers: 1.2800000000e+02
  Total weight: 1.2800000000e+02
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=0  my_counter=0
  time step      = 5.0000000000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000000000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625000000e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000000000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000000000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000000000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000000000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000000000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000000000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000000000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625000000e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000000000e-02</parameter>
<parameter name="time_step" condition="au">5.0000000000e-02</parameter>
<parameter name="timestep" condition="au">5.0000000000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
  Set drift_modifier UNR parameter a = 1.0000000000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000000000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: 0 and ratio_threshold_: 0.0000000000e+00
Allocating full size _hmat_temp and _smat_temp
Inside LM engine's get_param, num_params is: 69
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
[n0019.savio3:107195] 31 more processes have sent help message help-mpi-btl-openib.txt / no device params found
[n0019.savio3:107195] Set MCA parameter "orte_base_help_aggregate" to 0 to see all help / error messages
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 0
    time step          = 0.05
    reference energy   = -22.7965
    reference variance = 0.2698
====================================================
  Execution time = 2.6886e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s000
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5320e+04
  VMC Eavg = -2.2809e+01
  VMC Evar = 5.1700e-01
  Total weights = 1.962953884e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.6032e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.501431688075
                                         uncertainty =       0.002690666841

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.501431688075
                                         uncertainty =       0.002690666841

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000500685648
  error estimate for blocks of size 2^( 2) =       0.000521995429
  error estimate for blocks of size 2^( 3) =       0.000541264350
  error estimate for blocks of size 2^( 4) =       0.000556554493
  error estimate for blocks of size 2^( 5) =       0.000564860814
  error estimate for blocks of size 2^( 6) =       0.000571621839
  error estimate for blocks of size 2^( 7) =       0.000574373550

      target function =                  N/A
              le_mean =     -22.808713601175
             les_mean =     520.754417605795
             stat err =       0.000566852674
             autocorr =       1.281770034120
              std dev =       0.708076433528
             le_variance =       0.501372235718


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy-2.280871360117e+01 
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.5000e-01, overlap shift 2.5000e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.808713601169       residual = 1.81e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.812881169307       residual = 9.80e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.813153282290       residual = 2.52e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.813157437026       residual = 4.76e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.813157353621       residual = 1.07e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.813157383093       residual = 2.77e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          5 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.5000e-01 is 1.702961e-02

solving harmonic davidson linear method for identity shift 1.0000e+00, overlap shift 1.0000e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.808713601169       residual = 1.81e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.810328203973       residual = 6.00e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.810391766406       residual = 6.28e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.810392571465       residual = 1.08e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.810392497672       residual = 1.50e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          4 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.0000e+00 is 6.839289e-03

solving harmonic davidson linear method for identity shift 4.0000e+00, overlap shift 4.0000e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.808713601169       residual = 1.81e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.809181469490       residual = 5.02e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.809196511010       residual = 7.59e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.809196857342       residual = 1.77e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.809196847977       residual = 3.15e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          4 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 4.0000e+00 is 2.016324e-03

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.237308 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.1735e+01
  </log>
  <optVariables href="FORM.s000.opt.xml">
ci_01 1.597328e-01                 3 1 ON  0
ci_02 -5.408205e-02                3 1 ON  1
ci_03 -5.410965e-02                3 1 ON  2
ci_04 5.204321e-02                 3 1 ON  3
ci_05 -3.822392e-02                3 1 ON  4
ci_06 -3.801455e-02                3 1 ON  5
ci_07 3.006883e-02                 3 1 ON  6
ci_08 -1.602132e-02                3 1 ON  7
ci_09 -1.696447e-02                3 1 ON  8
ci_10 -1.668143e-02                3 1 ON  9
ci_11 1.613795e-02                 3 1 ON  10
ci_12 1.309165e-02                 3 1 ON  11
ci_13 1.251720e-02                 3 1 ON  12
ci_14 1.271722e-02                 3 1 ON  13
ci_15 1.196492e-02                 3 1 ON  14
ci_16 1.179571e-02                 3 1 ON  15
ci_17 -1.188408e-02                3 1 ON  16
ci_18 -1.209426e-02                3 1 ON  17
ci_19 1.108978e-02                 3 1 ON  18
ci_20 1.044127e-02                 3 1 ON  19
ci_21 9.934160e-03                 3 1 ON  20
ci_22 9.719380e-03                 3 1 ON  21
ci_23 6.710311e-03                 3 1 ON  22
ci_24 5.392056e-03                 3 1 ON  23
ci_25 5.199448e-03                 3 1 ON  24
ci_26 4.578461e-03                 3 1 ON  25
ci_27 4.637148e-03                 3 1 ON  26
ci_28 4.455852e-03                 3 1 ON  27
ci_29 4.470596e-03                 3 1 ON  28
ci_30 -3.530389e-03                3 1 ON  29
ci_31 -3.333731e-03                3 1 ON  30
ci_32 -2.624899e-03                3 1 ON  31
ci_33 -2.466960e-03                3 1 ON  32
ci_34 2.102699e-03                 3 1 ON  33
ci_35 2.053477e-03                 3 1 ON  34
ci_36 -2.174026e-03                3 1 ON  35
ci_37 -2.294712e-03                3 1 ON  36
ci_38 -1.784561e-03                3 1 ON  37
ci_39 -1.972528e-03                3 1 ON  38
ci_40 -1.856963e-03                3 1 ON  39
ci_41 -1.296525e-03                3 1 ON  40
ci_42 -1.175150e-03                3 1 ON  41
ci_43 -2.198895e-03                3 1 ON  42
ci_44 -2.148070e-03                3 1 ON  43
ci_45 -1.646620e-03                3 1 ON  44
ci_46 -1.658355e-03                3 1 ON  45
ci_47 -1.962886e-03                3 1 ON  46
ci_48 -1.986331e-03                3 1 ON  47
ci_49 -1.795409e-03                3 1 ON  48
ci_50 -1.345006e-03                3 1 ON  49
ci_51 1.295803e-03                 3 1 ON  50
ci_52 1.553217e-03                 3 1 ON  51
ci_53 -1.584067e-03                3 1 ON  52
ci_54 -1.441905e-03                3 1 ON  53
ci_55 -1.182701e-03                3 1 ON  54
ci_56 1.288382e-03                 3 1 ON  55
ci_57 1.309751e-03                 3 1 ON  56
ci_58 -1.140841e-03                3 1 ON  57
ci_59 -1.309014e-03                3 1 ON  58
ci_60 1.125143e-03                 3 1 ON  59
ci_61 1.116811e-03                 3 1 ON  60
ci_62 -8.582993e-04                3 1 ON  61
ci_63 -9.146191e-04                3 1 ON  62
ci_64 -1.089773e-03                3 1 ON  63
ci_65 -1.206120e-03                3 1 ON  64
ci_66 -9.990941e-04                3 1 ON  65
ci_67 -1.033517e-03                3 1 ON  66
ci_68 4.296080e-04                 3 1 ON  67
ci_69 6.467846e-04                 3 1 ON  68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 0
    time step          = 0.05
    reference energy   = -22.8097
    reference variance = 0.461653
====================================================
  Execution time = 2.5609e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s000
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2811e+01
  VMC Evar = 5.1205e-01
  Total weights = 1.9630e+06
  Execution time = 3.6071e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.507846009965
                                         uncertainty =       0.003057756690

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.507846009965
                                         uncertainty =       0.003057756690

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000504001909
  error estimate for blocks of size 2^( 2) =       0.000526016278
  error estimate for blocks of size 2^( 3) =       0.000546192062
  error estimate for blocks of size 2^( 4) =       0.000560335307
  error estimate for blocks of size 2^( 5) =       0.000569020675
  error estimate for blocks of size 2^( 6) =       0.000575339981
  error estimate for blocks of size 2^( 7) =       0.000580207776

      target function =                  N/A
              le_mean =     -22.810942740526
             les_mean =     521.057109467021
             stat err =       0.000571225935
             autocorr =       1.284551355213
              std dev =       0.712766334701
             le_variance =       0.508035847884

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.487324577955
                                         uncertainty =       0.003800356894

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.487324577955
                                         uncertainty =       0.003800356894

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000493708927
  error estimate for blocks of size 2^( 2) =       0.000514968918
  error estimate for blocks of size 2^( 3) =       0.000534626773
  error estimate for blocks of size 2^( 4) =       0.000548457586
  error estimate for blocks of size 2^( 5) =       0.000557049151
  error estimate for blocks of size 2^( 6) =       0.000563095294
  error estimate for blocks of size 2^( 7) =       0.000567640034

      target function =                  N/A
              le_mean =     -22.811413588858
             les_mean =     521.062092796638
             stat err =       0.000559060516
             autocorr =       1.282258781874
              std dev =       0.698209860664
             le_variance =       0.487497009529

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.489482540612
                                         uncertainty =       0.003238012818

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.489482540612
                                         uncertainty =       0.003238012818

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000494800711
  error estimate for blocks of size 2^( 2) =       0.000516177084
  error estimate for blocks of size 2^( 3) =       0.000535917368
  error estimate for blocks of size 2^( 4) =       0.000549791787
  error estimate for blocks of size 2^( 5) =       0.000558348919
  error estimate for blocks of size 2^( 6) =       0.000564515917
  error estimate for blocks of size 2^( 7) =       0.000569133194

      target function =                  N/A
              le_mean =     -22.811036900004
             les_mean =     522.570537374484
             stat err =       0.000560447454
             autocorr =       1.282948343234
              std dev =       0.699753876769
             le_variance =       0.489655488054

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       1.106346452745
                                         uncertainty =       0.440702841811

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       1.106346452745
                                         uncertainty =       0.440702841811

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000743468588
  error estimate for blocks of size 2^( 2) =       0.000758081782
  error estimate for blocks of size 2^( 3) =       0.000771966744
  error estimate for blocks of size 2^( 4) =       0.000781414096
  error estimate for blocks of size 2^( 5) =       0.000788120987
  error estimate for blocks of size 2^( 6) =       0.000793727950
  error estimate for blocks of size 2^( 7) =       0.000797540257

      target function =                  N/A
              le_mean =     -22.810063671227
             les_mean =     555.417724970234
             stat err =       0.000790200823
             autocorr =       1.129665086608
              std dev =       1.051423360418
             le_variance =       1.105491082833


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.810942740526        initial
     2.5000e-01     2.5000e+00             1.7030e-02       -22.811413588858  <--
     1.0000e+00     1.0000e+01             6.8393e-03       -22.811036900004
     4.0000e+00     4.0000e+01             2.0163e-03       -22.810063671227

*****************************************************************************
Applying the update for shift_i =   2.5000e-01     and shift_s =   2.5000e+00
*****************************************************************************

  Execution time = 4.3660e+01
  </log>
  <optVariables href="FORM.s000.opt.xml">
ci_01                 1.508280e-01 3 1  ON 0
ci_02                -4.533062e-02 3 1  ON 1
ci_03                -4.541162e-02 3 1  ON 2
ci_04                 4.185289e-02 3 1  ON 3
ci_05                -3.311998e-02 3 1  ON 4
ci_06                -3.254231e-02 3 1  ON 5
ci_07                 2.892866e-02 3 1  ON 6
ci_08                -1.136931e-02 3 1  ON 7
ci_09                -1.553361e-02 3 1  ON 8
ci_10                -1.470973e-02 3 1  ON 9
ci_11                 1.572517e-02 3 1  ON 10
ci_12                 1.217342e-02 3 1  ON 11
ci_13                 1.224713e-02 3 1  ON 12
ci_14                 1.293378e-02 3 1  ON 13
ci_15                 1.082353e-02 3 1  ON 14
ci_16                 1.037975e-02 3 1  ON 15
ci_17                -1.119136e-02 3 1  ON 16
ci_18                -1.176172e-02 3 1  ON 17
ci_19                 1.016116e-02 3 1  ON 18
ci_20                 1.017610e-02 3 1  ON 19
ci_21                 9.872746e-03 3 1  ON 20
ci_22                 9.194426e-03 3 1  ON 21
ci_23                 6.634116e-03 3 1  ON 22
ci_24                 5.503625e-03 3 1  ON 23
ci_25                 5.101764e-03 3 1  ON 24
ci_26                 4.071675e-03 3 1  ON 25
ci_27                 4.185558e-03 3 1  ON 26
ci_28                 4.612712e-03 3 1  ON 27
ci_29                 4.645358e-03 3 1  ON 28
ci_30                -3.164326e-03 3 1  ON 29
ci_31                -2.595709e-03 3 1  ON 30
ci_32                -1.638842e-03 3 1  ON 31
ci_33                -1.237350e-03 3 1  ON 32
ci_34                 1.065997e-03 3 1  ON 33
ci_35                 9.313363e-04 3 1  ON 34
ci_36                -1.433369e-03 3 1  ON 35
ci_37                -1.745448e-03 3 1  ON 36
ci_38                -1.205779e-03 3 1  ON 37
ci_39                -1.659625e-03 3 1  ON 38
ci_40                -1.576172e-03 3 1  ON 39
ci_41                -5.660461e-04 3 1  ON 40
ci_42                -2.364786e-04 3 1  ON 41
ci_43                -2.258692e-03 3 1  ON 42
ci_44                -2.095809e-03 3 1  ON 43
ci_45                -1.224098e-03 3 1  ON 44
ci_46                -1.250739e-03 3 1  ON 45
ci_47                -1.956455e-03 3 1  ON 46
ci_48                -2.069379e-03 3 1  ON 47
ci_49                -1.823223e-03 3 1  ON 48
ci_50                -8.542359e-04 3 1  ON 49
ci_51                 6.583027e-04 3 1  ON 50
ci_52                 1.285690e-03 3 1  ON 51
ci_53                -1.623755e-03 3 1  ON 52
ci_54                -1.304725e-03 3 1  ON 53
ci_55                -6.073819e-04 3 1  ON 54
ci_56                 1.270636e-03 3 1  ON 55
ci_57                 1.326512e-03 3 1  ON 56
ci_58                -9.755789e-04 3 1  ON 57
ci_59                -1.435427e-03 3 1  ON 58
ci_60                 1.053195e-03 3 1  ON 59
ci_61                 1.019402e-03 3 1  ON 60
ci_62                -4.411338e-04 3 1  ON 61
ci_63                -5.568658e-04 3 1  ON 62
ci_64                -1.050023e-03 3 1  ON 63
ci_65                -1.347019e-03 3 1  ON 64
ci_66                -8.846128e-04 3 1  ON 65
ci_67                -9.600379e-04 3 1  ON 66
ci_68                -4.650324e-04 3 1  ON 67
ci_69                 9.672195e-05 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.5401e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s001 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s001 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=1  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2803e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 1
    time step          = 0.05
    reference energy   = -22.9004
    reference variance = 0.293864
====================================================
  Execution time = 2.8074e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s001
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5334e+04
  VMC Eavg = -2.2815e+01
  VMC Evar = 4.9601e-01
  Total weights = 1.963359335e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.5709e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.481846665189
                                         uncertainty =       0.002520643288

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.481846665189
                                         uncertainty =       0.002520643288

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000490786846
  error estimate for blocks of size 2^( 2) =       0.000511466111
  error estimate for blocks of size 2^( 3) =       0.000531334453
  error estimate for blocks of size 2^( 4) =       0.000546331021
  error estimate for blocks of size 2^( 5) =       0.000554479632
  error estimate for blocks of size 2^( 6) =       0.000559205900
  error estimate for blocks of size 2^( 7) =       0.000561002362

      target function =                  N/A
              le_mean =     -22.815035505185
             les_mean =     521.021853128347
             stat err =       0.000555254729
             autocorr =       1.279966792746
              std dev =       0.694077414551
             le_variance =       0.481743457389


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281503550518e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.2500e-02, overlap shift 6.2500e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.815035505115       residual = 5.72e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.817333966612       residual = 6.19e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.817581285676       residual = 4.50e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.817612970936       residual = 3.62e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.817612740454       residual = 1.26e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.817613257086       residual = 5.96e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          5 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 6.2500e-02 is 2.011760e-02

solving harmonic davidson linear method for identity shift 2.5000e-01, overlap shift 2.5000e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.815035505115       residual = 5.72e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.816389843917       residual = 3.42e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.816468577809       residual = 7.19e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.816473501513       residual = 1.43e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.816473329493       residual = 2.43e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          4 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.5000e-01 is 9.122521e-03

solving harmonic davidson linear method for identity shift 1.0000e+00, overlap shift 1.0000e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.815035505115       residual = 5.72e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.815547808614       residual = 1.97e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.815565633131       residual = 1.87e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.815566482261       residual = 3.54e-08           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.815566556100       residual = 4.16e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          4 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.0000e+00 is 3.317702e-03

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.239118 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.2655e+01
  </log>
  <optVariables href="FORM.s001.opt.xml">
ci_01                 1.417055e-01 3 1  ON 0
ci_02                -3.717688e-02 3 1  ON 1
ci_03                -3.692001e-02 3 1  ON 2
ci_04                 3.361330e-02 3 1  ON 3
ci_05                -2.807674e-02 3 1  ON 4
ci_06                -2.798405e-02 3 1  ON 5
ci_07                 2.779176e-02 3 1  ON 6
ci_08                -7.950064e-03 3 1  ON 7
ci_09                -1.455674e-02 3 1  ON 8
ci_10                -1.376700e-02 3 1  ON 9
ci_11                 1.600956e-02 3 1  ON 10
ci_12                 1.133696e-02 3 1  ON 11
ci_13                 1.215426e-02 3 1  ON 12
ci_14                 1.378151e-02 3 1  ON 13
ci_15                 9.473837e-03 3 1  ON 14
ci_16                 9.053126e-03 3 1  ON 15
ci_17                -1.008206e-02 3 1  ON 16
ci_18                -1.073402e-02 3 1  ON 17
ci_19                 9.700682e-03 3 1  ON 18
ci_20                 1.052682e-02 3 1  ON 19
ci_21                 9.015105e-03 3 1  ON 20
ci_22                 8.488394e-03 3 1  ON 21
ci_23                 6.439805e-03 3 1  ON 22
ci_24                 5.846003e-03 3 1  ON 23
ci_25                 4.901854e-03 3 1  ON 24
ci_26                 2.829250e-03 3 1  ON 25
ci_27                 3.419037e-03 3 1  ON 26
ci_28                 4.788936e-03 3 1  ON 27
ci_29                 4.670563e-03 3 1  ON 28
ci_30                -1.784992e-03 3 1  ON 29
ci_31                -1.459106e-03 3 1  ON 30
ci_32                -4.852966e-04 3 1  ON 31
ci_33                -6.041283e-04 3 1  ON 32
ci_34                 9.689982e-04 3 1  ON 33
ci_35                 5.653786e-04 3 1  ON 34
ci_36                -1.028223e-03 3 1  ON 35
ci_37                -1.686589e-03 3 1  ON 36
ci_38                -1.135041e-03 3 1  ON 37
ci_39                -1.072826e-03 3 1  ON 38
ci_40                -1.197844e-03 3 1  ON 39
ci_41                 1.871798e-04 3 1  ON 40
ci_42                 3.653638e-04 3 1  ON 41
ci_43                -2.094793e-03 3 1  ON 42
ci_44                -2.155100e-03 3 1  ON 43
ci_45                -7.565377e-04 3 1  ON 44
ci_46                -6.947736e-04 3 1  ON 45
ci_47                -2.011350e-03 3 1  ON 46
ci_48                -2.532695e-03 3 1  ON 47
ci_49                -1.242721e-03 3 1  ON 48
ci_50                -6.587249e-04 3 1  ON 49
ci_51                 3.665363e-04 3 1  ON 50
ci_52                 5.310787e-04 3 1  ON 51
ci_53                -1.446527e-03 3 1  ON 52
ci_54                -9.288157e-04 3 1  ON 53
ci_55                -1.252836e-03 3 1  ON 54
ci_56                 1.604243e-03 3 1  ON 55
ci_57                 7.605158e-04 3 1  ON 56
ci_58                -1.351688e-03 3 1  ON 57
ci_59                -1.410717e-03 3 1  ON 58
ci_60                 1.326779e-03 3 1  ON 59
ci_61                 1.465841e-03 3 1  ON 60
ci_62                -3.892939e-04 3 1  ON 61
ci_63                -6.332154e-04 3 1  ON 62
ci_64                -4.278153e-04 3 1  ON 63
ci_65                -1.399015e-03 3 1  ON 64
ci_66                -6.794705e-04 3 1  ON 65
ci_67                -9.601131e-04 3 1  ON 66
ci_68                -8.739540e-04 3 1  ON 67
ci_69                -4.067306e-04 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 1
    time step          = 0.05
    reference energy   = -22.8456
    reference variance = 0.536477
====================================================
  Execution time = 2.5507e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s001
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2817e+01
  VMC Evar = 5.0051e-01
  Total weights = 1.9634e+06
  Execution time = 3.6351e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.499327375279
                                         uncertainty =       0.004445687503

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.499327375279
                                         uncertainty =       0.004445687503

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000499627746
  error estimate for blocks of size 2^( 2) =       0.000520482638
  error estimate for blocks of size 2^( 3) =       0.000540625148
  error estimate for blocks of size 2^( 4) =       0.000555302829
  error estimate for blocks of size 2^( 5) =       0.000564712944
  error estimate for blocks of size 2^( 6) =       0.000570959699
  error estimate for blocks of size 2^( 7) =       0.000572218982

      target function =                  N/A
              le_mean =     -22.817866397661
             les_mean =     521.326539667897
             stat err =       0.000565798613
             autocorr =       1.282421121230
              std dev =       0.706580333862
             le_variance =       0.499255768201

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.492550032317
                                         uncertainty =       0.009557545007

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.492550032317
                                         uncertainty =       0.009557545007

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000496231482
  error estimate for blocks of size 2^( 2) =       0.000517029023
  error estimate for blocks of size 2^( 3) =       0.000537115493
  error estimate for blocks of size 2^( 4) =       0.000551802231
  error estimate for blocks of size 2^( 5) =       0.000561449187
  error estimate for blocks of size 2^( 6) =       0.000568035869
  error estimate for blocks of size 2^( 7) =       0.000569507403

      target function =                  N/A
              le_mean =     -22.817699104701
             les_mean =     521.315738833992
             stat err =       0.000562698672
             autocorr =       1.285828816878
              std dev =       0.701777291707
             le_variance =       0.492491367155

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.548136414544
                                         uncertainty =       0.040659198642

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.548136414544
                                         uncertainty =       0.040659198642

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000523435882
  error estimate for blocks of size 2^( 2) =       0.000543354964
  error estimate for blocks of size 2^( 3) =       0.000562921587
  error estimate for blocks of size 2^( 4) =       0.000577248989
  error estimate for blocks of size 2^( 5) =       0.000586586198
  error estimate for blocks of size 2^( 6) =       0.000591941025
  error estimate for blocks of size 2^( 7) =       0.000592847952

      target function =                  N/A
              le_mean =     -22.817742272260
             les_mean =     522.706796794065
             stat err =       0.000587156041
             autocorr =       1.258288089162
              std dev =       0.740250123572
             le_variance =       0.547970245449

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.488674271616
                                         uncertainty =       0.003611080328

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.488674271616
                                         uncertainty =       0.003611080328

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000494274054
  error estimate for blocks of size 2^( 2) =       0.000515210714
  error estimate for blocks of size 2^( 3) =       0.000535370427
  error estimate for blocks of size 2^( 4) =       0.000550043728
  error estimate for blocks of size 2^( 5) =       0.000559568472
  error estimate for blocks of size 2^( 6) =       0.000565860717
  error estimate for blocks of size 2^( 7) =       0.000567316614

      target function =                  N/A
              le_mean =     -22.817492521375
             les_mean =     521.190325046271
             stat err =       0.000560697382
             autocorr =       1.286830749650
              std dev =       0.699009070797
             le_variance =       0.488613681057


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.817866397661        initial  <--
     6.2500e-02     6.2500e-01             2.0118e-02       -22.817699104701
     2.5000e-01     2.5000e+00             9.1225e-03       -22.817742272260
     1.0000e+00     1.0000e+01             3.3177e-03       -22.817492521375

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 43.5568
  </log>
  <optVariables href="FORM.s001.opt.xml">
ci_01                 1.508280e-01 3 1  ON 0
ci_02                -4.533062e-02 3 1  ON 1
ci_03                -4.541162e-02 3 1  ON 2
ci_04                 4.185289e-02 3 1  ON 3
ci_05                -3.311998e-02 3 1  ON 4
ci_06                -3.254231e-02 3 1  ON 5
ci_07                 2.892866e-02 3 1  ON 6
ci_08                -1.136931e-02 3 1  ON 7
ci_09                -1.553361e-02 3 1  ON 8
ci_10                -1.470973e-02 3 1  ON 9
ci_11                 1.572517e-02 3 1  ON 10
ci_12                 1.217342e-02 3 1  ON 11
ci_13                 1.224713e-02 3 1  ON 12
ci_14                 1.293378e-02 3 1  ON 13
ci_15                 1.082353e-02 3 1  ON 14
ci_16                 1.037975e-02 3 1  ON 15
ci_17                -1.119136e-02 3 1  ON 16
ci_18                -1.176172e-02 3 1  ON 17
ci_19                 1.016116e-02 3 1  ON 18
ci_20                 1.017610e-02 3 1  ON 19
ci_21                 9.872746e-03 3 1  ON 20
ci_22                 9.194426e-03 3 1  ON 21
ci_23                 6.634116e-03 3 1  ON 22
ci_24                 5.503625e-03 3 1  ON 23
ci_25                 5.101764e-03 3 1  ON 24
ci_26                 4.071675e-03 3 1  ON 25
ci_27                 4.185558e-03 3 1  ON 26
ci_28                 4.612712e-03 3 1  ON 27
ci_29                 4.645358e-03 3 1  ON 28
ci_30                -3.164326e-03 3 1  ON 29
ci_31                -2.595709e-03 3 1  ON 30
ci_32                -1.638842e-03 3 1  ON 31
ci_33                -1.237350e-03 3 1  ON 32
ci_34                 1.065997e-03 3 1  ON 33
ci_35                 9.313363e-04 3 1  ON 34
ci_36                -1.433369e-03 3 1  ON 35
ci_37                -1.745448e-03 3 1  ON 36
ci_38                -1.205779e-03 3 1  ON 37
ci_39                -1.659625e-03 3 1  ON 38
ci_40                -1.576172e-03 3 1  ON 39
ci_41                -5.660461e-04 3 1  ON 40
ci_42                -2.364786e-04 3 1  ON 41
ci_43                -2.258692e-03 3 1  ON 42
ci_44                -2.095809e-03 3 1  ON 43
ci_45                -1.224098e-03 3 1  ON 44
ci_46                -1.250739e-03 3 1  ON 45
ci_47                -1.956455e-03 3 1  ON 46
ci_48                -2.069379e-03 3 1  ON 47
ci_49                -1.823223e-03 3 1  ON 48
ci_50                -8.542359e-04 3 1  ON 49
ci_51                 6.583027e-04 3 1  ON 50
ci_52                 1.285690e-03 3 1  ON 51
ci_53                -1.623755e-03 3 1  ON 52
ci_54                -1.304725e-03 3 1  ON 53
ci_55                -6.073819e-04 3 1  ON 54
ci_56                 1.270636e-03 3 1  ON 55
ci_57                 1.326512e-03 3 1  ON 56
ci_58                -9.755789e-04 3 1  ON 57
ci_59                -1.435427e-03 3 1  ON 58
ci_60                 1.053195e-03 3 1  ON 59
ci_61                 1.019402e-03 3 1  ON 60
ci_62                -4.411338e-04 3 1  ON 61
ci_63                -5.568658e-04 3 1  ON 62
ci_64                -1.050023e-03 3 1  ON 63
ci_65                -1.347019e-03 3 1  ON 64
ci_66                -8.846128e-04 3 1  ON 65
ci_67                -9.600379e-04 3 1  ON 66
ci_68                -4.650324e-04 3 1  ON 67
ci_69                 9.672195e-05 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.6218e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s002 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s002 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=2  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2838e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 2
    time step          = 0.05
    reference energy   = -22.8706
    reference variance = 0.497351
====================================================
  Execution time = 2.6376e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s002
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5330e+04
  VMC Eavg = -2.2816e+01
  VMC Evar = 5.0175e-01
  Total weights = 1.963327679e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.6945e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.485718868027
                                         uncertainty =       0.002138410524

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.485718868027
                                         uncertainty =       0.002138410524

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000492788494
  error estimate for blocks of size 2^( 2) =       0.000513176607
  error estimate for blocks of size 2^( 3) =       0.000532389202
  error estimate for blocks of size 2^( 4) =       0.000546544147
  error estimate for blocks of size 2^( 5) =       0.000555859044
  error estimate for blocks of size 2^( 6) =       0.000561488498
  error estimate for blocks of size 2^( 7) =       0.000563091000

      target function =                  N/A
              le_mean =     -22.815975391964
             les_mean =     521.070484161786
             stat err =       0.000556745672
             autocorr =       1.276417005773
              std dev =       0.696908171354
             le_variance =       0.485680999300


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281597539196e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.2500e-01, overlap shift 6.2500e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.815975391898       residual = 5.72e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.816720823016       residual = 2.40e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.816762715725       residual = 2.64e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.816763714895       residual = 3.05e-08           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.816763652507       residual = 4.95e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          4 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 6.2500e-01 is 4.763838e-03

solving harmonic davidson linear method for identity shift 2.5000e+00, overlap shift 2.5000e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.815975391898       residual = 5.72e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.816204803454       residual = 1.79e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.816214698969       residual = 2.59e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.816215205958       residual = 6.76e-08           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.816215165568       residual = 7.68e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          4 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.5000e+00 is 1.520292e-03

solving harmonic davidson linear method for identity shift 1.0000e+01, overlap shift 1.0000e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.815975391898       residual = 5.72e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.816036259351       residual = 1.66e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.816038695605       residual = 3.17e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.816038856879       residual = 9.05e-08           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.816038846900       residual = 1.19e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          4 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.0000e+01 is 4.083805e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.240778 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.1080e+01
  </log>
  <optVariables href="FORM.s002.opt.xml">
ci_01                 1.495546e-01 3 1  ON 0
ci_02                -4.410694e-02 3 1  ON 1
ci_03                -4.404122e-02 3 1  ON 2
ci_04                 4.033259e-02 3 1  ON 3
ci_05                -3.226824e-02 3 1  ON 4
ci_06                -3.166924e-02 3 1  ON 5
ci_07                 2.863460e-02 3 1  ON 6
ci_08                -1.070547e-02 3 1  ON 7
ci_09                -1.533070e-02 3 1  ON 8
ci_10                -1.455855e-02 3 1  ON 9
ci_11                 1.563451e-02 3 1  ON 10
ci_12                 1.215636e-02 3 1  ON 11
ci_13                 1.219918e-02 3 1  ON 12
ci_14                 1.296127e-02 3 1  ON 13
ci_15                 1.060340e-02 3 1  ON 14
ci_16                 1.019740e-02 3 1  ON 15
ci_17                -1.119136e-02 3 1  ON 16
ci_18                -1.171495e-02 3 1  ON 17
ci_19                 1.011065e-02 3 1  ON 18
ci_20                 1.018206e-02 3 1  ON 19
ci_21                 9.796372e-03 3 1  ON 20
ci_22                 9.087249e-03 3 1  ON 21
ci_23                 6.565449e-03 3 1  ON 22
ci_24                 5.579655e-03 3 1  ON 23
ci_25                 5.122396e-03 3 1  ON 24
ci_26                 3.927000e-03 3 1  ON 25
ci_27                 4.083821e-03 3 1  ON 26
ci_28                 4.647960e-03 3 1  ON 27
ci_29                 4.746892e-03 3 1  ON 28
ci_30                -3.034405e-03 3 1  ON 29
ci_31                -2.535333e-03 3 1  ON 30
ci_32                -1.464421e-03 3 1  ON 31
ci_33                -1.106871e-03 3 1  ON 32
ci_34                 9.079364e-04 3 1  ON 33
ci_35                 7.599649e-04 3 1  ON 34
ci_36                -1.482590e-03 3 1  ON 35
ci_37                -1.546278e-03 3 1  ON 36
ci_38                -1.166208e-03 3 1  ON 37
ci_39                -1.605530e-03 3 1  ON 38
ci_40                -1.600474e-03 3 1  ON 39
ci_41                -3.134114e-04 3 1  ON 40
ci_42                -5.692850e-05 3 1  ON 41
ci_43                -2.280748e-03 3 1  ON 42
ci_44                -2.124033e-03 3 1  ON 43
ci_45                -1.114625e-03 3 1  ON 44
ci_46                -1.214209e-03 3 1  ON 45
ci_47                -1.978527e-03 3 1  ON 46
ci_48                -2.126147e-03 3 1  ON 47
ci_49                -1.835371e-03 3 1  ON 48
ci_50                -8.172504e-04 3 1  ON 49
ci_51                 6.210208e-04 3 1  ON 50
ci_52                 1.253726e-03 3 1  ON 51
ci_53                -1.493628e-03 3 1  ON 52
ci_54                -1.327165e-03 3 1  ON 53
ci_55                -6.995766e-04 3 1  ON 54
ci_56                 1.233316e-03 3 1  ON 55
ci_57                 1.353255e-03 3 1  ON 56
ci_58                -1.015472e-03 3 1  ON 57
ci_59                -1.391221e-03 3 1  ON 58
ci_60                 1.105431e-03 3 1  ON 59
ci_61                 1.076596e-03 3 1  ON 60
ci_62                -4.334007e-04 3 1  ON 61
ci_63                -6.024586e-04 3 1  ON 62
ci_64                -8.936214e-04 3 1  ON 63
ci_65                -1.374354e-03 3 1  ON 64
ci_66                -8.507504e-04 3 1  ON 65
ci_67                -8.461386e-04 3 1  ON 66
ci_68                -5.584586e-04 3 1  ON 67
ci_69                -2.069783e-05 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 2
    time step          = 0.05
    reference energy   = -22.8288
    reference variance = 0.271608
====================================================
  Execution time = 2.5423e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s002
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2816e+01
  VMC Evar = 5.0012e-01
  Total weights = 1.9632e+06
  Execution time = 3.6250e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

ERROR CostFunction-> Number of Effective Walkers is too small! 
  Number of effective walkers (samples) / total number of samples = 0.000158754
  User specified threshold minwalkers = 0.3
  If this message appears frequently. You might have to be cautious. 
  Find info about parameter "minwalkers" in the user manual!
Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.485899065626
                                         uncertainty =       0.002823567287

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.485899065626
                                         uncertainty =       0.002823567287

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000492855199
  error estimate for blocks of size 2^( 2) =       0.000513966880
  error estimate for blocks of size 2^( 3) =       0.000533531470
  error estimate for blocks of size 2^( 4) =       0.000549617180
  error estimate for blocks of size 2^( 5) =       0.000560771963
  error estimate for blocks of size 2^( 6) =       0.000564722729
  error estimate for blocks of size 2^( 7) =       0.000568168464

      target function =                  N/A
              le_mean =     -22.815791189157
             les_mean =     521.702071853785
             stat err =       0.000560820084
             autocorr =       1.294817117255
              std dev =       0.697002506853
             le_variance =       0.485812494559

ERROR CostFunction-> Number of Effective Walkers is too small! 
  Number of effective walkers (samples) / total number of samples = 7.7686e-05
  User specified threshold minwalkers = 0.3
  If this message appears frequently. You might have to be cautious. 
  Find info about parameter "minwalkers" in the user manual!
Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.480817019148
                                         uncertainty =       0.002869017247

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.480817019148
                                         uncertainty =       0.002869017247

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000490270023
  error estimate for blocks of size 2^( 2) =       0.000511373485
  error estimate for blocks of size 2^( 3) =       0.000530924801
  error estimate for blocks of size 2^( 4) =       0.000547025966
  error estimate for blocks of size 2^( 5) =       0.000558150785
  error estimate for blocks of size 2^( 6) =       0.000561989250
  error estimate for blocks of size 2^( 7) =       0.000565573769

      target function =                  N/A
              le_mean =     -22.815909565020
             les_mean =     521.288855661972
             stat err =       0.000558184943
             autocorr =       1.296240407374
              std dev =       0.693346515122
             le_variance =       0.480729390032

ERROR CostFunction-> Number of Effective Walkers is too small! 
  Number of effective walkers (samples) / total number of samples = 0.000158165
  User specified threshold minwalkers = 0.3
  If this message appears frequently. You might have to be cautious. 
  Find info about parameter "minwalkers" in the user manual!
Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.482071200654
                                         uncertainty =       0.002817336065

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.482071200654
                                         uncertainty =       0.002817336065

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000490909353
  error estimate for blocks of size 2^( 2) =       0.000512016929
  error estimate for blocks of size 2^( 3) =       0.000531556328
  error estimate for blocks of size 2^( 4) =       0.000547644112
  error estimate for blocks of size 2^( 5) =       0.000558804576
  error estimate for blocks of size 2^( 6) =       0.000562674904
  error estimate for blocks of size 2^( 7) =       0.000566147148

      target function =                  N/A
              le_mean =     -22.815823468535
             les_mean =     521.069883970243
             stat err =       0.000558817685
             autocorr =       1.295799087944
              std dev =       0.694250665484
             le_variance =       0.481983986525

ERROR CostFunction-> Number of Effective Walkers is too small! 
  Number of effective walkers (samples) / total number of samples = 0.000269834
  User specified threshold minwalkers = 0.3
  If this message appears frequently. You might have to be cautious. 
  Find info about parameter "minwalkers" in the user manual!
Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.484765102121
                                         uncertainty =       0.002785856071

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.484765102121
                                         uncertainty =       0.002785856071

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000492279440
  error estimate for blocks of size 2^( 2) =       0.000513406770
  error estimate for blocks of size 2^( 3) =       0.000532937627
  error estimate for blocks of size 2^( 4) =       0.000549020087
  error estimate for blocks of size 2^( 5) =       0.000560191080
  error estimate for blocks of size 2^( 6) =       0.000564105973
  error estimate for blocks of size 2^( 7) =       0.000567513476

      target function =                  N/A
              le_mean =     -22.815807131763
             les_mean =     521.089466126437
             stat err =       0.000560207654
             autocorr =       1.295014647883
              std dev =       0.696188260571
             le_variance =       0.484678094158


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.815791189157        initial
     6.2500e-01     6.2500e+00             4.7638e-03       -22.815909565020  <--
     2.5000e+00     2.5000e+01             1.5203e-03       -22.815823468535
     1.0000e+01     1.0000e+02             4.0838e-04       -22.815807131763

*****************************************************************************
Applying the update for shift_i =   6.2500e-01     and shift_s =   6.2500e+00
*****************************************************************************

  Execution time = 4.3581e+01
  </log>
  <optVariables href="FORM.s002.opt.xml">
ci_01                 1.462867e-01 3 1  ON 0
ci_02                -4.126572e-02 3 1  ON 1
ci_03                -4.084192e-02 3 1  ON 2
ci_04                 3.708905e-02 3 1  ON 3
ci_05                -3.035374e-02 3 1  ON 4
ci_06                -2.971330e-02 3 1  ON 5
ci_07                 2.793700e-02 3 1  ON 6
ci_08                -9.297460e-03 3 1  ON 7
ci_09                -1.483646e-02 3 1  ON 8
ci_10                -1.418951e-02 3 1  ON 9
ci_11                 1.544188e-02 3 1  ON 10
ci_12                 1.211194e-02 3 1  ON 11
ci_13                 1.208016e-02 3 1  ON 12
ci_14                 1.307323e-02 3 1  ON 13
ci_15                 1.008895e-02 3 1  ON 14
ci_16                 9.771679e-03 3 1  ON 15
ci_17                -1.114971e-02 3 1  ON 16
ci_18                -1.155867e-02 3 1  ON 17
ci_19                 1.002684e-02 3 1  ON 18
ci_20                 1.020625e-02 3 1  ON 19
ci_21                 9.595652e-03 3 1  ON 20
ci_22                 8.813278e-03 3 1  ON 21
ci_23                 6.437192e-03 3 1  ON 22
ci_24                 5.788431e-03 3 1  ON 23
ci_25                 5.175329e-03 3 1  ON 24
ci_26                 3.599588e-03 3 1  ON 25
ci_27                 3.860690e-03 3 1  ON 26
ci_28                 4.683841e-03 3 1  ON 27
ci_29                 4.932004e-03 3 1  ON 28
ci_30                -2.706644e-03 3 1  ON 29
ci_31                -2.370617e-03 3 1  ON 30
ci_32                -1.169011e-03 3 1  ON 31
ci_33                -9.041652e-04 3 1  ON 32
ci_34                 6.191460e-04 3 1  ON 33
ci_35                 4.262098e-04 3 1  ON 34
ci_36                -1.568629e-03 3 1  ON 35
ci_37                -1.120046e-03 3 1  ON 36
ci_38                -1.069785e-03 3 1  ON 37
ci_39                -1.487383e-03 3 1  ON 38
ci_40                -1.644407e-03 3 1  ON 39
ci_41                 1.579163e-04 3 1  ON 40
ci_42                 2.607437e-04 3 1  ON 41
ci_43                -2.274604e-03 3 1  ON 42
ci_44                -2.135466e-03 3 1  ON 43
ci_45                -8.838262e-04 3 1  ON 44
ci_46                -1.121449e-03 3 1  ON 45
ci_47                -2.011254e-03 3 1  ON 46
ci_48                -2.238612e-03 3 1  ON 47
ci_49                -1.870404e-03 3 1  ON 48
ci_50                -7.475102e-04 3 1  ON 49
ci_51                 5.369872e-04 3 1  ON 50
ci_52                 1.170915e-03 3 1  ON 51
ci_53                -1.243415e-03 3 1  ON 52
ci_54                -1.365372e-03 3 1  ON 53
ci_55                -9.064752e-04 3 1  ON 54
ci_56                 1.174216e-03 3 1  ON 55
ci_57                 1.430098e-03 3 1  ON 56
ci_58                -1.110825e-03 3 1  ON 57
ci_59                -1.292240e-03 3 1  ON 58
ci_60                 1.246114e-03 3 1  ON 59
ci_61                 1.227310e-03 3 1  ON 60
ci_62                -4.064458e-04 3 1  ON 61
ci_63                -6.815555e-04 3 1  ON 62
ci_64                -5.374481e-04 3 1  ON 63
ci_65                -1.427408e-03 3 1  ON 64
ci_66                -7.660981e-04 3 1  ON 65
ci_67                -5.989881e-04 3 1  ON 66
ci_68                -7.661392e-04 3 1  ON 67
ci_69                -2.829208e-04 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.4671e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s003 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s003 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=3  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2842e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 3
    time step          = 0.05
    reference energy   = -22.7583
    reference variance = 0.403727
====================================================
  Execution time = 2.6097e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s003
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5316e+04
  VMC Eavg = -2.2816e+01
  VMC Evar = 4.8937e-01
  Total weights = 1.963393913e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.5820e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.475400899644
                                         uncertainty =       0.002372752492

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.475400899644
                                         uncertainty =       0.002372752492

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000487504817
  error estimate for blocks of size 2^( 2) =       0.000508214196
  error estimate for blocks of size 2^( 3) =       0.000527325223
  error estimate for blocks of size 2^( 4) =       0.000542448032
  error estimate for blocks of size 2^( 5) =       0.000551192874
  error estimate for blocks of size 2^( 6) =       0.000555579169
  error estimate for blocks of size 2^( 7) =       0.000559531448

      target function =                  N/A
              le_mean =     -22.816005667275
             les_mean =     521.059488391558
             stat err =       0.000552187881
             autocorr =       1.282968279751
              std dev =       0.689435923578
             le_variance =       0.475321892720


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281600566728e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5625e-01, overlap shift 1.5625e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.816005667209       residual = 3.39e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.816973047143       residual = 2.47e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.817054872604       residual = 9.21e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.817059260961       residual = 2.64e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.817059577553       residual = 6.22e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          4 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.5625e-01 is 1.077556e-02

solving harmonic davidson linear method for identity shift 6.2500e-01, overlap shift 6.2500e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.816005667209       residual = 3.39e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.816423375835       residual = 1.29e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.816439622869       residual = 1.01e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.816440203636       residual = 1.44e-08           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.816440222813       residual = 2.99e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          4 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 6.2500e-01 is 3.875814e-03

solving harmonic davidson linear method for identity shift 2.5000e+00, overlap shift 2.5000e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.816005667209       residual = 3.39e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.816133288534       residual = 1.01e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.816136479141       residual = 1.14e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.816136636352       residual = 2.55e-08           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.816136624032       residual = 3.29e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          4 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.5000e+00 is 1.233518e-03

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.245778 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0695e+01
  </log>
  <optVariables href="FORM.s003.opt.xml">
ci_01                 1.425305e-01 3 1  ON 0
ci_02                -3.785747e-02 3 1  ON 1
ci_03                -3.782198e-02 3 1  ON 2
ci_04                 3.321324e-02 3 1  ON 3
ci_05                -2.825132e-02 3 1  ON 4
ci_06                -2.800712e-02 3 1  ON 5
ci_07                 2.748679e-02 3 1  ON 6
ci_08                -8.076107e-03 3 1  ON 7
ci_09                -1.417117e-02 3 1  ON 8
ci_10                -1.377515e-02 3 1  ON 9
ci_11                 1.544028e-02 3 1  ON 10
ci_12                 1.187020e-02 3 1  ON 11
ci_13                 1.201983e-02 3 1  ON 12
ci_14                 1.331779e-02 3 1  ON 13
ci_15                 9.514514e-03 3 1  ON 14
ci_16                 9.171367e-03 3 1  ON 15
ci_17                -1.140335e-02 3 1  ON 16
ci_18                -1.111689e-02 3 1  ON 17
ci_19                 9.921543e-03 3 1  ON 18
ci_20                 1.000529e-02 3 1  ON 19
ci_21                 9.578227e-03 3 1  ON 20
ci_22                 8.790488e-03 3 1  ON 21
ci_23                 6.503567e-03 3 1  ON 22
ci_24                 5.938563e-03 3 1  ON 23
ci_25                 5.002635e-03 3 1  ON 24
ci_26                 3.172594e-03 3 1  ON 25
ci_27                 3.629403e-03 3 1  ON 26
ci_28                 4.763084e-03 3 1  ON 27
ci_29                 4.889197e-03 3 1  ON 28
ci_30                -2.235977e-03 3 1  ON 29
ci_31                -1.977936e-03 3 1  ON 30
ci_32                -5.133930e-04 3 1  ON 31
ci_33                -8.336723e-04 3 1  ON 32
ci_34                 2.018797e-04 3 1  ON 33
ci_35                 2.237028e-04 3 1  ON 34
ci_36                -1.277485e-03 3 1  ON 35
ci_37                -1.261542e-03 3 1  ON 36
ci_38                -9.131196e-04 3 1  ON 37
ci_39                -1.242091e-03 3 1  ON 38
ci_40                -1.553933e-03 3 1  ON 39
ci_41                 4.746693e-04 3 1  ON 40
ci_42                 3.056140e-04 3 1  ON 41
ci_43                -2.507978e-03 3 1  ON 42
ci_44                -2.207252e-03 3 1  ON 43
ci_45                -7.616105e-04 3 1  ON 44
ci_46                -9.482798e-04 3 1  ON 45
ci_47                -1.694868e-03 3 1  ON 46
ci_48                -2.008067e-03 3 1  ON 47
ci_49                -1.841041e-03 3 1  ON 48
ci_50                -6.966871e-04 3 1  ON 49
ci_51                 1.997164e-04 3 1  ON 50
ci_52                 8.137460e-04 3 1  ON 51
ci_53                -9.715447e-04 3 1  ON 52
ci_54                -1.374782e-03 3 1  ON 53
ci_55                -9.912928e-04 3 1  ON 54
ci_56                 1.472272e-03 3 1  ON 55
ci_57                 1.123093e-03 3 1  ON 56
ci_58                -1.308480e-03 3 1  ON 57
ci_59                -1.285042e-03 3 1  ON 58
ci_60                 8.294815e-04 3 1  ON 59
ci_61                 1.287533e-03 3 1  ON 60
ci_62                -6.881806e-04 3 1  ON 61
ci_63                -9.114879e-04 3 1  ON 62
ci_64                -5.322902e-04 3 1  ON 63
ci_65                -1.298519e-03 3 1  ON 64
ci_66                -8.098177e-04 3 1  ON 65
ci_67                -3.888130e-04 3 1  ON 66
ci_68                -6.056177e-04 3 1  ON 67
ci_69                -4.790254e-04 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 3
    time step          = 0.05
    reference energy   = -22.8927
    reference variance = 0.603808
====================================================
  Execution time = 2.5219e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s003
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2817e+01
  VMC Evar = 4.9419e-01
  Total weights = 1.9630e+06
  Execution time = 3.5617e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.482594091471
                                         uncertainty =       0.005012813539

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.482594091471
                                         uncertainty =       0.005012813539

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000491200945
  error estimate for blocks of size 2^( 2) =       0.000512194477
  error estimate for blocks of size 2^( 3) =       0.000532180967
  error estimate for blocks of size 2^( 4) =       0.000548110406
  error estimate for blocks of size 2^( 5) =       0.000556486780
  error estimate for blocks of size 2^( 6) =       0.000560993109
  error estimate for blocks of size 2^( 7) =       0.000562392753

      target function =                  N/A
              le_mean =     -22.817399350491
             les_mean =     528.321641538536
             stat err =       0.000556995762
             autocorr =       1.285835448502
              std dev =       0.694663037972
             le_variance =       0.482556736324

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.540251797777
                                         uncertainty =       0.068475476757

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.540251797777
                                         uncertainty =       0.068475476757

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000519559135
  error estimate for blocks of size 2^( 2) =       0.000539644345
  error estimate for blocks of size 2^( 3) =       0.000558569081
  error estimate for blocks of size 2^( 4) =       0.000573802047
  error estimate for blocks of size 2^( 5) =       0.000581748625
  error estimate for blocks of size 2^( 6) =       0.000586063575
  error estimate for blocks of size 2^( 7) =       0.000588354397

      target function =                  N/A
              le_mean =     -22.817347608220
             les_mean =     521.616076495144
             stat err =       0.000582492161
             autocorr =       1.256927419020
              std dev =       0.734767575452
             le_variance =       0.539883389936

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.472421745954
                                         uncertainty =       0.002763942702

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.472421745954
                                         uncertainty =       0.002763942702

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000485998994
  error estimate for blocks of size 2^( 2) =       0.000507161780
  error estimate for blocks of size 2^( 3) =       0.000527244100
  error estimate for blocks of size 2^( 4) =       0.000543437369
  error estimate for blocks of size 2^( 5) =       0.000551926579
  error estimate for blocks of size 2^( 6) =       0.000556550060
  error estimate for blocks of size 2^( 7) =       0.000557948364

      target function =                  N/A
              le_mean =     -22.817439378774
             les_mean =     521.146683766896
             stat err =       0.000552465593
             autocorr =       1.292229735485
              std dev =       0.687306369299
             le_variance =       0.472390045280

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.477534448171
                                         uncertainty =       0.002972619653

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.477534448171
                                         uncertainty =       0.002972619653

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000488621503
  error estimate for blocks of size 2^( 2) =       0.000509684257
  error estimate for blocks of size 2^( 3) =       0.000529665659
  error estimate for blocks of size 2^( 4) =       0.000545678604
  error estimate for blocks of size 2^( 5) =       0.000554076589
  error estimate for blocks of size 2^( 6) =       0.000558610695
  error estimate for blocks of size 2^( 7) =       0.000560017980

      target function =                  N/A
              le_mean =     -22.817370861082
             les_mean =     521.135862360070
             stat err =       0.000554595967
             autocorr =       1.288274065966
              std dev =       0.691015155806
             le_variance =       0.477501945553


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.817399350491        initial
     1.5625e-01     1.5625e+00             1.0776e-02       -22.817347608220
     6.2500e-01     6.2500e+00             3.8758e-03       -22.817439378774  <--
     2.5000e+00     2.5000e+01             1.2335e-03       -22.817370861082

*****************************************************************************
Applying the update for shift_i =   6.2500e-01     and shift_s =   6.2500e+00
*****************************************************************************

  Execution time = 4.3066e+01
  </log>
  <optVariables href="FORM.s003.opt.xml">
ci_01                 1.425305e-01 3 1  ON 0
ci_02                -3.785747e-02 3 1  ON 1
ci_03                -3.782198e-02 3 1  ON 2
ci_04                 3.321324e-02 3 1  ON 3
ci_05                -2.825132e-02 3 1  ON 4
ci_06                -2.800712e-02 3 1  ON 5
ci_07                 2.748679e-02 3 1  ON 6
ci_08                -8.076107e-03 3 1  ON 7
ci_09                -1.417117e-02 3 1  ON 8
ci_10                -1.377515e-02 3 1  ON 9
ci_11                 1.544028e-02 3 1  ON 10
ci_12                 1.187020e-02 3 1  ON 11
ci_13                 1.201983e-02 3 1  ON 12
ci_14                 1.331779e-02 3 1  ON 13
ci_15                 9.514514e-03 3 1  ON 14
ci_16                 9.171367e-03 3 1  ON 15
ci_17                -1.140335e-02 3 1  ON 16
ci_18                -1.111689e-02 3 1  ON 17
ci_19                 9.921543e-03 3 1  ON 18
ci_20                 1.000529e-02 3 1  ON 19
ci_21                 9.578227e-03 3 1  ON 20
ci_22                 8.790488e-03 3 1  ON 21
ci_23                 6.503567e-03 3 1  ON 22
ci_24                 5.938563e-03 3 1  ON 23
ci_25                 5.002635e-03 3 1  ON 24
ci_26                 3.172594e-03 3 1  ON 25
ci_27                 3.629403e-03 3 1  ON 26
ci_28                 4.763084e-03 3 1  ON 27
ci_29                 4.889197e-03 3 1  ON 28
ci_30                -2.235977e-03 3 1  ON 29
ci_31                -1.977936e-03 3 1  ON 30
ci_32                -5.133930e-04 3 1  ON 31
ci_33                -8.336723e-04 3 1  ON 32
ci_34                 2.018797e-04 3 1  ON 33
ci_35                 2.237028e-04 3 1  ON 34
ci_36                -1.277485e-03 3 1  ON 35
ci_37                -1.261542e-03 3 1  ON 36
ci_38                -9.131196e-04 3 1  ON 37
ci_39                -1.242091e-03 3 1  ON 38
ci_40                -1.553933e-03 3 1  ON 39
ci_41                 4.746693e-04 3 1  ON 40
ci_42                 3.056140e-04 3 1  ON 41
ci_43                -2.507978e-03 3 1  ON 42
ci_44                -2.207252e-03 3 1  ON 43
ci_45                -7.616105e-04 3 1  ON 44
ci_46                -9.482798e-04 3 1  ON 45
ci_47                -1.694868e-03 3 1  ON 46
ci_48                -2.008067e-03 3 1  ON 47
ci_49                -1.841041e-03 3 1  ON 48
ci_50                -6.966871e-04 3 1  ON 49
ci_51                 1.997164e-04 3 1  ON 50
ci_52                 8.137460e-04 3 1  ON 51
ci_53                -9.715447e-04 3 1  ON 52
ci_54                -1.374782e-03 3 1  ON 53
ci_55                -9.912928e-04 3 1  ON 54
ci_56                 1.472272e-03 3 1  ON 55
ci_57                 1.123093e-03 3 1  ON 56
ci_58                -1.308480e-03 3 1  ON 57
ci_59                -1.285042e-03 3 1  ON 58
ci_60                 8.294815e-04 3 1  ON 59
ci_61                 1.287533e-03 3 1  ON 60
ci_62                -6.881806e-04 3 1  ON 61
ci_63                -9.114879e-04 3 1  ON 62
ci_64                -5.322902e-04 3 1  ON 63
ci_65                -1.298519e-03 3 1  ON 64
ci_66                -8.098177e-04 3 1  ON 65
ci_67                -3.888130e-04 3 1  ON 66
ci_68                -6.056177e-04 3 1  ON 67
ci_69                -4.790254e-04 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.3777e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s004 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s004 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=4  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2838e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 4
    time step          = 0.05
    reference energy   = -22.8811
    reference variance = 0.413281
====================================================
  Execution time = 2.5919e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s004
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5325e+04
  VMC Eavg = -2.2819e+01
  VMC Evar = 4.8889e-01
  Total weights = 1.963485820e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.6282e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.473822099757
                                         uncertainty =       0.002132894755

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.473822099757
                                         uncertainty =       0.002132894755

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000486707599
  error estimate for blocks of size 2^( 2) =       0.000507728127
  error estimate for blocks of size 2^( 3) =       0.000527614575
  error estimate for blocks of size 2^( 4) =       0.000542379151
  error estimate for blocks of size 2^( 5) =       0.000551804489
  error estimate for blocks of size 2^( 6) =       0.000556784047
  error estimate for blocks of size 2^( 7) =       0.000556876319

      target function =                  N/A
              le_mean =     -22.818566673576
             les_mean =     521.175872026374
             stat err =       0.000551961001
             autocorr =       1.286117163116
              std dev =       0.688308487413
             le_variance =       0.473768573844


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281856667358e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5625e-01, overlap shift 1.5625e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.818566673502       residual = 2.04e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.819186014589       residual = 1.62e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.819239845191       residual = 5.59e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.819243495461       residual = 1.30e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.819243300690       residual = 3.28e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          4 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.5625e-01 is 9.291546e-03

solving harmonic davidson linear method for identity shift 6.2500e-01, overlap shift 6.2500e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.818566673502       residual = 2.04e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.818827250079       residual = 8.14e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.818840245431       residual = 6.48e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.818840579534       residual = 9.05e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 6.2500e-01 is 3.228516e-03

solving harmonic davidson linear method for identity shift 2.5000e+00, overlap shift 2.5000e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.818566673502       residual = 2.04e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.818645226414       residual = 6.19e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.818648425763       residual = 7.39e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.818648507881       residual = 1.85e-08           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.818648499492       residual = 2.60e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          4 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.5000e+00 is 8.984145e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.247368 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0557e+01
  </log>
  <optVariables href="FORM.s004.opt.xml">
ci_01                 1.393019e-01 3 1  ON 0
ci_02                -3.527899e-02 3 1  ON 1
ci_03                -3.514811e-02 3 1  ON 2
ci_04                 3.078613e-02 3 1  ON 3
ci_05                -2.685424e-02 3 1  ON 4
ci_06                -2.680347e-02 3 1  ON 5
ci_07                 2.694871e-02 3 1  ON 6
ci_08                -6.942249e-03 3 1  ON 7
ci_09                -1.338547e-02 3 1  ON 8
ci_10                -1.320601e-02 3 1  ON 9
ci_11                 1.514494e-02 3 1  ON 10
ci_12                 1.170980e-02 3 1  ON 11
ci_13                 1.219983e-02 3 1  ON 12
ci_14                 1.329545e-02 3 1  ON 13
ci_15                 9.294501e-03 3 1  ON 14
ci_16                 8.818869e-03 3 1  ON 15
ci_17                -1.111954e-02 3 1  ON 16
ci_18                -1.101401e-02 3 1  ON 17
ci_19                 9.679829e-03 3 1  ON 18
ci_20                 1.033708e-02 3 1  ON 19
ci_21                 9.287024e-03 3 1  ON 20
ci_22                 8.700317e-03 3 1  ON 21
ci_23                 6.554582e-03 3 1  ON 22
ci_24                 5.959113e-03 3 1  ON 23
ci_25                 5.103166e-03 3 1  ON 24
ci_26                 3.194775e-03 3 1  ON 25
ci_27                 3.373818e-03 3 1  ON 26
ci_28                 4.877846e-03 3 1  ON 27
ci_29                 4.725031e-03 3 1  ON 28
ci_30                -1.947850e-03 3 1  ON 29
ci_31                -1.711536e-03 3 1  ON 30
ci_32                -3.965987e-04 3 1  ON 31
ci_33                -1.020424e-03 3 1  ON 32
ci_34                 3.057004e-04 3 1  ON 33
ci_35                 4.210333e-04 3 1  ON 34
ci_36                -1.179947e-03 3 1  ON 35
ci_37                -9.692346e-04 3 1  ON 36
ci_38                -6.555874e-04 3 1  ON 37
ci_39                -1.020991e-03 3 1  ON 38
ci_40                -1.385102e-03 3 1  ON 39
ci_41                 4.650165e-04 3 1  ON 40
ci_42                 1.600568e-04 3 1  ON 41
ci_43                -2.613210e-03 3 1  ON 42
ci_44                -2.345825e-03 3 1  ON 43
ci_45                -6.927473e-04 3 1  ON 44
ci_46                -5.580708e-04 3 1  ON 45
ci_47                -1.700235e-03 3 1  ON 46
ci_48                -1.812830e-03 3 1  ON 47
ci_49                -1.613274e-03 3 1  ON 48
ci_50                -5.285321e-04 3 1  ON 49
ci_51                 3.100100e-04 3 1  ON 50
ci_52                 5.702354e-04 3 1  ON 51
ci_53                -1.079129e-03 3 1  ON 52
ci_54                -1.160202e-03 3 1  ON 53
ci_55                -1.094415e-03 3 1  ON 54
ci_56                 1.418239e-03 3 1  ON 55
ci_57                 9.892727e-04 3 1  ON 56
ci_58                -1.339500e-03 3 1  ON 57
ci_59                -1.541834e-03 3 1  ON 58
ci_60                 6.668738e-04 3 1  ON 59
ci_61                 1.268688e-03 3 1  ON 60
ci_62                -6.982452e-04 3 1  ON 61
ci_63                -5.003920e-04 3 1  ON 62
ci_64                -3.342615e-04 3 1  ON 63
ci_65                -1.191764e-03 3 1  ON 64
ci_66                -9.090719e-04 3 1  ON 65
ci_67                -3.217913e-04 3 1  ON 66
ci_68                -7.623479e-04 3 1  ON 67
ci_69                -3.723093e-04 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 4
    time step          = 0.05
    reference energy   = -22.805
    reference variance = 0.372009
====================================================
  Execution time = 2.5201e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s004
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2818e+01
  VMC Evar = 4.9089e-01
  Total weights = 1.9632e+06
  Execution time = 3.5774e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

ERROR CostFunction-> Number of Effective Walkers is too small! 
  Number of effective walkers (samples) / total number of samples = 0.135846
  User specified threshold minwalkers = 0.3
  If this message appears frequently. You might have to be cautious. 
  Find info about parameter "minwalkers" in the user manual!
Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =     420.068991860666
                                         uncertainty =     417.489063369661

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =     420.068991860666
                                         uncertainty =     417.489063369661

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.014474703725
  error estimate for blocks of size 2^( 2) =       0.014476414103
  error estimate for blocks of size 2^( 3) =       0.014476754304
  error estimate for blocks of size 2^( 4) =       0.014477322642
  error estimate for blocks of size 2^( 5) =       0.014485052053
  error estimate for blocks of size 2^( 6) =       0.014486949316
  error estimate for blocks of size 2^( 7) =       0.014488862769

      target function =                  N/A
              le_mean =     -22.803863768120
             les_mean =  184062.965761810279
             stat err =       0.014484546695
             autocorr =       1.001360486163
              std dev =      20.470322318908
             le_variance =     419.034095839969

ERROR CostFunction-> Number of Effective Walkers is too small! 
  Number of effective walkers (samples) / total number of samples = 0.022908
  User specified threshold minwalkers = 0.3
  If this message appears frequently. You might have to be cautious. 
  Find info about parameter "minwalkers" in the user manual!
Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.474323003379
                                         uncertainty =       0.006092838232

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.474323003379
                                         uncertainty =       0.006092838232

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000486972961
  error estimate for blocks of size 2^( 2) =       0.000508312995
  error estimate for blocks of size 2^( 3) =       0.000528726479
  error estimate for blocks of size 2^( 4) =       0.000543144013
  error estimate for blocks of size 2^( 5) =       0.000551290315
  error estimate for blocks of size 2^( 6) =       0.000556647292
  error estimate for blocks of size 2^( 7) =       0.000559482628

      target function =                  N/A
              le_mean =     -22.818443013406
             les_mean =     521.349324764388
             stat err =       0.000552641062
             autocorr =       1.287883577159
              std dev =       0.688683765812
             le_variance =       0.474285329293

ERROR CostFunction-> Number of Effective Walkers is too small! 
  Number of effective walkers (samples) / total number of samples = 0.129425
  User specified threshold minwalkers = 0.3
  If this message appears frequently. You might have to be cautious. 
  Find info about parameter "minwalkers" in the user manual!
Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.473686425937
                                         uncertainty =       0.005762768964

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.473686425937
                                         uncertainty =       0.005762768964

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000486647372
  error estimate for blocks of size 2^( 2) =       0.000507983813
  error estimate for blocks of size 2^( 3) =       0.000528407066
  error estimate for blocks of size 2^( 4) =       0.000542850752
  error estimate for blocks of size 2^( 5) =       0.000551006160
  error estimate for blocks of size 2^( 6) =       0.000556328257
  error estimate for blocks of size 2^( 7) =       0.000559117697

      target function =                  N/A
              le_mean =     -22.818367443675
             les_mean =     521.205890051994
             stat err =       0.000552325716
             autocorr =       1.288136138675
              std dev =       0.688223313422
             le_variance =       0.473651329137

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.477374456250
                                         uncertainty =       0.006108002101

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.477374456250
                                         uncertainty =       0.006108002101

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000488538490
  error estimate for blocks of size 2^( 2) =       0.000509747117
  error estimate for blocks of size 2^( 3) =       0.000530055015
  error estimate for blocks of size 2^( 4) =       0.000544386611
  error estimate for blocks of size 2^( 5) =       0.000552392316
  error estimate for blocks of size 2^( 6) =       0.000557546418
  error estimate for blocks of size 2^( 7) =       0.000560397324

      target function =                  N/A
              le_mean =     -22.818330851531
             les_mean =     533.648349848510
             stat err =       0.000553680667
             autocorr =       1.284461666963
              std dev =       0.690897758143
             le_variance =       0.477339712206


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.803863768120        initial
     1.5625e-01     1.5625e+00             9.2915e-03       -22.818443013406  <--
     6.2500e-01     6.2500e+00             3.2285e-03       -22.818367443675
     2.5000e+00     2.5000e+01             8.9841e-04       -22.818330851531

*****************************************************************************
Applying the update for shift_i =   1.5625e-01     and shift_s =   1.5625e+00
*****************************************************************************

  Execution time = 4.3160e+01
  </log>
  <optVariables href="FORM.s004.opt.xml">
ci_01                 1.332389e-01 3 1  ON 0
ci_02                -3.161241e-02 3 1  ON 1
ci_03                -3.134956e-02 3 1  ON 2
ci_04                 2.793250e-02 3 1  ON 3
ci_05                -2.514878e-02 3 1  ON 4
ci_06                -2.540216e-02 3 1  ON 5
ci_07                 2.614792e-02 3 1  ON 6
ci_08                -5.627889e-03 3 1  ON 7
ci_09                -1.213594e-02 3 1  ON 8
ci_10                -1.229484e-02 3 1  ON 9
ci_11                 1.481719e-02 3 1  ON 10
ci_12                 1.150738e-02 3 1  ON 11
ci_13                 1.256153e-02 3 1  ON 12
ci_14                 1.331866e-02 3 1  ON 13
ci_15                 9.036775e-03 3 1  ON 14
ci_16                 8.340861e-03 3 1  ON 15
ci_17                -1.064064e-02 3 1  ON 16
ci_18                -1.079949e-02 3 1  ON 17
ci_19                 9.441739e-03 3 1  ON 18
ci_20                 1.081383e-02 3 1  ON 19
ci_21                 8.787127e-03 3 1  ON 20
ci_22                 8.552740e-03 3 1  ON 21
ci_23                 6.615583e-03 3 1  ON 22
ci_24                 6.041436e-03 3 1  ON 23
ci_25                 5.218855e-03 3 1  ON 24
ci_26                 3.284912e-03 3 1  ON 25
ci_27                 3.041378e-03 3 1  ON 26
ci_28                 4.922016e-03 3 1  ON 27
ci_29                 4.385118e-03 3 1  ON 28
ci_30                -1.385217e-03 3 1  ON 29
ci_31                -1.202597e-03 3 1  ON 30
ci_32                -3.815387e-04 3 1  ON 31
ci_33                -1.353924e-03 3 1  ON 32
ci_34                 6.754854e-04 3 1  ON 33
ci_35                 9.162017e-04 3 1  ON 34
ci_36                -1.071148e-03 3 1  ON 35
ci_37                -6.166085e-04 3 1  ON 36
ci_38                -3.399237e-04 3 1  ON 37
ci_39                -7.564774e-04 3 1  ON 38
ci_40                -1.222988e-03 3 1  ON 39
ci_41                 3.332609e-04 3 1  ON 40
ci_42                -1.235546e-04 3 1  ON 41
ci_43                -2.692050e-03 3 1  ON 42
ci_44                -2.472572e-03 3 1  ON 43
ci_45                -5.990693e-04 3 1  ON 44
ci_46                -1.096822e-04 3 1  ON 45
ci_47                -1.642701e-03 3 1  ON 46
ci_48                -1.401946e-03 3 1  ON 47
ci_49                -1.358584e-03 3 1  ON 48
ci_50                -3.674154e-04 3 1  ON 49
ci_51                 3.969379e-04 3 1  ON 50
ci_52                 2.646377e-04 3 1  ON 51
ci_53                -1.172159e-03 3 1  ON 52
ci_54                -8.492720e-04 3 1  ON 53
ci_55                -1.241267e-03 3 1  ON 54
ci_56                 1.356890e-03 3 1  ON 55
ci_57                 8.615262e-04 3 1  ON 56
ci_58                -1.391271e-03 3 1  ON 57
ci_59                -1.899054e-03 3 1  ON 58
ci_60                 3.278159e-04 3 1  ON 59
ci_61                 1.238925e-03 3 1  ON 60
ci_62                -6.860629e-04 3 1  ON 61
ci_63                -7.090515e-05 3 1  ON 62
ci_64                -9.585153e-05 3 1  ON 63
ci_65                -1.098311e-03 3 1  ON 64
ci_66                -1.021253e-03 3 1  ON 65
ci_67                -2.320077e-04 3 1  ON 66
ci_68                -9.597601e-04 3 1  ON 67
ci_69                -2.206474e-04 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.3728e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s005 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s005 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=5  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2839e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 5
    time step          = 0.05
    reference energy   = -22.9163
    reference variance = 0.538644
====================================================
  Execution time = 2.7749e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s005
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5357e+04
  VMC Eavg = -2.2819e+01
  VMC Evar = 4.9420e-01
  Total weights = 1.963413369e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.5611e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.477987462724
                                         uncertainty =       0.005258931340

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.477987462724
                                         uncertainty =       0.005258931340

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000488871708
  error estimate for blocks of size 2^( 2) =       0.000509857483
  error estimate for blocks of size 2^( 3) =       0.000530004997
  error estimate for blocks of size 2^( 4) =       0.000545583936
  error estimate for blocks of size 2^( 5) =       0.000555043262
  error estimate for blocks of size 2^( 6) =       0.000559892358
  error estimate for blocks of size 2^( 7) =       0.000561973654

      target function =                  N/A
              le_mean =     -22.818899078751
             les_mean =     521.196356154780
             stat err =       0.000555623303
             autocorr =       1.291728060866
              std dev =       0.691368999769
             le_variance =       0.477991093842


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281889907875e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.9062e-02, overlap shift 3.9062e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.818899078670       residual = 6.02e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.819127789870       residual = 9.83e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.819184384995       residual = 1.03e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.819194701124       residual = 6.80e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.819195089406       residual = 4.16e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.819195051705       residual = 4.25e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          5 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.9062e-02 is 1.189048e-02

solving harmonic davidson linear method for identity shift 1.5625e-01, overlap shift 1.5625e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.818899078670       residual = 6.02e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.819047835829       residual = 4.87e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.819066775697       residual = 1.82e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.819068881281       residual = 3.85e-08           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.819069001855       residual = 9.53e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          4 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.5625e-01 is 6.103574e-03

solving harmonic davidson linear method for identity shift 6.2500e-01, overlap shift 6.2500e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.818899078670       residual = 6.02e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.818961102096       residual = 2.12e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.818964233870       residual = 2.45e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.818964543777       residual = 2.01e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 6.2500e-01 is 2.104577e-03

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.249003 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.2320e+01
  </log>
  <optVariables href="FORM.s005.opt.xml">
ci_01                 1.271353e-01 3 1  ON 0
ci_02                -2.895937e-02 3 1  ON 1
ci_03                -2.856632e-02 3 1  ON 2
ci_04                 2.538905e-02 3 1  ON 3
ci_05                -2.395721e-02 3 1  ON 4
ci_06                -2.421595e-02 3 1  ON 5
ci_07                 2.510555e-02 3 1  ON 6
ci_08                -5.278321e-03 3 1  ON 7
ci_09                -1.199945e-02 3 1  ON 8
ci_10                -1.225650e-02 3 1  ON 9
ci_11                 1.533033e-02 3 1  ON 10
ci_12                 1.123169e-02 3 1  ON 11
ci_13                 1.260332e-02 3 1  ON 12
ci_14                 1.346922e-02 3 1  ON 13
ci_15                 8.993359e-03 3 1  ON 14
ci_16                 8.285967e-03 3 1  ON 15
ci_17                -1.033021e-02 3 1  ON 16
ci_18                -1.023119e-02 3 1  ON 17
ci_19                 8.716837e-03 3 1  ON 18
ci_20                 1.050458e-02 3 1  ON 19
ci_21                 8.761835e-03 3 1  ON 20
ci_22                 8.299230e-03 3 1  ON 21
ci_23                 5.972089e-03 3 1  ON 22
ci_24                 6.292412e-03 3 1  ON 23
ci_25                 4.506332e-03 3 1  ON 24
ci_26                 3.576525e-03 3 1  ON 25
ci_27                 2.639327e-03 3 1  ON 26
ci_28                 4.530743e-03 3 1  ON 27
ci_29                 4.732737e-03 3 1  ON 28
ci_30                -4.016591e-04 3 1  ON 29
ci_31                -1.204288e-03 3 1  ON 30
ci_32                 6.464680e-05 3 1  ON 31
ci_33                -6.243054e-04 3 1  ON 32
ci_34                 3.238587e-04 3 1  ON 33
ci_35                 8.372626e-04 3 1  ON 34
ci_36                -4.746269e-04 3 1  ON 35
ci_37                -8.250625e-04 3 1  ON 36
ci_38                -1.079346e-03 3 1  ON 37
ci_39                -2.275665e-04 3 1  ON 38
ci_40                -1.649689e-03 3 1  ON 39
ci_41                -2.348921e-05 3 1  ON 40
ci_42                 1.776196e-04 3 1  ON 41
ci_43                -2.329927e-03 3 1  ON 42
ci_44                -2.772256e-03 3 1  ON 43
ci_45                -7.015417e-05 3 1  ON 44
ci_46                -3.710103e-04 3 1  ON 45
ci_47                -1.958453e-03 3 1  ON 46
ci_48                 2.492167e-05 3 1  ON 47
ci_49                -1.527474e-03 3 1  ON 48
ci_50                -7.061118e-04 3 1  ON 49
ci_51                 3.116220e-04 3 1  ON 50
ci_52                 1.790976e-05 3 1  ON 51
ci_53                -9.715019e-04 3 1  ON 52
ci_54                -4.020626e-04 3 1  ON 53
ci_55                -1.216187e-03 3 1  ON 54
ci_56                 1.175850e-03 3 1  ON 55
ci_57                 1.046607e-03 3 1  ON 56
ci_58                -1.088102e-03 3 1  ON 57
ci_59                -1.887892e-03 3 1  ON 58
ci_60                 1.283679e-05 3 1  ON 59
ci_61                 1.370740e-03 3 1  ON 60
ci_62                 2.145685e-04 3 1  ON 61
ci_63                 7.739216e-05 3 1  ON 62
ci_64                 1.289640e-04 3 1  ON 63
ci_65                -1.229387e-03 3 1  ON 64
ci_66                -4.308514e-04 3 1  ON 65
ci_67                 1.965170e-04 3 1  ON 66
ci_68                -2.113216e-04 3 1  ON 67
ci_69                -3.619781e-04 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 5
    time step          = 0.05
    reference energy   = -22.885
    reference variance = 0.542369
====================================================
  Execution time = 2.5387e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s005
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2819e+01
  VMC Evar = 4.8628e-01
  Total weights = 1.9640e+06
  Execution time = 3.5564e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

ERROR CostFunction-> Number of Effective Walkers is too small! 
  Number of effective walkers (samples) / total number of samples = 0.067754
  User specified threshold minwalkers = 0.3
  If this message appears frequently. You might have to be cautious. 
  Find info about parameter "minwalkers" in the user manual!
Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.481683818487
                                         uncertainty =       0.007221912268

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.481683818487
                                         uncertainty =       0.007221912268

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000490789834
  error estimate for blocks of size 2^( 2) =       0.000512046922
  error estimate for blocks of size 2^( 3) =       0.000532112386
  error estimate for blocks of size 2^( 4) =       0.000547798784
  error estimate for blocks of size 2^( 5) =       0.000557291684
  error estimate for blocks of size 2^( 6) =       0.000564838940
  error estimate for blocks of size 2^( 7) =       0.000569828613

      target function =                  N/A
              le_mean =     -22.819197373536
             les_mean =     523.182680690990
             stat err =       0.000559939505
             autocorr =       1.301640647528
              std dev =       0.694081639207
             le_variance =       0.481749321885

ERROR CostFunction-> Number of Effective Walkers is too small! 
  Number of effective walkers (samples) / total number of samples = 0.162868
  User specified threshold minwalkers = 0.3
  If this message appears frequently. You might have to be cautious. 
  Find info about parameter "minwalkers" in the user manual!
Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.472688048202
                                         uncertainty =       0.002433963104

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.472688048202
                                         uncertainty =       0.002433963104

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000486197373
  error estimate for blocks of size 2^( 2) =       0.000507769803
  error estimate for blocks of size 2^( 3) =       0.000528170799
  error estimate for blocks of size 2^( 4) =       0.000544128654
  error estimate for blocks of size 2^( 5) =       0.000553824516
  error estimate for blocks of size 2^( 6) =       0.000561633490
  error estimate for blocks of size 2^( 7) =       0.000566644294

      target function =                  N/A
              le_mean =     -22.819119070397
             les_mean =     521.267362002524
             stat err =       0.000556557739
             autocorr =       1.310373902440
              std dev =       0.687586919446
             le_variance =       0.472775771793

ERROR CostFunction-> Number of Effective Walkers is too small! 
  Number of effective walkers (samples) / total number of samples = 0.0688142
  User specified threshold minwalkers = 0.3
  If this message appears frequently. You might have to be cautious. 
  Find info about parameter "minwalkers" in the user manual!
Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.476100724308
                                         uncertainty =       0.004122759095

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.476100724308
                                         uncertainty =       0.004122759095

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000487950997
  error estimate for blocks of size 2^( 2) =       0.000509541136
  error estimate for blocks of size 2^( 3) =       0.000529951771
  error estimate for blocks of size 2^( 4) =       0.000545905022
  error estimate for blocks of size 2^( 5) =       0.000555627926
  error estimate for blocks of size 2^( 6) =       0.000563560297
  error estimate for blocks of size 2^( 7) =       0.000568439133

      target function =                  N/A
              le_mean =     -22.819133130471
             les_mean =     522.010870840437
             stat err =       0.000558383095
             autocorr =       1.309519903467
              std dev =       0.690066917208
             le_variance =       0.476192350225

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.473973791389
                                         uncertainty =       0.002443574024

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.473973791389
                                         uncertainty =       0.002443574024

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000486850238
  error estimate for blocks of size 2^( 2) =       0.000508296590
  error estimate for blocks of size 2^( 3) =       0.000528499616
  error estimate for blocks of size 2^( 4) =       0.000544321912
  error estimate for blocks of size 2^( 5) =       0.000553900668
  error estimate for blocks of size 2^( 6) =       0.000561638096
  error estimate for blocks of size 2^( 7) =       0.000566651854

      target function =                  N/A
              le_mean =     -22.819108645533
             les_mean =     521.201796924969
             stat err =       0.000556628133
             autocorr =       1.307192450932
              std dev =       0.688510209518
             le_variance =       0.474046308611


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.819197373536        initial  <--
     3.9062e-02     3.9062e-01             1.1890e-02       -22.819119070397
     1.5625e-01     1.5625e+00             6.1036e-03       -22.819133130471
     6.2500e-01     6.2500e+00             2.1046e-03       -22.819108645533

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 43.2018
  </log>
  <optVariables href="FORM.s005.opt.xml">
ci_01                 1.332389e-01 3 1  ON 0
ci_02                -3.161241e-02 3 1  ON 1
ci_03                -3.134956e-02 3 1  ON 2
ci_04                 2.793250e-02 3 1  ON 3
ci_05                -2.514878e-02 3 1  ON 4
ci_06                -2.540216e-02 3 1  ON 5
ci_07                 2.614792e-02 3 1  ON 6
ci_08                -5.627889e-03 3 1  ON 7
ci_09                -1.213594e-02 3 1  ON 8
ci_10                -1.229484e-02 3 1  ON 9
ci_11                 1.481719e-02 3 1  ON 10
ci_12                 1.150738e-02 3 1  ON 11
ci_13                 1.256153e-02 3 1  ON 12
ci_14                 1.331866e-02 3 1  ON 13
ci_15                 9.036775e-03 3 1  ON 14
ci_16                 8.340861e-03 3 1  ON 15
ci_17                -1.064064e-02 3 1  ON 16
ci_18                -1.079949e-02 3 1  ON 17
ci_19                 9.441739e-03 3 1  ON 18
ci_20                 1.081383e-02 3 1  ON 19
ci_21                 8.787127e-03 3 1  ON 20
ci_22                 8.552740e-03 3 1  ON 21
ci_23                 6.615583e-03 3 1  ON 22
ci_24                 6.041436e-03 3 1  ON 23
ci_25                 5.218855e-03 3 1  ON 24
ci_26                 3.284912e-03 3 1  ON 25
ci_27                 3.041378e-03 3 1  ON 26
ci_28                 4.922016e-03 3 1  ON 27
ci_29                 4.385118e-03 3 1  ON 28
ci_30                -1.385217e-03 3 1  ON 29
ci_31                -1.202597e-03 3 1  ON 30
ci_32                -3.815387e-04 3 1  ON 31
ci_33                -1.353924e-03 3 1  ON 32
ci_34                 6.754854e-04 3 1  ON 33
ci_35                 9.162017e-04 3 1  ON 34
ci_36                -1.071148e-03 3 1  ON 35
ci_37                -6.166085e-04 3 1  ON 36
ci_38                -3.399237e-04 3 1  ON 37
ci_39                -7.564774e-04 3 1  ON 38
ci_40                -1.222988e-03 3 1  ON 39
ci_41                 3.332609e-04 3 1  ON 40
ci_42                -1.235546e-04 3 1  ON 41
ci_43                -2.692050e-03 3 1  ON 42
ci_44                -2.472572e-03 3 1  ON 43
ci_45                -5.990693e-04 3 1  ON 44
ci_46                -1.096822e-04 3 1  ON 45
ci_47                -1.642701e-03 3 1  ON 46
ci_48                -1.401946e-03 3 1  ON 47
ci_49                -1.358584e-03 3 1  ON 48
ci_50                -3.674154e-04 3 1  ON 49
ci_51                 3.969379e-04 3 1  ON 50
ci_52                 2.646377e-04 3 1  ON 51
ci_53                -1.172159e-03 3 1  ON 52
ci_54                -8.492720e-04 3 1  ON 53
ci_55                -1.241267e-03 3 1  ON 54
ci_56                 1.356890e-03 3 1  ON 55
ci_57                 8.615262e-04 3 1  ON 56
ci_58                -1.391271e-03 3 1  ON 57
ci_59                -1.899054e-03 3 1  ON 58
ci_60                 3.278159e-04 3 1  ON 59
ci_61                 1.238925e-03 3 1  ON 60
ci_62                -6.860629e-04 3 1  ON 61
ci_63                -7.090515e-05 3 1  ON 62
ci_64                -9.585153e-05 3 1  ON 63
ci_65                -1.098311e-03 3 1  ON 64
ci_66                -1.021253e-03 3 1  ON 65
ci_67                -2.320077e-04 3 1  ON 66
ci_68                -9.597601e-04 3 1  ON 67
ci_69                -2.206474e-04 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.5532e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s006 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s006 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=6  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2849e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 6
    time step          = 0.05
    reference energy   = -22.8117
    reference variance = 0.48987
====================================================
  Execution time = 2.5858e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s006
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5319e+04
  VMC Eavg = -2.2819e+01
  VMC Evar = 4.9443e-01
  Total weights = 1.963252163e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.5884e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.478774984214
                                         uncertainty =       0.003973425701

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.478774984214
                                         uncertainty =       0.003973425701

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000489322079
  error estimate for blocks of size 2^( 2) =       0.000510396203
  error estimate for blocks of size 2^( 3) =       0.000530290750
  error estimate for blocks of size 2^( 4) =       0.000545278693
  error estimate for blocks of size 2^( 5) =       0.000555526131
  error estimate for blocks of size 2^( 6) =       0.000560983148
  error estimate for blocks of size 2^( 7) =       0.000563152784

      target function =                  N/A
              le_mean =     -22.818997081681
             les_mean =     521.201053877094
             stat err =       0.000556235189
             autocorr =       1.292192734330
              std dev =       0.692005921151
             le_variance =       0.478872194908


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281899708168e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.9062e-01, overlap shift 3.9062e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.818997081611       residual = 6.04e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.819108540236       residual = 2.70e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.819116032048       residual = 4.35e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.819116365503       residual = 5.92e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.9062e-01 is 2.775670e-03

solving harmonic davidson linear method for identity shift 1.5625e+00, overlap shift 1.5625e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.818997081611       residual = 6.04e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.819033614948       residual = 1.58e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.819035355859       residual = 1.92e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.819035418913       residual = 3.32e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.5625e+00 is 8.126208e-04

solving harmonic davidson linear method for identity shift 6.2500e+00, overlap shift 6.2500e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.818997081611       residual = 6.04e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.819006985157       residual = 1.44e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.819007423805       residual = 2.57e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.819007439393       residual = 5.55e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 6.2500e+00 is 2.124497e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.253407 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0462e+01
  </log>
  <optVariables href="FORM.s006.opt.xml">
ci_01                 1.324263e-01 3 1  ON 0
ci_02                -3.106396e-02 3 1  ON 1
ci_03                -3.083089e-02 3 1  ON 2
ci_04                 2.747689e-02 3 1  ON 3
ci_05                -2.487753e-02 3 1  ON 4
ci_06                -2.511518e-02 3 1  ON 5
ci_07                 2.598974e-02 3 1  ON 6
ci_08                -5.417707e-03 3 1  ON 7
ci_09                -1.209044e-02 3 1  ON 8
ci_10                -1.217992e-02 3 1  ON 9
ci_11                 1.487263e-02 3 1  ON 10
ci_12                 1.129389e-02 3 1  ON 11
ci_13                 1.244331e-02 3 1  ON 12
ci_14                 1.331688e-02 3 1  ON 13
ci_15                 8.855685e-03 3 1  ON 14
ci_16                 8.092507e-03 3 1  ON 15
ci_17                -1.050948e-02 3 1  ON 16
ci_18                -1.068348e-02 3 1  ON 17
ci_19                 9.406692e-03 3 1  ON 18
ci_20                 1.077262e-02 3 1  ON 19
ci_21                 8.765184e-03 3 1  ON 20
ci_22                 8.479530e-03 3 1  ON 21
ci_23                 6.469816e-03 3 1  ON 22
ci_24                 6.241203e-03 3 1  ON 23
ci_25                 5.098758e-03 3 1  ON 24
ci_26                 3.232802e-03 3 1  ON 25
ci_27                 2.887533e-03 3 1  ON 26
ci_28                 4.804191e-03 3 1  ON 27
ci_29                 4.388493e-03 3 1  ON 28
ci_30                -1.267251e-03 3 1  ON 29
ci_31                -1.071600e-03 3 1  ON 30
ci_32                -2.955400e-04 3 1  ON 31
ci_33                -1.185670e-03 3 1  ON 32
ci_34                 6.279533e-04 3 1  ON 33
ci_35                 9.737533e-04 3 1  ON 34
ci_36                -1.017403e-03 3 1  ON 35
ci_37                -6.258551e-04 3 1  ON 36
ci_38                -2.837635e-04 3 1  ON 37
ci_39                -6.657988e-04 3 1  ON 38
ci_40                -1.375452e-03 3 1  ON 39
ci_41                 5.330582e-04 3 1  ON 40
ci_42                -4.744950e-05 3 1  ON 41
ci_43                -2.692302e-03 3 1  ON 42
ci_44                -2.487498e-03 3 1  ON 43
ci_45                -5.198154e-04 3 1  ON 44
ci_46                -1.509891e-04 3 1  ON 45
ci_47                -1.689034e-03 3 1  ON 46
ci_48                -1.378306e-03 3 1  ON 47
ci_49                -1.342971e-03 3 1  ON 48
ci_50                -4.716865e-04 3 1  ON 49
ci_51                 3.744072e-04 3 1  ON 50
ci_52                 1.961747e-04 3 1  ON 51
ci_53                -1.079280e-03 3 1  ON 52
ci_54                -7.950629e-04 3 1  ON 53
ci_55                -1.277908e-03 3 1  ON 54
ci_56                 1.360512e-03 3 1  ON 55
ci_57                 8.669145e-04 3 1  ON 56
ci_58                -1.411455e-03 3 1  ON 57
ci_59                -1.868848e-03 3 1  ON 58
ci_60                 3.524995e-04 3 1  ON 59
ci_61                 1.293627e-03 3 1  ON 60
ci_62                -5.448794e-04 3 1  ON 61
ci_63                -7.325739e-05 3 1  ON 62
ci_64                -3.990369e-05 3 1  ON 63
ci_65                -1.071398e-03 3 1  ON 64
ci_66                -9.851328e-04 3 1  ON 65
ci_67                -3.040983e-04 3 1  ON 66
ci_68                -1.021044e-03 3 1  ON 67
ci_69                -4.508292e-04 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 6
    time step          = 0.05
    reference energy   = -22.865
    reference variance = 0.764314
====================================================
  Execution time = 2.5326e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s006
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2819e+01
  VMC Evar = 4.8901e-01
  Total weights = 1.9637e+06
  Execution time = 3.5666e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.473260001048
                                         uncertainty =       0.002321458323

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.473260001048
                                         uncertainty =       0.002321458323

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000486502964
  error estimate for blocks of size 2^( 2) =       0.000507866334
  error estimate for blocks of size 2^( 3) =       0.000528194228
  error estimate for blocks of size 2^( 4) =       0.000543886352
  error estimate for blocks of size 2^( 5) =       0.000553295542
  error estimate for blocks of size 2^( 6) =       0.000558081237
  error estimate for blocks of size 2^( 7) =       0.000560091135

      target function =                  N/A
              le_mean =     -22.819267923171
             les_mean =     521.209751137837
             stat err =       0.000553838566
             autocorr =       1.295971370378
              std dev =       0.688019090164
             le_variance =       0.473370268430

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.472436482014
                                         uncertainty =       0.002299750876

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.472436482014
                                         uncertainty =       0.002299750876

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000486079633
  error estimate for blocks of size 2^( 2) =       0.000507502754
  error estimate for blocks of size 2^( 3) =       0.000527901098
  error estimate for blocks of size 2^( 4) =       0.000543682242
  error estimate for blocks of size 2^( 5) =       0.000553126300
  error estimate for blocks of size 2^( 6) =       0.000557907871
  error estimate for blocks of size 2^( 7) =       0.000559891455

      target function =                  N/A
              le_mean =     -22.819296037684
             les_mean =     521.211160433387
             stat err =       0.000553651967
             autocorr =       1.297355047644
              std dev =       0.687420409150
             le_variance =       0.472546818915

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.472673770905
                                         uncertainty =       0.002307390735

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.472673770905
                                         uncertainty =       0.002307390735

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000486201728
  error estimate for blocks of size 2^( 2) =       0.000507604483
  error estimate for blocks of size 2^( 3) =       0.000527978861
  error estimate for blocks of size 2^( 4) =       0.000543725576
  error estimate for blocks of size 2^( 5) =       0.000553156563
  error estimate for blocks of size 2^( 6) =       0.000557942681
  error estimate for blocks of size 2^( 7) =       0.000559939236

      target function =                  N/A
              le_mean =     -22.819277676383
             les_mean =     521.209321253607
             stat err =       0.000553691014
             autocorr =       1.296886455752
              std dev =       0.687593077524
             le_variance =       0.472784240259

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.473170596311
                                         uncertainty =       0.002319182202

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.473170596311
                                         uncertainty =       0.002319182202

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000486457038
  error estimate for blocks of size 2^( 2) =       0.000507823207
  error estimate for blocks of size 2^( 3) =       0.000528156681
  error estimate for blocks of size 2^( 4) =       0.000543856719
  error estimate for blocks of size 2^( 5) =       0.000553268709
  error estimate for blocks of size 2^( 6) =       0.000558053070
  error estimate for blocks of size 2^( 7) =       0.000560063467

      target function =                  N/A
              le_mean =     -22.819268882308
             les_mean =     521.212518120256
             stat err =       0.000553810491
             autocorr =       1.296084672974
              std dev =       0.687954140648
             le_variance =       0.473280899634


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.819267923171        initial
     3.9062e-01     3.9062e+00             2.7757e-03       -22.819296037684  <--
     1.5625e+00     1.5625e+01             8.1262e-04       -22.819277676383
     6.2500e+00     6.2500e+01             2.1245e-04       -22.819268882308

*****************************************************************************
Applying the update for shift_i =   3.9062e-01     and shift_s =   3.9062e+00
*****************************************************************************

  Execution time = 4.3223e+01
  </log>
  <optVariables href="FORM.s006.opt.xml">
ci_01                 1.304632e-01 3 1  ON 0
ci_02                -2.992050e-02 3 1  ON 1
ci_03                -2.975335e-02 3 1  ON 2
ci_04                 2.668184e-02 3 1  ON 3
ci_05                -2.434733e-02 3 1  ON 4
ci_06                -2.456377e-02 3 1  ON 5
ci_07                 2.566226e-02 3 1  ON 6
ci_08                -5.022146e-03 3 1  ON 7
ci_09                -1.200326e-02 3 1  ON 8
ci_10                -1.193830e-02 3 1  ON 9
ci_11                 1.501726e-02 3 1  ON 10
ci_12                 1.087746e-02 3 1  ON 11
ci_13                 1.219721e-02 3 1  ON 12
ci_14                 1.333434e-02 3 1  ON 13
ci_15                 8.472254e-03 3 1  ON 14
ci_16                 7.562609e-03 3 1  ON 15
ci_17                -1.021196e-02 3 1  ON 16
ci_18                -1.042555e-02 3 1  ON 17
ci_19                 9.366159e-03 3 1  ON 18
ci_20                 1.069345e-02 3 1  ON 19
ci_21                 8.692534e-03 3 1  ON 20
ci_22                 8.294868e-03 3 1  ON 21
ci_23                 6.225654e-03 3 1  ON 22
ci_24                 6.715254e-03 3 1  ON 23
ci_25                 4.875734e-03 3 1  ON 24
ci_26                 3.133383e-03 3 1  ON 25
ci_27                 2.571451e-03 3 1  ON 26
ci_28                 4.526284e-03 3 1  ON 27
ci_29                 4.363479e-03 3 1  ON 28
ci_30                -9.992393e-04 3 1  ON 29
ci_31                -7.680750e-04 3 1  ON 30
ci_32                -1.704872e-04 3 1  ON 31
ci_33                -9.071766e-04 3 1  ON 32
ci_34                 5.711472e-04 3 1  ON 33
ci_35                 1.140532e-03 3 1  ON 34
ci_36                -9.134281e-04 3 1  ON 35
ci_37                -6.391261e-04 3 1  ON 36
ci_38                -1.860172e-04 3 1  ON 37
ci_39                -4.924526e-04 3 1  ON 38
ci_40                -1.608198e-03 3 1  ON 39
ci_41                 8.740286e-04 3 1  ON 40
ci_42                 6.026252e-05 3 1  ON 41
ci_43                -2.672394e-03 3 1  ON 42
ci_44                -2.503366e-03 3 1  ON 43
ci_45                -3.744068e-04 3 1  ON 44
ci_46                -2.212421e-04 3 1  ON 45
ci_47                -1.757087e-03 3 1  ON 46
ci_48                -1.299656e-03 3 1  ON 47
ci_49                -1.308360e-03 3 1  ON 48
ci_50                -6.282432e-04 3 1  ON 49
ci_51                 3.293665e-04 3 1  ON 50
ci_52                 6.358694e-05 3 1  ON 51
ci_53                -9.236886e-04 3 1  ON 52
ci_54                -6.833493e-04 3 1  ON 53
ci_55                -1.355163e-03 3 1  ON 54
ci_56                 1.383186e-03 3 1  ON 55
ci_57                 8.816965e-04 3 1  ON 56
ci_58                -1.455881e-03 3 1  ON 57
ci_59                -1.810869e-03 3 1  ON 58
ci_60                 4.121386e-04 3 1  ON 59
ci_61                 1.430605e-03 3 1  ON 60
ci_62                -3.037827e-04 3 1  ON 61
ci_63                -7.135187e-05 3 1  ON 62
ci_64                 6.787868e-05 3 1  ON 63
ci_65                -1.015759e-03 3 1  ON 64
ci_66                -9.095841e-04 3 1  ON 65
ci_67                -4.242474e-04 3 1  ON 66
ci_68                -1.141534e-03 3 1  ON 67
ci_69                -9.076567e-04 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.3701e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s007 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s007 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=7  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2848e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 7
    time step          = 0.05
    reference energy   = -22.8504
    reference variance = 0.38502
====================================================
  Execution time = 2.5877e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s007
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5331e+04
  VMC Eavg = -2.2819e+01
  VMC Evar = 4.8416e-01
  Total weights = 1.963949327e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.6087e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.469955471853
                                         uncertainty =       0.002204162936

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.469955471853
                                         uncertainty =       0.002204162936

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000484749090
  error estimate for blocks of size 2^( 2) =       0.000505989242
  error estimate for blocks of size 2^( 3) =       0.000525633715
  error estimate for blocks of size 2^( 4) =       0.000540389596
  error estimate for blocks of size 2^( 5) =       0.000550210355
  error estimate for blocks of size 2^( 6) =       0.000554749038
  error estimate for blocks of size 2^( 7) =       0.000555888243

      target function =                  N/A
              le_mean =     -22.819162286879
             les_mean =     521.198323847615
             stat err =       0.000550309308
             autocorr =       1.288782742925
              std dev =       0.685538737386
             le_variance =       0.469963360456


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281916228688e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.7656e-02, overlap shift 9.7656e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.819162286797       residual = 3.91e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.819274110617       residual = 3.05e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.819291687887       residual = 1.47e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.819295032574       residual = 5.64e-08           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.819294866156       residual = 3.25e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          4 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.7656e-02 is 6.172744e-03

solving harmonic davidson linear method for identity shift 3.9062e-01, overlap shift 3.9062e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.819162286797       residual = 3.91e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.819215413352       residual = 1.28e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.819218434916       residual = 1.97e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.819218861866       residual = 4.59e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.9062e-01 is 2.397775e-03

solving harmonic davidson linear method for identity shift 1.5625e+00, overlap shift 1.5625e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.819162286797       residual = 3.91e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.819179426245       residual = 9.68e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.819179758459       residual = 1.58e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.819179835443       residual = 3.57e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.5625e+00 is 7.029951e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.258029 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0502e+01
  </log>
  <optVariables href="FORM.s007.opt.xml">
ci_01                 1.280655e-01 3 1  ON 0
ci_02                -2.899760e-02 3 1  ON 1
ci_03                -2.821541e-02 3 1  ON 2
ci_04                 2.576201e-02 3 1  ON 3
ci_05                -2.367988e-02 3 1  ON 4
ci_06                -2.390321e-02 3 1  ON 5
ci_07                 2.541622e-02 3 1  ON 6
ci_08                -5.352656e-03 3 1  ON 7
ci_09                -1.164256e-02 3 1  ON 8
ci_10                -1.222407e-02 3 1  ON 9
ci_11                 1.504863e-02 3 1  ON 10
ci_12                 1.094997e-02 3 1  ON 11
ci_13                 1.191958e-02 3 1  ON 12
ci_14                 1.370466e-02 3 1  ON 13
ci_15                 8.218434e-03 3 1  ON 14
ci_16                 7.919043e-03 3 1  ON 15
ci_17                -1.009671e-02 3 1  ON 16
ci_18                -1.033739e-02 3 1  ON 17
ci_19                 9.416763e-03 3 1  ON 18
ci_20                 1.061646e-02 3 1  ON 19
ci_21                 8.182998e-03 3 1  ON 20
ci_22                 8.240630e-03 3 1  ON 21
ci_23                 6.233439e-03 3 1  ON 22
ci_24                 7.086922e-03 3 1  ON 23
ci_25                 4.942198e-03 3 1  ON 24
ci_26                 3.011695e-03 3 1  ON 25
ci_27                 1.910436e-03 3 1  ON 26
ci_28                 4.384300e-03 3 1  ON 27
ci_29                 3.943986e-03 3 1  ON 28
ci_30                -4.346048e-04 3 1  ON 29
ci_31                -4.673599e-04 3 1  ON 30
ci_32                -1.829392e-04 3 1  ON 31
ci_33                -7.568752e-04 3 1  ON 32
ci_34                 2.485216e-04 3 1  ON 33
ci_35                 6.778091e-04 3 1  ON 34
ci_36                -1.112459e-03 3 1  ON 35
ci_37                -8.676428e-04 3 1  ON 36
ci_38                -1.127475e-04 3 1  ON 37
ci_39                -2.375932e-04 3 1  ON 38
ci_40                -1.506629e-03 3 1  ON 39
ci_41                 4.629084e-04 3 1  ON 40
ci_42                 5.688978e-04 3 1  ON 41
ci_43                -2.707509e-03 3 1  ON 42
ci_44                -2.160903e-03 3 1  ON 43
ci_45                -7.972192e-05 3 1  ON 44
ci_46                -1.812245e-04 3 1  ON 45
ci_47                -1.938516e-03 3 1  ON 46
ci_48                -1.024382e-03 3 1  ON 47
ci_49                -1.322951e-03 3 1  ON 48
ci_50                -5.999869e-04 3 1  ON 49
ci_51                 7.404669e-05 3 1  ON 50
ci_52                 1.150449e-04 3 1  ON 51
ci_53                -8.891550e-04 3 1  ON 52
ci_54                -7.117582e-04 3 1  ON 53
ci_55                -1.127772e-03 3 1  ON 54
ci_56                 1.517185e-03 3 1  ON 55
ci_57                 1.307471e-03 3 1  ON 56
ci_58                -1.267658e-03 3 1  ON 57
ci_59                -1.986596e-03 3 1  ON 58
ci_60                 5.541136e-04 3 1  ON 59
ci_61                 1.525916e-03 3 1  ON 60
ci_62                -4.287059e-05 3 1  ON 61
ci_63                -3.446502e-04 3 1  ON 62
ci_64                -7.479551e-05 3 1  ON 63
ci_65                -4.087321e-04 3 1  ON 64
ci_66                -5.279913e-04 3 1  ON 65
ci_67                -4.139718e-04 3 1  ON 66
ci_68                -1.185289e-03 3 1  ON 67
ci_69                -7.197343e-04 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 7
    time step          = 0.05
    reference energy   = -22.7768
    reference variance = 0.35812
====================================================
  Execution time = 2.5294e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s007
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2819e+01
  VMC Evar = 4.9204e-01
  Total weights = 1.9636e+06
  Execution time = 3.5548e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.475608141680
                                         uncertainty =       0.002539329436

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.475608141680
                                         uncertainty =       0.002539329436

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000487639738
  error estimate for blocks of size 2^( 2) =       0.000508613708
  error estimate for blocks of size 2^( 3) =       0.000528488338
  error estimate for blocks of size 2^( 4) =       0.000543538108
  error estimate for blocks of size 2^( 5) =       0.000550851330
  error estimate for blocks of size 2^( 6) =       0.000555916067
  error estimate for blocks of size 2^( 7) =       0.000558480462

      target function =                  N/A
              le_mean =     -22.819143899222
             les_mean =     521.228091858305
             stat err =       0.000552196492
             autocorr =       1.282298420906
              std dev =       0.689626731201
             le_variance =       0.475585028388

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.475729455517
                                         uncertainty =       0.002707085965

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.475729455517
                                         uncertainty =       0.002707085965

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000487701530
  error estimate for blocks of size 2^( 2) =       0.000508759017
  error estimate for blocks of size 2^( 3) =       0.000528779468
  error estimate for blocks of size 2^( 4) =       0.000543936476
  error estimate for blocks of size 2^( 5) =       0.000551335616
  error estimate for blocks of size 2^( 6) =       0.000556405836
  error estimate for blocks of size 2^( 7) =       0.000559124180

      target function =                  N/A
              le_mean =     -22.819143971416
             les_mean =     521.284804606895
             stat err =       0.000552700527
             autocorr =       1.284314903525
              std dev =       0.689714117723
             le_variance =       0.475705564187

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.475194301211
                                         uncertainty =       0.002633473872

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.475194301211
                                         uncertainty =       0.002633473872

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000487427716
  error estimate for blocks of size 2^( 2) =       0.000508502341
  error estimate for blocks of size 2^( 3) =       0.000528508422
  error estimate for blocks of size 2^( 4) =       0.000543680821
  error estimate for blocks of size 2^( 5) =       0.000551064953
  error estimate for blocks of size 2^( 6) =       0.000556177840
  error estimate for blocks of size 2^( 7) =       0.000558841447

      target function =                  N/A
              le_mean =     -22.819133728789
             les_mean =     521.352186740954
             stat err =       0.000552441265
             autocorr =       1.284552273231
              std dev =       0.689326886650
             le_variance =       0.475171556659

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.475570569141
                                         uncertainty =       0.002550228898

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.475570569141
                                         uncertainty =       0.002550228898

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000487620388
  error estimate for blocks of size 2^( 2) =       0.000508619161
  error estimate for blocks of size 2^( 3) =       0.000528514690
  error estimate for blocks of size 2^( 4) =       0.000543584090
  error estimate for blocks of size 2^( 5) =       0.000550885186
  error estimate for blocks of size 2^( 6) =       0.000555976996
  error estimate for blocks of size 2^( 7) =       0.000558581118

      target function =                  N/A
              le_mean =     -22.819122650246
             les_mean =     521.387876290473
             stat err =       0.000552256847
             autocorr =       1.282680544333
              std dev =       0.689599365753
             le_variance =       0.475547285246


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.819143899222        initial
     9.7656e-02     9.7656e-01             6.1727e-03       -22.819143971416  <--
     3.9062e-01     3.9062e+00             2.3978e-03       -22.819133728789
     1.5625e+00     1.5625e+01             7.0300e-04       -22.819122650246

*****************************************************************************
Applying the update for shift_i =   9.7656e-02     and shift_s =   9.7656e-01
*****************************************************************************

  Execution time = 4.3129e+01
  </log>
  <optVariables href="FORM.s007.opt.xml">
ci_01                 1.242905e-01 3 1  ON 0
ci_02                -2.809406e-02 3 1  ON 1
ci_03                -2.658327e-02 3 1  ON 2
ci_04                 2.501838e-02 3 1  ON 3
ci_05                -2.313882e-02 3 1  ON 4
ci_06                -2.333715e-02 3 1  ON 5
ci_07                 2.510857e-02 3 1  ON 6
ci_08                -5.515267e-03 3 1  ON 7
ci_09                -1.123640e-02 3 1  ON 8
ci_10                -1.256650e-02 3 1  ON 9
ci_11                 1.518423e-02 3 1  ON 10
ci_12                 1.104373e-02 3 1  ON 11
ci_13                 1.160319e-02 3 1  ON 12
ci_14                 1.444037e-02 3 1  ON 13
ci_15                 7.988413e-03 3 1  ON 14
ci_16                 8.285460e-03 3 1  ON 15
ci_17                -9.953170e-03 3 1  ON 16
ci_18                -1.020841e-02 3 1  ON 17
ci_19                 9.443127e-03 3 1  ON 18
ci_20                 1.050815e-02 3 1  ON 19
ci_21                 7.438745e-03 3 1  ON 20
ci_22                 8.172794e-03 3 1  ON 21
ci_23                 6.229158e-03 3 1  ON 22
ci_24                 7.655993e-03 3 1  ON 23
ci_25                 5.004398e-03 3 1  ON 24
ci_26                 2.838829e-03 3 1  ON 25
ci_27                 1.246833e-03 3 1  ON 26
ci_28                 4.181750e-03 3 1  ON 27
ci_29                 3.436023e-03 3 1  ON 28
ci_30                 3.676604e-04 3 1  ON 29
ci_31                -1.125605e-04 3 1  ON 30
ci_32                -1.958580e-04 3 1  ON 31
ci_33                -6.773139e-04 3 1  ON 32
ci_34                 6.865710e-06 3 1  ON 33
ci_35                 2.654640e-04 3 1  ON 34
ci_36                -1.260253e-03 3 1  ON 35
ci_37                -1.042735e-03 3 1  ON 36
ci_38                -4.164396e-05 3 1  ON 37
ci_39                -2.093512e-06 3 1  ON 38
ci_40                -1.428574e-03 3 1  ON 39
ci_41                 6.326878e-05 3 1  ON 40
ci_42                 9.918412e-04 3 1  ON 41
ci_43                -2.701658e-03 3 1  ON 42
ci_44                -1.732659e-03 3 1  ON 43
ci_45                 1.686085e-04 3 1  ON 44
ci_46                -1.336303e-04 3 1  ON 45
ci_47                -2.142988e-03 3 1  ON 46
ci_48                -5.738762e-04 3 1  ON 47
ci_49                -1.346932e-03 3 1  ON 48
ci_50                -5.678425e-04 3 1  ON 49
ci_51                -1.572939e-04 3 1  ON 50
ci_52                 1.436753e-04 3 1  ON 51
ci_53                -8.526989e-04 3 1  ON 52
ci_54                -7.782706e-04 3 1  ON 53
ci_55                -9.221832e-04 3 1  ON 54
ci_56                 1.604432e-03 3 1  ON 55
ci_57                 1.664531e-03 3 1  ON 56
ci_58                -1.085758e-03 3 1  ON 57
ci_59                -2.166585e-03 3 1  ON 58
ci_60                 8.221423e-04 3 1  ON 59
ci_61                 1.713541e-03 3 1  ON 60
ci_62                 1.498138e-04 3 1  ON 61
ci_63                -5.379261e-04 3 1  ON 62
ci_64                -2.170461e-04 3 1  ON 63
ci_65                 1.751973e-04 3 1  ON 64
ci_66                -1.823586e-04 3 1  ON 65
ci_67                -4.050576e-04 3 1  ON 66
ci_68                -1.271608e-03 3 1  ON 67
ci_69                -5.372493e-04 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.3645e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s008 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s008 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=8  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2843e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 8
    time step          = 0.05
    reference energy   = -22.9068
    reference variance = 0.519436
====================================================
  Execution time = 2.5930e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s008
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5340e+04
  VMC Eavg = -2.2819e+01
  VMC Evar = 4.8001e-01
  Total weights = 1.963502499e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.5496e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.466330843665
                                         uncertainty =       0.001787057492

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.466330843665
                                         uncertainty =       0.001787057492

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000482973958
  error estimate for blocks of size 2^( 2) =       0.000504736453
  error estimate for blocks of size 2^( 3) =       0.000525394341
  error estimate for blocks of size 2^( 4) =       0.000541964503
  error estimate for blocks of size 2^( 5) =       0.000551769600
  error estimate for blocks of size 2^( 6) =       0.000557704358
  error estimate for blocks of size 2^( 7) =       0.000560611003

      target function =                  N/A
              le_mean =     -22.819297480189
             les_mean =     521.200349699674
             stat err =       0.000553012366
             autocorr =       1.311059066090
              std dev =       0.683028321089
             le_variance =       0.466527687410


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281929748019e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.4414e-02, overlap shift 2.4414e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.819297480103       residual = 2.29e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.819365541227       residual = 3.82e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.819378288540       residual = 5.30e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.819381778714       residual = 6.48e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.819383661229       residual = 7.14e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.819383977679       residual = 9.74e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          5 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.4414e-02 is 7.729727e-03

solving harmonic davidson linear method for identity shift 9.7656e-02, overlap shift 9.7656e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.819297480103       residual = 2.29e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.819346361101       residual = 1.95e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.819351428318       residual = 1.30e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.819352324746       residual = 7.05e-08           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.819352753522       residual = 3.99e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          4 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.7656e-02 is 4.480154e-03

solving harmonic davidson linear method for identity shift 3.9062e-01, overlap shift 3.9062e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.819297480103       residual = 2.29e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.819320458627       residual = 5.13e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.819321495810       residual = 1.31e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.819321527500       residual = 2.60e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.9062e-01 is 1.684725e-03

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.263004 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0497e+01
  </log>
  <optVariables href="FORM.s008.opt.xml">
ci_01                 1.198104e-01 3 1  ON 0
ci_02                -2.654272e-02 3 1  ON 1
ci_03                -2.600800e-02 3 1  ON 2
ci_04                 2.511855e-02 3 1  ON 3
ci_05                -2.350343e-02 3 1  ON 4
ci_06                -2.341505e-02 3 1  ON 5
ci_07                 2.499661e-02 3 1  ON 6
ci_08                -4.589267e-03 3 1  ON 7
ci_09                -1.120241e-02 3 1  ON 8
ci_10                -1.258592e-02 3 1  ON 9
ci_11                 1.472776e-02 3 1  ON 10
ci_12                 1.114986e-02 3 1  ON 11
ci_13                 1.196721e-02 3 1  ON 12
ci_14                 1.523252e-02 3 1  ON 13
ci_15                 7.012384e-03 3 1  ON 14
ci_16                 9.159063e-03 3 1  ON 15
ci_17                -1.049258e-02 3 1  ON 16
ci_18                -1.089000e-02 3 1  ON 17
ci_19                 9.308671e-03 3 1  ON 18
ci_20                 1.032786e-02 3 1  ON 19
ci_21                 7.971005e-03 3 1  ON 20
ci_22                 9.146389e-03 3 1  ON 21
ci_23                 6.092691e-03 3 1  ON 22
ci_24                 7.400638e-03 3 1  ON 23
ci_25                 4.858312e-03 3 1  ON 24
ci_26                 2.283663e-03 3 1  ON 25
ci_27                 3.347381e-03 3 1  ON 26
ci_28                 3.870894e-03 3 1  ON 27
ci_29                 3.455630e-03 3 1  ON 28
ci_30                 2.011317e-04 3 1  ON 29
ci_31                -1.916355e-04 3 1  ON 30
ci_32                -1.671802e-04 3 1  ON 31
ci_33                 3.148755e-05 3 1  ON 32
ci_34                 5.561949e-04 3 1  ON 33
ci_35                 6.409853e-04 3 1  ON 34
ci_36                -6.416745e-04 3 1  ON 35
ci_37                -1.012235e-03 3 1  ON 36
ci_38                -3.750765e-04 3 1  ON 37
ci_39                -4.549170e-04 3 1  ON 38
ci_40                -1.059453e-03 3 1  ON 39
ci_41                -9.916078e-05 3 1  ON 40
ci_42                 8.721143e-04 3 1  ON 41
ci_43                -2.686144e-03 3 1  ON 42
ci_44                -2.429686e-03 3 1  ON 43
ci_45                -2.003759e-04 3 1  ON 44
ci_46                -1.018051e-03 3 1  ON 45
ci_47                -1.519295e-03 3 1  ON 46
ci_48                 4.617399e-05 3 1  ON 47
ci_49                -1.597044e-03 3 1  ON 48
ci_50                -4.197590e-04 3 1  ON 49
ci_51                -6.146654e-04 3 1  ON 50
ci_52                 2.237506e-04 3 1  ON 51
ci_53                -4.970069e-04 3 1  ON 52
ci_54                -1.453262e-03 3 1  ON 53
ci_55                -6.823407e-04 3 1  ON 54
ci_56                 1.867759e-03 3 1  ON 55
ci_57                 1.736121e-03 3 1  ON 56
ci_58                -6.653556e-04 3 1  ON 57
ci_59                -1.515729e-03 3 1  ON 58
ci_60                 6.525541e-04 3 1  ON 59
ci_61                 3.196351e-03 3 1  ON 60
ci_62                -2.672323e-04 3 1  ON 61
ci_63                -3.596840e-04 3 1  ON 62
ci_64                -1.082899e-03 3 1  ON 63
ci_65                 5.830418e-05 3 1  ON 64
ci_66                -5.005177e-04 3 1  ON 65
ci_67                -2.470771e-04 3 1  ON 66
ci_68                -1.520626e-03 3 1  ON 67
ci_69                -9.887699e-04 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 8
    time step          = 0.05
    reference energy   = -22.6916
    reference variance = 1.08288
====================================================
  Execution time = 2.5275e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s008
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2819e+01
  VMC Evar = 4.8637e-01
  Total weights = 1.9637e+06
  Execution time = 3.5710e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

ERROR CostFunction-> Number of Effective Walkers is too small! 
  Number of effective walkers (samples) / total number of samples = 0.00121498
  User specified threshold minwalkers = 0.3
  If this message appears frequently. You might have to be cautious. 
  Find info about parameter "minwalkers" in the user manual!
Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.575549740374
                                         uncertainty =       0.102546252441

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.575549740374
                                         uncertainty =       0.102546252441

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000536561126
  error estimate for blocks of size 2^( 2) =       0.000555765160
  error estimate for blocks of size 2^( 3) =       0.000574362850
  error estimate for blocks of size 2^( 4) =       0.000587956188
  error estimate for blocks of size 2^( 5) =       0.000596661872
  error estimate for blocks of size 2^( 6) =       0.000600703371
  error estimate for blocks of size 2^( 7) =       0.000602814996

      target function =                  N/A
              le_mean =     -22.819233565335
             les_mean =     569.279834240172
             stat err =       0.000597034107
             autocorr =       1.238111831905
              std dev =       0.758812021656
             le_variance =       0.575795684210

ERROR CostFunction-> Number of Effective Walkers is too small! 
  Number of effective walkers (samples) / total number of samples = 0.0105031
  User specified threshold minwalkers = 0.3
  If this message appears frequently. You might have to be cautious. 
  Find info about parameter "minwalkers" in the user manual!
Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.471064262434
                                         uncertainty =       0.002944090803

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.471064262434
                                         uncertainty =       0.002944090803

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000485427382
  error estimate for blocks of size 2^( 2) =       0.000506531364
  error estimate for blocks of size 2^( 3) =       0.000526727115
  error estimate for blocks of size 2^( 4) =       0.000541937420
  error estimate for blocks of size 2^( 5) =       0.000551401613
  error estimate for blocks of size 2^( 6) =       0.000555914824
  error estimate for blocks of size 2^( 7) =       0.000558224022

      target function =                  N/A
              le_mean =     -22.818943419237
             les_mean =     521.194021408108
             stat err =       0.000551869470
             autocorr =       1.292481088959
              std dev =       0.686497986811
             le_variance =       0.471279485895

ERROR CostFunction-> Number of Effective Walkers is too small! 
  Number of effective walkers (samples) / total number of samples = 0.00121778
  User specified threshold minwalkers = 0.3
  If this message appears frequently. You might have to be cautious. 
  Find info about parameter "minwalkers" in the user manual!
Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.472092292141
                                         uncertainty =       0.002954668536

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.472092292141
                                         uncertainty =       0.002954668536

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000485956196
  error estimate for blocks of size 2^( 2) =       0.000507065294
  error estimate for blocks of size 2^( 3) =       0.000527293342
  error estimate for blocks of size 2^( 4) =       0.000542507984
  error estimate for blocks of size 2^( 5) =       0.000552008503
  error estimate for blocks of size 2^( 6) =       0.000556445339
  error estimate for blocks of size 2^( 7) =       0.000558771885

      target function =                  N/A
              le_mean =     -22.818991262094
             les_mean =     521.298250253856
             stat err =       0.000552433428
             autocorr =       1.292306868729
              std dev =       0.687245842718
             le_variance =       0.472306848333

ERROR CostFunction-> Number of Effective Walkers is too small! 
  Number of effective walkers (samples) / total number of samples = 0.00832584
  User specified threshold minwalkers = 0.3
  If this message appears frequently. You might have to be cautious. 
  Find info about parameter "minwalkers" in the user manual!
Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.471176607074
                                         uncertainty =       0.003066768449

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.471176607074
                                         uncertainty =       0.003066768449

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000485483607
  error estimate for blocks of size 2^( 2) =       0.000506546252
  error estimate for blocks of size 2^( 3) =       0.000526677037
  error estimate for blocks of size 2^( 4) =       0.000541811247
  error estimate for blocks of size 2^( 5) =       0.000551248370
  error estimate for blocks of size 2^( 6) =       0.000555733608
  error estimate for blocks of size 2^( 7) =       0.000557958726

      target function =                  N/A
              le_mean =     -22.818939350464
             les_mean =     521.219151918643
             stat err =       0.000551687988
             autocorr =       1.291332006740
              std dev =       0.686577501756
             le_variance =       0.471388665917


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.819233565335        initial  <--
     2.4414e-02     2.4414e-01             7.7297e-03       -22.818943419237
     9.7656e-02     9.7656e-01             4.4802e-03       -22.818991262094
     3.9062e-01     3.9062e+00             1.6847e-03       -22.818939350464

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 43.1474
  </log>
  <optVariables href="FORM.s008.opt.xml">
ci_01                 1.242905e-01 3 1  ON 0
ci_02                -2.809406e-02 3 1  ON 1
ci_03                -2.658327e-02 3 1  ON 2
ci_04                 2.501838e-02 3 1  ON 3
ci_05                -2.313882e-02 3 1  ON 4
ci_06                -2.333715e-02 3 1  ON 5
ci_07                 2.510857e-02 3 1  ON 6
ci_08                -5.515267e-03 3 1  ON 7
ci_09                -1.123640e-02 3 1  ON 8
ci_10                -1.256650e-02 3 1  ON 9
ci_11                 1.518423e-02 3 1  ON 10
ci_12                 1.104373e-02 3 1  ON 11
ci_13                 1.160319e-02 3 1  ON 12
ci_14                 1.444037e-02 3 1  ON 13
ci_15                 7.988413e-03 3 1  ON 14
ci_16                 8.285460e-03 3 1  ON 15
ci_17                -9.953170e-03 3 1  ON 16
ci_18                -1.020841e-02 3 1  ON 17
ci_19                 9.443127e-03 3 1  ON 18
ci_20                 1.050815e-02 3 1  ON 19
ci_21                 7.438745e-03 3 1  ON 20
ci_22                 8.172794e-03 3 1  ON 21
ci_23                 6.229158e-03 3 1  ON 22
ci_24                 7.655993e-03 3 1  ON 23
ci_25                 5.004398e-03 3 1  ON 24
ci_26                 2.838829e-03 3 1  ON 25
ci_27                 1.246833e-03 3 1  ON 26
ci_28                 4.181750e-03 3 1  ON 27
ci_29                 3.436023e-03 3 1  ON 28
ci_30                 3.676604e-04 3 1  ON 29
ci_31                -1.125605e-04 3 1  ON 30
ci_32                -1.958580e-04 3 1  ON 31
ci_33                -6.773139e-04 3 1  ON 32
ci_34                 6.865710e-06 3 1  ON 33
ci_35                 2.654640e-04 3 1  ON 34
ci_36                -1.260253e-03 3 1  ON 35
ci_37                -1.042735e-03 3 1  ON 36
ci_38                -4.164396e-05 3 1  ON 37
ci_39                -2.093512e-06 3 1  ON 38
ci_40                -1.428574e-03 3 1  ON 39
ci_41                 6.326878e-05 3 1  ON 40
ci_42                 9.918412e-04 3 1  ON 41
ci_43                -2.701658e-03 3 1  ON 42
ci_44                -1.732659e-03 3 1  ON 43
ci_45                 1.686085e-04 3 1  ON 44
ci_46                -1.336303e-04 3 1  ON 45
ci_47                -2.142988e-03 3 1  ON 46
ci_48                -5.738762e-04 3 1  ON 47
ci_49                -1.346932e-03 3 1  ON 48
ci_50                -5.678425e-04 3 1  ON 49
ci_51                -1.572939e-04 3 1  ON 50
ci_52                 1.436753e-04 3 1  ON 51
ci_53                -8.526989e-04 3 1  ON 52
ci_54                -7.782706e-04 3 1  ON 53
ci_55                -9.221832e-04 3 1  ON 54
ci_56                 1.604432e-03 3 1  ON 55
ci_57                 1.664531e-03 3 1  ON 56
ci_58                -1.085758e-03 3 1  ON 57
ci_59                -2.166585e-03 3 1  ON 58
ci_60                 8.221423e-04 3 1  ON 59
ci_61                 1.713541e-03 3 1  ON 60
ci_62                 1.498138e-04 3 1  ON 61
ci_63                -5.379261e-04 3 1  ON 62
ci_64                -2.170461e-04 3 1  ON 63
ci_65                 1.751973e-04 3 1  ON 64
ci_66                -1.823586e-04 3 1  ON 65
ci_67                -4.050576e-04 3 1  ON 66
ci_68                -1.271608e-03 3 1  ON 67
ci_69                -5.372493e-04 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.3659e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s009 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s009 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=9  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2838e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 9
    time step          = 0.05
    reference energy   = -22.887
    reference variance = 0.327756
====================================================
  Execution time = 2.6690e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s009
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5343e+04
  VMC Eavg = -2.2819e+01
  VMC Evar = 4.9027e-01
  Total weights = 1.963711797e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.0973e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.470067256980
                                         uncertainty =       0.002544828257

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.470067256980
                                         uncertainty =       0.002544828257

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000484802201
  error estimate for blocks of size 2^( 2) =       0.000506498105
  error estimate for blocks of size 2^( 3) =       0.000526481408
  error estimate for blocks of size 2^( 4) =       0.000542369232
  error estimate for blocks of size 2^( 5) =       0.000552222124
  error estimate for blocks of size 2^( 6) =       0.000557626665
  error estimate for blocks of size 2^( 7) =       0.000562361251

      target function =                  N/A
              le_mean =     -22.819066200693
             les_mean =     521.200055345078
             stat err =       0.000553644818
             autocorr =       1.304167319907
              std dev =       0.685613847637
             le_variance =       0.470066348071


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281906620069e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.4414e-01, overlap shift 2.4414e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.819066200675       residual = 3.10e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.819102910679       residual = 9.99e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.819106285915       residual = 3.76e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.819106696221       residual = 6.09e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.4414e-01 is 2.254806e-03

solving harmonic davidson linear method for identity shift 9.7656e-01, overlap shift 9.7656e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.819066200675       residual = 3.10e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.819079622867       residual = 3.47e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.819080222060       residual = 6.32e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.819080256157       residual = 9.00e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.7656e-01 is 7.004190e-04

solving harmonic davidson linear method for identity shift 3.9062e+00, overlap shift 3.9062e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.819066200675       residual = 3.10e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.819069994939       residual = 3.01e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.819070118481       residual = 7.38e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.819070130298       residual = 1.27e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.9062e+00 is 1.863675e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.264347 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.1797e+01
  </log>
  <optVariables href="FORM.s009.opt.xml">
ci_01                 1.235901e-01 3 1  ON 0
ci_02                -2.762228e-02 3 1  ON 1
ci_03                -2.638270e-02 3 1  ON 2
ci_04                 2.515471e-02 3 1  ON 3
ci_05                -2.299063e-02 3 1  ON 4
ci_06                -2.335329e-02 3 1  ON 5
ci_07                 2.516998e-02 3 1  ON 6
ci_08                -5.151861e-03 3 1  ON 7
ci_09                -1.129452e-02 3 1  ON 8
ci_10                -1.256263e-02 3 1  ON 9
ci_11                 1.521791e-02 3 1  ON 10
ci_12                 1.095288e-02 3 1  ON 11
ci_13                 1.143845e-02 3 1  ON 12
ci_14                 1.469926e-02 3 1  ON 13
ci_15                 8.094384e-03 3 1  ON 14
ci_16                 8.339518e-03 3 1  ON 15
ci_17                -9.866835e-03 3 1  ON 16
ci_18                -1.021994e-02 3 1  ON 17
ci_19                 9.189105e-03 3 1  ON 18
ci_20                 1.069281e-02 3 1  ON 19
ci_21                 7.359236e-03 3 1  ON 20
ci_22                 8.141138e-03 3 1  ON 21
ci_23                 6.211834e-03 3 1  ON 22
ci_24                 7.636204e-03 3 1  ON 23
ci_25                 4.928280e-03 3 1  ON 24
ci_26                 2.998916e-03 3 1  ON 25
ci_27                 1.433532e-03 3 1  ON 26
ci_28                 3.817175e-03 3 1  ON 27
ci_29                 3.661544e-03 3 1  ON 28
ci_30                 4.244246e-04 3 1  ON 29
ci_31                 6.155387e-05 3 1  ON 30
ci_32                -1.349206e-04 3 1  ON 31
ci_33                -7.322564e-04 3 1  ON 32
ci_34                 3.473610e-04 3 1  ON 33
ci_35                 5.201991e-04 3 1  ON 34
ci_36                -1.159347e-03 3 1  ON 35
ci_37                -9.715804e-04 3 1  ON 36
ci_38                -9.074039e-05 3 1  ON 37
ci_39                -1.249079e-04 3 1  ON 38
ci_40                -1.421118e-03 3 1  ON 39
ci_41                 3.216406e-04 3 1  ON 40
ci_42                 8.248718e-04 3 1  ON 41
ci_43                -2.721013e-03 3 1  ON 42
ci_44                -1.854639e-03 3 1  ON 43
ci_45                 4.895676e-05 3 1  ON 44
ci_46                -8.396860e-05 3 1  ON 45
ci_47                -1.888069e-03 3 1  ON 46
ci_48                -5.315360e-04 3 1  ON 47
ci_49                -1.297247e-03 3 1  ON 48
ci_50                -5.461712e-04 3 1  ON 49
ci_51                -1.510632e-04 3 1  ON 50
ci_52                -4.723830e-05 3 1  ON 51
ci_53                -1.029647e-03 3 1  ON 52
ci_54                -7.074182e-04 3 1  ON 53
ci_55                -9.740518e-04 3 1  ON 54
ci_56                 1.560451e-03 3 1  ON 55
ci_57                 1.392999e-03 3 1  ON 56
ci_58                -1.149724e-03 3 1  ON 57
ci_59                -2.087806e-03 3 1  ON 58
ci_60                 9.619023e-04 3 1  ON 59
ci_61                 1.618372e-03 3 1  ON 60
ci_62                -1.034067e-04 3 1  ON 61
ci_63                -5.538351e-04 3 1  ON 62
ci_64                -4.467935e-04 3 1  ON 63
ci_65                 7.213370e-05 3 1  ON 64
ci_66                -2.603495e-04 3 1  ON 65
ci_67                -3.648072e-04 3 1  ON 66
ci_68                -1.500269e-03 3 1  ON 67
ci_69                -6.870569e-04 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 9
    time step          = 0.05
    reference energy   = -22.7094
    reference variance = 0.343667
====================================================
  Execution time = 2.5299e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s009
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2820e+01
  VMC Evar = 5.0893e-01
  Total weights = 1.9635e+06
  Execution time = 3.5625e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

ERROR CostFunction-> Number of Effective Walkers is too small! 
  Number of effective walkers (samples) / total number of samples = 0.28939
  User specified threshold minwalkers = 0.3
  If this message appears frequently. You might have to be cautious. 
  Find info about parameter "minwalkers" in the user manual!
Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.473949184459
                                         uncertainty =       0.004202855778

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.473949184459
                                         uncertainty =       0.004202855778

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000486813876
  error estimate for blocks of size 2^( 2) =       0.000507863102
  error estimate for blocks of size 2^( 3) =       0.000527729121
  error estimate for blocks of size 2^( 4) =       0.000542864175
  error estimate for blocks of size 2^( 5) =       0.000551853691
  error estimate for blocks of size 2^( 6) =       0.000556582887
  error estimate for blocks of size 2^( 7) =       0.000559209507

      target function =                  N/A
              le_mean =     -22.819531105889
             les_mean =     521.249004301197
             stat err =       0.000552627565
             autocorr =       1.288662498268
              std dev =       0.688458785536
             le_variance =       0.473975499381

ERROR CostFunction-> Number of Effective Walkers is too small! 
  Number of effective walkers (samples) / total number of samples = 0.189417
  User specified threshold minwalkers = 0.3
  If this message appears frequently. You might have to be cautious. 
  Find info about parameter "minwalkers" in the user manual!
Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.472142844967
                                         uncertainty =       0.003056714418

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.472142844967
                                         uncertainty =       0.003056714418

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000485886664
  error estimate for blocks of size 2^( 2) =       0.000506993883
  error estimate for blocks of size 2^( 3) =       0.000526926278
  error estimate for blocks of size 2^( 4) =       0.000542098092
  error estimate for blocks of size 2^( 5) =       0.000551088465
  error estimate for blocks of size 2^( 6) =       0.000555852719
  error estimate for blocks of size 2^( 7) =       0.000558457966

      target function =                  N/A
              le_mean =     -22.819548125215
             les_mean =     521.241544285336
             stat err =       0.000551874310
             autocorr =       1.290061452851
              std dev =       0.687147509386
             le_variance =       0.472171699656

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.472475512374
                                         uncertainty =       0.003182824176

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.472475512374
                                         uncertainty =       0.003182824176

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000486057630
  error estimate for blocks of size 2^( 2) =       0.000507151296
  error estimate for blocks of size 2^( 3) =       0.000527067486
  error estimate for blocks of size 2^( 4) =       0.000542219585
  error estimate for blocks of size 2^( 5) =       0.000551204517
  error estimate for blocks of size 2^( 6) =       0.000555951403
  error estimate for blocks of size 2^( 7) =       0.000558571481

      target function =                  N/A
              le_mean =     -22.819543750299
             les_mean =     521.724469181112
             stat err =       0.000551986747
             autocorr =       1.289679424217
              std dev =       0.687389292085
             le_variance =       0.472504038873

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.473598097227
                                         uncertainty =       0.003955458399

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.473598097227
                                         uncertainty =       0.003955458399

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000486633800
  error estimate for blocks of size 2^( 2) =       0.000507692671
  error estimate for blocks of size 2^( 3) =       0.000527567566
  error estimate for blocks of size 2^( 4) =       0.000542707037
  error estimate for blocks of size 2^( 5) =       0.000551696686
  error estimate for blocks of size 2^( 6) =       0.000556432572
  error estimate for blocks of size 2^( 7) =       0.000559058822

      target function =                  N/A
              le_mean =     -22.819530936390
             les_mean =     521.245798443516
             stat err =       0.000552473779
             autocorr =       1.288898744536
              std dev =       0.688204120497
             le_variance =       0.473624911469


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.819531105889        initial
     2.4414e-01     2.4414e+00             2.2548e-03       -22.819548125215  <--
     9.7656e-01     9.7656e+00             7.0042e-04       -22.819543750299
     3.9062e+00     3.9062e+01             1.8637e-04       -22.819530936390

*****************************************************************************
Applying the update for shift_i =   2.4414e-01     and shift_s =   2.4414e+00
*****************************************************************************

  Execution time = 4.3134e+01
  </log>
  <optVariables href="FORM.s009.opt.xml">
ci_01                 1.220357e-01 3 1  ON 0
ci_02                -2.674010e-02 3 1  ON 1
ci_03                -2.597490e-02 3 1  ON 2
ci_04                 2.537432e-02 3 1  ON 3
ci_05                -2.274081e-02 3 1  ON 4
ci_06                -2.344148e-02 3 1  ON 5
ci_07                 2.525458e-02 3 1  ON 6
ci_08                -4.649330e-03 3 1  ON 7
ci_09                -1.138443e-02 3 1  ON 8
ci_10                -1.253596e-02 3 1  ON 9
ci_11                 1.530402e-02 3 1  ON 10
ci_12                 1.081391e-02 3 1  ON 11
ci_13                 1.110524e-02 3 1  ON 12
ci_14                 1.530566e-02 3 1  ON 13
ci_15                 8.256190e-03 3 1  ON 14
ci_16                 8.414989e-03 3 1  ON 15
ci_17                -9.681091e-03 3 1  ON 16
ci_18                -1.023353e-02 3 1  ON 17
ci_19                 8.849149e-03 3 1  ON 18
ci_20                 1.103526e-02 3 1  ON 19
ci_21                 7.202005e-03 3 1  ON 20
ci_22                 8.037270e-03 3 1  ON 21
ci_23                 6.194656e-03 3 1  ON 22
ci_24                 7.604559e-03 3 1  ON 23
ci_25                 4.816111e-03 3 1  ON 24
ci_26                 3.261625e-03 3 1  ON 25
ci_27                 1.727914e-03 3 1  ON 26
ci_28                 3.165494e-03 3 1  ON 27
ci_29                 4.023232e-03 3 1  ON 28
ci_30                 5.244297e-04 3 1  ON 29
ci_31                 4.184254e-04 3 1  ON 30
ci_32                -5.695013e-05 3 1  ON 31
ci_33                -8.060740e-04 3 1  ON 32
ci_34                 9.742210e-04 3 1  ON 33
ci_35                 1.012350e-03 3 1  ON 34
ci_36                -1.020592e-03 3 1  ON 35
ci_37                -8.693302e-04 3 1  ON 36
ci_38                -1.625012e-04 3 1  ON 37
ci_39                -3.121762e-04 3 1  ON 38
ci_40                -1.408618e-03 3 1  ON 39
ci_41                 7.206162e-04 3 1  ON 40
ci_42                 5.722960e-04 3 1  ON 41
ci_43                -2.739976e-03 3 1  ON 42
ci_44                -2.069099e-03 3 1  ON 43
ci_45                -1.195244e-04 3 1  ON 44
ci_46                -1.001075e-05 3 1  ON 45
ci_47                -1.396207e-03 3 1  ON 46
ci_48                -4.591248e-04 3 1  ON 47
ci_49                -1.210260e-03 3 1  ON 48
ci_50                -5.244384e-04 3 1  ON 49
ci_51                -1.403596e-04 3 1  ON 50
ci_52                -3.247926e-04 3 1  ON 51
ci_53                -1.254954e-03 3 1  ON 52
ci_54                -5.967406e-04 3 1  ON 53
ci_55                -1.071677e-03 3 1  ON 54
ci_56                 1.521308e-03 3 1  ON 55
ci_57                 1.012901e-03 3 1  ON 56
ci_58                -1.258008e-03 3 1  ON 57
ci_59                -1.946578e-03 3 1  ON 58
ci_60                 1.308934e-03 3 1  ON 59
ci_61                 1.405248e-03 3 1  ON 60
ci_62                -4.183612e-04 3 1  ON 61
ci_63                -5.606706e-04 3 1  ON 62
ci_64                -8.092026e-04 3 1  ON 63
ci_65                -9.254229e-05 3 1  ON 64
ci_66                -3.708457e-04 3 1  ON 65
ci_67                -3.030010e-04 3 1  ON 66
ci_68                -1.838379e-03 3 1  ON 67
ci_69                -9.489554e-04 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.4941e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s010 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s010 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=10  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2834e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 10
    time step          = 0.05
    reference energy   = -22.8659
    reference variance = 0.366671
====================================================
  Execution time = 2.5820e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s010
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5327e+04
  VMC Eavg = -2.2819e+01
  VMC Evar = 4.8718e-01
  Total weights = 1.963863008e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.6389e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.472608493731
                                         uncertainty =       0.002580319594

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.472608493731
                                         uncertainty =       0.002580319594

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000486073157
  error estimate for blocks of size 2^( 2) =       0.000507694318
  error estimate for blocks of size 2^( 3) =       0.000528646917
  error estimate for blocks of size 2^( 4) =       0.000544432997
  error estimate for blocks of size 2^( 5) =       0.000553749609
  error estimate for blocks of size 2^( 6) =       0.000559869831
  error estimate for blocks of size 2^( 7) =       0.000560479023

      target function =                  N/A
              le_mean =     -22.818880765447
             les_mean =     521.188499529301
             stat err =       0.000554632865
             autocorr =       1.301990827822
              std dev =       0.687411250480
             le_variance =       0.472534227287


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281888076545e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.1035e-02, overlap shift 6.1035e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.818880765367       residual = 2.23e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.818903487534       residual = 1.84e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.818914481241       residual = 2.71e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.818914203715       residual = 2.23e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.818914539235       residual = 1.42e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.818914567499       residual = 1.50e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          5 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 6.1035e-02 is 4.300246e-03

solving harmonic davidson linear method for identity shift 2.4414e-01, overlap shift 2.4414e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.818880765367       residual = 2.23e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.818893781368       residual = 7.40e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.818896862899       residual = 3.35e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.818896655530       residual = 8.23e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.4414e-01 is 1.865730e-03

solving harmonic davidson linear method for identity shift 9.7656e-01, overlap shift 9.7656e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.818880765367       residual = 2.23e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.818885570668       residual = 3.46e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.818885836349       residual = 6.64e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.818885843408       residual = 7.80e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.7656e-01 is 5.776185e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.265882 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0472e+01
  </log>
  <optVariables href="FORM.s010.opt.xml">
ci_01                 1.201700e-01 3 1  ON 0
ci_02                -2.570858e-02 3 1  ON 1
ci_03                -2.567241e-02 3 1  ON 2
ci_04                 2.527406e-02 3 1  ON 3
ci_05                -2.271639e-02 3 1  ON 4
ci_06                -2.295632e-02 3 1  ON 5
ci_07                 2.509264e-02 3 1  ON 6
ci_08                -4.690520e-03 3 1  ON 7
ci_09                -1.149684e-02 3 1  ON 8
ci_10                -1.215576e-02 3 1  ON 9
ci_11                 1.571721e-02 3 1  ON 10
ci_12                 1.070643e-02 3 1  ON 11
ci_13                 1.135140e-02 3 1  ON 12
ci_14                 1.556764e-02 3 1  ON 13
ci_15                 7.947036e-03 3 1  ON 14
ci_16                 7.779296e-03 3 1  ON 15
ci_17                -9.316081e-03 3 1  ON 16
ci_18                -9.386348e-03 3 1  ON 17
ci_19                 9.156646e-03 3 1  ON 18
ci_20                 1.078447e-02 3 1  ON 19
ci_21                 7.761705e-03 3 1  ON 20
ci_22                 8.070567e-03 3 1  ON 21
ci_23                 6.206162e-03 3 1  ON 22
ci_24                 7.849928e-03 3 1  ON 23
ci_25                 5.393249e-03 3 1  ON 24
ci_26                 2.426306e-03 3 1  ON 25
ci_27                 2.053418e-03 3 1  ON 26
ci_28                 3.230483e-03 3 1  ON 27
ci_29                 3.837727e-03 3 1  ON 28
ci_30                 9.372154e-04 3 1  ON 29
ci_31                 3.303723e-04 3 1  ON 30
ci_32                -3.438674e-04 3 1  ON 31
ci_33                -9.316955e-04 3 1  ON 32
ci_34                 1.096242e-04 3 1  ON 33
ci_35                 5.664115e-04 3 1  ON 34
ci_36                -5.949126e-04 3 1  ON 35
ci_37                -8.896472e-04 3 1  ON 36
ci_38                 5.598802e-05 3 1  ON 37
ci_39                -3.168060e-04 3 1  ON 38
ci_40                -1.141756e-03 3 1  ON 39
ci_41                 3.633881e-04 3 1  ON 40
ci_42                 8.087396e-04 3 1  ON 41
ci_43                -2.092866e-03 3 1  ON 42
ci_44                -2.171213e-03 3 1  ON 43
ci_45                 8.915059e-05 3 1  ON 44
ci_46                 1.854292e-04 3 1  ON 45
ci_47                -1.176046e-03 3 1  ON 46
ci_48                -5.490329e-04 3 1  ON 47
ci_49                -1.467055e-03 3 1  ON 48
ci_50                -1.439089e-04 3 1  ON 49
ci_51                -3.737285e-04 3 1  ON 50
ci_52                 7.181737e-05 3 1  ON 51
ci_53                -1.221175e-03 3 1  ON 52
ci_54                -1.075191e-03 3 1  ON 53
ci_55                -9.858771e-04 3 1  ON 54
ci_56                 1.470342e-03 3 1  ON 55
ci_57                 1.190990e-03 3 1  ON 56
ci_58                -1.786952e-03 3 1  ON 57
ci_59                -1.170564e-03 3 1  ON 58
ci_60                 1.518109e-03 3 1  ON 59
ci_61                 1.516912e-03 3 1  ON 60
ci_62                -6.722360e-04 3 1  ON 61
ci_63                -1.615462e-04 3 1  ON 62
ci_64                -6.359445e-04 3 1  ON 63
ci_65                -1.016951e-04 3 1  ON 64
ci_66                -1.017230e-04 3 1  ON 65
ci_67                -4.838243e-04 3 1  ON 66
ci_68                -1.339590e-03 3 1  ON 67
ci_69                -8.883985e-04 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 10
    time step          = 0.05
    reference energy   = -22.8297
    reference variance = 0.569438
====================================================
  Execution time = 2.5332e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s010
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2820e+01
  VMC Evar = 4.8405e-01
  Total weights = 1.9637e+06
  Execution time = 3.5480e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.469459107326
                                         uncertainty =       0.002605902608

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.469459107326
                                         uncertainty =       0.002605902608

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000484449019
  error estimate for blocks of size 2^( 2) =       0.000505437850
  error estimate for blocks of size 2^( 3) =       0.000525916841
  error estimate for blocks of size 2^( 4) =       0.000540425733
  error estimate for blocks of size 2^( 5) =       0.000549306495
  error estimate for blocks of size 2^( 6) =       0.000554782419
  error estimate for blocks of size 2^( 7) =       0.000556869484

      target function =                  N/A
              le_mean =     -22.820243227206
             les_mean =     521.252852156011
             stat err =       0.000550346033
             autocorr =       1.290552031933
              std dev =       0.685114372828
             le_variance =       0.469381703855

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.469125724728
                                         uncertainty =       0.002565533237

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.469125724728
                                         uncertainty =       0.002565533237

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000484276423
  error estimate for blocks of size 2^( 2) =       0.000505325460
  error estimate for blocks of size 2^( 3) =       0.000525879791
  error estimate for blocks of size 2^( 4) =       0.000540461343
  error estimate for blocks of size 2^( 5) =       0.000549425555
  error estimate for blocks of size 2^( 6) =       0.000554933629
  error estimate for blocks of size 2^( 7) =       0.000556987885

      target function =                  N/A
              le_mean =     -22.820241458201
             les_mean =     521.374513981129
             stat err =       0.000550452103
             autocorr =       1.291969967866
              std dev =       0.684870285557
             le_variance =       0.469047308040

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.470478491313
                                         uncertainty =       0.002753737291

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.470478491313
                                         uncertainty =       0.002753737291

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000484974102
  error estimate for blocks of size 2^( 2) =       0.000506006259
  error estimate for blocks of size 2^( 3) =       0.000526530876
  error estimate for blocks of size 2^( 4) =       0.000541101432
  error estimate for blocks of size 2^( 5) =       0.000550065942
  error estimate for blocks of size 2^( 6) =       0.000555516869
  error estimate for blocks of size 2^( 7) =       0.000557575129

      target function =                  N/A
              le_mean =     -22.820226324222
             les_mean =     521.417536385424
             stat err =       0.000551064843
             autocorr =       1.291125068162
              std dev =       0.685856953002
             le_variance =       0.470399759981

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.469400711252
                                         uncertainty =       0.002600718726

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.469400711252
                                         uncertainty =       0.002600718726

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000484418648
  error estimate for blocks of size 2^( 2) =       0.000505417724
  error estimate for blocks of size 2^( 3) =       0.000525913893
  error estimate for blocks of size 2^( 4) =       0.000540437560
  error estimate for blocks of size 2^( 5) =       0.000549332059
  error estimate for blocks of size 2^( 6) =       0.000554813316
  error estimate for blocks of size 2^( 7) =       0.000556850757

      target function =                  N/A
              le_mean =     -22.820225692183
             les_mean =     521.275577683268
             stat err =       0.000550358423
             autocorr =       1.290771976339
              std dev =       0.685071422236
             le_variance =       0.469322853565


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.820243227206        initial  <--
     6.1035e-02     6.1035e-01             4.3002e-03       -22.820241458201
     2.4414e-01     2.4414e+00             1.8657e-03       -22.820226324222
     9.7656e-01     9.7656e+00             5.7762e-04       -22.820225692183

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 43.1207
  </log>
  <optVariables href="FORM.s010.opt.xml">
ci_01                 1.220357e-01 3 1  ON 0
ci_02                -2.674010e-02 3 1  ON 1
ci_03                -2.597490e-02 3 1  ON 2
ci_04                 2.537432e-02 3 1  ON 3
ci_05                -2.274081e-02 3 1  ON 4
ci_06                -2.344148e-02 3 1  ON 5
ci_07                 2.525458e-02 3 1  ON 6
ci_08                -4.649330e-03 3 1  ON 7
ci_09                -1.138443e-02 3 1  ON 8
ci_10                -1.253596e-02 3 1  ON 9
ci_11                 1.530402e-02 3 1  ON 10
ci_12                 1.081391e-02 3 1  ON 11
ci_13                 1.110524e-02 3 1  ON 12
ci_14                 1.530566e-02 3 1  ON 13
ci_15                 8.256190e-03 3 1  ON 14
ci_16                 8.414989e-03 3 1  ON 15
ci_17                -9.681091e-03 3 1  ON 16
ci_18                -1.023353e-02 3 1  ON 17
ci_19                 8.849149e-03 3 1  ON 18
ci_20                 1.103526e-02 3 1  ON 19
ci_21                 7.202005e-03 3 1  ON 20
ci_22                 8.037270e-03 3 1  ON 21
ci_23                 6.194656e-03 3 1  ON 22
ci_24                 7.604559e-03 3 1  ON 23
ci_25                 4.816111e-03 3 1  ON 24
ci_26                 3.261625e-03 3 1  ON 25
ci_27                 1.727914e-03 3 1  ON 26
ci_28                 3.165494e-03 3 1  ON 27
ci_29                 4.023232e-03 3 1  ON 28
ci_30                 5.244297e-04 3 1  ON 29
ci_31                 4.184254e-04 3 1  ON 30
ci_32                -5.695013e-05 3 1  ON 31
ci_33                -8.060740e-04 3 1  ON 32
ci_34                 9.742210e-04 3 1  ON 33
ci_35                 1.012350e-03 3 1  ON 34
ci_36                -1.020592e-03 3 1  ON 35
ci_37                -8.693302e-04 3 1  ON 36
ci_38                -1.625012e-04 3 1  ON 37
ci_39                -3.121762e-04 3 1  ON 38
ci_40                -1.408618e-03 3 1  ON 39
ci_41                 7.206162e-04 3 1  ON 40
ci_42                 5.722960e-04 3 1  ON 41
ci_43                -2.739976e-03 3 1  ON 42
ci_44                -2.069099e-03 3 1  ON 43
ci_45                -1.195244e-04 3 1  ON 44
ci_46                -1.001075e-05 3 1  ON 45
ci_47                -1.396207e-03 3 1  ON 46
ci_48                -4.591248e-04 3 1  ON 47
ci_49                -1.210260e-03 3 1  ON 48
ci_50                -5.244384e-04 3 1  ON 49
ci_51                -1.403596e-04 3 1  ON 50
ci_52                -3.247926e-04 3 1  ON 51
ci_53                -1.254954e-03 3 1  ON 52
ci_54                -5.967406e-04 3 1  ON 53
ci_55                -1.071677e-03 3 1  ON 54
ci_56                 1.521308e-03 3 1  ON 55
ci_57                 1.012901e-03 3 1  ON 56
ci_58                -1.258008e-03 3 1  ON 57
ci_59                -1.946578e-03 3 1  ON 58
ci_60                 1.308934e-03 3 1  ON 59
ci_61                 1.405248e-03 3 1  ON 60
ci_62                -4.183612e-04 3 1  ON 61
ci_63                -5.606706e-04 3 1  ON 62
ci_64                -8.092026e-04 3 1  ON 63
ci_65                -9.254229e-05 3 1  ON 64
ci_66                -3.708457e-04 3 1  ON 65
ci_67                -3.030010e-04 3 1  ON 66
ci_68                -1.838379e-03 3 1  ON 67
ci_69                -9.489554e-04 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.3598e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s011 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s011 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=11  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2836e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 11
    time step          = 0.05
    reference energy   = -22.8495
    reference variance = 0.304494
====================================================
  Execution time = 2.5877e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s011
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5339e+04
  VMC Eavg = -2.2820e+01
  VMC Evar = 4.8581e-01
  Total weights = 1.963555787e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.5774e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.469957769189
                                         uncertainty =       0.002332533426

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.469957769189
                                         uncertainty =       0.002332533426

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000484760538
  error estimate for blocks of size 2^( 2) =       0.000505967572
  error estimate for blocks of size 2^( 3) =       0.000526198975
  error estimate for blocks of size 2^( 4) =       0.000541215491
  error estimate for blocks of size 2^( 5) =       0.000551193886
  error estimate for blocks of size 2^( 6) =       0.000557192045
  error estimate for blocks of size 2^( 7) =       0.000562067712

      target function =                  N/A
              le_mean =     -22.819683640586
             les_mean =     521.223769489241
             stat err =       0.000552917284
             autocorr =       1.300965601889
              std dev =       0.685554927424
             le_variance =       0.469985558515


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281968364059e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.1035e-01, overlap shift 6.1035e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.819683640537       residual = 1.85e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.819691074485       residual = 2.36e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.819692093778       residual = 5.87e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.819692232359       residual = 9.05e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 6.1035e-01 is 6.301169e-04

solving harmonic davidson linear method for identity shift 2.4414e+00, overlap shift 2.4414e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.819683640537       residual = 1.85e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.819685909822       residual = 2.34e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.819686232789       residual = 5.47e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.819686256503       residual = 7.97e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.4414e+00 is 2.001307e-04

solving harmonic davidson linear method for identity shift 9.7656e+00, overlap shift 9.7656e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.819683640537       residual = 1.85e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.819684241042       residual = 2.64e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.819684327098       residual = 6.90e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.819684334330       residual = 1.13e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.7656e+00 is 5.414529e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.267173 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0464e+01
  </log>
  <optVariables href="FORM.s011.opt.xml">
ci_01                 1.218634e-01 3 1  ON 0
ci_02                -2.663847e-02 3 1  ON 1
ci_03                -2.599898e-02 3 1  ON 2
ci_04                 2.536459e-02 3 1  ON 3
ci_05                -2.277248e-02 3 1  ON 4
ci_06                -2.336650e-02 3 1  ON 5
ci_07                 2.527571e-02 3 1  ON 6
ci_08                -4.652877e-03 3 1  ON 7
ci_09                -1.143029e-02 3 1  ON 8
ci_10                -1.252475e-02 3 1  ON 9
ci_11                 1.533817e-02 3 1  ON 10
ci_12                 1.078391e-02 3 1  ON 11
ci_13                 1.109513e-02 3 1  ON 12
ci_14                 1.528559e-02 3 1  ON 13
ci_15                 8.294300e-03 3 1  ON 14
ci_16                 8.341962e-03 3 1  ON 15
ci_17                -9.672138e-03 3 1  ON 16
ci_18                -1.019748e-02 3 1  ON 17
ci_19                 9.049279e-03 3 1  ON 18
ci_20                 1.098231e-02 3 1  ON 19
ci_21                 7.168519e-03 3 1  ON 20
ci_22                 7.985101e-03 3 1  ON 21
ci_23                 6.124588e-03 3 1  ON 22
ci_24                 7.546121e-03 3 1  ON 23
ci_25                 4.743297e-03 3 1  ON 24
ci_26                 3.289002e-03 3 1  ON 25
ci_27                 1.751596e-03 3 1  ON 26
ci_28                 3.226498e-03 3 1  ON 27
ci_29                 3.980250e-03 3 1  ON 28
ci_30                 5.069025e-04 3 1  ON 29
ci_31                 3.506675e-04 3 1  ON 30
ci_32                -5.400526e-05 3 1  ON 31
ci_33                -7.440293e-04 3 1  ON 32
ci_34                 9.381277e-04 3 1  ON 33
ci_35                 9.311740e-04 3 1  ON 34
ci_36                -9.097577e-04 3 1  ON 35
ci_37                -8.245431e-04 3 1  ON 36
ci_38                -1.964014e-04 3 1  ON 37
ci_39                -3.875170e-04 3 1  ON 38
ci_40                -1.441287e-03 3 1  ON 39
ci_41                 7.129959e-04 3 1  ON 40
ci_42                 5.633025e-04 3 1  ON 41
ci_43                -2.722064e-03 3 1  ON 42
ci_44                -2.008325e-03 3 1  ON 43
ci_45                -1.501501e-04 3 1  ON 44
ci_46                -1.717741e-05 3 1  ON 45
ci_47                -1.283169e-03 3 1  ON 46
ci_48                -4.255130e-04 3 1  ON 47
ci_49                -1.169557e-03 3 1  ON 48
ci_50                -5.342072e-04 3 1  ON 49
ci_51                -2.449162e-05 3 1  ON 50
ci_52                -2.767229e-04 3 1  ON 51
ci_53                -1.252828e-03 3 1  ON 52
ci_54                -5.909731e-04 3 1  ON 53
ci_55                -9.344325e-04 3 1  ON 54
ci_56                 1.535826e-03 3 1  ON 55
ci_57                 1.101388e-03 3 1  ON 56
ci_58                -1.184258e-03 3 1  ON 57
ci_59                -1.981142e-03 3 1  ON 58
ci_60                 1.372329e-03 3 1  ON 59
ci_61                 1.451603e-03 3 1  ON 60
ci_62                -3.603340e-04 3 1  ON 61
ci_63                -6.208106e-04 3 1  ON 62
ci_64                -7.421468e-04 3 1  ON 63
ci_65                -4.243169e-05 3 1  ON 64
ci_66                -3.973300e-04 3 1  ON 65
ci_67                -3.381324e-04 3 1  ON 66
ci_68                -1.709098e-03 3 1  ON 67
ci_69                -9.097105e-04 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 11
    time step          = 0.05
    reference energy   = -22.7828
    reference variance = 0.616595
====================================================
  Execution time = 2.5472e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s011
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2819e+01
  VMC Evar = 4.8705e-01
  Total weights = 1.9639e+06
  Execution time = 3.5545e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.473982924365
                                         uncertainty =       0.002624334890

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.473982924365
                                         uncertainty =       0.002624334890

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000486799288
  error estimate for blocks of size 2^( 2) =       0.000508476115
  error estimate for blocks of size 2^( 3) =       0.000528844241
  error estimate for blocks of size 2^( 4) =       0.000545287536
  error estimate for blocks of size 2^( 5) =       0.000555053455
  error estimate for blocks of size 2^( 6) =       0.000559104670
  error estimate for blocks of size 2^( 7) =       0.000560073413

      target function =                  N/A
              le_mean =     -22.818771336043
             les_mean =     521.188307105308
             stat err =       0.000554879768
             autocorr =       1.299265517756
              std dev =       0.688438154627
             le_variance =       0.473947092747

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.473940691638
                                         uncertainty =       0.002627799764

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.473940691638
                                         uncertainty =       0.002627799764

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000486777605
  error estimate for blocks of size 2^( 2) =       0.000508462553
  error estimate for blocks of size 2^( 3) =       0.000528846669
  error estimate for blocks of size 2^( 4) =       0.000545292762
  error estimate for blocks of size 2^( 5) =       0.000555057800
  error estimate for blocks of size 2^( 6) =       0.000559115678
  error estimate for blocks of size 2^( 7) =       0.000560060112

      target function =                  N/A
              le_mean =     -22.818775326624
             les_mean =     521.188907312813
             stat err =       0.000554881588
             autocorr =       1.299389787820
              std dev =       0.688407491112
             le_variance =       0.473904873819

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.473947762374
                                         uncertainty =       0.002625876009

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.473947762374
                                         uncertainty =       0.002625876009

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000486781238
  error estimate for blocks of size 2^( 2) =       0.000508462572
  error estimate for blocks of size 2^( 3) =       0.000528839940
  error estimate for blocks of size 2^( 4) =       0.000545283048
  error estimate for blocks of size 2^( 5) =       0.000555047316
  error estimate for blocks of size 2^( 6) =       0.000559102944
  error estimate for blocks of size 2^( 7) =       0.000560056911

      target function =                  N/A
              le_mean =     -22.818772760384
             les_mean =     521.183831030655
             stat err =       0.000554872555
             autocorr =       1.299328085590
              std dev =       0.688412629296
             le_variance =       0.473911948175

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.473975750383
                                         uncertainty =       0.002624529382

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.473975750383
                                         uncertainty =       0.002624529382

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000486795605
  error estimate for blocks of size 2^( 2) =       0.000508473074
  error estimate for blocks of size 2^( 3) =       0.000528842521
  error estimate for blocks of size 2^( 4) =       0.000545284708
  error estimate for blocks of size 2^( 5) =       0.000555050353
  error estimate for blocks of size 2^( 6) =       0.000559101311
  error estimate for blocks of size 2^( 7) =       0.000560066877

      target function =                  N/A
              le_mean =     -22.818771713624
             les_mean =     521.183811328062
             stat err =       0.000554875812
             autocorr =       1.299266651274
              std dev =       0.688432946075
             le_variance =       0.473939921242


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.818771336043        initial
     6.1035e-01     6.1035e+00             6.3012e-04       -22.818775326624  <--
     2.4414e+00     2.4414e+01             2.0013e-04       -22.818772760384
     9.7656e+00     9.7656e+01             5.4145e-05       -22.818771713624

*****************************************************************************
Applying the update for shift_i =   6.1035e-01     and shift_s =   6.1035e+00
*****************************************************************************

  Execution time = 4.3284e+01
  </log>
  <optVariables href="FORM.s011.opt.xml">
ci_01                 1.214056e-01 3 1  ON 0
ci_02                -2.640294e-02 3 1  ON 1
ci_03                -2.606613e-02 3 1  ON 2
ci_04                 2.534553e-02 3 1  ON 3
ci_05                -2.285670e-02 3 1  ON 4
ci_06                -2.318815e-02 3 1  ON 5
ci_07                 2.531762e-02 3 1  ON 6
ci_08                -4.653545e-03 3 1  ON 7
ci_09                -1.153895e-02 3 1  ON 8
ci_10                -1.249993e-02 3 1  ON 9
ci_11                 1.542327e-02 3 1  ON 10
ci_12                 1.071337e-02 3 1  ON 11
ci_13                 1.106051e-02 3 1  ON 12
ci_14                 1.522706e-02 3 1  ON 13
ci_15                 8.382451e-03 3 1  ON 14
ci_16                 8.167862e-03 3 1  ON 15
ci_17                -9.655757e-03 3 1  ON 16
ci_18                -1.011247e-02 3 1  ON 17
ci_19                 9.463815e-03 3 1  ON 18
ci_20                 1.085009e-02 3 1  ON 19
ci_21                 7.092565e-03 3 1  ON 20
ci_22                 7.858996e-03 3 1  ON 21
ci_23                 5.977887e-03 3 1  ON 22
ci_24                 7.400109e-03 3 1  ON 23
ci_25                 4.588247e-03 3 1  ON 24
ci_26                 3.358910e-03 3 1  ON 25
ci_27                 1.809506e-03 3 1  ON 26
ci_28                 3.368358e-03 3 1  ON 27
ci_29                 3.882365e-03 3 1  ON 28
ci_30                 4.700728e-04 3 1  ON 29
ci_31                 1.928025e-04 3 1  ON 30
ci_32                -4.383521e-05 3 1  ON 31
ci_33                -6.081025e-04 3 1  ON 32
ci_34                 8.508959e-04 3 1  ON 33
ci_35                 7.426904e-04 3 1  ON 34
ci_36                -6.827667e-04 3 1  ON 35
ci_37                -7.348028e-04 3 1  ON 36
ci_38                -2.753511e-04 3 1  ON 37
ci_39                -5.488652e-04 3 1  ON 38
ci_40                -1.504368e-03 3 1  ON 39
ci_41                 6.926494e-04 3 1  ON 40
ci_42                 5.418301e-04 3 1  ON 41
ci_43                -2.681623e-03 3 1  ON 42
ci_44                -1.863302e-03 3 1  ON 43
ci_45                -2.172190e-04 3 1  ON 44
ci_46                -3.740431e-05 3 1  ON 45
ci_47                -1.023685e-03 3 1  ON 46
ci_48                -3.562138e-04 3 1  ON 47
ci_49                -1.085070e-03 3 1  ON 48
ci_50                -5.541011e-04 3 1  ON 49
ci_51                 2.178436e-04 3 1  ON 50
ci_52                -1.778869e-04 3 1  ON 51
ci_53                -1.246239e-03 3 1  ON 52
ci_54                -5.849133e-04 3 1  ON 53
ci_55                -6.178779e-04 3 1  ON 54
ci_56                 1.561790e-03 3 1  ON 55
ci_57                 1.276225e-03 3 1  ON 56
ci_58                -1.016119e-03 3 1  ON 57
ci_59                -2.063782e-03 3 1  ON 58
ci_60                 1.544154e-03 3 1  ON 59
ci_61                 1.578007e-03 3 1  ON 60
ci_62                -2.509546e-04 3 1  ON 61
ci_63                -7.443315e-04 3 1  ON 62
ci_64                -5.963784e-04 3 1  ON 63
ci_65                 6.862062e-05 3 1  ON 64
ci_66                -4.562615e-04 3 1  ON 65
ci_67                -4.111746e-04 3 1  ON 66
ci_68                -1.422522e-03 3 1  ON 67
ci_69                -8.194950e-04 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.3759e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s012 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s012 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=12  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2834e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 12
    time step          = 0.05
    reference energy   = -22.88
    reference variance = 0.315629
====================================================
  Execution time = 2.6028e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s012
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5330e+04
  VMC Eavg = -2.2819e+01
  VMC Evar = 4.8181e-01
  Total weights = 1.963691740e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.5263e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.466515927485
                                         uncertainty =       0.002069988845

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.466515927485
                                         uncertainty =       0.002069988845

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000482988720
  error estimate for blocks of size 2^( 2) =       0.000504325792
  error estimate for blocks of size 2^( 3) =       0.000524450460
  error estimate for blocks of size 2^( 4) =       0.000540715273
  error estimate for blocks of size 2^( 5) =       0.000551820853
  error estimate for blocks of size 2^( 6) =       0.000557235008
  error estimate for blocks of size 2^( 7) =       0.000562609111

      target function =                  N/A
              le_mean =     -22.819043942069
             les_mean =     521.190576339403
             stat err =       0.000553095061
             autocorr =       1.311371029238
              std dev =       0.683049198071
             le_variance =       0.466556206985


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281904394207e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5259e-01, overlap shift 1.5259e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.819043942005       residual = 3.93e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.819053074915       residual = 1.43e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.819054356369       residual = 5.61e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.819055045933       residual = 3.39e-08           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.819055198253       residual = 1.56e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          4 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.5259e-01 is 2.525634e-03

solving harmonic davidson linear method for identity shift 6.1035e-01, overlap shift 6.1035e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.819043942005       residual = 3.93e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.819047790345       residual = 5.39e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.819048267575       residual = 9.60e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.819048337409       residual = 1.54e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 6.1035e-01 is 1.199477e-03

solving harmonic davidson linear method for identity shift 2.4414e+00, overlap shift 2.4414e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.819043942005       residual = 3.93e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.819045103060       residual = 4.96e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.819045253534       residual = 9.18e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.819045262740       residual = 1.42e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.4414e+00 is 3.888495e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.271685 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0570e+01
  </log>
  <optVariables href="FORM.s012.opt.xml">
ci_01                 1.208704e-01 3 1  ON 0
ci_02                -2.626797e-02 3 1  ON 1
ci_03                -2.586647e-02 3 1  ON 2
ci_04                 2.529930e-02 3 1  ON 3
ci_05                -2.271800e-02 3 1  ON 4
ci_06                -2.297591e-02 3 1  ON 5
ci_07                 2.607290e-02 3 1  ON 6
ci_08                -4.472042e-03 3 1  ON 7
ci_09                -1.212389e-02 3 1  ON 8
ci_10                -1.216253e-02 3 1  ON 9
ci_11                 1.555372e-02 3 1  ON 10
ci_12                 1.082646e-02 3 1  ON 11
ci_13                 1.114560e-02 3 1  ON 12
ci_14                 1.489160e-02 3 1  ON 13
ci_15                 8.545506e-03 3 1  ON 14
ci_16                 8.194545e-03 3 1  ON 15
ci_17                -9.565508e-03 3 1  ON 16
ci_18                -1.015215e-02 3 1  ON 17
ci_19                 9.500001e-03 3 1  ON 18
ci_20                 1.088402e-02 3 1  ON 19
ci_21                 7.521571e-03 3 1  ON 20
ci_22                 8.620474e-03 3 1  ON 21
ci_23                 5.950106e-03 3 1  ON 22
ci_24                 7.305859e-03 3 1  ON 23
ci_25                 4.482333e-03 3 1  ON 24
ci_26                 2.995133e-03 3 1  ON 25
ci_27                 1.236016e-03 3 1  ON 26
ci_28                 3.557485e-03 3 1  ON 27
ci_29                 3.732059e-03 3 1  ON 28
ci_30                 6.433029e-04 3 1  ON 29
ci_31                 2.246768e-04 3 1  ON 30
ci_32                 1.549284e-04 3 1  ON 31
ci_33                -5.728908e-04 3 1  ON 32
ci_34                 8.439503e-04 3 1  ON 33
ci_35                 5.336093e-04 3 1  ON 34
ci_36                -1.882243e-03 3 1  ON 35
ci_37                -9.367124e-04 3 1  ON 36
ci_38                -3.619892e-04 3 1  ON 37
ci_39                -4.040840e-04 3 1  ON 38
ci_40                -1.493498e-03 3 1  ON 39
ci_41                 5.531280e-04 3 1  ON 40
ci_42                 3.926662e-04 3 1  ON 41
ci_43                -2.645530e-03 3 1  ON 42
ci_44                -1.788596e-03 3 1  ON 43
ci_45                -3.590368e-04 3 1  ON 44
ci_46                -2.860498e-05 3 1  ON 45
ci_47                -8.938957e-04 3 1  ON 46
ci_48                -4.246019e-04 3 1  ON 47
ci_49                -1.242948e-03 3 1  ON 48
ci_50                -4.086442e-04 3 1  ON 49
ci_51                 3.213086e-04 3 1  ON 50
ci_52                -2.157498e-04 3 1  ON 51
ci_53                -1.349470e-03 3 1  ON 52
ci_54                -2.441460e-04 3 1  ON 53
ci_55                -4.667421e-04 3 1  ON 54
ci_56                 1.627288e-03 3 1  ON 55
ci_57                 1.478941e-03 3 1  ON 56
ci_58                -1.166721e-03 3 1  ON 57
ci_59                -2.003876e-03 3 1  ON 58
ci_60                 1.701647e-03 3 1  ON 59
ci_61                 1.494978e-03 3 1  ON 60
ci_62                -3.241958e-04 3 1  ON 61
ci_63                -8.597601e-04 3 1  ON 62
ci_64                -5.791669e-04 3 1  ON 63
ci_65                 1.498632e-04 3 1  ON 64
ci_66                -5.959295e-04 3 1  ON 65
ci_67                -5.348241e-04 3 1  ON 66
ci_68                -1.360530e-03 3 1  ON 67
ci_69                -1.074778e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 12
    time step          = 0.05
    reference energy   = -22.7316
    reference variance = 0.494675
====================================================
  Execution time = 2.5523e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s012
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2819e+01
  VMC Evar = 4.8926e-01
  Total weights = 1.9637e+06
  Execution time = 3.5517e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.472681397088
                                         uncertainty =       0.002530111265

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.472681397088
                                         uncertainty =       0.002530111265

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000486197510
  error estimate for blocks of size 2^( 2) =       0.000507721693
  error estimate for blocks of size 2^( 3) =       0.000528542653
  error estimate for blocks of size 2^( 4) =       0.000544452343
  error estimate for blocks of size 2^( 5) =       0.000553899605
  error estimate for blocks of size 2^( 6) =       0.000560226770
  error estimate for blocks of size 2^( 7) =       0.000562979888

      target function =                  N/A
              le_mean =     -22.819292626157
             les_mean =     521.253507188649
             stat err =       0.000555389652
             autocorr =       1.304878593313
              std dev =       0.687587112350
             le_variance =       0.472776037070

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.472465625488
                                         uncertainty =       0.002486887204

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.472465625488
                                         uncertainty =       0.002486887204

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000486085766
  error estimate for blocks of size 2^( 2) =       0.000507642600
  error estimate for blocks of size 2^( 3) =       0.000528516311
  error estimate for blocks of size 2^( 4) =       0.000544448420
  error estimate for blocks of size 2^( 5) =       0.000553933378
  error estimate for blocks of size 2^( 6) =       0.000560295805
  error estimate for blocks of size 2^( 7) =       0.000562992336

      target function =                  N/A
              le_mean =     -22.819299763778
             les_mean =     521.212130162556
             stat err =       0.000555417485
             autocorr =       1.305609458445
              std dev =       0.687429082127
             le_variance =       0.472558742954

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.472391142767
                                         uncertainty =       0.002471171343

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.472391142767
                                         uncertainty =       0.002471171343

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000486047547
  error estimate for blocks of size 2^( 2) =       0.000507598139
  error estimate for blocks of size 2^( 3) =       0.000528462553
  error estimate for blocks of size 2^( 4) =       0.000544391110
  error estimate for blocks of size 2^( 5) =       0.000553864746
  error estimate for blocks of size 2^( 6) =       0.000560203784
  error estimate for blocks of size 2^( 7) =       0.000562912205

      target function =                  N/A
              le_mean =     -22.819295403407
             les_mean =     521.212238768372
             stat err =       0.000555342961
             autocorr =       1.305464396793
              std dev =       0.687375033182
             le_variance =       0.472484436241

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.472567890651
                                         uncertainty =       0.002518068599

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.472567890651
                                         uncertainty =       0.002518068599

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000486139053
  error estimate for blocks of size 2^( 2) =       0.000507666266
  error estimate for blocks of size 2^( 3) =       0.000528489706
  error estimate for blocks of size 2^( 4) =       0.000544397520
  error estimate for blocks of size 2^( 5) =       0.000553848300
  error estimate for blocks of size 2^( 6) =       0.000560176008
  error estimate for blocks of size 2^( 7) =       0.000562919451

      target function =                  N/A
              le_mean =     -22.819291838613
             les_mean =     521.212331913317
             stat err =       0.000555335320
             autocorr =       1.304937072858
              std dev =       0.687504442559
             le_variance =       0.472662358538


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.819292626157        initial
     1.5259e-01     1.5259e+00             2.5256e-03       -22.819299763778  <--
     6.1035e-01     6.1035e+00             1.1995e-03       -22.819295403407
     2.4414e+00     2.4414e+01             3.8885e-04       -22.819291838613

*****************************************************************************
Applying the update for shift_i =   1.5259e-01     and shift_s =   1.5259e+00
*****************************************************************************

  Execution time = 4.3332e+01
  </log>
  <optVariables href="FORM.s012.opt.xml">
ci_01                 1.198157e-01 3 1  ON 0
ci_02                -2.612304e-02 3 1  ON 1
ci_03                -2.558419e-02 3 1  ON 2
ci_04                 2.524426e-02 3 1  ON 3
ci_05                -2.254535e-02 3 1  ON 4
ci_06                -2.271172e-02 3 1  ON 5
ci_07                 2.734600e-02 3 1  ON 6
ci_08                -4.270792e-03 3 1  ON 7
ci_09                -1.308353e-02 3 1  ON 8
ci_10                -1.164194e-02 3 1  ON 9
ci_11                 1.576393e-02 3 1  ON 10
ci_12                 1.097629e-02 3 1  ON 11
ci_13                 1.141141e-02 3 1  ON 12
ci_14                 1.409666e-02 3 1  ON 13
ci_15                 8.766626e-03 3 1  ON 14
ci_16                 8.282841e-03 3 1  ON 15
ci_17                -9.427140e-03 3 1  ON 16
ci_18                -1.020387e-02 3 1  ON 17
ci_19                 9.515211e-03 3 1  ON 18
ci_20                 1.093080e-02 3 1  ON 19
ci_21                 8.262482e-03 3 1  ON 20
ci_22                 9.894240e-03 3 1  ON 21
ci_23                 5.910297e-03 3 1  ON 22
ci_24                 7.143348e-03 3 1  ON 23
ci_25                 4.355659e-03 3 1  ON 24
ci_26                 2.501439e-03 3 1  ON 25
ci_27                 3.411394e-04 3 1  ON 26
ci_28                 3.784498e-03 3 1  ON 27
ci_29                 3.492757e-03 3 1  ON 28
ci_30                 8.892881e-04 3 1  ON 29
ci_31                 2.179635e-04 3 1  ON 30
ci_32                 4.112074e-04 3 1  ON 31
ci_33                -5.449934e-04 3 1  ON 32
ci_34                 8.882144e-04 3 1  ON 33
ci_35                 2.459146e-04 3 1  ON 34
ci_36                -3.208400e-03 3 1  ON 35
ci_37                -1.152975e-03 3 1  ON 36
ci_38                -3.996411e-04 3 1  ON 37
ci_39                -2.444603e-04 3 1  ON 38
ci_40                -1.478833e-03 3 1  ON 39
ci_41                 3.802531e-04 3 1  ON 40
ci_42                 2.164164e-04 3 1  ON 41
ci_43                -2.587747e-03 3 1  ON 42
ci_44                -1.693910e-03 3 1  ON 43
ci_45                -5.007743e-04 3 1  ON 44
ci_46                 2.350166e-05 3 1  ON 45
ci_47                -7.112536e-04 3 1  ON 46
ci_48                -4.886658e-04 3 1  ON 47
ci_49                -1.416771e-03 3 1  ON 48
ci_50                -2.748594e-04 3 1  ON 49
ci_51                 4.525075e-04 3 1  ON 50
ci_52                -2.574678e-04 3 1  ON 51
ci_53                -1.452345e-03 3 1  ON 52
ci_54                 2.847888e-04 3 1  ON 53
ci_55                -2.472500e-04 3 1  ON 54
ci_56                 1.686161e-03 3 1  ON 55
ci_57                 1.697235e-03 3 1  ON 56
ci_58                -1.365542e-03 3 1  ON 57
ci_59                -1.911708e-03 3 1  ON 58
ci_60                 2.000379e-03 3 1  ON 59
ci_61                 1.268425e-03 3 1  ON 60
ci_62                -3.950942e-04 3 1  ON 61
ci_63                -9.640791e-04 3 1  ON 62
ci_64                -5.579070e-04 3 1  ON 63
ci_65                 2.550810e-04 3 1  ON 64
ci_66                -7.570220e-04 3 1  ON 65
ci_67                -7.310440e-04 3 1  ON 66
ci_68                -1.285773e-03 3 1  ON 67
ci_69                -1.394579e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.3918e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s013 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s013 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=13  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2832e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 13
    time step          = 0.05
    reference energy   = -22.8305
    reference variance = 0.363752
====================================================
  Execution time = 2.5762e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s013
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5323e+04
  VMC Eavg = -2.2819e+01
  VMC Evar = 4.8893e-01
  Total weights = 1.963439466e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.8147e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.474588536179
                                         uncertainty =       0.002785071785

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.474588536179
                                         uncertainty =       0.002785071785

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000487106844
  error estimate for blocks of size 2^( 2) =       0.000508727333
  error estimate for blocks of size 2^( 3) =       0.000528520108
  error estimate for blocks of size 2^( 4) =       0.000544024531
  error estimate for blocks of size 2^( 5) =       0.000554431701
  error estimate for blocks of size 2^( 6) =       0.000560268257
  error estimate for blocks of size 2^( 7) =       0.000563698475

      target function =                  N/A
              le_mean =     -22.819056760278
             les_mean =     521.198278163906
             stat err =       0.000555605741
             autocorr =       1.301023035088
              std dev =       0.688873105085
             le_variance =       0.474546154910


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281905676028e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.8147e-02, overlap shift 3.8147e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.819056760179       residual = 2.35e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.819130211300       residual = 2.66e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.819134988057       residual = 3.45e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.819134094120       residual = 4.54e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.819134358319       residual = 4.69e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.819134258581       residual = 6.84e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          5 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.8147e-02 is 4.174359e-03

solving harmonic davidson linear method for identity shift 1.5259e-01, overlap shift 1.5259e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.819056760179       residual = 2.35e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.819104427309       residual = 1.04e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.819104628825       residual = 4.56e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.819104293204       residual = 1.64e-08           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.819104321537       residual = 6.32e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          4 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.5259e-01 is 2.051048e-03

solving harmonic davidson linear method for identity shift 6.1035e-01, overlap shift 6.1035e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.819056760179       residual = 2.35e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.819076587075       residual = 2.54e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.819076301400       residual = 4.71e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.819076289587       residual = 1.00e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 6.1035e-01 is 8.396300e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.276674 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.2913e+01
  </log>
  <optVariables href="FORM.s013.opt.xml">
ci_01                 1.177646e-01 3 1  ON 0
ci_02                -2.620549e-02 3 1  ON 1
ci_03                -2.619660e-02 3 1  ON 2
ci_04                 2.468896e-02 3 1  ON 3
ci_05                -2.264439e-02 3 1  ON 4
ci_06                -2.308880e-02 3 1  ON 5
ci_07                 2.645310e-02 3 1  ON 6
ci_08                -4.364982e-03 3 1  ON 7
ci_09                -1.274870e-02 3 1  ON 8
ci_10                -1.135386e-02 3 1  ON 9
ci_11                 1.571389e-02 3 1  ON 10
ci_12                 1.083394e-02 3 1  ON 11
ci_13                 1.283218e-02 3 1  ON 12
ci_14                 1.583335e-02 3 1  ON 13
ci_15                 7.906982e-03 3 1  ON 14
ci_16                 8.519412e-03 3 1  ON 15
ci_17                -9.840371e-03 3 1  ON 16
ci_18                -1.050057e-02 3 1  ON 17
ci_19                 9.577134e-03 3 1  ON 18
ci_20                 1.087379e-02 3 1  ON 19
ci_21                 8.498895e-03 3 1  ON 20
ci_22                 9.212383e-03 3 1  ON 21
ci_23                 6.453307e-03 3 1  ON 22
ci_24                 7.003764e-03 3 1  ON 23
ci_25                 4.457636e-03 3 1  ON 24
ci_26                 2.313221e-03 3 1  ON 25
ci_27                 1.900207e-03 3 1  ON 26
ci_28                 4.279271e-03 3 1  ON 27
ci_29                 3.405152e-03 3 1  ON 28
ci_30                 6.668521e-04 3 1  ON 29
ci_31                 1.680071e-04 3 1  ON 30
ci_32                 1.015234e-04 3 1  ON 31
ci_33                -1.969557e-04 3 1  ON 32
ci_34                 2.220650e-04 3 1  ON 33
ci_35                 9.179689e-04 3 1  ON 34
ci_36                -1.461082e-03 3 1  ON 35
ci_37                -7.038566e-04 3 1  ON 36
ci_38                -3.950228e-04 3 1  ON 37
ci_39                -4.970595e-04 3 1  ON 38
ci_40                -1.557978e-03 3 1  ON 39
ci_41                 1.538811e-04 3 1  ON 40
ci_42                 1.099471e-04 3 1  ON 41
ci_43                -2.678675e-03 3 1  ON 42
ci_44                -1.954160e-03 3 1  ON 43
ci_45                -6.281431e-04 3 1  ON 44
ci_46                -3.621020e-04 3 1  ON 45
ci_47                -5.326095e-04 3 1  ON 46
ci_48                -9.589133e-04 3 1  ON 47
ci_49                -1.464358e-03 3 1  ON 48
ci_50                 5.262171e-05 3 1  ON 49
ci_51                 4.304896e-04 3 1  ON 50
ci_52                 4.103771e-04 3 1  ON 51
ci_53                -1.321737e-03 3 1  ON 52
ci_54                -4.034264e-04 3 1  ON 53
ci_55                 8.222743e-05 3 1  ON 54
ci_56                 1.358904e-03 3 1  ON 55
ci_57                 1.653904e-03 3 1  ON 56
ci_58                -1.273648e-03 3 1  ON 57
ci_59                -1.650584e-03 3 1  ON 58
ci_60                 1.749253e-03 3 1  ON 59
ci_61                 1.905064e-03 3 1  ON 60
ci_62                -2.492946e-04 3 1  ON 61
ci_63                -4.950044e-04 3 1  ON 62
ci_64                -7.251216e-04 3 1  ON 63
ci_65                -1.884974e-04 3 1  ON 64
ci_66                -7.344505e-04 3 1  ON 65
ci_67                -9.712248e-04 3 1  ON 66
ci_68                -9.796295e-04 3 1  ON 67
ci_69                -1.442772e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 13
    time step          = 0.05
    reference energy   = -22.8548
    reference variance = 0.381401
====================================================
  Execution time = 2.6275e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s013
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2820e+01
  VMC Evar = 4.8872e-01
  Total weights = 1.9634e+06
  Execution time = 3.5492e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

ERROR CostFunction-> Number of Effective Walkers is too small! 
  Number of effective walkers (samples) / total number of samples = 6.43549e-05
  User specified threshold minwalkers = 0.3
  If this message appears frequently. You might have to be cautious. 
  Find info about parameter "minwalkers" in the user manual!
Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.608144752244
                                         uncertainty =       0.133922448683

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.608144752244
                                         uncertainty =       0.133922448683

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000551420134
  error estimate for blocks of size 2^( 2) =       0.000570360272
  error estimate for blocks of size 2^( 3) =       0.000587900182
  error estimate for blocks of size 2^( 4) =       0.000601399256
  error estimate for blocks of size 2^( 5) =       0.000609164682
  error estimate for blocks of size 2^( 6) =       0.000614392880
  error estimate for blocks of size 2^( 7) =       0.000618255136

      target function =                  N/A
              le_mean =     -22.820206887754
             les_mean =     527.980802030752
             stat err =       0.000610802989
             autocorr =       1.226978824266
              std dev =       0.779825832309
             le_variance =       0.608128328737

ERROR CostFunction-> Number of Effective Walkers is too small! 
  Number of effective walkers (samples) / total number of samples = 8.32943e-05
  User specified threshold minwalkers = 0.3
  If this message appears frequently. You might have to be cautious. 
  Find info about parameter "minwalkers" in the user manual!
Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.474528877285
                                         uncertainty =       0.003452279631

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.474528877285
                                         uncertainty =       0.003452279631

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000487072242
  error estimate for blocks of size 2^( 2) =       0.000508794640
  error estimate for blocks of size 2^( 3) =       0.000528972020
  error estimate for blocks of size 2^( 4) =       0.000543883122
  error estimate for blocks of size 2^( 5) =       0.000553066783
  error estimate for blocks of size 2^( 6) =       0.000558941769
  error estimate for blocks of size 2^( 7) =       0.000563234674

      target function =                  N/A
              le_mean =     -22.819907593240
             les_mean =     521.748272363138
             stat err =       0.000554781587
             autocorr =       1.297350478471
              std dev =       0.688824171102
             le_variance =       0.474478738695

ERROR CostFunction-> Number of Effective Walkers is too small! 
  Number of effective walkers (samples) / total number of samples = 6.4355e-05
  User specified threshold minwalkers = 0.3
  If this message appears frequently. You might have to be cautious. 
  Find info about parameter "minwalkers" in the user manual!
Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.474594961025
                                         uncertainty =       0.003308718407

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.474594961025
                                         uncertainty =       0.003308718407

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000487107414
  error estimate for blocks of size 2^( 2) =       0.000508831772
  error estimate for blocks of size 2^( 3) =       0.000529013812
  error estimate for blocks of size 2^( 4) =       0.000543931286
  error estimate for blocks of size 2^( 5) =       0.000553013653
  error estimate for blocks of size 2^( 6) =       0.000558711736
  error estimate for blocks of size 2^( 7) =       0.000563063121

      target function =                  N/A
              le_mean =     -22.819946493559
             les_mean =     521.314509095907
             stat err =       0.000554679949
             autocorr =       1.296687889656
              std dev =       0.688873911157
             le_variance =       0.474547265473

ERROR CostFunction-> Number of Effective Walkers is too small! 
  Number of effective walkers (samples) / total number of samples = 6.54052e-05
  User specified threshold minwalkers = 0.3
  If this message appears frequently. You might have to be cautious. 
  Find info about parameter "minwalkers" in the user manual!
Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.473035272684
                                         uncertainty =       0.002982138018

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.473035272684
                                         uncertainty =       0.002982138018

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000486308677
  error estimate for blocks of size 2^( 2) =       0.000508066762
  error estimate for blocks of size 2^( 3) =       0.000528229762
  error estimate for blocks of size 2^( 4) =       0.000543145863
  error estimate for blocks of size 2^( 5) =       0.000552228025
  error estimate for blocks of size 2^( 6) =       0.000557951390
  error estimate for blocks of size 2^( 7) =       0.000562329504

      target function =                  N/A
              le_mean =     -22.819913443782
             les_mean =     521.416781645722
             stat err =       0.000553913695
             autocorr =       1.297359001631
              std dev =       0.687744326160
             le_variance =       0.472992258165


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.820206887754        initial  <--
     3.8147e-02     3.8147e-01             4.1744e-03       -22.819907593240
     1.5259e-01     1.5259e+00             2.0510e-03       -22.819946493559
     6.1035e-01     6.1035e+00             8.3963e-04       -22.819913443782

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 44.0889
  </log>
  <optVariables href="FORM.s013.opt.xml">
ci_01                 1.198157e-01 3 1  ON 0
ci_02                -2.612304e-02 3 1  ON 1
ci_03                -2.558419e-02 3 1  ON 2
ci_04                 2.524426e-02 3 1  ON 3
ci_05                -2.254535e-02 3 1  ON 4
ci_06                -2.271172e-02 3 1  ON 5
ci_07                 2.734600e-02 3 1  ON 6
ci_08                -4.270792e-03 3 1  ON 7
ci_09                -1.308353e-02 3 1  ON 8
ci_10                -1.164194e-02 3 1  ON 9
ci_11                 1.576393e-02 3 1  ON 10
ci_12                 1.097629e-02 3 1  ON 11
ci_13                 1.141141e-02 3 1  ON 12
ci_14                 1.409666e-02 3 1  ON 13
ci_15                 8.766626e-03 3 1  ON 14
ci_16                 8.282841e-03 3 1  ON 15
ci_17                -9.427140e-03 3 1  ON 16
ci_18                -1.020387e-02 3 1  ON 17
ci_19                 9.515211e-03 3 1  ON 18
ci_20                 1.093080e-02 3 1  ON 19
ci_21                 8.262482e-03 3 1  ON 20
ci_22                 9.894240e-03 3 1  ON 21
ci_23                 5.910297e-03 3 1  ON 22
ci_24                 7.143348e-03 3 1  ON 23
ci_25                 4.355659e-03 3 1  ON 24
ci_26                 2.501439e-03 3 1  ON 25
ci_27                 3.411394e-04 3 1  ON 26
ci_28                 3.784498e-03 3 1  ON 27
ci_29                 3.492757e-03 3 1  ON 28
ci_30                 8.892881e-04 3 1  ON 29
ci_31                 2.179635e-04 3 1  ON 30
ci_32                 4.112074e-04 3 1  ON 31
ci_33                -5.449934e-04 3 1  ON 32
ci_34                 8.882144e-04 3 1  ON 33
ci_35                 2.459146e-04 3 1  ON 34
ci_36                -3.208400e-03 3 1  ON 35
ci_37                -1.152975e-03 3 1  ON 36
ci_38                -3.996411e-04 3 1  ON 37
ci_39                -2.444603e-04 3 1  ON 38
ci_40                -1.478833e-03 3 1  ON 39
ci_41                 3.802531e-04 3 1  ON 40
ci_42                 2.164164e-04 3 1  ON 41
ci_43                -2.587747e-03 3 1  ON 42
ci_44                -1.693910e-03 3 1  ON 43
ci_45                -5.007743e-04 3 1  ON 44
ci_46                 2.350166e-05 3 1  ON 45
ci_47                -7.112536e-04 3 1  ON 46
ci_48                -4.886658e-04 3 1  ON 47
ci_49                -1.416771e-03 3 1  ON 48
ci_50                -2.748594e-04 3 1  ON 49
ci_51                 4.525075e-04 3 1  ON 50
ci_52                -2.574678e-04 3 1  ON 51
ci_53                -1.452345e-03 3 1  ON 52
ci_54                 2.847888e-04 3 1  ON 53
ci_55                -2.472500e-04 3 1  ON 54
ci_56                 1.686161e-03 3 1  ON 55
ci_57                 1.697235e-03 3 1  ON 56
ci_58                -1.365542e-03 3 1  ON 57
ci_59                -1.911708e-03 3 1  ON 58
ci_60                 2.000379e-03 3 1  ON 59
ci_61                 1.268425e-03 3 1  ON 60
ci_62                -3.950942e-04 3 1  ON 61
ci_63                -9.640791e-04 3 1  ON 62
ci_64                -5.579070e-04 3 1  ON 63
ci_65                 2.550810e-04 3 1  ON 64
ci_66                -7.570220e-04 3 1  ON 65
ci_67                -7.310440e-04 3 1  ON 66
ci_68                -1.285773e-03 3 1  ON 67
ci_69                -1.394579e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.7019e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s014 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s014 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=14  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2833e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 14
    time step          = 0.05
    reference energy   = -22.8317
    reference variance = 0.439796
====================================================
  Execution time = 2.5832e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s014
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5341e+04
  VMC Eavg = -2.2819e+01
  VMC Evar = 4.8284e-01
  Total weights = 1.963733813e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.6161e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.467682073641
                                         uncertainty =       0.002390361134

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.467682073641
                                         uncertainty =       0.002390361134

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000483565565
  error estimate for blocks of size 2^( 2) =       0.000505165239
  error estimate for blocks of size 2^( 3) =       0.000525728740
  error estimate for blocks of size 2^( 4) =       0.000541317954
  error estimate for blocks of size 2^( 5) =       0.000551156762
  error estimate for blocks of size 2^( 6) =       0.000556796288
  error estimate for blocks of size 2^( 7) =       0.000559861706

      target function =                  N/A
              le_mean =     -22.818782733745
             les_mean =     521.179683071276
             stat err =       0.000552283177
             autocorr =       1.304406325249
              std dev =       0.683864979978
             le_variance =       0.467671310841


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281878273375e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.8147e-01, overlap shift 3.8147e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.818782733654       residual = 2.00e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.818799620372       residual = 2.18e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.818799592554       residual = 3.94e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.818799642866       residual = 9.98e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.8147e-01 is 9.033029e-04

solving harmonic davidson linear method for identity shift 1.5259e+00, overlap shift 1.5259e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.818782733654       residual = 2.00e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.818788477807       residual = 1.71e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.818788266490       residual = 2.47e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.818788280147       residual = 3.19e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.5259e+00 is 3.264788e-04

solving harmonic davidson linear method for identity shift 6.1035e+00, overlap shift 6.1035e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.818782733654       residual = 2.00e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.818784311991       residual = 2.14e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.818784236539       residual = 4.22e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.818784242758       residual = 7.70e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 6.1035e+00 is 9.187491e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.281124 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0464e+01
  </log>
  <optVariables href="FORM.s014.opt.xml">
ci_01                 1.196743e-01 3 1  ON 0
ci_02                -2.613009e-02 3 1  ON 1
ci_03                -2.553852e-02 3 1  ON 2
ci_04                 2.518546e-02 3 1  ON 3
ci_05                -2.251147e-02 3 1  ON 4
ci_06                -2.278404e-02 3 1  ON 5
ci_07                 2.729433e-02 3 1  ON 6
ci_08                -4.324757e-03 3 1  ON 7
ci_09                -1.300583e-02 3 1  ON 8
ci_10                -1.153051e-02 3 1  ON 9
ci_11                 1.579750e-02 3 1  ON 10
ci_12                 1.094451e-02 3 1  ON 11
ci_13                 1.144426e-02 3 1  ON 12
ci_14                 1.412665e-02 3 1  ON 13
ci_15                 8.695266e-03 3 1  ON 14
ci_16                 8.331537e-03 3 1  ON 15
ci_17                -9.404350e-03 3 1  ON 16
ci_18                -1.007307e-02 3 1  ON 17
ci_19                 9.565337e-03 3 1  ON 18
ci_20                 1.091373e-02 3 1  ON 19
ci_21                 8.351343e-03 3 1  ON 20
ci_22                 9.803680e-03 3 1  ON 21
ci_23                 5.918881e-03 3 1  ON 22
ci_24                 7.208318e-03 3 1  ON 23
ci_25                 4.386771e-03 3 1  ON 24
ci_26                 2.414037e-03 3 1  ON 25
ci_27                 4.466704e-04 3 1  ON 26
ci_28                 3.915439e-03 3 1  ON 27
ci_29                 3.678680e-03 3 1  ON 28
ci_30                 9.074361e-04 3 1  ON 29
ci_31                 1.758599e-04 3 1  ON 30
ci_32                 2.473713e-04 3 1  ON 31
ci_33                -6.105699e-04 3 1  ON 32
ci_34                 8.800634e-04 3 1  ON 33
ci_35                 2.786810e-04 3 1  ON 34
ci_36                -2.881922e-03 3 1  ON 35
ci_37                -1.003847e-03 3 1  ON 36
ci_38                -3.759087e-04 3 1  ON 37
ci_39                -2.679579e-04 3 1  ON 38
ci_40                -1.381905e-03 3 1  ON 39
ci_41                 2.685686e-04 3 1  ON 40
ci_42                 1.876974e-04 3 1  ON 41
ci_43                -2.665288e-03 3 1  ON 42
ci_44                -1.624635e-03 3 1  ON 43
ci_45                -3.505207e-04 3 1  ON 44
ci_46                -6.812315e-05 3 1  ON 45
ci_47                -6.241523e-04 3 1  ON 46
ci_48                -5.952380e-04 3 1  ON 47
ci_49                -1.360146e-03 3 1  ON 48
ci_50                -2.934270e-04 3 1  ON 49
ci_51                 2.624843e-04 3 1  ON 50
ci_52                -1.475345e-04 3 1  ON 51
ci_53                -1.445779e-03 3 1  ON 52
ci_54                 1.339391e-04 3 1  ON 53
ci_55                -1.968955e-04 3 1  ON 54
ci_56                 1.766722e-03 3 1  ON 55
ci_57                 1.674768e-03 3 1  ON 56
ci_58                -1.443795e-03 3 1  ON 57
ci_59                -1.836208e-03 3 1  ON 58
ci_60                 1.855666e-03 3 1  ON 59
ci_61                 1.261553e-03 3 1  ON 60
ci_62                -2.160516e-04 3 1  ON 61
ci_63                -8.966675e-04 3 1  ON 62
ci_64                -6.423106e-04 3 1  ON 63
ci_65                 1.266653e-04 3 1  ON 64
ci_66                -7.067096e-04 3 1  ON 65
ci_67                -6.108939e-04 3 1  ON 66
ci_68                -1.118185e-03 3 1  ON 67
ci_69                -1.384194e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 14
    time step          = 0.05
    reference energy   = -22.8535
    reference variance = 0.386957
====================================================
  Execution time = 2.5345e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s014
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2820e+01
  VMC Evar = 4.9383e-01
  Total weights = 1.9637e+06
  Execution time = 3.5586e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.476229840063
                                         uncertainty =       0.002912514907

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.476229840063
                                         uncertainty =       0.002912514907

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000487993877
  error estimate for blocks of size 2^( 2) =       0.000509292281
  error estimate for blocks of size 2^( 3) =       0.000529488868
  error estimate for blocks of size 2^( 4) =       0.000544808689
  error estimate for blocks of size 2^( 5) =       0.000555178711
  error estimate for blocks of size 2^( 6) =       0.000561535017
  error estimate for blocks of size 2^( 7) =       0.000561472767

      target function =                  N/A
              le_mean =     -22.819605002889
             les_mean =     521.283834146710
             stat err =       0.000555748796
             autocorr =       1.296965174908
              std dev =       0.690127559691
             le_variance =       0.476276048645

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.476168893506
                                         uncertainty =       0.002921834442

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.476168893506
                                         uncertainty =       0.002921834442

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000487961848
  error estimate for blocks of size 2^( 2) =       0.000509266503
  error estimate for blocks of size 2^( 3) =       0.000529472859
  error estimate for blocks of size 2^( 4) =       0.000544802495
  error estimate for blocks of size 2^( 5) =       0.000555167268
  error estimate for blocks of size 2^( 6) =       0.000561540531
  error estimate for blocks of size 2^( 7) =       0.000561484832

      target function =                  N/A
              le_mean =     -22.819605667757
             les_mean =     521.228439786998
             stat err =       0.000555748782
             autocorr =       1.297135378263
              std dev =       0.690082262769
             le_variance =       0.476213529388

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.476172025955
                                         uncertainty =       0.002918392620

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.476172025955
                                         uncertainty =       0.002918392620

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000487963719
  error estimate for blocks of size 2^( 2) =       0.000509265688
  error estimate for blocks of size 2^( 3) =       0.000529469045
  error estimate for blocks of size 2^( 4) =       0.000544793147
  error estimate for blocks of size 2^( 5) =       0.000555157475
  error estimate for blocks of size 2^( 6) =       0.000561524342
  error estimate for blocks of size 2^( 7) =       0.000561461356

      target function =                  N/A
              le_mean =     -22.819602149952
             les_mean =     521.227824649303
             stat err =       0.000555734080
             autocorr =       1.297056804247
              std dev =       0.690084908704
             le_variance =       0.476217181222

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.476214155664
                                         uncertainty =       0.002913040785

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.476214155664
                                         uncertainty =       0.002913040785

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000487985771
  error estimate for blocks of size 2^( 2) =       0.000509284372
  error estimate for blocks of size 2^( 3) =       0.000529480662
  error estimate for blocks of size 2^( 4) =       0.000544800352
  error estimate for blocks of size 2^( 5) =       0.000555168910
  error estimate for blocks of size 2^( 6) =       0.000561527288
  error estimate for blocks of size 2^( 7) =       0.000561463601

      target function =                  N/A
              le_mean =     -22.819603074507
             les_mean =     521.234208210971
             stat err =       0.000555740038
             autocorr =       1.296967385942
              std dev =       0.690116095490
             le_variance =       0.476260225255


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.819605002889        initial
     3.8147e-01     3.8147e+00             9.0330e-04       -22.819605667757  <--
     1.5259e+00     1.5259e+01             3.2648e-04       -22.819602149952
     6.1035e+00     6.1035e+01             9.1875e-05       -22.819603074507

*****************************************************************************
Applying the update for shift_i =   3.8147e-01     and shift_s =   3.8147e+00
*****************************************************************************

  Execution time = 4.3161e+01
  </log>
  <optVariables href="FORM.s014.opt.xml">
ci_01                 1.193264e-01 3 1  ON 0
ci_02                -2.615227e-02 3 1  ON 1
ci_03                -2.545057e-02 3 1  ON 2
ci_04                 2.505666e-02 3 1  ON 3
ci_05                -2.244790e-02 3 1  ON 4
ci_06                -2.293658e-02 3 1  ON 5
ci_07                 2.717084e-02 3 1  ON 6
ci_08                -4.404440e-03 3 1  ON 7
ci_09                -1.283408e-02 3 1  ON 8
ci_10                -1.128677e-02 3 1  ON 9
ci_11                 1.586710e-02 3 1  ON 10
ci_12                 1.088027e-02 3 1  ON 11
ci_13                 1.152178e-02 3 1  ON 12
ci_14                 1.420390e-02 3 1  ON 13
ci_15                 8.547384e-03 3 1  ON 14
ci_16                 8.450364e-03 3 1  ON 15
ci_17                -9.353747e-03 3 1  ON 16
ci_18                -9.810684e-03 3 1  ON 17
ci_19                 9.640063e-03 3 1  ON 18
ci_20                 1.088591e-02 3 1  ON 19
ci_21                 8.559885e-03 3 1  ON 20
ci_22                 9.591865e-03 3 1  ON 21
ci_23                 5.929991e-03 3 1  ON 22
ci_24                 7.355863e-03 3 1  ON 23
ci_25                 4.444256e-03 3 1  ON 24
ci_26                 2.234093e-03 3 1  ON 25
ci_27                 6.789083e-04 3 1  ON 26
ci_28                 4.174378e-03 3 1  ON 27
ci_29                 4.056864e-03 3 1  ON 28
ci_30                 9.420017e-04 3 1  ON 29
ci_31                 9.694606e-05 3 1  ON 30
ci_32                -5.623340e-05 3 1  ON 31
ci_33                -7.234505e-04 3 1  ON 32
ci_34                 8.635213e-04 3 1  ON 33
ci_35                 3.397555e-04 3 1  ON 34
ci_36                -2.305098e-03 3 1  ON 35
ci_37                -7.583094e-04 3 1  ON 36
ci_38                -3.387415e-04 3 1  ON 37
ci_39                -3.150797e-04 3 1  ON 38
ci_40                -1.234384e-03 3 1  ON 39
ci_41                 7.080152e-05 3 1  ON 40
ci_42                 1.338958e-04 3 1  ON 41
ci_43                -2.828317e-03 3 1  ON 42
ci_44                -1.500564e-03 3 1  ON 43
ci_45                -9.104545e-05 3 1  ON 44
ci_46                -2.449541e-04 3 1  ON 45
ci_47                -4.283925e-04 3 1  ON 46
ci_48                -8.430784e-04 3 1  ON 47
ci_49                -1.249973e-03 3 1  ON 48
ci_50                -3.285224e-04 3 1  ON 49
ci_51                -8.260741e-05 3 1  ON 50
ci_52                 4.898371e-05 3 1  ON 51
ci_53                -1.432199e-03 3 1  ON 52
ci_54                -1.772713e-04 3 1  ON 53
ci_55                -9.459578e-05 3 1  ON 54
ci_56                 1.899613e-03 3 1  ON 55
ci_57                 1.618137e-03 3 1  ON 56
ci_58                -1.602741e-03 3 1  ON 57
ci_59                -1.683020e-03 3 1  ON 58
ci_60                 1.487483e-03 3 1  ON 59
ci_61                 1.244290e-03 3 1  ON 60
ci_62                 7.262809e-05 3 1  ON 61
ci_63                -7.956384e-04 3 1  ON 62
ci_64                -8.039424e-04 3 1  ON 63
ci_65                -1.160049e-04 3 1  ON 64
ci_66                -6.198911e-04 3 1  ON 65
ci_67                -3.854045e-04 3 1  ON 66
ci_68                -7.862550e-04 3 1  ON 67
ci_69                -1.354556e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.3637e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s015 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s015 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=15  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2833e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 15
    time step          = 0.05
    reference energy   = -22.7083
    reference variance = 0.563994
====================================================
  Execution time = 2.5819e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s015
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5341e+04
  VMC Eavg = -2.2819e+01
  VMC Evar = 4.8529e-01
  Total weights = 1.963517279e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.5272e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.468679462658
                                         uncertainty =       0.002087767143

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.468679462658
                                         uncertainty =       0.002087767143

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000484062844
  error estimate for blocks of size 2^( 2) =       0.000505013575
  error estimate for blocks of size 2^( 3) =       0.000525605429
  error estimate for blocks of size 2^( 4) =       0.000542040683
  error estimate for blocks of size 2^( 5) =       0.000552072382
  error estimate for blocks of size 2^( 6) =       0.000557697987
  error estimate for blocks of size 2^( 7) =       0.000559924397

      target function =                  N/A
              le_mean =     -22.819303323418
             les_mean =     521.205891294746
             stat err =       0.000552933862
             autocorr =       1.304796786402
              std dev =       0.684568239171
             le_variance =       0.468633674082


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281930332342e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.5367e-02, overlap shift 9.5367e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.819303323338       residual = 2.09e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.819343781526       residual = 1.13e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.819345006939       residual = 1.04e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.819345905714       residual = 7.17e-08           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.819346017050       residual = 3.28e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          4 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.5367e-02 is 2.313967e-03

solving harmonic davidson linear method for identity shift 3.8147e-01, overlap shift 3.8147e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.819303323338       residual = 2.09e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.819324227273       residual = 3.70e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.819324242333       residual = 9.04e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.819324273950       residual = 2.08e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.8147e-01 is 1.190284e-03

solving harmonic davidson linear method for identity shift 1.5259e+00, overlap shift 1.5259e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.819303323338       residual = 2.09e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.819310449785       residual = 1.93e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.819310436646       residual = 2.11e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.819310440486       residual = 5.31e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.5259e+00 is 4.301969e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.282529 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0356e+01
  </log>
  <optVariables href="FORM.s015.opt.xml">
ci_01                 1.184464e-01 3 1  ON 0
ci_02                -2.612886e-02 3 1  ON 1
ci_03                -2.535724e-02 3 1  ON 2
ci_04                 2.494181e-02 3 1  ON 3
ci_05                -2.269877e-02 3 1  ON 4
ci_06                -2.278057e-02 3 1  ON 5
ci_07                 2.640863e-02 3 1  ON 6
ci_08                -4.262786e-03 3 1  ON 7
ci_09                -1.259008e-02 3 1  ON 8
ci_10                -1.122375e-02 3 1  ON 9
ci_11                 1.627607e-02 3 1  ON 10
ci_12                 1.084774e-02 3 1  ON 11
ci_13                 1.147523e-02 3 1  ON 12
ci_14                 1.435273e-02 3 1  ON 13
ci_15                 8.621742e-03 3 1  ON 14
ci_16                 8.232495e-03 3 1  ON 15
ci_17                -9.271081e-03 3 1  ON 16
ci_18                -9.988788e-03 3 1  ON 17
ci_19                 9.392955e-03 3 1  ON 18
ci_20                 1.075174e-02 3 1  ON 19
ci_21                 8.593102e-03 3 1  ON 20
ci_22                 9.351075e-03 3 1  ON 21
ci_23                 5.837321e-03 3 1  ON 22
ci_24                 7.229943e-03 3 1  ON 23
ci_25                 4.402420e-03 3 1  ON 24
ci_26                 2.404862e-03 3 1  ON 25
ci_27                 1.232297e-03 3 1  ON 26
ci_28                 3.803672e-03 3 1  ON 27
ci_29                 3.575067e-03 3 1  ON 28
ci_30                 9.867078e-04 3 1  ON 29
ci_31                 2.220394e-04 3 1  ON 30
ci_32                -1.690478e-04 3 1  ON 31
ci_33                -4.192000e-04 3 1  ON 32
ci_34                 5.686367e-04 3 1  ON 33
ci_35                 6.517772e-04 3 1  ON 34
ci_36                -1.114814e-03 3 1  ON 35
ci_37                -1.188501e-03 3 1  ON 36
ci_38                -3.274386e-04 3 1  ON 37
ci_39                -3.414789e-04 3 1  ON 38
ci_40                -1.367143e-03 3 1  ON 39
ci_41                 3.565371e-04 3 1  ON 40
ci_42                 3.695461e-04 3 1  ON 41
ci_43                -2.566955e-03 3 1  ON 42
ci_44                -1.571961e-03 3 1  ON 43
ci_45                 1.122555e-04 3 1  ON 44
ci_46                -1.361068e-04 3 1  ON 45
ci_47                -9.929130e-04 3 1  ON 46
ci_48                -7.386533e-04 3 1  ON 47
ci_49                -9.764407e-04 3 1  ON 48
ci_50                -6.563650e-04 3 1  ON 49
ci_51                -2.636387e-05 3 1  ON 50
ci_52                 1.500402e-04 3 1  ON 51
ci_53                -1.121362e-03 3 1  ON 52
ci_54                -3.354168e-04 3 1  ON 53
ci_55                -1.386175e-06 3 1  ON 54
ci_56                 2.067409e-03 3 1  ON 55
ci_57                 1.321713e-03 3 1  ON 56
ci_58                -1.553952e-03 3 1  ON 57
ci_59                -1.692851e-03 3 1  ON 58
ci_60                 1.371337e-03 3 1  ON 59
ci_61                 1.127331e-03 3 1  ON 60
ci_62                -1.947902e-05 3 1  ON 61
ci_63                -7.532464e-04 3 1  ON 62
ci_64                -8.363382e-04 3 1  ON 63
ci_65                -2.456780e-04 3 1  ON 64
ci_66                -5.843398e-04 3 1  ON 65
ci_67                -6.592106e-05 3 1  ON 66
ci_68                -1.535933e-03 3 1  ON 67
ci_69                -1.415568e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 15
    time step          = 0.05
    reference energy   = -22.8008
    reference variance = 0.486631
====================================================
  Execution time = 2.5241e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s015
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2819e+01
  VMC Evar = 4.8345e-01
  Total weights = 1.9635e+06
  Execution time = 3.5445e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.468844180421
                                         uncertainty =       0.002315404118

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.468844180421
                                         uncertainty =       0.002315404118

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000484272988
  error estimate for blocks of size 2^( 2) =       0.000506096591
  error estimate for blocks of size 2^( 3) =       0.000526635116
  error estimate for blocks of size 2^( 4) =       0.000541968401
  error estimate for blocks of size 2^( 5) =       0.000551134455
  error estimate for blocks of size 2^( 6) =       0.000556802531
  error estimate for blocks of size 2^( 7) =       0.000560135053

      target function =                  N/A
              le_mean =     -22.818812942315
             les_mean =     521.197643934194
             stat err =       0.000552510110
             autocorr =       1.301667218476
              std dev =       0.684865427364
             le_variance =       0.469040653598

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.468565992931
                                         uncertainty =       0.002269755226

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.468565992931
                                         uncertainty =       0.002269755226

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000484127263
  error estimate for blocks of size 2^( 2) =       0.000505979787
  error estimate for blocks of size 2^( 3) =       0.000526539889
  error estimate for blocks of size 2^( 4) =       0.000541870361
  error estimate for blocks of size 2^( 5) =       0.000551069396
  error estimate for blocks of size 2^( 6) =       0.000556699754
  error estimate for blocks of size 2^( 7) =       0.000560064384

      target function =                  N/A
              le_mean =     -22.818826196790
             les_mean =     521.202315952611
             stat err =       0.000552425974
             autocorr =       1.302054307679
              std dev =       0.684659341756
             le_variance =       0.468758414254

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.468607244029
                                         uncertainty =       0.002272086631

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.468607244029
                                         uncertainty =       0.002272086631

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000484148823
  error estimate for blocks of size 2^( 2) =       0.000506000347
  error estimate for blocks of size 2^( 3) =       0.000526555772
  error estimate for blocks of size 2^( 4) =       0.000541881110
  error estimate for blocks of size 2^( 5) =       0.000551081548
  error estimate for blocks of size 2^( 6) =       0.000556707733
  error estimate for blocks of size 2^( 7) =       0.000560077543

      target function =                  N/A
              le_mean =     -22.818829142916
             les_mean =     521.185693027387
             stat err =       0.000552436983
             autocorr =       1.301990240286
              std dev =       0.684689832343
             le_variance =       0.468800166514

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.468699307293
                                         uncertainty =       0.002309028369

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.468699307293
                                         uncertainty =       0.002309028369

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000484197885
  error estimate for blocks of size 2^( 2) =       0.000506025330
  error estimate for blocks of size 2^( 3) =       0.000526568567
  error estimate for blocks of size 2^( 4) =       0.000541900591
  error estimate for blocks of size 2^( 5) =       0.000551076018
  error estimate for blocks of size 2^( 6) =       0.000556740104
  error estimate for blocks of size 2^( 7) =       0.000560082457

      target function =                  N/A
              le_mean =     -22.818809357201
             les_mean =     521.183109379967
             stat err =       0.000552449793
             autocorr =       1.301786771953
              std dev =       0.684759215353
             le_variance =       0.468895183011


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.818812942315        initial
     9.5367e-02     9.5367e-01             2.3140e-03       -22.818826196790
     3.8147e-01     3.8147e+00             1.1903e-03       -22.818829142916  <--
     1.5259e+00     1.5259e+01             4.3020e-04       -22.818809357201

*****************************************************************************
Applying the update for shift_i =   3.8147e-01     and shift_s =   3.8147e+00
*****************************************************************************

  Execution time = 4.3045e+01
  </log>
  <optVariables href="FORM.s015.opt.xml">
ci_01                 1.184464e-01 3 1  ON 0
ci_02                -2.612886e-02 3 1  ON 1
ci_03                -2.535724e-02 3 1  ON 2
ci_04                 2.494181e-02 3 1  ON 3
ci_05                -2.269877e-02 3 1  ON 4
ci_06                -2.278057e-02 3 1  ON 5
ci_07                 2.640863e-02 3 1  ON 6
ci_08                -4.262786e-03 3 1  ON 7
ci_09                -1.259008e-02 3 1  ON 8
ci_10                -1.122375e-02 3 1  ON 9
ci_11                 1.627607e-02 3 1  ON 10
ci_12                 1.084774e-02 3 1  ON 11
ci_13                 1.147523e-02 3 1  ON 12
ci_14                 1.435273e-02 3 1  ON 13
ci_15                 8.621742e-03 3 1  ON 14
ci_16                 8.232495e-03 3 1  ON 15
ci_17                -9.271081e-03 3 1  ON 16
ci_18                -9.988788e-03 3 1  ON 17
ci_19                 9.392955e-03 3 1  ON 18
ci_20                 1.075174e-02 3 1  ON 19
ci_21                 8.593102e-03 3 1  ON 20
ci_22                 9.351075e-03 3 1  ON 21
ci_23                 5.837321e-03 3 1  ON 22
ci_24                 7.229943e-03 3 1  ON 23
ci_25                 4.402420e-03 3 1  ON 24
ci_26                 2.404862e-03 3 1  ON 25
ci_27                 1.232297e-03 3 1  ON 26
ci_28                 3.803672e-03 3 1  ON 27
ci_29                 3.575067e-03 3 1  ON 28
ci_30                 9.867078e-04 3 1  ON 29
ci_31                 2.220394e-04 3 1  ON 30
ci_32                -1.690478e-04 3 1  ON 31
ci_33                -4.192000e-04 3 1  ON 32
ci_34                 5.686367e-04 3 1  ON 33
ci_35                 6.517772e-04 3 1  ON 34
ci_36                -1.114814e-03 3 1  ON 35
ci_37                -1.188501e-03 3 1  ON 36
ci_38                -3.274386e-04 3 1  ON 37
ci_39                -3.414789e-04 3 1  ON 38
ci_40                -1.367143e-03 3 1  ON 39
ci_41                 3.565371e-04 3 1  ON 40
ci_42                 3.695461e-04 3 1  ON 41
ci_43                -2.566955e-03 3 1  ON 42
ci_44                -1.571961e-03 3 1  ON 43
ci_45                 1.122555e-04 3 1  ON 44
ci_46                -1.361068e-04 3 1  ON 45
ci_47                -9.929130e-04 3 1  ON 46
ci_48                -7.386533e-04 3 1  ON 47
ci_49                -9.764407e-04 3 1  ON 48
ci_50                -6.563650e-04 3 1  ON 49
ci_51                -2.636387e-05 3 1  ON 50
ci_52                 1.500402e-04 3 1  ON 51
ci_53                -1.121362e-03 3 1  ON 52
ci_54                -3.354168e-04 3 1  ON 53
ci_55                -1.386175e-06 3 1  ON 54
ci_56                 2.067409e-03 3 1  ON 55
ci_57                 1.321713e-03 3 1  ON 56
ci_58                -1.553952e-03 3 1  ON 57
ci_59                -1.692851e-03 3 1  ON 58
ci_60                 1.371337e-03 3 1  ON 59
ci_61                 1.127331e-03 3 1  ON 60
ci_62                -1.947902e-05 3 1  ON 61
ci_63                -7.532464e-04 3 1  ON 62
ci_64                -8.363382e-04 3 1  ON 63
ci_65                -2.456780e-04 3 1  ON 64
ci_66                -5.843398e-04 3 1  ON 65
ci_67                -6.592106e-05 3 1  ON 66
ci_68                -1.535933e-03 3 1  ON 67
ci_69                -1.415568e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.3407e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s016 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s016 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=16  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2828e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 16
    time step          = 0.05
    reference energy   = -22.8302
    reference variance = 0.281166
====================================================
  Execution time = 2.5754e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s016
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5347e+04
  VMC Eavg = -2.2819e+01
  VMC Evar = 4.8629e-01
  Total weights = 1.964238791e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.6001e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.471346024465
                                         uncertainty =       0.002838078795

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.471346024465
                                         uncertainty =       0.002838078795

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000485485549
  error estimate for blocks of size 2^( 2) =       0.000507113844
  error estimate for blocks of size 2^( 3) =       0.000527018275
  error estimate for blocks of size 2^( 4) =       0.000542380637
  error estimate for blocks of size 2^( 5) =       0.000551928613
  error estimate for blocks of size 2^( 6) =       0.000557007523
  error estimate for blocks of size 2^( 7) =       0.000559788303

      target function =                  N/A
              le_mean =     -22.819385407450
             les_mean =     521.210638090519
             stat err =       0.000552776269
             autocorr =       1.296421326269
              std dev =       0.686580247077
             le_variance =       0.471392435677


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281938540745e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.5367e-02, overlap shift 9.5367e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.819385407408       residual = 1.63e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.819403444659       residual = 7.98e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.819405560684       residual = 6.09e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.819405762803       residual = 5.55e-08           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.819405809356       residual = 4.31e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          4 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.5367e-02 is 1.070039e-03

solving harmonic davidson linear method for identity shift 3.8147e-01, overlap shift 3.8147e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.819385407408       residual = 1.63e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.819394645750       residual = 2.14e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.819394682936       residual = 3.34e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.819394653779       residual = 1.04e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.8147e-01 is 4.966721e-04

solving harmonic davidson linear method for identity shift 1.5259e+00, overlap shift 1.5259e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.819385407408       residual = 1.63e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.819388537692       residual = 9.31e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.819388375520       residual = 1.42e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.819388343348       residual = 3.82e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.5259e+00 is 1.663562e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.283932 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0363e+01
  </log>
  <optVariables href="FORM.s016.opt.xml">
ci_01                 1.180418e-01 3 1  ON 0
ci_02                -2.621783e-02 3 1  ON 1
ci_03                -2.557354e-02 3 1  ON 2
ci_04                 2.471901e-02 3 1  ON 3
ci_05                -2.269207e-02 3 1  ON 4
ci_06                -2.269384e-02 3 1  ON 5
ci_07                 2.641018e-02 3 1  ON 6
ci_08                -4.254485e-03 3 1  ON 7
ci_09                -1.245358e-02 3 1  ON 8
ci_10                -1.132809e-02 3 1  ON 9
ci_11                 1.607817e-02 3 1  ON 10
ci_12                 1.112897e-02 3 1  ON 11
ci_13                 1.104266e-02 3 1  ON 12
ci_14                 1.465354e-02 3 1  ON 13
ci_15                 8.217003e-03 3 1  ON 14
ci_16                 7.915065e-03 3 1  ON 15
ci_17                -9.664139e-03 3 1  ON 16
ci_18                -9.908169e-03 3 1  ON 17
ci_19                 9.623415e-03 3 1  ON 18
ci_20                 1.069515e-02 3 1  ON 19
ci_21                 8.426592e-03 3 1  ON 20
ci_22                 9.000962e-03 3 1  ON 21
ci_23                 5.900147e-03 3 1  ON 22
ci_24                 7.129157e-03 3 1  ON 23
ci_25                 3.950501e-03 3 1  ON 24
ci_26                 2.668333e-03 3 1  ON 25
ci_27                 1.645376e-03 3 1  ON 26
ci_28                 3.672692e-03 3 1  ON 27
ci_29                 3.573167e-03 3 1  ON 28
ci_30                 7.349532e-04 3 1  ON 29
ci_31                 3.868404e-04 3 1  ON 30
ci_32                -2.995373e-05 3 1  ON 31
ci_33                -5.953172e-04 3 1  ON 32
ci_34                 2.198486e-04 3 1  ON 33
ci_35                 4.634707e-04 3 1  ON 34
ci_36                -8.691729e-04 3 1  ON 35
ci_37                -1.073819e-03 3 1  ON 36
ci_38                -1.695656e-05 3 1  ON 37
ci_39                -6.456303e-04 3 1  ON 38
ci_40                -1.790655e-03 3 1  ON 39
ci_41                 6.565962e-04 3 1  ON 40
ci_42                -4.178656e-05 3 1  ON 41
ci_43                -2.530382e-03 3 1  ON 42
ci_44                -1.798750e-03 3 1  ON 43
ci_45                 6.197511e-05 3 1  ON 44
ci_46                -4.190757e-04 3 1  ON 45
ci_47                -7.205590e-04 3 1  ON 46
ci_48                -9.503098e-04 3 1  ON 47
ci_49                -1.206993e-03 3 1  ON 48
ci_50                -8.619896e-04 3 1  ON 49
ci_51                -3.323932e-04 3 1  ON 50
ci_52                 3.580315e-04 3 1  ON 51
ci_53                -1.127190e-03 3 1  ON 52
ci_54                -3.838049e-04 3 1  ON 53
ci_55                -4.866532e-04 3 1  ON 54
ci_56                 1.793017e-03 3 1  ON 55
ci_57                 1.609806e-03 3 1  ON 56
ci_58                -1.312444e-03 3 1  ON 57
ci_59                -1.196179e-03 3 1  ON 58
ci_60                 1.754284e-03 3 1  ON 59
ci_61                 1.062115e-03 3 1  ON 60
ci_62                 5.693105e-06 3 1  ON 61
ci_63                -7.255594e-04 3 1  ON 62
ci_64                -4.812225e-04 3 1  ON 63
ci_65                -5.487709e-04 3 1  ON 64
ci_66                -4.401894e-04 3 1  ON 65
ci_67                -5.160306e-04 3 1  ON 66
ci_68                -1.853992e-03 3 1  ON 67
ci_69                -1.800327e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 16
    time step          = 0.05
    reference energy   = -22.8675
    reference variance = 0.389051
====================================================
  Execution time = 2.5254e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s016
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2819e+01
  VMC Evar = 4.8216e-01
  Total weights = 1.9637e+06
  Execution time = 3.5457e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

ERROR CostFunction-> Number of Effective Walkers is too small! 
  Number of effective walkers (samples) / total number of samples = 0.168875
  User specified threshold minwalkers = 0.3
  If this message appears frequently. You might have to be cautious. 
  Find info about parameter "minwalkers" in the user manual!
Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.470169400073
                                         uncertainty =       0.002342627008

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.470169400073
                                         uncertainty =       0.002342627008

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000484900322
  error estimate for blocks of size 2^( 2) =       0.000506471572
  error estimate for blocks of size 2^( 3) =       0.000527555349
  error estimate for blocks of size 2^( 4) =       0.000544391130
  error estimate for blocks of size 2^( 5) =       0.000554830366
  error estimate for blocks of size 2^( 6) =       0.000560928074
  error estimate for blocks of size 2^( 7) =       0.000565126115

      target function =                  N/A
              le_mean =     -22.818516185227
             les_mean =     521.202904121667
             stat err =       0.000556318922
             autocorr =       1.316263134231
              std dev =       0.685752611891
             le_variance =       0.470256644715

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.470163596987
                                         uncertainty =       0.002352623802

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.470163596987
                                         uncertainty =       0.002352623802

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000484898204
  error estimate for blocks of size 2^( 2) =       0.000506481373
  error estimate for blocks of size 2^( 3) =       0.000527598775
  error estimate for blocks of size 2^( 4) =       0.000544449815
  error estimate for blocks of size 2^( 5) =       0.000554882353
  error estimate for blocks of size 2^( 6) =       0.000560973847
  error estimate for blocks of size 2^( 7) =       0.000565221571

      target function =                  N/A
              le_mean =     -22.818525824774
             les_mean =     521.169833165038
             stat err =       0.000556381897
             autocorr =       1.316572652706
              std dev =       0.685749616653
             le_variance =       0.470252536740

ERROR CostFunction-> Number of Effective Walkers is too small! 
  Number of effective walkers (samples) / total number of samples = 0.16247
  User specified threshold minwalkers = 0.3
  If this message appears frequently. You might have to be cautious. 
  Find info about parameter "minwalkers" in the user manual!
Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.470165150266
                                         uncertainty =       0.002352270228

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.470165150266
                                         uncertainty =       0.002352270228

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000484899002
  error estimate for blocks of size 2^( 2) =       0.000506481927
  error estimate for blocks of size 2^( 3) =       0.000527595563
  error estimate for blocks of size 2^( 4) =       0.000544443283
  error estimate for blocks of size 2^( 5) =       0.000554875053
  error estimate for blocks of size 2^( 6) =       0.000560972910
  error estimate for blocks of size 2^( 7) =       0.000565234374

      target function =                  N/A
              le_mean =     -22.818526277112
             les_mean =     521.169139694257
             stat err =       0.000556381405
             autocorr =       1.316565994013
              std dev =       0.685750744837
             le_variance =       0.470254084044

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.470116100939
                                         uncertainty =       0.002342562935

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.470116100939
                                         uncertainty =       0.002342562935

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000484872988
  error estimate for blocks of size 2^( 2) =       0.000506446937
  error estimate for blocks of size 2^( 3) =       0.000527536841
  error estimate for blocks of size 2^( 4) =       0.000544369764
  error estimate for blocks of size 2^( 5) =       0.000554815414
  error estimate for blocks of size 2^( 6) =       0.000560922216
  error estimate for blocks of size 2^( 7) =       0.000565137419

      target function =                  N/A
              le_mean =     -22.818519616326
             les_mean =     521.167991477115
             stat err =       0.000556311203
             autocorr =       1.316375015866
              std dev =       0.685713955578
             le_variance =       0.470203628875


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.818516185227        initial
     9.5367e-02     9.5367e-01             1.0700e-03       -22.818525824774
     3.8147e-01     3.8147e+00             4.9667e-04       -22.818526277112  <--
     1.5259e+00     1.5259e+01             1.6636e-04       -22.818519616326

*****************************************************************************
Applying the update for shift_i =   3.8147e-01     and shift_s =   3.8147e+00
*****************************************************************************

  Execution time = 4.3069e+01
  </log>
  <optVariables href="FORM.s016.opt.xml">
ci_01                 1.180418e-01 3 1  ON 0
ci_02                -2.621783e-02 3 1  ON 1
ci_03                -2.557354e-02 3 1  ON 2
ci_04                 2.471901e-02 3 1  ON 3
ci_05                -2.269207e-02 3 1  ON 4
ci_06                -2.269384e-02 3 1  ON 5
ci_07                 2.641018e-02 3 1  ON 6
ci_08                -4.254485e-03 3 1  ON 7
ci_09                -1.245358e-02 3 1  ON 8
ci_10                -1.132809e-02 3 1  ON 9
ci_11                 1.607817e-02 3 1  ON 10
ci_12                 1.112897e-02 3 1  ON 11
ci_13                 1.104266e-02 3 1  ON 12
ci_14                 1.465354e-02 3 1  ON 13
ci_15                 8.217003e-03 3 1  ON 14
ci_16                 7.915065e-03 3 1  ON 15
ci_17                -9.664139e-03 3 1  ON 16
ci_18                -9.908169e-03 3 1  ON 17
ci_19                 9.623415e-03 3 1  ON 18
ci_20                 1.069515e-02 3 1  ON 19
ci_21                 8.426592e-03 3 1  ON 20
ci_22                 9.000962e-03 3 1  ON 21
ci_23                 5.900147e-03 3 1  ON 22
ci_24                 7.129157e-03 3 1  ON 23
ci_25                 3.950501e-03 3 1  ON 24
ci_26                 2.668333e-03 3 1  ON 25
ci_27                 1.645376e-03 3 1  ON 26
ci_28                 3.672692e-03 3 1  ON 27
ci_29                 3.573167e-03 3 1  ON 28
ci_30                 7.349532e-04 3 1  ON 29
ci_31                 3.868404e-04 3 1  ON 30
ci_32                -2.995373e-05 3 1  ON 31
ci_33                -5.953172e-04 3 1  ON 32
ci_34                 2.198486e-04 3 1  ON 33
ci_35                 4.634707e-04 3 1  ON 34
ci_36                -8.691729e-04 3 1  ON 35
ci_37                -1.073819e-03 3 1  ON 36
ci_38                -1.695656e-05 3 1  ON 37
ci_39                -6.456303e-04 3 1  ON 38
ci_40                -1.790655e-03 3 1  ON 39
ci_41                 6.565962e-04 3 1  ON 40
ci_42                -4.178656e-05 3 1  ON 41
ci_43                -2.530382e-03 3 1  ON 42
ci_44                -1.798750e-03 3 1  ON 43
ci_45                 6.197511e-05 3 1  ON 44
ci_46                -4.190757e-04 3 1  ON 45
ci_47                -7.205590e-04 3 1  ON 46
ci_48                -9.503098e-04 3 1  ON 47
ci_49                -1.206993e-03 3 1  ON 48
ci_50                -8.619896e-04 3 1  ON 49
ci_51                -3.323932e-04 3 1  ON 50
ci_52                 3.580315e-04 3 1  ON 51
ci_53                -1.127190e-03 3 1  ON 52
ci_54                -3.838049e-04 3 1  ON 53
ci_55                -4.866532e-04 3 1  ON 54
ci_56                 1.793017e-03 3 1  ON 55
ci_57                 1.609806e-03 3 1  ON 56
ci_58                -1.312444e-03 3 1  ON 57
ci_59                -1.196179e-03 3 1  ON 58
ci_60                 1.754284e-03 3 1  ON 59
ci_61                 1.062115e-03 3 1  ON 60
ci_62                 5.693105e-06 3 1  ON 61
ci_63                -7.255594e-04 3 1  ON 62
ci_64                -4.812225e-04 3 1  ON 63
ci_65                -5.487709e-04 3 1  ON 64
ci_66                -4.401894e-04 3 1  ON 65
ci_67                -5.160306e-04 3 1  ON 66
ci_68                -1.853992e-03 3 1  ON 67
ci_69                -1.800327e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.3442e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s017 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s017 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=17  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2830e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 17
    time step          = 0.05
    reference energy   = -22.7579
    reference variance = 0.455083
====================================================
  Execution time = 2.6052e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s017
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5372e+04
  VMC Eavg = -2.2819e+01
  VMC Evar = 4.8835e-01
  Total weights = 1.963813908e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.5774e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.472619466656
                                         uncertainty =       0.003768979283

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.472619466656
                                         uncertainty =       0.003768979283

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000486165502
  error estimate for blocks of size 2^( 2) =       0.000506982553
  error estimate for blocks of size 2^( 3) =       0.000527120383
  error estimate for blocks of size 2^( 4) =       0.000543119340
  error estimate for blocks of size 2^( 5) =       0.000553296232
  error estimate for blocks of size 2^( 6) =       0.000556361563
  error estimate for blocks of size 2^( 7) =       0.000561097433

      target function =                  N/A
              le_mean =     -22.819327818737
             les_mean =     521.210068219031
             stat err =       0.000553468642
             autocorr =       1.296038083986
              std dev =       0.687541846209
             le_variance =       0.472713790288


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281932781874e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.5367e-02, overlap shift 9.5367e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.819327818658       residual = 1.21e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.819337919775       residual = 4.71e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.819337991935       residual = 1.97e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.819337753679       residual = 1.12e-08           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.819337897697       residual = 6.73e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          4 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.5367e-02 is 1.165265e-03

solving harmonic davidson linear method for identity shift 3.8147e-01, overlap shift 3.8147e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.819327818658       residual = 1.21e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.819332976820       residual = 1.49e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.819333184420       residual = 2.72e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.819333128685       residual = 4.42e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.8147e-01 is 6.213080e-04

solving harmonic davidson linear method for identity shift 1.5259e+00, overlap shift 1.5259e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.819327818658       residual = 1.21e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.819329562817       residual = 8.97e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.819329705836       residual = 1.17e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.819329682312       residual = 2.49e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.5259e+00 is 2.167631e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.285355 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0639e+01
  </log>
  <optVariables href="FORM.s017.opt.xml">
ci_01                 1.177287e-01 3 1  ON 0
ci_02                -2.607289e-02 3 1  ON 1
ci_03                -2.585968e-02 3 1  ON 2
ci_04                 2.466271e-02 3 1  ON 3
ci_05                -2.258640e-02 3 1  ON 4
ci_06                -2.305112e-02 3 1  ON 5
ci_07                 2.602818e-02 3 1  ON 6
ci_08                -4.480758e-03 3 1  ON 7
ci_09                -1.251577e-02 3 1  ON 8
ci_10                -1.138361e-02 3 1  ON 9
ci_11                 1.608470e-02 3 1  ON 10
ci_12                 1.101681e-02 3 1  ON 11
ci_13                 1.147508e-02 3 1  ON 12
ci_14                 1.474071e-02 3 1  ON 13
ci_15                 7.746808e-03 3 1  ON 14
ci_16                 8.092413e-03 3 1  ON 15
ci_17                -9.539298e-03 3 1  ON 16
ci_18                -9.836073e-03 3 1  ON 17
ci_19                 9.263728e-03 3 1  ON 18
ci_20                 1.052556e-02 3 1  ON 19
ci_21                 7.998269e-03 3 1  ON 20
ci_22                 8.649871e-03 3 1  ON 21
ci_23                 5.931078e-03 3 1  ON 22
ci_24                 7.158073e-03 3 1  ON 23
ci_25                 4.571809e-03 3 1  ON 24
ci_26                 2.479557e-03 3 1  ON 25
ci_27                 1.568104e-03 3 1  ON 26
ci_28                 3.678096e-03 3 1  ON 27
ci_29                 3.750734e-03 3 1  ON 28
ci_30                 5.112150e-04 3 1  ON 29
ci_31                 5.598046e-04 3 1  ON 30
ci_32                -2.645550e-04 3 1  ON 31
ci_33                -2.017011e-04 3 1  ON 32
ci_34                 2.470954e-04 3 1  ON 33
ci_35                 5.265730e-04 3 1  ON 34
ci_36                -7.332244e-04 3 1  ON 35
ci_37                -1.060418e-03 3 1  ON 36
ci_38                 1.082866e-04 3 1  ON 37
ci_39                -8.541687e-04 3 1  ON 38
ci_40                -1.796159e-03 3 1  ON 39
ci_41                 6.040191e-04 3 1  ON 40
ci_42                -5.465227e-05 3 1  ON 41
ci_43                -2.296262e-03 3 1  ON 42
ci_44                -2.040408e-03 3 1  ON 43
ci_45                 1.907034e-04 3 1  ON 44
ci_46                -2.000474e-04 3 1  ON 45
ci_47                -8.471827e-04 3 1  ON 46
ci_48                -1.104714e-03 3 1  ON 47
ci_49                -1.348697e-03 3 1  ON 48
ci_50                -8.687330e-04 3 1  ON 49
ci_51                -2.536267e-04 3 1  ON 50
ci_52                 3.590880e-04 3 1  ON 51
ci_53                -9.457584e-04 3 1  ON 52
ci_54                -1.117242e-04 3 1  ON 53
ci_55                -1.056903e-03 3 1  ON 54
ci_56                 1.721846e-03 3 1  ON 55
ci_57                 1.435596e-03 3 1  ON 56
ci_58                -1.614845e-03 3 1  ON 57
ci_59                -1.627359e-03 3 1  ON 58
ci_60                 1.654690e-03 3 1  ON 59
ci_61                 9.544679e-04 3 1  ON 60
ci_62                -3.953773e-05 3 1  ON 61
ci_63                -2.970120e-04 3 1  ON 62
ci_64                -6.640902e-04 3 1  ON 63
ci_65                -7.512968e-04 3 1  ON 64
ci_66                -2.638845e-04 3 1  ON 65
ci_67                -7.728883e-04 3 1  ON 66
ci_68                -1.860726e-03 3 1  ON 67
ci_69                -1.824410e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 17
    time step          = 0.05
    reference energy   = -22.8199
    reference variance = 0.31635
====================================================
  Execution time = 2.7209e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s017
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2819e+01
  VMC Evar = 4.8693e-01
  Total weights = 1.9635e+06
  Execution time = 3.5458e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.471263687636
                                         uncertainty =       0.002367841056

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.471263687636
                                         uncertainty =       0.002367841056

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000485466551
  error estimate for blocks of size 2^( 2) =       0.000506494153
  error estimate for blocks of size 2^( 3) =       0.000526136861
  error estimate for blocks of size 2^( 4) =       0.000541210488
  error estimate for blocks of size 2^( 5) =       0.000551996186
  error estimate for blocks of size 2^( 6) =       0.000557997567
  error estimate for blocks of size 2^( 7) =       0.000560389218

      target function =                  N/A
              le_mean =     -22.819211450342
             les_mean =     521.415139919885
             stat err =       0.000552898365
             autocorr =       1.297095604569
              std dev =       0.686553380026
             le_variance =       0.471355543625

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.471150783540
                                         uncertainty =       0.002385724213

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.471150783540
                                         uncertainty =       0.002385724213

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000485407228
  error estimate for blocks of size 2^( 2) =       0.000506437266
  error estimate for blocks of size 2^( 3) =       0.000526094173
  error estimate for blocks of size 2^( 4) =       0.000541148722
  error estimate for blocks of size 2^( 5) =       0.000551908581
  error estimate for blocks of size 2^( 6) =       0.000557912427
  error estimate for blocks of size 2^( 7) =       0.000560357475

      target function =                  N/A
              le_mean =     -22.819199025942
             les_mean =     521.204826783941
             stat err =       0.000552831801
             autocorr =       1.297100294219
              std dev =       0.686469484683
             le_variance =       0.471240353402

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.471151321602
                                         uncertainty =       0.002385488330

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.471151321602
                                         uncertainty =       0.002385488330

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000485407720
  error estimate for blocks of size 2^( 2) =       0.000506438791
  error estimate for blocks of size 2^( 3) =       0.000526094238
  error estimate for blocks of size 2^( 4) =       0.000541147801
  error estimate for blocks of size 2^( 5) =       0.000551907051
  error estimate for blocks of size 2^( 6) =       0.000557921041
  error estimate for blocks of size 2^( 7) =       0.000560360077

      target function =                  N/A
              le_mean =     -22.819200337592
             les_mean =     521.205314079346
             stat err =       0.000552833992
             autocorr =       1.297107945790
              std dev =       0.686470180686
             le_variance =       0.471241308971

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.471122548328
                                         uncertainty =       0.002375483226

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.471122548328
                                         uncertainty =       0.002375483226

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000485393695
  error estimate for blocks of size 2^( 2) =       0.000506420842
  error estimate for blocks of size 2^( 3) =       0.000526074820
  error estimate for blocks of size 2^( 4) =       0.000541135409
  error estimate for blocks of size 2^( 5) =       0.000551908641
  error estimate for blocks of size 2^( 6) =       0.000557907655
  error estimate for blocks of size 2^( 7) =       0.000560348481

      target function =                  N/A
              le_mean =     -22.819207446375
             les_mean =     521.559490999635
             stat err =       0.000552825046
             autocorr =       1.297140922331
              std dev =       0.686450346522
             le_variance =       0.471214078240


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.819211450342        initial  <--
     9.5367e-02     9.5367e-01             1.1653e-03       -22.819199025942
     3.8147e-01     3.8147e+00             6.2131e-04       -22.819200337592
     1.5259e+00     1.5259e+01             2.1676e-04       -22.819207446375

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 45.0167
  </log>
  <optVariables href="FORM.s017.opt.xml">
ci_01                 1.180418e-01 3 1  ON 0
ci_02                -2.621783e-02 3 1  ON 1
ci_03                -2.557354e-02 3 1  ON 2
ci_04                 2.471901e-02 3 1  ON 3
ci_05                -2.269207e-02 3 1  ON 4
ci_06                -2.269384e-02 3 1  ON 5
ci_07                 2.641018e-02 3 1  ON 6
ci_08                -4.254485e-03 3 1  ON 7
ci_09                -1.245358e-02 3 1  ON 8
ci_10                -1.132809e-02 3 1  ON 9
ci_11                 1.607817e-02 3 1  ON 10
ci_12                 1.112897e-02 3 1  ON 11
ci_13                 1.104266e-02 3 1  ON 12
ci_14                 1.465354e-02 3 1  ON 13
ci_15                 8.217003e-03 3 1  ON 14
ci_16                 7.915065e-03 3 1  ON 15
ci_17                -9.664139e-03 3 1  ON 16
ci_18                -9.908169e-03 3 1  ON 17
ci_19                 9.623415e-03 3 1  ON 18
ci_20                 1.069515e-02 3 1  ON 19
ci_21                 8.426592e-03 3 1  ON 20
ci_22                 9.000962e-03 3 1  ON 21
ci_23                 5.900147e-03 3 1  ON 22
ci_24                 7.129157e-03 3 1  ON 23
ci_25                 3.950501e-03 3 1  ON 24
ci_26                 2.668333e-03 3 1  ON 25
ci_27                 1.645376e-03 3 1  ON 26
ci_28                 3.672692e-03 3 1  ON 27
ci_29                 3.573167e-03 3 1  ON 28
ci_30                 7.349532e-04 3 1  ON 29
ci_31                 3.868404e-04 3 1  ON 30
ci_32                -2.995373e-05 3 1  ON 31
ci_33                -5.953172e-04 3 1  ON 32
ci_34                 2.198486e-04 3 1  ON 33
ci_35                 4.634707e-04 3 1  ON 34
ci_36                -8.691729e-04 3 1  ON 35
ci_37                -1.073819e-03 3 1  ON 36
ci_38                -1.695656e-05 3 1  ON 37
ci_39                -6.456303e-04 3 1  ON 38
ci_40                -1.790655e-03 3 1  ON 39
ci_41                 6.565962e-04 3 1  ON 40
ci_42                -4.178656e-05 3 1  ON 41
ci_43                -2.530382e-03 3 1  ON 42
ci_44                -1.798750e-03 3 1  ON 43
ci_45                 6.197511e-05 3 1  ON 44
ci_46                -4.190757e-04 3 1  ON 45
ci_47                -7.205590e-04 3 1  ON 46
ci_48                -9.503098e-04 3 1  ON 47
ci_49                -1.206993e-03 3 1  ON 48
ci_50                -8.619896e-04 3 1  ON 49
ci_51                -3.323932e-04 3 1  ON 50
ci_52                 3.580315e-04 3 1  ON 51
ci_53                -1.127190e-03 3 1  ON 52
ci_54                -3.838049e-04 3 1  ON 53
ci_55                -4.866532e-04 3 1  ON 54
ci_56                 1.793017e-03 3 1  ON 55
ci_57                 1.609806e-03 3 1  ON 56
ci_58                -1.312444e-03 3 1  ON 57
ci_59                -1.196179e-03 3 1  ON 58
ci_60                 1.754284e-03 3 1  ON 59
ci_61                 1.062115e-03 3 1  ON 60
ci_62                 5.693105e-06 3 1  ON 61
ci_63                -7.255594e-04 3 1  ON 62
ci_64                -4.812225e-04 3 1  ON 63
ci_65                -5.487709e-04 3 1  ON 64
ci_66                -4.401894e-04 3 1  ON 65
ci_67                -5.160306e-04 3 1  ON 66
ci_68                -1.853992e-03 3 1  ON 67
ci_69                -1.800327e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.5661e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s018 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s018 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=18  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2827e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 18
    time step          = 0.05
    reference energy   = -22.8702
    reference variance = 0.348998
====================================================
  Execution time = 2.6690e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s018
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5340e+04
  VMC Eavg = -2.2820e+01
  VMC Evar = 4.8681e-01
  Total weights = 1.963580613e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.6051e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.473182618219
                                         uncertainty =       0.003042097973

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.473182618219
                                         uncertainty =       0.003042097973

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000486375795
  error estimate for blocks of size 2^( 2) =       0.000507716451
  error estimate for blocks of size 2^( 3) =       0.000528074034
  error estimate for blocks of size 2^( 4) =       0.000543796535
  error estimate for blocks of size 2^( 5) =       0.000553092317
  error estimate for blocks of size 2^( 6) =       0.000559720428
  error estimate for blocks of size 2^( 7) =       0.000563948004

      target function =                  N/A
              le_mean =     -22.819702546319
             les_mean =     521.225637650249
             stat err =       0.000555139321
             autocorr =       1.302746970105
              std dev =       0.687839246267
             le_variance =       0.473122828705


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281970254632e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.5367e-01, overlap shift 9.5367e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.819702546254       residual = 1.39e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.819710573755       residual = 1.19e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.819710918086       residual = 1.64e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.819710916785       residual = 2.05e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.5367e-01 is 2.520878e-04

solving harmonic davidson linear method for identity shift 3.8147e+00, overlap shift 3.8147e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.819702546254       residual = 1.39e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.819704867881       residual = 1.24e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.819704976118       residual = 2.43e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.819704985159       residual = 3.97e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.8147e+00 is 7.158824e-05

solving harmonic davidson linear method for identity shift 1.5259e+01, overlap shift 1.5259e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.819702546254       residual = 1.39e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.819703150347       residual = 1.37e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.819703179484       residual = 3.12e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.819703182873       residual = 5.66e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.5259e+01 is 1.852979e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.286695 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.1305e+01
  </log>
  <optVariables href="FORM.s018.opt.xml">
ci_01                 1.180082e-01 3 1  ON 0
ci_02                -2.622776e-02 3 1  ON 1
ci_03                -2.561890e-02 3 1  ON 2
ci_04                 2.470661e-02 3 1  ON 3
ci_05                -2.269520e-02 3 1  ON 4
ci_06                -2.271142e-02 3 1  ON 5
ci_07                 2.637682e-02 3 1  ON 6
ci_08                -4.297640e-03 3 1  ON 7
ci_09                -1.243423e-02 3 1  ON 8
ci_10                -1.129455e-02 3 1  ON 9
ci_11                 1.604612e-02 3 1  ON 10
ci_12                 1.110254e-02 3 1  ON 11
ci_13                 1.108770e-02 3 1  ON 12
ci_14                 1.470240e-02 3 1  ON 13
ci_15                 8.170905e-03 3 1  ON 14
ci_16                 7.962000e-03 3 1  ON 15
ci_17                -9.624051e-03 3 1  ON 16
ci_18                -9.836581e-03 3 1  ON 17
ci_19                 9.617071e-03 3 1  ON 18
ci_20                 1.064661e-02 3 1  ON 19
ci_21                 8.437540e-03 3 1  ON 20
ci_22                 8.970196e-03 3 1  ON 21
ci_23                 5.957390e-03 3 1  ON 22
ci_24                 7.116518e-03 3 1  ON 23
ci_25                 4.007861e-03 3 1  ON 24
ci_26                 2.622863e-03 3 1  ON 25
ci_27                 1.683534e-03 3 1  ON 26
ci_28                 3.697207e-03 3 1  ON 27
ci_29                 3.596065e-03 3 1  ON 28
ci_30                 7.107019e-04 3 1  ON 29
ci_31                 3.622595e-04 3 1  ON 30
ci_32                 3.701831e-05 3 1  ON 31
ci_33                -5.754869e-04 3 1  ON 32
ci_34                 2.564608e-04 3 1  ON 33
ci_35                 4.225400e-04 3 1  ON 34
ci_36                -8.311829e-04 3 1  ON 35
ci_37                -1.093960e-03 3 1  ON 36
ci_38                -6.604238e-05 3 1  ON 37
ci_39                -6.378885e-04 3 1  ON 38
ci_40                -1.721392e-03 3 1  ON 39
ci_41                 6.291065e-04 3 1  ON 40
ci_42                -6.419551e-05 3 1  ON 41
ci_43                -2.496021e-03 3 1  ON 42
ci_44                -1.821144e-03 3 1  ON 43
ci_45                 1.325534e-05 3 1  ON 44
ci_46                -3.595151e-04 3 1  ON 45
ci_47                -7.067793e-04 3 1  ON 46
ci_48                -9.238480e-04 3 1  ON 47
ci_49                -1.222413e-03 3 1  ON 48
ci_50                -8.013779e-04 3 1  ON 49
ci_51                -3.065118e-04 3 1  ON 50
ci_52                 3.686616e-04 3 1  ON 51
ci_53                -1.125497e-03 3 1  ON 52
ci_54                -3.727478e-04 3 1  ON 53
ci_55                -5.032770e-04 3 1  ON 54
ci_56                 1.824152e-03 3 1  ON 55
ci_57                 1.624093e-03 3 1  ON 56
ci_58                -1.275104e-03 3 1  ON 57
ci_59                -1.136224e-03 3 1  ON 58
ci_60                 1.729624e-03 3 1  ON 59
ci_61                 1.062502e-03 3 1  ON 60
ci_62                 2.284718e-05 3 1  ON 61
ci_63                -7.272215e-04 3 1  ON 62
ci_64                -4.929558e-04 3 1  ON 63
ci_65                -5.153436e-04 3 1  ON 64
ci_66                -4.454405e-04 3 1  ON 65
ci_67                -5.556321e-04 3 1  ON 66
ci_68                -1.793194e-03 3 1  ON 67
ci_69                -1.754357e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 18
    time step          = 0.05
    reference energy   = -22.7524
    reference variance = 0.374833
====================================================
  Execution time = 2.5464e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s018
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2819e+01
  VMC Evar = 4.8152e-01
  Total weights = 1.9638e+06
  Execution time = 3.5535e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.466725458867
                                         uncertainty =       0.002312342675

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.466725458867
                                         uncertainty =       0.002312342675

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000483070476
  error estimate for blocks of size 2^( 2) =       0.000504216198
  error estimate for blocks of size 2^( 3) =       0.000524733620
  error estimate for blocks of size 2^( 4) =       0.000540367170
  error estimate for blocks of size 2^( 5) =       0.000549263590
  error estimate for blocks of size 2^( 6) =       0.000554350751
  error estimate for blocks of size 2^( 7) =       0.000554590858

      target function =                  N/A
              le_mean =     -22.818940809182
             les_mean =     521.185599201517
             stat err =       0.000549643092
             autocorr =       1.294614770101
              std dev =       0.683164819173
             le_variance =       0.466714170156

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.466710383872
                                         uncertainty =       0.002308456671

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.466710383872
                                         uncertainty =       0.002308456671

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000483062665
  error estimate for blocks of size 2^( 2) =       0.000504207897
  error estimate for blocks of size 2^( 3) =       0.000524725084
  error estimate for blocks of size 2^( 4) =       0.000540358281
  error estimate for blocks of size 2^( 5) =       0.000549257073
  error estimate for blocks of size 2^( 6) =       0.000554349100
  error estimate for blocks of size 2^( 7) =       0.000554595860

      target function =                  N/A
              le_mean =     -22.818939789863
             les_mean =     521.192476016884
             stat err =       0.000549640079
             autocorr =       1.294642441875
              std dev =       0.683153772119
             le_variance =       0.466699076361

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.466712477225
                                         uncertainty =       0.002309996358

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.466712477225
                                         uncertainty =       0.002309996358

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000483063755
  error estimate for blocks of size 2^( 2) =       0.000504209354
  error estimate for blocks of size 2^( 3) =       0.000524726540
  error estimate for blocks of size 2^( 4) =       0.000540359315
  error estimate for blocks of size 2^( 5) =       0.000549258517
  error estimate for blocks of size 2^( 6) =       0.000554346794
  error estimate for blocks of size 2^( 7) =       0.000554586198

      target function =                  N/A
              le_mean =     -22.818939607496
             les_mean =     521.185660768803
             stat err =       0.000549637706
             autocorr =       1.294625421566
              std dev =       0.683155313804
             le_variance =       0.466701182778

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.466723171332
                                         uncertainty =       0.002312024889

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.466723171332
                                         uncertainty =       0.002312024889

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000483069292
  error estimate for blocks of size 2^( 2) =       0.000504215004
  error estimate for blocks of size 2^( 3) =       0.000524732390
  error estimate for blocks of size 2^( 4) =       0.000540365822
  error estimate for blocks of size 2^( 5) =       0.000549262669
  error estimate for blocks of size 2^( 6) =       0.000554349942
  error estimate for blocks of size 2^( 7) =       0.000554589880

      target function =                  N/A
              le_mean =     -22.818940576768
             les_mean =     521.185559876187
             stat err =       0.000549642078
             autocorr =       1.294616338737
              std dev =       0.683163144866
             le_variance =       0.466711882504


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.818940809182        initial  <--
     9.5367e-01     9.5367e+00             2.5209e-04       -22.818939789863
     3.8147e+00     3.8147e+01             7.1588e-05       -22.818939607496
     1.5259e+01     1.5259e+02             1.8530e-05       -22.818940576768

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 43.2706
  </log>
  <optVariables href="FORM.s018.opt.xml">
ci_01                 1.180418e-01 3 1  ON 0
ci_02                -2.621783e-02 3 1  ON 1
ci_03                -2.557354e-02 3 1  ON 2
ci_04                 2.471901e-02 3 1  ON 3
ci_05                -2.269207e-02 3 1  ON 4
ci_06                -2.269384e-02 3 1  ON 5
ci_07                 2.641018e-02 3 1  ON 6
ci_08                -4.254485e-03 3 1  ON 7
ci_09                -1.245358e-02 3 1  ON 8
ci_10                -1.132809e-02 3 1  ON 9
ci_11                 1.607817e-02 3 1  ON 10
ci_12                 1.112897e-02 3 1  ON 11
ci_13                 1.104266e-02 3 1  ON 12
ci_14                 1.465354e-02 3 1  ON 13
ci_15                 8.217003e-03 3 1  ON 14
ci_16                 7.915065e-03 3 1  ON 15
ci_17                -9.664139e-03 3 1  ON 16
ci_18                -9.908169e-03 3 1  ON 17
ci_19                 9.623415e-03 3 1  ON 18
ci_20                 1.069515e-02 3 1  ON 19
ci_21                 8.426592e-03 3 1  ON 20
ci_22                 9.000962e-03 3 1  ON 21
ci_23                 5.900147e-03 3 1  ON 22
ci_24                 7.129157e-03 3 1  ON 23
ci_25                 3.950501e-03 3 1  ON 24
ci_26                 2.668333e-03 3 1  ON 25
ci_27                 1.645376e-03 3 1  ON 26
ci_28                 3.672692e-03 3 1  ON 27
ci_29                 3.573167e-03 3 1  ON 28
ci_30                 7.349532e-04 3 1  ON 29
ci_31                 3.868404e-04 3 1  ON 30
ci_32                -2.995373e-05 3 1  ON 31
ci_33                -5.953172e-04 3 1  ON 32
ci_34                 2.198486e-04 3 1  ON 33
ci_35                 4.634707e-04 3 1  ON 34
ci_36                -8.691729e-04 3 1  ON 35
ci_37                -1.073819e-03 3 1  ON 36
ci_38                -1.695656e-05 3 1  ON 37
ci_39                -6.456303e-04 3 1  ON 38
ci_40                -1.790655e-03 3 1  ON 39
ci_41                 6.565962e-04 3 1  ON 40
ci_42                -4.178656e-05 3 1  ON 41
ci_43                -2.530382e-03 3 1  ON 42
ci_44                -1.798750e-03 3 1  ON 43
ci_45                 6.197511e-05 3 1  ON 44
ci_46                -4.190757e-04 3 1  ON 45
ci_47                -7.205590e-04 3 1  ON 46
ci_48                -9.503098e-04 3 1  ON 47
ci_49                -1.206993e-03 3 1  ON 48
ci_50                -8.619896e-04 3 1  ON 49
ci_51                -3.323932e-04 3 1  ON 50
ci_52                 3.580315e-04 3 1  ON 51
ci_53                -1.127190e-03 3 1  ON 52
ci_54                -3.838049e-04 3 1  ON 53
ci_55                -4.866532e-04 3 1  ON 54
ci_56                 1.793017e-03 3 1  ON 55
ci_57                 1.609806e-03 3 1  ON 56
ci_58                -1.312444e-03 3 1  ON 57
ci_59                -1.196179e-03 3 1  ON 58
ci_60                 1.754284e-03 3 1  ON 59
ci_61                 1.062115e-03 3 1  ON 60
ci_62                 5.693105e-06 3 1  ON 61
ci_63                -7.255594e-04 3 1  ON 62
ci_64                -4.812225e-04 3 1  ON 63
ci_65                -5.487709e-04 3 1  ON 64
ci_66                -4.401894e-04 3 1  ON 65
ci_67                -5.160306e-04 3 1  ON 66
ci_68                -1.853992e-03 3 1  ON 67
ci_69                -1.800327e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.4582e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s019 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s019 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=19  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2826e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 19
    time step          = 0.05
    reference energy   = -22.7072
    reference variance = 0.365191
====================================================
  Execution time = 2.6163e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s019
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5354e+04
  VMC Eavg = -2.2820e+01
  VMC Evar = 5.1212e-01
  Total weights = 1.963877975e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.5610e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.474847894376
                                         uncertainty =       0.003944408964

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.474847894376
                                         uncertainty =       0.003944408964

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000487267822
  error estimate for blocks of size 2^( 2) =       0.000508464173
  error estimate for blocks of size 2^( 3) =       0.000528456270
  error estimate for blocks of size 2^( 4) =       0.000544266881
  error estimate for blocks of size 2^( 5) =       0.000554788077
  error estimate for blocks of size 2^( 6) =       0.000560893045
  error estimate for blocks of size 2^( 7) =       0.000563691166

      target function =                  N/A
              le_mean =     -22.820129274580
             les_mean =     521.270423436590
             stat err =       0.000555909792
             autocorr =       1.301586942235
              std dev =       0.689100762541
             le_variance =       0.474859860935


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.282012927458e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.5367e+00, overlap shift 9.5367e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.820129274505       residual = 2.48e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.820130333091       residual = 4.82e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.820130529404       residual = 2.06e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.820130578372       residual = 5.51e-08           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.820130578836       residual = 1.01e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          4 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.5367e+00 is 1.967061e-04

solving harmonic davidson linear method for identity shift 3.8147e+01, overlap shift 3.8147e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.820129274505       residual = 2.48e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.820129543127       residual = 4.74e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.820129593092       residual = 2.04e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.820129605370       residual = 5.73e-08           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.820129605558       residual = 1.14e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          4 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.8147e+01 is 4.977078e-05

solving harmonic davidson linear method for identity shift 1.5259e+02, overlap shift 1.5259e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.820129274505       residual = 2.48e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.820129341914       residual = 4.72e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.820129354463       residual = 2.04e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.820129357533       residual = 5.79e-08           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.820129357585       residual = 1.17e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          4 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.5259e+02 is 1.248040e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.288291 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0734e+01
  </log>
  <optVariables href="FORM.s019.opt.xml">
ci_01                 1.180430e-01 3 1  ON 0
ci_02                -2.619953e-02 3 1  ON 1
ci_03                -2.557570e-02 3 1  ON 2
ci_04                 2.470102e-02 3 1  ON 3
ci_05                -2.264230e-02 3 1  ON 4
ci_06                -2.269296e-02 3 1  ON 5
ci_07                 2.640555e-02 3 1  ON 6
ci_08                -4.224723e-03 3 1  ON 7
ci_09                -1.247146e-02 3 1  ON 8
ci_10                -1.133577e-02 3 1  ON 9
ci_11                 1.606225e-02 3 1  ON 10
ci_12                 1.112783e-02 3 1  ON 11
ci_13                 1.108113e-02 3 1  ON 12
ci_14                 1.464722e-02 3 1  ON 13
ci_15                 8.207050e-03 3 1  ON 14
ci_16                 7.918863e-03 3 1  ON 15
ci_17                -9.646697e-03 3 1  ON 16
ci_18                -9.913351e-03 3 1  ON 17
ci_19                 9.628314e-03 3 1  ON 18
ci_20                 1.069636e-02 3 1  ON 19
ci_21                 8.447581e-03 3 1  ON 20
ci_22                 8.988731e-03 3 1  ON 21
ci_23                 5.904154e-03 3 1  ON 22
ci_24                 7.129171e-03 3 1  ON 23
ci_25                 3.956928e-03 3 1  ON 24
ci_26                 2.672569e-03 3 1  ON 25
ci_27                 1.638312e-03 3 1  ON 26
ci_28                 3.663150e-03 3 1  ON 27
ci_29                 3.559170e-03 3 1  ON 28
ci_30                 7.356264e-04 3 1  ON 29
ci_31                 3.513431e-04 3 1  ON 30
ci_32                -3.565261e-05 3 1  ON 31
ci_33                -5.910010e-04 3 1  ON 32
ci_34                 2.151414e-04 3 1  ON 33
ci_35                 4.624101e-04 3 1  ON 34
ci_36                -8.659515e-04 3 1  ON 35
ci_37                -1.075587e-03 3 1  ON 36
ci_38                -1.220251e-05 3 1  ON 37
ci_39                -6.393539e-04 3 1  ON 38
ci_40                -1.787177e-03 3 1  ON 39
ci_41                 6.463712e-04 3 1  ON 40
ci_42                -3.853466e-05 3 1  ON 41
ci_43                -2.490143e-03 3 1  ON 42
ci_44                -1.797884e-03 3 1  ON 43
ci_45                 5.788453e-05 3 1  ON 44
ci_46                -4.302494e-04 3 1  ON 45
ci_47                -7.370085e-04 3 1  ON 46
ci_48                -9.484389e-04 3 1  ON 47
ci_49                -1.202710e-03 3 1  ON 48
ci_50                -8.583421e-04 3 1  ON 49
ci_51                -3.318000e-04 3 1  ON 50
ci_52                 3.652825e-04 3 1  ON 51
ci_53                -1.133113e-03 3 1  ON 52
ci_54                -3.850864e-04 3 1  ON 53
ci_55                -5.129368e-04 3 1  ON 54
ci_56                 1.787549e-03 3 1  ON 55
ci_57                 1.596724e-03 3 1  ON 56
ci_58                -1.306165e-03 3 1  ON 57
ci_59                -1.194261e-03 3 1  ON 58
ci_60                 1.751717e-03 3 1  ON 59
ci_61                 1.062668e-03 3 1  ON 60
ci_62                 1.427536e-05 3 1  ON 61
ci_63                -7.191589e-04 3 1  ON 62
ci_64                -4.578418e-04 3 1  ON 63
ci_65                -5.492045e-04 3 1  ON 64
ci_66                -4.534698e-04 3 1  ON 65
ci_67                -5.086690e-04 3 1  ON 66
ci_68                -1.845732e-03 3 1  ON 67
ci_69                -1.807670e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 19
    time step          = 0.05
    reference energy   = -22.8194
    reference variance = 0.353507
====================================================
  Execution time = 2.5546e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s019
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2820e+01
  VMC Evar = 4.8882e-01
  Total weights = 1.9636e+06
  Execution time = 3.5429e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.470480831534
                                         uncertainty =       0.003026409633

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.470480831534
                                         uncertainty =       0.003026409633

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000485019216
  error estimate for blocks of size 2^( 2) =       0.000506691434
  error estimate for blocks of size 2^( 3) =       0.000526747918
  error estimate for blocks of size 2^( 4) =       0.000542880834
  error estimate for blocks of size 2^( 5) =       0.000552306928
  error estimate for blocks of size 2^( 6) =       0.000555581783
  error estimate for blocks of size 2^( 7) =       0.000557981629

      target function =                  N/A
              le_mean =     -22.819801413387
             les_mean =     521.232416876948
             stat err =       0.000552187794
             autocorr =       1.296151343597
              std dev =       0.685920752658
             le_variance =       0.470487278927

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.470457919237
                                         uncertainty =       0.003023718171

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.470457919237
                                         uncertainty =       0.003023718171

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000485007363
  error estimate for blocks of size 2^( 2) =       0.000506681619
  error estimate for blocks of size 2^( 3) =       0.000526741523
  error estimate for blocks of size 2^( 4) =       0.000542877401
  error estimate for blocks of size 2^( 5) =       0.000552304058
  error estimate for blocks of size 2^( 6) =       0.000555575635
  error estimate for blocks of size 2^( 7) =       0.000557969485

      target function =                  N/A
              le_mean =     -22.819799183634
             les_mean =     521.231651353094
             stat err =       0.000552181645
             autocorr =       1.296185829797
              std dev =       0.685903990045
             le_variance =       0.470464283559

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.470468436827
                                         uncertainty =       0.003025034065

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.470468436827
                                         uncertainty =       0.003025034065

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000485012805
  error estimate for blocks of size 2^( 2) =       0.000506686075
  error estimate for blocks of size 2^( 3) =       0.000526744288
  error estimate for blocks of size 2^( 4) =       0.000542878748
  error estimate for blocks of size 2^( 5) =       0.000552305116
  error estimate for blocks of size 2^( 6) =       0.000555578140
  error estimate for blocks of size 2^( 7) =       0.000557974965

      target function =                  N/A
              le_mean =     -22.819800179192
             les_mean =     521.231955415668
             stat err =       0.000552184242
             autocorr =       1.296168933916
              std dev =       0.685911687263
             le_variance =       0.470474842724

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.470479191983
                                         uncertainty =       0.003026236130

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.470479191983
                                         uncertainty =       0.003026236130

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000485018368
  error estimate for blocks of size 2^( 2) =       0.000506690719
  error estimate for blocks of size 2^( 3) =       0.000526747416
  error estimate for blocks of size 2^( 4) =       0.000542880521
  error estimate for blocks of size 2^( 5) =       0.000552306646
  error estimate for blocks of size 2^( 6) =       0.000555581264
  error estimate for blocks of size 2^( 7) =       0.000557980742

      target function =                  N/A
              le_mean =     -22.819801250026
             les_mean =     521.232336585835
             stat err =       0.000552187293
             autocorr =       1.296153525646
              std dev =       0.685919553760
             le_variance =       0.470485634230


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.819801413387        initial  <--
     9.5367e+00     9.5367e+01             1.9671e-04       -22.819799183634
     3.8147e+01     3.8147e+02             4.9771e-05       -22.819800179192
     1.5259e+02     1.5259e+03             1.2480e-05       -22.819801250026

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 43.3504
  </log>
  <optVariables href="FORM.s019.opt.xml">
ci_01                 1.180418e-01 3 1  ON 0
ci_02                -2.621783e-02 3 1  ON 1
ci_03                -2.557354e-02 3 1  ON 2
ci_04                 2.471901e-02 3 1  ON 3
ci_05                -2.269207e-02 3 1  ON 4
ci_06                -2.269384e-02 3 1  ON 5
ci_07                 2.641018e-02 3 1  ON 6
ci_08                -4.254485e-03 3 1  ON 7
ci_09                -1.245358e-02 3 1  ON 8
ci_10                -1.132809e-02 3 1  ON 9
ci_11                 1.607817e-02 3 1  ON 10
ci_12                 1.112897e-02 3 1  ON 11
ci_13                 1.104266e-02 3 1  ON 12
ci_14                 1.465354e-02 3 1  ON 13
ci_15                 8.217003e-03 3 1  ON 14
ci_16                 7.915065e-03 3 1  ON 15
ci_17                -9.664139e-03 3 1  ON 16
ci_18                -9.908169e-03 3 1  ON 17
ci_19                 9.623415e-03 3 1  ON 18
ci_20                 1.069515e-02 3 1  ON 19
ci_21                 8.426592e-03 3 1  ON 20
ci_22                 9.000962e-03 3 1  ON 21
ci_23                 5.900147e-03 3 1  ON 22
ci_24                 7.129157e-03 3 1  ON 23
ci_25                 3.950501e-03 3 1  ON 24
ci_26                 2.668333e-03 3 1  ON 25
ci_27                 1.645376e-03 3 1  ON 26
ci_28                 3.672692e-03 3 1  ON 27
ci_29                 3.573167e-03 3 1  ON 28
ci_30                 7.349532e-04 3 1  ON 29
ci_31                 3.868404e-04 3 1  ON 30
ci_32                -2.995373e-05 3 1  ON 31
ci_33                -5.953172e-04 3 1  ON 32
ci_34                 2.198486e-04 3 1  ON 33
ci_35                 4.634707e-04 3 1  ON 34
ci_36                -8.691729e-04 3 1  ON 35
ci_37                -1.073819e-03 3 1  ON 36
ci_38                -1.695656e-05 3 1  ON 37
ci_39                -6.456303e-04 3 1  ON 38
ci_40                -1.790655e-03 3 1  ON 39
ci_41                 6.565962e-04 3 1  ON 40
ci_42                -4.178656e-05 3 1  ON 41
ci_43                -2.530382e-03 3 1  ON 42
ci_44                -1.798750e-03 3 1  ON 43
ci_45                 6.197511e-05 3 1  ON 44
ci_46                -4.190757e-04 3 1  ON 45
ci_47                -7.205590e-04 3 1  ON 46
ci_48                -9.503098e-04 3 1  ON 47
ci_49                -1.206993e-03 3 1  ON 48
ci_50                -8.619896e-04 3 1  ON 49
ci_51                -3.323932e-04 3 1  ON 50
ci_52                 3.580315e-04 3 1  ON 51
ci_53                -1.127190e-03 3 1  ON 52
ci_54                -3.838049e-04 3 1  ON 53
ci_55                -4.866532e-04 3 1  ON 54
ci_56                 1.793017e-03 3 1  ON 55
ci_57                 1.609806e-03 3 1  ON 56
ci_58                -1.312444e-03 3 1  ON 57
ci_59                -1.196179e-03 3 1  ON 58
ci_60                 1.754284e-03 3 1  ON 59
ci_61                 1.062115e-03 3 1  ON 60
ci_62                 5.693105e-06 3 1  ON 61
ci_63                -7.255594e-04 3 1  ON 62
ci_64                -4.812225e-04 3 1  ON 63
ci_65                -5.487709e-04 3 1  ON 64
ci_66                -4.401894e-04 3 1  ON 65
ci_67                -5.160306e-04 3 1  ON 66
ci_68                -1.853992e-03 3 1  ON 67
ci_69                -1.800327e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.4090e+01 secs
  Total Execution time = 1.4886e+03 secs

=========================================================
  A new xml input file : FORM.s019.cont.xml
